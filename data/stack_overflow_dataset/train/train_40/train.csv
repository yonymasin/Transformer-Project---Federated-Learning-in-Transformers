PostId,PostCreationDate,OwnerUserId,OwnerCreationDate,ReputationAtPostCreation,OwnerUndeletedAnswerCountAtPostTime,Title,BodyMarkdown,Tag1,Tag2,Tag3,Tag4,Tag5,PostClosedDate,OpenStatus,OpenStatusInt,BodyLength,TitleLength,TitleConcatWithBody,NumberOfTags
6757958,07/20/2011 06:40:16,330471,05/01/2010 17:08:50,1192,97,SQL abstractions,"Why do some frameworks (like CakePHP, Kohana, Zend, Djago, less - Rails) create some kind of SQL abstractions instead of a raw SQL database access? E.g. why do we need to make some perversions instead of a usual queries?",sql,database,orm,,,07/20/2011 12:07:30,not constructive,1,39,2,"SQL abstractions Why do some frameworks (like CakePHP, Kohana, Zend, Djago, less - Rails) create some kind of SQL abstractions instead of a raw SQL database access? E.g. why do we need to make some perversions instead of a usual queries?",3
7544781,09/25/2011 09:53:14,963476,09/25/2011 09:43:10,1,0,price update based on comparison.in baanIV c4,"How to update the last 2nd row in baan sql.
I want to compare the last 2 rows and based on some condition and wants to update the last 2nd row.
        ",sql,,,,,09/25/2011 10:29:46,not a real question,1,38,7,"price update based on comparison.in baanIV c4 How to update the last 2nd row in baan sql.
I want to compare the last 2 rows and based on some condition and wants to update the last 2nd row.
        ",1
4402900,12/09/2010 20:40:49,497470,11/04/2010 17:11:04,400,23,trouble turning this into a stored procedure,"    Declare @YearToGet int
    Set @YearToGet = 2008
    
    ;With RawData As
        (
        Select 39503 As Booked
        Union All Select 39509
        Union All Select 39535
        Union All Select 39620
        Union All Select 39791
        Union All Select 39838
        Union All Select 39899
        Union All Select 39134
        Union All Select 39139
        Union All Select 39139
        Union All Select 39140
        Union All Select 39146
        Union All Select 39146
        Union All Select 39146
        )
        , Numbers As 
        (
        Select 0 As Value, Year(GetDate()) As [Year]
            , Cast( DateDiff(d,0,GetDate()) as datetime ) As [Date]
            , DateDiff(d,0,GetDate()) As [DateInt]
        Union All 
        Select Value + 1, [Year] - 1
            , DateAdd(yyyy, -1, [Date])
            , DateDiff(d, 0, DateAdd(yyyy, -1, [Date]))
        From Numbers
        Where Value <= ( Year(GetDate()) - @YearToGet )
        )
    Select DIVISION, SDESCR, DYYYY
        , SUM(APRICE) AS Sales
        , SUM(PARTY) AS PAX
        , SUM(NetAmount) AS NetSales
        , SUM(InsAmount) AS InsSales
        , SUM(CancelRevenue) AS CXSales
        , SUM(OtherAmount) AS OtherSales
        , SUM(CXVALUE) AS CXValue
    From dbo.B101BookingsDetails As BD
        Join Numbers As N
            On Cast(N.[Year] As char(4)) = BD.DYYYY
    Where BD.Booked = N.DateInt - 2
    Group By DIVISION, SDESCR, DYYYY",sql,sql-server-2005,,,,12/10/2010 03:38:47,not a real question,1,485,7,"trouble turning this into a stored procedure     Declare @YearToGet int
    Set @YearToGet = 2008
    
    ;With RawData As
        (
        Select 39503 As Booked
        Union All Select 39509
        Union All Select 39535
        Union All Select 39620
        Union All Select 39791
        Union All Select 39838
        Union All Select 39899
        Union All Select 39134
        Union All Select 39139
        Union All Select 39139
        Union All Select 39140
        Union All Select 39146
        Union All Select 39146
        Union All Select 39146
        )
        , Numbers As 
        (
        Select 0 As Value, Year(GetDate()) As [Year]
            , Cast( DateDiff(d,0,GetDate()) as datetime ) As [Date]
            , DateDiff(d,0,GetDate()) As [DateInt]
        Union All 
        Select Value + 1, [Year] - 1
            , DateAdd(yyyy, -1, [Date])
            , DateDiff(d, 0, DateAdd(yyyy, -1, [Date]))
        From Numbers
        Where Value <= ( Year(GetDate()) - @YearToGet )
        )
    Select DIVISION, SDESCR, DYYYY
        , SUM(APRICE) AS Sales
        , SUM(PARTY) AS PAX
        , SUM(NetAmount) AS NetSales
        , SUM(InsAmount) AS InsSales
        , SUM(CancelRevenue) AS CXSales
        , SUM(OtherAmount) AS OtherSales
        , SUM(CXVALUE) AS CXValue
    From dbo.B101BookingsDetails As BD
        Join Numbers As N
            On Cast(N.[Year] As char(4)) = BD.DYYYY
    Where BD.Booked = N.DateInt - 2
    Group By DIVISION, SDESCR, DYYYY",2
5806715,04/27/2011 15:36:53,727239,04/27/2011 12:23:53,3,0,"sum of cost spent on advertisments on specific magazine (month?, year?)","Here are the tables //sorry for the bad format//

ADV_COST
--------
PAGE_SIZE  
MAG_ID  
COST

//SAMPLE DATA ADV_COST//  
PAGE_SIZE                MAG_ID       COST
-------------------- ---------- ----------
1/25 PAGE                     1         40  
1/8 PAGE                      1         60  
1/6 PAGE                      1         65  
...


ADS
--------
AD_ID  
ADV_ID  
PAGE_SIZE  
MAG_ID  
START_DATE  
PURCH_DATE  
NUM_ISSUES
  
//SAMPLE DATA ADS//  
     AD_ID     ADV_ID PAGE_SIZE     MAG_ID START_DAT PURCH_DAT NUM_ISSUES
---------- ---------- ---------- ---------- --------- --------- ----------
         1          5 1/4 PAGE           1 01-APR-11 01-MAR-11         4
...


----------


Here's the question:  
Whirlpool ADV_ID=6; HOUSES: MAG_ID=1;

""How much money did Whirlpool spend in advertising in HOUSES this month?, this year?""

",sql,oracle,,,,,open,0,249,11,"sum of cost spent on advertisments on specific magazine (month?, year?) Here are the tables //sorry for the bad format//

ADV_COST
--------
PAGE_SIZE  
MAG_ID  
COST

//SAMPLE DATA ADV_COST//  
PAGE_SIZE                MAG_ID       COST
-------------------- ---------- ----------
1/25 PAGE                     1         40  
1/8 PAGE                      1         60  
1/6 PAGE                      1         65  
...


ADS
--------
AD_ID  
ADV_ID  
PAGE_SIZE  
MAG_ID  
START_DATE  
PURCH_DATE  
NUM_ISSUES
  
//SAMPLE DATA ADS//  
     AD_ID     ADV_ID PAGE_SIZE     MAG_ID START_DAT PURCH_DAT NUM_ISSUES
---------- ---------- ---------- ---------- --------- --------- ----------
         1          5 1/4 PAGE           1 01-APR-11 01-MAR-11         4
...


----------


Here's the question:  
Whirlpool ADV_ID=6; HOUSES: MAG_ID=1;

""How much money did Whirlpool spend in advertising in HOUSES this month?, this year?""

",2
6203157,06/01/2011 14:51:42,779639,06/01/2011 14:51:42,1,0,How to run two separate queries in SQL,"I would like to know how to run two separate queries using sql in Microsoft server management studio. I would like to have a space between the two is this possible?

select this that and the other
From tbl

select this that and the other
from tbl

returns...

query 1

query 2


",sql,sql-server-2005,query,table,,06/01/2011 14:56:06,not a real question,1,45,8,"How to run two separate queries in SQL I would like to know how to run two separate queries using sql in Microsoft server management studio. I would like to have a space between the two is this possible?

select this that and the other
From tbl

select this that and the other
from tbl

returns...

query 1

query 2


",4
5347025,03/18/2011 01:12:33,665337,03/18/2011 01:10:52,1,0,'OUTPUT' DML does not work in SQL Server 2008 R2,"I am trying to use the OUTPUT DML command in SQL Server 2008 R2 against a database but it highlights with the red squiggly, and says 'OUTPUT' Stored Procedure not found!

What gives?:!

http://msdn.microsoft.com/en-us/library/ms177564.aspx

Thanks,
",sql,sql-server-2008,,,,03/18/2011 10:08:08,not a real question,1,32,10,"'OUTPUT' DML does not work in SQL Server 2008 R2 I am trying to use the OUTPUT DML command in SQL Server 2008 R2 against a database but it highlights with the red squiggly, and says 'OUTPUT' Stored Procedure not found!

What gives?:!

http://msdn.microsoft.com/en-us/library/ms177564.aspx

Thanks,
",2
10997719,06/12/2012 13:28:35,1207026,02/13/2012 14:38:59,22,1,At what point does an index become necessary or worthwhile?,"I'm in the process of learning Databases and SQL. From what I have read adding an index to a table can increase performance to from around (log(n)) to even constant time. 

Considering the increased space usage, at what point does it make sense to add an index to a table? 

For example if i was using an employees table at how many records would the table have to have before you would add an index? 

In this specific case would a clustered index make sense?  
",sql,database,oracle,database-design,indexing,06/12/2012 22:59:31,not constructive,1,87,10,"At what point does an index become necessary or worthwhile? I'm in the process of learning Databases and SQL. From what I have read adding an index to a table can increase performance to from around (log(n)) to even constant time. 

Considering the increased space usage, at what point does it make sense to add an index to a table? 

For example if i was using an employees table at how many records would the table have to have before you would add an index? 

In this specific case would a clustered index make sense?  
",5
5847650,05/01/2011 09:45:14,713029,04/18/2011 08:16:33,16,0,Automating sql script to generate data in excel,"how to automate a sql script so that i can get the data in excel sheet???
any suggetion pls...",sql,,,,,08/18/2011 14:19:11,not a real question,1,18,8,"Automating sql script to generate data in excel how to automate a sql script so that i can get the data in excel sheet???
any suggetion pls...",1
8413049,12/07/2011 09:31:09,1085296,12/07/2011 09:28:27,1,0,Will there be any performance difference between these 2 Queries?,"1)
select * from student_tbl A ,result_tbl B where
A.student_name = B.student_name and
A.student_name = ""xyz"" ;

2)
select * from student_tbl A ,result_tbl B where
A.student_name = ""xyz"" and
A.student_name = B.student_name ;

Please Explain .",sql,,,,,,open,0,29,10,"Will there be any performance difference between these 2 Queries? 1)
select * from student_tbl A ,result_tbl B where
A.student_name = B.student_name and
A.student_name = ""xyz"" ;

2)
select * from student_tbl A ,result_tbl B where
A.student_name = ""xyz"" and
A.student_name = B.student_name ;

Please Explain .",1
4943622,02/09/2011 10:32:15,609563,02/09/2011 10:32:15,1,0,Returning unique results in a joined select,"I need help with a query that check the MSDB-database for SQL Server Agent Job results. My query is as follows:

SELECT
Convert(varchar(30),SERVERPROPERTY('ServerName')),
a.run_status,
b.run_requested_date,
c.name,
CASE c.enabled WHEN 1 THEN 'Enabled' Else 'Disabled' END,
CONVERT(VARCHAR(10),CONVERT(DATETIME,RTRIM(19000101))+(a.run_duration * 9 + a.run_duration % 10000 * 6 + a.run_duration % 100 * 10) / 216e4,108),
b.next_scheduled_run_date
FROM (msdb.dbo.sysjobhistory a LEFT JOIN msdb.dbo.sysjobactivity b ON b.job_history_id = a.instance_id)
join msdb.dbo.sysjobs c on b.job_id = c.job_id
ORDER BY c.name

So far so good, but running it returns serveral results for the same jobs depending on how many times they have ran up until the query. This is no good. I want only one result per job, and only the latest.

If I add the the string:
WHERE b.session_id=(SELECT MAX(session_id)  from msdb.dbo.sysjobactivity) 
It works better, but then it only lists the latest jobs depending on the session_id parameter. This will exclude jobs that haven't run for a while and is not good either.

Can someone help me with this?
I have tried with DISTINCT and/or GROUP BY but canät get it to work.",sql,tsql,unique,distinct,,,open,0,162,7,"Returning unique results in a joined select I need help with a query that check the MSDB-database for SQL Server Agent Job results. My query is as follows:

SELECT
Convert(varchar(30),SERVERPROPERTY('ServerName')),
a.run_status,
b.run_requested_date,
c.name,
CASE c.enabled WHEN 1 THEN 'Enabled' Else 'Disabled' END,
CONVERT(VARCHAR(10),CONVERT(DATETIME,RTRIM(19000101))+(a.run_duration * 9 + a.run_duration % 10000 * 6 + a.run_duration % 100 * 10) / 216e4,108),
b.next_scheduled_run_date
FROM (msdb.dbo.sysjobhistory a LEFT JOIN msdb.dbo.sysjobactivity b ON b.job_history_id = a.instance_id)
join msdb.dbo.sysjobs c on b.job_id = c.job_id
ORDER BY c.name

So far so good, but running it returns serveral results for the same jobs depending on how many times they have ran up until the query. This is no good. I want only one result per job, and only the latest.

If I add the the string:
WHERE b.session_id=(SELECT MAX(session_id)  from msdb.dbo.sysjobactivity) 
It works better, but then it only lists the latest jobs depending on the session_id parameter. This will exclude jobs that haven't run for a while and is not good either.

Can someone help me with this?
I have tried with DISTINCT and/or GROUP BY but canät get it to work.",4
11296023,07/02/2012 14:48:33,666468,03/18/2011 17:40:58,242,20,Oracle error: character string buffer too small,"I am running a basic query that retrieves rows based on basic conditional clauses, nothing complex.  This works fine:

    <cfquery name=""courses"" datasource=""banner"">
            SELECT *
            FROM tjucatalog
            WHERE (course_status = 'Active')
            	AND CONCAT(subject,course_no) IN (#PreserveSingleQuotes(courselist)#)
                AND term IN ('Fall 2012')
                AND ((end_date > #now()#) OR (course_meeting_info IS NOT NULL))
            ORDER BY TYear, TSort, DayNum, start_date, time, title
    </cfquery>

However, when I remove the ""AND term IN"" line from the query, it fails.

    <cfquery name=""courses"" datasource=""banner"">
            SELECT *
            FROM tjucatalog
            WHERE (course_status = 'Active')
            	AND CONCAT(subject,course_no) IN (#PreserveSingleQuotes(courselist)#)
                AND ((end_date > #now()#) OR (course_meeting_info IS NOT NULL))
            ORDER BY TYear, TSort, DayNum, start_date, time, title
    </cfquery>

The error I get is: **ORA-06502: PL/SQL: numeric or value error: character string buffer too small ORA-06512: at ""BANINST1.TJUCATALOG_PACK"", line 519**

Is this maybe a view that requires the field 'term' to be included, or is there something else at play here I'm entirely unaware of?",sql,oracle,coldfusion-8,,,,open,0,315,7,"Oracle error: character string buffer too small I am running a basic query that retrieves rows based on basic conditional clauses, nothing complex.  This works fine:

    <cfquery name=""courses"" datasource=""banner"">
            SELECT *
            FROM tjucatalog
            WHERE (course_status = 'Active')
            	AND CONCAT(subject,course_no) IN (#PreserveSingleQuotes(courselist)#)
                AND term IN ('Fall 2012')
                AND ((end_date > #now()#) OR (course_meeting_info IS NOT NULL))
            ORDER BY TYear, TSort, DayNum, start_date, time, title
    </cfquery>

However, when I remove the ""AND term IN"" line from the query, it fails.

    <cfquery name=""courses"" datasource=""banner"">
            SELECT *
            FROM tjucatalog
            WHERE (course_status = 'Active')
            	AND CONCAT(subject,course_no) IN (#PreserveSingleQuotes(courselist)#)
                AND ((end_date > #now()#) OR (course_meeting_info IS NOT NULL))
            ORDER BY TYear, TSort, DayNum, start_date, time, title
    </cfquery>

The error I get is: **ORA-06502: PL/SQL: numeric or value error: character string buffer too small ORA-06512: at ""BANINST1.TJUCATALOG_PACK"", line 519**

Is this maybe a view that requires the field 'term' to be included, or is there something else at play here I'm entirely unaware of?",3
8804621,01/10/2012 14:12:28,719825,04/21/2011 23:30:37,314,5,access - reset all comboboxes to itemdata(1) in form,"I have about 8 combo-boxes on a form. When a user clicks the button ""reset""  I would like all the combo boxes to display the first itemdata in the combo box. The code below returns null and doesn't work:


    Private Sub Command1_Click()
         Me.Combo1.ItemData (1)
         Me.Combo2.ItemData (1)
         Me.Combo3.ItemData (1)
         Me.Combo4.ItemData (1)
         Me.Combo5.ItemData (1)
         Me.Combo6.ItemData (1)
         Me.Combo7.ItemData (1)
         Me.Combo8.ItemData (1)
    End Sub",sql,vba,vb,combobox,access,,open,0,131,9,"access - reset all comboboxes to itemdata(1) in form I have about 8 combo-boxes on a form. When a user clicks the button ""reset""  I would like all the combo boxes to display the first itemdata in the combo box. The code below returns null and doesn't work:


    Private Sub Command1_Click()
         Me.Combo1.ItemData (1)
         Me.Combo2.ItemData (1)
         Me.Combo3.ItemData (1)
         Me.Combo4.ItemData (1)
         Me.Combo5.ItemData (1)
         Me.Combo6.ItemData (1)
         Me.Combo7.ItemData (1)
         Me.Combo8.ItemData (1)
    End Sub",5
7141543,08/21/2011 22:19:50,625031,02/20/2011 05:58:28,16,0,"How to get Forum Title, Description, Total Posts, TotalReplies and LastPost in SQL Query","I have Three Tables in SQL Server Database.
1- Forums (ForumID, ForumCategory, Title, Description,AddedBy,DateAdded,UpdatedBy,DateModified)
2- ForumThreads (ThreadID,ForumID,ThreadTitle,Description,AddedBy,DateAdded,UpdatedBy,DateModified)
3 -ForumThreadReplies (ThreadReplyID,ThreadID,Comments,AddedBy,DateAdded)

Now i want a SQL query to display records in ListView control on webpage to get results like this:

ThreadTitle, Description, ThreadStartedBy, DateStarted, TotalPosts(Threads), TotalReplies(To Threads), LastThread(Post), LastThreadAddedBy",sql,sql-server,,,,04/18/2012 08:42:21,not a real question,1,43,14,"How to get Forum Title, Description, Total Posts, TotalReplies and LastPost in SQL Query I have Three Tables in SQL Server Database.
1- Forums (ForumID, ForumCategory, Title, Description,AddedBy,DateAdded,UpdatedBy,DateModified)
2- ForumThreads (ThreadID,ForumID,ThreadTitle,Description,AddedBy,DateAdded,UpdatedBy,DateModified)
3 -ForumThreadReplies (ThreadReplyID,ThreadID,Comments,AddedBy,DateAdded)

Now i want a SQL query to display records in ListView control on webpage to get results like this:

ThreadTitle, Description, ThreadStartedBy, DateStarted, TotalPosts(Threads), TotalReplies(To Threads), LastThread(Post), LastThreadAddedBy",2
1216667,08/01/2009 14:02:18,37783,11/14/2008 20:00:29,77,3,dynamic interval creation in SQL,"I have the following problem, that I would like to solve with transact-sql.
I have something like this

Start End Item
1      5   A 
3      8   B

and I want to create something like

Start End Item-Combination
1      2    A      
3      5    A-B
6      8    B 



For the Item-Combination concatenation I already thought of using the FOR XML statement. But in order to create the different new intervals... I really don't know how to approach it. Any idea?

thanks",sql,sql-server,,,,,open,0,114,5,"dynamic interval creation in SQL I have the following problem, that I would like to solve with transact-sql.
I have something like this

Start End Item
1      5   A 
3      8   B

and I want to create something like

Start End Item-Combination
1      2    A      
3      5    A-B
6      8    B 



For the Item-Combination concatenation I already thought of using the FOR XML statement. But in order to create the different new intervals... I really don't know how to approach it. Any idea?

thanks",2
3136273,06/28/2010 21:27:07,200018,10/31/2009 02:28:19,15,0,Passing multiple filtering paramertes to a stored Proc,"I am sure the title of my question doesn't make much sense. But here is what i m trying to achieve. I have table with different stories(columns are StoryID, StoryTitle, StoryDesc, StoryCategory), so each story can belong to a category. for example category1, category2,.... category10.  I am in the need of a SP, where i specify the categories as parameters(multiple categories, in CSV format or XML) and the SP will return the stories belong to that categories. 

Im not sure what wouldbe the best way to do this in one SP call.any pointers will be appreciated.

thank you
",sql,sql-server-2008,,,,,open,0,98,8,"Passing multiple filtering paramertes to a stored Proc I am sure the title of my question doesn't make much sense. But here is what i m trying to achieve. I have table with different stories(columns are StoryID, StoryTitle, StoryDesc, StoryCategory), so each story can belong to a category. for example category1, category2,.... category10.  I am in the need of a SP, where i specify the categories as parameters(multiple categories, in CSV format or XML) and the SP will return the stories belong to that categories. 

Im not sure what wouldbe the best way to do this in one SP call.any pointers will be appreciated.

thank you
",2
3330555,07/25/2010 18:51:05,127880,06/23/2009 22:01:04,1118,36,SQL - Is it better to do a subquery here or an extended WHERE clause?,"The CUST table below will be joined with ~10 tables.

For this subquery in particular, am I better off simply joining up directly with the Customer table and moving the subquery's 4-part WHERE clause to the main query's WHERE clause?

I'm primarily wondering if it is possible to cut down on the amount of processing that SQL Server has to do if we localize portions of the master WHERE Clause by creating subqueries as below.

    select * From 
	(select CKey, CID, CName from MainDB.dbo.Customer 
         where 
            LOC = 'ARK' 
            and Status = 1 
            and CID not like 'KAN%' 
            and CIDnot like 'MIS%') as CUST


",sql,sql-server,sql-server-2005,sql-server-2008,,,open,0,161,15,"SQL - Is it better to do a subquery here or an extended WHERE clause? The CUST table below will be joined with ~10 tables.

For this subquery in particular, am I better off simply joining up directly with the Customer table and moving the subquery's 4-part WHERE clause to the main query's WHERE clause?

I'm primarily wondering if it is possible to cut down on the amount of processing that SQL Server has to do if we localize portions of the master WHERE Clause by creating subqueries as below.

    select * From 
	(select CKey, CID, CName from MainDB.dbo.Customer 
         where 
            LOC = 'ARK' 
            and Status = 1 
            and CID not like 'KAN%' 
            and CIDnot like 'MIS%') as CUST


",4
5883600,05/04/2011 12:45:40,495084,11/02/2010 17:59:44,38,3,SQL Summing and Grouping,"How can I modify this query to display what it already does but also include the total SUM either in a separate row or column of InvPayAmnt per each select which has a unique CardName?

    SELECT IdEntry, DocNum, 'MICHIGAN' + CardCode, QUOTENAME(CardName,'""'), Convert(Decimal(10,2),InvPayAmnt), CONVERT(VARCHAR(10), T5.PmntDate,101), NumAtCard, PymMeth, 'Objtype' = CASE WHEN Objtype = 19 THEN 'CREDIT' ELSE 'INVOICE' END
    FROM MICHIGAN.dbo.PWZ3
    INNER JOIN MICHIGAN.dbo.OPWZ T5 ON T5.IdNumber = IdEntry
    WHERE T5.PmntDate = '4/1/2011' 
    AND T5.Canceled = 'N' 
    AND Checked = 'Y'
    UNION
    SELECT IdEntry, DocNum, 'BEN' + CardCode, QUOTENAME(CardName,'""'), Convert(Decimal(10,2),InvPayAmnt), 
    CONVERT(VARCHAR(10), T5.PmntDate,101), NumAtCard, PymMeth, 
    'Objtype' = CASE WHEN Objtype = 19 THEN 'CREDIT' ELSE 'INVOICE' END
    FROM BENSALEM.dbo.PWZ3
    INNER JOIN BENSALEM.dbo.OPWZ T5 ON T5.IdNumber = IdEntry
    WHERE T5.PmntDate = '4/1/2011' 
    AND T5.Canceled = 'N' 
    AND Checked = 'Y'
    ORDER By 3",sql,sum,,,,,open,0,185,4,"SQL Summing and Grouping How can I modify this query to display what it already does but also include the total SUM either in a separate row or column of InvPayAmnt per each select which has a unique CardName?

    SELECT IdEntry, DocNum, 'MICHIGAN' + CardCode, QUOTENAME(CardName,'""'), Convert(Decimal(10,2),InvPayAmnt), CONVERT(VARCHAR(10), T5.PmntDate,101), NumAtCard, PymMeth, 'Objtype' = CASE WHEN Objtype = 19 THEN 'CREDIT' ELSE 'INVOICE' END
    FROM MICHIGAN.dbo.PWZ3
    INNER JOIN MICHIGAN.dbo.OPWZ T5 ON T5.IdNumber = IdEntry
    WHERE T5.PmntDate = '4/1/2011' 
    AND T5.Canceled = 'N' 
    AND Checked = 'Y'
    UNION
    SELECT IdEntry, DocNum, 'BEN' + CardCode, QUOTENAME(CardName,'""'), Convert(Decimal(10,2),InvPayAmnt), 
    CONVERT(VARCHAR(10), T5.PmntDate,101), NumAtCard, PymMeth, 
    'Objtype' = CASE WHEN Objtype = 19 THEN 'CREDIT' ELSE 'INVOICE' END
    FROM BENSALEM.dbo.PWZ3
    INNER JOIN BENSALEM.dbo.OPWZ T5 ON T5.IdNumber = IdEntry
    WHERE T5.PmntDate = '4/1/2011' 
    AND T5.Canceled = 'N' 
    AND Checked = 'Y'
    ORDER By 3",2
11638796,07/24/2012 20:28:59,1222420,02/21/2012 02:35:02,373,16,Why does ORDERBY not belong in a View?,"I [understand](http://stackoverflow.com/questions/4227746/possible-to-have-an-orderby-in-a-view) [that you](http://blog.sqlauthority.com/2010/08/23/sql-server-order-by-does-not-work-limitation-of-the-views-part-1/) [cannot have](http://social.msdn.microsoft.com/forums/en-US/transactsql/thread/de53825b-a727-4bc7-95af-a4022cf2c0df/) `ORDERBY` in a View. (At least in MS SQL2012 where I am working)

I also understand that the ""correct"" way of sorting a View is by putting an `ORDERBY` around the `SELECT` statement querying the view.

But being relatively new to practical SQL and the usages of Views, I would like to *understand why* this is done so by design.  If I've followed the history correctly, this was once possible and was explicitly removed from MS SQL 2008 and so on (don't quote me on the exact version). 

However, the best reason I can come up with as to why Microsoft removed this feature is because ""a view is an unsorted collection of data"".

I am assuming there is a good, logical reason as to why a View should be unsorted.  Why can't a view just be a flattened out collection of data? Why specifically *un*-sorted?  It doesn't seem that hard to come up with situations where (at least to me / IMHO) it seems perfectly intuitive to have a sorted view. 
",sql,sql-server,order-by,sql-view,,07/24/2012 23:32:17,off topic,1,179,8,"Why does ORDERBY not belong in a View? I [understand](http://stackoverflow.com/questions/4227746/possible-to-have-an-orderby-in-a-view) [that you](http://blog.sqlauthority.com/2010/08/23/sql-server-order-by-does-not-work-limitation-of-the-views-part-1/) [cannot have](http://social.msdn.microsoft.com/forums/en-US/transactsql/thread/de53825b-a727-4bc7-95af-a4022cf2c0df/) `ORDERBY` in a View. (At least in MS SQL2012 where I am working)

I also understand that the ""correct"" way of sorting a View is by putting an `ORDERBY` around the `SELECT` statement querying the view.

But being relatively new to practical SQL and the usages of Views, I would like to *understand why* this is done so by design.  If I've followed the history correctly, this was once possible and was explicitly removed from MS SQL 2008 and so on (don't quote me on the exact version). 

However, the best reason I can come up with as to why Microsoft removed this feature is because ""a view is an unsorted collection of data"".

I am assuming there is a good, logical reason as to why a View should be unsorted.  Why can't a view just be a flattened out collection of data? Why specifically *un*-sorted?  It doesn't seem that hard to come up with situations where (at least to me / IMHO) it seems perfectly intuitive to have a sorted view. 
",4
4272168,11/24/2010 22:34:10,518201,11/24/2010 00:35:47,1,0,what is faster and why? where 1=1 or where 1 <= 1,"i would like to know which one of these will execute faster and why:

    select column1 from table1 where 1=1

or

    select column1 from table1 where 1<=1",sql,,,,,11/24/2010 22:47:45,not a real question,1,32,12,"what is faster and why? where 1=1 or where 1 <= 1 i would like to know which one of these will execute faster and why:

    select column1 from table1 where 1=1

or

    select column1 from table1 where 1<=1",1
6991162,08/09/2011 03:46:26,698778,04/08/2011 13:58:16,18,0,What are good sources for metaprogramming in SQL?,"I'm about to start on a project involving extensive amounts of SQL where there is probably a lot of opportunity to automate/standardize a bunch of different code. What are some good sources for learning SQL metaprogramming, code generation, and other shortcuts?",sql,metaprogramming,,,,11/20/2011 16:23:30,off topic,1,41,8,"What are good sources for metaprogramming in SQL? I'm about to start on a project involving extensive amounts of SQL where there is probably a lot of opportunity to automate/standardize a bunch of different code. What are some good sources for learning SQL metaprogramming, code generation, and other shortcuts?",2
3412064,08/05/2010 05:49:47,411574,08/05/2010 05:49:47,1,0,SQL server  -----IF we have lot of records in Database. How we can handle them? ,IF we have lot of records in Database. How we can handle them? ,sql,server,,,,08/05/2010 06:09:53,not a real question,1,14,17,SQL server  -----IF we have lot of records in Database. How we can handle them?  IF we have lot of records in Database. How we can handle them? ,2
4330992,12/02/2010 01:58:36,507865,11/15/2010 05:21:26,26,1,which statement can be used instead of nested select SQL statement,which statement can be used instead of nested select SQL statement ,sql,,,,,12/02/2010 02:11:22,not a real question,1,12,11,which statement can be used instead of nested select SQL statement which statement can be used instead of nested select SQL statement ,1
11329755,07/04/2012 13:08:20,1010730,10/24/2011 11:16:40,67,0,How to test for a series of equal X paired rows in a row referring to a specific column?,"I'm using SQL Server 2008 R2.

Consider this table @t (TOP 20 of ORDER BY PK DESC):

    PK	SK	VC	APP		M	C
	==	==	==	====	==	==================
    21	7	79	NULL	0	NULL
    20	9	74	1		3	20=14, 18=13, 15=2
    19	6	79	1		2	19=11, 17=7
    18	9	77	1		0	NULL
    17	6	74	1		0	NULL
    16	7	79	1		0	NULL
    15	9	74	1		0	NULL
    14	9	74	1		0	NULL
    13	9	77	1		0	NULL
    12	7	77	1		0	NULL
    11	6	79	1		0	NULL
    10	7	79	1		0	NULL
    9	7	74	1		0	NULL
    8	7	79	1		0	NULL
    7	6	74	1		0	NULL
    6	6	74	1		0	NULL
    5	7	79	1		0	NULL
    4	7	77	1		0	NULL
    3	6	79	1		0	NULL
    2	9	74	1		0	NULL

Created with this:

    DECLARE @t TABLE(PK INT NOT NULL IDENTITY(1,1) PRIMARY KEY CLUSTERED, SK INT NOT NULL, VC INT NULL,  APP INT NULL, M INT NOT NULL,  C NVARCHAR(111) NULL);
    
    INSERT @t (SK,VC,APP,M,C) VALUES
    (7,77,1,0,NULL),
    (9,74,1,0,NULL),
    (6,79,1,0,NULL),
    (7,77,1,0,NULL),
    (7,79,1,0,NULL),
    (6,74,1,0,NULL),
    (6,74,1,0,NULL),
    (7,79,1,0,NULL),
    (7,74,1,0,NULL),
    (7,79,1,0,NULL),
    (6,79,1,0,NULL),
    (7,77,1,0,NULL),
    (9,77,1,0,NULL),
    (9,74,1,0,NULL),
    (9,74,1,0,NULL),
    (7,79,1,0,NULL),
    (6,74,1,0,NULL),
    (9,77,1,0,NULL),
    (6,79,1,2,'19=11, 17=7'),
    (9,74,1,3,'20=14, 18=13, 15=2'),
    (7,79,NULL,0,NULL)

My task is to return true for a match if the latest row (where APP IS NOT NULL) 
complete a series of X matching pairs or latest rows of the same group (same current SK).

For example, when testing for only 2 pairs, given the current required test is on SK=6, as soon as getting to PK = 19 there is a match.
The match is VC(19)=VC(11)=79 AND VC(17)=VC(7)=74

See that by executing the following:

DECLARE @PairsToTest int = 2
DECLARE @SK int = 6
SELECT 
	TOP (2*@PairsToTest) 
	* 
	FROM @t 
	WHERE 
			APP IS NOT NULL 
		AND SK = @SK 
	ORDER BY SK, PK DESC

results:

    PK	SK	VC	APP	M	C
    19	6	79	1	2	19=11, 17=7
    17	6	74	1	0	NULL
    11	6	79	1	0	NULL
    7	6	74	1	0	NULL

Another example.
When testing for 3 pairs, a match is found on PK=20 when looking in SK=9
(For my task, there is no need to test for all SKs. Although it is interesting question by itself, a result for a given SK is sufficient for the task.)

To see the match execute this:

    DECLARE @PairsToTest int = 3
    DECLARE @SK int = 9
    SELECT 
    	TOP (2*@PairsToTest) 
    	* 
    	FROM @t 
    	WHERE 
    			APP IS NOT NULL 
    		AND SK = @SK 
    	ORDER BY SK, PK DESC

which results:

    PK	SK	VC	APP	M	C
    20	9	74	1	3	20=14, 18=13, 15=2
    18	9	77	1	0	NULL
    15	9	74	1	0	NULL
    14	9	74	1	0	NULL
    13	9	77	1	0	NULL
    2	9	74	1	0	NULL


as you can see: VC(20)=VC(14)=74, VC(18)=VC(13)=74 and VC(15)=VC(2)

I thought of selecting the required sets of rows in the correct order, and count the equal rows in VC. If the count is the same as the `@PairsToTest` this is the sign to raise a flag.

I tried:

    DECLARE @PairsToTest int = 3
    DECLARE @SK int = 9
    ;with t0 as
    (
    SELECT 
    	TOP (2*@PairsToTest) 
    	* 
    	FROM @t 
    	WHERE 
    			APP IS NOT NULL 
    		AND SK = @SK 
    	ORDER BY SK, PK DESC
    ),
    t1 AS
    (
    SELECT TOP (@PairsToTest) * FROM t0
    ),
    t2 AS
    (
    SELECT TOP (@PairsToTest) * FROM t0 ORDER BY PK ASC 
    )
    ,t3 AS
    (
    SELECT TOP 99999999 * FROM t2 ORDER BY PK DESC
    )
    
    IF (SELECT COUNT(*) FROM t1 LEFT OUTER JOIN t3 ON t1.VC = t3.VC) = @PairsToTest 
    	SELECT 1
    ELSE
    	SELECT 0
    	
but there are too  may flaws in this:
1) VC does not contain unique data (only by chance)
2) the IF is not allowed
3) I should get rid of the TOP 99999999 in t3 (although I can live with that)

What are the required changes I should take in order to solve this?
",sql,sql-server,sql-server-2008,,,,open,0,792,19,"How to test for a series of equal X paired rows in a row referring to a specific column? I'm using SQL Server 2008 R2.

Consider this table @t (TOP 20 of ORDER BY PK DESC):

    PK	SK	VC	APP		M	C
	==	==	==	====	==	==================
    21	7	79	NULL	0	NULL
    20	9	74	1		3	20=14, 18=13, 15=2
    19	6	79	1		2	19=11, 17=7
    18	9	77	1		0	NULL
    17	6	74	1		0	NULL
    16	7	79	1		0	NULL
    15	9	74	1		0	NULL
    14	9	74	1		0	NULL
    13	9	77	1		0	NULL
    12	7	77	1		0	NULL
    11	6	79	1		0	NULL
    10	7	79	1		0	NULL
    9	7	74	1		0	NULL
    8	7	79	1		0	NULL
    7	6	74	1		0	NULL
    6	6	74	1		0	NULL
    5	7	79	1		0	NULL
    4	7	77	1		0	NULL
    3	6	79	1		0	NULL
    2	9	74	1		0	NULL

Created with this:

    DECLARE @t TABLE(PK INT NOT NULL IDENTITY(1,1) PRIMARY KEY CLUSTERED, SK INT NOT NULL, VC INT NULL,  APP INT NULL, M INT NOT NULL,  C NVARCHAR(111) NULL);
    
    INSERT @t (SK,VC,APP,M,C) VALUES
    (7,77,1,0,NULL),
    (9,74,1,0,NULL),
    (6,79,1,0,NULL),
    (7,77,1,0,NULL),
    (7,79,1,0,NULL),
    (6,74,1,0,NULL),
    (6,74,1,0,NULL),
    (7,79,1,0,NULL),
    (7,74,1,0,NULL),
    (7,79,1,0,NULL),
    (6,79,1,0,NULL),
    (7,77,1,0,NULL),
    (9,77,1,0,NULL),
    (9,74,1,0,NULL),
    (9,74,1,0,NULL),
    (7,79,1,0,NULL),
    (6,74,1,0,NULL),
    (9,77,1,0,NULL),
    (6,79,1,2,'19=11, 17=7'),
    (9,74,1,3,'20=14, 18=13, 15=2'),
    (7,79,NULL,0,NULL)

My task is to return true for a match if the latest row (where APP IS NOT NULL) 
complete a series of X matching pairs or latest rows of the same group (same current SK).

For example, when testing for only 2 pairs, given the current required test is on SK=6, as soon as getting to PK = 19 there is a match.
The match is VC(19)=VC(11)=79 AND VC(17)=VC(7)=74

See that by executing the following:

DECLARE @PairsToTest int = 2
DECLARE @SK int = 6
SELECT 
	TOP (2*@PairsToTest) 
	* 
	FROM @t 
	WHERE 
			APP IS NOT NULL 
		AND SK = @SK 
	ORDER BY SK, PK DESC

results:

    PK	SK	VC	APP	M	C
    19	6	79	1	2	19=11, 17=7
    17	6	74	1	0	NULL
    11	6	79	1	0	NULL
    7	6	74	1	0	NULL

Another example.
When testing for 3 pairs, a match is found on PK=20 when looking in SK=9
(For my task, there is no need to test for all SKs. Although it is interesting question by itself, a result for a given SK is sufficient for the task.)

To see the match execute this:

    DECLARE @PairsToTest int = 3
    DECLARE @SK int = 9
    SELECT 
    	TOP (2*@PairsToTest) 
    	* 
    	FROM @t 
    	WHERE 
    			APP IS NOT NULL 
    		AND SK = @SK 
    	ORDER BY SK, PK DESC

which results:

    PK	SK	VC	APP	M	C
    20	9	74	1	3	20=14, 18=13, 15=2
    18	9	77	1	0	NULL
    15	9	74	1	0	NULL
    14	9	74	1	0	NULL
    13	9	77	1	0	NULL
    2	9	74	1	0	NULL


as you can see: VC(20)=VC(14)=74, VC(18)=VC(13)=74 and VC(15)=VC(2)

I thought of selecting the required sets of rows in the correct order, and count the equal rows in VC. If the count is the same as the `@PairsToTest` this is the sign to raise a flag.

I tried:

    DECLARE @PairsToTest int = 3
    DECLARE @SK int = 9
    ;with t0 as
    (
    SELECT 
    	TOP (2*@PairsToTest) 
    	* 
    	FROM @t 
    	WHERE 
    			APP IS NOT NULL 
    		AND SK = @SK 
    	ORDER BY SK, PK DESC
    ),
    t1 AS
    (
    SELECT TOP (@PairsToTest) * FROM t0
    ),
    t2 AS
    (
    SELECT TOP (@PairsToTest) * FROM t0 ORDER BY PK ASC 
    )
    ,t3 AS
    (
    SELECT TOP 99999999 * FROM t2 ORDER BY PK DESC
    )
    
    IF (SELECT COUNT(*) FROM t1 LEFT OUTER JOIN t3 ON t1.VC = t3.VC) = @PairsToTest 
    	SELECT 1
    ELSE
    	SELECT 0
    	
but there are too  may flaws in this:
1) VC does not contain unique data (only by chance)
2) the IF is not allowed
3) I should get rid of the TOP 99999999 in t3 (although I can live with that)

What are the required changes I should take in order to solve this?
",3
7428152,09/15/2011 08:45:44,930369,09/06/2011 09:43:41,1,0,How to add a connection string to the web.config file,"I had the code:
 <add name=""EmployeeDatabase"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Intitial Catalog=EmployeeDatabase;Integrated Security=True;""/> <!--providerName=""System.Data.SqlClient""-->
    <add name=""EmployeeDatabaseConnectionString"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Initial Catalog=EmployeeDatabase;Integrated Security=True;"" providerName=""System.Data.SqlClient""/>
    <add name=""Time_Sheet"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Initial Catalog=Time_Sheet; Integrated Security=True;"" />
    <add name=""Time_SheetConnectionString"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Initial Catalog=Time_Sheet;Integrated Security=True;"" providerName=""System.Data.SqlClient""/>
It is showing the error Keyword not supported: 'intitial catalog'",sql,,,,,09/15/2011 09:11:17,too localized,1,51,10,"How to add a connection string to the web.config file I had the code:
 <add name=""EmployeeDatabase"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Intitial Catalog=EmployeeDatabase;Integrated Security=True;""/> <!--providerName=""System.Data.SqlClient""-->
    <add name=""EmployeeDatabaseConnectionString"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Initial Catalog=EmployeeDatabase;Integrated Security=True;"" providerName=""System.Data.SqlClient""/>
    <add name=""Time_Sheet"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Initial Catalog=Time_Sheet; Integrated Security=True;"" />
    <add name=""Time_SheetConnectionString"" connectionString=""Data Source=TVPC0004\SQLEXPRESS;Initial Catalog=Time_Sheet;Integrated Security=True;"" providerName=""System.Data.SqlClient""/>
It is showing the error Keyword not supported: 'intitial catalog'",1
6141940,05/26/2011 16:30:32,46717,12/16/2008 16:13:09,580,13,SQL test for prospective employees,"I hope it's okay to ask this question here, but I'm wondering if anyone out there in the data analyst/IT community has developed a test for applicants to verify their sql skills at an intermediate to advanced level?

thank you!

-C",sql,testing,interview-questions,,,05/26/2011 16:35:25,off topic,1,39,5,"SQL test for prospective employees I hope it's okay to ask this question here, but I'm wondering if anyone out there in the data analyst/IT community has developed a test for applicants to verify their sql skills at an intermediate to advanced level?

thank you!

-C",3
9503637,02/29/2012 17:17:11,1240726,02/29/2012 16:33:17,1,0,ACCES:insert select with an iterate where condition,"I'm quite new of Access and vba and SQl but still  I need to use these all together.
What I have to do is duplicate some record on certain table basing on a set of  criteria;
In order to do this I've managed to perform an ""insert select"" statement.
In brief my problem is that I've have to duplicate N times the same record where some field values in the table  is equal to a certain value.
here is my code : this allows me to iterate the sql statements N times (Where N is taken from a Table )

        Sub trydup()
    Dim rst As DAO.Recordset
    Dim asd As DAO.Recordset
    Set rst = CurrentDb.OpenRecordset(""piv"")
    With rst
    Dim i As Long
    For i = 1 To 36
    Dim NOM(1 To 36) As String
    Dim NUM(1 To 36)
    NOM(i) = !CDPRD
    NUM(i) = !n
    .MoveNext
    Next
    End With
    Set asd = CurrentDb.OpenRecordset(""Acc6"")
    MsgBox (NUM(4) & ""   "" & NOM(4))
    With asd
    Dim k As Integer
    Dim n As Long
    For n = 1 To 36
    Do While k <= NUM(n)
      CurrentDb.Execute "" INSERT into Acc6 SELECT * from Acc6 where CD_MAD = "" & ""'NOM("" & n & "" )'""
    k = k + 1
    Loop
    Next n
    End With
    End Sub

indeed if i run instead this code:

 

    Sub trydup()
    Dim rst As DAO.Recordset
    Dim asd As DAO.Recordset
    Set rst = CurrentDb.OpenRecordset(""piv"")
    With rst
    Dim i As Long
    For i = 1 To 36
    Dim NOM(1 To 36) As String
    Dim NUM(1 To 36)
    NOM(i) = !CDPRD
    NUM(i) = !n
    .MoveNext
    Next
    End With
    Set asd = CurrentDb.OpenRecordset(""Acc6"")
    MsgBox (NUM(4) & ""   "" & NOM(4))
    With asd
    Dim k As Integer
    Dim n As Long
    For n = 1 To 36
    Do While k <= NUM(n)
      *CurrentDb.Execute "" INSERT into Acc6 SELECT * from Acc6 where CD_MAD='PCA' "" )'""*
    k = k + 1
    Loop
    Next n
    End With
    End Sub
where PCA is the value containde in the vector NOM the vba works fine!
so the question is how to extract in sql statement all the values of the vector ""NOM"" iterativley?
thak you in advance for the answares!!!!
",sql,select,loops,insert,,,open,0,529,7,"ACCES:insert select with an iterate where condition I'm quite new of Access and vba and SQl but still  I need to use these all together.
What I have to do is duplicate some record on certain table basing on a set of  criteria;
In order to do this I've managed to perform an ""insert select"" statement.
In brief my problem is that I've have to duplicate N times the same record where some field values in the table  is equal to a certain value.
here is my code : this allows me to iterate the sql statements N times (Where N is taken from a Table )

        Sub trydup()
    Dim rst As DAO.Recordset
    Dim asd As DAO.Recordset
    Set rst = CurrentDb.OpenRecordset(""piv"")
    With rst
    Dim i As Long
    For i = 1 To 36
    Dim NOM(1 To 36) As String
    Dim NUM(1 To 36)
    NOM(i) = !CDPRD
    NUM(i) = !n
    .MoveNext
    Next
    End With
    Set asd = CurrentDb.OpenRecordset(""Acc6"")
    MsgBox (NUM(4) & ""   "" & NOM(4))
    With asd
    Dim k As Integer
    Dim n As Long
    For n = 1 To 36
    Do While k <= NUM(n)
      CurrentDb.Execute "" INSERT into Acc6 SELECT * from Acc6 where CD_MAD = "" & ""'NOM("" & n & "" )'""
    k = k + 1
    Loop
    Next n
    End With
    End Sub

indeed if i run instead this code:

 

    Sub trydup()
    Dim rst As DAO.Recordset
    Dim asd As DAO.Recordset
    Set rst = CurrentDb.OpenRecordset(""piv"")
    With rst
    Dim i As Long
    For i = 1 To 36
    Dim NOM(1 To 36) As String
    Dim NUM(1 To 36)
    NOM(i) = !CDPRD
    NUM(i) = !n
    .MoveNext
    Next
    End With
    Set asd = CurrentDb.OpenRecordset(""Acc6"")
    MsgBox (NUM(4) & ""   "" & NOM(4))
    With asd
    Dim k As Integer
    Dim n As Long
    For n = 1 To 36
    Do While k <= NUM(n)
      *CurrentDb.Execute "" INSERT into Acc6 SELECT * from Acc6 where CD_MAD='PCA' "" )'""*
    k = k + 1
    Loop
    Next n
    End With
    End Sub
where PCA is the value containde in the vector NOM the vba works fine!
so the question is how to extract in sql statement all the values of the vector ""NOM"" iterativley?
thak you in advance for the answares!!!!
",4
6744481,07/19/2011 08:47:42,850132,07/18/2011 13:41:54,4,0,Search in SQL table,"Good morning,
i want to do a search in my table :
if the key search is founded then it show the result for this paramater.
else it show all the table.

Thank you",sql,search,,,,07/19/2011 10:23:06,not a real question,1,30,4,"Search in SQL table Good morning,
i want to do a search in my table :
if the key search is founded then it show the result for this paramater.
else it show all the table.

Thank you",2
9215432,02/09/2012 17:10:06,501211,11/08/2010 21:57:46,35,2,SQL Group By - Get unique key of every type,"I have a problem with this SQL Grouping.

If i have a table with 3 columns.  Key is a unique key for every record.  Type is the type of record and Version is the version of the type.

    ID    Type      Version
    ------------------------
    1      A          200
    2      A          100
    3      B          200
    4      B          200
    5      B          100

I need to get 1 row for each version of each type

so it would look something like

    ID    Type       Version
    ------------------------
    1      A           200
    2      A           100
    3      B           200
    5      B           100

I know I need to group by the Type and version but I cant seem to figure out how to get the unique key for each Type and Version since they are on the same table

    SELECT Type, Version FROM TableName GROUP BY Type, Version 

Gets me all the unique Types and Versions, but I cant figure out how to finish off the query.
",sql,sql-server-2008,tsql,group-by,,,open,0,342,10,"SQL Group By - Get unique key of every type I have a problem with this SQL Grouping.

If i have a table with 3 columns.  Key is a unique key for every record.  Type is the type of record and Version is the version of the type.

    ID    Type      Version
    ------------------------
    1      A          200
    2      A          100
    3      B          200
    4      B          200
    5      B          100

I need to get 1 row for each version of each type

so it would look something like

    ID    Type       Version
    ------------------------
    1      A           200
    2      A           100
    3      B           200
    5      B           100

I know I need to group by the Type and version but I cant seem to figure out how to get the unique key for each Type and Version since they are on the same table

    SELECT Type, Version FROM TableName GROUP BY Type, Version 

Gets me all the unique Types and Versions, but I cant figure out how to finish off the query.
",4
10293863,04/24/2012 07:49:57,1353107,04/24/2012 07:39:35,1,0,SQL 2008 delete statement,"I am terribly sorry if this is a duplicate question, but I am having real issues.
Our DB administrator has gone missing in action, and is uncontactable. We have a realtime database which has now outgrown the disc size. I have a limited knowledge of SQL (only out of interests sake) and now i need to trim some old history from the db so the new data can again be enetered.

Can you please, please see if this statement is correct:

Delete from History where UdDate between '01-june-2011 00:00:01' and '30-june-2011 23:59:59'

History is the table, and UdDate is a parameter for filtering the data.

Would this statement be safe to run, and from what I have read I would have to do a shrink on the DB once the delete has completed.

Sorry again, terrible newbie here. 

Thanks for any / all assistance
Best regards

Jesse 
",sql,,,,,04/25/2012 13:43:21,not constructive,1,140,4,"SQL 2008 delete statement I am terribly sorry if this is a duplicate question, but I am having real issues.
Our DB administrator has gone missing in action, and is uncontactable. We have a realtime database which has now outgrown the disc size. I have a limited knowledge of SQL (only out of interests sake) and now i need to trim some old history from the db so the new data can again be enetered.

Can you please, please see if this statement is correct:

Delete from History where UdDate between '01-june-2011 00:00:01' and '30-june-2011 23:59:59'

History is the table, and UdDate is a parameter for filtering the data.

Would this statement be safe to run, and from what I have read I would have to do a shrink on the DB once the delete has completed.

Sorry again, terrible newbie here. 

Thanks for any / all assistance
Best regards

Jesse 
",1
10713561,05/23/2012 04:44:21,1404813,05/19/2012 08:03:43,0,0,How to create indexing in ms sql?,"How to create a indexing in sp . i used mssql server 2008,
how is it possible in stored procedure .
and how to impliment in strore procedure.
and also can u briflly explain how is it possible.
",sql,sql-server,sql-server-2008,indexing,,05/23/2012 11:10:11,not a real question,1,35,7,"How to create indexing in ms sql? How to create a indexing in sp . i used mssql server 2008,
how is it possible in stored procedure .
and how to impliment in strore procedure.
and also can u briflly explain how is it possible.
",4
7468728,09/19/2011 09:17:55,774908,05/29/2011 06:35:10,1,0,SQL Server Health Review Template,"Does anyone have any standard template which we can used to audit/review/report health of SQL SERVER

Regards",sql,sql-server,,,,09/21/2011 00:01:47,off topic,1,16,5,"SQL Server Health Review Template Does anyone have any standard template which we can used to audit/review/report health of SQL SERVER

Regards",2
8660970,12/28/2011 20:36:02,967330,09/27/2011 14:55:32,570,64,Calculating date differences between records,"We have a table in our database that various systems report into with timestamp and values. This table is called the data table. (I know, I didn't name it.)

So I'm given the task of going through and find the time differences between the reports for a particular system.

Not knowing how else to go about this, I created a temporary table, such:

    CREATE TABLE #Readings(
      id			INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
      timestamp 	DATETIME
    )

Then I insert all of the readings for a particular system:

    INSERT INTO #Readings (timestamp)
    SELECT ReadingAt
    FROM data 
    WHERE SenId = 3
    ORDER BY ReadingAt

Finally, I run my query:

    select	r1.id, r1.timestamp, datediff(second, r1.timestamp, (select r2.timestamp 
    from #Readings r2 where r2.id = (r1.id - 1)))
    from	#Readings r1
    where id > 1

but this returned:

    101	2011-07-14 04:44:05.443	<null>
    102	2011-07-14 04:46:05.443	-120
    103	2011-07-14 04:48:05.447	-120
    104	2011-07-14 04:50:05.447	-120
    105	2011-07-14 04:52:05.447	-120
    106	2011-07-14 04:54:05.45	-120
    107	2011-07-14 04:56:05.45	-120
    108	2011-07-14 04:58:05.45	-120
    109	2011-07-14 05:00:05.45	-120
    110	2011-07-14 05:02:05.453	-120

So I did the following:

    select	r1.id, r1.timestamp, (select r2.timestamp from #Readings r2 where r2.id = (r1.id - 1))
    from	#Readings r1
    where id > 1

which returned the correct dates.

So, I'm wondering, how can I do this?

Thanks.




",sql,sql-server,,,,12/30/2011 07:07:21,too localized,1,263,5,"Calculating date differences between records We have a table in our database that various systems report into with timestamp and values. This table is called the data table. (I know, I didn't name it.)

So I'm given the task of going through and find the time differences between the reports for a particular system.

Not knowing how else to go about this, I created a temporary table, such:

    CREATE TABLE #Readings(
      id			INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
      timestamp 	DATETIME
    )

Then I insert all of the readings for a particular system:

    INSERT INTO #Readings (timestamp)
    SELECT ReadingAt
    FROM data 
    WHERE SenId = 3
    ORDER BY ReadingAt

Finally, I run my query:

    select	r1.id, r1.timestamp, datediff(second, r1.timestamp, (select r2.timestamp 
    from #Readings r2 where r2.id = (r1.id - 1)))
    from	#Readings r1
    where id > 1

but this returned:

    101	2011-07-14 04:44:05.443	<null>
    102	2011-07-14 04:46:05.443	-120
    103	2011-07-14 04:48:05.447	-120
    104	2011-07-14 04:50:05.447	-120
    105	2011-07-14 04:52:05.447	-120
    106	2011-07-14 04:54:05.45	-120
    107	2011-07-14 04:56:05.45	-120
    108	2011-07-14 04:58:05.45	-120
    109	2011-07-14 05:00:05.45	-120
    110	2011-07-14 05:02:05.453	-120

So I did the following:

    select	r1.id, r1.timestamp, (select r2.timestamp from #Readings r2 where r2.id = (r1.id - 1))
    from	#Readings r1
    where id > 1

which returned the correct dates.

So, I'm wondering, how can I do this?

Thanks.




",2
7056094,08/14/2011 09:39:26,893731,08/14/2011 08:49:56,1,0,IF ELSE statement and Select query not working,"> have this simple if elseif statement that doesn't seems to work.
The variables are passed from a checkbox select.
If used like this it works just for the type selection.
If i use a if + if statement, it shows results for the second select.
Any ideas?

    $man=$_GET['m'];  
    $wom=$_GET['w'];  
    $chd=$_GET['c'];  
    $type1=$_GET['tip1'];  
    $type2=$_GET['tip2'];  
    $type3=$_GET['tip3'];  
    $link=mysql_connect (""localhost"", ""............."", ""........."") 
        or die(""Nu s-a putut face conectarea la serverul SQL!"");  
    mysql_select_db(""......"") or die(""Nu s-a putut selecta baza de date!"");

    if (($type1)||($type2)||($type3))
    {
    $q=""SELECT * FROM biju WHERE tip like '%$type1%' or tip like '%$type2%' or tip like  '%$type3%'"";
    }

    elseif (($man)||($wom)||($chd))
    {
    $q=""SELECT * FROM biju WHERE gen like '%$man%' or gen like '%$chd%' or gen like '%$wom%'"";
    };


    $result=mysql_query($q);  
    $nr=mysql_numrows($result);",sql,select,if-statement,else,,11/22/2011 09:44:11,not a real question,1,193,8,"IF ELSE statement and Select query not working > have this simple if elseif statement that doesn't seems to work.
The variables are passed from a checkbox select.
If used like this it works just for the type selection.
If i use a if + if statement, it shows results for the second select.
Any ideas?

    $man=$_GET['m'];  
    $wom=$_GET['w'];  
    $chd=$_GET['c'];  
    $type1=$_GET['tip1'];  
    $type2=$_GET['tip2'];  
    $type3=$_GET['tip3'];  
    $link=mysql_connect (""localhost"", ""............."", ""........."") 
        or die(""Nu s-a putut face conectarea la serverul SQL!"");  
    mysql_select_db(""......"") or die(""Nu s-a putut selecta baza de date!"");

    if (($type1)||($type2)||($type3))
    {
    $q=""SELECT * FROM biju WHERE tip like '%$type1%' or tip like '%$type2%' or tip like  '%$type3%'"";
    }

    elseif (($man)||($wom)||($chd))
    {
    $q=""SELECT * FROM biju WHERE gen like '%$man%' or gen like '%$chd%' or gen like '%$wom%'"";
    };


    $result=mysql_query($q);  
    $nr=mysql_numrows($result);",4
6852201,07/27/2011 22:53:11,806969,06/20/2011 15:58:54,1261,96,which example is best at using indexes,"Using mssql server 2008. I need to compare performance. I don't have access to query analyzer until next week. It is just a crazy thought, I want to know which script will perform best.

I am wondering which script(s) can use the index on txt and why. 

The 2 tables has a total of 3 indexes and both tables has approximate 1 mil rows

    table1(id int(indexed), name varchar(10))          
    table2(id int(indexed), txt varchar(10)(indexed)) 

SQL1: (2*joins)

    SELECT *
    FROM table1 t1 LEFT JOIN
    table2 t2 ON t1.id = t2.t1_id
    AND NOT t2.txt LIKE 'blue%'
    AND NOT t2.txt LIKE 'green%'
    INNER JOIN table2 t3 ON t1.id = t3.t1_id
    WHERE t2.id is NULL    

SQL2: (1*join 1*'or')

    SELECT *
    FROM table1 t1 LEFT JOIN
    table2 t2 ON t1.id = t2.t1_id
    AND (t2.txt LIKE 'blue%' or t2.txt LIKE 'green%')
",sql,tsql,optimization,index,,,open,0,184,7,"which example is best at using indexes Using mssql server 2008. I need to compare performance. I don't have access to query analyzer until next week. It is just a crazy thought, I want to know which script will perform best.

I am wondering which script(s) can use the index on txt and why. 

The 2 tables has a total of 3 indexes and both tables has approximate 1 mil rows

    table1(id int(indexed), name varchar(10))          
    table2(id int(indexed), txt varchar(10)(indexed)) 

SQL1: (2*joins)

    SELECT *
    FROM table1 t1 LEFT JOIN
    table2 t2 ON t1.id = t2.t1_id
    AND NOT t2.txt LIKE 'blue%'
    AND NOT t2.txt LIKE 'green%'
    INNER JOIN table2 t3 ON t1.id = t3.t1_id
    WHERE t2.id is NULL    

SQL2: (1*join 1*'or')

    SELECT *
    FROM table1 t1 LEFT JOIN
    table2 t2 ON t1.id = t2.t1_id
    AND (t2.txt LIKE 'blue%' or t2.txt LIKE 'green%')
",4
11564566,07/19/2012 15:49:58,1354275,04/24/2012 16:35:02,1,0,Oracle SQL Triggers,"I'm new to Oracle and SQL and I'm trying to create a trigger where the req_ship_date (suborder table) cannot be before the order_date (customer_order table). I created the trigger:

    create or replace trigger req_ship_date_error
    before insert on suborder
    for each row
    declare
    placed_date date;
    req_date date;
    begin
    select order_date into placed_date
    from customer_order;
    select req_ship_date into req_date
    from suborder
    where suborder_no = :new.suborder_no;
    if placed_date > req_date then
    raise_application_error(-20002, ('Order ' || :new.suborder_no || ' required shipping date cannot be before order date'));
    end if;
    end;

But even after a try inserting a good statement I'm getting the following error

    insert into suborder
	values	( 8, 2, '10-jul-2012', '12-jul-2012', 'CVS', 2);

ERROR
 
        Error starting at line 1 in command:
    insert into suborder
    	values	( 8, 2, '10-jul-2012', '12-jul-2012', 'CVS', 2)
    Error report:
    SQL Error: ORA-01422: exact fetch returns more than requested number of rows
    ORA-06512: at ""COMPANY.REQ_SHIP_DATE_ERROR"", line 5
    ORA-04088: error during execution of trigger 'COMPANY.REQ_SHIP_DATE_ERROR'
    01422. 00000 -  ""exact fetch returns more than requested number of rows""
    *Cause:    The number specified in exact fetch is less than the rows returned.
    *Action:   Rewrite the query or change number of rows requested

Any idea what is causing this? Thanks",sql,oracle,triggers,,,07/21/2012 05:59:51,too localized,1,284,3,"Oracle SQL Triggers I'm new to Oracle and SQL and I'm trying to create a trigger where the req_ship_date (suborder table) cannot be before the order_date (customer_order table). I created the trigger:

    create or replace trigger req_ship_date_error
    before insert on suborder
    for each row
    declare
    placed_date date;
    req_date date;
    begin
    select order_date into placed_date
    from customer_order;
    select req_ship_date into req_date
    from suborder
    where suborder_no = :new.suborder_no;
    if placed_date > req_date then
    raise_application_error(-20002, ('Order ' || :new.suborder_no || ' required shipping date cannot be before order date'));
    end if;
    end;

But even after a try inserting a good statement I'm getting the following error

    insert into suborder
	values	( 8, 2, '10-jul-2012', '12-jul-2012', 'CVS', 2);

ERROR
 
        Error starting at line 1 in command:
    insert into suborder
    	values	( 8, 2, '10-jul-2012', '12-jul-2012', 'CVS', 2)
    Error report:
    SQL Error: ORA-01422: exact fetch returns more than requested number of rows
    ORA-06512: at ""COMPANY.REQ_SHIP_DATE_ERROR"", line 5
    ORA-04088: error during execution of trigger 'COMPANY.REQ_SHIP_DATE_ERROR'
    01422. 00000 -  ""exact fetch returns more than requested number of rows""
    *Cause:    The number specified in exact fetch is less than the rows returned.
    *Action:   Rewrite the query or change number of rows requested

Any idea what is causing this? Thanks",3
10829583,05/31/2012 08:01:06,1029321,11/04/2011 08:27:45,54,1,How to get the student academic progress?,"course Table

    course_code   course_name      credit_points_reqd
    1             Comp Science     300
    2             Soft Engineering 300

subject Table

    subject_code   subject_name    credit_points
    CS123          C Prog          15
    CS124          COBOL           15

enrolment table

    student_id    student_name  course_code      subject_code      Results  
    1             Lara Croft    1                CS123               70
    1             Lara Croft    1                CS124               50
    2             Tom Raider    2                CS123               60
    2             Tom Raider    2                CS124               40
    3             James Bond    1                CS123               NULL
    3             James Bond    1                CS124               40

OUTPUT TABLE

    student_name   course_name      credit_points_obt    credit_points_reqd
    Lara Croft     Comp Science     30                   300          
    Tom Raider     Soft Engineering 15                   300

I'm currently using TSQL. So here's the situation. I've prepared these tables to get the output like the way it i showed u up there. I need to calculate the credit points obtained. Credit points are achieved if the student receives > 50 for a subject they took. I want to ignore students that has not received any credit points at all (eg, James Bond is ignored as he has not achieved any points yet)

    select student_name, course_name,credit_points_obt,credit_points_reqd
    FROM enrolment (SELECT student_full_name, SUM(credit_points) AS credit_points_obt
                   FROM enrolment
                   GROUP BY student_id),

Totally stuck...I have no idea where to go now.
",sql,,,,,,open,0,695,7,"How to get the student academic progress? course Table

    course_code   course_name      credit_points_reqd
    1             Comp Science     300
    2             Soft Engineering 300

subject Table

    subject_code   subject_name    credit_points
    CS123          C Prog          15
    CS124          COBOL           15

enrolment table

    student_id    student_name  course_code      subject_code      Results  
    1             Lara Croft    1                CS123               70
    1             Lara Croft    1                CS124               50
    2             Tom Raider    2                CS123               60
    2             Tom Raider    2                CS124               40
    3             James Bond    1                CS123               NULL
    3             James Bond    1                CS124               40

OUTPUT TABLE

    student_name   course_name      credit_points_obt    credit_points_reqd
    Lara Croft     Comp Science     30                   300          
    Tom Raider     Soft Engineering 15                   300

I'm currently using TSQL. So here's the situation. I've prepared these tables to get the output like the way it i showed u up there. I need to calculate the credit points obtained. Credit points are achieved if the student receives > 50 for a subject they took. I want to ignore students that has not received any credit points at all (eg, James Bond is ignored as he has not achieved any points yet)

    select student_name, course_name,credit_points_obt,credit_points_reqd
    FROM enrolment (SELECT student_full_name, SUM(credit_points) AS credit_points_obt
                   FROM enrolment
                   GROUP BY student_id),

Totally stuck...I have no idea where to go now.
",1
9193418,02/08/2012 12:35:45,1172117,01/26/2012 20:01:14,5,0,Suggestion for SQL query books,I want to learn more in Teradata SQL. Can any one suggest me a good book to learn Teradata SQl or as a matter of fact any good SQL book through which I can learn SQL Queries.,sql,books,teradata,,,02/08/2012 12:59:16,not constructive,1,37,5,Suggestion for SQL query books I want to learn more in Teradata SQL. Can any one suggest me a good book to learn Teradata SQl or as a matter of fact any good SQL book through which I can learn SQL Queries.,3
42357,09/03/2008 19:28:30,1463,08/15/2008 17:26:44,311,26,How do you check your URL for SQL Injection Attacks?,"I've seen a few attempted SQL injection attacks on one of my web sites. It comes in the form of a query string that includes the ""cast"" keyword and a bunch of hex characters which when ""decoded"" are an injection of banner adverts into the DB.

My solution is to scan the full URL (and params) and search for the presence of ""cast(0x"" and if it's there to redirect to a static page.

How do you check your URL's for SQL Injection attacks?",sql,sql-server,,,,,open,0,81,10,"How do you check your URL for SQL Injection Attacks? I've seen a few attempted SQL injection attacks on one of my web sites. It comes in the form of a query string that includes the ""cast"" keyword and a bunch of hex characters which when ""decoded"" are an injection of banner adverts into the DB.

My solution is to scan the full URL (and params) and search for the presence of ""cast(0x"" and if it's there to redirect to a static page.

How do you check your URL's for SQL Injection attacks?",2
9765912,03/19/2012 06:30:27,273006,02/14/2010 18:39:23,32,2,How to do a match a string with multiple similar strings to find a closest match,"I have 3 rules which are strings like '483??', '48310**', '48**' and I have a source string '483102334' that has to be matched with the above rules to find a rule that matches the closest. In this example the closest match rule is '48310*' since it matches with most number of digits in my source string. I want to acheive this in PL/SQL. Please help!",sql,regex,string,collections,plsql,03/19/2012 13:45:33,not a real question,1,65,16,"How to do a match a string with multiple similar strings to find a closest match I have 3 rules which are strings like '483??', '48310**', '48**' and I have a source string '483102334' that has to be matched with the above rules to find a rule that matches the closest. In this example the closest match rule is '48310*' since it matches with most number of digits in my source string. I want to acheive this in PL/SQL. Please help!",5
9200978,02/08/2012 20:35:25,95803,04/25/2009 01:27:03,23,0,sql GROUP HAVING selection,"I want to project the **pid** indexes for all products which have the same title, as I'm using the following as a sub query.

Product(**pid**, title)

    SELECT p.title
    FROM product p
    group by title
    HAVING ( COUNT(p.title) > 1 )

this outputs the duplicate titles fine, but how do I project the **pid**'s instead?


",sql,group-by,having,,,,open,0,64,4,"sql GROUP HAVING selection I want to project the **pid** indexes for all products which have the same title, as I'm using the following as a sub query.

Product(**pid**, title)

    SELECT p.title
    FROM product p
    group by title
    HAVING ( COUNT(p.title) > 1 )

this outputs the duplicate titles fine, but how do I project the **pid**'s instead?


",3
11692845,07/27/2012 17:38:00,1558347,07/27/2012 17:28:02,1,0,How do I select all manager with respective employee,"ID  EMP_ID  EMP_NAE  MANAGER_ID
1     1      KARAN      2
2     2      K VEDI     3
3     3      SOMYA      2
4     4      KAVITA     3
5     5      AMAN       2",sql,,,,,07/27/2012 17:52:46,not a real question,1,92,9,"How do I select all manager with respective employee ID  EMP_ID  EMP_NAE  MANAGER_ID
1     1      KARAN      2
2     2      K VEDI     3
3     3      SOMYA      2
4     4      KAVITA     3
5     5      AMAN       2",1
11656604,07/25/2012 18:52:52,710201,04/15/2011 16:30:46,70,0,Visual SQL query Builder for Delphi 2010 and Unidac,"We are seeking a freeware or opensource Visual SQL Builder for Delphi 2010 and Unidac

We currently allow our clients to perform SQL against our application's database using a standard Memo field and peform button. We would like to enhance this functionality.

Any help would be greatly appreciated.",sql,delphi,delphi-2010,unidac,,07/26/2012 11:13:46,off topic,1,46,9,"Visual SQL query Builder for Delphi 2010 and Unidac We are seeking a freeware or opensource Visual SQL Builder for Delphi 2010 and Unidac

We currently allow our clients to perform SQL against our application's database using a standard Memo field and peform button. We would like to enhance this functionality.

Any help would be greatly appreciated.",4
10198668,04/17/2012 20:31:00,1339685,04/17/2012 20:04:47,1,0,"I need to write an SQL statement that joins multiple tables, including one table twice, and sorts by counting a group .. I think","I am an amateur just trying to finish his last question of his assignment (it is past due at this point, just looking for understanding) I sat and shot attempts at this for almost 5 hours now across two days, and have had no success.

I have tried looking through all the different types of joins, couldn't get grouping to work (ever) and have had little luck with the sorting as well. I can do all of these things one at a time, but the difficulty here was getting all of these things to work in union. 

This is the question:

<em>Write a SQL query to retrieve a list that has (source city, source code, destination city, 
destination code, and number-of-flights) for all source-dest pairs with at least 2 flights. Order 
by the number_of_flights. Note that the “dest”, and “source” attributes in the “flights” table 
are both referenced to the “airportid” in the “airports” table.</em>


Here are the tables I have to work with (also came with about 3000 lines of dummy entries)

    create table airports (airportid char(3) primary key, city varchar(20));
    create table airlines (airlineid char(2) primary key, name varchar(20), hub char(3)                  references airports(airportid)); 
    create table customers (customerid char(10) primary key, name varchar(25), birthdate date, frequentflieron char(2) references airlines(airlineid));
    create table flights (flightid char(6) primary key, source char(3) references airports(airportid), dest char(3) references airports(airportid), airlineid char(2) references airlines(airlineid), local_departing_time date, local_arrival_time date);
    create table flown (flightid char(6) references flights(flightid), customerid char(10) references customers, flightdate date);

The first problem I ran in to was outputting airports.city twice in the same query but with different results. Not only that, but no matter what I tried when grouping I would always get the same result: ""Not a GROUP BY expression"". Normally I have fun trying to piece these together, but this has been frustrating. Help!",sql,oracle,join,count,group,,open,0,332,24,"I need to write an SQL statement that joins multiple tables, including one table twice, and sorts by counting a group .. I think I am an amateur just trying to finish his last question of his assignment (it is past due at this point, just looking for understanding) I sat and shot attempts at this for almost 5 hours now across two days, and have had no success.

I have tried looking through all the different types of joins, couldn't get grouping to work (ever) and have had little luck with the sorting as well. I can do all of these things one at a time, but the difficulty here was getting all of these things to work in union. 

This is the question:

<em>Write a SQL query to retrieve a list that has (source city, source code, destination city, 
destination code, and number-of-flights) for all source-dest pairs with at least 2 flights. Order 
by the number_of_flights. Note that the “dest”, and “source” attributes in the “flights” table 
are both referenced to the “airportid” in the “airports” table.</em>


Here are the tables I have to work with (also came with about 3000 lines of dummy entries)

    create table airports (airportid char(3) primary key, city varchar(20));
    create table airlines (airlineid char(2) primary key, name varchar(20), hub char(3)                  references airports(airportid)); 
    create table customers (customerid char(10) primary key, name varchar(25), birthdate date, frequentflieron char(2) references airlines(airlineid));
    create table flights (flightid char(6) primary key, source char(3) references airports(airportid), dest char(3) references airports(airportid), airlineid char(2) references airlines(airlineid), local_departing_time date, local_arrival_time date);
    create table flown (flightid char(6) references flights(flightid), customerid char(10) references customers, flightdate date);

The first problem I ran in to was outputting airports.city twice in the same query but with different results. Not only that, but no matter what I tried when grouping I would always get the same result: ""Not a GROUP BY expression"". Normally I have fun trying to piece these together, but this has been frustrating. Help!",5
3142793,06/29/2010 16:41:30,259403,01/26/2010 17:00:43,51,1,SQL Server 2005 bigint missing?,"I am trying to set a column as a 64-bit integer, but my only available options are tinyint, smallint and int. Where did bigint run off to?

Notes: I'm using Access 2008 to access my SQL Server.",sql,sql-server,sql-server-2005,tsql,,,open,0,36,5,"SQL Server 2005 bigint missing? I am trying to set a column as a 64-bit integer, but my only available options are tinyint, smallint and int. Where did bigint run off to?

Notes: I'm using Access 2008 to access my SQL Server.",4
2921729,05/27/2010 13:57:10,511886,04/15/2010 09:40:42,201,0,"sql error, NULL??","So I have a query, can someone let me know if it looks ok content wise?

    ""INSERT INTO "".TBL_MESSAGES."" (NULL, 'Your ranking points have changed', 
										   'Due to your recent activity, your ranking points have increased by $r', '2', '$u', 
										   '0', '0', '0', '0', NULL, NULL, NULL, NULL, now())"";

I can add further information if the query doesnt appear to have a problem?
Thanks",sql,,,,,05/27/2010 14:09:55,not a real question,1,70,3,"sql error, NULL?? So I have a query, can someone let me know if it looks ok content wise?

    ""INSERT INTO "".TBL_MESSAGES."" (NULL, 'Your ranking points have changed', 
										   'Due to your recent activity, your ranking points have increased by $r', '2', '$u', 
										   '0', '0', '0', '0', NULL, NULL, NULL, NULL, now())"";

I can add further information if the query doesnt appear to have a problem?
Thanks",1
3707875,09/14/2010 10:05:46,445540,09/12/2010 11:19:00,1,1,Senior project for junior DBA(need advice),"I am a junior oracle DBA.Now I am graduating my university and there I should present senior project about my desired topic..I need help.What topic should I choose? What will be useful for me to deeper my knowledge about Oracle database?

Thanks a lot in previous.

",sql,oracle,,,,07/12/2011 18:18:01,not constructive,1,45,6,"Senior project for junior DBA(need advice) I am a junior oracle DBA.Now I am graduating my university and there I should present senior project about my desired topic..I need help.What topic should I choose? What will be useful for me to deeper my knowledge about Oracle database?

Thanks a lot in previous.

",2
2691056,04/22/2010 13:14:07,299533,02/10/2010 23:57:59,42,1,DB2 CASE Statement ,"I need to somehow use the CASE syntax (which is beyond me) to affect the database results based on criteria.
	I have a bunch of royalties in 0.# form (royalty)
	I have a title ID # (title_id) and I need to show the new increase in royalties so that I can use the data.
	
	IF: they have a current royalty of 0.0 - 0.1 = 10% raise
	IF: they have 0.11 - 0.15 = 20% raise
	IF: royalty >= 0.16 =  20% raise
	
Any help would be much appreciated.

    	create table royalites (
	title_id	char(6),
	lorange		integer,
	hirange		integer,
	royalty		decimal(5,2));",sql,case,db2,,,,open,0,91,4,"DB2 CASE Statement  I need to somehow use the CASE syntax (which is beyond me) to affect the database results based on criteria.
	I have a bunch of royalties in 0.# form (royalty)
	I have a title ID # (title_id) and I need to show the new increase in royalties so that I can use the data.
	
	IF: they have a current royalty of 0.0 - 0.1 = 10% raise
	IF: they have 0.11 - 0.15 = 20% raise
	IF: royalty >= 0.16 =  20% raise
	
Any help would be much appreciated.

    	create table royalites (
	title_id	char(6),
	lorange		integer,
	hirange		integer,
	royalty		decimal(5,2));",3
6519387,06/29/2011 10:44:19,231387,12/14/2009 15:41:13,77,3,Best SQL query for list of records containing certain characters?,"I'm working with a relatively large SQL Server 2000 DB at the moment. It's 80 GB in size, and have millions and millions of records. 

I currently need to return a list of names that contains at least one of a series of illegal characters. By illegal characters is just meant an arbitrary list of characters that is defined by the customer. In the below example I use question mark, semi-colon, period and comma as the illegal character list.

I was initially thinking to do a CLR function that worked with regular expressions, but as it's SQL server 2000, I guess that's out of the question. 

At the moment I've done like this:

    select x from users
    where 
    columnToBeSearched like '%?%' OR
    columnToBeSearched like '%;%' OR
    columnToBeSearched like '%.%' OR
    columnToBeSearched like '%,%' OR
    otherColumnToBeSearched like '%?%' OR
    otherColumnToBeSearched like '%;%' OR
    otherColumnToBeSearched like '%.%' OR
    otherColumnToBeSearched like '%,%'

Now, I'm not a SQL expert by any means, but I get the feeling that the above query will be very inefficient. Doing 8 multiple wildcard searches in a table with millions of records, seems like it could slow the system down rather seriously. While it seems to work fine on test servers, I am getting the ""this has to be completely wrong"" vibe.

As I need to execute this script on a live production server eventually, I hope to achieve good performance, so as not to clog the system. The script might need to be expanded later on to include more illegal characters, but this is very unlikely. 

To sum up: My aim is to get a list of records where either of two columns contain a customer-defined ""illegal character"". The database is live and massive, so I want a somewhat efficient approach, as I believe the above queries will be very slow.

Can anyone tell me the best way for achieving my result? Thanks!

/Morten",sql,sql-server,tsql,sql-server-2000,,,open,0,342,10,"Best SQL query for list of records containing certain characters? I'm working with a relatively large SQL Server 2000 DB at the moment. It's 80 GB in size, and have millions and millions of records. 

I currently need to return a list of names that contains at least one of a series of illegal characters. By illegal characters is just meant an arbitrary list of characters that is defined by the customer. In the below example I use question mark, semi-colon, period and comma as the illegal character list.

I was initially thinking to do a CLR function that worked with regular expressions, but as it's SQL server 2000, I guess that's out of the question. 

At the moment I've done like this:

    select x from users
    where 
    columnToBeSearched like '%?%' OR
    columnToBeSearched like '%;%' OR
    columnToBeSearched like '%.%' OR
    columnToBeSearched like '%,%' OR
    otherColumnToBeSearched like '%?%' OR
    otherColumnToBeSearched like '%;%' OR
    otherColumnToBeSearched like '%.%' OR
    otherColumnToBeSearched like '%,%'

Now, I'm not a SQL expert by any means, but I get the feeling that the above query will be very inefficient. Doing 8 multiple wildcard searches in a table with millions of records, seems like it could slow the system down rather seriously. While it seems to work fine on test servers, I am getting the ""this has to be completely wrong"" vibe.

As I need to execute this script on a live production server eventually, I hope to achieve good performance, so as not to clog the system. The script might need to be expanded later on to include more illegal characters, but this is very unlikely. 

To sum up: My aim is to get a list of records where either of two columns contain a customer-defined ""illegal character"". The database is live and massive, so I want a somewhat efficient approach, as I believe the above queries will be very slow.

Can anyone tell me the best way for achieving my result? Thanks!

/Morten",4
6102824,05/23/2011 20:46:15,25616,10/06/2008 19:57:07,511,21,Is there a postgres CLOSEST operator?,"I'm looking for something that, given a table like:

    | id | number |
    |  1 |     .7 |
    |  2 |   1.25 |
    |  3 |   1.01 |
    |  4 |    3.0 |

the query `SELECT * FROM my_table WHERE `number` CLOSEST(1)` would return row 3. I only care about numbers. Right now I've got a procedure that just loops over every row and does a comparison, but I figure the information should be available from a b-tree index, so this might be possible as a builtin, but I can't find any documentation suggesting that it does.",sql,postgresql,,,,,open,0,127,6,"Is there a postgres CLOSEST operator? I'm looking for something that, given a table like:

    | id | number |
    |  1 |     .7 |
    |  2 |   1.25 |
    |  3 |   1.01 |
    |  4 |    3.0 |

the query `SELECT * FROM my_table WHERE `number` CLOSEST(1)` would return row 3. I only care about numbers. Right now I've got a procedure that just loops over every row and does a comparison, but I figure the information should be available from a b-tree index, so this might be possible as a builtin, but I can't find any documentation suggesting that it does.",2
7005853,08/10/2011 04:18:11,265915,02/04/2010 05:27:07,627,39,Is there a database data browser app that will automatically compose views based on foreign keys?,"Every now and then when I'm browsing data in a database, I get tired of writing ad-hoc queries to join in the various tables I want to see, and I go looking for an app that will:

 - Allow me to follow foreign key relationships
 - Automatically display tables in a tree-like format based on relationships
 - Compose views by automatically joining on foreign keys

I know this can be done because I wrote (and lost) such an app many years ago, but I can't seem to find anything out there. The closest I've seen is generated ""scaffolding"" such as RoR has and MS has with ""Dynamic Data.""

Preferably free, of course :)",sql,database,scaffolding,,,,open,0,111,16,"Is there a database data browser app that will automatically compose views based on foreign keys? Every now and then when I'm browsing data in a database, I get tired of writing ad-hoc queries to join in the various tables I want to see, and I go looking for an app that will:

 - Allow me to follow foreign key relationships
 - Automatically display tables in a tree-like format based on relationships
 - Compose views by automatically joining on foreign keys

I know this can be done because I wrote (and lost) such an app many years ago, but I can't seem to find anything out there. The closest I've seen is generated ""scaffolding"" such as RoR has and MS has with ""Dynamic Data.""

Preferably free, of course :)",3
10024905,04/05/2012 08:10:26,20336,09/22/2008 10:02:42,10205,316,Call PostgreSQL function with multiple composite output parameters,"I'd like to define a function in PostgreSQL 9.1 that takes multiple INOUT parameters of composite types, but I don't know how to call it.

Eg.

    CREATE TYPE my_type_a AS (a integer, b float);
    CREATE TYPE my_type_b AS (c boolean, d varchar(5));
    
    CREATE FUNCTION my_complex_func(INOUT a my_type_a, INOUT b my_type_b)
    RETURNS RECORD
    '...'
    LANGUAGE plpgsql;

The definition statements execute just fine, but I don't know how to call this function! I tried:

    SELECT INTO a, b
        a, b FROM my_complex_func(a, b);

but this gives an error:

    ERROR:  record or row variable cannot be part of multiple-item INTO list

",sql,database,function,postgresql,plpgsql,,open,0,131,8,"Call PostgreSQL function with multiple composite output parameters I'd like to define a function in PostgreSQL 9.1 that takes multiple INOUT parameters of composite types, but I don't know how to call it.

Eg.

    CREATE TYPE my_type_a AS (a integer, b float);
    CREATE TYPE my_type_b AS (c boolean, d varchar(5));
    
    CREATE FUNCTION my_complex_func(INOUT a my_type_a, INOUT b my_type_b)
    RETURNS RECORD
    '...'
    LANGUAGE plpgsql;

The definition statements execute just fine, but I don't know how to call this function! I tried:

    SELECT INTO a, b
        a, b FROM my_complex_func(a, b);

but this gives an error:

    ERROR:  record or row variable cannot be part of multiple-item INTO list

",5
10471408,05/06/2012 14:44:52,498727,11/05/2010 19:41:55,206,0,Logic of creating sql tables -,"When is it better to create a few SQL tables, rather then one large table? (assuming it is possible to store all data in one table)

What are the advanteges and disadvanteges of one table over a few?",sql,,,,,05/06/2012 17:44:39,not constructive,1,37,6,"Logic of creating sql tables - When is it better to create a few SQL tables, rather then one large table? (assuming it is possible to store all data in one table)

What are the advanteges and disadvanteges of one table over a few?",1
7274448,09/01/2011 17:59:03,899746,08/18/2011 01:55:37,1,0,SQL for grouping/compressing by time span for a report dynamically,"How can I compress / aggregate / group a table with events dynamically over time. 
I have a table with values and time of occurrence.

Something like this:

    3  | 2011-02-16 23:21:05.250
    2  | 2011-02-16 22:21:05.267
    15 | 2011-02-16 22:21:05.155

I need to aggregate the values hourly starting from the first row (latest event). So in this example I want to end up with two rows.

    5
    15

So if a new value comes in:

    6  | 2011-02-16 24:21:05.249
    3  | 2011-02-16 23:21:05.250
    2  | 2011-02-16 22:21:05.267
    15 | 2011-02-16 22:21:05.155

If I would run that query again I end up with:

    9
    17

It should be easy to change the time span in the query. For example compress over the last 30 seconds. How can I do that in oracle and MS SQL?
",sql,oracle,sql-server-2005,sql-server-2008,,,open,0,167,10,"SQL for grouping/compressing by time span for a report dynamically How can I compress / aggregate / group a table with events dynamically over time. 
I have a table with values and time of occurrence.

Something like this:

    3  | 2011-02-16 23:21:05.250
    2  | 2011-02-16 22:21:05.267
    15 | 2011-02-16 22:21:05.155

I need to aggregate the values hourly starting from the first row (latest event). So in this example I want to end up with two rows.

    5
    15

So if a new value comes in:

    6  | 2011-02-16 24:21:05.249
    3  | 2011-02-16 23:21:05.250
    2  | 2011-02-16 22:21:05.267
    15 | 2011-02-16 22:21:05.155

If I would run that query again I end up with:

    9
    17

It should be easy to change the time span in the query. For example compress over the last 30 seconds. How can I do that in oracle and MS SQL?
",4
3514505,08/18/2010 16:47:25,424287,08/18/2010 16:47:25,1,0,How to optimize this query?,"**prices**
    id
    id_stock
    price
    date
    
    **stocks**
    id
    stock_name
    active

now i have to set stocks.active=0 for each stocks that has the MAX(prices.date) > then 15 days (of a date i have to pass)

This is my query, but it's very very slow!!!

    update stocks set stocks.active=0 where stocks.id IN (
    
    SELECT prices.id_stock 
    FROM prices
    GROUP BY prices.id_stock
    HAVING datediff('2010-08-17', MAX( prices.date )) > 15
    
    )

How to optimize it?

Thank you really much!

",sql,mysql,,,,,open,0,124,5,"How to optimize this query? **prices**
    id
    id_stock
    price
    date
    
    **stocks**
    id
    stock_name
    active

now i have to set stocks.active=0 for each stocks that has the MAX(prices.date) > then 15 days (of a date i have to pass)

This is my query, but it's very very slow!!!

    update stocks set stocks.active=0 where stocks.id IN (
    
    SELECT prices.id_stock 
    FROM prices
    GROUP BY prices.id_stock
    HAVING datediff('2010-08-17', MAX( prices.date )) > 15
    
    )

How to optimize it?

Thank you really much!

",2
8204770,11/20/2011 21:14:23,18044,09/18/2008 18:03:24,1055,22,Finding all children for multiple parents in single SQL query,"Suppose I have a table with parent-child relationships.

<pre>
parent  child
1       4
1       5
2       6
3       7
4       8
6       9
7       10
8       11
</pre>

Now I have a query that returns a list of people (eg. 1 and 2) and I want to find all their children, grandchildren etc. (in this case: 1, 2, 4, 5, 6, 8, 9, 11). 

I know I can use common table expressions to search recursively, but I wondered if I could create a SQL statement to find all descendents at once without having to iterate over the input set.",sql,sql-server,query,hierarchical-data,,,open,0,136,10,"Finding all children for multiple parents in single SQL query Suppose I have a table with parent-child relationships.

<pre>
parent  child
1       4
1       5
2       6
3       7
4       8
6       9
7       10
8       11
</pre>

Now I have a query that returns a list of people (eg. 1 and 2) and I want to find all their children, grandchildren etc. (in this case: 1, 2, 4, 5, 6, 8, 9, 11). 

I know I can use common table expressions to search recursively, but I wondered if I could create a SQL statement to find all descendents at once without having to iterate over the input set.",4
6799308,07/23/2011 08:47:04,851413,07/19/2011 06:56:15,1,0,i unable to filter the data because of spaces in data in sql server 2008,"select DISTINCT rtrim(ITEMID) 	FROM [MIS-028].[AX-DW-QTY].[dbo].ITEMQTYHISTORY_2 	where ITEMID = 'S991071215' this record is present in table but when im going to filter with this id not getting any record because in this id there is some space than i am use ltrim,rtrim after that also im not getting any record so plz tell what i have to do 
",sql,sql-server-2008,,,,07/25/2011 08:44:48,not a real question,1,58,15,"i unable to filter the data because of spaces in data in sql server 2008 select DISTINCT rtrim(ITEMID) 	FROM [MIS-028].[AX-DW-QTY].[dbo].ITEMQTYHISTORY_2 	where ITEMID = 'S991071215' this record is present in table but when im going to filter with this id not getting any record because in this id there is some space than i am use ltrim,rtrim after that also im not getting any record so plz tell what i have to do 
",2
3998529,10/22/2010 15:45:43,484392,10/22/2010 15:45:43,1,0,SQL Query : Selecting top N rows for each group in a table,"i am facing a very common issue regarding ""Selecting top N rows for each group in a table""

let's say I have a table with id, name, hair_colour, score columns.

Now i want a result such that , from each hair colour get me top 3 scorer names.

To solve this i got exactly what i need on 

http://rickosborne.org/blog/index.php/2008/01/07/sql-getting-top-n-rows-for-a-grouped-query/

But that won't work as expected when my scores are equal.
In above example the result as follow.

id  name  hair  score  ranknum
12  Kit  Blonde  10  1
9  Becca  Blonde  9  2
8  Katie  Blonde  8  3
3  Sarah  Brunette 10  1    
4  Deborah Brunette 9  2 - ------- - - > if
1  Kim  Brunette 8  3


if  4 Deborah Brunette 9 2 - ------- - - > if this also has same score as 10 same as Sarah then ranknum will be 2,2,3 for ""Brunette"" type of hair.

So anybody has solution to that...
",sql,,,,,,open,0,171,13,"SQL Query : Selecting top N rows for each group in a table i am facing a very common issue regarding ""Selecting top N rows for each group in a table""

let's say I have a table with id, name, hair_colour, score columns.

Now i want a result such that , from each hair colour get me top 3 scorer names.

To solve this i got exactly what i need on 

http://rickosborne.org/blog/index.php/2008/01/07/sql-getting-top-n-rows-for-a-grouped-query/

But that won't work as expected when my scores are equal.
In above example the result as follow.

id  name  hair  score  ranknum
12  Kit  Blonde  10  1
9  Becca  Blonde  9  2
8  Katie  Blonde  8  3
3  Sarah  Brunette 10  1    
4  Deborah Brunette 9  2 - ------- - - > if
1  Kim  Brunette 8  3


if  4 Deborah Brunette 9 2 - ------- - - > if this also has same score as 10 same as Sarah then ranknum will be 2,2,3 for ""Brunette"" type of hair.

So anybody has solution to that...
",1
2963248,06/03/2010 04:00:59,234194,12/17/2009 22:38:48,75,1,displaying sql exception in JSF,"I was wondering how would I be able to show SQL errors generated during update, delete, select * etc in JSF.

Any help would be appreciated.",sql,jsf,errors,,,,open,0,25,5,"displaying sql exception in JSF I was wondering how would I be able to show SQL errors generated during update, delete, select * etc in JSF.

Any help would be appreciated.",3
1409202,09/11/2009 05:56:06,2027,08/19/2008 21:06:37,162,6,Storing dependant dates in SQL,"I have quite a few situations where I have database structures similar to:

TABLE Event (EventID INT PrimaryKey, Start DATETIME, Finish DATETIME); and 
TABLE EventTask (EventTaskID INT PrimaryKey, EventID INT ForeignKey, TaskStart DATETIME, TaskFinish DATETIME)

1 to many relationship between Events and EventTasks, etc.

When the dates in the Event table are changed, the EventTask dates need to be changed as well - not difficult with supplied date functions, but date manipulation is always just a bit tricky.

I was wondering if it might be better to replace the TaskStart DATETIME and TaskFinish DATETIME with two INTS: one for Event.Start offset (mins different to Event.Start) and a Duration.

This way date updates become much more robust, as only a single row needs an update.

(I stipulate that this only applies where the EventTask dates are absolutely dependant on the Event dates)
",sql,,,,,,open,0,135,5,"Storing dependant dates in SQL I have quite a few situations where I have database structures similar to:

TABLE Event (EventID INT PrimaryKey, Start DATETIME, Finish DATETIME); and 
TABLE EventTask (EventTaskID INT PrimaryKey, EventID INT ForeignKey, TaskStart DATETIME, TaskFinish DATETIME)

1 to many relationship between Events and EventTasks, etc.

When the dates in the Event table are changed, the EventTask dates need to be changed as well - not difficult with supplied date functions, but date manipulation is always just a bit tricky.

I was wondering if it might be better to replace the TaskStart DATETIME and TaskFinish DATETIME with two INTS: one for Event.Start offset (mins different to Event.Start) and a Duration.

This way date updates become much more robust, as only a single row needs an update.

(I stipulate that this only applies where the EventTask dates are absolutely dependant on the Event dates)
",1
7386054,09/12/2011 09:53:10,577574,01/16/2011 15:11:23,1,0,SQL SERVER sub query,"How i must write this SQL SERVER script, NOTA = ? to get the NOTA parent value

SELECT NOTA AS nota1, SALES, NLANG, SUM(MSEMUA) AS MSEMUA,
       (SELECT SUM(KREDIT) AS KREDIT
        FROM  mutasidbf WHERE tgl_b BETWEEN '2011-07-01' AND '2011-07-31' AND **NOTA = NOTA**) AS Expr1
FROM mutasidbf
WHERE (TGL BETWEEN '2011-07-01' AND '2011-07-31') AND (NOTA LIKE 'v%')
GROUP BY NOTA, SALES, NLANG",sql,,,,,09/12/2011 10:11:28,not a real question,1,71,4,"SQL SERVER sub query How i must write this SQL SERVER script, NOTA = ? to get the NOTA parent value

SELECT NOTA AS nota1, SALES, NLANG, SUM(MSEMUA) AS MSEMUA,
       (SELECT SUM(KREDIT) AS KREDIT
        FROM  mutasidbf WHERE tgl_b BETWEEN '2011-07-01' AND '2011-07-31' AND **NOTA = NOTA**) AS Expr1
FROM mutasidbf
WHERE (TGL BETWEEN '2011-07-01' AND '2011-07-31') AND (NOTA LIKE 'v%')
GROUP BY NOTA, SALES, NLANG",1
9651711,03/11/2012 01:40:39,814264,06/24/2011 14:52:33,12,0,sql to get events that your friends are attending,"I've got a few tables

        User (UserId)
        Event (EventId)
        AttendingEvent (UserId,EventId)
        Friends (UserId,UserId)

I want to write a query that can return events where a specific user that I know the id of beforehand has friends that are going to it ordered by the event with the most friends attending.    
 ",sql,sql-server,,,,03/12/2012 15:08:38,not a real question,1,82,9,"sql to get events that your friends are attending I've got a few tables

        User (UserId)
        Event (EventId)
        AttendingEvent (UserId,EventId)
        Friends (UserId,UserId)

I want to write a query that can return events where a specific user that I know the id of beforehand has friends that are going to it ordered by the event with the most friends attending.    
 ",2
10909448,06/06/2012 06:51:46,1429149,05/31/2012 18:13:06,47,2,What are the scenarios in which LSN are broken?,"Have there ever being a need when you had to break a LSN  link in the log file. 

I would like to know when would we be doing this.",sql,sql-server,sql-server-2008,,,06/07/2012 12:58:45,not a real question,1,30,9,"What are the scenarios in which LSN are broken? Have there ever being a need when you had to break a LSN  link in the log file. 

I would like to know when would we be doing this.",3
6648140,07/11/2011 09:26:14,134713,07/08/2009 05:51:58,4035,145,sql query takes a lot of time,"i am running the below query:

    select * from dblappc.credit_history 
    where crd_effective_date>to_date('20100801','YYYYMMDD') and 
    o_crd_score >650 and 
    crd_expiration_date is null

Above table has no indexes.
the field `crd_expiration_date` is part of the primary key.

What are the ways where i can use to fast up the query output.
How could i use parallel hint here so that to give 500 rows at a time atleast. 
I am newbie to sql when it comes to using parallel hint.
Can anybody help me with this?",sql,oracle,parallel-processing,hint,,,open,0,92,7,"sql query takes a lot of time i am running the below query:

    select * from dblappc.credit_history 
    where crd_effective_date>to_date('20100801','YYYYMMDD') and 
    o_crd_score >650 and 
    crd_expiration_date is null

Above table has no indexes.
the field `crd_expiration_date` is part of the primary key.

What are the ways where i can use to fast up the query output.
How could i use parallel hint here so that to give 500 rows at a time atleast. 
I am newbie to sql when it comes to using parallel hint.
Can anybody help me with this?",4
11524073,07/17/2012 13:57:33,79020,03/17/2009 13:57:21,33,3,How does TSQL store the information in Job Schedule Properties?,"I know there is SELECT * FROM msdb..sysjobschedules, but that just shows the next time a job is scheduled to run.  I want to know how this is all determined and stored.  So where does it store the value for Recurs every Monday checkbox?",sql,tsql,job-scheduling,,,07/17/2012 14:05:34,off topic,1,46,10,"How does TSQL store the information in Job Schedule Properties? I know there is SELECT * FROM msdb..sysjobschedules, but that just shows the next time a job is scheduled to run.  I want to know how this is all determined and stored.  So where does it store the value for Recurs every Monday checkbox?",3
7279263,09/02/2011 04:34:51,924627,09/02/2011 04:34:51,1,0,search string in varbinary column of sql table,"i have a sql table which has 3 fields ProblemID,FileContent,FileName

i want to search user specified string from fileContent Column of SQL table

Is It possible to Convert binary data in varchar (I tried it but it gives results in different format)

thanks",sql,query,varbinary,,,,open,0,40,8,"search string in varbinary column of sql table i have a sql table which has 3 fields ProblemID,FileContent,FileName

i want to search user specified string from fileContent Column of SQL table

Is It possible to Convert binary data in varchar (I tried it but it gives results in different format)

thanks",3
10645812,05/18/2012 01:59:41,798510,06/14/2011 21:05:59,39,0,SQL group by query,"I have a a UNION ALL on two result sets. This results in some like below.

TOTALSTABLE

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL
    Brown          Dave           1234        500.00
    Brown          Dave           1234        300.00
    Smith          Frank          4321        123.00
    Smith          Frank          4321        456.00

I run the following query...

    SELECT TOTALSTABLE.FAMILYNAME,
      TOTALSTABLE.FIRSTNAME,
      TOTALSTABLE.NUMBER,
      SUM(TOTALSTABLE.TOTAL) COMBINEDTOTAL
    FROM TOTALSTABLE
    GROUP BY TOTALSTABLE.FAMILYNAME,
      TOTALSTABLE.FIRSTNAME,
      TOTALSTABLE.NUMBER

Which gives me something like...

    FAMILYNAME-----FIRSTNAME------NUMBER------COMBINEDTOTAL
    Brown          Dave           1234        800.00
    Smith          Frank          4321        579.00

This is what i need. However I need to add an additional column which is null in the result i am attempting to do a UNION ALL on.

Example:

T1

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
    Brown          Dave           1234        500.00      01/01/2001
    Smith          Frank          4321        123.00      01/01/2001

T2

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
    Brown          Dave           1234        300.00      NULL
    Smith          Frank          4321        456.00      NULL

COMBINED (UNION ALL)

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
    Brown          Dave           1234        500.00      01/01/2001
    Brown          Dave           1234        300.00      NULL
    Smith          Frank          4321        123.00      01/01/2001
    Smith          Frank          4321        456.00      NULL

I need to get the combined total like in the first example, using the date that isnt null.

Example of desired results.

    FAMILYNAME-----FIRSTNAME------NUMBER------COMBINEDTOTAL----DATE
    Brown          Dave           1234        800.00           01/01/2001
    Smith          Frank          4321        579.00           01/01/2001

Can anyone tell me what I need to do here? Cheers.",sql,oracle,group-by,union-all,,,open,0,744,4,"SQL group by query I have a a UNION ALL on two result sets. This results in some like below.

TOTALSTABLE

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL
    Brown          Dave           1234        500.00
    Brown          Dave           1234        300.00
    Smith          Frank          4321        123.00
    Smith          Frank          4321        456.00

I run the following query...

    SELECT TOTALSTABLE.FAMILYNAME,
      TOTALSTABLE.FIRSTNAME,
      TOTALSTABLE.NUMBER,
      SUM(TOTALSTABLE.TOTAL) COMBINEDTOTAL
    FROM TOTALSTABLE
    GROUP BY TOTALSTABLE.FAMILYNAME,
      TOTALSTABLE.FIRSTNAME,
      TOTALSTABLE.NUMBER

Which gives me something like...

    FAMILYNAME-----FIRSTNAME------NUMBER------COMBINEDTOTAL
    Brown          Dave           1234        800.00
    Smith          Frank          4321        579.00

This is what i need. However I need to add an additional column which is null in the result i am attempting to do a UNION ALL on.

Example:

T1

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
    Brown          Dave           1234        500.00      01/01/2001
    Smith          Frank          4321        123.00      01/01/2001

T2

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
    Brown          Dave           1234        300.00      NULL
    Smith          Frank          4321        456.00      NULL

COMBINED (UNION ALL)

    FAMILYNAME-----FIRSTNAME------NUMBER------TOTAL-------DATE
    Brown          Dave           1234        500.00      01/01/2001
    Brown          Dave           1234        300.00      NULL
    Smith          Frank          4321        123.00      01/01/2001
    Smith          Frank          4321        456.00      NULL

I need to get the combined total like in the first example, using the date that isnt null.

Example of desired results.

    FAMILYNAME-----FIRSTNAME------NUMBER------COMBINEDTOTAL----DATE
    Brown          Dave           1234        800.00           01/01/2001
    Smith          Frank          4321        579.00           01/01/2001

Can anyone tell me what I need to do here? Cheers.",4
11299217,07/02/2012 18:31:41,1132642,01/05/2012 16:40:10,949,66,"How can I optimize this SQL query? It runs too slowly, and I already optimized it! (Introduction to Indexes)","(This is designed to foster canonical answers to common SQL problems or questions.)

I have a query which runs more slowly than I would like. The query is correct already, and I have refactored it, but I cannot get it to run quickly enough. The predicates are already Sarg-able where possible (If you don’t know what that means, see here: http://stackoverflow.com/questions/799584/what-makes-a-sql-statement-sargable) It is already properly using joins, requests no extra tables, and does not unnecessarily replicate rows or use nested subqueries in ways that would slow it down. (Or, I know what I am doing with the query, and it needs to be like this.)

I’m not a DBA, and I don’t already know how to pick a good index to make my query faster. I can alter the table structures; there is no DBA in charge of the database, and I have the permissions on the database server to do so.  (If either of these is not true, this is the wrong thing to do on your own. Talk to your DBA or sysadmin. If you are not the only user, this may affect others.)

If I need the type of help that would require a significant amount of knowledge about the database structure, or using anything more complex than vanilla indexes, I should try asking at http://dba.stackoverflow.com, instead of here.
",sql,indexing,,,,07/02/2012 19:06:16,not a real question,1,220,19,"How can I optimize this SQL query? It runs too slowly, and I already optimized it! (Introduction to Indexes) (This is designed to foster canonical answers to common SQL problems or questions.)

I have a query which runs more slowly than I would like. The query is correct already, and I have refactored it, but I cannot get it to run quickly enough. The predicates are already Sarg-able where possible (If you don’t know what that means, see here: http://stackoverflow.com/questions/799584/what-makes-a-sql-statement-sargable) It is already properly using joins, requests no extra tables, and does not unnecessarily replicate rows or use nested subqueries in ways that would slow it down. (Or, I know what I am doing with the query, and it needs to be like this.)

I’m not a DBA, and I don’t already know how to pick a good index to make my query faster. I can alter the table structures; there is no DBA in charge of the database, and I have the permissions on the database server to do so.  (If either of these is not true, this is the wrong thing to do on your own. Talk to your DBA or sysadmin. If you are not the only user, this may affect others.)

If I need the type of help that would require a significant amount of knowledge about the database structure, or using anything more complex than vanilla indexes, I should try asking at http://dba.stackoverflow.com, instead of here.
",2
3561990,08/25/2010 00:18:18,195125,10/23/2009 07:15:02,80,2,How can I optimize a query that does an ORDER BY on a derived column in MySQL?,"I am having trouble optimizing a relatively simple query involving a GROUP BY, ORDER BY, and LIMIT.  The table has just over 300,000 records.  Here's the schema (I added some extra indexes to experiment with):

    CREATE TABLE `scrape_search_results` (
      `id` int(11) NOT NULL auto_increment,
      `creative_id` int(11) NOT NULL,
      `url_id` int(11) NOT NULL,
      `access_date` datetime NOT NULL,
      PRIMARY KEY  (`id`),
      KEY `creative_url_index` (`creative_id`,`url_id`),
      KEY `access_date_index` (`access_date`),
      KEY `access_date_creative_id_index` (`access_date`,`creative_id`),
      KEY `creative_id_access_date_index` (`creative_id`,`access_date`),
      KEY `test_index` USING HASH (`creative_id`)
    ) ENGINE=MyISAM AUTO_INCREMENT=4252725 DEFAULT CHARSET=latin1

In the table, a single creative_id may appear multiple (hundreds) of times.  The query I am trying to answer is a relatively simple one; give me the first 20 `creative_id`s ordered by `access_date`.  Here's my SQL:

    SELECT `ScrapeSearchResult`.`creative_id`, 
            MAX(`ScrapeSearchResult`.`access_date`) AS `latest_access_date` 
    FROM `scrape_search_results` AS `ScrapeSearchResult` 
    WHERE 1 = 1 
    GROUP BY `ScrapeSearchResult`.`creative_id` 
    ORDER BY `latest_access_date` DESC 
    LIMIT 20;

Here's the results of executing this query, where we see the 20th largest `access_date` is 2010-08-23 11:03:25:

    +-------------+---------------------+
    | creative_id | latest_access_date  |
    +-------------+---------------------+
    |         550 | 2010-08-23 11:07:49 | 
    |        4568 | 2010-08-23 11:07:49 | 
    |         552 | 2010-08-23 11:07:49 | 
    |        2109 | 2010-08-23 11:07:49 | 
    |        5221 | 2010-08-23 11:07:49 | 
    |        1544 | 2010-08-23 11:07:49 | 
    |        1697 | 2010-08-23 11:07:49 | 
    |         554 | 2010-08-23 11:07:12 | 
    |         932 | 2010-08-23 11:05:48 | 
    |       11029 | 2010-08-23 11:05:37 | 
    |       11854 | 2010-08-23 11:05:27 | 
    |       11856 | 2010-08-23 11:05:05 | 
    |         702 | 2010-08-23 11:03:56 | 
    |        4319 | 2010-08-23 11:03:56 | 
    |        7159 | 2010-08-23 11:03:56 | 
    |       10610 | 2010-08-23 11:03:46 | 
    |        5540 | 2010-08-23 11:03:46 | 
    |           1 | 2010-08-23 11:03:46 | 
    |       11942 | 2010-08-23 11:03:35 | 
    |        7900 | 2010-08-23 11:03:25 | 
    +-------------+---------------------+

If I was going to write this algorithm by hand, I would build a b-tree ordered on (`access_date`, `creative_id`).  I'd start at the `MAX(access_date)` and keep walking the tree until I found 20 unique `creative_id`s, which I would then return in the order I found them in.

Using that algorithm, I would need to consider just 94 rows (there are 94 rows for which `access_date >= 2010-08-23 11:03:25`, which is our 20th largest `access_date` as shown above).

However, MySQL decides to use `creative_url_index` when answering this query, which I don't understand.  It considers over 10,000 rows when doing this.

    ANALYZE TABLE scrape_search_results;
    SELECT ...;
    +----+-------------+--------------------+-------+---------------+--------------------+---------+------+-------+---------------------------------+
    | id | select_type | table              | type  | possible_keys | key                | key_len | ref  | rows  | Extra                           |
    +----+-------------+--------------------+-------+---------------+--------------------+---------+------+-------+---------------------------------+
    |  1 | SIMPLE      | ScrapeSearchResult | index | NULL          | creative_url_index | 8       | NULL | 10687 | Using temporary; Using filesort | 
    +----+-------------+--------------------+-------+---------------+--------------------+---------+------+-------+---------------------------------+


Is my trouble that I am performing an ORDER BY on the derived-column `MAX(access_date)`?  If so, how can I optimize my query to perform more in-line with my expectations?",sql,database,mysql,query,,,open,0,894,17,"How can I optimize a query that does an ORDER BY on a derived column in MySQL? I am having trouble optimizing a relatively simple query involving a GROUP BY, ORDER BY, and LIMIT.  The table has just over 300,000 records.  Here's the schema (I added some extra indexes to experiment with):

    CREATE TABLE `scrape_search_results` (
      `id` int(11) NOT NULL auto_increment,
      `creative_id` int(11) NOT NULL,
      `url_id` int(11) NOT NULL,
      `access_date` datetime NOT NULL,
      PRIMARY KEY  (`id`),
      KEY `creative_url_index` (`creative_id`,`url_id`),
      KEY `access_date_index` (`access_date`),
      KEY `access_date_creative_id_index` (`access_date`,`creative_id`),
      KEY `creative_id_access_date_index` (`creative_id`,`access_date`),
      KEY `test_index` USING HASH (`creative_id`)
    ) ENGINE=MyISAM AUTO_INCREMENT=4252725 DEFAULT CHARSET=latin1

In the table, a single creative_id may appear multiple (hundreds) of times.  The query I am trying to answer is a relatively simple one; give me the first 20 `creative_id`s ordered by `access_date`.  Here's my SQL:

    SELECT `ScrapeSearchResult`.`creative_id`, 
            MAX(`ScrapeSearchResult`.`access_date`) AS `latest_access_date` 
    FROM `scrape_search_results` AS `ScrapeSearchResult` 
    WHERE 1 = 1 
    GROUP BY `ScrapeSearchResult`.`creative_id` 
    ORDER BY `latest_access_date` DESC 
    LIMIT 20;

Here's the results of executing this query, where we see the 20th largest `access_date` is 2010-08-23 11:03:25:

    +-------------+---------------------+
    | creative_id | latest_access_date  |
    +-------------+---------------------+
    |         550 | 2010-08-23 11:07:49 | 
    |        4568 | 2010-08-23 11:07:49 | 
    |         552 | 2010-08-23 11:07:49 | 
    |        2109 | 2010-08-23 11:07:49 | 
    |        5221 | 2010-08-23 11:07:49 | 
    |        1544 | 2010-08-23 11:07:49 | 
    |        1697 | 2010-08-23 11:07:49 | 
    |         554 | 2010-08-23 11:07:12 | 
    |         932 | 2010-08-23 11:05:48 | 
    |       11029 | 2010-08-23 11:05:37 | 
    |       11854 | 2010-08-23 11:05:27 | 
    |       11856 | 2010-08-23 11:05:05 | 
    |         702 | 2010-08-23 11:03:56 | 
    |        4319 | 2010-08-23 11:03:56 | 
    |        7159 | 2010-08-23 11:03:56 | 
    |       10610 | 2010-08-23 11:03:46 | 
    |        5540 | 2010-08-23 11:03:46 | 
    |           1 | 2010-08-23 11:03:46 | 
    |       11942 | 2010-08-23 11:03:35 | 
    |        7900 | 2010-08-23 11:03:25 | 
    +-------------+---------------------+

If I was going to write this algorithm by hand, I would build a b-tree ordered on (`access_date`, `creative_id`).  I'd start at the `MAX(access_date)` and keep walking the tree until I found 20 unique `creative_id`s, which I would then return in the order I found them in.

Using that algorithm, I would need to consider just 94 rows (there are 94 rows for which `access_date >= 2010-08-23 11:03:25`, which is our 20th largest `access_date` as shown above).

However, MySQL decides to use `creative_url_index` when answering this query, which I don't understand.  It considers over 10,000 rows when doing this.

    ANALYZE TABLE scrape_search_results;
    SELECT ...;
    +----+-------------+--------------------+-------+---------------+--------------------+---------+------+-------+---------------------------------+
    | id | select_type | table              | type  | possible_keys | key                | key_len | ref  | rows  | Extra                           |
    +----+-------------+--------------------+-------+---------------+--------------------+---------+------+-------+---------------------------------+
    |  1 | SIMPLE      | ScrapeSearchResult | index | NULL          | creative_url_index | 8       | NULL | 10687 | Using temporary; Using filesort | 
    +----+-------------+--------------------+-------+---------------+--------------------+---------+------+-------+---------------------------------+


Is my trouble that I am performing an ORDER BY on the derived-column `MAX(access_date)`?  If so, how can I optimize my query to perform more in-line with my expectations?",4
7872131,10/24/2011 06:50:11,878077,08/04/2011 07:35:06,85,1,intresting SQL query,"I have this data in my table:

    onum	amt		    odate				        cnum	snum

    3001	18,69		1990-03-10 00:00:00.000		2008	1007
    3002	1900,10		1990-03-10 00:00:00.000		2007	1004
    3003	767,19		1990-03-10 00:00:00.000		2001	1001
    3005	5160,45		1990-03-10 00:00:00.000		2003	1002
    3006	1098,16		1990-03-10 00:00:00.000		2008	1007
    3007	75,75		1990-03-10 00:00:00.000		2004	1002
    3008	4723,00		1990-05-10 00:00:00.000		2006	1001
    3009	1713,23		1990-04-10 00:00:00.000		2002	1003
    3010	1309,95		1990-06-10 00:00:00.000		2004	1002
    3011	9891,88		1990-06-10 00:00:00.000		2006	1001

I need get this result:

    amt         odate                       snum

    5160,45		1990-03-10 00:00:00.000		1002
    4723,00		1990-05-10 00:00:00.000		1001
    9891,88		1990-06-10 00:00:00.000		1001
    

that is I select the max **amt** on the each day **odate**, but with displaying of seller **snum**

if I write this:
 

     SELECT MAX(amt), odate, snum FROM [Understanding].[dbo].[Orders] GROUP BY odate, snum
the output is wrong because it displays the groups by days and sellers.",sql,tsql,,,,,open,0,179,3,"intresting SQL query I have this data in my table:

    onum	amt		    odate				        cnum	snum

    3001	18,69		1990-03-10 00:00:00.000		2008	1007
    3002	1900,10		1990-03-10 00:00:00.000		2007	1004
    3003	767,19		1990-03-10 00:00:00.000		2001	1001
    3005	5160,45		1990-03-10 00:00:00.000		2003	1002
    3006	1098,16		1990-03-10 00:00:00.000		2008	1007
    3007	75,75		1990-03-10 00:00:00.000		2004	1002
    3008	4723,00		1990-05-10 00:00:00.000		2006	1001
    3009	1713,23		1990-04-10 00:00:00.000		2002	1003
    3010	1309,95		1990-06-10 00:00:00.000		2004	1002
    3011	9891,88		1990-06-10 00:00:00.000		2006	1001

I need get this result:

    amt         odate                       snum

    5160,45		1990-03-10 00:00:00.000		1002
    4723,00		1990-05-10 00:00:00.000		1001
    9891,88		1990-06-10 00:00:00.000		1001
    

that is I select the max **amt** on the each day **odate**, but with displaying of seller **snum**

if I write this:
 

     SELECT MAX(amt), odate, snum FROM [Understanding].[dbo].[Orders] GROUP BY odate, snum
the output is wrong because it displays the groups by days and sellers.",2
1886732,12/11/2009 09:00:55,189247,10/13/2009 16:26:52,33,3,Efficient query to lookup stuff in a word index,"I have two tables defined like this:

    Page(id), Index(page_id, word)

page_id in Index is a foreign key to Page so that each Page is
connected to a group of Index entries. The Index table is a index for
the Page table so that you can do fast text searching. E.g:

    SELECT page_id FROM Index where word = 'hello'

Would select all page_id's for all pages containing the word
'hello'. But now I want to select all page_id's for pages that contain
all of the words 'word1', 'word2' and 'word3'. The best query I can
come up with for this is:

    SELECT page_id
    FROM Index
    WHERE word IN ('word1', 'word2', 'word3')
    GROUP BY page_id
    HAVING COUNT(1) = 3;

It works, but I wonder if someone can think of an alternative more
efficient query?
",sql,indexing,full-text-search,,,,open,0,144,9,"Efficient query to lookup stuff in a word index I have two tables defined like this:

    Page(id), Index(page_id, word)

page_id in Index is a foreign key to Page so that each Page is
connected to a group of Index entries. The Index table is a index for
the Page table so that you can do fast text searching. E.g:

    SELECT page_id FROM Index where word = 'hello'

Would select all page_id's for all pages containing the word
'hello'. But now I want to select all page_id's for pages that contain
all of the words 'word1', 'word2' and 'word3'. The best query I can
come up with for this is:

    SELECT page_id
    FROM Index
    WHERE word IN ('word1', 'word2', 'word3')
    GROUP BY page_id
    HAVING COUNT(1) = 3;

It works, but I wonder if someone can think of an alternative more
efficient query?
",3
11714011,07/30/2012 00:01:01,1561673,07/29/2012 23:53:53,1,0,SQL SELECT FROM Two,"TABLE1

ID    |     DATE  
 a    |   10-06-2012    |   
 b    |   07-07-2012    |   
 c    |   10-06-2012    |   
 
TABLE2

ID    |  COST  |  
 a    |   3    |  
 b    |   4    |  
 c    |   4    | 

I have two Tables and I would like to search the DATE e.g. 10-06-2012 and return the total COST for that DATE being 7.

ID is common in both tables.",sql,query,,,,07/31/2012 07:02:29,not a real question,1,137,4,"SQL SELECT FROM Two TABLE1

ID    |     DATE  
 a    |   10-06-2012    |   
 b    |   07-07-2012    |   
 c    |   10-06-2012    |   
 
TABLE2

ID    |  COST  |  
 a    |   3    |  
 b    |   4    |  
 c    |   4    | 

I have two Tables and I would like to search the DATE e.g. 10-06-2012 and return the total COST for that DATE being 7.

ID is common in both tables.",2
8054884,11/08/2011 17:51:02,1020241,10/29/2011 23:26:57,11,1,SQL server retriev data from table,"TABLE
: Customer 
KEY
:- CustomerID 
Other 
columns: Name, age, etc TABLE
: Customer_address 
Keys
: AddrerssID, CustomerID 
Other 
columns: Street, city, STATE, etc /*Please give me ALL customers.
I also want to see the customer address if the state = FL. Only create one SQL statement. 
The SQL below starts this way. Please fill in the rest.--------------------------------------------------------------- */
",sql,sql-server-2005,,,,11/09/2011 16:08:46,not a real question,1,54,6,"SQL server retriev data from table TABLE
: Customer 
KEY
:- CustomerID 
Other 
columns: Name, age, etc TABLE
: Customer_address 
Keys
: AddrerssID, CustomerID 
Other 
columns: Street, city, STATE, etc /*Please give me ALL customers.
I also want to see the customer address if the state = FL. Only create one SQL statement. 
The SQL below starts this way. Please fill in the rest.--------------------------------------------------------------- */
",2
4491503,12/20/2010 16:16:30,543509,12/15/2010 15:04:59,12,0,PROBLEM IN CREATING TWO IDENTICAL COLUMN IN A SINGLE TABLE,"I am having a problem in creating two identical columns in a single table. This is my part of job... They need two identity columns in a single table at  any cost. Is there any way to do this. 

Please provide any syntaxs for creating two identitical columns in a single table at a time or later also.



Thanks in Advance,
Shashra",sql,mysql,sql-server,sql-server-2005,mysql-query,,open,0,61,10,"PROBLEM IN CREATING TWO IDENTICAL COLUMN IN A SINGLE TABLE I am having a problem in creating two identical columns in a single table. This is my part of job... They need two identity columns in a single table at  any cost. Is there any way to do this. 

Please provide any syntaxs for creating two identitical columns in a single table at a time or later also.



Thanks in Advance,
Shashra",5
7599224,09/29/2011 14:54:39,935224,09/08/2011 15:57:03,1,0,SQL find query that excludes row if it contains a value,"For example:

Say I have some people who rent boats. I want to to find a query that would only return people who have rented a red boat but not a green boat. If they have ever rented a green boat I do not want them returned but they could have rented a red and blue boat.",sql,,,,,09/29/2011 14:59:31,not a real question,1,56,11,"SQL find query that excludes row if it contains a value For example:

Say I have some people who rent boats. I want to to find a query that would only return people who have rented a red boat but not a green boat. If they have ever rented a green boat I do not want them returned but they could have rented a red and blue boat.",1
4920114,02/07/2011 10:20:04,391455,07/14/2010 10:41:15,150,1,GUID / UUID for this scenario?  Or compound key?  Or other..,"I'm currently working on a system that in some cases will need to run on a local database during the day, and then replicated to a central server during the night.  It *cannot* all run from one central database as the local sites are out of contact with it periodically.  The data at the central server is for viewing and reporting only at head office, so nothing needs to be reverse replicated back to the site.

Each ""site"" is given a text based unique key (human generated).  However, the thought of making every table in the database design reference the site key is not appealing.

Here's an example of a very cut back version of the schema *without* worrying about remote replication (which will work fine for the majority of clients) : -

(I'll only show the history table for the Area table, to keep things short) :

    [Site]
    SiteKey [PK] (Gauranteed 100% unique across all sites text based key)
    
    [User]
    SiteKey [FK -> Site]
    UserID [PK]
    
    [Area]
    SiteKey [FK -> Site]
    AreaID [PK]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [AreaHistory]
    Site [FK -> Site]
    AreaID [FK -> Area]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    AuditedDtm
    
    [Location]
    AreaID [FK -> Area]
    LocationID [PK]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [Sensor]
    LocationID [PK / FK -> Location]
    SensorNo [PK]
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [Reading]
    LocationID [PK / FK -> Sensor]
    SensorNo [PK / FK -> Sensor]
    ReadingDtm [PK]

Which is fine, until I come to ""merge"" the database with the database at the central server.  I'm obviously going to get clashes in the Location table because I'm mixing data with ID's generated at other sites.

The first way I thought around this problem was to do this:

gs short) :

    [Location]
    SiteKey [FK -> Location, FK -> User] ** ADDED THIS
    AreaID [FK -> Area]
    LocationID [PK]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [Sensor]
    SiteKey [FK -> Location, FK -> User] ** ADDED THIS
    LocationID [PK / FK -> Location]
    SensorNo [PK]
    UpdatedDtm
    UpdatedUserID [FK -> User]

    [Reading]
    SiteKey [FK -> Sensor] ** ADDED THIS
    LocationID [PK / FK -> Sensor]
    SensorNo [PK / FK -> Sensor]
    ReadingDtm [PK]

Basically, every table gets a SiteKey making each row unique to the site.

An alternative is this (using UUIDs in some places) : -

    [User]
    SiteKey [FK -> Site]
    UserUUID [PK]
    
    [Area]
    SiteKey [FK -> Site]
    AreaUUID [PK]
    Description
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    
    [AreaHistory]
    Site [FK -> Site]
    AreaUUID [FK -> Area]
    Description
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    AuditedDtm
    
    [Location]
    AreaUUID [FK -> Area]
    LocationUUID [PK]
    Description
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    
    [Sensor]
    LocationUUID [PK / FK -> Location]
    SensorNo [PK]
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    
    [Reading]
    LocationUUID [PK / FK -> Sensor]
    SensorNo [PK / FK -> Sensor]
    ReadingDtm [PK]

Remember this is cut down, but it illustrates the problem.

Are there any alternatives I may be missing?  I thought about ID remapping but that seemed to introduce new even worse nightmares.

The annoying part of this is that it's a very small number of cases that use this scenario, the rest are happy with one database serving many sites.  However, the client wanting this scenario is the biggest ;-)

I thought maybe I could use UUID just for them, but that means creating exceptions everywhere so may as well just use them throughout (where neccessary) if I'm going to use them.

If it makes any difference, I'm using PostgreSQL.

PS, [this][1] discussion may be relevant to this case.  I just keep wondering if there's another way considering I have a nice gauranteed unique SiteKey.


  [1]: http://stackoverflow.com/questions/45399/advantages-and-disadvantages-of-guid-uuid-database-keys",sql,database,database-design,postgresql,relational-database,,open,0,886,13,"GUID / UUID for this scenario?  Or compound key?  Or other.. I'm currently working on a system that in some cases will need to run on a local database during the day, and then replicated to a central server during the night.  It *cannot* all run from one central database as the local sites are out of contact with it periodically.  The data at the central server is for viewing and reporting only at head office, so nothing needs to be reverse replicated back to the site.

Each ""site"" is given a text based unique key (human generated).  However, the thought of making every table in the database design reference the site key is not appealing.

Here's an example of a very cut back version of the schema *without* worrying about remote replication (which will work fine for the majority of clients) : -

(I'll only show the history table for the Area table, to keep things short) :

    [Site]
    SiteKey [PK] (Gauranteed 100% unique across all sites text based key)
    
    [User]
    SiteKey [FK -> Site]
    UserID [PK]
    
    [Area]
    SiteKey [FK -> Site]
    AreaID [PK]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [AreaHistory]
    Site [FK -> Site]
    AreaID [FK -> Area]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    AuditedDtm
    
    [Location]
    AreaID [FK -> Area]
    LocationID [PK]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [Sensor]
    LocationID [PK / FK -> Location]
    SensorNo [PK]
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [Reading]
    LocationID [PK / FK -> Sensor]
    SensorNo [PK / FK -> Sensor]
    ReadingDtm [PK]

Which is fine, until I come to ""merge"" the database with the database at the central server.  I'm obviously going to get clashes in the Location table because I'm mixing data with ID's generated at other sites.

The first way I thought around this problem was to do this:

gs short) :

    [Location]
    SiteKey [FK -> Location, FK -> User] ** ADDED THIS
    AreaID [FK -> Area]
    LocationID [PK]
    Description
    UpdatedDtm
    UpdatedUserID [FK -> User]
    
    [Sensor]
    SiteKey [FK -> Location, FK -> User] ** ADDED THIS
    LocationID [PK / FK -> Location]
    SensorNo [PK]
    UpdatedDtm
    UpdatedUserID [FK -> User]

    [Reading]
    SiteKey [FK -> Sensor] ** ADDED THIS
    LocationID [PK / FK -> Sensor]
    SensorNo [PK / FK -> Sensor]
    ReadingDtm [PK]

Basically, every table gets a SiteKey making each row unique to the site.

An alternative is this (using UUIDs in some places) : -

    [User]
    SiteKey [FK -> Site]
    UserUUID [PK]
    
    [Area]
    SiteKey [FK -> Site]
    AreaUUID [PK]
    Description
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    
    [AreaHistory]
    Site [FK -> Site]
    AreaUUID [FK -> Area]
    Description
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    AuditedDtm
    
    [Location]
    AreaUUID [FK -> Area]
    LocationUUID [PK]
    Description
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    
    [Sensor]
    LocationUUID [PK / FK -> Location]
    SensorNo [PK]
    UpdatedDtm
    UpdatedUserUUID [FK -> User]
    
    [Reading]
    LocationUUID [PK / FK -> Sensor]
    SensorNo [PK / FK -> Sensor]
    ReadingDtm [PK]

Remember this is cut down, but it illustrates the problem.

Are there any alternatives I may be missing?  I thought about ID remapping but that seemed to introduce new even worse nightmares.

The annoying part of this is that it's a very small number of cases that use this scenario, the rest are happy with one database serving many sites.  However, the client wanting this scenario is the biggest ;-)

I thought maybe I could use UUID just for them, but that means creating exceptions everywhere so may as well just use them throughout (where neccessary) if I'm going to use them.

If it makes any difference, I'm using PostgreSQL.

PS, [this][1] discussion may be relevant to this case.  I just keep wondering if there's another way considering I have a nice gauranteed unique SiteKey.


  [1]: http://stackoverflow.com/questions/45399/advantages-and-disadvantages-of-guid-uuid-database-keys",5
9787542,03/20/2012 13:17:26,1280952,03/20/2012 13:05:45,1,0,Using Acces as front end of MS SQL server,"How can I create a form that has an insert, update and a delete button for a set of records in the sever?",sql,sql-server,,,,03/20/2012 13:21:16,not constructive,1,23,9,"Using Acces as front end of MS SQL server How can I create a form that has an insert, update and a delete button for a set of records in the sever?",2
7430429,09/15/2011 11:58:33,946716,09/15/2011 11:58:33,1,0,Sql Query for below problem,"i have one table having data as mentioned below:

  **Name**
  ram
  ram
  ram
  sita
  sita
  sita
now i need out put like below:
ram
sita
ram
sita
ram
sita

is any one know the answer?

",sql,sql-server,oracle,sql-server-2008,,09/15/2011 13:01:28,not a real question,1,34,5,"Sql Query for below problem i have one table having data as mentioned below:

  **Name**
  ram
  ram
  ram
  sita
  sita
  sita
now i need out put like below:
ram
sita
ram
sita
ram
sita

is any one know the answer?

",4
11582498,07/20/2012 15:34:24,1489373,06/28/2012 17:43:20,11,0,"Databases entering ""In recovery"" mode on restore","I am facing an issue while restoring the database. 

I have many dump files in a folder and I try to restore them one by one to a database xyz, perform some update operation and continue my restore operation with the other dumps. During this restore operation all the other databases are entering the state of In Recovery . Also the database xyz is also entering the state of recovery and my restore operation fails for the 2nd dump saying the ""Not able to achieve exclusive lock on the xyz"" . 

I am on MS SQL Server 2008 R2.     

So how can I solve this issue please suggest.",sql,sql-server,sql-server-2008,microsoft,,07/20/2012 23:18:02,off topic,1,112,7,"Databases entering ""In recovery"" mode on restore I am facing an issue while restoring the database. 

I have many dump files in a folder and I try to restore them one by one to a database xyz, perform some update operation and continue my restore operation with the other dumps. During this restore operation all the other databases are entering the state of In Recovery . Also the database xyz is also entering the state of recovery and my restore operation fails for the 2nd dump saying the ""Not able to achieve exclusive lock on the xyz"" . 

I am on MS SQL Server 2008 R2.     

So how can I solve this issue please suggest.",4
2190155,02/03/2010 06:38:40,162381,08/25/2009 00:44:47,121,14,best way in producing a master script for SQL,"i want to extract specific database tables & stored procedures into one master script. Do you know any software that can help me do this faster? I've tried using the SQL Database publishing tool, but it's not that efficient since its gathering tables that I didn't select.",sql,sql-server-2005,tsql,,,,open,0,47,9,"best way in producing a master script for SQL i want to extract specific database tables & stored procedures into one master script. Do you know any software that can help me do this faster? I've tried using the SQL Database publishing tool, but it's not that efficient since its gathering tables that I didn't select.",3
10071389,04/09/2012 09:35:13,1307947,04/02/2012 11:55:30,1,0,Query to select fifth highest salary from table?,How to select fifth highest salary from table in SQL ?,sql,,,,,04/09/2012 09:41:09,not a real question,1,11,8,Query to select fifth highest salary from table? How to select fifth highest salary from table in SQL ?,1
3121686,06/25/2010 21:51:41,245878,01/07/2010 20:03:38,40,2,MSSQL 2008 hosting recommendations.,"I am currently working on a project that is hosted at GoDaddy and it has a large database.  (Periodically inserting millions of rows).  It keeps filling the transaction logs and since GoDaddy sets the SQL user up without permission to basically do anything, I cannot truncate it.  The 200mb database max is not ideal either.  A VPS isn't in the cards for this company just yet, so I am stuck trying to find a shared hosting provider that office MSSQL2008 only hosting.

Soooooo, my question is, does anyone know of a hosting company that does MSSQL2008 hosting that they can vouch for and give high marks?

Cheers guys & gals!",sql,database,hosting,shared-hosting,,06/26/2010 11:30:29,off topic,1,112,4,"MSSQL 2008 hosting recommendations. I am currently working on a project that is hosted at GoDaddy and it has a large database.  (Periodically inserting millions of rows).  It keeps filling the transaction logs and since GoDaddy sets the SQL user up without permission to basically do anything, I cannot truncate it.  The 200mb database max is not ideal either.  A VPS isn't in the cards for this company just yet, so I am stuck trying to find a shared hosting provider that office MSSQL2008 only hosting.

Soooooo, my question is, does anyone know of a hosting company that does MSSQL2008 hosting that they can vouch for and give high marks?

Cheers guys & gals!",4
8987171,01/24/2012 12:56:14,1044581,11/13/2011 20:42:38,63,0,How to work around or to remedy Error: Invalid Use of Null?,"
Good day everyone,


In this piece of MS Access Code I am trying to get the MAX Date of a Customer signup. First I have to convert the date so it can work with an aggregate function. Unfortunately there are areas in the date column that are null.

I am getting the error Invalid use of null due to some records missing dates.

How can I remedy that, is there a work around?

Here is the code:


    SELECT CUSTOMER.FIRST_NAME, 
    
    MAX(DateSerial(CInt(Left([CUSTOMER.SIGNUP_DATE],4)),CInt(Mid([CUSTOMER.SIGNUP_DATE],5,2)),CInt(Right([CUSTOMER.SIGNUP_DATE],2)))) AS SIGN_DATE, 
    
    (DateSerial(CInt(Left([CUSTOMER.LEAVE_DATE],4)),CInt(Mid([CUSTOMER.LEAVE_DATE],5,2)),CInt(Right([CUSTOMER.LEAVE_DATE],2)))) AS LEV_DATE
    
    FROM CUSTOMER
    
    WHERE ((DateSerial(CInt(Left([CUSTOMER.SIGNUP_DATE],4)),CInt(Mid([CUSTOMER.SIGNUP_DATE],5,2)),CInt(Right([CUSTOMER.SIGNUP_DATE],2)))) <=Date())
    
    AND
    
    ((DateSerial(CInt(Left([CUSTOMER.LEAVE_DATE],4)),CInt(Mid([CUSTOMER.LEAVE_DATE],5,2)),CInt(Right([CUSTOMER.LEAVE_DATE],2)))) =#012/31/2012#)
    
    GROUP BY
    
    CUSTOMER.FIRST_NAME,
    
    CUSTOMER.SIGNUP_DATE,
    
    CUSTOMER.LEAVE_DATE;


Thanks for looking!


Guy",sql,ms-access-2007,,,,,open,0,171,12,"How to work around or to remedy Error: Invalid Use of Null? 
Good day everyone,


In this piece of MS Access Code I am trying to get the MAX Date of a Customer signup. First I have to convert the date so it can work with an aggregate function. Unfortunately there are areas in the date column that are null.

I am getting the error Invalid use of null due to some records missing dates.

How can I remedy that, is there a work around?

Here is the code:


    SELECT CUSTOMER.FIRST_NAME, 
    
    MAX(DateSerial(CInt(Left([CUSTOMER.SIGNUP_DATE],4)),CInt(Mid([CUSTOMER.SIGNUP_DATE],5,2)),CInt(Right([CUSTOMER.SIGNUP_DATE],2)))) AS SIGN_DATE, 
    
    (DateSerial(CInt(Left([CUSTOMER.LEAVE_DATE],4)),CInt(Mid([CUSTOMER.LEAVE_DATE],5,2)),CInt(Right([CUSTOMER.LEAVE_DATE],2)))) AS LEV_DATE
    
    FROM CUSTOMER
    
    WHERE ((DateSerial(CInt(Left([CUSTOMER.SIGNUP_DATE],4)),CInt(Mid([CUSTOMER.SIGNUP_DATE],5,2)),CInt(Right([CUSTOMER.SIGNUP_DATE],2)))) <=Date())
    
    AND
    
    ((DateSerial(CInt(Left([CUSTOMER.LEAVE_DATE],4)),CInt(Mid([CUSTOMER.LEAVE_DATE],5,2)),CInt(Right([CUSTOMER.LEAVE_DATE],2)))) =#012/31/2012#)
    
    GROUP BY
    
    CUSTOMER.FIRST_NAME,
    
    CUSTOMER.SIGNUP_DATE,
    
    CUSTOMER.LEAVE_DATE;


Thanks for looking!


Guy",2
7172311,08/24/2011 08:05:48,909166,08/24/2011 08:05:48,1,0,Sql server Left outer join VS. Left inner join? ;-),"I just need somebody to answer the above question?
Thank you
",sql,server,join,left,outer,08/24/2011 08:26:36,not a real question,1,10,10,"Sql server Left outer join VS. Left inner join? ;-) I just need somebody to answer the above question?
Thank you
",5
11032311,06/14/2012 11:40:49,1448837,06/11/2012 11:31:25,1,1,Converting Sql query (update table set ....) to linq ( var m = ...),"I am trying to write a linq query in my Database.cs file. I find it difficult. Is there any tool to convert sql to linq? I tried linqer but it is no good. Or could you help me in writing the following query in linq.

    update table set field1='R', field2='"" + DateTime.Now.ToString(""MM/dd/yyyy hh:mm:ss"") + ""', field3 = '"" + util.CleanStringInput(value1) + ""' where field1 = 'P' and field3 = '"" + value2 + ""' and field4 = (select max(field5) from table2 where field6='"" + value2 + ""')

Thanks.

Have a good day.
",sql,linq,,,,,open,0,93,14,"Converting Sql query (update table set ....) to linq ( var m = ...) I am trying to write a linq query in my Database.cs file. I find it difficult. Is there any tool to convert sql to linq? I tried linqer but it is no good. Or could you help me in writing the following query in linq.

    update table set field1='R', field2='"" + DateTime.Now.ToString(""MM/dd/yyyy hh:mm:ss"") + ""', field3 = '"" + util.CleanStringInput(value1) + ""' where field1 = 'P' and field3 = '"" + value2 + ""' and field4 = (select max(field5) from table2 where field6='"" + value2 + ""')

Thanks.

Have a good day.
",2
11701159,07/28/2012 12:48:47,1559529,07/28/2012 11:20:05,1,0,"how i can use next subset in summation(sum(k, c(j,k) * lambda((t+1),j,k)) =e= sum(k, (c(j,k)-g(j,k)))"," const(t,j).. sum(k, c(j,k) * lambda((t+1),j,k)) =e= sum(k, (c(j,k)-g(j,k))
****                                      $145$148,8,37,409

  8  ')' expected
 37  '=l=' or '=e=' or '=g=' operator expected
145  Set identifier or quoted element expected
148  Dimension different - The symbol is referenced with more/less
        indices as declared
409  Unrecognizable item - skip to find a new statement
       looking for a ';' or a key word to get started again

how can i fix these code part?
",sql,syntax,syntax-highlighting,syntax-error,ast,07/30/2012 15:15:56,not a real question,1,122,14,"how i can use next subset in summation(sum(k, c(j,k) * lambda((t+1),j,k)) =e= sum(k, (c(j,k)-g(j,k)))  const(t,j).. sum(k, c(j,k) * lambda((t+1),j,k)) =e= sum(k, (c(j,k)-g(j,k))
****                                      $145$148,8,37,409

  8  ')' expected
 37  '=l=' or '=e=' or '=g=' operator expected
145  Set identifier or quoted element expected
148  Dimension different - The symbol is referenced with more/less
        indices as declared
409  Unrecognizable item - skip to find a new statement
       looking for a ';' or a key word to get started again

how can i fix these code part?
",5
3031256,06/13/2010 05:58:56,141203,07/20/2009 06:45:18,403,7,SQL Query Help - Return row in table which relates to another table row with max(column),"I have two tables:

    Table1 = Schools
        Columns: id(PK), state(nvchar(100)), schoolname

    Table2 = Grades
        Columns: id(PK), id_schools(FK), Year, Reading, Writing...

I would like to develop a query to find the schoolname which has the highest grade for Reading.

So far I have the following and need help to fill in the blanks:

    SELECT Schools.schoolname, Grades.Reading
    FROM Schools, Grades
    WHERE Schools.id = (* need id_schools for max(Grades.Reading)*)
",sql,sql-server-2008,,,,,open,0,93,16,"SQL Query Help - Return row in table which relates to another table row with max(column) I have two tables:

    Table1 = Schools
        Columns: id(PK), state(nvchar(100)), schoolname

    Table2 = Grades
        Columns: id(PK), id_schools(FK), Year, Reading, Writing...

I would like to develop a query to find the schoolname which has the highest grade for Reading.

So far I have the following and need help to fill in the blanks:

    SELECT Schools.schoolname, Grades.Reading
    FROM Schools, Grades
    WHERE Schools.id = (* need id_schools for max(Grades.Reading)*)
",2
7533319,09/23/2011 18:29:12,961743,09/23/2011 18:19:34,1,0,Compare Two Tables with SQL,"I have two tables; one with records being recorded by operators, the other with data stored by the machines the operators are running to log down time of the machine. The data coming from the operators is one record minimum (sometimes more) per hour that the machines are operating. The data stored for downtime is a constant stream of data logging when the machines are down or when they are running. 

What I want to do is take the data from the operators and compare it with the down time system to make sure that the operators are taking their weights every hour that the machines are operational. To do this, I will need to simplify the data to one record per hour for each table and compare that there is a record for every hour on both.

My SQL knowledge isn't that broad so I don't even know if this is possible. I have tried counting items per hour and grouping data, but have not been able to successfully get them to work.

The tables reside on a Microsoft SQLExpress database.",sql,,,,,09/27/2011 03:37:47,not a real question,1,180,5,"Compare Two Tables with SQL I have two tables; one with records being recorded by operators, the other with data stored by the machines the operators are running to log down time of the machine. The data coming from the operators is one record minimum (sometimes more) per hour that the machines are operating. The data stored for downtime is a constant stream of data logging when the machines are down or when they are running. 

What I want to do is take the data from the operators and compare it with the down time system to make sure that the operators are taking their weights every hour that the machines are operational. To do this, I will need to simplify the data to one record per hour for each table and compare that there is a record for every hour on both.

My SQL knowledge isn't that broad so I don't even know if this is possible. I have tried counting items per hour and grouping data, but have not been able to successfully get them to work.

The tables reside on a Microsoft SQLExpress database.",1
8194933,11/19/2011 15:13:39,1030127,11/04/2011 17:08:02,1,0,"MCA With 1.7 Years Experience In ASP.NET,C#,SQL-2005,2008,WPF, Web Service,Window services,Ajax,WCF,Jquery,","How to install SQL server without copying setup files ?

can anyone help ? ",sql,sql-server-2008,server,,,11/19/2011 15:22:27,not a real question,1,14,10,"MCA With 1.7 Years Experience In ASP.NET,C#,SQL-2005,2008,WPF, Web Service,Window services,Ajax,WCF,Jquery, How to install SQL server without copying setup files ?

can anyone help ? ",3
3423243,08/06/2010 11:18:40,387423,07/09/2010 06:02:37,6,1,idea to write procedure?,"  i  pass parameter as productid, i check in productrelated table whether this product 
related product are there or not if it is not there i want to check sample productid in departmentreplated  table if it is not there i find the department of the productid and find the that productid related  department product..
   
 
 Plz help me how to write the store procedure.... 
 which logic i want to use....

help me writing procedure.... reply as soon as ...
thanks... ",sql,sql-server-2008,,,,08/07/2010 02:39:20,not a real question,1,87,4,"idea to write procedure?   i  pass parameter as productid, i check in productrelated table whether this product 
related product are there or not if it is not there i want to check sample productid in departmentreplated  table if it is not there i find the department of the productid and find the that productid related  department product..
   
 
 Plz help me how to write the store procedure.... 
 which logic i want to use....

help me writing procedure.... reply as soon as ...
thanks... ",2
8420929,12/07/2011 19:00:39,869721,07/29/2011 16:20:45,26,0,Hibernate IN Clause with a list of Composite Keys,"I am using DB2 (Version 9.01 DRIVER=4.3.85) and Hibernate and trying to invoke SELECT for a list of composite Keys.
I have an ArrayList<TableKeys> tableKeys containing the list of composite keys. I tried doing soemthing like this:

    String hql = ""from Table where tableKey IN (:tableKeys)"";
    Query query = em.createQuery(hql);
    query.setParameter(""tableKeys"", tableKeys);

Hibernate chokes at executing this SELECT with an error:

    ""SQL Error: SQLCODE=-104, SQLSTATE=42601 An unexpected token "","" was found"" 

The generated SQL looked like 

    select * from TABLE t0_ where (t0_.CK1, t0_.CK2, t0_.CK3) in ((?, ?, ?))

Since this query results in the same SQL error when I run this query directly in my SQL Editor, is this a known defect in Hibernate?
Any workarounds?

I noticed a similar problem reported at http://stackoverflow.com/questions/2714530/hibernate-criteria-db2-composite-keys-in-in-clause but inserting VALUES wouldnot work in my case.",sql,hibernate,db2,composite-key,,,open,0,144,9,"Hibernate IN Clause with a list of Composite Keys I am using DB2 (Version 9.01 DRIVER=4.3.85) and Hibernate and trying to invoke SELECT for a list of composite Keys.
I have an ArrayList<TableKeys> tableKeys containing the list of composite keys. I tried doing soemthing like this:

    String hql = ""from Table where tableKey IN (:tableKeys)"";
    Query query = em.createQuery(hql);
    query.setParameter(""tableKeys"", tableKeys);

Hibernate chokes at executing this SELECT with an error:

    ""SQL Error: SQLCODE=-104, SQLSTATE=42601 An unexpected token "","" was found"" 

The generated SQL looked like 

    select * from TABLE t0_ where (t0_.CK1, t0_.CK2, t0_.CK3) in ((?, ?, ?))

Since this query results in the same SQL error when I run this query directly in my SQL Editor, is this a known defect in Hibernate?
Any workarounds?

I noticed a similar problem reported at http://stackoverflow.com/questions/2714530/hibernate-criteria-db2-composite-keys-in-in-clause but inserting VALUES wouldnot work in my case.",4
4042712,10/28/2010 12:05:24,82037,03/24/2009 14:12:17,272,11,Aliasing a linked server?,"I have a server which I need to have as a linked server to another server, using sp_addLinkedServer.

My server's name is in the format ""DepartmentName.CompanyName.com"", which I can usually change to [blah.blah.com], but which I can't use in the SQL Server Management Studio View creator, because it keeps deleting my square brackets...

On the other hand, because the @srvproduct is SQL Server, I can't specify a name for the server to use, either, so I can't just call it ""DepartmentName"".

I seem to be in a bit of a catch-22 here. Any suggestions?",sql,sql-server,sql-server-2000,ssms,,,open,0,91,4,"Aliasing a linked server? I have a server which I need to have as a linked server to another server, using sp_addLinkedServer.

My server's name is in the format ""DepartmentName.CompanyName.com"", which I can usually change to [blah.blah.com], but which I can't use in the SQL Server Management Studio View creator, because it keeps deleting my square brackets...

On the other hand, because the @srvproduct is SQL Server, I can't specify a name for the server to use, either, so I can't just call it ""DepartmentName"".

I seem to be in a bit of a catch-22 here. Any suggestions?",4
1204563,07/30/2009 05:11:20,146841,07/29/2009 05:14:17,11,1,"How to update a table with a subquery, which is returning more rows?",Showing error while updating the table with subquery ie should not have more than one value. Please help me in this.,sql,,,,,07/30/2009 12:42:55,not a real question,1,21,13,"How to update a table with a subquery, which is returning more rows? Showing error while updating the table with subquery ie should not have more than one value. Please help me in this.",1
6899619,08/01/2011 14:07:24,824892,07/01/2011 12:48:44,1,0,SQL set vs select giving different results when using date/char,"I am having trouble converting/editing dates in MySQL, probably be easiest if I show my issue:


INPUT:

declare @from_dattim2 datetime

set @from_dattim2 = (select dateadd(day,-30,'2011-07-18'))

print @from_dattim2

OUTPUT:

Jun 18 2011 12:00AM

which makes sense, then...

INPUT:

declare @from_dattim2 datetime

set @from_dattim2 = (select dateadd(day,-30,'2011-07-18'))

print @from_dattim2

select convert (datetime, @from_dattim2, 121)

OUTPUT:

2011-06-18 00:00:00.000

This is the output I want however it doesn't seem to work when I try to set my variable:

INPUT:

declare @from_dattim2 datetime

set @from_dattim2 = (select dateadd(day,-30,'2011-07-18'))

set @from_dattim2 = convert (datetime, @from_dattim2, 121)

OUTPUT:

Jun 18 2011 12:00AM



Any ideas how I can set my variable to the format yyyy-mm-dd etc rather than Jun 18 etc?",sql,,,,,,open,0,91,10,"SQL set vs select giving different results when using date/char I am having trouble converting/editing dates in MySQL, probably be easiest if I show my issue:


INPUT:

declare @from_dattim2 datetime

set @from_dattim2 = (select dateadd(day,-30,'2011-07-18'))

print @from_dattim2

OUTPUT:

Jun 18 2011 12:00AM

which makes sense, then...

INPUT:

declare @from_dattim2 datetime

set @from_dattim2 = (select dateadd(day,-30,'2011-07-18'))

print @from_dattim2

select convert (datetime, @from_dattim2, 121)

OUTPUT:

2011-06-18 00:00:00.000

This is the output I want however it doesn't seem to work when I try to set my variable:

INPUT:

declare @from_dattim2 datetime

set @from_dattim2 = (select dateadd(day,-30,'2011-07-18'))

set @from_dattim2 = convert (datetime, @from_dattim2, 121)

OUTPUT:

Jun 18 2011 12:00AM



Any ideas how I can set my variable to the format yyyy-mm-dd etc rather than Jun 18 etc?",1
7882242,10/24/2011 21:29:48,284750,03/02/2010 20:32:09,99,6,Is this SQL the most efficient way,"We have a table that converts SAT scores into ACT scores using a year. if the data changes in the future we would add the new scores along with the year the scores change. We need to pass in a year and sat score and return the correct act score.

sample data with three rows would be

act sat year

28 1010 1998

29 1010 2012

30 1010 2015

If I pass in a SAT score of 1010 and a year of 2014 I should return an act score of 29 back.


I wrote the following SQL statement that works.  We are using Db2 is the reason for the FETCH FIRST ROW ONLY

select act, RANK() OVER(ORDER BY year DESC) from keessattbl where sat = 1010 and INT(year)<= 2014 FETCH FIRST ROW ONLY

Is this the most efficient way to handle this.

Thanks in advance Doug",sql,,,,,,open,0,137,7,"Is this SQL the most efficient way We have a table that converts SAT scores into ACT scores using a year. if the data changes in the future we would add the new scores along with the year the scores change. We need to pass in a year and sat score and return the correct act score.

sample data with three rows would be

act sat year

28 1010 1998

29 1010 2012

30 1010 2015

If I pass in a SAT score of 1010 and a year of 2014 I should return an act score of 29 back.


I wrote the following SQL statement that works.  We are using Db2 is the reason for the FETCH FIRST ROW ONLY

select act, RANK() OVER(ORDER BY year DESC) from keessattbl where sat = 1010 and INT(year)<= 2014 FETCH FIRST ROW ONLY

Is this the most efficient way to handle this.

Thanks in advance Doug",1
11605709,07/23/2012 02:20:28,280868,02/25/2010 03:03:00,41,0,Combine database partitions from separate disk drives,"I have SQL server Database partitions divided over two drives D: & E:

We are now moving the DB and the application for a new server and since there's more space on each individual disk drive, need to amalgamate the partitions onto 1 drive.  

how can I achieve this?",sql,sql-server,,,,07/24/2012 20:21:46,off topic,1,49,7,"Combine database partitions from separate disk drives I have SQL server Database partitions divided over two drives D: & E:

We are now moving the DB and the application for a new server and since there's more space on each individual disk drive, need to amalgamate the partitions onto 1 drive.  

how can I achieve this?",2
10545215,05/11/2012 03:53:07,1210760,02/15/2012 08:07:17,1,0,Datetime cast in MS SQL Server 2005,"Why select cast('''1900-01-01''' as datetime) failed in sqlserver 2005 ?
It's show error message : Conversion failed when converting datetime from character string.

Thanks.",sql,datetime,,,,05/11/2012 13:52:15,too localized,1,22,7,"Datetime cast in MS SQL Server 2005 Why select cast('''1900-01-01''' as datetime) failed in sqlserver 2005 ?
It's show error message : Conversion failed when converting datetime from character string.

Thanks.",2
7742872,10/12/2011 15:51:50,942982,09/13/2011 16:31:27,7,1,Good Sql Puzzle,"I have a Users table that contains dozens of columns like date of birth, year of vehicle owned, make and model of the vehicle, color and many other personal fields unrelated to the vehicle

There's also a 2nd table called Coupons that needs to be designed in a way to support a qualification like ""user qualifies if younger than 30 yrs old"", ""user qualifies if vehicle is greater than 10 yrs old"", ""user qualifies if vehicle color is green"".

When a user logs in, I need to present all coupons the user qualifies for. The problem that I'm having is that the coupon qualifications could be numerous, could have qualifiers like equal, greater than or less than and may have different combinations.

My only solution at this point is to store the actual sql string within one of the coupons table columns like 

    select * from Users where UserId = SOME_PLACEHOLDER and VehicleYear < 10

Then I could execute the sql for each coupon row and return true or false. Seems very inefficient as I would potentially have to execute 1000s of sql statements for each coupon code.

Any insight, help is appreciated. I do have server-side code where I could potentially be able to do looping. I use Entity Framework (4.1) on the server-side so the solution has to be able to be supported by EF 4.1. At a minimum, I'd like to hear any sql solution but hopefully one that is supported by EF 4.1.

Thank you.",sql,tsql,sql-server-2008,entity-framework-4.1,,,open,0,247,3,"Good Sql Puzzle I have a Users table that contains dozens of columns like date of birth, year of vehicle owned, make and model of the vehicle, color and many other personal fields unrelated to the vehicle

There's also a 2nd table called Coupons that needs to be designed in a way to support a qualification like ""user qualifies if younger than 30 yrs old"", ""user qualifies if vehicle is greater than 10 yrs old"", ""user qualifies if vehicle color is green"".

When a user logs in, I need to present all coupons the user qualifies for. The problem that I'm having is that the coupon qualifications could be numerous, could have qualifiers like equal, greater than or less than and may have different combinations.

My only solution at this point is to store the actual sql string within one of the coupons table columns like 

    select * from Users where UserId = SOME_PLACEHOLDER and VehicleYear < 10

Then I could execute the sql for each coupon row and return true or false. Seems very inefficient as I would potentially have to execute 1000s of sql statements for each coupon code.

Any insight, help is appreciated. I do have server-side code where I could potentially be able to do looping. I use Entity Framework (4.1) on the server-side so the solution has to be able to be supported by EF 4.1. At a minimum, I'd like to hear any sql solution but hopefully one that is supported by EF 4.1.

Thank you.",4
1012504,06/18/2009 12:59:09,11208,09/16/2008 06:12:22,4988,294,SQL query for point-in-polygon using Postgres,"I have the following simple table:

    CREATE TABLE tbl_test
    (
      id serial NOT NULL,
      poly polygon NOT NULL
    )
    WITH (OIDS=FALSE);


I then try to insert a row with a polygon:

    insert into tbl_test values(1, PolyFromText('POLYGON((0 0, 10 10, 10 0, 0 0))'))

And run into this error:

> column ""poly"" is of type polygon but expression is of type geometry

Which is lame. So my first questions is:

1. Do I really have to cast? 


Anyway, after casting it works. And now I'm trying to do a simple ST_Contains query:

    select id, poly from tbl_test where ST_Contains(poly, Point(GeomFromText('POINT(9 2)')))

Which gives the error:

    ERROR:  function st_contains(polygon, point) does not exist
    LINE 1: select id, poly from tbl_test where ST_Contains(poly, Point(...
                                                ^
    HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

What am I supposed to do?

Does it not support point-in-polygon queries? (polygon in polygon works, btw)",sql,gis,postgresql,rdbms,,,open,0,235,6,"SQL query for point-in-polygon using Postgres I have the following simple table:

    CREATE TABLE tbl_test
    (
      id serial NOT NULL,
      poly polygon NOT NULL
    )
    WITH (OIDS=FALSE);


I then try to insert a row with a polygon:

    insert into tbl_test values(1, PolyFromText('POLYGON((0 0, 10 10, 10 0, 0 0))'))

And run into this error:

> column ""poly"" is of type polygon but expression is of type geometry

Which is lame. So my first questions is:

1. Do I really have to cast? 


Anyway, after casting it works. And now I'm trying to do a simple ST_Contains query:

    select id, poly from tbl_test where ST_Contains(poly, Point(GeomFromText('POINT(9 2)')))

Which gives the error:

    ERROR:  function st_contains(polygon, point) does not exist
    LINE 1: select id, poly from tbl_test where ST_Contains(poly, Point(...
                                                ^
    HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

What am I supposed to do?

Does it not support point-in-polygon queries? (polygon in polygon works, btw)",4
561384,02/18/2009 14:56:04,54197,01/12/2009 14:57:01,196,1,How do I join a select distinct to a select sum?,"I am trying to join a select disinct statement to a select sum statement.  Here is an example of the data

    CD  STDATE    ENDDATE   PR
    F1  01/02/09  01/04/09  $10
    F1  01/02/09  01/04/09  $40
    F1  01/02/09  01/04/09  $20
    F1  01/02/09  01/04/09  $30
    F1  01/22/09  01/26/09  $10
    F1  01/22/09  01/26/09  $50
    F1  01/22/09  01/26/09  $20

My desired output is - 

    F1  01/02/09  01/04/09  $100
    F1  01/22/09  01/26/09  $80

So far, I have the foll statement, which is incorrect:

    SELECT DISTINCT STDATE, ENDDATE, CD FROM TABLE AS A 
    INNER JOIN (SELECT SUM(PR) FROM TABLE) AS B 
    ON A.STDATE=B.STDATE

How can I do that???







",sql,asp.net,sql-server,,,,open,0,173,11,"How do I join a select distinct to a select sum? I am trying to join a select disinct statement to a select sum statement.  Here is an example of the data

    CD  STDATE    ENDDATE   PR
    F1  01/02/09  01/04/09  $10
    F1  01/02/09  01/04/09  $40
    F1  01/02/09  01/04/09  $20
    F1  01/02/09  01/04/09  $30
    F1  01/22/09  01/26/09  $10
    F1  01/22/09  01/26/09  $50
    F1  01/22/09  01/26/09  $20

My desired output is - 

    F1  01/02/09  01/04/09  $100
    F1  01/22/09  01/26/09  $80

So far, I have the foll statement, which is incorrect:

    SELECT DISTINCT STDATE, ENDDATE, CD FROM TABLE AS A 
    INNER JOIN (SELECT SUM(PR) FROM TABLE) AS B 
    ON A.STDATE=B.STDATE

How can I do that???







",3
11295738,07/02/2012 14:32:28,1496308,07/02/2012 14:26:26,1,0,How do i convet following sql query to linq,"I have to convert a following sql query into linq

Can you please help me to sort out this 


    SELECT  DISTINCT ExamConditionSeverityID,
(
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 			      
			UNION
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 
			      AND  _tblBodyPart.LeftRightID IS NULL			      
			UNION
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 
			      AND _tblBodyPart.FrontBackID IS NULL 
			UNION
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 
			      AND _tblBodyPart.FrontBackID IS NULL AND _tblBodyPart.LeftRightID IS NULL 
			) AS BodyPartCode

FROM tblIncExam IncExam
inner join _tblBodyPart B on IncExam.BodyPartID=B.BodyPartID


Thanks in Advance
Meeran",sql,linq,linq-to-sql,,,07/04/2012 00:38:45,too localized,1,115,9,"How do i convet following sql query to linq I have to convert a following sql query into linq

Can you please help me to sort out this 


    SELECT  DISTINCT ExamConditionSeverityID,
(
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 			      
			UNION
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 
			      AND  _tblBodyPart.LeftRightID IS NULL			      
			UNION
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 
			      AND _tblBodyPart.FrontBackID IS NULL 
			UNION
			SELECT _tblBodyPart.BodyPartCode FROM _tblBodyPart WHERE _tblBodyPart.BodyPartID = IncExam.BodyPartID 
			      AND _tblBodyPart.FrontBackID IS NULL AND _tblBodyPart.LeftRightID IS NULL 
			) AS BodyPartCode

FROM tblIncExam IncExam
inner join _tblBodyPart B on IncExam.BodyPartID=B.BodyPartID


Thanks in Advance
Meeran",3
5400584,03/23/2011 03:26:45,475464,10/14/2010 07:40:18,30,1,How to update date range using sql query?,"This is my sql code

        DECLARE @Product TABLE ( Date_From Datetime, Date_To Datetime, Product_ID INT)
    INSERT INTO @Product Values
    ('20110323', '20110326', 101)
    INSERT INTO @Product Values
    ('20110327','20110329',101)
    
    -- The actual solution --
    DECLARE @Beg Datetime, @End Datetime
    SET @Beg = '20110323'
    SET @End = '20110323'
    
    IF @Beg = @End
    BEGIN
        DECLARE @Temp TABLE (Date_From Datetime, Date_To Datetime, Product_ID INT, [Version] INT)
        INSERT INTO @Temp
        SELECT p.*, x.[Version]
        FROM @Product AS p, (SELECT 1 AS [Version] UNION SELECT 2 AS [Version]) AS x
        WHERE @Beg BETWEEN p.Date_From AND p.Date_To   
    
        DELETE FROM @Product WHERE @Beg BETWEEN Date_From AND Date_To   
    
        UPDATE @temp SET
            Date_From = CASE WHEN [Version] = 1 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, -1, @Beg)
                             WHEN [Version] = 2 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, +1, @Beg)
                             ELSE Date_From END,
            Date_To =  CASE WHEN [Version] = 1 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, -1, @Beg)
                           WHEN [Version] = 2 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, +1, @Beg)
                           ELSE Date_From END
        INSERT INTO @Product ( Date_From, Date_To, Product_ID)
        SELECT  Date_From, Date_To, Product_ID FROM @Temp
    END
    
    ELSE
    
    BEGIN
        UPDATE @Product
         SET
            Date_From = CASE WHEN Date_From BETWEEN @Beg AND @End THEN DateAdd(dd, 1, @End) ELSE Date_From END,
            Date_To = CASE WHEN Date_To BETWEEN @Beg AND @End THEN DateAdd(dd, -1, @Beg) ELSE Date_To END
        WHERE Date_From BETWEEN @Beg AND @End
        OR Date_To BETWEEN @Beg AND @End
    DELETE FROM @Product WHERE Date_From > Date_To
    END
    
    SELECT * FROM @Product ORDER BY Date_From
    
     
this is the out put...

    2011-03-22 00:00:00.000	2011-03-22 00:00:00.000	101
    2011-03-24 00:00:00.000	2011-03-24 00:00:00.000	101
    2011-03-27 00:00:00.000	2011-03-29 00:00:00.000	101

problem in this output is 22 that is not in the DECLARE table

Wht i need is below out put

    2011-03-24 00:00:00.000	2011-03-24 00:00:00.000	101
    2011-03-27 00:00:00.000	2011-03-29 00:00:00.000	101

",sql,query,,,,,open,0,642,8,"How to update date range using sql query? This is my sql code

        DECLARE @Product TABLE ( Date_From Datetime, Date_To Datetime, Product_ID INT)
    INSERT INTO @Product Values
    ('20110323', '20110326', 101)
    INSERT INTO @Product Values
    ('20110327','20110329',101)
    
    -- The actual solution --
    DECLARE @Beg Datetime, @End Datetime
    SET @Beg = '20110323'
    SET @End = '20110323'
    
    IF @Beg = @End
    BEGIN
        DECLARE @Temp TABLE (Date_From Datetime, Date_To Datetime, Product_ID INT, [Version] INT)
        INSERT INTO @Temp
        SELECT p.*, x.[Version]
        FROM @Product AS p, (SELECT 1 AS [Version] UNION SELECT 2 AS [Version]) AS x
        WHERE @Beg BETWEEN p.Date_From AND p.Date_To   
    
        DELETE FROM @Product WHERE @Beg BETWEEN Date_From AND Date_To   
    
        UPDATE @temp SET
            Date_From = CASE WHEN [Version] = 1 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, -1, @Beg)
                             WHEN [Version] = 2 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, +1, @Beg)
                             ELSE Date_From END,
            Date_To =  CASE WHEN [Version] = 1 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, -1, @Beg)
                           WHEN [Version] = 2 AND @Beg BETWEEN Date_From AND Date_To THEN DateAdd(dd, +1, @Beg)
                           ELSE Date_From END
        INSERT INTO @Product ( Date_From, Date_To, Product_ID)
        SELECT  Date_From, Date_To, Product_ID FROM @Temp
    END
    
    ELSE
    
    BEGIN
        UPDATE @Product
         SET
            Date_From = CASE WHEN Date_From BETWEEN @Beg AND @End THEN DateAdd(dd, 1, @End) ELSE Date_From END,
            Date_To = CASE WHEN Date_To BETWEEN @Beg AND @End THEN DateAdd(dd, -1, @Beg) ELSE Date_To END
        WHERE Date_From BETWEEN @Beg AND @End
        OR Date_To BETWEEN @Beg AND @End
    DELETE FROM @Product WHERE Date_From > Date_To
    END
    
    SELECT * FROM @Product ORDER BY Date_From
    
     
this is the out put...

    2011-03-22 00:00:00.000	2011-03-22 00:00:00.000	101
    2011-03-24 00:00:00.000	2011-03-24 00:00:00.000	101
    2011-03-27 00:00:00.000	2011-03-29 00:00:00.000	101

problem in this output is 22 that is not in the DECLARE table

Wht i need is below out put

    2011-03-24 00:00:00.000	2011-03-24 00:00:00.000	101
    2011-03-27 00:00:00.000	2011-03-29 00:00:00.000	101

",2
3576229,08/26/2010 14:42:51,238779,12/26/2009 08:54:17,1224,71,Difference between Delete and Truncate in sql server. Was I wrong... ?,"In a recent interview I was asked the difference between the two. I replied the general answere that all we know... 

The interviewer then asked if truncate can be rollbacked ? I replied no... 

The interviewer said that it can be rollbacked and asked me to go through the details of the behind the scene operation of both delete and truncate and check it later.

Well i posting this question here not for just the definition and the things we know... but to get to the core of it. Thorwing light on this aspect will be highly appricieated ...

Thanks in advance

",sql,server,,,,,open,0,100,12,"Difference between Delete and Truncate in sql server. Was I wrong... ? In a recent interview I was asked the difference between the two. I replied the general answere that all we know... 

The interviewer then asked if truncate can be rollbacked ? I replied no... 

The interviewer said that it can be rollbacked and asked me to go through the details of the behind the scene operation of both delete and truncate and check it later.

Well i posting this question here not for just the definition and the things we know... but to get to the core of it. Thorwing light on this aspect will be highly appricieated ...

Thanks in advance

",2
498629,01/31/2009 10:46:36,54645,01/13/2009 15:54:53,1,0,"In SQL how can I have two fields that can't both be identical, only one is a primary key","I'm useing MySQL and I have three tables, a table of tasks, a table of products and a table that describes the relation between the two: Each product is composed of several tasks, and each task may be found in multiple products.

The table that describes the relationship between the two has two primary keys, ProductID and TaskID that are both foreign keys as well. In this table I have a field called TaskOrder that for a given Product lists the order that tasks must be performed.

What I want is to say that for any product you can't have two tasks with the same TaskOrder, however I can't just set TaskOrder to unique because diffrent products will (and should) have duplicate values for TaskOrder

Is there some way to do this?",sql,mysql,,,,,open,0,129,19,"In SQL how can I have two fields that can't both be identical, only one is a primary key I'm useing MySQL and I have three tables, a table of tasks, a table of products and a table that describes the relation between the two: Each product is composed of several tasks, and each task may be found in multiple products.

The table that describes the relationship between the two has two primary keys, ProductID and TaskID that are both foreign keys as well. In this table I have a field called TaskOrder that for a given Product lists the order that tasks must be performed.

What I want is to say that for any product you can't have two tasks with the same TaskOrder, however I can't just set TaskOrder to unique because diffrent products will (and should) have duplicate values for TaskOrder

Is there some way to do this?",2
2758060,05/03/2010 12:44:49,17635,09/18/2008 12:59:05,2781,153,Is there a web site where I can paste a SQL Insert statement and have it break it out by column?,"I've been working on an application that has no discernable data access layer, so all the SQL statements are just built up as strings and executed.  I'm constantly confronted by very long INSERT statements where I'm trying to figure out what value in the VALUES list matches up with what column in the column name list.

I was about to create a little helper application where I could paste in an INSERT statement and have it show me a list of values matched up with the column names, just for debugging, and I thought, ""someone else has probably done this already.""

Does anyone know of a web site where I can just paste in an INSERT statement and have it show me a two column table with column names in the first column and values in the second column?",sql,insert,,,,,open,0,138,21,"Is there a web site where I can paste a SQL Insert statement and have it break it out by column? I've been working on an application that has no discernable data access layer, so all the SQL statements are just built up as strings and executed.  I'm constantly confronted by very long INSERT statements where I'm trying to figure out what value in the VALUES list matches up with what column in the column name list.

I was about to create a little helper application where I could paste in an INSERT statement and have it show me a list of values matched up with the column names, just for debugging, and I thought, ""someone else has probably done this already.""

Does anyone know of a web site where I can just paste in an INSERT statement and have it show me a two column table with column names in the first column and values in the second column?",2
5359767,03/19/2011 03:02:07,666508,03/18/2011 18:10:59,4,0,how to use a try and catch in vb.net,"FOR THIS CODE IF ANY EROOR OCCURS ANY WERE IN THE CODE
 HOW COULD I USE THE TRY CATCH 
TOTKILO.Text = KILO.Text * TOUCH.Text * 0.01
        TextBox10.Text = TextBox9.Text * TextBox8.Text * 0.01
        K = Math.Round(Val(TOTKILO.Text) - Val(TextBox10.Text), 5)
        TextBox11.Text = TextBox7.Text + K

        cmd.CommandType = Data.CommandType.Text
        con.ConnectionString = ""Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Documents and Settings\Administrator\My Documents\Visual Studio 2005\Projects\SHOPPROJECT\SHOPPROJECT\shop.mdf;Integrated Security=True;User Instance=True""
        con.Open()
        If RadioButton1.Checked Then
            GOLD = 1
        ElseIf RadioButton2.Checked Then
            SILVER = 1
        End If
        If RadioButton3.Checked Then
            KGOLD = 1
        ElseIf RadioButton4.Checked Then
            KSILVER = 1
        End If
        cmd.CommandText = "" INSERT INTO SALES VALUES('"" & ComboBox1.Text & "" ' , "" & SILVER & "" ,"" & GOLD & "",'"" & ComboBox2.Text & ""',"" & KILO.Text & "", "" & TOUCH.Text & "" ,"" & TOTKILO.Text & "","" & TextBox3.Text & "","" & TextBox8.Text & "","" & KGOLD & "","" & KSILVER & "","" & TextBox9.Text & "" ,"" & TextBox10.Text & "","" & TextBox11.Text & "","" & TextBox12.Text & "" , "" & TextBox13.Text & "" ) ""
        cmd.CommandType = "" UPDATE BALANCE SET OBBALANCE = "" & TextBox11.Text & "" WHERE CUSTOMERNAME = '"" & ComboBox1.Text & ""' ""
        cmd.Connection = con
        cmd.ExecuteNonQuery()
        con.Close()
END SUB


SINCE I USED BOTH THE VB.NET CONTROLS AND ALSO THE LINK TO SQL TO UPDATE AND INSERT ALL SO WEN EVER ERROR OCCUS I WANT TO SHOW ENTER DATA COREECTLY HOW TO DO USING TRY CATCH 
",sql,,,,,03/19/2011 19:29:21,not a real question,1,396,9,"how to use a try and catch in vb.net FOR THIS CODE IF ANY EROOR OCCURS ANY WERE IN THE CODE
 HOW COULD I USE THE TRY CATCH 
TOTKILO.Text = KILO.Text * TOUCH.Text * 0.01
        TextBox10.Text = TextBox9.Text * TextBox8.Text * 0.01
        K = Math.Round(Val(TOTKILO.Text) - Val(TextBox10.Text), 5)
        TextBox11.Text = TextBox7.Text + K

        cmd.CommandType = Data.CommandType.Text
        con.ConnectionString = ""Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Documents and Settings\Administrator\My Documents\Visual Studio 2005\Projects\SHOPPROJECT\SHOPPROJECT\shop.mdf;Integrated Security=True;User Instance=True""
        con.Open()
        If RadioButton1.Checked Then
            GOLD = 1
        ElseIf RadioButton2.Checked Then
            SILVER = 1
        End If
        If RadioButton3.Checked Then
            KGOLD = 1
        ElseIf RadioButton4.Checked Then
            KSILVER = 1
        End If
        cmd.CommandText = "" INSERT INTO SALES VALUES('"" & ComboBox1.Text & "" ' , "" & SILVER & "" ,"" & GOLD & "",'"" & ComboBox2.Text & ""',"" & KILO.Text & "", "" & TOUCH.Text & "" ,"" & TOTKILO.Text & "","" & TextBox3.Text & "","" & TextBox8.Text & "","" & KGOLD & "","" & KSILVER & "","" & TextBox9.Text & "" ,"" & TextBox10.Text & "","" & TextBox11.Text & "","" & TextBox12.Text & "" , "" & TextBox13.Text & "" ) ""
        cmd.CommandType = "" UPDATE BALANCE SET OBBALANCE = "" & TextBox11.Text & "" WHERE CUSTOMERNAME = '"" & ComboBox1.Text & ""' ""
        cmd.Connection = con
        cmd.ExecuteNonQuery()
        con.Close()
END SUB


SINCE I USED BOTH THE VB.NET CONTROLS AND ALSO THE LINK TO SQL TO UPDATE AND INSERT ALL SO WEN EVER ERROR OCCUS I WANT TO SHOW ENTER DATA COREECTLY HOW TO DO USING TRY CATCH 
",1
11296109,07/02/2012 14:53:33,1169020,01/25/2012 11:02:14,8538,790,sql server table partitioning,"Scenario:

 - two databases: DB_A and DB_Archive  with one very big table called
   tableA.
 - every day, records older than 60 days are deleted from DB_A  and moved
   to DB_Archive mainly to leave thing ""separated"" because tableA is heavily queried on DB_A for records of the past 2 months.

I want to get rid of this process because it is slow and consumes a lot of resources.
I'm thinking of implementing table partitioning on DB_A with a partition function on a date column and storing all records < 2 month on one partition and all records > 2 months on another partition. My questions:

 - is this scenario going to behave like if I had 2 different databases? If I
   query my tableA for records > getdate() - 30, is it going to read the archiving partition?
 - I supposed I have to partition the indexes as well, right?
 - How do I deal with the fact that tomorrow my partition function will
   ""change"", I mean, if I create the function today (2nd of July, its
   range will be 2nd of May, but tomorrow would be the 3rd of May). Can
   I create a dynamic partition function?

   

 ",sql,sql-server,sql-server-2005,database-partitioning,,07/02/2012 15:09:24,off topic,1,213,4,"sql server table partitioning Scenario:

 - two databases: DB_A and DB_Archive  with one very big table called
   tableA.
 - every day, records older than 60 days are deleted from DB_A  and moved
   to DB_Archive mainly to leave thing ""separated"" because tableA is heavily queried on DB_A for records of the past 2 months.

I want to get rid of this process because it is slow and consumes a lot of resources.
I'm thinking of implementing table partitioning on DB_A with a partition function on a date column and storing all records < 2 month on one partition and all records > 2 months on another partition. My questions:

 - is this scenario going to behave like if I had 2 different databases? If I
   query my tableA for records > getdate() - 30, is it going to read the archiving partition?
 - I supposed I have to partition the indexes as well, right?
 - How do I deal with the fact that tomorrow my partition function will
   ""change"", I mean, if I create the function today (2nd of July, its
   range will be 2nd of May, but tomorrow would be the 3rd of May). Can
   I create a dynamic partition function?

   

 ",4
4633734,01/08/2011 11:57:56,567980,01/08/2011 11:52:17,1,0,Business Intelligence Development Studio,"I can't find Business Intelligence Development Studio in Sql Server 2005.
I have installed Visual Studio 2008 and Sql Server 2005 Standard edition.
How can i view ",sql,sql-server-2005,,,,,open,0,26,4,"Business Intelligence Development Studio I can't find Business Intelligence Development Studio in Sql Server 2005.
I have installed Visual Studio 2008 and Sql Server 2005 Standard edition.
How can i view ",2
10554905,05/11/2012 16:04:28,428757,08/23/2010 19:36:03,731,24,Why doesn't the tsql variable hold its value when called a second time?,"If you run the exec stored procedure command in SSMS, it produces this script:

    USE [MY_DB]
    GO
    
    DECLARE	@return_value int
    
    EXEC	@return_value = [dbo].[usr_DailyReportsEmpty]
            @username = N'someuser'
    
    SELECT	'Return value' = @return_value
    
    GO

However when I run the script the EXEC returns 16 and the SELECT returns 0. Why is that?",sql,sql-server,tsql,,,05/28/2012 08:44:06,not a real question,1,92,13,"Why doesn't the tsql variable hold its value when called a second time? If you run the exec stored procedure command in SSMS, it produces this script:

    USE [MY_DB]
    GO
    
    DECLARE	@return_value int
    
    EXEC	@return_value = [dbo].[usr_DailyReportsEmpty]
            @username = N'someuser'
    
    SELECT	'Return value' = @return_value
    
    GO

However when I run the script the EXEC returns 16 and the SELECT returns 0. Why is that?",3
1543653,10/09/2009 13:09:53,99594,05/01/2009 20:15:51,2060,122,SQL-2008: N small databases VS 1 database with N schemas,"I have a database server with few main databases, and few dozens of small ones.

These small databases are kind of intermediary/staging databases for data import from various sources into main database. Data import is a daily task. They are all quite similar in structure as the implementation of these data imports are similar, so basically they have a configuration tables, which define mapping, conversions etc, and the data tables, which contain the results of the import.

Some time ago there have been only the handful of small ones, but now I have more then 20 of them will grow further with the number of supported data feeds.

I have just migrated all the server environment to SQL-2008, and having some time now for clean-up/refactoring, I am thinking to merge all of data-import databases into just one database, and use `database schema` to separate them.


**Question-0:** Any other ideas for the described situation?

**Question-1:** Shall I change from a `separate database` to a `separate schema`?

**Question-2:** Any tricky thing to be careful about in `database schema` implementation?
",sql,sql-server,sql-server-2008,schema,,,open,0,171,10,"SQL-2008: N small databases VS 1 database with N schemas I have a database server with few main databases, and few dozens of small ones.

These small databases are kind of intermediary/staging databases for data import from various sources into main database. Data import is a daily task. They are all quite similar in structure as the implementation of these data imports are similar, so basically they have a configuration tables, which define mapping, conversions etc, and the data tables, which contain the results of the import.

Some time ago there have been only the handful of small ones, but now I have more then 20 of them will grow further with the number of supported data feeds.

I have just migrated all the server environment to SQL-2008, and having some time now for clean-up/refactoring, I am thinking to merge all of data-import databases into just one database, and use `database schema` to separate them.


**Question-0:** Any other ideas for the described situation?

**Question-1:** Shall I change from a `separate database` to a `separate schema`?

**Question-2:** Any tricky thing to be careful about in `database schema` implementation?
",4
6786941,07/22/2011 07:30:31,857462,07/22/2011 07:30:31,1,0,store data from live webpages & create database,i want to write a program that get data from some live web pages and create a database in sql to show the information in a table.can anybody help me and give me some useful codes?,sql,database,create,,,07/27/2011 03:05:44,not constructive,1,36,8,store data from live webpages & create database i want to write a program that get data from some live web pages and create a database in sql to show the information in a table.can anybody help me and give me some useful codes?,3
5611286,04/10/2011 11:00:36,569008,01/09/2011 18:09:49,26,1,MS SQL Server table - Update Order by,"I have an MS SQL Server table with fields: id, city, country. I imported this table from Excel file, everything is imported successfully, but id field is not ordered by number. The tool i use imported the rows in some random number. 

What kind of Update command i should use from MS SQL Server Management Studio Express to re-order my ids?",sql,,,,,,open,0,61,8,"MS SQL Server table - Update Order by I have an MS SQL Server table with fields: id, city, country. I imported this table from Excel file, everything is imported successfully, but id field is not ordered by number. The tool i use imported the rows in some random number. 

What kind of Update command i should use from MS SQL Server Management Studio Express to re-order my ids?",1
10722654,05/23/2012 15:01:19,1293343,03/26/2012 15:08:20,1,0,3 table Linq Query,"I Have 3 Relational Tables on SQLCE Database.
<p>Product &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProductCategory &nbsp;&nbsp;&nbsp; ProductPhoto</p>
<p>---------- &nbsp;&nbsp;&nbsp;&nbsp; ---------------------- &nbsp;&nbsp;&nbsp; -----------------</p>

<p>PId &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CatId &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PhotoId</p>
<p>Name &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value</p>
<p>CatId &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PId</p>

I Need, List ProductCategories with first Product Photo for Linq.
<br />
If not possible Linq, please sql code.
<br />
Thanks.
",sql,linq,sql-server-ce,,,05/23/2012 21:11:45,not a real question,1,43,4,"3 table Linq Query I Have 3 Relational Tables on SQLCE Database.
<p>Product &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProductCategory &nbsp;&nbsp;&nbsp; ProductPhoto</p>
<p>---------- &nbsp;&nbsp;&nbsp;&nbsp; ---------------------- &nbsp;&nbsp;&nbsp; -----------------</p>

<p>PId &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CatId &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PhotoId</p>
<p>Name &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value</p>
<p>CatId &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PId</p>

I Need, List ProductCategories with first Product Photo for Linq.
<br />
If not possible Linq, please sql code.
<br />
Thanks.
",3
11145160,06/21/2012 19:13:27,331393,05/03/2010 12:20:59,462,3,"Is a SQL self-join the best way to implement ""lookups""?","I am running an SQL query which self-joins the same table 24 times in order to ""look up"" particular rows of the table according to 24 different criteria, so that I can use all those values in a calculation. While the performance is perfectly fine (the table is indexed and the join criteria are restrictive), I can't help but feel there is a code smell here.

Is there a better way of doing lookups in SQL?

(Apologies for not including an example; I hope I have phrased the question in a general fashion).",sql,self-join,,,,,open,0,91,10,"Is a SQL self-join the best way to implement ""lookups""? I am running an SQL query which self-joins the same table 24 times in order to ""look up"" particular rows of the table according to 24 different criteria, so that I can use all those values in a calculation. While the performance is perfectly fine (the table is indexed and the join criteria are restrictive), I can't help but feel there is a code smell here.

Is there a better way of doing lookups in SQL?

(Apologies for not including an example; I hope I have phrased the question in a general fashion).",2
1569101,10/14/2009 21:26:26,76512,03/11/2009 05:55:51,106,4,TSQL function to return the number of rows in a result set from a function,"I have a job that performs several validation checks on rows in several tables in a database.  If the check fails it logs the failure in a table that.  The information that is logged includes the table name, a uniqueidentifier value of the row that failed, which check it failed, and which job was being run at the time.  Here's the simplified table definition of the log

    CREATE TABLE [tblSY_ValidationFieldFailures](
    	[pkValidationFieldFailure] [int] IDENTITY(1,1) NOT NULL,
    	[fkJobID] [int] NOT NULL,
    	[fkValidationFieldFailureType] [int] NOT NULL,
        [TableName] nvarchar(128),
    	[TableUniqueIdentifier] [nvarchar](100) NULL)

I'd like to write a function that returns the number of rows failed given a certain table and jobID (i.e. fnGetNumberOfFailedRows(@JobID, @TableName)).  I tried something similar to the following:

    CREATE FUNCTION fnGetNumberOfRowsThatFailedValidationCheck 
    (
    	@pkJobID int,
    	@TableName nvarchar(128)
    )
    RETURNS int
    AS
    BEGIN
    	-- Declare the return variable here
    	DECLARE @NumFailedRows int
    	
    	Select fkJobID, 
               TableUniqueIdentifier, 
               TableName 
        From tblSY_ValidationFieldFailures
    		Where fkJobID=@pkJobID And TableName=@TableName
    	                Group By fkJobID, TableName, TableUniqueIdentifier
    
    	SET @NumFailedRows = @@ROWCOUNT
    
    	RETURN @NumFailedRows    
    END
But of course you can't have that Select statement inside a function.  Is there a way to do what I want inside a function or do I have to so the stored procedure route?",sql,tsql,udf,,,,open,0,339,15,"TSQL function to return the number of rows in a result set from a function I have a job that performs several validation checks on rows in several tables in a database.  If the check fails it logs the failure in a table that.  The information that is logged includes the table name, a uniqueidentifier value of the row that failed, which check it failed, and which job was being run at the time.  Here's the simplified table definition of the log

    CREATE TABLE [tblSY_ValidationFieldFailures](
    	[pkValidationFieldFailure] [int] IDENTITY(1,1) NOT NULL,
    	[fkJobID] [int] NOT NULL,
    	[fkValidationFieldFailureType] [int] NOT NULL,
        [TableName] nvarchar(128),
    	[TableUniqueIdentifier] [nvarchar](100) NULL)

I'd like to write a function that returns the number of rows failed given a certain table and jobID (i.e. fnGetNumberOfFailedRows(@JobID, @TableName)).  I tried something similar to the following:

    CREATE FUNCTION fnGetNumberOfRowsThatFailedValidationCheck 
    (
    	@pkJobID int,
    	@TableName nvarchar(128)
    )
    RETURNS int
    AS
    BEGIN
    	-- Declare the return variable here
    	DECLARE @NumFailedRows int
    	
    	Select fkJobID, 
               TableUniqueIdentifier, 
               TableName 
        From tblSY_ValidationFieldFailures
    		Where fkJobID=@pkJobID And TableName=@TableName
    	                Group By fkJobID, TableName, TableUniqueIdentifier
    
    	SET @NumFailedRows = @@ROWCOUNT
    
    	RETURN @NumFailedRows    
    END
But of course you can't have that Select statement inside a function.  Is there a way to do what I want inside a function or do I have to so the stored procedure route?",3
8595215,12/21/2011 19:28:11,1046536,11/14/2011 23:19:44,8,0,Special VB String Escape Character like @'String' in C#,Does VB have an equivalent to the @ symbol in C# to quickly and efficiently escape a SQL command line string?,sql,string,vb,escaping,,12/23/2011 07:22:13,not constructive,1,21,9,Special VB String Escape Character like @'String' in C# Does VB have an equivalent to the @ symbol in C# to quickly and efficiently escape a SQL command line string?,4
10763680,05/26/2012 04:52:59,1125430,01/01/2012 21:29:20,173,22,sort nvarchar in SQL server 2008,"II have a table with this data in sql server :  

    Id
=========
    1
    12e
    5 


and i want to order this data like this:
 

    id
=========
    1
    5
    12e 


my id type is nvarchar(50) and i can't convert it to the int.is this possible that i sord the data in this way.
",sql,sql-server,tsql,,,,open,0,78,6,"sort nvarchar in SQL server 2008 II have a table with this data in sql server :  

    Id
=========
    1
    12e
    5 


and i want to order this data like this:
 

    id
=========
    1
    5
    12e 


my id type is nvarchar(50) and i can't convert it to the int.is this possible that i sord the data in this way.
",3
11524080,07/17/2012 13:58:00,601862,02/03/2011 16:16:50,44,0,MS SQL Server 2008 R2 all buttons disabled,"I get an odd problem in my SQL R2. 
Although I can attach a new db to my db instance, but all buttons on the tool menu panel are disabled.
So I cannot execute any sql query statements.
It is really annoying !!!
I have been stuck on it for ages.

Could someone help me figure it out?

![All buttons disabled][1]


  [1]: http://i.stack.imgur.com/Li5Hp.png

Thank you so much.",sql,sql-server-2008-r2,,,,07/17/2012 14:05:10,off topic,1,62,8,"MS SQL Server 2008 R2 all buttons disabled I get an odd problem in my SQL R2. 
Although I can attach a new db to my db instance, but all buttons on the tool menu panel are disabled.
So I cannot execute any sql query statements.
It is really annoying !!!
I have been stuck on it for ages.

Could someone help me figure it out?

![All buttons disabled][1]


  [1]: http://i.stack.imgur.com/Li5Hp.png

Thank you so much.",2
10887170,06/04/2012 19:32:42,1183614,02/01/2012 20:06:36,15,0,How to select distinct by 2 fields,"I need to be able to only select records which have an IsActive = 1 in addition to all of this:

    SELECT DISTINCT 0 as CommunityID,  

                        CASE Libname
							WHEN 'RKHL' THEN 'ROCK HILL'
							WHEN 'FTML' THEN 'FORT MILL'
							WHEN 'LANC' THEN 'LANCASTER'
							WHEN 'BREV' THEN 'BREVARD'
                            WHEN 'PBTC' THEN 'MIDLANDS-CLEC'
                            WHEN 'PBTI' THEN 'MIDLANDS-ILEC'
                            
                        END AS CommunityDesc,

                        LibName,
                        LibName + '|' AS FilterByID,
                        IsActive 
                        FROM Reference.dbo.Community
                        WHERE LibName <> 'CAROTEL' 
                        UNION
                        SELECT CommunityID, RTRIM(COMMNAME) AS CommunityDesc, LibName, LibName + '|' + RTRIM(COMMNAME) AS FilterByID, IsActive
                        FROM Reference.dbo.Community 
                        
                        WHERE LibName <> 'CAROTEL'
                        ORDER BY 1,3;
                        
                        ",sql,database,group-by,distinct,,,open,0,528,7,"How to select distinct by 2 fields I need to be able to only select records which have an IsActive = 1 in addition to all of this:

    SELECT DISTINCT 0 as CommunityID,  

                        CASE Libname
							WHEN 'RKHL' THEN 'ROCK HILL'
							WHEN 'FTML' THEN 'FORT MILL'
							WHEN 'LANC' THEN 'LANCASTER'
							WHEN 'BREV' THEN 'BREVARD'
                            WHEN 'PBTC' THEN 'MIDLANDS-CLEC'
                            WHEN 'PBTI' THEN 'MIDLANDS-ILEC'
                            
                        END AS CommunityDesc,

                        LibName,
                        LibName + '|' AS FilterByID,
                        IsActive 
                        FROM Reference.dbo.Community
                        WHERE LibName <> 'CAROTEL' 
                        UNION
                        SELECT CommunityID, RTRIM(COMMNAME) AS CommunityDesc, LibName, LibName + '|' + RTRIM(COMMNAME) AS FilterByID, IsActive
                        FROM Reference.dbo.Community 
                        
                        WHERE LibName <> 'CAROTEL'
                        ORDER BY 1,3;
                        
                        ",4
9040595,01/27/2012 21:55:14,1174442,01/27/2012 21:38:55,1,0,How to manipulate subtypes and supertypes in oracle relational-object schema?,"For example, I will define a LEGAL ENTITY supertype and some subtypes under LEGAL ENTITY called SUPPLIER, CUSTOMER and MANUFACTURER...

When I insert an instance of CUSTOMER, Oracle will create both supertype LEGAL ENTITY and subtype CUSTOMER instances for me.

But, suppose I have someone who is a CUSTOMER and a SUPPLIER at same time...how can I insert it as CUSTOMER and SUPPLIER under the same LEGAL ENTITY instance?

Thanks in advanced for your help.",sql,oracle,object,orm,,,open,0,72,10,"How to manipulate subtypes and supertypes in oracle relational-object schema? For example, I will define a LEGAL ENTITY supertype and some subtypes under LEGAL ENTITY called SUPPLIER, CUSTOMER and MANUFACTURER...

When I insert an instance of CUSTOMER, Oracle will create both supertype LEGAL ENTITY and subtype CUSTOMER instances for me.

But, suppose I have someone who is a CUSTOMER and a SUPPLIER at same time...how can I insert it as CUSTOMER and SUPPLIER under the same LEGAL ENTITY instance?

Thanks in advanced for your help.",4
6838034,07/26/2011 23:58:43,864459,07/26/2011 23:58:43,1,0,English Language teacher,"I logged in as a user(HR, SAMPLE SCHEMA) and create so many tables. By default, HR has about 8 tables already created. like EMPLOYEES, LOCATIONS, DEPARTMENTS, JOB_HISTORY ETC. Now is there any query to display only the default tables excluding the ones I created? or a query to display only the ones I created leaving the default tables? 

Thanks..",sql,query,,,,07/27/2011 00:50:38,not a real question,1,59,3,"English Language teacher I logged in as a user(HR, SAMPLE SCHEMA) and create so many tables. By default, HR has about 8 tables already created. like EMPLOYEES, LOCATIONS, DEPARTMENTS, JOB_HISTORY ETC. Now is there any query to display only the default tables excluding the ones I created? or a query to display only the ones I created leaving the default tables? 

Thanks..",2
8046882,11/08/2011 06:52:22,1035085,11/08/2011 06:33:30,1,0,Count Column Data based on Groupings,"so I have this problem. My Database has two tables that look something
like this:
        


        Table A:

        ============================
        Username     Group Number
        ============================
        mike              1
        john              1
        stan              2
        mark              2

        ============================


        Table B:

        ========================================
        Username     FeatureA  FeatureB FeatureC
        ----------------------------------------

        mike           Yes                Yes
        john                      Yes
        stan                      Yes     Yes
        mark           Yes                Yes
        ========================================

Tables A and B are joined together by Username and I need something that looks like this:



        ============================================
        Group Number  FeatureA   FeatureB   FeatureC
        ============================================

             1         1            1          1
             2         1            1          2
        ============================================

Basically I need to count the number of users in each group that have access to each feature.

",sql,sql-server,,,,,open,0,503,6,"Count Column Data based on Groupings so I have this problem. My Database has two tables that look something
like this:
        


        Table A:

        ============================
        Username     Group Number
        ============================
        mike              1
        john              1
        stan              2
        mark              2

        ============================


        Table B:

        ========================================
        Username     FeatureA  FeatureB FeatureC
        ----------------------------------------

        mike           Yes                Yes
        john                      Yes
        stan                      Yes     Yes
        mark           Yes                Yes
        ========================================

Tables A and B are joined together by Username and I need something that looks like this:



        ============================================
        Group Number  FeatureA   FeatureB   FeatureC
        ============================================

             1         1            1          1
             2         1            1          2
        ============================================

Basically I need to count the number of users in each group that have access to each feature.

",2
10893663,06/05/2012 08:02:48,796035,06/13/2011 13:56:32,84,7,WAMP with PostgreSQL,"I can't install PostgreSQL on my wamp-server. I enabled php_pgsql and php_pdo_pgsql extensions and my plugin is still not loaded after I restarted WAMP.

[Here][1] I found that I can solve that by *adding path-php in PATH environment variable of Windows* but what does that mean?


  [1]: http://stackoverflow.com/questions/5218692/postgresql-with-wamp",sql,postgresql,wamp,wampserver,,06/05/2012 21:06:46,off topic,1,48,3,"WAMP with PostgreSQL I can't install PostgreSQL on my wamp-server. I enabled php_pgsql and php_pdo_pgsql extensions and my plugin is still not loaded after I restarted WAMP.

[Here][1] I found that I can solve that by *adding path-php in PATH environment variable of Windows* but what does that mean?


  [1]: http://stackoverflow.com/questions/5218692/postgresql-with-wamp",4
2551207,03/31/2010 07:41:38,298785,03/22/2010 05:41:15,13,0,Using CONNECT BY to get all parents and one child in Hierarchy through SQL query in Oracle,"I was going through some previous posts on CONNECT BY usage. What I need to find is that what to do if I want to get all the parents (i.e, up to root) and just one child for a node, say 4.

It seems Like I will have to use union of the following two:-
   

     SELECT  * 
     FROM    hierarchy 
     START WITH id = 4
     CONNECT BY id = PRIOR parent
    union
         SELECT  *
         FROM    hierarchy
         WHERE LEVEL =<2
         START WITH
         id = 4
         CONNECT BY
         parent = PRIOR id


Is there a better way to do this, some workaround that is more optimized?",sql,oracle,hierarchy,,,,open,0,189,17,"Using CONNECT BY to get all parents and one child in Hierarchy through SQL query in Oracle I was going through some previous posts on CONNECT BY usage. What I need to find is that what to do if I want to get all the parents (i.e, up to root) and just one child for a node, say 4.

It seems Like I will have to use union of the following two:-
   

     SELECT  * 
     FROM    hierarchy 
     START WITH id = 4
     CONNECT BY id = PRIOR parent
    union
         SELECT  *
         FROM    hierarchy
         WHERE LEVEL =<2
         START WITH
         id = 4
         CONNECT BY
         parent = PRIOR id


Is there a better way to do this, some workaround that is more optimized?",3
5401119,03/23/2011 05:12:14,95265,04/24/2009 01:28:43,1456,13,moving file from desktop to Oracle directory,"I have created a directory in Oracle via the command create directory. The directory is called temp. I have a file located on:

G:\Documents\SO\Content\102010 Stack Overflow\test.xml

that I want to put in this directory. How can I do this via a SQL statement?",sql,oracle,,,,,open,0,41,7,"moving file from desktop to Oracle directory I have created a directory in Oracle via the command create directory. The directory is called temp. I have a file located on:

G:\Documents\SO\Content\102010 Stack Overflow\test.xml

that I want to put in this directory. How can I do this via a SQL statement?",2
3240297,07/13/2010 18:38:41,219645,11/26/2009 19:20:58,181,24,How do I use column values as xml element names using for xml in MS SQL 2005?,"Simplifying what I'm doing somewhat, as an example, say I have the following tables:

    declare @elements table (id int, name nvarchar(20))
    
    insert into @elements (id, name) values (1, 'FirstName')
    insert into @elements (id, name) values (2, 'Surname')
    insert into @elements (id, name) values (3, 'Address')
    
    declare @values table (id int, value nvarchar(20), elementId int)
    
    insert into @values (id, value, elementId) values (1, 'XXX', 1)
    insert into @values (id, value, elementId) values (2, 'YYY', 2)
    insert into @values (id, value, elementId) values (3, 'ZZZ', 3)

which simply defines a table of element names that could be dynamic, against which are defined a table of values.

What I would like is to generate XML in the following form, where the values of the @elements table become the element names, and the values of the @values table become the values.

    <Customer>
        <FirstName>XXX</FirstName>
        <Surname>YYY</Surname>
        <Address>ZZZ<Address>
    </Customer>

However my efforts with `for xml` so far are not going so well:

    select e.name, v.value from @elements e
    inner join @values v on v.elementId = e.id
    for xml path(''), root('customer')

returns

    <customer>
      <name>FirstName</name>
      <value>XXX</value>
      <name>Surname</name>
      <value>YYY</value>
      <name>Address</name>
      <value>ZZZ</value>
    </customer>

`for xml auto` returns

    <customer>
      <e name=""FirstName"">
        <v value=""XXX"" />
      </e>
      <e name=""Surname"">
        <v value=""YYY"" />
      </e>
      <e name=""Address"">
        <v value=""ZZZ"" />
      </e>
    </customer>

`for xml raw` returns

    <customer>
      <row name=""FirstName"" value=""XXX"" />
      <row name=""Surname"" value=""YYY"" />
      <row name=""Address"" value=""ZZZ"" />
    </customer>

Is there a way I can get the values from a column to output as element names? I'm sure I'm missing something obviously simple here.",sql,sql-server,xml,sql-server-2005,,,open,0,428,17,"How do I use column values as xml element names using for xml in MS SQL 2005? Simplifying what I'm doing somewhat, as an example, say I have the following tables:

    declare @elements table (id int, name nvarchar(20))
    
    insert into @elements (id, name) values (1, 'FirstName')
    insert into @elements (id, name) values (2, 'Surname')
    insert into @elements (id, name) values (3, 'Address')
    
    declare @values table (id int, value nvarchar(20), elementId int)
    
    insert into @values (id, value, elementId) values (1, 'XXX', 1)
    insert into @values (id, value, elementId) values (2, 'YYY', 2)
    insert into @values (id, value, elementId) values (3, 'ZZZ', 3)

which simply defines a table of element names that could be dynamic, against which are defined a table of values.

What I would like is to generate XML in the following form, where the values of the @elements table become the element names, and the values of the @values table become the values.

    <Customer>
        <FirstName>XXX</FirstName>
        <Surname>YYY</Surname>
        <Address>ZZZ<Address>
    </Customer>

However my efforts with `for xml` so far are not going so well:

    select e.name, v.value from @elements e
    inner join @values v on v.elementId = e.id
    for xml path(''), root('customer')

returns

    <customer>
      <name>FirstName</name>
      <value>XXX</value>
      <name>Surname</name>
      <value>YYY</value>
      <name>Address</name>
      <value>ZZZ</value>
    </customer>

`for xml auto` returns

    <customer>
      <e name=""FirstName"">
        <v value=""XXX"" />
      </e>
      <e name=""Surname"">
        <v value=""YYY"" />
      </e>
      <e name=""Address"">
        <v value=""ZZZ"" />
      </e>
    </customer>

`for xml raw` returns

    <customer>
      <row name=""FirstName"" value=""XXX"" />
      <row name=""Surname"" value=""YYY"" />
      <row name=""Address"" value=""ZZZ"" />
    </customer>

Is there a way I can get the values from a column to output as element names? I'm sure I'm missing something obviously simple here.",4
4822830,01/27/2011 22:45:15,440266,09/06/2010 00:05:05,233,0,IFNull in MySQL,"I am new to SQL and I am trying to create a calculated field using a set of columns. However, some of those values may be NULL. If they are NULL, I don't want the calculated field to return a NULL result but instead set some arbitrary value.

Here is the calculated field

    (ces.EXPERT_SCORE * cirm.CONSUMER_RATING) + (12.5 * scs.SIMILARITY)

",sql,mysql,,ifnull,,,open,0,62,3,"IFNull in MySQL I am new to SQL and I am trying to create a calculated field using a set of columns. However, some of those values may be NULL. If they are NULL, I don't want the calculated field to return a NULL result but instead set some arbitrary value.

Here is the calculated field

    (ces.EXPERT_SCORE * cirm.CONSUMER_RATING) + (12.5 * scs.SIMILARITY)

",3
10650895,05/18/2012 10:26:29,1355513,04/25/2012 07:18:39,8,0,Invalid Object Name dbo.owt,"SELECT     TOP (100) PERCENT owtsector, owttotal AS Expr2,
                          (SELECT     SUM(owt.owttotal) AS Expr1
                            FROM          dbo.OWT AS t1
                            WHERE      (t1.owtsector <= owt.owtsector)) AS Expr1
FROM         (SELECT     TOP (100) PERCENT SUM(DocTotal) AS owttotal, U_SECTOR AS owtsector
                       FROM          dbo.OWTR AS t2
                       GROUP BY U_SECTOR) AS owt",sql,,,,,05/18/2012 15:22:23,not a real question,1,207,4,"Invalid Object Name dbo.owt SELECT     TOP (100) PERCENT owtsector, owttotal AS Expr2,
                          (SELECT     SUM(owt.owttotal) AS Expr1
                            FROM          dbo.OWT AS t1
                            WHERE      (t1.owtsector <= owt.owtsector)) AS Expr1
FROM         (SELECT     TOP (100) PERCENT SUM(DocTotal) AS owttotal, U_SECTOR AS owtsector
                       FROM          dbo.OWTR AS t2
                       GROUP BY U_SECTOR) AS owt",1
11412211,07/10/2012 11:19:34,1514577,07/10/2012 11:13:16,1,0,core java excersise,"Core Java Coding exercise:

Given a CSV of this format:
id,name,relation,related_id,dob
1,Peter,,,19/08/1965
2,Roger,father,4,19/04/1945
3,Ann,wife,2,19/05/1946
4,Albert,son,2,19/03/1994
5,Sam,uncle,1,19/08/1940
6,Satheesh,husband,7,19/08/1981
7,Nisha,,,16/07/1983
8,Dinesh,,,15/04/1935
9,Angie,niece,8,11/11/1956

Explained:
2,Roger,father,4,19/04/1945
4,Albert,son,2,19/03/1994

Roger has id: 2 and is the father of 4
Albert has id 4 and is the son of 2

Relations are not bi directional.

1. Parse the CSV into a POJO model.
2. Implement queries in core java to find the following:
   * Select on name. Given a name, the system should output all people who have that name. Implement the wild card % too (only at the end)
   * Implement the query, ""select people where relation = '<filter>'""
   * Implement the query, ""select people where relation = null""
   * Correct the CSV to make the relation bidirectional if and only if (iff) one side of the relation is not related.
   * Implement the query ""select * from ppl order by dob desc""
   
The CSV will be updated every 30 mins, add a thread to read the new contents from the CSV every 15 mins. 

This operation should be thread safe and no queries should run when the update operation is underway.
   ",sql,multithreading,query,csv,,07/10/2012 11:59:57,not a real question,1,182,3,"core java excersise Core Java Coding exercise:

Given a CSV of this format:
id,name,relation,related_id,dob
1,Peter,,,19/08/1965
2,Roger,father,4,19/04/1945
3,Ann,wife,2,19/05/1946
4,Albert,son,2,19/03/1994
5,Sam,uncle,1,19/08/1940
6,Satheesh,husband,7,19/08/1981
7,Nisha,,,16/07/1983
8,Dinesh,,,15/04/1935
9,Angie,niece,8,11/11/1956

Explained:
2,Roger,father,4,19/04/1945
4,Albert,son,2,19/03/1994

Roger has id: 2 and is the father of 4
Albert has id 4 and is the son of 2

Relations are not bi directional.

1. Parse the CSV into a POJO model.
2. Implement queries in core java to find the following:
   * Select on name. Given a name, the system should output all people who have that name. Implement the wild card % too (only at the end)
   * Implement the query, ""select people where relation = '<filter>'""
   * Implement the query, ""select people where relation = null""
   * Correct the CSV to make the relation bidirectional if and only if (iff) one side of the relation is not related.
   * Implement the query ""select * from ppl order by dob desc""
   
The CSV will be updated every 30 mins, add a thread to read the new contents from the CSV every 15 mins. 

This operation should be thread safe and no queries should run when the update operation is underway.
   ",4
2097764,01/19/2010 22:44:59,254448,01/19/2010 22:44:59,1,0,help with simple query,"My config table:

    name | value
    version > 1.5.6
    title > test

How i try and get it:

    $getCfg = mysql_query(""SELECT * FROM config"");
    $config = mysql_fetch_assoc($getCfg);

    echo $config['title'];
    
Equals to:

    Notice: Undefined index: title in C:\web\index.php on line 5
    
How would I do to get the value where the name is title?

The above dont work..well if i add WHERE title = 'test' and then echo $config['title']",sql,,,,,,open,0,93,4,"help with simple query My config table:

    name | value
    version > 1.5.6
    title > test

How i try and get it:

    $getCfg = mysql_query(""SELECT * FROM config"");
    $config = mysql_fetch_assoc($getCfg);

    echo $config['title'];
    
Equals to:

    Notice: Undefined index: title in C:\web\index.php on line 5
    
How would I do to get the value where the name is title?

The above dont work..well if i add WHERE title = 'test' and then echo $config['title']",1
9020517,01/26/2012 15:29:28,1160955,01/20/2012 15:52:02,1,0,Restore failed for Server 'Server path'. Microsoft.SqlExpress.Express.Smo,"I get this error when i try to restore my database.

Additional Information:
    System.Data.SqlClient.SqlError: The media set has 2 media families but only 1 are provided. All members must be provided.

Any suggestions? Please.",sql,server,,,,01/26/2012 17:58:24,not a real question,1,35,7,"Restore failed for Server 'Server path'. Microsoft.SqlExpress.Express.Smo I get this error when i try to restore my database.

Additional Information:
    System.Data.SqlClient.SqlError: The media set has 2 media families but only 1 are provided. All members must be provided.

Any suggestions? Please.",2
8255801,11/24/2011 10:47:38,517147,11/23/2010 08:11:03,8,0,"msg 102,level 15,state 1,line 9 Incorrect syntax near '('-","hello everyone,
               I am working on a cross tab query in sql server 2008. everything appear fine apart from this error i am getting.here is my code:
        select * from 
(select ITEM_CODE,NET_PRODUCTION_QUANTITY,RAW_MATERIAL_CODE,DATE_ID  from dbo.ODST_PRODUCTION_TRANS 
 ) n
pivot
(sum(NET_PRODUCTION_QUANTITY) for datename(month,DATE_ID) In ([January],[February],[March],[April],[May],[June])) as pvt
where RAW_MATERIAL_CODE = 'X' and DATE_ID between '01-Jan-11' and '30-Jun-11'.

the problem is where the ""datename(month,date_id)"" but i cant figure it out.Can anyone give me a solution.Thanks in advance",sql,server,,,,,open,0,92,9,"msg 102,level 15,state 1,line 9 Incorrect syntax near '('- hello everyone,
               I am working on a cross tab query in sql server 2008. everything appear fine apart from this error i am getting.here is my code:
        select * from 
(select ITEM_CODE,NET_PRODUCTION_QUANTITY,RAW_MATERIAL_CODE,DATE_ID  from dbo.ODST_PRODUCTION_TRANS 
 ) n
pivot
(sum(NET_PRODUCTION_QUANTITY) for datename(month,DATE_ID) In ([January],[February],[March],[April],[May],[June])) as pvt
where RAW_MATERIAL_CODE = 'X' and DATE_ID between '01-Jan-11' and '30-Jun-11'.

the problem is where the ""datename(month,date_id)"" but i cant figure it out.Can anyone give me a solution.Thanks in advance",2
4039917,10/28/2010 05:05:09,489682,10/28/2010 05:05:09,1,0,subquery  considered as table,how  can do assume sub query as table  in mssql?,sql,mysql,oracle,,,10/28/2010 06:42:55,not a real question,1,12,5,subquery  considered as table how  can do assume sub query as table  in mssql?,3
1300196,08/19/2009 14:08:10,72443,03/01/2009 11:57:20,620,106,how to create a fresh database before tests run ?,how to create a fresh database (everytime) before tests run from a schema file ?,sql,.net,nhibernate,,,,open,0,15,10,how to create a fresh database before tests run ? how to create a fresh database (everytime) before tests run from a schema file ?,3
1195313,07/28/2009 16:43:44,109035,05/18/2009 21:44:38,804,53,Type II dimension joins,"I have the following table lookup table in OLTP

    CREATE TABLE TransactionState
    (
        TransactionStateId INT IDENTITY (1, 1) NOT NULL,
        TransactionStateName VarChar (100)
    )

When this comes into my OLAP, I change the structure as follows:

    CREATE TABLE TransactionState
    (
        TransactionStateId INT NOT NULL, /* not an IDENTITY column in OLAP */
        TransactionStateName VarChar (100) NOT NULL,
        StartDateTime DateTime NOT NULL,
        EndDateTime NULL
    )

My question is regarding the TransactionStateId column. Over time, I may have duplicate TransactionStateId values in my OLAP, but with the combination of StartDateTime and EndDateTime, they would be unique.

I have seen samples of Type-2 Dimensions where an OriginalTransactionStateId is added and the incoming TransactionStateId is mapped to it, plus a new TransactionStateId IDENTITY field becomes the PK and is used for the joins.

    CREATE TABLE TransactionState
    (
        TransactionStateId INT IDENTITY (1, 1) NOT NULL,
        OriginalTransactionStateId INT NOT NULL, /* not an IDENTITY column in OLAP */
        TransactionStateName VarChar (100) NOT NULL,
        StartDateTime DateTime NOT NULL,
        EndDateTime NULL
    )

Should I go with bachellorete #2 or bachellorete #3?",sql,datawarehouse,dimensions,type-2-dimension,sql-server,,open,0,273,4,"Type II dimension joins I have the following table lookup table in OLTP

    CREATE TABLE TransactionState
    (
        TransactionStateId INT IDENTITY (1, 1) NOT NULL,
        TransactionStateName VarChar (100)
    )

When this comes into my OLAP, I change the structure as follows:

    CREATE TABLE TransactionState
    (
        TransactionStateId INT NOT NULL, /* not an IDENTITY column in OLAP */
        TransactionStateName VarChar (100) NOT NULL,
        StartDateTime DateTime NOT NULL,
        EndDateTime NULL
    )

My question is regarding the TransactionStateId column. Over time, I may have duplicate TransactionStateId values in my OLAP, but with the combination of StartDateTime and EndDateTime, they would be unique.

I have seen samples of Type-2 Dimensions where an OriginalTransactionStateId is added and the incoming TransactionStateId is mapped to it, plus a new TransactionStateId IDENTITY field becomes the PK and is used for the joins.

    CREATE TABLE TransactionState
    (
        TransactionStateId INT IDENTITY (1, 1) NOT NULL,
        OriginalTransactionStateId INT NOT NULL, /* not an IDENTITY column in OLAP */
        TransactionStateName VarChar (100) NOT NULL,
        StartDateTime DateTime NOT NULL,
        EndDateTime NULL
    )

Should I go with bachellorete #2 or bachellorete #3?",5
3741219,09/18/2010 10:05:40,275074,02/17/2010 08:59:21,245,0,Sql - struggling with count/having query based on several joins,"I'm struggling to get my query working. Basically, what it should do is only return vacancies that haven't been filled. For example, a vacancy can have a pre-determined limit of 5. To fill this, it will need to have a mixture of 5 active or pending bookings or simply 5 active or 5 pending bookings.

A pending booking is changed to active when a client accepts it.

It may help by providing a basic schema of my set up:-

    **tbl.vacancies:**
    vacancy_id
    job_category_id
    business_unit_id
    start_date
    publication_date
    end_date
    limit - how many bookings it will accept
    
    **tbl.bookings**
    booking_id
    candidate_id
    vacancy_id
    booking_status_id
    user_id
    date
    
    **btl.booking_status**
    id
    user_id
    booking_status_type_id
    date
    
    **tbl.booking_status_type**
    id (1,2,3,4)
    name (pending, active, rejected, revoked)

My query works fine when displaying all vacancies as I create an inner join between the job_category, business_unit, candidate, booking_status and booking_status_type tables.

But I have a requirement where I need to show filtered data based on if a vacancy has been fulfilled i.e. It has less active/pending bookings than the vacancies limit or it has been fully booked.

The query I'm currently using is:

    SELECT v.*, j.job_category_name, bu.business_unit_name 
    FROM vacancy v 
    INNER JOIN job_category j ON j.job_category_id = v.job_category_id 
    INNER JOIN business_unit bu ON bu.business_unit_id = v.business_unit_id 
    INNER JOIN booking b ON b.vacancy_id = v.vacancy_id 
    INNER JOIN booking_status bs ON bs.id = b.booking_status_id 
    WHERE 
        v.vacancy_status <> 'revoked' AND 
        v.vacancy_reference <> 'auto-generated booking' AND 
        v.business_unit_id IN (series of primary keys) AND 
    (bs.booking_status_type_id = 1 OR bs.booking_status_type_id = 2) 
    GROUP BY v.vacancy_id 
    HAVING v.vacancy_limit > count(b.booking_id)
    ORDER BY v.vacancy_id DESC

The problem occurs when I revoke a booking (booking_status_type_id 4). It seems to mess up the results or not pick up any.

A little scenario of a status change on a booking could be:-

1. User creates booking (Pending state)
2. Client accepts (Active state)
3. Client then decides to revoke (Revoke state)

This will result in entries like so:-

    Vacancy ID = 100;
    Booking ID = 10;
    Booking Status entries:-
    
    Booking_id    Booking_status_type_id
    ---------------------------------------
    10            1
    10            2
    10            4

So in theory this booking shouldn't display in the results as the position has been removed and become available again.

This will result in 3 entries in the booking_status_type table for the status changes on the booking.

I'm unsure as to why my query isn't working or if it is constructed correctly at all. As a basic requirement, when the user opts to select if a booking has been unfilled it should only show vacancies which the sum of the bookings aren't greater than the limit for the booking.

Likewise, when selecting to filter on filled vacancies, it should only show vacancies where the limit has been reached.",sql,count,inner-join,having-clause,,,open,0,637,10,"Sql - struggling with count/having query based on several joins I'm struggling to get my query working. Basically, what it should do is only return vacancies that haven't been filled. For example, a vacancy can have a pre-determined limit of 5. To fill this, it will need to have a mixture of 5 active or pending bookings or simply 5 active or 5 pending bookings.

A pending booking is changed to active when a client accepts it.

It may help by providing a basic schema of my set up:-

    **tbl.vacancies:**
    vacancy_id
    job_category_id
    business_unit_id
    start_date
    publication_date
    end_date
    limit - how many bookings it will accept
    
    **tbl.bookings**
    booking_id
    candidate_id
    vacancy_id
    booking_status_id
    user_id
    date
    
    **btl.booking_status**
    id
    user_id
    booking_status_type_id
    date
    
    **tbl.booking_status_type**
    id (1,2,3,4)
    name (pending, active, rejected, revoked)

My query works fine when displaying all vacancies as I create an inner join between the job_category, business_unit, candidate, booking_status and booking_status_type tables.

But I have a requirement where I need to show filtered data based on if a vacancy has been fulfilled i.e. It has less active/pending bookings than the vacancies limit or it has been fully booked.

The query I'm currently using is:

    SELECT v.*, j.job_category_name, bu.business_unit_name 
    FROM vacancy v 
    INNER JOIN job_category j ON j.job_category_id = v.job_category_id 
    INNER JOIN business_unit bu ON bu.business_unit_id = v.business_unit_id 
    INNER JOIN booking b ON b.vacancy_id = v.vacancy_id 
    INNER JOIN booking_status bs ON bs.id = b.booking_status_id 
    WHERE 
        v.vacancy_status <> 'revoked' AND 
        v.vacancy_reference <> 'auto-generated booking' AND 
        v.business_unit_id IN (series of primary keys) AND 
    (bs.booking_status_type_id = 1 OR bs.booking_status_type_id = 2) 
    GROUP BY v.vacancy_id 
    HAVING v.vacancy_limit > count(b.booking_id)
    ORDER BY v.vacancy_id DESC

The problem occurs when I revoke a booking (booking_status_type_id 4). It seems to mess up the results or not pick up any.

A little scenario of a status change on a booking could be:-

1. User creates booking (Pending state)
2. Client accepts (Active state)
3. Client then decides to revoke (Revoke state)

This will result in entries like so:-

    Vacancy ID = 100;
    Booking ID = 10;
    Booking Status entries:-
    
    Booking_id    Booking_status_type_id
    ---------------------------------------
    10            1
    10            2
    10            4

So in theory this booking shouldn't display in the results as the position has been removed and become available again.

This will result in 3 entries in the booking_status_type table for the status changes on the booking.

I'm unsure as to why my query isn't working or if it is constructed correctly at all. As a basic requirement, when the user opts to select if a booking has been unfilled it should only show vacancies which the sum of the bookings aren't greater than the limit for the booking.

Likewise, when selecting to filter on filled vacancies, it should only show vacancies where the limit has been reached.",4
5606595,04/09/2011 17:25:53,531984,12/06/2010 08:29:33,59,1,SQL Primary Key,"I came across the 2 versions of sql code..  

    --1
    CREATE TABLE Location ( 
	Id     INTEGER PRIMARY KEY 
                       NOT NULL,
	Name   TEXT    NOT NULL 
    );
    
    --2
    CREATE TABLE Location ( 
    	Id     INTEGER PRIMARY KEY 
                           NOT NULL
                           UNIQUE,
    	Name   TEXT    NOT NULL 
    );


In TSQL, is it necessary to specify the primary key to be unique and not null?  
I always assumed that the primary key was unique and could not be null. ",sql,primary-key,unique-key,,,,open,0,199,3,"SQL Primary Key I came across the 2 versions of sql code..  

    --1
    CREATE TABLE Location ( 
	Id     INTEGER PRIMARY KEY 
                       NOT NULL,
	Name   TEXT    NOT NULL 
    );
    
    --2
    CREATE TABLE Location ( 
    	Id     INTEGER PRIMARY KEY 
                           NOT NULL
                           UNIQUE,
    	Name   TEXT    NOT NULL 
    );


In TSQL, is it necessary to specify the primary key to be unique and not null?  
I always assumed that the primary key was unique and could not be null. ",3
4102060,11/04/2010 22:35:42,233421,12/17/2009 00:41:31,1023,0,InnoDB Storage Engine Dropped From Oracle MySQL Classic Edition?,"InnoDB Storage Engine Dropped From Oracle MySQL Classic Edition? What does this mean for the average developer who uses mysql or shall we start looking for alternatives?

http://goo.gl/fb/nIMX6

Thanks in advance ;-)

Just trying to understand what this really means? ",sql,mysql,oracle,innodb,,07/25/2012 12:54:04,not a real question,1,38,9,"InnoDB Storage Engine Dropped From Oracle MySQL Classic Edition? InnoDB Storage Engine Dropped From Oracle MySQL Classic Edition? What does this mean for the average developer who uses mysql or shall we start looking for alternatives?

http://goo.gl/fb/nIMX6

Thanks in advance ;-)

Just trying to understand what this really means? ",4
5880465,05/04/2011 08:13:51,712973,04/18/2011 07:33:31,12,0,sql query formation,"here is my sql query,

     drop table #tempi
 
    CREATE TABLE #tempi ( nav1 VARCHAR(50), nav2 int, nav3 int, nav4 int, nav5 int )  
 
     insert into  #tempi   
        select coalesce(cast(machinename as varchar(28)), 'Grand Total:') as machinename, 
        sum(case when vfrm.job_id = '1001' then DateDiff(mi, 0, total_time)  end) as  CRATE_SMALL ,       
        sum(case when vfrm.job_id = '1002' then DateDiff(mi, 0, total_time)  end) as  CRATE_MEDIUM ,       
        sum(case when vfrm.job_id = '1014' then DateDiff(mi, 0, total_time)  end) as  FRONT_AIR_DEFLECTOR ,       
        sum(case when vfrm.job_id = '9999' then DateDiff(mi, 0, total_time)  end) as  NO_SCHEDULE
        from    ven_fullreportmaster vfrm
                 INNER JOIN ven_descriptionmaster VDM ON VDM.description_id = vfrm..description_id
                        inner join ven_machinemaster vm on  vm.machine_id = vfrm..machine_id
                          where  vfrm.entry_date = convert(varchar, getdate()-7, 105)  
                          --and  vfrm.shift_id =1 
                          and vfrm.is_task_completed ='Y' 
              group by   machinename  with rollup


the out put in tempi table :
----------------------------

    nav1    nav2    nav3   nav4   nav5
  
    abc      0:0     0:0     0:0   1:0

    def      0:0     1:0     2:0   1:0

    ghi      0:0     0:0     0:0   1:0

    grand    0:0     1:0     2:0   3:0
     total


i want to select the columns whose grand total is greater than 0..
how to achieve it plz help me soon..



  
              ",sql,sql-server,tsql,,,,open,0,508,3,"sql query formation here is my sql query,

     drop table #tempi
 
    CREATE TABLE #tempi ( nav1 VARCHAR(50), nav2 int, nav3 int, nav4 int, nav5 int )  
 
     insert into  #tempi   
        select coalesce(cast(machinename as varchar(28)), 'Grand Total:') as machinename, 
        sum(case when vfrm.job_id = '1001' then DateDiff(mi, 0, total_time)  end) as  CRATE_SMALL ,       
        sum(case when vfrm.job_id = '1002' then DateDiff(mi, 0, total_time)  end) as  CRATE_MEDIUM ,       
        sum(case when vfrm.job_id = '1014' then DateDiff(mi, 0, total_time)  end) as  FRONT_AIR_DEFLECTOR ,       
        sum(case when vfrm.job_id = '9999' then DateDiff(mi, 0, total_time)  end) as  NO_SCHEDULE
        from    ven_fullreportmaster vfrm
                 INNER JOIN ven_descriptionmaster VDM ON VDM.description_id = vfrm..description_id
                        inner join ven_machinemaster vm on  vm.machine_id = vfrm..machine_id
                          where  vfrm.entry_date = convert(varchar, getdate()-7, 105)  
                          --and  vfrm.shift_id =1 
                          and vfrm.is_task_completed ='Y' 
              group by   machinename  with rollup


the out put in tempi table :
----------------------------

    nav1    nav2    nav3   nav4   nav5
  
    abc      0:0     0:0     0:0   1:0

    def      0:0     1:0     2:0   1:0

    ghi      0:0     0:0     0:0   1:0

    grand    0:0     1:0     2:0   3:0
     total


i want to select the columns whose grand total is greater than 0..
how to achieve it plz help me soon..



  
              ",3
11562769,07/19/2012 14:14:05,1438268,06/05/2012 20:11:03,21,0,How to relax precision in DOS,Hi I am using sqlcmd in DOS and I am trying to insert floating point data from one table into another. When I do the insert the numbers become truncated. How can i relax the floating point precision here?,sql,dos,sqlcmd,,,07/23/2012 01:07:41,not a real question,1,39,6,How to relax precision in DOS Hi I am using sqlcmd in DOS and I am trying to insert floating point data from one table into another. When I do the insert the numbers become truncated. How can i relax the floating point precision here?,3
11428528,07/11/2012 08:28:05,1480292,06/25/2012 14:30:56,86,14,Is it save to change name column in msdb sysjobs?,"I need to rename a lot of similar named job names so i want to run an update statement to change the `name` column of `msdb..sysjobs`.

Editing system tables is something i am pretty aware of, but changing job names doesnt feel that dangerous, because i think the job_id is what counts. Is it save to do it in this case?

I am using sql server 2008.",sql,sql-server,sql-server-2008,,,,open,0,65,10,"Is it save to change name column in msdb sysjobs? I need to rename a lot of similar named job names so i want to run an update statement to change the `name` column of `msdb..sysjobs`.

Editing system tables is something i am pretty aware of, but changing job names doesnt feel that dangerous, because i think the job_id is what counts. Is it save to do it in this case?

I am using sql server 2008.",3
10206435,04/18/2012 09:20:35,1340735,04/18/2012 07:56:40,1,0,SQL required for selecting records based on priority,"I want a query that will select the records from data below:

condition : select only those record that highest priority in the group (COB,CUR1,CUR2).
Legend: 1 is Highest Priority and 3 is lowest Priority. 

    KEY		COB			CUR1 	CUR2	RATE		PRIORITY
    ------	--------	-----	----	--------	--------
    46051	3/9/2012	AUD		USD		1.0573		1
    44392	3/9/2012	AUD		USD		1.06195		2
    43122	3/9/2012	AUD		USD		1.06585		3
    44394	3/9/2012	BMD		USD		1.0000		2   	
    44395	3/9/2012	BSD		USD		1.0000		2   	
    46052	3/9/2012	BWP		USD		0.13875		1
    44402	3/9/2012	BWP		USD		0.13925		2
    46053	3/9/2012	DKK		RON		0.5859		1
    44406	3/9/2012	EUR		CSD		110.62		2
    46090	3/9/2012	EUR		USD		1.3109		1
    44434	3/9/2012	EUR		USD		1.31185		2
    43154	3/9/2012	EUR		USD		1.32556		3
    44436	3/9/2012	FJD		USD		0.564		2
    43156	3/9/2012	FJD		USD		0.5686		3
    46092	3/9/2012	FKP		USD		1.51195		1
    44437	3/9/2012	GBN		USD		1.6339		2
    43185	3/9/2012	GBP		USD		1.57985		3


output should be :

    KEY		COB			CUR1 	CUR2	RATE		PRIORITY
    ------	--------	-----	----	--------	--------
    46051	3/9/2012	AUD		USD		1.0573		1
    44394	3/9/2012	BMD		USD		1.0000		2   	
    44395	3/9/2012	BSD		USD		1.000		2   	
    44402	3/9/2012	BWP		USD		0.13925		2
    46053	3/9/2012	DKK		RON		0.5859		1
    44406	3/9/2012	EUR		CSD		110.62		2
    46090	3/9/2012	EUR		USD		1.3109		1
    44436	3/9/2012	FJD		USD		0.564		2
    46092	3/9/2012	FKP		USD		1.51195		1
    44437	3/9/2012	GBN		USD		1.6339		2
    43185	3/9/2012	GBP		USD		1.57985		3


Please provide your inputs ?
",sql,oracle,query,,,04/19/2012 13:16:21,too localized,1,183,8,"SQL required for selecting records based on priority I want a query that will select the records from data below:

condition : select only those record that highest priority in the group (COB,CUR1,CUR2).
Legend: 1 is Highest Priority and 3 is lowest Priority. 

    KEY		COB			CUR1 	CUR2	RATE		PRIORITY
    ------	--------	-----	----	--------	--------
    46051	3/9/2012	AUD		USD		1.0573		1
    44392	3/9/2012	AUD		USD		1.06195		2
    43122	3/9/2012	AUD		USD		1.06585		3
    44394	3/9/2012	BMD		USD		1.0000		2   	
    44395	3/9/2012	BSD		USD		1.0000		2   	
    46052	3/9/2012	BWP		USD		0.13875		1
    44402	3/9/2012	BWP		USD		0.13925		2
    46053	3/9/2012	DKK		RON		0.5859		1
    44406	3/9/2012	EUR		CSD		110.62		2
    46090	3/9/2012	EUR		USD		1.3109		1
    44434	3/9/2012	EUR		USD		1.31185		2
    43154	3/9/2012	EUR		USD		1.32556		3
    44436	3/9/2012	FJD		USD		0.564		2
    43156	3/9/2012	FJD		USD		0.5686		3
    46092	3/9/2012	FKP		USD		1.51195		1
    44437	3/9/2012	GBN		USD		1.6339		2
    43185	3/9/2012	GBP		USD		1.57985		3


output should be :

    KEY		COB			CUR1 	CUR2	RATE		PRIORITY
    ------	--------	-----	----	--------	--------
    46051	3/9/2012	AUD		USD		1.0573		1
    44394	3/9/2012	BMD		USD		1.0000		2   	
    44395	3/9/2012	BSD		USD		1.000		2   	
    44402	3/9/2012	BWP		USD		0.13925		2
    46053	3/9/2012	DKK		RON		0.5859		1
    44406	3/9/2012	EUR		CSD		110.62		2
    46090	3/9/2012	EUR		USD		1.3109		1
    44436	3/9/2012	FJD		USD		0.564		2
    46092	3/9/2012	FKP		USD		1.51195		1
    44437	3/9/2012	GBN		USD		1.6339		2
    43185	3/9/2012	GBP		USD		1.57985		3


Please provide your inputs ?
",3
4485859,12/19/2010 23:55:23,257558,01/23/2010 20:48:14,1035,29,Will SQL Die in Data Access Layer?,"My impression is that SQL is slowly becoming like assembly. (Slowly dying off). Especially in regards to the data access layer and that ORMs like hibernate (in java) and entity framework (in c#) or core data (apple) or active record (ruby) will take its place. 

Am I on the right track here, or will there be circumstances where people will find a need to write their select, join, where statements in code?
",sql,language-agnostic,orm,,,12/20/2010 00:26:43,not constructive,1,72,7,"Will SQL Die in Data Access Layer? My impression is that SQL is slowly becoming like assembly. (Slowly dying off). Especially in regards to the data access layer and that ORMs like hibernate (in java) and entity framework (in c#) or core data (apple) or active record (ruby) will take its place. 

Am I on the right track here, or will there be circumstances where people will find a need to write their select, join, where statements in code?
",3
3386536,08/02/2010 09:36:14,233421,12/17/2009 00:41:31,914,0,When to use What Storage Engine in the Real World (MySQL)?,"When to use What Storage Engine in the Real World (MySQL)? I Know MyISAM is good for Full Text Searches and InnoDB is good for Transactions/Referential integrity but What do you use When as there are so Many Storage Engines and Why in the real World.

I guess what i'm after is a discussion of the various Storage Engines in Mysql  so i can increase my Knowledge. Some of the Storage Engines I've Heard about are ScaleDB ,Spider ,PBXT  ,Sphinx etc

Thankyou in advance;-)",sql,mysql,storage-engines,,,07/22/2012 23:59:12,not constructive,1,84,11,"When to use What Storage Engine in the Real World (MySQL)? When to use What Storage Engine in the Real World (MySQL)? I Know MyISAM is good for Full Text Searches and InnoDB is good for Transactions/Referential integrity but What do you use When as there are so Many Storage Engines and Why in the real World.

I guess what i'm after is a discussion of the various Storage Engines in Mysql  so i can increase my Knowledge. Some of the Storage Engines I've Heard about are ScaleDB ,Spider ,PBXT  ,Sphinx etc

Thankyou in advance;-)",3
9947444,03/30/2012 17:09:28,1303791,03/30/2012 17:04:51,1,0,Can you print a SQL Server view?,Is there any way to print the structure (graphically) of a view in SQL Server?,sql,sql-server,,,,03/31/2012 03:24:00,not a real question,1,15,7,Can you print a SQL Server view? Is there any way to print the structure (graphically) of a view in SQL Server?,2
1880013,12/10/2009 10:13:10,132754,07/03/2009 11:00:24,23,1,SQL Full Text search on HTML/XML data,"I have a sql full text catalog on a cms database (SQL 2005). The database holds the CMS page content within a ntext column which is part of the full text catalog.  As expected the searching takes into account the xml tags within the page content so searching for ""H1"" returns all the pages with H1 tags.

Is it possible to apply filters within the full text search to only index data within the xml tags.

I can see it is possible for SQL full text search to index/search .html binary types or xml columns.  However as you can the setup is slightly different to this.

Many Thanks, 

Adam

",sql,full-text-search,full-text-indexing,sql-server,sql-server-2005,,open,0,108,7,"SQL Full Text search on HTML/XML data I have a sql full text catalog on a cms database (SQL 2005). The database holds the CMS page content within a ntext column which is part of the full text catalog.  As expected the searching takes into account the xml tags within the page content so searching for ""H1"" returns all the pages with H1 tags.

Is it possible to apply filters within the full text search to only index data within the xml tags.

I can see it is possible for SQL full text search to index/search .html binary types or xml columns.  However as you can the setup is slightly different to this.

Many Thanks, 

Adam

",5
4368425,12/06/2010 16:11:47,347361,05/21/2010 18:50:38,12,0,Selecting records with most recent date for each 'order',"I have information in the format of the sample table below.  Each file can have multiple grades, I need to select the most recent grade (based on completion date) for each file.  If there is a file w/ the same completion dates, I would select the best grade (a being best and subsequent letters being a lesser grade).  This seems easy, but for some reason having a brain fart



Sample Table:


ID_PK File_No    Grade     Completion_Date

1     Smith      A         10/1/2010

2     Smith      C         9/25/2010

3     Davis      B         11/1/2010

4     Johnson    D         12/5/2010

5     Johnson    A         11/1/2010

6     Johnson    C         10/1/2010

7     Miller     X         9/1/2010

8     Miller     F         12/1/2010

9     Miller     D         10/1/2010


Ideal Results:

1     Smith      A         10/1/2010

3     Davis      B         11/1/2010

4     Johnson    D         12/5/2010

8     Miller     F         12/1/2010


",sql,tsql,,,,,open,0,332,9,"Selecting records with most recent date for each 'order' I have information in the format of the sample table below.  Each file can have multiple grades, I need to select the most recent grade (based on completion date) for each file.  If there is a file w/ the same completion dates, I would select the best grade (a being best and subsequent letters being a lesser grade).  This seems easy, but for some reason having a brain fart



Sample Table:


ID_PK File_No    Grade     Completion_Date

1     Smith      A         10/1/2010

2     Smith      C         9/25/2010

3     Davis      B         11/1/2010

4     Johnson    D         12/5/2010

5     Johnson    A         11/1/2010

6     Johnson    C         10/1/2010

7     Miller     X         9/1/2010

8     Miller     F         12/1/2010

9     Miller     D         10/1/2010


Ideal Results:

1     Smith      A         10/1/2010

3     Davis      B         11/1/2010

4     Johnson    D         12/5/2010

8     Miller     F         12/1/2010


",2
9315471,02/16/2012 16:55:13,1214351,02/16/2012 16:50:36,1,0,Date format issue while importing from a flat file to an SQL database,"I Created an SSIS package where the Data is taken in from a flat flie and is transferred to the database.
 
But this had the confusing and hilarious effect of interpreting dates inconsistently. 
Any dates, where the day was greater than the 12th of the month would be correctly 
interpreted as dd/mm/yyyy but anything less than that would be backwards. 

So 02/15/2012 would be correctly read as the 15th of Feb 2012.

But 02/09/2012 would happily be interpreted as 2nd of Sep 2012.",sql,date,ssis,,,,open,0,82,13,"Date format issue while importing from a flat file to an SQL database I Created an SSIS package where the Data is taken in from a flat flie and is transferred to the database.
 
But this had the confusing and hilarious effect of interpreting dates inconsistently. 
Any dates, where the day was greater than the 12th of the month would be correctly 
interpreted as dd/mm/yyyy but anything less than that would be backwards. 

So 02/15/2012 would be correctly read as the 15th of Feb 2012.

But 02/09/2012 would happily be interpreted as 2nd of Sep 2012.",3
6632325,07/09/2011 02:32:28,836340,07/09/2011 02:32:28,1,0,"Cannot find compilation errors in my code, please help. (SQL)","CREATE OR REPLACE TRIGGER employees_on_delete
BEFORE
DELETE ON employees
FOR EACH ROW
BEGIN
INSERT INTO emp_temp
(employee_id, employee_name, job_id, job_description, HOD, hiredate,
salary, department_id)
VALUES(:old.employee_id, :old.employee_name, :old.job_id, :old.job_description,
:old.hod, :old.hiredate, :old.salary, :old.department_id);
END;
/",sql,,,,,07/09/2011 03:33:48,not a real question,1,23,10,"Cannot find compilation errors in my code, please help. (SQL) CREATE OR REPLACE TRIGGER employees_on_delete
BEFORE
DELETE ON employees
FOR EACH ROW
BEGIN
INSERT INTO emp_temp
(employee_id, employee_name, job_id, job_description, HOD, hiredate,
salary, department_id)
VALUES(:old.employee_id, :old.employee_name, :old.job_id, :old.job_description,
:old.hod, :old.hiredate, :old.salary, :old.department_id);
END;
/",1
9315888,02/16/2012 17:20:33,969134,09/28/2011 13:07:39,187,12,Condition in WHERE clause,"I'm trying to change my WHERE clause based on the value of one column of my table.
My tables are:

**server_updates**

    k1ID        updID
    ----------- -----------

**server_updates_cat**

    sucID        updID       catID       selectChildren   includeNullType
    -----------  ----------- ----------- ---------------- --------------

**server_updates_types**

    sucID       typeID
    ----------- -----------

And here's what I'm doing:

    DECLARE @k1_catID INT
    DECLARE @k4_type INT
    
    SET @k1_catID = 30
    SET @k4_type = 1
    
    SELECT suc.sucID, suc.updID FROM server_updates su
    INNER JOIN server_updates_cat suc ON suc.updID = su.updID
    
    WHERE
    includeNullType = 0
    	AND suc.catID = @k1_catID
    	AND selectChildren = 1
    	AND @k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID)
    OR
    includeNullType = 1	
    	AND KSUC.catID = @k1_catID
    	AND selectChildren = 1
    	AND (@k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID) OR @k4_type IS NULL)

I would like to not have to repeat all conditions either `includeNullType = 0` or `includeNullType = 1`, but change the only thing I really need to change, which is:

`@k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID)`


Is there another way of doing that?",sql,where-clause,,,,,open,0,279,4,"Condition in WHERE clause I'm trying to change my WHERE clause based on the value of one column of my table.
My tables are:

**server_updates**

    k1ID        updID
    ----------- -----------

**server_updates_cat**

    sucID        updID       catID       selectChildren   includeNullType
    -----------  ----------- ----------- ---------------- --------------

**server_updates_types**

    sucID       typeID
    ----------- -----------

And here's what I'm doing:

    DECLARE @k1_catID INT
    DECLARE @k4_type INT
    
    SET @k1_catID = 30
    SET @k4_type = 1
    
    SELECT suc.sucID, suc.updID FROM server_updates su
    INNER JOIN server_updates_cat suc ON suc.updID = su.updID
    
    WHERE
    includeNullType = 0
    	AND suc.catID = @k1_catID
    	AND selectChildren = 1
    	AND @k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID)
    OR
    includeNullType = 1	
    	AND KSUC.catID = @k1_catID
    	AND selectChildren = 1
    	AND (@k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID) OR @k4_type IS NULL)

I would like to not have to repeat all conditions either `includeNullType = 0` or `includeNullType = 1`, but change the only thing I really need to change, which is:

`@k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID)`


Is there another way of doing that?",2
6826177,07/26/2011 06:33:10,287104,03/05/2010 12:10:08,331,11,sql select stetment duration Timeout expired,"we have a regular select stetment

    strSql = ""SELECT PG_ID, PG_FileName, PG_AbsolutePath "" & _
                 ""FROM PHOTO_GALLERY "" & _
                 ""WHERE (PG_ID = "" & lPG_ID & "")""

in sql analyzer it works good and quick, on the page, the duration i get from the profiler is more the 7000 and then i get to the error log we have built, timeout expired

the table photo_gallery has just abit more then 8000 rows

what can be done in order to find the solution for that?

this table has index on PG_ID

the variable lPG_ID is not null - it is a number and it is there in the record",sql,select,timeout,,,,open,0,139,6,"sql select stetment duration Timeout expired we have a regular select stetment

    strSql = ""SELECT PG_ID, PG_FileName, PG_AbsolutePath "" & _
                 ""FROM PHOTO_GALLERY "" & _
                 ""WHERE (PG_ID = "" & lPG_ID & "")""

in sql analyzer it works good and quick, on the page, the duration i get from the profiler is more the 7000 and then i get to the error log we have built, timeout expired

the table photo_gallery has just abit more then 8000 rows

what can be done in order to find the solution for that?

this table has index on PG_ID

the variable lPG_ID is not null - it is a number and it is there in the record",3
11743002,07/31/2012 14:59:14,1366172,04/30/2012 15:44:07,1,0,convert a query to criteria hibernate,"i have trouble to convert this expression to a Criteria expression :

    SELECT profile_profiles.profile_sup_id 
    FROM profil inner join profile_profiles 
    on profile_profiles.profile_id=profil.id 
    and profil.id=4


can anyone help ?
",sql,hibernate,criteria,restriction,,,open,0,41,6,"convert a query to criteria hibernate i have trouble to convert this expression to a Criteria expression :

    SELECT profile_profiles.profile_sup_id 
    FROM profil inner join profile_profiles 
    on profile_profiles.profile_id=profil.id 
    and profil.id=4


can anyone help ?
",4
3240397,07/13/2010 18:50:41,367591,06/15/2010 18:43:38,256,26,Adding a unique constraint on calculated value of a column,"I'm not exactly sure how to phrase this, but here goes...
We have a table structure like the following:

    Id   |   Timestamp    | Type  | Clientid   | ..others..
    001  |   1234567890   | TYPE1 | CL1234567  |.....    
    002  |   1234561890   | TYPE1 | CL1234567  |.....    

Now for the data given above... I would like to have a constraint so that those 2 rows could not exist together. Essentially, I want the table to be

    Unique for (Type, ClientId, CEIL(Timestamp/10000)*10000)

I don't want rows with the same data created within X time of each other to be added to the db, i.e would like a constraint violation in this case. The problem is that, the above constraint is not something I can actually create.

Before you ask, I know, I know.... why right? Well I know a certain scenario should not be happening, but alas it is. I need a sort of stop gap measure for now, so I can buy some time to investigate the actual matter. Let me know if you need additional info...",sql,database,oracle,,,,open,0,212,10,"Adding a unique constraint on calculated value of a column I'm not exactly sure how to phrase this, but here goes...
We have a table structure like the following:

    Id   |   Timestamp    | Type  | Clientid   | ..others..
    001  |   1234567890   | TYPE1 | CL1234567  |.....    
    002  |   1234561890   | TYPE1 | CL1234567  |.....    

Now for the data given above... I would like to have a constraint so that those 2 rows could not exist together. Essentially, I want the table to be

    Unique for (Type, ClientId, CEIL(Timestamp/10000)*10000)

I don't want rows with the same data created within X time of each other to be added to the db, i.e would like a constraint violation in this case. The problem is that, the above constraint is not something I can actually create.

Before you ask, I know, I know.... why right? Well I know a certain scenario should not be happening, but alas it is. I need a sort of stop gap measure for now, so I can buy some time to investigate the actual matter. Let me know if you need additional info...",3
7710153,10/10/2011 08:24:35,939860,09/12/2011 04:04:08,2018,94,What is easier to read in EXISTS subqueries?,"Its a question of **readability**. There is no difference in performance.  
<sub>Old versions of SQL Server were silly enough to look up meta data, but not any more.</sub>  

    SELECT foo FROM bar WHERE EXISTS (SELECT * FROM baz WHERE baz.id = bar.id);
    SELECT foo FROM bar WHERE EXISTS (SELECT 1 FROM baz WHERE baz.id = bar.id);

I am not considering NULL or ""fun variants"", they are clearly not intuitive.  
    <strike> SELECT foo FROM bar WHERE EXISTS (SELECT NULL FROM baz WHERE baz.id = bar.id);  
    SELECT foo FROM bar WHERE EXISTS (SELECT 1/0 FROM baz WHERE baz.id = bar.id);</strike>

The question popped up in comments just now. I researched the manuals of the most popular RDBMS:

 - MS SQL seems to favor `SELECT *` [in the manual][1]
 - The [example in the PostgreSQL 9.1 manual][2] uses `SELECT 1`
 - Oracle 11g has `SELECT *` in the [language reference][3]
 - MySQL 5.6 has `SELECT *` in the [reference manual][4] but mostly `SELECT 1` in the comments.
 - SQLite has no example in the [language reference][5]

A google search for ""EXISTS (SELECT 1"" yields ""About 2,850,000 results"".  
A google search for ""EXISTS (SELECT *"" yields ""About 36,700,000 results"".

A search on SO for ""EXISTS (SELECT 1"" yields 1,528 results.  
A search on SO for ""EXISTS (SELECT *"" yields 5,000+ results.

So `SELECT *` has the popular vote and the big commercial RDBMS on its side.  
I find `SELECT 1` more intuitive. It's like saying ""if at least one exists"".  
Would you find `SELECT *` more intuitive?

  [1]: http://msdn.microsoft.com/en-us/library/ms188336.aspx
  [2]: http://www.postgresql.org/docs/9.1/interactive/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS
  [3]: http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/conditions012.htm#sthref2961
  [4]: http://dev.mysql.com/doc/refman/5.6/en/exists-and-not-exists-subqueries.html
  [5]: http://www.sqlite.org/lang_expr.html#in_op",sql,syntax,exists,,,10/11/2011 02:53:44,not constructive,1,286,8,"What is easier to read in EXISTS subqueries? Its a question of **readability**. There is no difference in performance.  
<sub>Old versions of SQL Server were silly enough to look up meta data, but not any more.</sub>  

    SELECT foo FROM bar WHERE EXISTS (SELECT * FROM baz WHERE baz.id = bar.id);
    SELECT foo FROM bar WHERE EXISTS (SELECT 1 FROM baz WHERE baz.id = bar.id);

I am not considering NULL or ""fun variants"", they are clearly not intuitive.  
    <strike> SELECT foo FROM bar WHERE EXISTS (SELECT NULL FROM baz WHERE baz.id = bar.id);  
    SELECT foo FROM bar WHERE EXISTS (SELECT 1/0 FROM baz WHERE baz.id = bar.id);</strike>

The question popped up in comments just now. I researched the manuals of the most popular RDBMS:

 - MS SQL seems to favor `SELECT *` [in the manual][1]
 - The [example in the PostgreSQL 9.1 manual][2] uses `SELECT 1`
 - Oracle 11g has `SELECT *` in the [language reference][3]
 - MySQL 5.6 has `SELECT *` in the [reference manual][4] but mostly `SELECT 1` in the comments.
 - SQLite has no example in the [language reference][5]

A google search for ""EXISTS (SELECT 1"" yields ""About 2,850,000 results"".  
A google search for ""EXISTS (SELECT *"" yields ""About 36,700,000 results"".

A search on SO for ""EXISTS (SELECT 1"" yields 1,528 results.  
A search on SO for ""EXISTS (SELECT *"" yields 5,000+ results.

So `SELECT *` has the popular vote and the big commercial RDBMS on its side.  
I find `SELECT 1` more intuitive. It's like saying ""if at least one exists"".  
Would you find `SELECT *` more intuitive?

  [1]: http://msdn.microsoft.com/en-us/library/ms188336.aspx
  [2]: http://www.postgresql.org/docs/9.1/interactive/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS
  [3]: http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/conditions012.htm#sthref2961
  [4]: http://dev.mysql.com/doc/refman/5.6/en/exists-and-not-exists-subqueries.html
  [5]: http://www.sqlite.org/lang_expr.html#in_op",3
7545639,09/25/2011 13:00:58,754508,05/15/2011 13:45:42,46,0,SQL cut results from table,"I have the following query:

        SELECT cust_id,cust_name,SUM(calls.duration) as duration
      FROM 
    	  calls, telephone
      
      WHERE calls.from_t_no = telephone.t_no
      AND
      calls.duration <=60
      
      group by telephone.cust_id, telephone.cust_name

Which give the following results;

    cust_id	cust_name duration
    0123456789	Avi	18
    1234567890	Benny	27
    2345678901	Gadi	13
    3456789012	Dalia	69
    4567890123	Hilla	5
    5678901234	Varda	14
    7890123456	Haim	20
    8901234567	Tali	20
    9012345678	Yoram	46


I also have this query:

    SELECT cust_id,cust_name,SUM(calls.duration) as duration 
    	  FROM calls ,telephone
    	  WHERE to_t_no = telephone.t_no
    	  AND
    	  calls.duration >=500
    	  group by telephone.cust_id, telephone.cust_name

Which provides the following results:

    cust_id	cust_name	duration
    2345678901	Gadi	50022
    4567890123	Hilla	50000


the second query is actually another filter or condition which the first query should match.
I cannot include the second query within the first query because it uses different columns.
I need to ""subtract"" the second query from the first query.

How do I do that?",sql,,,,,09/26/2011 06:44:45,too localized,1,227,5,"SQL cut results from table I have the following query:

        SELECT cust_id,cust_name,SUM(calls.duration) as duration
      FROM 
    	  calls, telephone
      
      WHERE calls.from_t_no = telephone.t_no
      AND
      calls.duration <=60
      
      group by telephone.cust_id, telephone.cust_name

Which give the following results;

    cust_id	cust_name duration
    0123456789	Avi	18
    1234567890	Benny	27
    2345678901	Gadi	13
    3456789012	Dalia	69
    4567890123	Hilla	5
    5678901234	Varda	14
    7890123456	Haim	20
    8901234567	Tali	20
    9012345678	Yoram	46


I also have this query:

    SELECT cust_id,cust_name,SUM(calls.duration) as duration 
    	  FROM calls ,telephone
    	  WHERE to_t_no = telephone.t_no
    	  AND
    	  calls.duration >=500
    	  group by telephone.cust_id, telephone.cust_name

Which provides the following results:

    cust_id	cust_name	duration
    2345678901	Gadi	50022
    4567890123	Hilla	50000


the second query is actually another filter or condition which the first query should match.
I cannot include the second query within the first query because it uses different columns.
I need to ""subtract"" the second query from the first query.

How do I do that?",1
706905,04/01/2009 18:55:09,73637,03/04/2009 11:40:14,3,0,Indexing in Sql Server,What is Clustured and non clustured indexing? How to index a table using sql server 2000 Enterprise manager?   thanks in advance for your kind reply..,sql,server,,,,,open,0,27,4,Indexing in Sql Server What is Clustured and non clustured indexing? How to index a table using sql server 2000 Enterprise manager?   thanks in advance for your kind reply..,2
6764233,07/20/2011 15:14:42,854192,07/20/2011 14:52:46,1,0,Join several selects,"I have tables like this fake ones:

[http://lzzbr.com/temp/sql.png][1]

How can I make this query?
I'm using Oracle 10g.


  [1]: http://lzzbr.com/temp/sql.png",sql,oracle,select,,,07/22/2011 01:51:26,not a real question,1,18,3,"Join several selects I have tables like this fake ones:

[http://lzzbr.com/temp/sql.png][1]

How can I make this query?
I'm using Oracle 10g.


  [1]: http://lzzbr.com/temp/sql.png",3
3072659,06/18/2010 19:54:26,348218,05/23/2010 10:04:24,21,1,Choice Between Oracle DBA and Data Analyst which one is better career option,I am very confused about making choice between being a Oracle DBA or SAS Data Analyst. I've got B.Sc.Maths degree and have decided to make inroad in computer and some friends have suggested me SAS as better option than DBA. But I have heard that DBA is money and job stability-wise better than a data analysyt. I have no very much programming experience and have done SQL but not so much intensively or extensibly. Could some one help me in this regard? I get tense whenever i think about it. THANK YOU.,sql,oracle,sas,,,06/19/2010 02:59:19,off topic,1,92,13,Choice Between Oracle DBA and Data Analyst which one is better career option I am very confused about making choice between being a Oracle DBA or SAS Data Analyst. I've got B.Sc.Maths degree and have decided to make inroad in computer and some friends have suggested me SAS as better option than DBA. But I have heard that DBA is money and job stability-wise better than a data analysyt. I have no very much programming experience and have done SQL but not so much intensively or extensibly. Could some one help me in this regard? I get tense whenever i think about it. THANK YOU.,3
11717210,07/30/2012 07:40:23,1513489,07/10/2012 02:14:33,1,0,how to import csv file part by part sql server 2008,"I use 'bulk insert' to insert a csv file to the database. However, I need to do some filtering before insert it into the db. So, I want to import it part by part into temp table, do the filtering and then insert the filtered result into the db. In this way, I could save many space since the original csv is really big. Any idea how to do that using 'bulk insert'?",sql,,,,,07/31/2012 11:47:45,not a real question,1,73,11,"how to import csv file part by part sql server 2008 I use 'bulk insert' to insert a csv file to the database. However, I need to do some filtering before insert it into the db. So, I want to import it part by part into temp table, do the filtering and then insert the filtered result into the db. In this way, I could save many space since the original csv is really big. Any idea how to do that using 'bulk insert'?",1
11348780,07/05/2012 16:38:51,1504636,07/05/2012 16:30:51,1,0,Unable To Run Access Report With Column Name Which Has Special Character,"I'm trying to run a report in Access that references a poorly named column: Vendor#. For those of you not familiar with Access: '#' is a reserved keyword with special meaning. I've been trying to run the report and every time I do a popup appears asking for a value for the column: in other words it keeps seeing it as a variable name. I've tried a number of variations on the name including: [Vendor#], 'Vendor#', ['Vendor#']. I tried an Alias but then I encountered the same issue in the where clause referencing the Alias. No I can't change the schema to rename the column to something more appropriate. Any help is appreciated.",sql,sql-server,ms-access-2007,office,,,open,0,113,12,"Unable To Run Access Report With Column Name Which Has Special Character I'm trying to run a report in Access that references a poorly named column: Vendor#. For those of you not familiar with Access: '#' is a reserved keyword with special meaning. I've been trying to run the report and every time I do a popup appears asking for a value for the column: in other words it keeps seeing it as a variable name. I've tried a number of variations on the name including: [Vendor#], 'Vendor#', ['Vendor#']. I tried an Alias but then I encountered the same issue in the where clause referencing the Alias. No I can't change the schema to rename the column to something more appropriate. Any help is appreciated.",4
7258255,08/31/2011 14:14:22,408257,08/02/2010 02:34:03,30,1,Something like reference counting or shared pointers for database rows?,"First of all, I am using Postgres 9.1.

I have a table named filepaths and other tables that have rows that point to the id of their corresponding filepaths.  Is there a common design approach for reference counting the filepaths so that when other rows are dropped and there are no longer any references to a particular filepath row, it can be dropped as well?  

Example:


        [filepaths]
        1 | c:\windows\system32\test.exe
        2 | c:\windows\calc.exe

        [events_2011_08_30]
        [1][timestamp][other data] [ filepaths = 1]
        [2][timestamp][other data] [ filepaths = 2]

        [events_2011_08_31]
        [1][timestamp][other data] [ filepaths = 1]


So I will be storing data in tables to partition it, and I want to delete old tables when they are older than say 30 days (will still have them archived).  In the above example, let's assume there are only those two events_<date> tables.  If I delete the 2011_08_30, I would desire a way to know that nothing is pointing to filepaths '2' and therefore remove it, but know that a row is still pointing to filepaths '1' and therefore retain it.

Any thoughts, suggestions, etc? I believe some of the strategies I have read, at least for postgres and triggers, still have race conditions about which thread got a lock first on the primary key column and other related issues.

Thanks!
",sql,postgresql,foreign-keys,,,,open,0,271,10,"Something like reference counting or shared pointers for database rows? First of all, I am using Postgres 9.1.

I have a table named filepaths and other tables that have rows that point to the id of their corresponding filepaths.  Is there a common design approach for reference counting the filepaths so that when other rows are dropped and there are no longer any references to a particular filepath row, it can be dropped as well?  

Example:


        [filepaths]
        1 | c:\windows\system32\test.exe
        2 | c:\windows\calc.exe

        [events_2011_08_30]
        [1][timestamp][other data] [ filepaths = 1]
        [2][timestamp][other data] [ filepaths = 2]

        [events_2011_08_31]
        [1][timestamp][other data] [ filepaths = 1]


So I will be storing data in tables to partition it, and I want to delete old tables when they are older than say 30 days (will still have them archived).  In the above example, let's assume there are only those two events_<date> tables.  If I delete the 2011_08_30, I would desire a way to know that nothing is pointing to filepaths '2' and therefore remove it, but know that a row is still pointing to filepaths '1' and therefore retain it.

Any thoughts, suggestions, etc? I believe some of the strategies I have read, at least for postgres and triggers, still have race conditions about which thread got a lock first on the primary key column and other related issues.

Thanks!
",3
6493967,06/27/2011 13:55:47,817501,06/27/2011 13:55:47,1,0,SQL Injection on INSERT statement,"I have to follow query which I wanna break:

    INSERT INTO `table` (`A`,`B`,`C`,`D`,`E`,`F`,`G`,`TIMESTAMP`) 
    VALUES              ('' ,'1','2','z','X','1','n',NOW());

WHERE X is the value which comes from POST

I wanna inject a UPDATE statement:

what I tryd:

    ' XOR (UPDATE `table2` SET `VALUE` = 'j' WHERE `TABLE_ID` = 2) OR '

also this:

    Test','0','n',NOW()); UPDATE `table2` SET `VALUE` = j WHERE `TABLE_ID` = 2); --

But both give me a error. Any Idea how to do it? Query 1 works when there is not UPDATE inserted (example ' XOR TRUE ' OR ') and query 2 wont accept ether the escapeing -- or the secound query?

Thanks for your help.


",sql,update,insert,sql-injection,injection,06/27/2011 14:06:24,not constructive,1,127,5,"SQL Injection on INSERT statement I have to follow query which I wanna break:

    INSERT INTO `table` (`A`,`B`,`C`,`D`,`E`,`F`,`G`,`TIMESTAMP`) 
    VALUES              ('' ,'1','2','z','X','1','n',NOW());

WHERE X is the value which comes from POST

I wanna inject a UPDATE statement:

what I tryd:

    ' XOR (UPDATE `table2` SET `VALUE` = 'j' WHERE `TABLE_ID` = 2) OR '

also this:

    Test','0','n',NOW()); UPDATE `table2` SET `VALUE` = j WHERE `TABLE_ID` = 2); --

But both give me a error. Any Idea how to do it? Query 1 works when there is not UPDATE inserted (example ' XOR TRUE ' OR ') and query 2 wont accept ether the escapeing -- or the secound query?

Thanks for your help.


",5
11532284,07/17/2012 23:28:20,1533216,07/17/2012 23:24:32,1,0,SQl query to join different tables,I have a excel spread sheet and I have columns from different tables and I was able to figure out all of them (I mean from which tables they are) is there any efficient way to combine these tables apart from Inner join ...,sql,,,,,07/20/2012 12:25:26,not a real question,1,44,6,SQl query to join different tables I have a excel spread sheet and I have columns from different tables and I was able to figure out all of them (I mean from which tables they are) is there any efficient way to combine these tables apart from Inner join ...,1
11706761,07/29/2012 04:49:02,1560502,07/29/2012 04:40:45,1,0,learning sql for the first time,"now im new to the forum so i dont know if ive posted this into the correct area.....
Im wanting a career change and want to get back into developing/programming.
after graduating(business it) i had a change of direction with stuff that came up in my personal life.
im 30, and ive been a sales manager at a retail company, but just havent got my heart in it anymore.
Ive always wanted to be a programmer/developer and i just want to get on with it.
i want to get into sharepoint but before that i would like to learn sql. because im at work and with family and kids i dont have much time. i will be putting in rougly about 30 hours per week into it.
 now i really want your expert help about where would be the best place to get good training/resourses/materials for learning sql first.
help will be appreciated alot.",sql,,,,,07/29/2012 10:48:53,off topic,1,148,6,"learning sql for the first time now im new to the forum so i dont know if ive posted this into the correct area.....
Im wanting a career change and want to get back into developing/programming.
after graduating(business it) i had a change of direction with stuff that came up in my personal life.
im 30, and ive been a sales manager at a retail company, but just havent got my heart in it anymore.
Ive always wanted to be a programmer/developer and i just want to get on with it.
i want to get into sharepoint but before that i would like to learn sql. because im at work and with family and kids i dont have much time. i will be putting in rougly about 30 hours per week into it.
 now i really want your expert help about where would be the best place to get good training/resourses/materials for learning sql first.
help will be appreciated alot.",1
11567844,07/19/2012 19:21:39,1475788,06/22/2012 19:37:17,24,0,SQL Many to many select distinct,"I need some help with the following query. So far what I have is below. What I am trying to do is get uniqure ServiceEntryPart records when parts are same and multiple service entry records when parts are unique. The following query works fine with the search filters, its just I need to get unique records when multiple parts are not present. Thanks


    SELECT * FROM ServiceEntryPart    
              INNER JOIN Part  
              on ServiceEntryPart.PartID = Part.ID  
               WHERE (ServiceDateTime between @StartDate and @EndDate)  
               AND ((@ActivePart = 0 AND Part.Active is not null) or (@ActivePart = 1 and Part.Active = 0))  
               AND (ServiceEntryPart.ServiceTypeIDs = ISNULL(@ServiceTypes,ServiceEntryPart.ServiceTypeIDs))
               AND ( @ServiceTypes is null or 
               charindex(','+cast(ServiceEntryPart.ServiceTypeIDs as varchar(255))+',',
               ','+@ServiceTypes+',') > 0)
        
        Sample Filter
        
        @ServiceTypes = (2,3) OR @ServiceTypes = ''
        @ActivePart = 1 or @ActivePart = 0
        
        DBO.ServiceEntryPart
        ID       SERVICEENTRYID   PartID            ServiceTypeIDs
        1063	1	         266		1
        1064	1	         267		1
        1065	1	         268		1,2
        706	96	         324		7
        707	96	         327		7
        682	244	         397		NULL
        683	264	         382	         NULL
        
        DBO.Part
        ID       DESCRIPTION       PARENTID ACTIVE
        13	Barcode Reader	       2	    1
        14	Dispersion Motor	       2	    1	
        15	Robot	                2	    1	 
        16	RFID Reader	       2	    1	
        20	Gantry	                3	    0	 
        23	Sample Wash Cup	       3	    1	
        24	R1Wash Cup	       3	    1	",sql,sql-server,,,,07/20/2012 06:46:49,not a real question,1,664,6,"SQL Many to many select distinct I need some help with the following query. So far what I have is below. What I am trying to do is get uniqure ServiceEntryPart records when parts are same and multiple service entry records when parts are unique. The following query works fine with the search filters, its just I need to get unique records when multiple parts are not present. Thanks


    SELECT * FROM ServiceEntryPart    
              INNER JOIN Part  
              on ServiceEntryPart.PartID = Part.ID  
               WHERE (ServiceDateTime between @StartDate and @EndDate)  
               AND ((@ActivePart = 0 AND Part.Active is not null) or (@ActivePart = 1 and Part.Active = 0))  
               AND (ServiceEntryPart.ServiceTypeIDs = ISNULL(@ServiceTypes,ServiceEntryPart.ServiceTypeIDs))
               AND ( @ServiceTypes is null or 
               charindex(','+cast(ServiceEntryPart.ServiceTypeIDs as varchar(255))+',',
               ','+@ServiceTypes+',') > 0)
        
        Sample Filter
        
        @ServiceTypes = (2,3) OR @ServiceTypes = ''
        @ActivePart = 1 or @ActivePart = 0
        
        DBO.ServiceEntryPart
        ID       SERVICEENTRYID   PartID            ServiceTypeIDs
        1063	1	         266		1
        1064	1	         267		1
        1065	1	         268		1,2
        706	96	         324		7
        707	96	         327		7
        682	244	         397		NULL
        683	264	         382	         NULL
        
        DBO.Part
        ID       DESCRIPTION       PARENTID ACTIVE
        13	Barcode Reader	       2	    1
        14	Dispersion Motor	       2	    1	
        15	Robot	                2	    1	 
        16	RFID Reader	       2	    1	
        20	Gantry	                3	    0	 
        23	Sample Wash Cup	       3	    1	
        24	R1Wash Cup	       3	    1	",2
5756368,04/22/2011 14:18:32,704169,04/12/2011 13:29:04,1,0,In line View SQL,"SELECT ddd.invoice_fk,sss.invoice_rid, ddd.inventory_num, sss.billing_account, sss.Invoice_date 
FROM ( SELECT invoice_rid, billing_account, max(invoice_date) as Invoice_date  
FROM im_invoice  
group by invoice_rid, billing_account ) sss, im_invoice_inventory ddd
where ddd.invoice_fk= sss.invoice_rid
and ddd.inventory_num = '1131497271'

O/P

206973	206973	1131497271	1011964	2010-01-02 00:00:00.000
206974	206974	1131497271	1011964	2009-12-02 00:00:00.000
214493	214493	1131497271	1011964	2010-02-02 00:00:00.000
249202	249202	1131497271	1011964	2010-04-02 00:00:00.000

Hi from this Query i am not able to find out lastest date for inventory No's, pleas help me with this. 

here is the tabel Structur

Here is the table structure, 

•	One Billing account can have Multiple Invoice num, (in Query invoice_num we dint use,).
•	Invoice_rid  and invoice_fk will generate with respect invoice_num.
•	One invoice_num can have multiple inventories.
•	Inventory_num  & invoice_fk  are available in im_invoice_inventroy table

Here is the invoice data

  
Ap Extracted 	040402634066 
  	  Claro Argentina 
03/01/2010 	03/19/2010 	20097727994 	CD 	  $0.00 	 $3,293.45 	 $3,293.45 	 	 
  
Ap Extracted 	040402719235 
 	  Claro Argentina 
04/01/2010 	04/20/2010 	20097727994 	CD 	  $0.00 	 $1,374.84 	 $1,374.84 	 	 
  
Ap Extracted 	040402804459 
 	  Claro Argentina 
05/01/2010 	05/19/2010 	20097727994 	CD 	  $0.00 	 $1,253.60 	 $1,253.60 	 	 
  
Ap Extracted 	040403143672 
 	  Claro Argentina 
09/01/2010 	09/21/2010 	20097727994 	CD 	  $0.00 	 $1,312.80 	 $1,312.80 	 	 
  
Ap Extracted 	040403060776 
 	  Claro Argentina 
08/01/2010 	08/19/2010 	20097727994 	CD 	  $0.00 	 $1,777.59 	 $1,777.59 	 	 
  
Ap Extracted 	040402976157 
 	  Claro Argentina 
07/01/2010 	07/20/2010 	20097727994 	CD 	  $0.00 	 $1,946.75 	 $1,946.75 	 	 
  
Ap Extracted 	040402890800 
 	  Claro Argentina 
06/01/2010 	06/18/2010 	20097727994 	CD 	  $0.00 	 $1,435.70 	 $1,435.70 	 	 
  
Ap Extracted 	040403563442 
 	  Claro Argentina 
02/01/2011 	02/18/2011 	20097727994 	CD 	  $0.00 	 $1,180.03 	 $1,180.03 	 	 
  
Ap Extracted 	040403488021 
 	  Claro Argentina 
01/01/2011 	01/19/2011 	20097727994 	CD 	  $0.00 	 $1,282.31 	 $1,282.31 	 	 
  
Ap Extracted 	040403406547 
 	  Claro Argentina 
12/01/2010 	12/21/2010 	20097727994 	CD 	  $0.00 	 $1,803.05 	 $1,803.05 	 	 
  
Ap Extracted 	040403650134 
 	  Claro Argentina 
03/01/2011 	03/18/2011 	20097727994 	CD 	  $0.00 	 $1,357.64 	 $1,357.64 	 	 


and please explain how i can use inline query more effectively in SQL Queries.


In Above Query, invoice_fk is forien key for im_invoice table, and invoice_rid is Primary key for im_invoice table.


Thanks & Regards
Srinivas

",sql,query,inline,,,,open,0,389,4,"In line View SQL SELECT ddd.invoice_fk,sss.invoice_rid, ddd.inventory_num, sss.billing_account, sss.Invoice_date 
FROM ( SELECT invoice_rid, billing_account, max(invoice_date) as Invoice_date  
FROM im_invoice  
group by invoice_rid, billing_account ) sss, im_invoice_inventory ddd
where ddd.invoice_fk= sss.invoice_rid
and ddd.inventory_num = '1131497271'

O/P

206973	206973	1131497271	1011964	2010-01-02 00:00:00.000
206974	206974	1131497271	1011964	2009-12-02 00:00:00.000
214493	214493	1131497271	1011964	2010-02-02 00:00:00.000
249202	249202	1131497271	1011964	2010-04-02 00:00:00.000

Hi from this Query i am not able to find out lastest date for inventory No's, pleas help me with this. 

here is the tabel Structur

Here is the table structure, 

•	One Billing account can have Multiple Invoice num, (in Query invoice_num we dint use,).
•	Invoice_rid  and invoice_fk will generate with respect invoice_num.
•	One invoice_num can have multiple inventories.
•	Inventory_num  & invoice_fk  are available in im_invoice_inventroy table

Here is the invoice data

  
Ap Extracted 	040402634066 
  	  Claro Argentina 
03/01/2010 	03/19/2010 	20097727994 	CD 	  $0.00 	 $3,293.45 	 $3,293.45 	 	 
  
Ap Extracted 	040402719235 
 	  Claro Argentina 
04/01/2010 	04/20/2010 	20097727994 	CD 	  $0.00 	 $1,374.84 	 $1,374.84 	 	 
  
Ap Extracted 	040402804459 
 	  Claro Argentina 
05/01/2010 	05/19/2010 	20097727994 	CD 	  $0.00 	 $1,253.60 	 $1,253.60 	 	 
  
Ap Extracted 	040403143672 
 	  Claro Argentina 
09/01/2010 	09/21/2010 	20097727994 	CD 	  $0.00 	 $1,312.80 	 $1,312.80 	 	 
  
Ap Extracted 	040403060776 
 	  Claro Argentina 
08/01/2010 	08/19/2010 	20097727994 	CD 	  $0.00 	 $1,777.59 	 $1,777.59 	 	 
  
Ap Extracted 	040402976157 
 	  Claro Argentina 
07/01/2010 	07/20/2010 	20097727994 	CD 	  $0.00 	 $1,946.75 	 $1,946.75 	 	 
  
Ap Extracted 	040402890800 
 	  Claro Argentina 
06/01/2010 	06/18/2010 	20097727994 	CD 	  $0.00 	 $1,435.70 	 $1,435.70 	 	 
  
Ap Extracted 	040403563442 
 	  Claro Argentina 
02/01/2011 	02/18/2011 	20097727994 	CD 	  $0.00 	 $1,180.03 	 $1,180.03 	 	 
  
Ap Extracted 	040403488021 
 	  Claro Argentina 
01/01/2011 	01/19/2011 	20097727994 	CD 	  $0.00 	 $1,282.31 	 $1,282.31 	 	 
  
Ap Extracted 	040403406547 
 	  Claro Argentina 
12/01/2010 	12/21/2010 	20097727994 	CD 	  $0.00 	 $1,803.05 	 $1,803.05 	 	 
  
Ap Extracted 	040403650134 
 	  Claro Argentina 
03/01/2011 	03/18/2011 	20097727994 	CD 	  $0.00 	 $1,357.64 	 $1,357.64 	 	 


and please explain how i can use inline query more effectively in SQL Queries.


In Above Query, invoice_fk is forien key for im_invoice table, and invoice_rid is Primary key for im_invoice table.


Thanks & Regards
Srinivas

",3
11623192,07/24/2012 02:17:01,348434,05/16/2010 06:45:57,184,0,When it is OK to use SELECT * in SQL,I understand that in general it is a bad idea to use SELECT * in SQL. Are there any exception cases? Thanks!,sql,select,,,,07/27/2012 04:22:04,not constructive,1,22,10,When it is OK to use SELECT * in SQL I understand that in general it is a bad idea to use SELECT * in SQL. Are there any exception cases? Thanks!,2
453074,01/17/2009 09:45:54,37511,11/13/2008 22:53:48,65,2,"Implementing an efficient system of ""unread comments"" counters.","I am trying to find an optimal solution for the following problem: there is a need to design a database (postgres-based), the system of triggers and counters in it, which will form a system of efficiently querying, updating and storing information on 'how much unread comments exist in each article (or blog entry, or smth. similar), that is displayed on the page'.

Every solution that comes to the head, has some serious disadvantages, either in querying, or the storing, or the updating part. I.e. it needs too much storage, or too much updates, or too costy queries.

What about your expirience? Maybe there is an already formed nice solution for this kind of problems?",sql,database,counters,,,,open,0,112,8,"Implementing an efficient system of ""unread comments"" counters. I am trying to find an optimal solution for the following problem: there is a need to design a database (postgres-based), the system of triggers and counters in it, which will form a system of efficiently querying, updating and storing information on 'how much unread comments exist in each article (or blog entry, or smth. similar), that is displayed on the page'.

Every solution that comes to the head, has some serious disadvantages, either in querying, or the storing, or the updating part. I.e. it needs too much storage, or too much updates, or too costy queries.

What about your expirience? Maybe there is an already formed nice solution for this kind of problems?",3
2502032,03/23/2010 17:13:42,57083,01/20/2009 12:44:23,292,13,SQL Update to the SUM if it's joined values,"I'm trying to update a field in the database to the sum of it's joined values:

    UPDATE P
    SET extrasPrice = SUM(E.price)
    FROM dbo.BookingPitchExtras AS E
    INNER JOIN dbo.BookingPitches AS P ON E.pitchID = P.ID
        AND P.bookingID = 1
    WHERE E.[required] = 1

When I run this I get the following error:

""An aggregate may not appear in the set list of an UPDATE statement.""

Any ideas?",sql,update,sum,,,,open,0,86,9,"SQL Update to the SUM if it's joined values I'm trying to update a field in the database to the sum of it's joined values:

    UPDATE P
    SET extrasPrice = SUM(E.price)
    FROM dbo.BookingPitchExtras AS E
    INNER JOIN dbo.BookingPitches AS P ON E.pitchID = P.ID
        AND P.bookingID = 1
    WHERE E.[required] = 1

When I run this I get the following error:

""An aggregate may not appear in the set list of an UPDATE statement.""

Any ideas?",3
11573362,07/20/2012 05:25:21,1539783,07/20/2012 05:21:01,1,0,extract data from filename using sql server,"I want to extract data from filename where filename is ""20120522175832546.PBF"".In this i need ""PBF"" from filename using sql query.(Platform Sql server 2005)",sql,sql-server-2005,,,,07/20/2012 12:18:09,not a real question,1,23,7,"extract data from filename using sql server I want to extract data from filename where filename is ""20120522175832546.PBF"".In this i need ""PBF"" from filename using sql query.(Platform Sql server 2005)",2
6280490,06/08/2011 14:34:38,775917,05/30/2011 07:59:14,7,0,join 2 queries SQL + ColdFusion,"Got two queries, and can't make them work properly, they end product gives the repeated items, here is the quries:

**1st Query**

    <cfquery name=""get_partner_all"" datasource=""#dsn#"">
    	SELECT 	
    		C.COMPANY_ID,
    		C.FULLNAME,
    		CP.MOBILTEL,
    		CP.MOBIL_CODE, 
    		CP.IMCAT_ID,
    		CP.COMPANY_PARTNER_TEL, 
    		CP.COMPANY_PARTNER_TELCODE,
    		CP.COMPANY_PARTNER_TEL_EXT,
    		CP.MISSION, 
    		CP.DEPARTMENT, 
    		CP.TITLE,
    		CP.COMPANY_PARTNER_SURNAME, 
    		CP.COMPANY_PARTNER_NAME, 
    		CP.PARTNER_ID, 
    		CP.COMPANY_PARTNER_EMAIL, 
    		CP.HOMEPAGE, 
    		CP.COUNTY,
    		CP.COUNTRY,
    		CP.COMPANY_PARTNER_ADDRESS, 
    		CP.COMPANY_PARTNER_FAX,
    		CP.RECORD_DATE,
    		CP.MEMBER_CODE,
    		CC.COMPANYCAT
    		<cfif isdefined('attributes.report_sort') and attributes.report_sort is 2>
    		,CCD.SITE_DOMAIN
    		</cfif>
    	FROM
    		COMPANY_PARTNER CP,
    		COMPANY C,
    		COMPANY_CAT CC
    		<cfif isdefined('attributes.report_sort') and attributes.report_sort is 2>
    		,COMPANY_CONSUMER_DOMAINS CCD
    		</cfif>
    	WHERE
    		C.COMPANY_ID = CP.COMPANY_ID
    		AND C.COMPANYCAT_ID = CC.COMPANYCAT_ID		
        <cfif isDefined('attributes.search_status') and len(attributes.search_status)> 
    		AND CP.COMPANY_PARTNER_STATUS = <cfqueryparam cfsqltype=""cf_sql_integer"" value=""#attributes.search_status#"">
    	</cfif>
    	<cfelseif isDefined(""attributes.comp_cat"") and len(attributes.comp_cat)>
    		AND C.COMPANYCAT_ID = <cfqueryparam cfsqltype=""cf_sql_integer"" value=""#attributes.comp_cat#"">
    	</cfif>
    	<cfif isdefined('attributes.report_sort') and attributes.report_sort is 2>
    		AND CP.PARTNER_ID = CCD.PARTNER_ID
    		AND CCD.SITE_DOMAIN = 'www.projedepo.com'
    	</cfif>
    </cfquery>

**2nd Query:**

    <cfquery name=""get_money"" datasource=""#dsn2#"">
    	SELECT BAKIYE,BORC,ALACAK FROM COMPANY_REMAINDER_MONEY WHERE COMPANY_ID = #company_id#
    </cfquery>

when i try to define the for example C.COMPANY_ID=CRM.COMPANY_ID it shows some repeated items, i know that i should use smth like JOIN and other stuff, but can't understand how to do it :) need help, and thank you all for help!",sql,query,join,coldfusion,,,open,0,344,6,"join 2 queries SQL + ColdFusion Got two queries, and can't make them work properly, they end product gives the repeated items, here is the quries:

**1st Query**

    <cfquery name=""get_partner_all"" datasource=""#dsn#"">
    	SELECT 	
    		C.COMPANY_ID,
    		C.FULLNAME,
    		CP.MOBILTEL,
    		CP.MOBIL_CODE, 
    		CP.IMCAT_ID,
    		CP.COMPANY_PARTNER_TEL, 
    		CP.COMPANY_PARTNER_TELCODE,
    		CP.COMPANY_PARTNER_TEL_EXT,
    		CP.MISSION, 
    		CP.DEPARTMENT, 
    		CP.TITLE,
    		CP.COMPANY_PARTNER_SURNAME, 
    		CP.COMPANY_PARTNER_NAME, 
    		CP.PARTNER_ID, 
    		CP.COMPANY_PARTNER_EMAIL, 
    		CP.HOMEPAGE, 
    		CP.COUNTY,
    		CP.COUNTRY,
    		CP.COMPANY_PARTNER_ADDRESS, 
    		CP.COMPANY_PARTNER_FAX,
    		CP.RECORD_DATE,
    		CP.MEMBER_CODE,
    		CC.COMPANYCAT
    		<cfif isdefined('attributes.report_sort') and attributes.report_sort is 2>
    		,CCD.SITE_DOMAIN
    		</cfif>
    	FROM
    		COMPANY_PARTNER CP,
    		COMPANY C,
    		COMPANY_CAT CC
    		<cfif isdefined('attributes.report_sort') and attributes.report_sort is 2>
    		,COMPANY_CONSUMER_DOMAINS CCD
    		</cfif>
    	WHERE
    		C.COMPANY_ID = CP.COMPANY_ID
    		AND C.COMPANYCAT_ID = CC.COMPANYCAT_ID		
        <cfif isDefined('attributes.search_status') and len(attributes.search_status)> 
    		AND CP.COMPANY_PARTNER_STATUS = <cfqueryparam cfsqltype=""cf_sql_integer"" value=""#attributes.search_status#"">
    	</cfif>
    	<cfelseif isDefined(""attributes.comp_cat"") and len(attributes.comp_cat)>
    		AND C.COMPANYCAT_ID = <cfqueryparam cfsqltype=""cf_sql_integer"" value=""#attributes.comp_cat#"">
    	</cfif>
    	<cfif isdefined('attributes.report_sort') and attributes.report_sort is 2>
    		AND CP.PARTNER_ID = CCD.PARTNER_ID
    		AND CCD.SITE_DOMAIN = 'www.projedepo.com'
    	</cfif>
    </cfquery>

**2nd Query:**

    <cfquery name=""get_money"" datasource=""#dsn2#"">
    	SELECT BAKIYE,BORC,ALACAK FROM COMPANY_REMAINDER_MONEY WHERE COMPANY_ID = #company_id#
    </cfquery>

when i try to define the for example C.COMPANY_ID=CRM.COMPANY_ID it shows some repeated items, i know that i should use smth like JOIN and other stuff, but can't understand how to do it :) need help, and thank you all for help!",4
8109272,11/13/2011 02:52:46,937594,09/09/2011 21:38:20,61,1,SQL Server : voiding records with message,"I have a TableA (ID int, [set] int,[status] char(20), message char(20))

    ID set status message
    1   1
    2   1  MATCH
    3   3
    4   3  MATCH
    5   2
    6   2

Now I want to do two things here:

set status = 'void' where it is not 'match' in the same set. so ID with 1 and 3 will get the void.

 set message = ""For ID = xx"" where xx is ID. set the message where it is void also pointing to its corresponding matched ID. 

Expected result:

    ID set status message
    1   1  VOID   For ID = 2
    2   1  MATCH  NULL
    3   3  VOID   For ID = 4
    4   3  MATCH  NULL
    5   2  NULL   NULL
    6   2  NULL   NULL

Thanks !!",sql,,,,,,open,0,204,7,"SQL Server : voiding records with message I have a TableA (ID int, [set] int,[status] char(20), message char(20))

    ID set status message
    1   1
    2   1  MATCH
    3   3
    4   3  MATCH
    5   2
    6   2

Now I want to do two things here:

set status = 'void' where it is not 'match' in the same set. so ID with 1 and 3 will get the void.

 set message = ""For ID = xx"" where xx is ID. set the message where it is void also pointing to its corresponding matched ID. 

Expected result:

    ID set status message
    1   1  VOID   For ID = 2
    2   1  MATCH  NULL
    3   3  VOID   For ID = 4
    4   3  MATCH  NULL
    5   2  NULL   NULL
    6   2  NULL   NULL

Thanks !!",1
10004880,04/04/2012 04:21:41,933979,09/08/2011 03:41:39,59,0,Ruby on Rails - Retrieve array of elements from DB with expansion,"I have a table called routes within my database where each route has an origin and destination.
Given any origin, I want to be able to return a list of destinations that can be reached directly from this origin OR from any destination that links with this origin.
How can I do this in Ruby?

    def find_available_routes(origin) 
	  routes = Array.new
	  #each row in routes has 'origin' and 'destination'
	end",sql,ruby-on-rails,ruby,,,,open,0,72,12,"Ruby on Rails - Retrieve array of elements from DB with expansion I have a table called routes within my database where each route has an origin and destination.
Given any origin, I want to be able to return a list of destinations that can be reached directly from this origin OR from any destination that links with this origin.
How can I do this in Ruby?

    def find_available_routes(origin) 
	  routes = Array.new
	  #each row in routes has 'origin' and 'destination'
	end",3
8139618,11/15/2011 16:25:10,821113,06/29/2011 12:56:36,165,10,PostgreSQL parameterized Order By / Limit in table function,"I have sql procedure that do regular sql select statement:

    CREATE OR REPLACE FUNCTION getStuff(param character varying)
      RETURNS SETOF stuff AS
    $BODY$
        select *
        from stuff
        where col = $1
    $BODY$
      LANGUAGE sql;

For now I am invoking this function like this:

    select * from getStuff('hello');

What are my options, if I need to order and limit the results as it would be normal select statement with `order by` and `limit` clauses?

My guess is that query:

    select * from getStuff('hello') order by col2 limit 100;

would not be very efficient, because all rows from table `stuff` will be returned by function `getStuff` and only then ordered and sliced by limit.

But also if I am right, there is no easy way how to pass the orderby by argument of sql language function. Only values can be passed, not parts of sql statement.

Another option is to create the function in `plpgsql` language, where It is possible to construct the query and execute it via `EXECUTE`.
But this is not very nice aproach either.

So, is there any other method of achieving this?
Or what option would you choose? Ordering/limiting outside the function, or plpgsql?

I am using postgresql 9.1.

Thank you for every idea,
Josh",sql,database,postgresql,database-design,,,open,0,240,9,"PostgreSQL parameterized Order By / Limit in table function I have sql procedure that do regular sql select statement:

    CREATE OR REPLACE FUNCTION getStuff(param character varying)
      RETURNS SETOF stuff AS
    $BODY$
        select *
        from stuff
        where col = $1
    $BODY$
      LANGUAGE sql;

For now I am invoking this function like this:

    select * from getStuff('hello');

What are my options, if I need to order and limit the results as it would be normal select statement with `order by` and `limit` clauses?

My guess is that query:

    select * from getStuff('hello') order by col2 limit 100;

would not be very efficient, because all rows from table `stuff` will be returned by function `getStuff` and only then ordered and sliced by limit.

But also if I am right, there is no easy way how to pass the orderby by argument of sql language function. Only values can be passed, not parts of sql statement.

Another option is to create the function in `plpgsql` language, where It is possible to construct the query and execute it via `EXECUTE`.
But this is not very nice aproach either.

So, is there any other method of achieving this?
Or what option would you choose? Ordering/limiting outside the function, or plpgsql?

I am using postgresql 9.1.

Thank you for every idea,
Josh",4
2476469,03/19/2010 10:29:22,275235,02/17/2010 12:42:53,11,5,Question on SQL Grouping,"I am trying to achieve the following without using sub query.

 For a funding, I would like to select the latest Letter created date and the ‘earliest worklist created since letter created’ date for a funding.

FundingId Leter (1, 1/1/2009 )(1, 5/5/2009) (1, 8/8/2009) (2, 3/3/2009) 

FundingId WorkList (1, 5/5/2009 ) (1, 9/9/2009) (1, 10/10/2009) (2, 2/2/2009) 

Expected Result -
FundingId Leter WorkList (1, 8/8/2009, 9/9/2009)


I wrote a query as follows. It has a bug. It will omit those FundingId for which the minimum WorkList date is less than latest Letter date (even though it has another worklist with greater than letter created date).

CREATE TABLE #Funding(
[Funding_ID] [int] IDENTITY(1,1) NOT NULL,
[Funding_No] [int] NOT NULL,
CONSTRAINT [PK_Center_Center_ID] PRIMARY KEY NONCLUSTERED ([Funding_ID] ASC)
) ON [PRIMARY]

CREATE TABLE #Letter(
[Letter_ID] [int] IDENTITY(1,1) NOT NULL,
[Funding_ID] [int] NOT NULL,
[CreatedDt] [SMALLDATETIME],
CONSTRAINT [PK_Letter_Letter_ID] PRIMARY KEY NONCLUSTERED ([Letter_ID] ASC)
) ON [PRIMARY]

CREATE TABLE #WorkList(
[WorkList_ID] [int] IDENTITY(1,1) NOT NULL,
[Funding_ID] [int] NOT NULL,
[CreatedDt] [SMALLDATETIME],
CONSTRAINT [PK_WorkList_WorkList_ID] PRIMARY KEY NONCLUSTERED ([WorkList_ID] ASC)
) ON [PRIMARY]

SELECT F.Funding_ID,

Funding_No, 

MAX (L.CreatedDt),

MIN(W.CreatedDt)

FROM #Funding F

INNER JOIN #Letter L ON L.Funding_ID = F.Funding_ID

LEFT OUTER JOIN #WorkList W ON W.Funding_ID = F.Funding_ID

GROUP BY F.Funding_ID,Funding_No

HAVING MIN(W.CreatedDt) > MAX (L.CreatedDt)




How can I write a correct query without using subquery?

Please help


Thanks

Lijo",sql,,,,,,open,0,191,4,"Question on SQL Grouping I am trying to achieve the following without using sub query.

 For a funding, I would like to select the latest Letter created date and the ‘earliest worklist created since letter created’ date for a funding.

FundingId Leter (1, 1/1/2009 )(1, 5/5/2009) (1, 8/8/2009) (2, 3/3/2009) 

FundingId WorkList (1, 5/5/2009 ) (1, 9/9/2009) (1, 10/10/2009) (2, 2/2/2009) 

Expected Result -
FundingId Leter WorkList (1, 8/8/2009, 9/9/2009)


I wrote a query as follows. It has a bug. It will omit those FundingId for which the minimum WorkList date is less than latest Letter date (even though it has another worklist with greater than letter created date).

CREATE TABLE #Funding(
[Funding_ID] [int] IDENTITY(1,1) NOT NULL,
[Funding_No] [int] NOT NULL,
CONSTRAINT [PK_Center_Center_ID] PRIMARY KEY NONCLUSTERED ([Funding_ID] ASC)
) ON [PRIMARY]

CREATE TABLE #Letter(
[Letter_ID] [int] IDENTITY(1,1) NOT NULL,
[Funding_ID] [int] NOT NULL,
[CreatedDt] [SMALLDATETIME],
CONSTRAINT [PK_Letter_Letter_ID] PRIMARY KEY NONCLUSTERED ([Letter_ID] ASC)
) ON [PRIMARY]

CREATE TABLE #WorkList(
[WorkList_ID] [int] IDENTITY(1,1) NOT NULL,
[Funding_ID] [int] NOT NULL,
[CreatedDt] [SMALLDATETIME],
CONSTRAINT [PK_WorkList_WorkList_ID] PRIMARY KEY NONCLUSTERED ([WorkList_ID] ASC)
) ON [PRIMARY]

SELECT F.Funding_ID,

Funding_No, 

MAX (L.CreatedDt),

MIN(W.CreatedDt)

FROM #Funding F

INNER JOIN #Letter L ON L.Funding_ID = F.Funding_ID

LEFT OUTER JOIN #WorkList W ON W.Funding_ID = F.Funding_ID

GROUP BY F.Funding_ID,Funding_No

HAVING MIN(W.CreatedDt) > MAX (L.CreatedDt)




How can I write a correct query without using subquery?

Please help


Thanks

Lijo",1
8106675,11/12/2011 18:42:35,1022923,11/01/2011 00:50:08,1,0,ruby on rails: right location for sql query,"I have a general question about rails controllers/models:
I have a model Providers, that represents the table providers in my database.
If I have sql queries (with certain conditions) to gather information from that table, where the SQL code should be implemented, in the model or in the controller?
",sql,ruby-on-rails,mvc,,,,open,0,47,8,"ruby on rails: right location for sql query I have a general question about rails controllers/models:
I have a model Providers, that represents the table providers in my database.
If I have sql queries (with certain conditions) to gather information from that table, where the SQL code should be implemented, in the model or in the controller?
",3
11035073,06/14/2012 14:18:45,1019193,10/28/2011 22:22:31,1086,78,"How to get a user specific configuration value, or default if missing, in a single SQL","I have a configuration table, that holds the values selected by a specific user. If no values where entered, then the default should be returned. But there's a catch: the user belong to a speciffic group, and each group has it's own defaul.

What I need is *a single query* that returns the user's values, or the default for his/her group if no data found.

This works, but I wanted something more ""elegant""...

    SELECT TOP 1 
      FROM Config C
     WHERE C.GroupId = @GroupId
       AND (C.UserId = @UserId OR C.UserId IS NULL)
     ORDER BY C.UserId DESC

Any thoughts?
",sql,,,,,,open,0,117,16,"How to get a user specific configuration value, or default if missing, in a single SQL I have a configuration table, that holds the values selected by a specific user. If no values where entered, then the default should be returned. But there's a catch: the user belong to a speciffic group, and each group has it's own defaul.

What I need is *a single query* that returns the user's values, or the default for his/her group if no data found.

This works, but I wanted something more ""elegant""...

    SELECT TOP 1 
      FROM Config C
     WHERE C.GroupId = @GroupId
       AND (C.UserId = @UserId OR C.UserId IS NULL)
     ORDER BY C.UserId DESC

Any thoughts?
",1
6015778,05/16/2011 10:04:37,388388,07/10/2010 10:12:11,2102,166,Transact-SQL Formatting Standards (Coding Styles),"    How should SQL code be formatted?
    What sort of indentation should you use?
    Should keywords be in upper case? 
    How should lists be lined up?

Standardisation of code layout is an important issue, but what standard should you adopt?",sql,tsql,,,,05/19/2011 09:31:45,not constructive,1,52,5,"Transact-SQL Formatting Standards (Coding Styles)     How should SQL code be formatted?
    What sort of indentation should you use?
    Should keywords be in upper case? 
    How should lists be lined up?

Standardisation of code layout is an important issue, but what standard should you adopt?",2
8137431,11/15/2011 13:56:30,428073,08/23/2010 05:58:43,361,8,What is the use of Table Hints in SQL,"What is the use of `Table Hint` in SQL
like `NOLOCK, READUNCOMMITTED`

please explain this with example.
",sql,sql-server,sql-server-2008,,,11/15/2011 16:05:27,not a real question,1,15,9,"What is the use of Table Hints in SQL What is the use of `Table Hint` in SQL
like `NOLOCK, READUNCOMMITTED`

please explain this with example.
",3
8791969,01/09/2012 16:45:50,708631,04/14/2011 19:31:04,11,0,How do I get multiple records with no join table,"I have 2 tables one has the Items (Name UPC etc.) the other is the store info like Store Name etc.

for each Store i need itemName,and storeName both tables or not joint.",sql,sql-server,sql-server-2005,,,01/09/2012 16:57:16,not a real question,1,32,10,"How do I get multiple records with no join table I have 2 tables one has the Items (Name UPC etc.) the other is the store info like Store Name etc.

for each Store i need itemName,and storeName both tables or not joint.",3
7299302,09/04/2011 12:44:51,3917,08/31/2008 21:39:18,98,1,Book on good SQL practice?,"There are a bunch of books on good Java practices, such as [Java Puzzlers](http://www.amazon.com/Java-Puzzlers-Traps-Pitfalls-Corner/dp/032133678X), [Effective Java](http://www.amazon.com/Effective-Java-2nd-Joshua-Bloch/dp/0321356683), and [Clean Code](http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882).

Is there anything similar for SQL?  In particular, parts that most newbies find confusing, or common gotchas?  I could just browse the SQL tag here, but it would be great to find something a little more organized.  :)
",sql,,,,,09/04/2011 14:15:11,not constructive,1,59,5,"Book on good SQL practice? There are a bunch of books on good Java practices, such as [Java Puzzlers](http://www.amazon.com/Java-Puzzlers-Traps-Pitfalls-Corner/dp/032133678X), [Effective Java](http://www.amazon.com/Effective-Java-2nd-Joshua-Bloch/dp/0321356683), and [Clean Code](http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882).

Is there anything similar for SQL?  In particular, parts that most newbies find confusing, or common gotchas?  I could just browse the SQL tag here, but it would be great to find something a little more organized.  :)
",1
3480344,08/13/2010 20:09:15,89566,04/10/2009 18:54:58,904,16,Appending DB Connection String with prepareSQL=0,What does this do?,sql,,,,,,open,0,4,6,Appending DB Connection String with prepareSQL=0 What does this do?,1
7126989,08/19/2011 20:22:07,794436,06/12/2011 02:35:42,353,13,"Which is the most memory intensive SQL query: select, update or insert?","Which is the most memory intensive SQL query: select, update or insert? and why? 

The database consists of a two simple tables that are independent of each other 
",sql,oracle,query,jdbc,,08/19/2011 20:27:35,not a real question,1,29,12,"Which is the most memory intensive SQL query: select, update or insert? Which is the most memory intensive SQL query: select, update or insert? and why? 

The database consists of a two simple tables that are independent of each other 
",4
5745858,04/21/2011 14:57:56,639914,03/01/2011 18:49:58,24,0,help creating a complicated stored procedure,"So I am not even sure if this is possible but it really would be awesome to learn and to be able to do this.

What I am trying to do is run 3 seperate queries that return a single row of data and create a single table that can then be used in a gridview in asp.net

query 1

    SELECT     dbo.BOOKINGS.USERID, SUM(dbo.BOOKINGS.APRICE) AS total, COUNT
    (dbo.BOOKINGS.USERID) AS bookingcount
    FROM         dbo.BOOKINGS INNER JOIN
                 dbo.TOURS ON dbo.BOOKINGS.TOUR = dbo.TOURS.TOUR INNER JOIN
                 dbo.MAJOR ON dbo.TOURS.MAJOR = dbo.MAJOR.MAJOR
    WHERE     (dbo.BOOKINGS.BOOKED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
    @enddate)) AND (dbo.MAJOR.SDESCR = 'Cruises') AND 
                          (dbo.BOOKINGS.USERID = @USER) AND (dbo.MAJOR.DIVISION = 'A')
    GROUP BY dbo.BOOKINGS.USERID

query 2

    SELECT     dbo.BOOKINGS.USERID, SUM(dbo.BOOKINGS.APRICE) AS total, COUNT
        (dbo.BOOKINGS.USERID) AS bookingcount
    FROM         dbo.BOOKINGS INNER JOIN
                          dbo.TOURS ON dbo.BOOKINGS.TOUR = dbo.TOURS.TOUR INNER JOIN
                          dbo.MAJOR ON dbo.TOURS.MAJOR = dbo.MAJOR.MAJOR
    WHERE     (dbo.BOOKINGS.BOOKED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
        @enddate)) AND (dbo.MAJOR.SDESCR <> 'Cruises') AND 
                          (dbo.BOOKINGS.USERID = @USER) AND (dbo.MAJOR.DIVISION = 'A')
    GROUP BY dbo.BOOKINGS.USERID

query 3

    SELECT     SUM(dbo.SUBS.AMOUNT) AS total, COUNT(dbo.SUBS.AMOUNT) AS Memberships, 
        dbo.HOMES.USERID
    FROM         dbo.HOMES INNER JOIN
                          dbo.SUBS ON dbo.HOMES.HOME = dbo.SUBS.HOME AND dbo.HOMES.JOINED 
        = dbo.SUBS.PAIDON
    WHERE     (dbo.HOMES.JOINED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
        @enddate)) AND (dbo.HOMES.USERID = 
        @USER)
    GROUP BY dbo.HOMES.USERID

all thre queries return a single row with 3 columns
so i figure this could work the only other difficult part is i want to add a new column 

    query1 userid  total1   bookingcount
    query2 userid  total2   bookingcount
    query3 userid  total3   memberships




",sql,sql-server-2005,stored-procedures,,,,open,0,547,6,"help creating a complicated stored procedure So I am not even sure if this is possible but it really would be awesome to learn and to be able to do this.

What I am trying to do is run 3 seperate queries that return a single row of data and create a single table that can then be used in a gridview in asp.net

query 1

    SELECT     dbo.BOOKINGS.USERID, SUM(dbo.BOOKINGS.APRICE) AS total, COUNT
    (dbo.BOOKINGS.USERID) AS bookingcount
    FROM         dbo.BOOKINGS INNER JOIN
                 dbo.TOURS ON dbo.BOOKINGS.TOUR = dbo.TOURS.TOUR INNER JOIN
                 dbo.MAJOR ON dbo.TOURS.MAJOR = dbo.MAJOR.MAJOR
    WHERE     (dbo.BOOKINGS.BOOKED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
    @enddate)) AND (dbo.MAJOR.SDESCR = 'Cruises') AND 
                          (dbo.BOOKINGS.USERID = @USER) AND (dbo.MAJOR.DIVISION = 'A')
    GROUP BY dbo.BOOKINGS.USERID

query 2

    SELECT     dbo.BOOKINGS.USERID, SUM(dbo.BOOKINGS.APRICE) AS total, COUNT
        (dbo.BOOKINGS.USERID) AS bookingcount
    FROM         dbo.BOOKINGS INNER JOIN
                          dbo.TOURS ON dbo.BOOKINGS.TOUR = dbo.TOURS.TOUR INNER JOIN
                          dbo.MAJOR ON dbo.TOURS.MAJOR = dbo.MAJOR.MAJOR
    WHERE     (dbo.BOOKINGS.BOOKED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
        @enddate)) AND (dbo.MAJOR.SDESCR <> 'Cruises') AND 
                          (dbo.BOOKINGS.USERID = @USER) AND (dbo.MAJOR.DIVISION = 'A')
    GROUP BY dbo.BOOKINGS.USERID

query 3

    SELECT     SUM(dbo.SUBS.AMOUNT) AS total, COUNT(dbo.SUBS.AMOUNT) AS Memberships, 
        dbo.HOMES.USERID
    FROM         dbo.HOMES INNER JOIN
                          dbo.SUBS ON dbo.HOMES.HOME = dbo.SUBS.HOME AND dbo.HOMES.JOINED 
        = dbo.SUBS.PAIDON
    WHERE     (dbo.HOMES.JOINED BETWEEN CONVERT(int, @startdate) AND CONVERT(int, 
        @enddate)) AND (dbo.HOMES.USERID = 
        @USER)
    GROUP BY dbo.HOMES.USERID

all thre queries return a single row with 3 columns
so i figure this could work the only other difficult part is i want to add a new column 

    query1 userid  total1   bookingcount
    query2 userid  total2   bookingcount
    query3 userid  total3   memberships




",3
5102134,02/24/2011 08:30:09,238232,12/24/2009 13:41:39,566,6,How to group text columns into one column.,"I need something like :

    SELECT dt, (???) AS C FROM (SELECT dt,c1,c2,c3,c4  ...

dt - datetime and by the way I've got some weird structure , for example :

    24.02.2011 null null null ""text""
    25.02.2011 null ""te"" null ""text""
    26.02.2011 null ""te"" null null

it must became

    24.02.2011 ""text""
    25.02.2011 ""te""
    25.02.2011 ""text""
    26.02.2011 ""te""

or maybe 

    24.02.2011 ""c4"" ""text""
    25.02.2011 ""c2"" ""te""
    25.02.2011 ""c4 ""text""
    26.02.2011 ""c2"" ""te""

if I do `select dt, с1+с2+с3+с4 as C from select dt,c1,c2,c3,c4`

there will be 

    25.02.2011  ""tetext""

so I need any idea how can I exchange rows+columns to rows.

thank you.

MS SQL Server 2008.",sql,tsq,,,,,open,0,139,8,"How to group text columns into one column. I need something like :

    SELECT dt, (???) AS C FROM (SELECT dt,c1,c2,c3,c4  ...

dt - datetime and by the way I've got some weird structure , for example :

    24.02.2011 null null null ""text""
    25.02.2011 null ""te"" null ""text""
    26.02.2011 null ""te"" null null

it must became

    24.02.2011 ""text""
    25.02.2011 ""te""
    25.02.2011 ""text""
    26.02.2011 ""te""

or maybe 

    24.02.2011 ""c4"" ""text""
    25.02.2011 ""c2"" ""te""
    25.02.2011 ""c4 ""text""
    26.02.2011 ""c2"" ""te""

if I do `select dt, с1+с2+с3+с4 as C from select dt,c1,c2,c3,c4`

there will be 

    25.02.2011  ""tetext""

so I need any idea how can I exchange rows+columns to rows.

thank you.

MS SQL Server 2008.",2
7089028,08/17/2011 07:05:26,86156,04/02/2009 11:49:03,865,18,Track what an SQL-query actually does (insert/update/delete) in Oracle,"Is it possible to somehow log what a SQL-statement results in. For example:

    INSERT INTO bonus SELECT ename, job, sal, comm FROM emp
    WHERE comm > sal * 0.25;

How to get which rows that are acually inserted (or updated or deleted if it's another query), instead of just getting ""5 rows inserted."". It would be especially nice if it's possible to get the change in SQL-form.",sql,oracle,debugging,logging,,,open,0,72,9,"Track what an SQL-query actually does (insert/update/delete) in Oracle Is it possible to somehow log what a SQL-statement results in. For example:

    INSERT INTO bonus SELECT ename, job, sal, comm FROM emp
    WHERE comm > sal * 0.25;

How to get which rows that are acually inserted (or updated or deleted if it's another query), instead of just getting ""5 rows inserted."". It would be especially nice if it's possible to get the change in SQL-form.",4
5141518,02/28/2011 11:44:34,508127,11/15/2010 10:28:18,866,2,SQL server table partition year wise,i read few article for table partition in sql server searching google but those was not very understandable for me. so please anyone help me to partition a table year wise. help me with script.,sql,sql-server-2005,,,,02/28/2011 13:27:22,not a real question,1,35,6,SQL server table partition year wise i read few article for table partition in sql server searching google but those was not very understandable for me. so please anyone help me to partition a table year wise. help me with script.,2
7555606,09/26/2011 13:13:19,965096,09/26/2011 12:58:36,1,0,SQL SERVER Table league,"I would like to build a table league from macthes ( scores and rounds).

I succceed from my MS SQL database to calculate points for each teams and matches but i would like now to generate a table league..(football)


Some one can help me please?

`

    SELECT     TOP (100) PERCENT dbo.jos_joomleague_matches.match_id, dbo.jos_joomleague_clubs.name AS Team, jos_joomleague_clubs_1.name AS Team2, 
                          dbo.jos_joomleague_matches.match_date, dbo.jos_joomleague_matches.matchpart1_result, dbo.jos_joomleague_matches.matchpart2_result, 
                          dbo.jos_joomleague_rounds.name, 
                          CASE WHEN dbo.jos_joomleague_matches.matchpart1_result > dbo.jos_joomleague_matches.matchpart2_result THEN 3 WHEN dbo.jos_joomleague_matches.matchpart1_result
                           = dbo.jos_joomleague_matches.matchpart2_result THEN 1 ELSE 0 END AS ptsclub1HOME, 
                          CASE WHEN dbo.jos_joomleague_matches.matchpart2_result > dbo.jos_joomleague_matches.matchpart1_result THEN 3 WHEN dbo.jos_joomleague_matches.matchpart2_result
                           = dbo.jos_joomleague_matches.matchpart1_result THEN 1 ELSE 0 END AS ptsclub2AWAY
    FROM         dbo.jos_joomleague_rounds INNER JOIN
                          dbo.jos_joomleague_clubs AS jos_joomleague_clubs_1 INNER JOIN
                          dbo.jos_joomleague_matches INNER JOIN
                          dbo.jos_joomleague_clubs ON dbo.jos_joomleague_matches.matchpart1 = dbo.jos_joomleague_clubs.id ON 
                          jos_joomleague_clubs_1.id = dbo.jos_joomleague_matches.matchpart2 ON dbo.jos_joomleague_rounds.id = dbo.jos_joomleague_matches.round_id
    ORDER BY dbo.jos_joomleague_matches.match_date

`
",sql,table,ms,,,09/26/2011 15:08:22,not a real question,1,400,4,"SQL SERVER Table league I would like to build a table league from macthes ( scores and rounds).

I succceed from my MS SQL database to calculate points for each teams and matches but i would like now to generate a table league..(football)


Some one can help me please?

`

    SELECT     TOP (100) PERCENT dbo.jos_joomleague_matches.match_id, dbo.jos_joomleague_clubs.name AS Team, jos_joomleague_clubs_1.name AS Team2, 
                          dbo.jos_joomleague_matches.match_date, dbo.jos_joomleague_matches.matchpart1_result, dbo.jos_joomleague_matches.matchpart2_result, 
                          dbo.jos_joomleague_rounds.name, 
                          CASE WHEN dbo.jos_joomleague_matches.matchpart1_result > dbo.jos_joomleague_matches.matchpart2_result THEN 3 WHEN dbo.jos_joomleague_matches.matchpart1_result
                           = dbo.jos_joomleague_matches.matchpart2_result THEN 1 ELSE 0 END AS ptsclub1HOME, 
                          CASE WHEN dbo.jos_joomleague_matches.matchpart2_result > dbo.jos_joomleague_matches.matchpart1_result THEN 3 WHEN dbo.jos_joomleague_matches.matchpart2_result
                           = dbo.jos_joomleague_matches.matchpart1_result THEN 1 ELSE 0 END AS ptsclub2AWAY
    FROM         dbo.jos_joomleague_rounds INNER JOIN
                          dbo.jos_joomleague_clubs AS jos_joomleague_clubs_1 INNER JOIN
                          dbo.jos_joomleague_matches INNER JOIN
                          dbo.jos_joomleague_clubs ON dbo.jos_joomleague_matches.matchpart1 = dbo.jos_joomleague_clubs.id ON 
                          jos_joomleague_clubs_1.id = dbo.jos_joomleague_matches.matchpart2 ON dbo.jos_joomleague_rounds.id = dbo.jos_joomleague_matches.round_id
    ORDER BY dbo.jos_joomleague_matches.match_date

`
",3
7253247,08/31/2011 06:17:30,591656,01/27/2011 04:04:03,3612,244,Question on Query execution,"In the below query if the Patients table has 1000 records how many times TableValueFunction executes? Only once or 1000 time?

This is a query in a Stored Procedure, do you have a better idea to improve this?

    SELECT * FROM Patients
    WHERE Patient.Id In (SELECT PatientId FROM TableValueFunction(parameters..))",sql,sql-server,sql-server-2005,tsql,query-execution-plans,,open,0,54,4,"Question on Query execution In the below query if the Patients table has 1000 records how many times TableValueFunction executes? Only once or 1000 time?

This is a query in a Stored Procedure, do you have a better idea to improve this?

    SELECT * FROM Patients
    WHERE Patient.Id In (SELECT PatientId FROM TableValueFunction(parameters..))",5
6178050,05/30/2011 15:19:07,144701,07/24/2009 19:04:44,468,23,Anyone know a SQL schema (scripts or something) for a forum's Start up?,"We are searching for a while now on google to find out some good SQL scripts to 
create a ""forum"". Does anyone know some great start up kit (Image, scripts, schema view) from what I could start? We want something with the most fonctionnalities as possible (such as nomber of views, ranking, etc).  
  
Thank you.",sql,sql-server-2005,,,,05/30/2011 15:23:10,not a real question,1,58,13,"Anyone know a SQL schema (scripts or something) for a forum's Start up? We are searching for a while now on google to find out some good SQL scripts to 
create a ""forum"". Does anyone know some great start up kit (Image, scripts, schema view) from what I could start? We want something with the most fonctionnalities as possible (such as nomber of views, ranking, etc).  
  
Thank you.",2
7333971,09/07/2011 12:35:04,829930,07/05/2011 14:42:44,57,0,Problem with Update statement in T-SQL,"I have two tables: 

    CREATE TABLE [dbo].[Task](
    	[SysTask] [int] IDENTITY(1,1) NOT NULL,
    	[TaskStatus] [int] NOT NULL,
    )
    
    CREATE TABLE [dbo].[Queue](
    	[SysQueue] [int] IDENTITY(1,1) NOT NULL,
    	[SysTask] [int] NOT NULL,
    	[QueueStatus] [int] NOT NULL,
    )

One TASK has many Queue records. I know these names are confusing a little bit. 
I need to update all the records from the table TASK, which have no record in the table QUEUE with QueueStatus < 4. And this query drives me crazy! 

Here is what I've tried: 

		UPDATE Task SET SysTaskStatus = 3
			WHERE SysTaskStatus <> 3 AND [SysTask] NOT IN ((SELECT tq.SysTask FROM [dbo].[TaskQueue] tq WHERE [SysTask] = tq.SysTask AND tq.[SysTaskQueueStatus] IN (1,2,3)))

		UPDATE Task SET SysTaskStatus = 3
			WHERE EXISTS (SELECT 1 FROM [dbo].[TaskQueue] WHERE Task.[SysTask] = [SysTask] AND [SysTaskQueueStatus] <4 HAVING COUNT(*)=0)
			
		UPDATE Task SET SysTaskStatus = 3 
			WHERE 0 = (SELECT SysTask FROM [dbo].[TaskQueue] WHERE Task.[SysTask] = SysTask AND [SysTaskQueueStatus] < 4)

For all this queries there is always the same error:

> Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.
The statement has been terminated.",sql,sql-server,sql-server-2008,query,,,open,0,222,6,"Problem with Update statement in T-SQL I have two tables: 

    CREATE TABLE [dbo].[Task](
    	[SysTask] [int] IDENTITY(1,1) NOT NULL,
    	[TaskStatus] [int] NOT NULL,
    )
    
    CREATE TABLE [dbo].[Queue](
    	[SysQueue] [int] IDENTITY(1,1) NOT NULL,
    	[SysTask] [int] NOT NULL,
    	[QueueStatus] [int] NOT NULL,
    )

One TASK has many Queue records. I know these names are confusing a little bit. 
I need to update all the records from the table TASK, which have no record in the table QUEUE with QueueStatus < 4. And this query drives me crazy! 

Here is what I've tried: 

		UPDATE Task SET SysTaskStatus = 3
			WHERE SysTaskStatus <> 3 AND [SysTask] NOT IN ((SELECT tq.SysTask FROM [dbo].[TaskQueue] tq WHERE [SysTask] = tq.SysTask AND tq.[SysTaskQueueStatus] IN (1,2,3)))

		UPDATE Task SET SysTaskStatus = 3
			WHERE EXISTS (SELECT 1 FROM [dbo].[TaskQueue] WHERE Task.[SysTask] = [SysTask] AND [SysTaskQueueStatus] <4 HAVING COUNT(*)=0)
			
		UPDATE Task SET SysTaskStatus = 3 
			WHERE 0 = (SELECT SysTask FROM [dbo].[TaskQueue] WHERE Task.[SysTask] = SysTask AND [SysTaskQueueStatus] < 4)

For all this queries there is always the same error:

> Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.
The statement has been terminated.",4
2182697,02/02/2010 08:30:08,89752,04/11/2009 12:32:07,413,12,Quick SQL question! Sort by most occurences of an attribute,"Hi guys I have two tables as such:

Categories:
ID - Name - Desc

Items
ID - Name - CategoryID - Desc - Price

I want a query that returns a list of categories ranked by most occurences in the items table",sql,mysql,,,,,open,0,37,10,"Quick SQL question! Sort by most occurences of an attribute Hi guys I have two tables as such:

Categories:
ID - Name - Desc

Items
ID - Name - CategoryID - Desc - Price

I want a query that returns a list of categories ranked by most occurences in the items table",2
8928146,01/19/2012 14:54:34,789476,06/08/2011 15:37:35,658,29,Do large systems use foreign keys in their databases?,"One of the disadvantages people point to with using foreign keys in a relational database is the overhead of making sure the parent table exists before doing any insert operation. ([Example][1]).  As your database and operation grows, this effect is amplified.  Does anyone know if large sites on the web use them then?  If so, how do they get around that extra overhead?  If not, as your development team gets bigger, it seems that that could cause a lot of potential bugs/conflicts/miscommunication/orphan-rows.

Any insight?


  [1]: http://stackoverflow.com/questions/83147/whats-wrong-with-foreign-keys",sql,foreign-keys,scalability,rdbms,production,01/19/2012 21:43:40,not constructive,1,90,9,"Do large systems use foreign keys in their databases? One of the disadvantages people point to with using foreign keys in a relational database is the overhead of making sure the parent table exists before doing any insert operation. ([Example][1]).  As your database and operation grows, this effect is amplified.  Does anyone know if large sites on the web use them then?  If so, how do they get around that extra overhead?  If not, as your development team gets bigger, it seems that that could cause a lot of potential bugs/conflicts/miscommunication/orphan-rows.

Any insight?


  [1]: http://stackoverflow.com/questions/83147/whats-wrong-with-foreign-keys",5
7582882,09/28/2011 11:59:32,555447,12/27/2010 22:43:46,66,6,Is a Join Faster than two queries,"I know this question has been asked before, 
[example](http://stackoverflow.com/questions/4758712/which-of-the-following-sql-queries-would-be-faster-a-join-on-two-tables-or-succe), and I do agree that one query with a join is faster than performing another query for each record returned by the firs query.

However, since with a join you tend to generate redundant field will this slow the network ?

Let's say I have a table hotel and HOTEL has a number of images in a table HOTEL_IMAGE. HOTEL has 20 fields. performing a join on HOTEL_IMAGE will produce 20 fields for each hotel image. will this query still be faster over the network ?",sql,performance,networking,,,,open,0,93,7,"Is a Join Faster than two queries I know this question has been asked before, 
[example](http://stackoverflow.com/questions/4758712/which-of-the-following-sql-queries-would-be-faster-a-join-on-two-tables-or-succe), and I do agree that one query with a join is faster than performing another query for each record returned by the firs query.

However, since with a join you tend to generate redundant field will this slow the network ?

Let's say I have a table hotel and HOTEL has a number of images in a table HOTEL_IMAGE. HOTEL has 20 fields. performing a join on HOTEL_IMAGE will produce 20 fields for each hotel image. will this query still be faster over the network ?",3
3160719,07/01/2010 18:42:07,125551,06/19/2009 05:41:29,259,8,SQL Search column for each variable in CSV string,"I have a variable passed to stored procedure 
Ex:

    @keywords = 'val1, val3, val5'

And i'm trying to see if column named Title contain any of them in it

    Ex: Title1 - 'Hello val1'
        Title2 - 'Hello val3'   
        Title3 - 'Hello val1, val3'  
        Title4 - 'Hello' 

 

SO my results should return values

    Title
    ------
    Hello val1
    Hello val3
    Hello val1, val3

Is this possible to use LIKE or any other function/method?

 ",sql,sql-server,sql-server-2005,tsql,,,open,0,118,9,"SQL Search column for each variable in CSV string I have a variable passed to stored procedure 
Ex:

    @keywords = 'val1, val3, val5'

And i'm trying to see if column named Title contain any of them in it

    Ex: Title1 - 'Hello val1'
        Title2 - 'Hello val3'   
        Title3 - 'Hello val1, val3'  
        Title4 - 'Hello' 

 

SO my results should return values

    Title
    ------
    Hello val1
    Hello val3
    Hello val1, val3

Is this possible to use LIKE or any other function/method?

 ",4
11746229,07/31/2012 18:00:23,265521,02/03/2010 18:09:11,986,35,"Django LEFT JOIN, efficiently?","Suppose I have this model:

	class PhotoAlbum(models.Model):
		title = models.CharField(max_length=128)
		author = models.CharField(max_length=128)
	
	class Photo(models.Model):
		album = models.ForeignKey('PhotoAlbum')

And I want to do this query: ""Find 10 albums whose name starts with 'The', and then give me all the photos in those albums.""

In SQL I could do it something like this:

    SELECT * FROM
        (SELECT * FROM photoalbum WHERE title LIKE 'The%' LIMIT 10) AS selected_albums
    LEFT JOIN photo ON photo.album_id = selected_albums.id

My question is, how can I do this in Django? ***(WITHOUT TRIGGERING A QUERY FOR EACH ALBUM!)*** I assume this is a fairly common requirement, and I can't believe there isn't some way to do it.

If there is no Django-ey way, I will settle for ""how can I implement this in Django using raw SQL?"".

Here are some things which will not work:

* `select_related()`; that is for *forward* `ForeignKey` relationships, this is backwards.
* `PhotoAlbum.photo_set`; that triggers a query for each album.
* The closest I have got is:

	albums = PhotoAlbum.objects.all()[:10]
	photos = Photo.objects.filter(album__in=albums)

But it doesn't work on MySQL sadly, and I've been told it is better to use `LEFT JOIN`'s than the `WHERE ... IN (SELECT ...)` type query that this creates.
",sql,django,left-join,,,,open,0,198,4,"Django LEFT JOIN, efficiently? Suppose I have this model:

	class PhotoAlbum(models.Model):
		title = models.CharField(max_length=128)
		author = models.CharField(max_length=128)
	
	class Photo(models.Model):
		album = models.ForeignKey('PhotoAlbum')

And I want to do this query: ""Find 10 albums whose name starts with 'The', and then give me all the photos in those albums.""

In SQL I could do it something like this:

    SELECT * FROM
        (SELECT * FROM photoalbum WHERE title LIKE 'The%' LIMIT 10) AS selected_albums
    LEFT JOIN photo ON photo.album_id = selected_albums.id

My question is, how can I do this in Django? ***(WITHOUT TRIGGERING A QUERY FOR EACH ALBUM!)*** I assume this is a fairly common requirement, and I can't believe there isn't some way to do it.

If there is no Django-ey way, I will settle for ""how can I implement this in Django using raw SQL?"".

Here are some things which will not work:

* `select_related()`; that is for *forward* `ForeignKey` relationships, this is backwards.
* `PhotoAlbum.photo_set`; that triggers a query for each album.
* The closest I have got is:

	albums = PhotoAlbum.objects.all()[:10]
	photos = Photo.objects.filter(album__in=albums)

But it doesn't work on MySQL sadly, and I've been told it is better to use `LEFT JOIN`'s than the `WHERE ... IN (SELECT ...)` type query that this creates.
",3
5852895,05/02/2011 02:03:55,176855,09/21/2009 23:30:14,11,0,Can you or How can you make custom functions MongoDB like db.mydbname.customFunction()?,I'd like to know if you could write custom functions in MongoDB similar to a stored procedure for queries?,sql,nosql,mongodb,,,,open,0,19,12,Can you or How can you make custom functions MongoDB like db.mydbname.customFunction()? I'd like to know if you could write custom functions in MongoDB similar to a stored procedure for queries?,3
9912377,03/28/2012 17:05:43,1009835,10/23/2011 18:49:02,17,0,SQL Having clause,"Is this a valid sql query? Im not sure how to use ""having count"" in this situation. Basically, find customer_name with at least 2 accounts, opened in different branches.

Account(account_number, branch_name, balance)
<br>Depositor(customer_name, account_number)


`select d.customer_name
from Depositor d
where d.account_number in
	(select a.account_number
	from Account a
	where a.branch_name in
		(select a2.branch_name
		from Account a2
		where a2.branch_name<>a.branch_name)
	group_by a.account_number
	having count(a.account_number)>1)`",sql,query,having-clause,,,03/29/2012 18:07:12,too localized,1,48,3,"SQL Having clause Is this a valid sql query? Im not sure how to use ""having count"" in this situation. Basically, find customer_name with at least 2 accounts, opened in different branches.

Account(account_number, branch_name, balance)
<br>Depositor(customer_name, account_number)


`select d.customer_name
from Depositor d
where d.account_number in
	(select a.account_number
	from Account a
	where a.branch_name in
		(select a2.branch_name
		from Account a2
		where a2.branch_name<>a.branch_name)
	group_by a.account_number
	having count(a.account_number)>1)`",3
4486258,12/20/2010 01:37:02,120888,06/10/2009 21:07:48,575,18,How Can I Force a Column to be Unidqe for an Entire Table in SQL Server 2008 R2?,"I have a table with a ""Description"" field, and I want to ensure that no two rows have the same ""Description,"" but I can't make Description into my idientity column (my ID column is an int). Is it safe to set ""Description"" as a second primary key (in addition to my ID which is already a primary key)?",sql,sql-server,database,primary-key,unique,,open,0,58,18,"How Can I Force a Column to be Unidqe for an Entire Table in SQL Server 2008 R2? I have a table with a ""Description"" field, and I want to ensure that no two rows have the same ""Description,"" but I can't make Description into my idientity column (my ID column is an int). Is it safe to set ""Description"" as a second primary key (in addition to my ID which is already a primary key)?",5
1135594,07/16/2009 05:42:06,128112,06/24/2009 09:48:22,11,0,Backup Through LAN network,"I tried to take  sql server 2008 database backup from the server which has the following feature 

server: windows  server 2008 os

to the client which has the following feature:

client:windows xp service pack 3 os

through lan network but i couldnt achieve it and i am getting the following error



*********Msg 3201, Level 16, State 1, Line 1 
Cannot open backup device 'AstrovedFullDatabase(\\prabha\Rajniprabha\AstroBak.bak)'. Operating system error 5(failed to retrieve text for this error. Reason: 15105). 
Msg 3013, Level 16, State 1, Line 1 
BACKUP DATABASE is terminating abnormally.*********



can anyone help me?",sql,server,2008,,,08/26/2009 11:58:53,off topic,1,90,4,"Backup Through LAN network I tried to take  sql server 2008 database backup from the server which has the following feature 

server: windows  server 2008 os

to the client which has the following feature:

client:windows xp service pack 3 os

through lan network but i couldnt achieve it and i am getting the following error



*********Msg 3201, Level 16, State 1, Line 1 
Cannot open backup device 'AstrovedFullDatabase(\\prabha\Rajniprabha\AstroBak.bak)'. Operating system error 5(failed to retrieve text for this error. Reason: 15105). 
Msg 3013, Level 16, State 1, Line 1 
BACKUP DATABASE is terminating abnormally.*********



can anyone help me?",3
11599565,07/22/2012 10:39:26,301459,03/25/2010 06:32:23,590,22,Reading XML in table,"I have a stored procedure which is passed XML as a parameter and then I have to read that xML and do some updates. The format of the XML is 

    <Requests>
        <RequestReference>R12345</RequestReference>
        <Inventory InventoryId=""1"" InventoryName=""I1"">
            <RequestCodes>
                <Code>AAA</Code>
            </RequestCodes>
        </Inventory>
        <Inventory InventoryId=""2"" InventoryName=""I2"">
            <RequestCodes>
                <Code>BBB</Code>
                <Code>CCC</Code>
            </RequestCodes>
        </Inventory>
        <Inventory InventoryId=""3"" InventoryName=""I3"">
            <RequestCodes>
                <Code>DDD</Code>
                <Code>EEE</Code>
                <Code>FFF</Code>
            </RequestCodes>
        </Inventory>
    </Requests>


Now I need to read the XML in a table like

    RequestReference	InventoryId	InventoryName	        Code
    R12345	                  1	          I1	        AAA
    R12345	                  2           I2	        BBB
    R12345	                  2	          I2	        CCC
    R12345	                  3	          I3	        DDD
    R12345	                  3	          I3	        EEE
    R12345	                  3	          I3	        FFF

I am trying something like 

    SELECT 
    	T.Item.value('@InventoryId', 'VARCHAR(3)')	AS InventoryId,
        T.Item.value('@InventoryName', 'VARCHAR(3)')	AS InventoryName,
        T.Item.value('RequestCodes[1]/Code[1]', 'VARCHAR(5)')	AS Code
    FROM   
       @xmlDoc.nodes('Requests/Inventory') 
       AS T(Item)

This seems to be working but not producing the desired results completely.",sql,sql-server,tsql,sql-server-2005,,,open,0,602,4,"Reading XML in table I have a stored procedure which is passed XML as a parameter and then I have to read that xML and do some updates. The format of the XML is 

    <Requests>
        <RequestReference>R12345</RequestReference>
        <Inventory InventoryId=""1"" InventoryName=""I1"">
            <RequestCodes>
                <Code>AAA</Code>
            </RequestCodes>
        </Inventory>
        <Inventory InventoryId=""2"" InventoryName=""I2"">
            <RequestCodes>
                <Code>BBB</Code>
                <Code>CCC</Code>
            </RequestCodes>
        </Inventory>
        <Inventory InventoryId=""3"" InventoryName=""I3"">
            <RequestCodes>
                <Code>DDD</Code>
                <Code>EEE</Code>
                <Code>FFF</Code>
            </RequestCodes>
        </Inventory>
    </Requests>


Now I need to read the XML in a table like

    RequestReference	InventoryId	InventoryName	        Code
    R12345	                  1	          I1	        AAA
    R12345	                  2           I2	        BBB
    R12345	                  2	          I2	        CCC
    R12345	                  3	          I3	        DDD
    R12345	                  3	          I3	        EEE
    R12345	                  3	          I3	        FFF

I am trying something like 

    SELECT 
    	T.Item.value('@InventoryId', 'VARCHAR(3)')	AS InventoryId,
        T.Item.value('@InventoryName', 'VARCHAR(3)')	AS InventoryName,
        T.Item.value('RequestCodes[1]/Code[1]', 'VARCHAR(5)')	AS Code
    FROM   
       @xmlDoc.nodes('Requests/Inventory') 
       AS T(Item)

This seems to be working but not producing the desired results completely.",4
7504403,09/21/2011 17:59:06,912223,08/25/2011 13:45:05,64,1,Select query issue,"I have the following data in a table:

    Date       ID             Start                   END        Duration_S     Duration_A
    9/12/2011 22216	9/12/2011 12:30:00 PM	9/12/2011 2:15:00 PM	6300	     NULL
    9/12/2011 22216	9/12/2011 2:30:00 PM	9/12/2011 2:39:00 PM	540           NULL
    9/12/2011 22216	9/12/2011 5:20:00 PM	9/12/2011 5:50:00 PM	1800           NULL

My goal is to update the Duration_A column, currently Null.

The information I use to get that info is a table structured like so:


    ID	      Start_Time	State	End_Time	   State_Duration
    22216	6/3/10 2:07:58	1	   6/3/10 2:20:58	    800
    22216	6/3/10 2:21:58	2	   6/3/10 2:25:55	    52
    22216	6/3/10 5:21:58	2	   6/3/10 5:31:05	    600

To update my Duration_A, I have to sum the duration containing certain states(this is no problem), but the issue is that the Start_Time and End_Time have to match the Start and End of my first table. Here is what I am doing:

    SELECT     tblB.ID, SUM(tblB.StateDuration) AS Total, tblA.Start_Time, 
                          tblA.End_Time
    FROM         
                          tblA INNER JOIN tblB ON tblB.Id = tblA.ID
                          tblB.Start_Time >= tblA.Start AND 
                          tblB.End_Time <= tblA.End
    
    WHERE     STATE IN (1, 2, 3, 4, 5, 6, 7, 10, 11)
    GROUP BY tblB.StateDuration, tblB.Id, tblA.Start_Time, 
                          tblA.End_Time,tblB.End_Time, 
                          tblB.Start_Time

This gives me the first duration when the start and end time of tblB match tblA, where I want the sum of all durations between those time frames. If I am not clear, let me know.
",sql,sql-server-2005,,,,,open,0,497,3,"Select query issue I have the following data in a table:

    Date       ID             Start                   END        Duration_S     Duration_A
    9/12/2011 22216	9/12/2011 12:30:00 PM	9/12/2011 2:15:00 PM	6300	     NULL
    9/12/2011 22216	9/12/2011 2:30:00 PM	9/12/2011 2:39:00 PM	540           NULL
    9/12/2011 22216	9/12/2011 5:20:00 PM	9/12/2011 5:50:00 PM	1800           NULL

My goal is to update the Duration_A column, currently Null.

The information I use to get that info is a table structured like so:


    ID	      Start_Time	State	End_Time	   State_Duration
    22216	6/3/10 2:07:58	1	   6/3/10 2:20:58	    800
    22216	6/3/10 2:21:58	2	   6/3/10 2:25:55	    52
    22216	6/3/10 5:21:58	2	   6/3/10 5:31:05	    600

To update my Duration_A, I have to sum the duration containing certain states(this is no problem), but the issue is that the Start_Time and End_Time have to match the Start and End of my first table. Here is what I am doing:

    SELECT     tblB.ID, SUM(tblB.StateDuration) AS Total, tblA.Start_Time, 
                          tblA.End_Time
    FROM         
                          tblA INNER JOIN tblB ON tblB.Id = tblA.ID
                          tblB.Start_Time >= tblA.Start AND 
                          tblB.End_Time <= tblA.End
    
    WHERE     STATE IN (1, 2, 3, 4, 5, 6, 7, 10, 11)
    GROUP BY tblB.StateDuration, tblB.Id, tblA.Start_Time, 
                          tblA.End_Time,tblB.End_Time, 
                          tblB.Start_Time

This gives me the first duration when the start and end time of tblB match tblA, where I want the sum of all durations between those time frames. If I am not clear, let me know.
",2
2962884,06/03/2010 01:57:14,357033,06/03/2010 01:46:27,1,0,100+ tables to joined,"I was wondering if anyone ever had a change to measure how a would 100 joined tables perform?
Each table would have an ID column with primary index and all table are 1:1 related. 

It is a common problem within many data entry applications where we need to collect 1000+ data points. One solution would be to have one big table with 1000+ columns and the alternative would be to split them into multiple tables and join them when it is necessary. 

So perhaps more real question would be how 30 tables (30 columns each) would behave with multitable join.

500K-1M rows should be the expected size of the tables.

Cheers

",sql,join,,,,,open,0,108,4,"100+ tables to joined I was wondering if anyone ever had a change to measure how a would 100 joined tables perform?
Each table would have an ID column with primary index and all table are 1:1 related. 

It is a common problem within many data entry applications where we need to collect 1000+ data points. One solution would be to have one big table with 1000+ columns and the alternative would be to split them into multiple tables and join them when it is necessary. 

So perhaps more real question would be how 30 tables (30 columns each) would behave with multitable join.

500K-1M rows should be the expected size of the tables.

Cheers

",2
488020,01/28/2009 15:25:31,7734,09/15/2008 14:19:11,2974,173,What is your best sql trick?,"
I am intending this to be an entry which is a resource for anyone to find out about aspects of sql that they may have not run into yet, so that the ideas can be stolen and used in their own programming.   With that in mind...

**What sql tricks have you personally used, that made it possible for you to do less actual real world  programming to get things done?**

",sql,reference,,,,11/18/2011 06:24:58,not constructive,1,72,6,"What is your best sql trick? 
I am intending this to be an entry which is a resource for anyone to find out about aspects of sql that they may have not run into yet, so that the ideas can be stolen and used in their own programming.   With that in mind...

**What sql tricks have you personally used, that made it possible for you to do less actual real world  programming to get things done?**

",2
9859606,03/25/2012 10:52:32,1233278,02/26/2012 01:50:26,11,0,What's a quick way to create SQL tables when starting out?,"I find that creating SQL tables tedious when starting to create a web app (ASP/Python/PHP).

Do you guys know any tools that makes creating tables quicker and faster and easier? Thanks in advance! :-)",sql,,,,,03/25/2012 12:45:16,not a real question,1,33,11,"What's a quick way to create SQL tables when starting out? I find that creating SQL tables tedious when starting to create a web app (ASP/Python/PHP).

Do you guys know any tools that makes creating tables quicker and faster and easier? Thanks in advance! :-)",1
3101375,06/23/2010 12:03:40,303832,03/28/2010 23:10:02,56,4,Wordpress SQL statement help needed?,"I want to select with sql latest post from one category,I know how to select latest post from all category but dont know how to JOIN tables.Can someone help me with this,and explain a little.
My sql statement.

    SELECT id,post_title,post_date FROM wp_posts ORDER BY post_date ASC

How to select from one category,I'm trying some code,looking INNER JOIN examples,but it doesnt work,help please.",sql,mysql,wordpress,,,,open,0,63,5,"Wordpress SQL statement help needed? I want to select with sql latest post from one category,I know how to select latest post from all category but dont know how to JOIN tables.Can someone help me with this,and explain a little.
My sql statement.

    SELECT id,post_title,post_date FROM wp_posts ORDER BY post_date ASC

How to select from one category,I'm trying some code,looking INNER JOIN examples,but it doesnt work,help please.",3
7560317,09/26/2011 19:36:13,852880,07/19/2011 21:53:39,8,0,SQL Selecting record with highest ID,"I have a issue with some SQL that I can't wrap my head around a solution. 

Right now the query I am running basically is:

    SELECT Q.ID, Q.STATUS, C.LASTNAME, C.FIRSTNAME, C.POSTAL, C.PHONE FROM QUEUE Q LEFT OUTER JOIN CUSTOMER C ON Q.ID = C.APPID WHERE C.LASTNAME LIKE 'SMITH%'

I have about 200 records from this query. My issue is the same person has multiple occurances. 

    Q.ID  Q.STATUS   C.LASTNAME   C.FIRSTNAME   ETC...
     1        A         SMITH        JOHN
     2        A         SMITH        RYAN
     3        B         SMITH        BRIAN
     100      A         SMITH        RYAN
     200      A         SMITH        RYAN

What I need returned instead is

    Q.ID   Q.STATUS   C.LASTNAME   C.FIRSTNAME   ETC...
     1        A          SMITH         JOHN
     3        B          SMITH         BRIAN
     200      A          SMITH         RYAN

Can anyone point me in the right direction please. I have tried

    SELECT WHATEVER FROM TABLE WHERE Q.ID IN (SELECT MAX(ID) FROM TABLE WHERE BLAH BLAH) 

which worked when searching for ""RYAN SMITH"" specifically. But I need to show all results for SMITH with the highest IDs.

Any help is appreciated.

Cheers

 ",sql,,,,,,open,0,397,6,"SQL Selecting record with highest ID I have a issue with some SQL that I can't wrap my head around a solution. 

Right now the query I am running basically is:

    SELECT Q.ID, Q.STATUS, C.LASTNAME, C.FIRSTNAME, C.POSTAL, C.PHONE FROM QUEUE Q LEFT OUTER JOIN CUSTOMER C ON Q.ID = C.APPID WHERE C.LASTNAME LIKE 'SMITH%'

I have about 200 records from this query. My issue is the same person has multiple occurances. 

    Q.ID  Q.STATUS   C.LASTNAME   C.FIRSTNAME   ETC...
     1        A         SMITH        JOHN
     2        A         SMITH        RYAN
     3        B         SMITH        BRIAN
     100      A         SMITH        RYAN
     200      A         SMITH        RYAN

What I need returned instead is

    Q.ID   Q.STATUS   C.LASTNAME   C.FIRSTNAME   ETC...
     1        A          SMITH         JOHN
     3        B          SMITH         BRIAN
     200      A          SMITH         RYAN

Can anyone point me in the right direction please. I have tried

    SELECT WHATEVER FROM TABLE WHERE Q.ID IN (SELECT MAX(ID) FROM TABLE WHERE BLAH BLAH) 

which worked when searching for ""RYAN SMITH"" specifically. But I need to show all results for SMITH with the highest IDs.

Any help is appreciated.

Cheers

 ",1
5942056,05/09/2011 20:21:56,735779,05/03/2011 08:48:20,94,3,"Very complex database architecture, how to deal with it ?","I have worked on several rails applications and now I work on a very complex one, from the database side. A lots of nested models, several polymorphyc associations...

How you deal with that complexity ? How can I know that we are working in the good direction ? What about performance issues ?

Thansk for your opinions.",sql,ruby-on-rails,ruby-on-rails-3,postgresql,,05/10/2011 00:47:49,not a real question,1,55,10,"Very complex database architecture, how to deal with it ? I have worked on several rails applications and now I work on a very complex one, from the database side. A lots of nested models, several polymorphyc associations...

How you deal with that complexity ? How can I know that we are working in the good direction ? What about performance issues ?

Thansk for your opinions.",4
9775837,03/19/2012 18:32:42,1229244,02/23/2012 19:56:45,12,2,SQL Qeury to return Geography type as XML,"I'm trying to return an XML from a table which holds a Geography type.  
SQL query:  

    SELECT *
    From Events
    ORDER BY HydrantId ASC
    FOR XML RAW ('Event'), ROOT ('Events'), ELEMENTS XSINIL;

I'm getting the following error:  

    FOR XML does not support CLR types -   
    cast CLR types explicitly into one of the supported types in FOR XML queries.  

How can I cast this Geography column to something which is readable?  
Thanks.",sql,xml,query,sqlgeography,,,open,0,99,8,"SQL Qeury to return Geography type as XML I'm trying to return an XML from a table which holds a Geography type.  
SQL query:  

    SELECT *
    From Events
    ORDER BY HydrantId ASC
    FOR XML RAW ('Event'), ROOT ('Events'), ELEMENTS XSINIL;

I'm getting the following error:  

    FOR XML does not support CLR types -   
    cast CLR types explicitly into one of the supported types in FOR XML queries.  

How can I cast this Geography column to something which is readable?  
Thanks.",4
1049062,06/26/2009 13:14:14,15354,09/17/2008 08:35:10,1637,188,Should a SQL VIEW always be in 1NF?,"A SQL VIEW is a global, logical table that may or may not be persisted. But it's still a table. Therefore, should a VIEW always adhere to first normal form (1NF)? i.e. no duplicate rows, scalar types only, no top-to-bottom or left-to-right ordering, etc. What about the higher normal forms?",sql,normalization,,,,,open,0,50,8,"Should a SQL VIEW always be in 1NF? A SQL VIEW is a global, logical table that may or may not be persisted. But it's still a table. Therefore, should a VIEW always adhere to first normal form (1NF)? i.e. no duplicate rows, scalar types only, no top-to-bottom or left-to-right ordering, etc. What about the higher normal forms?",2
9925659,03/29/2012 12:47:58,666160,03/18/2011 14:16:09,27,0,"update table with self fired  INSERT trigger using standard UPDATE statement, and not :NEW method","When i insert data into table, i want to update field trenutna_cena. I know this is possible to to with this code:

    CREATE OR REPLACE TRIGGER TRG_PROCED_SK_CENA
    BEFORE INSERT ON stavka_kataloga
    FOR EACH ROW
    DECLARE 
    pragma autonomous_transaction;
    BEGIN
    :NEW.trenutna_cena := 'da';
    COMMIT;
    END;
    /
that was the way doing that without using packages, and stored procedures.And with using only **BEFORE TRIGGER**. But since this is a school project, i need to do that using Packages, Stored procedure, and Trigger. So code below is my try at it. But it doesn't seems to work. PROCEDURE IS THE PROBLEM just to short time on thiking. variables are passed correctly to procedure, but UPDATE just doesn't work in it.

**CREATION OF THE PACKAGE** 

    CREATE OR REPLACE PACKAGE paket_stavka_kataloga IS
    sifra_stavke_kat NUMBER;
    END paket_stavka_kataloga;
    /

**CREATION OF THE PROCEDURE** 

    CREATE OR REPLACE PROCEDURE pstavka_nar_trenutna_cena(v_sifra_stavke_kat IN NUMBER)
    IS
    BEGIN
    update stavka_kataloga set trenutna_cena = 'da' where sifra_stavke_kat = v_sifra_stavke_kat;
    END;
    /
   

**CREATION OF TRIGGER**

    CREATE OR REPLACE TRIGGER TRG_PROCED_SK_CENA
    BEFORE INSERT ON stavka_kataloga
    FOR EACH ROW
    DECLARE 
    pragma autonomous_transaction;
    BEGIN
    paket_stavka_kataloga.sifra_stavke_kat:= :NEW.sifra_stavke_kat;
    pstavka_nar_trenutna_cena(paket_stavka_kataloga.sifra_stavke_kat);
    COMMIT;
    END;
    /

any suggestion and help is welcome. Thanks!",sql,database,oracle,triggers,oracle11g,03/29/2012 14:30:29,too localized,1,283,16,"update table with self fired  INSERT trigger using standard UPDATE statement, and not :NEW method When i insert data into table, i want to update field trenutna_cena. I know this is possible to to with this code:

    CREATE OR REPLACE TRIGGER TRG_PROCED_SK_CENA
    BEFORE INSERT ON stavka_kataloga
    FOR EACH ROW
    DECLARE 
    pragma autonomous_transaction;
    BEGIN
    :NEW.trenutna_cena := 'da';
    COMMIT;
    END;
    /
that was the way doing that without using packages, and stored procedures.And with using only **BEFORE TRIGGER**. But since this is a school project, i need to do that using Packages, Stored procedure, and Trigger. So code below is my try at it. But it doesn't seems to work. PROCEDURE IS THE PROBLEM just to short time on thiking. variables are passed correctly to procedure, but UPDATE just doesn't work in it.

**CREATION OF THE PACKAGE** 

    CREATE OR REPLACE PACKAGE paket_stavka_kataloga IS
    sifra_stavke_kat NUMBER;
    END paket_stavka_kataloga;
    /

**CREATION OF THE PROCEDURE** 

    CREATE OR REPLACE PROCEDURE pstavka_nar_trenutna_cena(v_sifra_stavke_kat IN NUMBER)
    IS
    BEGIN
    update stavka_kataloga set trenutna_cena = 'da' where sifra_stavke_kat = v_sifra_stavke_kat;
    END;
    /
   

**CREATION OF TRIGGER**

    CREATE OR REPLACE TRIGGER TRG_PROCED_SK_CENA
    BEFORE INSERT ON stavka_kataloga
    FOR EACH ROW
    DECLARE 
    pragma autonomous_transaction;
    BEGIN
    paket_stavka_kataloga.sifra_stavke_kat:= :NEW.sifra_stavke_kat;
    pstavka_nar_trenutna_cena(paket_stavka_kataloga.sifra_stavke_kat);
    COMMIT;
    END;
    /

any suggestion and help is welcome. Thanks!",5
6667458,07/12/2011 16:12:28,530340,12/04/2010 10:20:09,190,1,need help understanding the following very complex query,"if anyone can break the query up into logical parts; it will be of great help. just a short note and pointers on what each part is doing ..


    SELECT qs.execution_count AS [Runs], 
                         (qs.total_worker_time - qs.last_worker_time) / (qs.execution_count - 1) AS [Avg time],
                         qs.last_worker_time AS [Last time], 
                         (qs.last_worker_time - ((qs.total_worker_time - qs.last_worker_time) /
                         (qs.execution_count - 1))) AS [Time Deviation], 
                         CASE WHEN qs.last_worker_time = 0 
                              THEN 100
                              ELSE (qs.last_worker_time - ((qs.total_worker_time -
                                    qs.last_worker_time) / (qs.execution_count - 1))) * 100
                         END
                         / (((qs.total_worker_time - qs.last_worker_time) /
                             (qs.execution_count - 1.0))) AS [% Time Deviation],
                         qs.last_logical_reads + qs.last_logical_writes + qs.last_physical_reads AS [Last IO],
                         ((qs.total_logical_reads + qs.total_logical_writes + qs.total_physical_reads) -
                         (qs.last_logical_reads + last_logical_writes + qs.last_physical_reads)) / 
                         (qs.execution_count - 1) AS [Avg IO], 
                         SUBSTRING (qt.text,(qs.statement_start_offset/2) + 1,
                                   ((CASE WHEN qs.statement_end_offset = -1
                                   THEN LEN(CONVERT(NVARCHAR(MAX), qt.text)) * 2
                                   ELSE qs.statement_end_offset
                                   END - qs.statement_start_offset)/2) + 1) AS [Individual Query], 
                        qt.text AS [Parent Query], 
                        DB_NAME(qt.dbid) AS [DatabaseName]
                  INTO #SlowQueries
                  FROM sys.dm_exec_query_stats qs
                  CROSS APPLY sys.dm_exec_sql_text(qs.plan_handle) qt
                  WHERE qs.execution_count > 1
                  AND qs.total_worker_time != qs.last_worker_time
                  ORDER BY [% Time Deviation] DESC

                  SELECT [Runs], [Avg time], [Last time], [Time Deviation], [% Time Deviation], 
                         [Last IO], [Avg IO], [Last IO] - [Avg IO] AS [IO Deviation], 
                         CASE WHEN [Avg IO] = 0
                              THEN 0
                              ELSE ([Last IO]- [Avg IO]) * 100 / [Avg IO]
                         END AS [% IO Deviation], 
                         [Individual Query], [Parent Query], [DatabaseName]
                 INTO #SlowQueriesByIO
                 FROM #SlowQueries
                 ORDER BY [% Time Deviation] DESC
                 
                SELECT [Runs], [Avg time], [Last time], [Time Deviation], [% Time Deviation], [Last IO],
                       [Avg IO], [IO Deviation], [% IO Deviation], 
                       [Impedance] = [% Time Deviation] - [% IO Deviation], [Individual Query], [Parent Query],
                       [DatabaseName]
                FROM #SlowQueriesByIO
                WHERE [% Time Deviation] - [% IO Deviation] > 20
                ORDER BY [Impedance] DESC
                DROP TABLE #SlowQueries
                DROP TABLE #SlowQueriesByIO


Can anyone please help me understand the above query. Its simply too complex for me to understand. its a DMV of SQL server i found .",sql,sql-server-2008,,,,07/12/2011 16:47:14,not a real question,1,1413,8,"need help understanding the following very complex query if anyone can break the query up into logical parts; it will be of great help. just a short note and pointers on what each part is doing ..


    SELECT qs.execution_count AS [Runs], 
                         (qs.total_worker_time - qs.last_worker_time) / (qs.execution_count - 1) AS [Avg time],
                         qs.last_worker_time AS [Last time], 
                         (qs.last_worker_time - ((qs.total_worker_time - qs.last_worker_time) /
                         (qs.execution_count - 1))) AS [Time Deviation], 
                         CASE WHEN qs.last_worker_time = 0 
                              THEN 100
                              ELSE (qs.last_worker_time - ((qs.total_worker_time -
                                    qs.last_worker_time) / (qs.execution_count - 1))) * 100
                         END
                         / (((qs.total_worker_time - qs.last_worker_time) /
                             (qs.execution_count - 1.0))) AS [% Time Deviation],
                         qs.last_logical_reads + qs.last_logical_writes + qs.last_physical_reads AS [Last IO],
                         ((qs.total_logical_reads + qs.total_logical_writes + qs.total_physical_reads) -
                         (qs.last_logical_reads + last_logical_writes + qs.last_physical_reads)) / 
                         (qs.execution_count - 1) AS [Avg IO], 
                         SUBSTRING (qt.text,(qs.statement_start_offset/2) + 1,
                                   ((CASE WHEN qs.statement_end_offset = -1
                                   THEN LEN(CONVERT(NVARCHAR(MAX), qt.text)) * 2
                                   ELSE qs.statement_end_offset
                                   END - qs.statement_start_offset)/2) + 1) AS [Individual Query], 
                        qt.text AS [Parent Query], 
                        DB_NAME(qt.dbid) AS [DatabaseName]
                  INTO #SlowQueries
                  FROM sys.dm_exec_query_stats qs
                  CROSS APPLY sys.dm_exec_sql_text(qs.plan_handle) qt
                  WHERE qs.execution_count > 1
                  AND qs.total_worker_time != qs.last_worker_time
                  ORDER BY [% Time Deviation] DESC

                  SELECT [Runs], [Avg time], [Last time], [Time Deviation], [% Time Deviation], 
                         [Last IO], [Avg IO], [Last IO] - [Avg IO] AS [IO Deviation], 
                         CASE WHEN [Avg IO] = 0
                              THEN 0
                              ELSE ([Last IO]- [Avg IO]) * 100 / [Avg IO]
                         END AS [% IO Deviation], 
                         [Individual Query], [Parent Query], [DatabaseName]
                 INTO #SlowQueriesByIO
                 FROM #SlowQueries
                 ORDER BY [% Time Deviation] DESC
                 
                SELECT [Runs], [Avg time], [Last time], [Time Deviation], [% Time Deviation], [Last IO],
                       [Avg IO], [IO Deviation], [% IO Deviation], 
                       [Impedance] = [% Time Deviation] - [% IO Deviation], [Individual Query], [Parent Query],
                       [DatabaseName]
                FROM #SlowQueriesByIO
                WHERE [% Time Deviation] - [% IO Deviation] > 20
                ORDER BY [Impedance] DESC
                DROP TABLE #SlowQueries
                DROP TABLE #SlowQueriesByIO


Can anyone please help me understand the above query. Its simply too complex for me to understand. its a DMV of SQL server i found .",2
11743265,07/31/2012 15:11:03,1088389,12/08/2011 19:07:20,303,7,insert multiple rows into DB2 database,"I want to insert multiple rows into a DB2 table.
I have a query that looks like this

    insert into tableName 
    (col1, col2, col3, col4, col5) 
    values 
    (val1, val2, val3, val4, val5),
    (val1, val2, val3, val4, val5),
    (val1, val2, val3, val4, val5),
    (val1, val2, val3, val4, val5);

This query does't work. I don't know if there is a more syntactically correct way to do this in DB2. But it'd be useful to insert my test data. ",sql,query,db2,,,,open,0,99,6,"insert multiple rows into DB2 database I want to insert multiple rows into a DB2 table.
I have a query that looks like this

    insert into tableName 
    (col1, col2, col3, col4, col5) 
    values 
    (val1, val2, val3, val4, val5),
    (val1, val2, val3, val4, val5),
    (val1, val2, val3, val4, val5),
    (val1, val2, val3, val4, val5);

This query does't work. I don't know if there is a more syntactically correct way to do this in DB2. But it'd be useful to insert my test data. ",3
11562536,07/19/2012 14:01:07,33584,11/03/2008 07:45:07,1173,25,Update records in table after CTE,"I have the following CTE that will give me the DocTotal for the entire invoice.

     ;WITH CTE_DocTotal
     AS
     (
       SELECT SUM(Sale + VAT) AS DocTotal
       FROM PEDI_InvoiceDetail
       GROUP BY InvoiceNumber
     )

    UPDATE PEDI_InvoiceDetail
    SET DocTotal = CTE_DocTotal.DocTotal

Now with this result I want to enter into the column the DocTotal value inside PEDI_InvoiceDetail.

I know is not going to work and I know I am missing something, what is it?
",sql,sql-server,tsql,common-table-expression,,,open,0,108,6,"Update records in table after CTE I have the following CTE that will give me the DocTotal for the entire invoice.

     ;WITH CTE_DocTotal
     AS
     (
       SELECT SUM(Sale + VAT) AS DocTotal
       FROM PEDI_InvoiceDetail
       GROUP BY InvoiceNumber
     )

    UPDATE PEDI_InvoiceDetail
    SET DocTotal = CTE_DocTotal.DocTotal

Now with this result I want to enter into the column the DocTotal value inside PEDI_InvoiceDetail.

I know is not going to work and I know I am missing something, what is it?
",4
8781202,01/08/2012 20:51:00,346005,05/20/2010 10:30:25,1243,72,Ensure that a SQL query is READ-only,"What would be the best way to ensure that a **SQL query won't alter the data** of a database?

In my scenario, you don't have access to the database layer and can only do this logic on the application layer.

Would you recommend using a gem, a ruby custom script?",sql,ruby,ruby-on-rails-3.1,sequel,,,open,0,48,7,"Ensure that a SQL query is READ-only What would be the best way to ensure that a **SQL query won't alter the data** of a database?

In my scenario, you don't have access to the database layer and can only do this logic on the application layer.

Would you recommend using a gem, a ruby custom script?",4
9396605,02/22/2012 14:21:25,1108768,12/20/2011 22:12:12,1,0,#SQL Moving multiple Row Data into its own Column,"I've searched StackOverflow and google for quite some time now and haven't been able to find an answer even remotely close to my desired solution using SQL. I have a CSV file (1 table) and it has data for numerous users. The problem is each user has multiple rows with multiple scores but same UserID. I would like to move those scores into their own column to present one row with all of the user's data. How can I achieve this using SQL?

Example of Current Layout:

UserID, FNm, LNm, Measure, Score

 - 0001, person, one, LNF, 26
 - 0001, person, one, NFS, 74
 - 0001, person, one, CFS, 54
 - 0002, person, two, LNF, 35
 - 0002, person, two, NFS, 43
 - 0002, person, two, CFS, 33

Desired Solution:

UserID, FNm, LNm, LNF, NFS, CFS

 - 0001, person, one, 26, 74, 54
 - 0002, person, two, 35, 43, 33

",sql,server,access,,,,open,0,146,9,"#SQL Moving multiple Row Data into its own Column I've searched StackOverflow and google for quite some time now and haven't been able to find an answer even remotely close to my desired solution using SQL. I have a CSV file (1 table) and it has data for numerous users. The problem is each user has multiple rows with multiple scores but same UserID. I would like to move those scores into their own column to present one row with all of the user's data. How can I achieve this using SQL?

Example of Current Layout:

UserID, FNm, LNm, Measure, Score

 - 0001, person, one, LNF, 26
 - 0001, person, one, NFS, 74
 - 0001, person, one, CFS, 54
 - 0002, person, two, LNF, 35
 - 0002, person, two, NFS, 43
 - 0002, person, two, CFS, 33

Desired Solution:

UserID, FNm, LNm, LNF, NFS, CFS

 - 0001, person, one, 26, 74, 54
 - 0002, person, two, 35, 43, 33

",3
7943353,10/30/2011 04:43:43,734984,05/02/2011 19:19:06,1329,26,"Which is more recommended, SQL in the program or in database in stored procedures?","There is any recommendation where is the better place to store the SQL codes?

Supposing two types of SQL queries (CRUD commands and Bussiness queries),  where is better, more recommended and more used place to store the SQL, inside the application or in database?",sql,database,,,,10/30/2011 13:47:03,not constructive,1,44,14,"Which is more recommended, SQL in the program or in database in stored procedures? There is any recommendation where is the better place to store the SQL codes?

Supposing two types of SQL queries (CRUD commands and Bussiness queries),  where is better, more recommended and more used place to store the SQL, inside the application or in database?",2
9650099,03/10/2012 20:53:30,91607,04/16/2009 12:44:26,1989,28,How to combine multiple SQL queries into a single one?,"I have these multiple sql queries that I want to bundle together into one single query :

1) select * from table18 where pin = 123;

2) select * from table1 where case = (select case from table18 where pin = 123);

3) select * from table5 where pin = 123;

4) select * from table55 where seqNum = 0 and rfa = (select rfa from table18 where pin = 123);

5) select * from table103 where histCode = 0 and case = (select case from table18 where pin = 123);

6) select * from table715 where histSeqNum in (select max(histSeqNum from table715))
      and histCode in (select max(histCode) from table715)
      and case = (select case from table18 where pin = 123);
",sql,,,,,03/11/2012 13:45:25,not a real question,1,125,10,"How to combine multiple SQL queries into a single one? I have these multiple sql queries that I want to bundle together into one single query :

1) select * from table18 where pin = 123;

2) select * from table1 where case = (select case from table18 where pin = 123);

3) select * from table5 where pin = 123;

4) select * from table55 where seqNum = 0 and rfa = (select rfa from table18 where pin = 123);

5) select * from table103 where histCode = 0 and case = (select case from table18 where pin = 123);

6) select * from table715 where histSeqNum in (select max(histSeqNum from table715))
      and histCode in (select max(histCode) from table715)
      and case = (select case from table18 where pin = 123);
",1
10203010,04/18/2012 04:55:01,260653,01/28/2010 04:50:24,16,0,Update 30 fields in a table in one go,I need to update 2 columns in a table for 30 rows. Tried using dbms utility - arrays but it doesnt accept spaces. Please suggest an optimised way to update 30 rows in one go.,sql,oracle,,,,04/18/2012 06:15:17,not a real question,1,35,9,Update 30 fields in a table in one go I need to update 2 columns in a table for 30 rows. Tried using dbms utility - arrays but it doesnt accept spaces. Please suggest an optimised way to update 30 rows in one go.,2
4929186,02/08/2011 03:06:57,575353,01/14/2011 07:26:23,1,1,How to export excel from sql server when meeting cannot create an instance?,"Msg 7302, Level 16, State 1, Line 13
Cannot create an instance of OLE DB provider ""Microsoft.Jet.OLEDB.4.0"" for linked server ""(null)"".


    declare @PivotList nvarchar(MAX)
    declare @SQL nvarchar(MAX)
    set @PivotList=(SELECT top(1)
    substring((SELECT distinct ( ' [' + Company + '],' ) 
    from Temp_Car_Park_Transactions t2 group by Company
    FOR XML PATH( '' ) 
    ), 2, 1000 ) as col)
    
    set @SQL=' select * from (select [serial_no], [Date], Company from Temp_Car_Park_Transactions)t '
    set @SQL=@SQL+ 'pivot(count(serial_no) for Company in('+substring(@PivotList,1,LEN(@PivotList)-1)+'))pvt '
    --exec (@SQL)
    
    insert into OPENROWSET('Microsoft.Jet.OLEDB.4.0', 
        'Excel 8.0;Database=d:\Applications\Carpark\Excel\Analysis.xls;', 
        'SELECT * FROM [SheetName$]') exec (@SQL)",sql,sql-server,,,,,open,0,147,13,"How to export excel from sql server when meeting cannot create an instance? Msg 7302, Level 16, State 1, Line 13
Cannot create an instance of OLE DB provider ""Microsoft.Jet.OLEDB.4.0"" for linked server ""(null)"".


    declare @PivotList nvarchar(MAX)
    declare @SQL nvarchar(MAX)
    set @PivotList=(SELECT top(1)
    substring((SELECT distinct ( ' [' + Company + '],' ) 
    from Temp_Car_Park_Transactions t2 group by Company
    FOR XML PATH( '' ) 
    ), 2, 1000 ) as col)
    
    set @SQL=' select * from (select [serial_no], [Date], Company from Temp_Car_Park_Transactions)t '
    set @SQL=@SQL+ 'pivot(count(serial_no) for Company in('+substring(@PivotList,1,LEN(@PivotList)-1)+'))pvt '
    --exec (@SQL)
    
    insert into OPENROWSET('Microsoft.Jet.OLEDB.4.0', 
        'Excel 8.0;Database=d:\Applications\Carpark\Excel\Analysis.xls;', 
        'SELECT * FROM [SheetName$]') exec (@SQL)",2
1731177,11/13/2009 19:01:49,210679,11/13/2009 19:01:49,1,0,Need some help with SQL GroupBY,"I have a two column table as follows:

    ID    Emp ID
    1      1
    1      2
    1      3
    1      4
    2      2
    2      6
    2      10
    3      1
    3      5
    4      8
    5      2
    5      6

I need something like this:

    ID   Emp ID
    1    1,2,3,4
    2    2,6,10
    3     1,5
    4     8
    5     2,6

Please help :)",sql,group-by,,,,,open,0,194,6,"Need some help with SQL GroupBY I have a two column table as follows:

    ID    Emp ID
    1      1
    1      2
    1      3
    1      4
    2      2
    2      6
    2      10
    3      1
    3      5
    4      8
    5      2
    5      6

I need something like this:

    ID   Emp ID
    1    1,2,3,4
    2    2,6,10
    3     1,5
    4     8
    5     2,6

Please help :)",2
11374321,07/07/2012 10:45:53,623266,02/18/2011 14:17:12,1096,19,get the recordset of users who submitted resources in order of who submitted the most rails,"Users can submit resources.  I want to show the users who are most 'active' by showing the users who have submitted resources and comments and show the results in  order of the user with the most submitted the most resources and comments combined to the least. 


    **Resource**
    has_many :users, :through => :kits
    has_many :kits
    belongs_to :submitter, class_name: ""User""
    
    **User**
    has_many :resources, :through => :kits
    has_many :kits
    has_many :submitted_resources, class_name: ""Resource"", foreign_key: ""submitter_id""
    
    **Kits**
    belongs_to :resource
    belongs_to :user
    
    **Comments**
     belongs_to :user

I am a NOOB when it comes to this kind of sql in Rails. How can I get this record set?",sql,scope,ruby-on-rails-3.2,,,,open,0,155,16,"get the recordset of users who submitted resources in order of who submitted the most rails Users can submit resources.  I want to show the users who are most 'active' by showing the users who have submitted resources and comments and show the results in  order of the user with the most submitted the most resources and comments combined to the least. 


    **Resource**
    has_many :users, :through => :kits
    has_many :kits
    belongs_to :submitter, class_name: ""User""
    
    **User**
    has_many :resources, :through => :kits
    has_many :kits
    has_many :submitted_resources, class_name: ""Resource"", foreign_key: ""submitter_id""
    
    **Kits**
    belongs_to :resource
    belongs_to :user
    
    **Comments**
     belongs_to :user

I am a NOOB when it comes to this kind of sql in Rails. How can I get this record set?",3
1187627,07/27/2009 11:20:28,131870,07/01/2009 17:54:58,26,10,Need a help in query?,"I have a hierarchical tree table structure .How can i get the left tree and right tree .


    1	a	NULL
    2	b	1
    3	c	1
    4	d	2
    5	e	2
    6	f	3
    7	g	3
    8	h	4
    9	i	4
    10	j	5
    11	k	5
    12	l	6 

If i have the id of a ie 1 .how can i get the tree of b and c

i am expecting the tree under b as 


    2	b	
    4	d	
    5	e	
    8	h	
    9	i	
    10	j	
    11	k	


Here i an following adjacency model only  i am going .I am not looking for nested model.
This mit be a duplicate question . ",sql,sql-server,sql-server-2005,,,,open,0,145,5,"Need a help in query? I have a hierarchical tree table structure .How can i get the left tree and right tree .


    1	a	NULL
    2	b	1
    3	c	1
    4	d	2
    5	e	2
    6	f	3
    7	g	3
    8	h	4
    9	i	4
    10	j	5
    11	k	5
    12	l	6 

If i have the id of a ie 1 .how can i get the tree of b and c

i am expecting the tree under b as 


    2	b	
    4	d	
    5	e	
    8	h	
    9	i	
    10	j	
    11	k	


Here i an following adjacency model only  i am going .I am not looking for nested model.
This mit be a duplicate question . ",3
2209220,02/05/2010 17:54:10,14193,09/16/2008 22:27:01,389,11,How do I make a SQL table from the result of another select?,"I'm asking for MySQL specifically, but the answer might work for a lot of SQL databases.

If I have a select statement like this:

    select * from users where age > 5;

How do I assign that to a new table?",sql,,,,,,open,0,42,13,"How do I make a SQL table from the result of another select? I'm asking for MySQL specifically, but the answer might work for a lot of SQL databases.

If I have a select statement like this:

    select * from users where age > 5;

How do I assign that to a new table?",1
4365829,12/06/2010 11:19:25,233085,12/16/2009 16:00:39,138,21,select first 10 rows and then select 5 random row of them,"i want to select first 10 rows then select 5 random rows of them.

",sql,select,,,,12/07/2010 01:16:12,not a real question,1,14,12,"select first 10 rows and then select 5 random row of them i want to select first 10 rows then select 5 random rows of them.

",2
7767986,10/14/2011 13:02:29,907526,08/23/2011 10:38:57,68,2,Sybase compare number of values from 2 queries in one query,"Is it possible to compare the count of 2 separate queries in one step?

I have table A which has x records. From table B, I want to check that all x records are within it. 

I'm struggling to find a way to go this. I've been looking at this for days and the closest I've got is returning only if the exact records are in A and B, no difference or subset. ",sql,database,query,sybase,,,open,0,73,11,"Sybase compare number of values from 2 queries in one query Is it possible to compare the count of 2 separate queries in one step?

I have table A which has x records. From table B, I want to check that all x records are within it. 

I'm struggling to find a way to go this. I've been looking at this for days and the closest I've got is returning only if the exact records are in A and B, no difference or subset. ",4
6353155,06/15/2011 04:50:34,616919,02/14/2011 21:51:05,8,0,ProcID lineage identification,"I am working with SQL Server 2008 and need for stored proc B to be able to give (whether that means storeor print etc...) the name/id of stored proc A which called it. I.e. I would like to find the value of the parent of @@ProcID.

I have seen the question has been asked but not given a satisfactory answer (from Microsoft or any online community) so I thought there would be a clevr solution using sp_who in combination with master..sysprocesses but I haven't come up with one.",sql,tsql,sql-server-2008,,,,open,0,87,3,"ProcID lineage identification I am working with SQL Server 2008 and need for stored proc B to be able to give (whether that means storeor print etc...) the name/id of stored proc A which called it. I.e. I would like to find the value of the parent of @@ProcID.

I have seen the question has been asked but not given a satisfactory answer (from Microsoft or any online community) so I thought there would be a clevr solution using sp_who in combination with master..sysprocesses but I haven't come up with one.",3
6416308,06/20/2011 19:23:07,247542,01/10/2010 16:35:34,2563,95,Natural Language SQL Query,"What are the most comprehensive open source natural-language to SQL query translators? I was only able to find the following three, and non of them work very well, if at all:

 - [C-Phase][1], still maintained, primitive but working code, written in LISP
 - [nlbean][2], working but unmaintained proof-of-concept code, written in Java
 - [SQ-HAL][3], non-working unmaintained code, part of a graduate thesis project, written in Perl. I was able to get it to run, but it doesn't appear to actually do any translation out of the box.


  [1]: http://code.google.com/p/c-phrase/
  [2]: http://www.markwatson.com/opensource/
  [3]: http://www.csse.monash.edu.au/hons/projects/2000/Supun.Ruwanpura/",sql,nlp,machine-learning,,,06/21/2011 09:01:25,not constructive,1,96,4,"Natural Language SQL Query What are the most comprehensive open source natural-language to SQL query translators? I was only able to find the following three, and non of them work very well, if at all:

 - [C-Phase][1], still maintained, primitive but working code, written in LISP
 - [nlbean][2], working but unmaintained proof-of-concept code, written in Java
 - [SQ-HAL][3], non-working unmaintained code, part of a graduate thesis project, written in Perl. I was able to get it to run, but it doesn't appear to actually do any translation out of the box.


  [1]: http://code.google.com/p/c-phrase/
  [2]: http://www.markwatson.com/opensource/
  [3]: http://www.csse.monash.edu.au/hons/projects/2000/Supun.Ruwanpura/",3
3213540,07/09/2010 14:24:29,370456,06/18/2010 15:48:46,1,0,Silverlight 4 & SQLite,"I've been doing some research on finding an embedded database to be used with Silverlight/isolated storage.  Everyone says SQLite will not work with Silverlight due to unmanaged code.

From my experience there is just a dll named System.Data.SQLite.DLL which I believe I either got from installed SQLite.NET or from the NHibernate build.  

When configuring in c# code you can use a file based database and just specify a file to use. 

So my question is where is the unmanaged code?  And why wouldn't using file based database and writing it to isolated storage work?  And now that Silverlight 4 supports OOB does that have any impact on this?

Answers appreciated ahead of time.  

Regards",sql,silverlight,silverlight-4.0,,,,open,0,117,4,"Silverlight 4 & SQLite I've been doing some research on finding an embedded database to be used with Silverlight/isolated storage.  Everyone says SQLite will not work with Silverlight due to unmanaged code.

From my experience there is just a dll named System.Data.SQLite.DLL which I believe I either got from installed SQLite.NET or from the NHibernate build.  

When configuring in c# code you can use a file based database and just specify a file to use. 

So my question is where is the unmanaged code?  And why wouldn't using file based database and writing it to isolated storage work?  And now that Silverlight 4 supports OOB does that have any impact on this?

Answers appreciated ahead of time.  

Regards",3
4073339,11/01/2010 21:45:37,494105,11/01/2010 21:45:37,1,0,I need help to convert sql to relational algebra,"Select  a.SalesRepName, Product.ProductName, Product.ProductNo, Product.ProductDescription, Product.ProductPrice , Product.Unit, Product.ProductRep, b.salesRepName  manager
   From   SalesRep a, SalesRep b, Product
   Where a.SalesRepID = Product.ProductRep
        and a.Supervisor = b.SalesRepId;


I need to translate this to relational algebra. Can someone help me out pl ?

Pl note that I had to use the alias a and b since the Manager is also a SalesRep so the attribute Manager had to be relative to an attribute in the same table.

Thanks",sql,relational,algebra,multiple-databases,,10/24/2011 02:11:40,too localized,1,87,9,"I need help to convert sql to relational algebra Select  a.SalesRepName, Product.ProductName, Product.ProductNo, Product.ProductDescription, Product.ProductPrice , Product.Unit, Product.ProductRep, b.salesRepName  manager
   From   SalesRep a, SalesRep b, Product
   Where a.SalesRepID = Product.ProductRep
        and a.Supervisor = b.SalesRepId;


I need to translate this to relational algebra. Can someone help me out pl ?

Pl note that I had to use the alias a and b since the Manager is also a SalesRep so the attribute Manager had to be relative to an attribute in the same table.

Thanks",4
7193272,08/25/2011 15:42:29,725431,04/26/2011 13:14:15,92,0,help with 2 loops and an update in sql server 2000,"   
I am working on a stored procedure that will trigger once a week so i am not worried about speed as much as getting the thing to work.


what i am trying to do is loop through a table called households that stores information about the houses,

then using the houseid looping through a table called individuals 

which will return more then one person therefore leading me to loop through that result to gather inforamtion.

my main goal is to concatenate all the names of the people in the household, and their codes


 

    declare @RowNum int,
        @houseId nchar(10), 
        @hid nchar(25) 
        
        select @houseId=MAX(ID) FROM households     --start with the highest ID 
        Select @RowNum = Count(*) From households      --get total number of records
        WHILE @RowNum > 0                          --loop until no more records BEGIN       
         
        select @hid = id from households where ID = @houseid    --get other info from that row  
        
        DECLARE @RowCount INT
        
        SET @RowCount = (SELECT COUNT(ID) FROM (select id, firstname,lastname,party_code from indviduals where householdid = @houseid) as table1)  
        DECLARE @code1 VARCHAR(50), @names1 VARCHAR(500), @lastname1 VARCHAR(50) 
        -- Declare an iterator
        DECLARE @I INT
        -- Initialize the iterator
        SET @I = (select min(id) from indviduals where householdid = @houseid)
        
        -- Loop through the rows of a table @myTable
        WHILE (@I <= @RowCount)
        BEGIN
                -- Declare variables to hold the data which we get after looping each record 
                DECLARE @code VARCHAR(50), @names VARCHAR(500), @lastname VARCHAR(50)    
                
                -- Get the data from table and set to variables
                SELECT @code = party_code, @names = firstname, @lastname = lastname FROM (select id, firstname,lastname,party_code from indviduals where householdid = @houseid) as table1  WHERE ID = @I
                -- Display the looped data
         
        
         
        set @code1 = (@code + ',' + @code1)
        set @names1 = (@names + ',' + @names1)
        set @lastname1 = @lastname
                -- Increment the iterator
                SET @I = @I  + 1
        END
        
        update households    
        SET firstnames=@names1, lastname=@lastname1, party_codes=@code1,
        where id = @houseid  
        
        select top 1 @houseId=ID 
        from households
        where ID < @houseID 
        order by ID desc --get the next one    
        
         set @RowNum = @RowNum - 1                              
         END ",sql,stored-procedures,sql-server-2000,,,,open,0,860,11,"help with 2 loops and an update in sql server 2000    
I am working on a stored procedure that will trigger once a week so i am not worried about speed as much as getting the thing to work.


what i am trying to do is loop through a table called households that stores information about the houses,

then using the houseid looping through a table called individuals 

which will return more then one person therefore leading me to loop through that result to gather inforamtion.

my main goal is to concatenate all the names of the people in the household, and their codes


 

    declare @RowNum int,
        @houseId nchar(10), 
        @hid nchar(25) 
        
        select @houseId=MAX(ID) FROM households     --start with the highest ID 
        Select @RowNum = Count(*) From households      --get total number of records
        WHILE @RowNum > 0                          --loop until no more records BEGIN       
         
        select @hid = id from households where ID = @houseid    --get other info from that row  
        
        DECLARE @RowCount INT
        
        SET @RowCount = (SELECT COUNT(ID) FROM (select id, firstname,lastname,party_code from indviduals where householdid = @houseid) as table1)  
        DECLARE @code1 VARCHAR(50), @names1 VARCHAR(500), @lastname1 VARCHAR(50) 
        -- Declare an iterator
        DECLARE @I INT
        -- Initialize the iterator
        SET @I = (select min(id) from indviduals where householdid = @houseid)
        
        -- Loop through the rows of a table @myTable
        WHILE (@I <= @RowCount)
        BEGIN
                -- Declare variables to hold the data which we get after looping each record 
                DECLARE @code VARCHAR(50), @names VARCHAR(500), @lastname VARCHAR(50)    
                
                -- Get the data from table and set to variables
                SELECT @code = party_code, @names = firstname, @lastname = lastname FROM (select id, firstname,lastname,party_code from indviduals where householdid = @houseid) as table1  WHERE ID = @I
                -- Display the looped data
         
        
         
        set @code1 = (@code + ',' + @code1)
        set @names1 = (@names + ',' + @names1)
        set @lastname1 = @lastname
                -- Increment the iterator
                SET @I = @I  + 1
        END
        
        update households    
        SET firstnames=@names1, lastname=@lastname1, party_codes=@code1,
        where id = @houseid  
        
        select top 1 @houseId=ID 
        from households
        where ID < @houseID 
        order by ID desc --get the next one    
        
         set @RowNum = @RowNum - 1                              
         END ",3
8463419,12/11/2011 10:58:16,1020476,10/30/2011 07:55:30,154,0,Add Description From Excel File to Columns description  in SQL,"I have a DB (in SQL Server 2008 SP3) include many tables and each tables have a lot of columns, in other hand I have an Excel file include description for any of my DB's columns, So I am interesting in add this description to description of columns in DB (of course not by hand and one by one), does any one have any idea about this? ",sql,sql-server,sql-server-2008,tsql,,,open,0,68,11,"Add Description From Excel File to Columns description  in SQL I have a DB (in SQL Server 2008 SP3) include many tables and each tables have a lot of columns, in other hand I have an Excel file include description for any of my DB's columns, So I am interesting in add this description to description of columns in DB (of course not by hand and one by one), does any one have any idea about this? ",4
3689035,09/10/2010 23:21:14,365470,06/13/2010 01:19:17,68,1,Oracle SQL Issue with Insert Statements,"So I am a beginner to this, and trying to follow my professors instructions on how to complete this.  They are as follows:

Consider the relational database described in Tables 1-3.  The underlined attribute(s) is the primary key for a table.  Use your Oracle account to create this database and to insert the tuples listed in each table.  Make sure you include the primary key and foreign key constraints.  Put check constraints on the following three attributes.  Rating (between 0 and 10), Lengith (greater than 0), ReleaseDate (after 1/1/1900). 

Table 1: Theatres
Name (Underlined as Primary), City, State, Zip, Phone

Table 2: Movies
Title (Primary), Rating, Length, ReleaseDate

Table 3: ShownAt
TheatreName, MovieTitle (BOTH listed as Primary)

Here is how I have them declared:

    CREATE TABLE Theatres (
    Name   varchar2(50) not null,
    City   varchar2(50) not null,
    State   varchar2(50) not null,
    Zip   number not null,
    Phone   varchar2(50) not null,
    CONSTRAINT name_pk PRIMARY KEY (Name)
    );
     
    create table Movies (
    Title   varchar2(100),
    Rating NUMBER CONSTRAINT Rating_CHK CHECK (Rating BETWEEN 0 AND 10),
    Length NUMBER CONSTRAINT Length_CHK CHECK (Length > 0),
    ReleaseDate date CONSTRAINT RDATE_CHK CHECK (ReleaseDate > to_date('1/January/1900', 'DD/MONTH/YYYY')),
    CONSTRAINT title_pk PRIMARY KEY (Title)
    );

    create table ShownAt (
    TheatreName varchar2(50),
    MovieTitle varchar2(100),
    CONSTRAINT moviet_fk FOREIGN KEY (MovieTitle) REFERENCES Movies(Title),
    CONSTRAINT shown_pk PRIMARY KEY (TheatreName, MovieTitle)
    );

This declares fine, and I get no errors.  Below are my inserts (I gave one example insert for each table):

    insert into theatres values ( 'Great Escape 14', 'Wilder', 'KY', '41076', '(859) 442-0000' );
    insert into movies values ( 'The Expendables', '7.6', '103', '13 August 2010' );
    insert into shownat values ( 'Great Escape 14', 'The Expendables' );

All inserts into theatres and movies go off without a hitch.  For ShownAt, I get A LOT OF ERRORS, most of which look something like this:
Error starting at line 37 in command:
insert into shownat values ( 'Showcase Cinema De Lux Florence', 'The Pianist' )
Error report:
SQL Error: ORA-02291: integrity constraint (LANGB1.MOVIET_FK) violated - parent key not found
02291. 00000 - ""integrity constraint (%s.%s) violated - parent key not found""
*Cause:    A foreign key value has no matching primary key value.
*Action:   Delete the foreign key or add a matching primary key.

Any insert into ShownAt where the title is just one word (say the movie Up) works just fine, but anything with more than one word (like The Expendables) won't execute, and give the above error.  ANY HELP would be much appreciated.  I can post any other details that you need.

",sql,oracle,query,,,,open,0,496,6,"Oracle SQL Issue with Insert Statements So I am a beginner to this, and trying to follow my professors instructions on how to complete this.  They are as follows:

Consider the relational database described in Tables 1-3.  The underlined attribute(s) is the primary key for a table.  Use your Oracle account to create this database and to insert the tuples listed in each table.  Make sure you include the primary key and foreign key constraints.  Put check constraints on the following three attributes.  Rating (between 0 and 10), Lengith (greater than 0), ReleaseDate (after 1/1/1900). 

Table 1: Theatres
Name (Underlined as Primary), City, State, Zip, Phone

Table 2: Movies
Title (Primary), Rating, Length, ReleaseDate

Table 3: ShownAt
TheatreName, MovieTitle (BOTH listed as Primary)

Here is how I have them declared:

    CREATE TABLE Theatres (
    Name   varchar2(50) not null,
    City   varchar2(50) not null,
    State   varchar2(50) not null,
    Zip   number not null,
    Phone   varchar2(50) not null,
    CONSTRAINT name_pk PRIMARY KEY (Name)
    );
     
    create table Movies (
    Title   varchar2(100),
    Rating NUMBER CONSTRAINT Rating_CHK CHECK (Rating BETWEEN 0 AND 10),
    Length NUMBER CONSTRAINT Length_CHK CHECK (Length > 0),
    ReleaseDate date CONSTRAINT RDATE_CHK CHECK (ReleaseDate > to_date('1/January/1900', 'DD/MONTH/YYYY')),
    CONSTRAINT title_pk PRIMARY KEY (Title)
    );

    create table ShownAt (
    TheatreName varchar2(50),
    MovieTitle varchar2(100),
    CONSTRAINT moviet_fk FOREIGN KEY (MovieTitle) REFERENCES Movies(Title),
    CONSTRAINT shown_pk PRIMARY KEY (TheatreName, MovieTitle)
    );

This declares fine, and I get no errors.  Below are my inserts (I gave one example insert for each table):

    insert into theatres values ( 'Great Escape 14', 'Wilder', 'KY', '41076', '(859) 442-0000' );
    insert into movies values ( 'The Expendables', '7.6', '103', '13 August 2010' );
    insert into shownat values ( 'Great Escape 14', 'The Expendables' );

All inserts into theatres and movies go off without a hitch.  For ShownAt, I get A LOT OF ERRORS, most of which look something like this:
Error starting at line 37 in command:
insert into shownat values ( 'Showcase Cinema De Lux Florence', 'The Pianist' )
Error report:
SQL Error: ORA-02291: integrity constraint (LANGB1.MOVIET_FK) violated - parent key not found
02291. 00000 - ""integrity constraint (%s.%s) violated - parent key not found""
*Cause:    A foreign key value has no matching primary key value.
*Action:   Delete the foreign key or add a matching primary key.

Any insert into ShownAt where the title is just one word (say the movie Up) works just fine, but anything with more than one word (like The Expendables) won't execute, and give the above error.  ANY HELP would be much appreciated.  I can post any other details that you need.

",3
1201541,07/29/2009 16:39:33,141498,07/20/2009 16:09:34,3,0,Converting MSSQL null date/time fields,"Whenever the value is null for this query

SELECT ISNULL(someDateTime,'')
FROM  someTable

the result is<br>

<u>someDateTime</u><br>
1900-01-01 00:00:00.000

I want it to be ""No"", so if I run this:
<br>

SELECT ISNULL(someDateTime,'No')
FROM  someTable<br>

then there's this error: Conversion failed when converting datetime from character string.

How to do it?  Thanks in advance!
",sql,,,,,,open,0,45,5,"Converting MSSQL null date/time fields Whenever the value is null for this query

SELECT ISNULL(someDateTime,'')
FROM  someTable

the result is<br>

<u>someDateTime</u><br>
1900-01-01 00:00:00.000

I want it to be ""No"", so if I run this:
<br>

SELECT ISNULL(someDateTime,'No')
FROM  someTable<br>

then there's this error: Conversion failed when converting datetime from character string.

How to do it?  Thanks in advance!
",1
11389193,07/09/2012 04:45:12,1508104,07/07/2012 01:40:57,1,0,how to insert this BLOB from vb 6 to sql 2008 view?,"This is my table view
    SELECT     dbo.Gen_photo.picture, dbo.sign.sign, dbo.thumb.thumb
     FROM         dbo.sign INNER JOIN
                      dbo.Gen_photo ON dbo.sign.link = dbo.Gen_photo.link INNER JOIN
                      dbo.thumb ON dbo.sign.link = dbo.thumb.link CROSS JOIN
                      [DPRM_DOMAIN\test.deseo].NUP_VIEW

problem is the i need a BLOB source for the images. which includes the tables Gen_Photo, thumb and sign



can anyone please point me to the right command line, thanks in advance ^_^",sql,blob,,,,07/10/2012 08:40:28,not a real question,1,141,12,"how to insert this BLOB from vb 6 to sql 2008 view? This is my table view
    SELECT     dbo.Gen_photo.picture, dbo.sign.sign, dbo.thumb.thumb
     FROM         dbo.sign INNER JOIN
                      dbo.Gen_photo ON dbo.sign.link = dbo.Gen_photo.link INNER JOIN
                      dbo.thumb ON dbo.sign.link = dbo.thumb.link CROSS JOIN
                      [DPRM_DOMAIN\test.deseo].NUP_VIEW

problem is the i need a BLOB source for the images. which includes the tables Gen_Photo, thumb and sign



can anyone please point me to the right command line, thanks in advance ^_^",2
5343571,03/17/2011 18:30:40,664912,03/17/2011 18:30:40,1,0,Excel Formula ==(J13*(12-1)+E13)/12 in SQL,"I Have a Excel sheet. which has A column to J total 10 coulmns.

And the below formula starts from rownumber 14th in J column and fills the sheet. How would i write this in the SQL?

    =(J13*(11)+E13)/12",sql,sql-server,tsql,,,03/17/2011 18:52:46,not a real question,1,40,5,"Excel Formula ==(J13*(12-1)+E13)/12 in SQL I Have a Excel sheet. which has A column to J total 10 coulmns.

And the below formula starts from rownumber 14th in J column and fills the sheet. How would i write this in the SQL?

    =(J13*(11)+E13)/12",3
157272,10/01/2008 12:03:12,5241,09/08/2008 16:53:54,54,7,SQL trigger for deleting old results,"We have a database that we are using to store test results for an embedded device.  There's a table with columns for different types of failures (details not relevant), along with a primary key 'keynum' and a 'NUM\_FAILURES' column that lists the number of failures.  We store passes and failures, so a pass has a '0' in 'NUM\_FAILURES'.

In order to keep the database from growing without bounds, we want to keep the last 1000 results, plus any of the last 50 failures that fall outside of the 1000.  So, worst case, the table could have 1050 entries in it.  I'm trying to find the most efficient SQL insert trigger to remove extra entries.  I'll give what I have so far as an answer, but I'm looking to see if anyone can come up with something better, since SQL isn't something I do very often.

We are using SQLITE3 on a non-Windows platform, if it's relevant.",sql,sqlite,sqlite3,,,,open,0,159,6,"SQL trigger for deleting old results We have a database that we are using to store test results for an embedded device.  There's a table with columns for different types of failures (details not relevant), along with a primary key 'keynum' and a 'NUM\_FAILURES' column that lists the number of failures.  We store passes and failures, so a pass has a '0' in 'NUM\_FAILURES'.

In order to keep the database from growing without bounds, we want to keep the last 1000 results, plus any of the last 50 failures that fall outside of the 1000.  So, worst case, the table could have 1050 entries in it.  I'm trying to find the most efficient SQL insert trigger to remove extra entries.  I'll give what I have so far as an answer, but I'm looking to see if anyone can come up with something better, since SQL isn't something I do very often.

We are using SQLITE3 on a non-Windows platform, if it's relevant.",3
7981666,11/02/2011 14:05:21,223863,12/03/2009 13:52:10,1921,38,Are there any free open source tools that let me do the following to a sql db?,"I want to be able to perform the following procedures on a sql installation...

<p>1) to be able to delete a db and close all connections and then restore it from a .bak file. </p>
<p>2) to be able to drop all the constraints in a db and then drop a table before re-creating it</p>
 3) to be able to drop a whole db and then re-create it</p>

I will write a script to do these tasks but was thinking there might be an open source solution out there..?",sql,sql-server,,,,11/14/2011 11:53:56,off topic,1,86,17,"Are there any free open source tools that let me do the following to a sql db? I want to be able to perform the following procedures on a sql installation...

<p>1) to be able to delete a db and close all connections and then restore it from a .bak file. </p>
<p>2) to be able to drop all the constraints in a db and then drop a table before re-creating it</p>
 3) to be able to drop a whole db and then re-create it</p>

I will write a script to do these tasks but was thinking there might be an open source solution out there..?",2
6737812,07/18/2011 18:50:44,823893,06/30/2011 21:45:26,1,0,"how to do a C# switch, change to lower case and update on the fly","How can I do the following C# in MS sql?  Also I need to be able to update vars, Total_before_ReCompute,
newTotal, WtdAvgTotal, MrkTotal .....

             #region determine if Dimension has length & width
            bool lengthWidthDimension = false;
            string[] xy = new string[1];
            Dimension = Dimension.ToUpper();
            if (Dimension.Contains('X'))
            {
                xy = Dimension.Split('X');
                lengthWidthDimension = true;
            }
            #endregion

            //            switch (dataGridView1.Rows[i].Cells[iUnit].Value.ToString().ToLower())
            #region totaling

            Cost = Convert.ToDecimal(dataGridView1.Rows[i].Cells[iCost_Prior_ReCompute].Value.ToString());

            switch (Unit.ToLower())
            {
               case ""each"":
                    {
                        #region each
                        try
                        {
                            Total_before_ReCompute = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", Count * Cost * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                        }
                        catch
                        {
                            Total_before_ReCompute = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", ""0"")));
                        }
                        break;
        
                                newTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iNewTotal].Value = String.Format(""{0:0.00}"", Count * newCost * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
        
                                if ((K == ""K"") || (D != """"))
                                    reCalculate_K_FACTORS(i);
        
                                WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                if (K == """" && D == """")
                                {
                                    WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                    MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                }
                                else
                                    if (C == """" && K == """")
                                    {
                                        WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                        MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                    }
                                    else
                                        if (K == ""K"")
                                        {
                                            WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                            MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                        }

        
        
        #endregion
                    }
                case ""foot"":
                    {
                        #region foot

                        try
                        {
                            Footage = 0;
                            if (!String.IsNullOrEmpty(dataGridView1.Rows[i].Cells[iFootage].Value.ToString()))
                                Footage = Convert.ToDecimal(dataGridView1.Rows[i].Cells[iFootage].Value.ToString());

                            //Footage = Math.Round(((Footage / orgCount) * Count), 2, System.MidpointRounding.AwayFromZero);
                            //dataGridView1.Rows[i].Cells[iFootage].Value = String.Format(""{0:0.00}"", Footage.ToString());

                            Total_before_ReCompute = Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", Footage * Cost * countNegitive).ToString());
                        }
                        catch
                        {
                            Total_before_ReCompute = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", ""0"")));
                        }
                        break;
                        #endregion
                    }
                case ""cft"":
                .
                .
                .
                case ""cwt"":
                case ""cwts"":
                .
                .
                .
                case ""sqft"":
                .
                .
                
I have started with the following, but not sure how to start:

Select 
   CASE --Unit
    when WtdAvgTotal = 0 then [Count] * newCost * countNegitive
    end WtdAvgTotal, C, D, K, [Count], newCost, countNegitive, Unit
FROM VF_CasINV_Cost
where (CalendarYear = 2010) AND (Item# = Item#) AND (ID = ID) and (Item# < 99999990) and
K = '' and D = '' and D <> 'D' 
",sql,ms,,,,07/18/2011 19:43:43,not a real question,1,2324,15,"how to do a C# switch, change to lower case and update on the fly How can I do the following C# in MS sql?  Also I need to be able to update vars, Total_before_ReCompute,
newTotal, WtdAvgTotal, MrkTotal .....

             #region determine if Dimension has length & width
            bool lengthWidthDimension = false;
            string[] xy = new string[1];
            Dimension = Dimension.ToUpper();
            if (Dimension.Contains('X'))
            {
                xy = Dimension.Split('X');
                lengthWidthDimension = true;
            }
            #endregion

            //            switch (dataGridView1.Rows[i].Cells[iUnit].Value.ToString().ToLower())
            #region totaling

            Cost = Convert.ToDecimal(dataGridView1.Rows[i].Cells[iCost_Prior_ReCompute].Value.ToString());

            switch (Unit.ToLower())
            {
               case ""each"":
                    {
                        #region each
                        try
                        {
                            Total_before_ReCompute = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", Count * Cost * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                        }
                        catch
                        {
                            Total_before_ReCompute = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", ""0"")));
                        }
                        break;
        
                                newTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iNewTotal].Value = String.Format(""{0:0.00}"", Count * newCost * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
        
                                if ((K == ""K"") || (D != """"))
                                    reCalculate_K_FACTORS(i);
        
                                WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                if (K == """" && D == """")
                                {
                                    WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                    MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                }
                                else
                                    if (C == """" && K == """")
                                    {
                                        WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                        MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                    }
                                    else
                                        if (K == ""K"")
                                        {
                                            WtdAvgTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iWtdAvgTotal].Value = String.Format(""{0:0.00}"", Count * Wgtd_Avg * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                            MrkTotal = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iMrkTotal].Value = String.Format(""{0:0.00}"", Count * Market * countNegitive).ToString()), 2, System.MidpointRounding.AwayFromZero);
                                        }

        
        
        #endregion
                    }
                case ""foot"":
                    {
                        #region foot

                        try
                        {
                            Footage = 0;
                            if (!String.IsNullOrEmpty(dataGridView1.Rows[i].Cells[iFootage].Value.ToString()))
                                Footage = Convert.ToDecimal(dataGridView1.Rows[i].Cells[iFootage].Value.ToString());

                            //Footage = Math.Round(((Footage / orgCount) * Count), 2, System.MidpointRounding.AwayFromZero);
                            //dataGridView1.Rows[i].Cells[iFootage].Value = String.Format(""{0:0.00}"", Footage.ToString());

                            Total_before_ReCompute = Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", Footage * Cost * countNegitive).ToString());
                        }
                        catch
                        {
                            Total_before_ReCompute = Math.Round(Convert.ToDecimal(dataGridView1.Rows[i].Cells[iTotal_before_ReCompute].Value = String.Format(""{0:0.00}"", ""0"")));
                        }
                        break;
                        #endregion
                    }
                case ""cft"":
                .
                .
                .
                case ""cwt"":
                case ""cwts"":
                .
                .
                .
                case ""sqft"":
                .
                .
                
I have started with the following, but not sure how to start:

Select 
   CASE --Unit
    when WtdAvgTotal = 0 then [Count] * newCost * countNegitive
    end WtdAvgTotal, C, D, K, [Count], newCost, countNegitive, Unit
FROM VF_CasINV_Cost
where (CalendarYear = 2010) AND (Item# = Item#) AND (ID = ID) and (Item# < 99999990) and
K = '' and D = '' and D <> 'D' 
",2
10724314,05/23/2012 16:41:27,1262693,03/11/2012 18:29:32,11,0,Creating and reading from a table in the same SQL script,"I am developing a SQL script in SQL Developer which will obfuscate personal data in a schema using Oracle SQL. The script looks into a table called ""OBFUS_TABLE"" which contains a list of which tables and columns need to be obfuscated and how. It then loops through the table, altering the data as it goes.

I have tested the actual loop and obfuscate process and it works fine, I have also successfully tested the beginning of the script up to just before the loop, which creates OBFUS_TABLE and inserts the values into it. The problem comes when it tries to do the two together, failing on a ""table or view does not exist"" error when it attempts to execute the loop. Snippet of code below:

        alter session set current_schema = SYSTEM;

        DECLARE
          t_count                   NUMBER;
          t_count2                  NUMBER;
          p_tname                   VARCHAR2(100);
          p_cname                   VARCHAR2(100);
          l_datatype                VARCHAR2(100);
        BEGIN
        
          SELECT COUNT(*) INTO t_count FROM all_tables  WHERE table_name = 'OBFUS_TABLE';
          SELECT COUNT(*) INTO t_count2 FROM all_tables  WHERE table_name = 'OBFUS_LOG';
        
          IF (t_count = 0)
            THEN
              EXECUTE immediate 'create table OBFUS_TABLE( TABLENAME VARCHAR2(200 BYTE), COLUMNNAME VARCHAR2(200 BYTE), DATA_TYPE VARCHAR2(20 BYTE), ACTIVE  VARCHAR(1 BYTE)  )';
          END IF;

          IF (t_count2 = 0)
            THEN
              EXECUTE immediate 'CREATE TABLE OBFUS_LOG (SRC_TABLENAME VARCHAR2(50 BYTE), SRC_TABLE_ROW_COUNT NUMBER, COPY_TABLENAME VARCHAR2(50 BYTE), COPY_TABLE_ROW_COUNT NUMBER, UPDATE_DATE TIMESTAMP(6) )';
          END IF;

        EXECUTE immediate 'INSERT INTO OBFUS_TABLE VALUES (''OB_MYTABLE1'',''SRNM'',''NAME'',''Y'')';
        COMMIT;


          FOR x IN (SELECT TABLENAME, COLUMNNAME, DATA_TYPE FROM OBFUS_TABLE WHERE ACTIVE='Y')
          LOOP
            p_tname    := upper(x.TABLENAME);  -- Table name
            p_cname    := upper(x.COLUMNNAME); -- Column name
            l_datatype := upper(x.DATA_TYPE);
            dbms_output.put_line('Started: '||TO_CHAR(sysdate,'YYYY/MM/DD HH24:MI:SS'));
          END LOOP;
  
        END;


NB: There are actually around 30 insert statements in exactly the same format as the one above. I removed them since they would pad out this post too much, but I have manually checked every insert statement and they're all correct.

I assume the problem is that SQL Developer does a ""sanity check"" on the code before running, and looks ahead to the loop and realises OBFUS_TABLE doesn't exist, but fails to understand that by the time that piece of code is executed, OBFUS_TABLE will definitely exist.

Is there a way to get around this? I thought maybe a GOTO statement might help but no luck. I would rather keep the solution as one single script rather than two seperate ones, but if the only way around this is to do so then I could do that I suppose. Any help would be much appreciated.",sql,oracle,,,,,open,0,770,11,"Creating and reading from a table in the same SQL script I am developing a SQL script in SQL Developer which will obfuscate personal data in a schema using Oracle SQL. The script looks into a table called ""OBFUS_TABLE"" which contains a list of which tables and columns need to be obfuscated and how. It then loops through the table, altering the data as it goes.

I have tested the actual loop and obfuscate process and it works fine, I have also successfully tested the beginning of the script up to just before the loop, which creates OBFUS_TABLE and inserts the values into it. The problem comes when it tries to do the two together, failing on a ""table or view does not exist"" error when it attempts to execute the loop. Snippet of code below:

        alter session set current_schema = SYSTEM;

        DECLARE
          t_count                   NUMBER;
          t_count2                  NUMBER;
          p_tname                   VARCHAR2(100);
          p_cname                   VARCHAR2(100);
          l_datatype                VARCHAR2(100);
        BEGIN
        
          SELECT COUNT(*) INTO t_count FROM all_tables  WHERE table_name = 'OBFUS_TABLE';
          SELECT COUNT(*) INTO t_count2 FROM all_tables  WHERE table_name = 'OBFUS_LOG';
        
          IF (t_count = 0)
            THEN
              EXECUTE immediate 'create table OBFUS_TABLE( TABLENAME VARCHAR2(200 BYTE), COLUMNNAME VARCHAR2(200 BYTE), DATA_TYPE VARCHAR2(20 BYTE), ACTIVE  VARCHAR(1 BYTE)  )';
          END IF;

          IF (t_count2 = 0)
            THEN
              EXECUTE immediate 'CREATE TABLE OBFUS_LOG (SRC_TABLENAME VARCHAR2(50 BYTE), SRC_TABLE_ROW_COUNT NUMBER, COPY_TABLENAME VARCHAR2(50 BYTE), COPY_TABLE_ROW_COUNT NUMBER, UPDATE_DATE TIMESTAMP(6) )';
          END IF;

        EXECUTE immediate 'INSERT INTO OBFUS_TABLE VALUES (''OB_MYTABLE1'',''SRNM'',''NAME'',''Y'')';
        COMMIT;


          FOR x IN (SELECT TABLENAME, COLUMNNAME, DATA_TYPE FROM OBFUS_TABLE WHERE ACTIVE='Y')
          LOOP
            p_tname    := upper(x.TABLENAME);  -- Table name
            p_cname    := upper(x.COLUMNNAME); -- Column name
            l_datatype := upper(x.DATA_TYPE);
            dbms_output.put_line('Started: '||TO_CHAR(sysdate,'YYYY/MM/DD HH24:MI:SS'));
          END LOOP;
  
        END;


NB: There are actually around 30 insert statements in exactly the same format as the one above. I removed them since they would pad out this post too much, but I have manually checked every insert statement and they're all correct.

I assume the problem is that SQL Developer does a ""sanity check"" on the code before running, and looks ahead to the loop and realises OBFUS_TABLE doesn't exist, but fails to understand that by the time that piece of code is executed, OBFUS_TABLE will definitely exist.

Is there a way to get around this? I thought maybe a GOTO statement might help but no luck. I would rather keep the solution as one single script rather than two seperate ones, but if the only way around this is to do so then I could do that I suppose. Any help would be much appreciated.",2
3152529,06/30/2010 19:07:17,40521,11/25/2008 05:29:48,1054,31,LINQ 2 SQL : Loading more than one result sets to a variable when executing a stored procedure from LIN2 SQL.,"In LINQ 2 SQL,I am executing a stored procedure like
   
      datacontext.StoredProcedureName(parameter1,paramter2)

My sotored procedure is returning 2 different resultsets.How can i catch it and parse over it to grab the values from it

VB.NET am working with",sql,linq-to-sql,stored-procedures,,,,open,0,43,21,"LINQ 2 SQL : Loading more than one result sets to a variable when executing a stored procedure from LIN2 SQL. In LINQ 2 SQL,I am executing a stored procedure like
   
      datacontext.StoredProcedureName(parameter1,paramter2)

My sotored procedure is returning 2 different resultsets.How can i catch it and parse over it to grab the values from it

VB.NET am working with",3
10264474,04/22/2012 01:23:57,1307149,04/02/2012 03:05:37,6,0,Select Statement Check,"I have 2 tables listed below.  I was just wondering if I had the select statement right for what I want to do.  I want to Update Revised_Country based on Our_Country.  I will be using a Cursor to loop through the 2 tables and then update.  Any help would be appreciated. Thanks again. 

I am doing this in PL/SQL

    ![Here are the sample tables ][1]

    Select Our_Country, Old_Country, Country
         From Reference_Table, New_Table
    Where Our_Country != Old_Country
         And Country = Old Country;

 


  [1]: http://i.stack.imgur.com/0gCF7.jpg",sql,oracle,select,plsql,plsqldeveloper,04/25/2012 11:28:00,not a real question,1,114,3,"Select Statement Check I have 2 tables listed below.  I was just wondering if I had the select statement right for what I want to do.  I want to Update Revised_Country based on Our_Country.  I will be using a Cursor to loop through the 2 tables and then update.  Any help would be appreciated. Thanks again. 

I am doing this in PL/SQL

    ![Here are the sample tables ][1]

    Select Our_Country, Old_Country, Country
         From Reference_Table, New_Table
    Where Our_Country != Old_Country
         And Country = Old Country;

 


  [1]: http://i.stack.imgur.com/0gCF7.jpg",5
8930149,01/19/2012 17:03:05,1158965,01/19/2012 16:32:25,1,0,Multiple Sql Queries Same Field,"I have a table (Inventory_Line) where LID is auto increment and IID is a single number referring to the inventory date, PID is a numeric part#.  We use this table for inventory. 

|LID|IID|NAME|PID|QTY|<br>
1,1,Part A,213,12<br>
2,1,Part B,200,15<br>
3,2,Part A,213,9<br>
4,2,Part B,200,7<br>

We also have a table Order_Line

|OLID|OID|NAME|PID|QTY|<br>
1,217,Part A,213,12<br>
2,217,Part B,200,15<br>
3,218,Part A,213,9<br>
4,218,Part B,200,7<br>

My goal is to show ((Previous Inventory Qty (Inventory_Line.IID=2)) AS PREV_INV + (ORDERED Qty (Order_Line.OID = 217 AND 218)) AS ORDERED - (Current Inventory Qty Inventory_Line.IID=3) AS CURRENT_INV) AS SOLD WHERE PID = X

|PID|NAME|PREV_INV|ORDERED|CURRENT_INV|SOLD|

We are using MS Access and I have some experience with Joins but I am kind of stuck on how to pull this off.  Any help would be appreciated.",sql,query,ms-access,,,,open,0,109,5,"Multiple Sql Queries Same Field I have a table (Inventory_Line) where LID is auto increment and IID is a single number referring to the inventory date, PID is a numeric part#.  We use this table for inventory. 

|LID|IID|NAME|PID|QTY|<br>
1,1,Part A,213,12<br>
2,1,Part B,200,15<br>
3,2,Part A,213,9<br>
4,2,Part B,200,7<br>

We also have a table Order_Line

|OLID|OID|NAME|PID|QTY|<br>
1,217,Part A,213,12<br>
2,217,Part B,200,15<br>
3,218,Part A,213,9<br>
4,218,Part B,200,7<br>

My goal is to show ((Previous Inventory Qty (Inventory_Line.IID=2)) AS PREV_INV + (ORDERED Qty (Order_Line.OID = 217 AND 218)) AS ORDERED - (Current Inventory Qty Inventory_Line.IID=3) AS CURRENT_INV) AS SOLD WHERE PID = X

|PID|NAME|PREV_INV|ORDERED|CURRENT_INV|SOLD|

We are using MS Access and I have some experience with Joins but I am kind of stuck on how to pull this off.  Any help would be appreciated.",3
8473763,12/12/2011 11:43:22,1093605,12/12/2011 11:32:43,1,0,what does getPropertyInfo method in java JDBC Driver Interface supposed to return?,"i don't understand what was written in the documentation here
<br>
http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/Driver.html#getPropertyInfo%28java.lang.String,%20java.util.Properties%29
<br>
i don't even know who may use this method .. ?",sql,database,jdbc,,,12/12/2011 18:39:33,not a real question,1,20,12,"what does getPropertyInfo method in java JDBC Driver Interface supposed to return? i don't understand what was written in the documentation here
<br>
http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/Driver.html#getPropertyInfo%28java.lang.String,%20java.util.Properties%29
<br>
i don't even know who may use this method .. ?",3
6798567,07/23/2011 06:01:52,184046,10/04/2009 20:35:01,5838,38,Is there a way to directly compres/zips the result from a SQL query?,"Off late I have been dumping relatively large tables using SSMS. The usual way is to set `Query->Results-To->File`, 'Execute`, choose a file and let the SQL query run. After it finishes, I usually zip the file and then transfer it to my local machine. This has obvious problems of the host machine running out of space during overnight SQL queries.

I was wondering if there is a way to compress the output from SSMS directly without having to wait until it dumps the results from the entire query. Any suggestions? The host machine is pretty restricted in what it allows me to run on it so a suggestion that requires minimal third-party software would be great.",sql,sql-server,database,sql-server-2008,ssms,,open,0,115,13,"Is there a way to directly compres/zips the result from a SQL query? Off late I have been dumping relatively large tables using SSMS. The usual way is to set `Query->Results-To->File`, 'Execute`, choose a file and let the SQL query run. After it finishes, I usually zip the file and then transfer it to my local machine. This has obvious problems of the host machine running out of space during overnight SQL queries.

I was wondering if there is a way to compress the output from SSMS directly without having to wait until it dumps the results from the entire query. Any suggestions? The host machine is pretty restricted in what it allows me to run on it so a suggestion that requires minimal third-party software would be great.",5
6540209,06/30/2011 19:41:22,661078,03/15/2011 17:22:23,164,2,SQL search through ALL fields,"I've got a database I'm searching through, and I want to be able to return all rows who have at least one field in them that matches the search criteria. Is there an easier way to do this than looping through all the columns? 
Something like
SELECT *
FROM table
WHERE [insert very simple code here]
LIKE fieldString

If not I can just loop, I was just wondering if there was a simple solution I was missing.",sql,search,fields,,,,open,0,72,5,"SQL search through ALL fields I've got a database I'm searching through, and I want to be able to return all rows who have at least one field in them that matches the search criteria. Is there an easier way to do this than looping through all the columns? 
Something like
SELECT *
FROM table
WHERE [insert very simple code here]
LIKE fieldString

If not I can just loop, I was just wondering if there was a simple solution I was missing.",3
10283464,04/23/2012 15:24:47,979331,10/04/2011 21:19:34,148,2,SQL query where clause,"I have this line in my sql query..

            WHERE client = $id
    		AND (isinvoiced = 0) OR (isinvoiced = 1 and isrecurring = 1)

and this gets more results than I am expecting, however and write it like this....

            WHERE client = $id
    		AND (isinvoiced = 0) OR (isinvoiced = 1 and isrecurring = 1 and client = $id)

This gets me the results I wanted, but this is the best way to write this? I just dont wanna run into any more issues with this code. 

Thanks,
J",sql,query,where-clause,,,07/24/2012 11:45:13,not a real question,1,114,4,"SQL query where clause I have this line in my sql query..

            WHERE client = $id
    		AND (isinvoiced = 0) OR (isinvoiced = 1 and isrecurring = 1)

and this gets more results than I am expecting, however and write it like this....

            WHERE client = $id
    		AND (isinvoiced = 0) OR (isinvoiced = 1 and isrecurring = 1 and client = $id)

This gets me the results I wanted, but this is the best way to write this? I just dont wanna run into any more issues with this code. 

Thanks,
J",3
4263027,11/24/2010 02:41:40,438678,09/03/2010 06:36:38,42,1,Returning Count and Resultset from a single stored procedure,"I'm fairly new to stored procedures for Oracle. I want to be able to return both the count of hotels as well as the hotel names in a single stored procedure. Problem is I don't know where to start.  Any help would be appreciated.



    SELECT COUNT(HNAME) FROM HOTELS; //returns 'There are 30 hotels' 
    SELECT HNAME FROM HOTELS; //returns a table of 30 hotel names",sql,oracle,stored-procedures,,,,open,0,72,9,"Returning Count and Resultset from a single stored procedure I'm fairly new to stored procedures for Oracle. I want to be able to return both the count of hotels as well as the hotel names in a single stored procedure. Problem is I don't know where to start.  Any help would be appreciated.



    SELECT COUNT(HNAME) FROM HOTELS; //returns 'There are 30 hotels' 
    SELECT HNAME FROM HOTELS; //returns a table of 30 hotel names",3
7935090,10/28/2011 21:26:33,967319,09/27/2011 14:49:32,21,6,SQL Uniqu Values,"I have this query that joins 3 table. It appears to be working but I am getting duplicates. How can i remove the duplicates?

    SELECT FIRST 100 e.email_id, e.location_id, e.email, l.location_type, p.salutation, p.fname, p.lname
    FROM email e, location l, person p
    WHERE e.location_id = l.location_id
    AND l.per_id = p.per_id",sql,join,informix,duplicate-data,,,open,0,61,3,"SQL Uniqu Values I have this query that joins 3 table. It appears to be working but I am getting duplicates. How can i remove the duplicates?

    SELECT FIRST 100 e.email_id, e.location_id, e.email, l.location_type, p.salutation, p.fname, p.lname
    FROM email e, location l, person p
    WHERE e.location_id = l.location_id
    AND l.per_id = p.per_id",4
4185944,11/15/2010 15:35:51,417266,08/11/2010 13:11:50,14,0,Creating a Mysql database,"I want to create a MySQL database which should contain all the users of my site, and also There should be an option of adding other users as friends. What should be the fields of database.",sql,mysql,database,,,11/15/2010 15:47:49,not a real question,1,36,4,"Creating a Mysql database I want to create a MySQL database which should contain all the users of my site, and also There should be an option of adding other users as friends. What should be the fields of database.",3
6068717,05/20/2011 07:22:14,137520,07/13/2009 15:44:44,120,2,order by word in SQL,"For E.g

        I have word ""John Roshan"" i want to arrange this order by first alphbet of  the each word that means the output of the above word should be ""Roshan John"".
  
        i want to do it with SQL

Please help me its urget.

Thanks in advance

 ",sql,sql-server,sql-server-2005,sql-server-2008,,05/20/2011 08:26:50,not a real question,1,63,5,"order by word in SQL For E.g

        I have word ""John Roshan"" i want to arrange this order by first alphbet of  the each word that means the output of the above word should be ""Roshan John"".
  
        i want to do it with SQL

Please help me its urget.

Thanks in advance

 ",4
5721922,04/19/2011 19:56:49,315427,04/13/2010 11:57:31,1075,29,Filter out string column,"Here is my query, to locate a single record in table:

    SELECT TOP 1 Tests.Release, Tests.Result FROM Tests WHERE 
      Tests.TestCaseID = 104209
        ORDER BY Tests.Release

`Tests.Release` is a column, containg alphanumeric values, which are not comparable using numerical comparision operators. I want to filter out records from my query, based on one known release string and whatever is sorted above that record. If that release were a string I would write `WHERE Tests.Release > 10`. But again, my release is complex string, which can be only sorted.",sql,ms-access,vba,,,,open,0,102,4,"Filter out string column Here is my query, to locate a single record in table:

    SELECT TOP 1 Tests.Release, Tests.Result FROM Tests WHERE 
      Tests.TestCaseID = 104209
        ORDER BY Tests.Release

`Tests.Release` is a column, containg alphanumeric values, which are not comparable using numerical comparision operators. I want to filter out records from my query, based on one known release string and whatever is sorted above that record. If that release were a string I would write `WHERE Tests.Release > 10`. But again, my release is complex string, which can be only sorted.",3
7884210,10/25/2011 02:56:43,988651,10/11/2011 01:17:48,24,0,Searching in ASP Classic," anyone please help me to do searching in ASP classic(inventory system)..i newbie in programming and students..below is the screen look like.

http://imageshack.us/photo/my-images/707/searchc.jpg/

explanation

1.User can input free text in free text field 

2.User can select either searching by assetNo/serialNo or select All.

3.User can select all field..

then data will display below with paging..user also can save in excel.

code.

    <%
    Dim adoCon         
    Dim rsGuestbook    
    Dim strSQL           
    Dim lngRecordNo    
               
    lngRecordNo = CLng(Request.QueryString(""ID""))
    Set rsGuestbook = Server.CreateObject(""ADODB.Recordset"")
    strSQL = ""SELECT * FROM tbl_Master WHERE ID="" & lngRecordNo
    rsGuestbook.Open strSQL, oConn
%>

Database SQL Server

table name (tbl_Master)..Attributes (AssetNo,Region,SerialNo,Manufacturer,dateCreate)

Thanks you so much ",sql,server,asp,,,10/25/2011 06:04:29,not a real question,1,163,4,"Searching in ASP Classic  anyone please help me to do searching in ASP classic(inventory system)..i newbie in programming and students..below is the screen look like.

http://imageshack.us/photo/my-images/707/searchc.jpg/

explanation

1.User can input free text in free text field 

2.User can select either searching by assetNo/serialNo or select All.

3.User can select all field..

then data will display below with paging..user also can save in excel.

code.

    <%
    Dim adoCon         
    Dim rsGuestbook    
    Dim strSQL           
    Dim lngRecordNo    
               
    lngRecordNo = CLng(Request.QueryString(""ID""))
    Set rsGuestbook = Server.CreateObject(""ADODB.Recordset"")
    strSQL = ""SELECT * FROM tbl_Master WHERE ID="" & lngRecordNo
    rsGuestbook.Open strSQL, oConn
%>

Database SQL Server

table name (tbl_Master)..Attributes (AssetNo,Region,SerialNo,Manufacturer,dateCreate)

Thanks you so much ",3
7294945,09/03/2011 18:14:42,926879,09/03/2011 18:14:42,1,0,Please solve following query related to SQL,"My table contains ID and ID1
ID  ID1
5   8
6   9
7   1
Now The result set should like This
ID  ID1
8   5
9   6
1   7",sql,,,,,09/04/2011 00:17:23,not a real question,1,34,7,"Please solve following query related to SQL My table contains ID and ID1
ID  ID1
5   8
6   9
7   1
Now The result set should like This
ID  ID1
8   5
9   6
1   7",1
3720851,09/15/2010 18:58:47,329811,04/30/2010 14:19:52,58,6,How to extract sybase (12.5) table ddl via sql.,"Good afternoon,  

I've scanned similar questions but they seem to be referring to other databases and/or external languages.  

I'm looking to programatically extract table DDL via sql, with a result that's ""good enough"" to re-import and reconstruct the table.

DBArtisan produces the exact result I'm looking for, but I have a dynamic list of a few dozen tables that I need to work with, and was hoping for a programatic solution.  

I figure DBArtisan has to be doing calling the api SOMEhow.  Are they just ripping against the systables or is there a system installed stored proc (similar to the one that yields stored proc text) that I'm missing?  

Thanks o/


",sql,perl,sybase,ddl,,,open,0,115,9,"How to extract sybase (12.5) table ddl via sql. Good afternoon,  

I've scanned similar questions but they seem to be referring to other databases and/or external languages.  

I'm looking to programatically extract table DDL via sql, with a result that's ""good enough"" to re-import and reconstruct the table.

DBArtisan produces the exact result I'm looking for, but I have a dynamic list of a few dozen tables that I need to work with, and was hoping for a programatic solution.  

I figure DBArtisan has to be doing calling the api SOMEhow.  Are they just ripping against the systables or is there a system installed stored proc (similar to the one that yields stored proc text) that I'm missing?  

Thanks o/


",4
4040661,10/28/2010 07:23:18,429349,08/24/2010 09:37:27,180,2,Is their any gui tool for mysql 5.0,"Is their any gui like interface for mysql like microsoft sql server 2005 server management studio provides,because basically i am operating mysql with command promt interface.",sql,mysql,sql-server-2005,ssms,,05/22/2012 10:10:00,not constructive,1,26,8,"Is their any gui tool for mysql 5.0 Is their any gui like interface for mysql like microsoft sql server 2005 server management studio provides,because basically i am operating mysql with command promt interface.",4
407320,01/02/2009 16:24:23,19307,09/19/2008 21:03:27,1520,115,"Strange SQL2005 problem.  ""SqlConnection does not support parallel transactions""","I have a problem that seems like its a result of a deadlock-situation. 
Whe are now searching for the root of the problem but meantime we wanted to restart the server and get the customer going.

And now everytime we start the program it just says ""SqlConnection does not support parallel transactions"". We have not changed anything in the program, its compiled and on the customers server, but after the ""possible deadlock""-situation it want go online again.

We have 7 clients (computers) running the program, each client is talking to a webservice on a local server, and the webservice is talking to the sql-server (same machine as webserver). 

We have restarted both the sql-server and the iis-server, but not rebooted the server because of other important services running on the server so its the last thing we do.
We can se no locks or anything in the management tab. 

So my question is, why does the ""SqlConnection does not support parallel transactions"" error comming from one time to another without changing anything in the program and it still lives between sql-restart.

It seems like it happens at the first db-request the program does when it start.

If you need more information just ask. Im puzzled...

",sql,transactions,,,,,open,0,200,10,"Strange SQL2005 problem.  ""SqlConnection does not support parallel transactions"" I have a problem that seems like its a result of a deadlock-situation. 
Whe are now searching for the root of the problem but meantime we wanted to restart the server and get the customer going.

And now everytime we start the program it just says ""SqlConnection does not support parallel transactions"". We have not changed anything in the program, its compiled and on the customers server, but after the ""possible deadlock""-situation it want go online again.

We have 7 clients (computers) running the program, each client is talking to a webservice on a local server, and the webservice is talking to the sql-server (same machine as webserver). 

We have restarted both the sql-server and the iis-server, but not rebooted the server because of other important services running on the server so its the last thing we do.
We can se no locks or anything in the management tab. 

So my question is, why does the ""SqlConnection does not support parallel transactions"" error comming from one time to another without changing anything in the program and it still lives between sql-restart.

It seems like it happens at the first db-request the program does when it start.

If you need more information just ask. Im puzzled...

",2
3779786,09/23/2010 15:11:57,422134,08/16/2010 20:19:21,68,12,"Update Table with a ""Select query"" with a where clause ","I want to Achieve the following: 

**Current State of table (my_table)**                                 

     id        totalX          totalY          totalZ               
     --------- --------------  --------------  --------------       
             9             34              334             0      
            10              6               56             0      
            11             21              251             0      
            12              3               93             0   


**Query result of (my_table2)**

    select id,count(*) as total FROM my_table2 WHERE column_2 = 1 GROUP BY id
         
     id        total               
     --------- --------------       
             9            500      
            10            600      
            11            700      
            12            800  


**Expected State of table (my_table)**

     id        totalX          totalY          totalZ               
     --------- --------------  --------------  --------------       
             9             34              334             500      
            10              6               56             600      
            11             21              251             700      
            12              3               93             800    


Can this be done in ONE update query ? I am looking for Sybase ASE 12.5 on a RHEL 5.0


",sql,select,update,join,sybase,,open,0,852,11,"Update Table with a ""Select query"" with a where clause  I want to Achieve the following: 

**Current State of table (my_table)**                                 

     id        totalX          totalY          totalZ               
     --------- --------------  --------------  --------------       
             9             34              334             0      
            10              6               56             0      
            11             21              251             0      
            12              3               93             0   


**Query result of (my_table2)**

    select id,count(*) as total FROM my_table2 WHERE column_2 = 1 GROUP BY id
         
     id        total               
     --------- --------------       
             9            500      
            10            600      
            11            700      
            12            800  


**Expected State of table (my_table)**

     id        totalX          totalY          totalZ               
     --------- --------------  --------------  --------------       
             9             34              334             500      
            10              6               56             600      
            11             21              251             700      
            12              3               93             800    


Can this be done in ONE update query ? I am looking for Sybase ASE 12.5 on a RHEL 5.0


",5
7585423,09/28/2011 15:13:13,858953,07/23/2011 04:13:02,4689,242,Filling Gaps in Ranking Function based on Predicate,"I couldn't think of a simple way to describe this problem for the title...

Consider the following example query (SQL Server 2005):

    select
    	s.COL1,
    	s.COL2, 
    	s.COL3,
    	s.COL4,
    	dense_rank() over (
    		partition by s.COL1, s.COL2, s.COL3
    		order by s.COL4
    	) as MyRanking
    from
    	SourceTable s
    where
    	s.MyCondition = True

Pretty standard ranking query. However, I'd like to ""fill in gaps"" in a set-based manner for those values where s.MyCondition = False

**Current Results**

    0000010	UGRD	DEMO1	1942	1
    0000010	UGRD	DEMO1	2016	2
    0000010	UGRD	DEMO1	2026	3
    0000010	UGRD	DEMO1	2040	NULL 
    0000010	UGRD	DEMO1	2042	NULL 
    0000010	UGRD    DEMO1   2044    4
    0000010	UGRD	DEMO1	2048	NULL 
    0000010	UGRD	DEMO1	2050    5 

The rows with a NULL ranking are due to s.MyCondition being False. I'd like to have those NULL values be the previous non-NULL value. 

**Desired Results**


    0000010	UGRD	DEMO1	1942	1
    0000010	UGRD	DEMO1	2016	2
    0000010	UGRD	DEMO1	2026	3
    0000010	UGRD	DEMO1	2040	3
    0000010	UGRD	DEMO1	2042	3
    0000010	UGRD    DEMO1   2044    4
    0000010	UGRD	DEMO1	2048	4
    0000010	UGRD	DEMO1	2050    5 

Is there a method that I'm not thinking of to easily do this, preferably in the initial select/ranking? I know I can do a non-set based or recursive cte, but I'm trying to avoid that if possible.

If there's a mechanism in 2008/2008R2 that makes this easier/possible, please post them as well. We'll be upgrading at some point in the very near future.",sql,sql-server,sql-server-2005,tsql,sql-server-2008,09/29/2011 04:48:25,too localized,1,294,8,"Filling Gaps in Ranking Function based on Predicate I couldn't think of a simple way to describe this problem for the title...

Consider the following example query (SQL Server 2005):

    select
    	s.COL1,
    	s.COL2, 
    	s.COL3,
    	s.COL4,
    	dense_rank() over (
    		partition by s.COL1, s.COL2, s.COL3
    		order by s.COL4
    	) as MyRanking
    from
    	SourceTable s
    where
    	s.MyCondition = True

Pretty standard ranking query. However, I'd like to ""fill in gaps"" in a set-based manner for those values where s.MyCondition = False

**Current Results**

    0000010	UGRD	DEMO1	1942	1
    0000010	UGRD	DEMO1	2016	2
    0000010	UGRD	DEMO1	2026	3
    0000010	UGRD	DEMO1	2040	NULL 
    0000010	UGRD	DEMO1	2042	NULL 
    0000010	UGRD    DEMO1   2044    4
    0000010	UGRD	DEMO1	2048	NULL 
    0000010	UGRD	DEMO1	2050    5 

The rows with a NULL ranking are due to s.MyCondition being False. I'd like to have those NULL values be the previous non-NULL value. 

**Desired Results**


    0000010	UGRD	DEMO1	1942	1
    0000010	UGRD	DEMO1	2016	2
    0000010	UGRD	DEMO1	2026	3
    0000010	UGRD	DEMO1	2040	3
    0000010	UGRD	DEMO1	2042	3
    0000010	UGRD    DEMO1   2044    4
    0000010	UGRD	DEMO1	2048	4
    0000010	UGRD	DEMO1	2050    5 

Is there a method that I'm not thinking of to easily do this, preferably in the initial select/ranking? I know I can do a non-set based or recursive cte, but I'm trying to avoid that if possible.

If there's a mechanism in 2008/2008R2 that makes this easier/possible, please post them as well. We'll be upgrading at some point in the very near future.",5
6652890,07/11/2011 15:52:01,715125,04/19/2011 11:48:36,6,0,get .BAT file or SQLCMD to prompt user for input,"I am attemting to run the following query

sqlcmd -STEMP7 -E -devolive_base -w256 -QEXIT(""DECLARE @r int EXEC @r = usp_AddToObservationtbl $,$,$ SELECT @r"")

I am attempting to get the BAT file to ask the user for 3 variables.... can anyone help me ?
",sql,sql-server-2008,batch-file,sqlcmd,,,open,0,41,10,"get .BAT file or SQLCMD to prompt user for input I am attemting to run the following query

sqlcmd -STEMP7 -E -devolive_base -w256 -QEXIT(""DECLARE @r int EXEC @r = usp_AddToObservationtbl $,$,$ SELECT @r"")

I am attempting to get the BAT file to ask the user for 3 variables.... can anyone help me ?
",4
9261661,02/13/2012 13:49:54,1022280,10/31/2011 15:55:35,36,2,which method is best for Bulk Insert?,"i have to insert more than 2 lakh record in sqlserver DB..

my concept is add the data into DATA TABLE then doing Bulk Insert, but my TL Said Insert the data into CSV file format and do the bulk insert.

Which type is best ? which is time consuming?

thanks in advance..",sql,vb.net,sql-server-2005,,,,open,0,50,7,"which method is best for Bulk Insert? i have to insert more than 2 lakh record in sqlserver DB..

my concept is add the data into DATA TABLE then doing Bulk Insert, but my TL Said Insert the data into CSV file format and do the bulk insert.

Which type is best ? which is time consuming?

thanks in advance..",3
6412306,06/20/2011 13:53:26,806735,05/10/2010 20:44:44,1,0,SQL Distinct and non-distinct column selection,"http://stackoverflow.com/questions/192924/sql-distinct-for-2-fields-in-a-database

The above link I believe is not too far from what I'm looking for. There was a post talking about what I believe I need. It says that I should have my fields that do NOT need to be distinct in an aggregate and then the ones I want distinct should be in a group by clause.

The following SQL which I did NOT write works for giving us back the data we want. I've added the line: group by pf.PatientID, pf.SubjectID

/****** Object:  UserDefinedFunction [dbo].[getResearchAssistantProgressReportByStudyAndLoation]    Script Date: 06/20/2011 06:24:39 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
ALTER FUNCTION [dbo].[getResearchAssistantProgressReportByStudyAndLoation]
(	
	@StudyId int,
	@LocationID int,
	@ResearchAssistantID int,
	@StartDate datetime,
	@EndDate datetime
)
RETURNS TABLE 
AS
RETURN 
(
		
Select 
	pf.PatientID, pf.SubjectID, pf.ResearchAssistantID,
	study.form, pf.dateAvailable, pf.DateComplete, 
	CAST((CASE WHEN pf.dateavailable + convert(int,study.daystoexpire,101) < GETDATE() and pf.dateComplete is null then 'True' else 'False' END) AS varchar(10)) as Expired
FROM 
	PatientForms pf
	INNER JOIN (SELECT * FROM getFormsINStudy(@StudyId)) as study
	on pf.formID = study.FormID
	INNER JOIN UserLocations ul on pf.patientid = ul.userid
WHERE 
	ul.LocationID = @LocationID
	and (ResearchAssistantID = @ResearchAssistantID or @ResearchAssistantID = -1)
	and (pf.DateAvailable + convert(int,study.daystoexpire,101)) > @StartDate
	and (pf.DateAvailable + convert(int,study.DAYSTOEXPIRE,101)) < @EndDate
group by pf.PatientID, pf.SubjectID
)

This gives me an error:
Msg 8120, Level 16, State 1, Procedure getResearchAssistantProgressReportByStudyAndLoation, Line 20
Column 'PatientForms.ResearchAssistantID' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.

I get why I have this error, it's not in an aggregate function. What I'm not sure of how to do is to get it IN an aggregate, that to my knowledge would change the results of my query.

Any help anybody can and is willing to offer is greatly appreciated!",sql,select,distinct,,,,open,0,266,6,"SQL Distinct and non-distinct column selection http://stackoverflow.com/questions/192924/sql-distinct-for-2-fields-in-a-database

The above link I believe is not too far from what I'm looking for. There was a post talking about what I believe I need. It says that I should have my fields that do NOT need to be distinct in an aggregate and then the ones I want distinct should be in a group by clause.

The following SQL which I did NOT write works for giving us back the data we want. I've added the line: group by pf.PatientID, pf.SubjectID

/****** Object:  UserDefinedFunction [dbo].[getResearchAssistantProgressReportByStudyAndLoation]    Script Date: 06/20/2011 06:24:39 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
ALTER FUNCTION [dbo].[getResearchAssistantProgressReportByStudyAndLoation]
(	
	@StudyId int,
	@LocationID int,
	@ResearchAssistantID int,
	@StartDate datetime,
	@EndDate datetime
)
RETURNS TABLE 
AS
RETURN 
(
		
Select 
	pf.PatientID, pf.SubjectID, pf.ResearchAssistantID,
	study.form, pf.dateAvailable, pf.DateComplete, 
	CAST((CASE WHEN pf.dateavailable + convert(int,study.daystoexpire,101) < GETDATE() and pf.dateComplete is null then 'True' else 'False' END) AS varchar(10)) as Expired
FROM 
	PatientForms pf
	INNER JOIN (SELECT * FROM getFormsINStudy(@StudyId)) as study
	on pf.formID = study.FormID
	INNER JOIN UserLocations ul on pf.patientid = ul.userid
WHERE 
	ul.LocationID = @LocationID
	and (ResearchAssistantID = @ResearchAssistantID or @ResearchAssistantID = -1)
	and (pf.DateAvailable + convert(int,study.daystoexpire,101)) > @StartDate
	and (pf.DateAvailable + convert(int,study.DAYSTOEXPIRE,101)) < @EndDate
group by pf.PatientID, pf.SubjectID
)

This gives me an error:
Msg 8120, Level 16, State 1, Procedure getResearchAssistantProgressReportByStudyAndLoation, Line 20
Column 'PatientForms.ResearchAssistantID' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.

I get why I have this error, it's not in an aggregate function. What I'm not sure of how to do is to get it IN an aggregate, that to my knowledge would change the results of my query.

Any help anybody can and is willing to offer is greatly appreciated!",3
10020751,04/04/2012 23:36:00,556665,12/29/2010 02:40:00,20,0,Return Merged Rows In Select with Un-Selected Values,"I have a table with the following format:

    DB_KEY     DB_VALUE
    ------     --------
    row1       value1
    row2;1     value2
    row2;2     value3
    row3       value4
    row4;1     value5
    row4;2     value6
    row4;3     value7

I want to return only the DB_VALUE column, and if the first part of the DB_KEY (before the semicolon) is the same on any rows then merge the rows together.  So the return for this example above would be:

    value1
    value2value3
    value4
    value5value6value7

I thought to do something with group by, but it seems like that can't be used if the column you are grouping on is not selected.  Ie:

    SELECT DB_VALUE FROM TABLE GROUP BY REXEP_SUBSTR(DB_KEY, ';', 1, 1)

Any suggestions would be greatly appreciated.
",sql,oracle,group-by,,,,open,0,193,8,"Return Merged Rows In Select with Un-Selected Values I have a table with the following format:

    DB_KEY     DB_VALUE
    ------     --------
    row1       value1
    row2;1     value2
    row2;2     value3
    row3       value4
    row4;1     value5
    row4;2     value6
    row4;3     value7

I want to return only the DB_VALUE column, and if the first part of the DB_KEY (before the semicolon) is the same on any rows then merge the rows together.  So the return for this example above would be:

    value1
    value2value3
    value4
    value5value6value7

I thought to do something with group by, but it seems like that can't be used if the column you are grouping on is not selected.  Ie:

    SELECT DB_VALUE FROM TABLE GROUP BY REXEP_SUBSTR(DB_KEY, ';', 1, 1)

Any suggestions would be greatly appreciated.
",3
10389203,04/30/2012 19:10:06,1289282,03/23/2012 22:39:14,98,0,sql / sqlplus - How to view schema,"I was just wondering - is there a command to view the schema for the database I have created?

- Using SqlPlus

Thanks.",sql,sqlplus,,,,05/01/2012 18:42:48,not a real question,1,21,8,"sql / sqlplus - How to view schema I was just wondering - is there a command to view the schema for the database I have created?

- Using SqlPlus

Thanks.",2
183742,10/08/2008 16:47:01,572,08/06/2008 20:56:54,5777,316,How do you deal with 1..n relationships in a relational database?,"Let's look at an example - books. A book can have 1..n authors. An author can have 1..m books. What is a good way to represent all of the authors of a book?

I came up with an idea to create a Books table and an Authors table. The Authors table has a primary AuthorID key the author's name. The Books table has a primary Book ID and metadata about the book (title, publication date, so on). However, there needs to be a way to link the books to authors and authors to books. And this is where the problem is.

Let's say we have three books by Bob. However, on one book, he wrote it as Bob, PhD. Another he wrote as Dr. Bob, and a third he wrote as Dr. Robert. I want to be able to identify the fact that these authors are, in reality, the same person but credited under different names. I also want to distinguish Bob from another Bob who wrote different books.

Now let's also add in another part to an application, a Person table that keeps track of interesting people. And let's say that Bob is an interesting person. I want to not only say that the author of all three books is Bob, but that this interesting Bob is the same Bob as the author Bob.

So what strategies exist for such potentially complicated mapping, while ensuring that the book authors are identified by the name on the cover?",sql,database-design,database,,,,open,0,244,11,"How do you deal with 1..n relationships in a relational database? Let's look at an example - books. A book can have 1..n authors. An author can have 1..m books. What is a good way to represent all of the authors of a book?

I came up with an idea to create a Books table and an Authors table. The Authors table has a primary AuthorID key the author's name. The Books table has a primary Book ID and metadata about the book (title, publication date, so on). However, there needs to be a way to link the books to authors and authors to books. And this is where the problem is.

Let's say we have three books by Bob. However, on one book, he wrote it as Bob, PhD. Another he wrote as Dr. Bob, and a third he wrote as Dr. Robert. I want to be able to identify the fact that these authors are, in reality, the same person but credited under different names. I also want to distinguish Bob from another Bob who wrote different books.

Now let's also add in another part to an application, a Person table that keeps track of interesting people. And let's say that Bob is an interesting person. I want to not only say that the author of all three books is Bob, but that this interesting Bob is the same Bob as the author Bob.

So what strategies exist for such potentially complicated mapping, while ensuring that the book authors are identified by the name on the cover?",3
8743639,01/05/2012 13:51:14,1132090,01/05/2012 12:08:42,1,0,Relationships between two entities,"I have a situation:

1. I have a user (creator) who creates events (Each event belongs to one user)
2. Each event can invite other users (participants) (Each user belongs to one event)

So basically, there are two entities (Users and Events), but relationships are not simple.
I mean, user who creates event may be not the same who attends it. A user may be just a participant, but not a creator.

The situation is similar to [this][1].

I realised that those relationships are not just many-to-many.

For instance, I may create two tables with two relationships (circular relationship).
To break this circle I need to allow to create a user (participant) without an event by temporarily assigning NULL to it or by creating one more column (Boolean) that indicates whether this user also a creator or not.

But I solved it by creating the third table:

[Diagram 1][2] // Sorry, I am a new user, I can't post images here.

The third table stores events and their participants.

I also found another way to solve this problem. It involves 4 tables:

1. User (User can be either a creator or a participant)

2. Creator (Creator is user who creates event)

3. Event (Each event belongs to one creator)

4. Participant (Participant is user who takes part in an event, one event has many participants)

These relationships would look like this:
[Diagram 2][3]

Which solution is better?

I liked the one with two tables, but I just needed to dig deeper and find the proper.


  [1]: http://stackoverflow.com/questions/8583194/multiple-relationships-between-two-entities-is-this-good-practice
  [2]: http://s1.ipicture.ru/uploads/20120105/Tn4b5738.png
  [3]: http://s1.ipicture.ru/uploads/20120105/5HNVz3cx.png",sql,table,entities,relationships,,,open,0,244,4,"Relationships between two entities I have a situation:

1. I have a user (creator) who creates events (Each event belongs to one user)
2. Each event can invite other users (participants) (Each user belongs to one event)

So basically, there are two entities (Users and Events), but relationships are not simple.
I mean, user who creates event may be not the same who attends it. A user may be just a participant, but not a creator.

The situation is similar to [this][1].

I realised that those relationships are not just many-to-many.

For instance, I may create two tables with two relationships (circular relationship).
To break this circle I need to allow to create a user (participant) without an event by temporarily assigning NULL to it or by creating one more column (Boolean) that indicates whether this user also a creator or not.

But I solved it by creating the third table:

[Diagram 1][2] // Sorry, I am a new user, I can't post images here.

The third table stores events and their participants.

I also found another way to solve this problem. It involves 4 tables:

1. User (User can be either a creator or a participant)

2. Creator (Creator is user who creates event)

3. Event (Each event belongs to one creator)

4. Participant (Participant is user who takes part in an event, one event has many participants)

These relationships would look like this:
[Diagram 2][3]

Which solution is better?

I liked the one with two tables, but I just needed to dig deeper and find the proper.


  [1]: http://stackoverflow.com/questions/8583194/multiple-relationships-between-two-entities-is-this-good-practice
  [2]: http://s1.ipicture.ru/uploads/20120105/Tn4b5738.png
  [3]: http://s1.ipicture.ru/uploads/20120105/5HNVz3cx.png",4
9857259,03/25/2012 01:42:44,1207331,02/13/2012 17:09:38,14,2,"SQL Error in query for ""undefined"" column (?)","    SELECT Output.name, Output.avgSalary FROM (SELECT Airplane.aid, Airplane.aname AS name, AVG (worker.salary) AS avgSalary FROM Aircraft Airplane , Certified IsCertified, Employees worker WHERE Airplane.aid = IsCertified.aid AND IsCertified.eid = worker.eid AND Airplane.crusingrange >  1000 GROUP BY Airplane.aid, Airplane.aname) AS Output

Oracle SQL says error at ""AS Output"" near the end, yet I cannot figure out what is wrong with it. :S

    
    ERROR at line 1:
    ORA-00933: SQL command not properly ended

",sql,oracle,,,,,open,0,84,8,"SQL Error in query for ""undefined"" column (?)     SELECT Output.name, Output.avgSalary FROM (SELECT Airplane.aid, Airplane.aname AS name, AVG (worker.salary) AS avgSalary FROM Aircraft Airplane , Certified IsCertified, Employees worker WHERE Airplane.aid = IsCertified.aid AND IsCertified.eid = worker.eid AND Airplane.crusingrange >  1000 GROUP BY Airplane.aid, Airplane.aname) AS Output

Oracle SQL says error at ""AS Output"" near the end, yet I cannot figure out what is wrong with it. :S

    
    ERROR at line 1:
    ORA-00933: SQL command not properly ended

",2
3975027,10/20/2010 05:34:02,150172,08/04/2009 07:45:18,686,23,Quick introduction on how to use oracle xml data type,"How do you work with the oracle XML data type?

_This question is intended to be asked and answered by me, just to share the information with others_",sql,xml,oracle,,,,open,0,27,10,"Quick introduction on how to use oracle xml data type How do you work with the oracle XML data type?

_This question is intended to be asked and answered by me, just to share the information with others_",3
4991417,02/14/2011 11:07:08,356502,06/02/2010 13:52:54,1,0,Join slows down sql,We have a discussion over SQL Server 2008 and join. One half says the more joins the slower you sql runs. The other half says ihat it does not matter because SQL server takes care of business so you wil not notice any performance loss. What is true?,sql,performance,server,join,,02/14/2011 12:51:29,not constructive,1,48,4,Join slows down sql We have a discussion over SQL Server 2008 and join. One half says the more joins the slower you sql runs. The other half says ihat it does not matter because SQL server takes care of business so you wil not notice any performance loss. What is true?,4
11186257,06/25/2012 09:02:13,1372442,05/03/2012 12:18:48,1,0,Invalid object name error after restoring the database,"I am using sql server 2005
I have restore the database into msdb which is under system database,it successfully restored with all database tables but still when i type the query "" select * from table name "" from restored database table it is giving error that invalid object name..
PLZ Help me out",sql,,,,,06/26/2012 11:49:23,not a real question,1,52,8,"Invalid object name error after restoring the database I am using sql server 2005
I have restore the database into msdb which is under system database,it successfully restored with all database tables but still when i type the query "" select * from table name "" from restored database table it is giving error that invalid object name..
PLZ Help me out",1
6816604,07/25/2011 13:05:37,848633,07/17/2011 12:13:23,6,0,Calling parameterized stored procedure in OpenQuery - SQl Server 2008,"I am calling a stored procedure in OpenQuery and passing parameters to the stored Procedure.

declare @Src nvarchar(max),@Tgt nvarchar(max)
declare @sql_str nvarchar (4000)
set @Src = '$\VMT\Versions\0900\AMS\'
set @Tgt = '$\VMT\Versions\0900\Base\'
set @sql_str = 'exec [Tfs_VMT Collection].dbo.MergeCandidate ''' + @Src+ ''' , ''' +@Tgt+''' ' 
set @sql_str = 'select * into #test from openquery(ODSSERVER,''' +Replace(@sql_str,'''', '''''') +''')'

print @sql_str

EXEC (@sql_str)

but this fails with following error
Msg 7357, Level 16, State 2, Line 1
Cannot process the object ""exec [Tfs_VMT Collection].dbo.MergeCandidate '$\VMT\Versions\0900\AMS\' , '$\VMT\Versions\0900\Base\' "". The OLE DB provider ""SQLNCLI10"" for linked server ""ODSSERVER"" indicates that either the object has no columns or the current user does not have permissions on that object.

I have checked this has nothing to do with permissions.
Can you please help?",sql,server,,,,,open,0,116,10,"Calling parameterized stored procedure in OpenQuery - SQl Server 2008 I am calling a stored procedure in OpenQuery and passing parameters to the stored Procedure.

declare @Src nvarchar(max),@Tgt nvarchar(max)
declare @sql_str nvarchar (4000)
set @Src = '$\VMT\Versions\0900\AMS\'
set @Tgt = '$\VMT\Versions\0900\Base\'
set @sql_str = 'exec [Tfs_VMT Collection].dbo.MergeCandidate ''' + @Src+ ''' , ''' +@Tgt+''' ' 
set @sql_str = 'select * into #test from openquery(ODSSERVER,''' +Replace(@sql_str,'''', '''''') +''')'

print @sql_str

EXEC (@sql_str)

but this fails with following error
Msg 7357, Level 16, State 2, Line 1
Cannot process the object ""exec [Tfs_VMT Collection].dbo.MergeCandidate '$\VMT\Versions\0900\AMS\' , '$\VMT\Versions\0900\Base\' "". The OLE DB provider ""SQLNCLI10"" for linked server ""ODSSERVER"" indicates that either the object has no columns or the current user does not have permissions on that object.

I have checked this has nothing to do with permissions.
Can you please help?",2
5608837,04/10/2011 00:13:30,700302,04/09/2011 20:30:00,13,0,Query Help With TSQL (Join Functions),"I have 2 queries I got from the help from this site and they are:

SELECT gr.g_name, (DATEDIFF(d, r.res_checkout_date, r.res_checkin_date) * pp.rate ) + ISNULL(i.inv_amount, 0)
FROM guest_reservation gr LEFT OUTER JOIN invoice i ON gr.confirm_no = i.confirm_no
JOIN reservation r ON gr.confirm_no = r.confirm_no
JOIN price_plan pp ON r.price_plan = pp.price_plan;

SELECT g.g_name, DATEDIFF(d, r.res_checkin_date, r.res_checkout_date)*p.rate+coalesce(i.inv_amount, 0) as Amount FROM reservation as r INNER JOIN priceplan as p ON r.price_plan = p.price_plan INNER JOIN guest_reservation as g ON r.confirm_no = g.confirm_no LEFT OUTER JOIN invoice as i ON r.confirm_no = i.confirm_no;

The above queries use the following tables:

The guest reservation table has the following columns with data:

(confirm_no, agent_id, g_name, g_phone)

The reservation table has the following columns with data:

(confirm_no, credit_card_no, res_checkin_date, res_checkout_date, 
 default_villa_type, price_plan)

Now I need to one or any of the queries above items that a guest has ordered from the dining_order table (where the r_confirm_no from the dining_order table equals the confirm_no from the reservation table), the items price must be taken from the dining_menu table (where dining_order.item equals dining_menu.item) and added into the above query.

The associated tables with the new information I need to add is:

The invoice table has the following columns with data:

(inv_no, inv_date, inv_amount, confirm_no).

The price plan table has the following columns with data:

(price_plan, rate, default_villa_type, bed_type)",sql,tsql,query,server,microsoft,,open,0,207,6,"Query Help With TSQL (Join Functions) I have 2 queries I got from the help from this site and they are:

SELECT gr.g_name, (DATEDIFF(d, r.res_checkout_date, r.res_checkin_date) * pp.rate ) + ISNULL(i.inv_amount, 0)
FROM guest_reservation gr LEFT OUTER JOIN invoice i ON gr.confirm_no = i.confirm_no
JOIN reservation r ON gr.confirm_no = r.confirm_no
JOIN price_plan pp ON r.price_plan = pp.price_plan;

SELECT g.g_name, DATEDIFF(d, r.res_checkin_date, r.res_checkout_date)*p.rate+coalesce(i.inv_amount, 0) as Amount FROM reservation as r INNER JOIN priceplan as p ON r.price_plan = p.price_plan INNER JOIN guest_reservation as g ON r.confirm_no = g.confirm_no LEFT OUTER JOIN invoice as i ON r.confirm_no = i.confirm_no;

The above queries use the following tables:

The guest reservation table has the following columns with data:

(confirm_no, agent_id, g_name, g_phone)

The reservation table has the following columns with data:

(confirm_no, credit_card_no, res_checkin_date, res_checkout_date, 
 default_villa_type, price_plan)

Now I need to one or any of the queries above items that a guest has ordered from the dining_order table (where the r_confirm_no from the dining_order table equals the confirm_no from the reservation table), the items price must be taken from the dining_menu table (where dining_order.item equals dining_menu.item) and added into the above query.

The associated tables with the new information I need to add is:

The invoice table has the following columns with data:

(inv_no, inv_date, inv_amount, confirm_no).

The price plan table has the following columns with data:

(price_plan, rate, default_villa_type, bed_type)",5
9670650,03/12/2012 16:11:03,1264329,03/12/2012 14:25:08,1,0,SQL: Find all previous records for a subset of IDs,"I'm new to SQL and I am having trouble even starting this query.  <br> 

If a student has a record in '2012', list that record and all of their previous records. <br>

A simplified data set: 

<pre>ASSIGNMENTS

STUDENT_ID    BOOK_TITLE   TERM
<HR>001           MOBY DICK    2009     
002           ULYSSES      2009
003           HAMLET       2009
004           1984         2009
005           HAMLET       2009
004           WAR & PEACE  2010
003           THE TRIAL    2010
004           MOBY DICK    2011
001           -NULL----    2012
004           -NULL----    2012
</pre>

Results should be the record of those registered in a given term followed by that student's previous records. The goal is for the user to look at currently registered students (NULL value in book title) and make sure they don't assign a book the student has already read.
<pre>
STUDENT_ID   BOOK_TITLE   TERM
001          -NULL----    2012
001          MOBY DICK    2009
004          -NULL----    2012
004          MOBY DICK    2011
004          WAR & PEACE  2010
004          1984         2009
</PRE>

Any pointers/starting directions would be greatly appreciated! I have tried messing around with 'with', multiple inner joins, but I am not getting anywhere. I keep thinking about if..then syntax that doesn't really work in SQL?",sql,,,,,,open,0,393,10,"SQL: Find all previous records for a subset of IDs I'm new to SQL and I am having trouble even starting this query.  <br> 

If a student has a record in '2012', list that record and all of their previous records. <br>

A simplified data set: 

<pre>ASSIGNMENTS

STUDENT_ID    BOOK_TITLE   TERM
<HR>001           MOBY DICK    2009     
002           ULYSSES      2009
003           HAMLET       2009
004           1984         2009
005           HAMLET       2009
004           WAR & PEACE  2010
003           THE TRIAL    2010
004           MOBY DICK    2011
001           -NULL----    2012
004           -NULL----    2012
</pre>

Results should be the record of those registered in a given term followed by that student's previous records. The goal is for the user to look at currently registered students (NULL value in book title) and make sure they don't assign a book the student has already read.
<pre>
STUDENT_ID   BOOK_TITLE   TERM
001          -NULL----    2012
001          MOBY DICK    2009
004          -NULL----    2012
004          MOBY DICK    2011
004          WAR & PEACE  2010
004          1984         2009
</PRE>

Any pointers/starting directions would be greatly appreciated! I have tried messing around with 'with', multiple inner joins, but I am not getting anywhere. I keep thinking about if..then syntax that doesn't really work in SQL?",1
9451499,02/26/2012 08:01:05,974330,10/01/2011 09:33:26,68,2,Count statement with Joint and where clause,"![enter image description here][1]


  [1]: http://i.stack.imgur.com/1aVhu.jpg

The top two are individual results..
the third on is the statement in which i am trying to join another table in it.My problem is i am not able to set the conditions in the sql statement.
In the last join statement i got two columns with Route Id and the sum with Flab=1  but am not able to set the condition in which the flag =0 ..please help 
I need T2 as the last column.  ",sql,join,count,,,,open,0,83,7,"Count statement with Joint and where clause ![enter image description here][1]


  [1]: http://i.stack.imgur.com/1aVhu.jpg

The top two are individual results..
the third on is the statement in which i am trying to join another table in it.My problem is i am not able to set the conditions in the sql statement.
In the last join statement i got two columns with Route Id and the sum with Flab=1  but am not able to set the condition in which the flag =0 ..please help 
I need T2 as the last column.  ",3
10682730,05/21/2012 09:33:09,1247237,03/03/2012 19:11:41,64,1,How to define what SQL is,"Is it safe to say that SQL is somewhat a standard that other languages implement or use part of? Much in the same way POSIX is a standard for unix systems? Or is SQL a language itself, that other languages inherit most of its syntax from? I'm just looking for a definition of the daily use of the word SQL.",sql,,,,,05/21/2012 09:44:07,not a real question,1,60,6,"How to define what SQL is Is it safe to say that SQL is somewhat a standard that other languages implement or use part of? Much in the same way POSIX is a standard for unix systems? Or is SQL a language itself, that other languages inherit most of its syntax from? I'm just looking for a definition of the daily use of the word SQL.",1
1982893,12/30/2009 22:34:10,125512,06/19/2009 02:37:29,146,5,best practices- analysis server ans sql browser,"I read somewhere:

> Analysis services should run under
> network account 

> Ensure SQL
> Browser uses a domain account


Why is that?",sql,sql-server,,,,,open,0,20,7,"best practices- analysis server ans sql browser I read somewhere:

> Analysis services should run under
> network account 

> Ensure SQL
> Browser uses a domain account


Why is that?",2
7828767,10/19/2011 22:02:23,931423,09/06/2011 19:26:41,29,0,"Seeking compilers, any idea?","This semester, I'm learning database using the isql*plus (oracle10g), but that needs to install a server on the pc first so it will function well. That really lags my pc, and I just need to write simple code snippets, and view the output.

And I've been starving to find a C programming language compiler (World Widely Known), with the suitable OpenGL dll libraries.

I've searched the internet for the isql*plus, found something called (altova database), but needs money.

Searched again for a C compiler, but found an old compiler (that's fine by me!) and found the dll libraries for the openGL, but don't know how to bind the library with that lousy compiler program I'm using; maybe a C compiler suitable for game programming is the best.

",sql,c,compiler,oracle10g,,10/20/2011 22:18:40,not a real question,1,124,4,"Seeking compilers, any idea? This semester, I'm learning database using the isql*plus (oracle10g), but that needs to install a server on the pc first so it will function well. That really lags my pc, and I just need to write simple code snippets, and view the output.

And I've been starving to find a C programming language compiler (World Widely Known), with the suitable OpenGL dll libraries.

I've searched the internet for the isql*plus, found something called (altova database), but needs money.

Searched again for a C compiler, but found an old compiler (that's fine by me!) and found the dll libraries for the openGL, but don't know how to bind the library with that lousy compiler program I'm using; maybe a C compiler suitable for game programming is the best.

",4
11696995,07/27/2012 23:48:41,110795,05/21/2009 22:49:20,510,4,SQL: retrieve records between dates in all databases,"I would like to select all the records in a table between two dates. I have a query like:

<code>SELECT * FROM &lt;table&gt; WHERE (thedate BETWEEN DATE('2012-04-01') AND DATE('2012-06-30'))</code>

This is fine for HSQL, Oracle, PostgreSQL, but it doesn't work in SQL Server due to the lack of the Date function. Is there a way to get this to work generally for all databases (including SQL Server) or do I need to use an ORM like Hibernate (I know I should, but I'm specifically asking if this can be done in SQL)?",sql,sql-server,datetime,,,,open,0,90,8,"SQL: retrieve records between dates in all databases I would like to select all the records in a table between two dates. I have a query like:

<code>SELECT * FROM &lt;table&gt; WHERE (thedate BETWEEN DATE('2012-04-01') AND DATE('2012-06-30'))</code>

This is fine for HSQL, Oracle, PostgreSQL, but it doesn't work in SQL Server due to the lack of the Date function. Is there a way to get this to work generally for all databases (including SQL Server) or do I need to use an ORM like Hibernate (I know I should, but I'm specifically asking if this can be done in SQL)?",3
2959702,06/02/2010 16:39:12,256895,01/22/2010 16:33:39,663,51,How to get count of another table in a left join,"I have multiple tables

post
    id  Name
    1   post-name1
    2   post-name2

user
    id  username
    1   user1
    2   user2

post_user
    post_id   user_id
    1         1
    2         1

post_comments
    post_id   comment_id
    1         1
    1         2
    1         3

I am using a query like this: 

    SELECT post.id, post.title, user.id AS uid, username
    FROM `post`
    LEFT JOIN post_user ON post.id = post_user.post_id
    LEFT JOIN user ON user.id = post_user.user_id
    ORDER BY post_date DESC

It works as intended. However I would like the get the number of comments for each post too. So how can i modify the this query so I can get the count of comments.

Any ideas?",sql,database,mysql,,,,open,0,206,11,"How to get count of another table in a left join I have multiple tables

post
    id  Name
    1   post-name1
    2   post-name2

user
    id  username
    1   user1
    2   user2

post_user
    post_id   user_id
    1         1
    2         1

post_comments
    post_id   comment_id
    1         1
    1         2
    1         3

I am using a query like this: 

    SELECT post.id, post.title, user.id AS uid, username
    FROM `post`
    LEFT JOIN post_user ON post.id = post_user.post_id
    LEFT JOIN user ON user.id = post_user.user_id
    ORDER BY post_date DESC

It works as intended. However I would like the get the number of comments for each post too. So how can i modify the this query so I can get the count of comments.

Any ideas?",3
8226847,11/22/2011 12:30:28,1059073,11/22/2011 04:22:58,28,0,How to Prepare an SQL Qeries using Exel Workbook data?,"Can any answer how to prepare an SQL Query from exel sheet

Example

A1 : PNAME	INSTITUTE	COURSE 	COURSE FEE
A2 : ANAND	SABHARI	        PGDCA	4500
A3 : ALTAF	COIT	        DCA	7200

I need Quries like...

INSERT INTO STUDIES VALUES('ANAND','SABHARI','PGDCA',4500)

INSERT INTO STUDIES VALUES('ALTAF','COIT','DCA',7200)

INSERT INTO STUDIES VALUES('JULIANA','BDPS','MCA',22000)

",sql,,,,,11/23/2011 16:39:00,not a real question,1,48,10,"How to Prepare an SQL Qeries using Exel Workbook data? Can any answer how to prepare an SQL Query from exel sheet

Example

A1 : PNAME	INSTITUTE	COURSE 	COURSE FEE
A2 : ANAND	SABHARI	        PGDCA	4500
A3 : ALTAF	COIT	        DCA	7200

I need Quries like...

INSERT INTO STUDIES VALUES('ANAND','SABHARI','PGDCA',4500)

INSERT INTO STUDIES VALUES('ALTAF','COIT','DCA',7200)

INSERT INTO STUDIES VALUES('JULIANA','BDPS','MCA',22000)

",1
5141940,02/28/2011 12:25:47,479886,10/18/2010 23:13:29,352,3,"Hi, there is a free software that gives you Entity-Relation Diagram from a .SQL file???","i have a .sql file representing my phpmyadmin database.... i want to see the entity relation diagram of it

exists a easy and free software that shows it from a sql file?

thanks",sql,,,,,11/17/2011 15:55:21,off topic,1,31,15,"Hi, there is a free software that gives you Entity-Relation Diagram from a .SQL file??? i have a .sql file representing my phpmyadmin database.... i want to see the entity relation diagram of it

exists a easy and free software that shows it from a sql file?

thanks",1
6917319,08/02/2011 19:15:14,769742,05/25/2011 14:20:46,1,0,Selecting top3 from a table,"How to select top3 values from a table.
Please let me know the query for selecting top 3 values of the table.
Thank you.",sql,,,,,08/02/2011 19:46:15,not a real question,1,22,5,"Selecting top3 from a table How to select top3 values from a table.
Please let me know the query for selecting top 3 values of the table.
Thank you.",1
101635,09/19/2008 12:59:11,15329,09/17/2008 08:21:53,400,43,Could you recommend good books on Sybase ASE 15?,"We need to get some good books on Sybase ASE 15 for our developers. The people in the team  have previous experience with different SQL flavors (MS SQL, MySQL, Informix and Oracle) but no one worked with Sybase before. Therefore I am looking for two kinds of books:

1. Book for developers on how to use Sybase for queries,sprocs, views etc. Has to be a book for professionals and not something like 'learn SQL in 21 day'
1. Book for the DB administrator on how to maintain the database. This could be on any level and a dummy guide would not go wrong :)

Thank you",sql,books,sybase,,,09/30/2011 00:51:01,not constructive,1,104,9,"Could you recommend good books on Sybase ASE 15? We need to get some good books on Sybase ASE 15 for our developers. The people in the team  have previous experience with different SQL flavors (MS SQL, MySQL, Informix and Oracle) but no one worked with Sybase before. Therefore I am looking for two kinds of books:

1. Book for developers on how to use Sybase for queries,sprocs, views etc. Has to be a book for professionals and not something like 'learn SQL in 21 day'
1. Book for the DB administrator on how to maintain the database. This could be on any level and a dummy guide would not go wrong :)

Thank you",3
10650823,05/18/2012 10:20:42,961236,10/13/2010 10:09:59,1,0,Search in horizontal partiton table,"We have a view whcih is horizontal partition on check constartint as starttime.

This view is combination of 15 tables based on date
Indexes are on date and starttime. 

View is from tables like scheduletest20120517, scheduletest21020518 etc for 15 days

While i am searching using varchar date like '2012-05-17' it is searching only one table 

but while i am giving like getutc() it is searching on all tables.

Please give the suggestion.",sql,,,,,05/18/2012 16:52:42,not a real question,1,68,5,"Search in horizontal partiton table We have a view whcih is horizontal partition on check constartint as starttime.

This view is combination of 15 tables based on date
Indexes are on date and starttime. 

View is from tables like scheduletest20120517, scheduletest21020518 etc for 15 days

While i am searching using varchar date like '2012-05-17' it is searching only one table 

but while i am giving like getutc() it is searching on all tables.

Please give the suggestion.",1
10673010,05/20/2012 11:28:57,1406159,05/20/2012 11:14:36,1,0,3 SQL queries to database,"I have a test where I am to write 3 questions to my database. They are the following:

     1. What film director have directed the movies with a specific character (can choose any from my database)
    
     2. What production company have hired the same actor the most times
    
     3. What lead-actor are in movies that's on the top list

 http://imageshack.us/f/213/erdiagram.jpg/ Here is my ER-diagram, although the names are mostly in Swedish. 

    Skadespelare = Actor
    roll = role
    roll_i_Film = role_in_movie
    Film = movie
    produktionsbolag = production company
    land = country
    regissor = director
    språk = language
    topp_land = top list

I hope this is enough information for you to be able to help me out!",sql,query,,,,05/20/2012 15:50:16,too localized,1,162,5,"3 SQL queries to database I have a test where I am to write 3 questions to my database. They are the following:

     1. What film director have directed the movies with a specific character (can choose any from my database)
    
     2. What production company have hired the same actor the most times
    
     3. What lead-actor are in movies that's on the top list

 http://imageshack.us/f/213/erdiagram.jpg/ Here is my ER-diagram, although the names are mostly in Swedish. 

    Skadespelare = Actor
    roll = role
    roll_i_Film = role_in_movie
    Film = movie
    produktionsbolag = production company
    land = country
    regissor = director
    språk = language
    topp_land = top list

I hope this is enough information for you to be able to help me out!",2
5992092,05/13/2011 12:51:02,752393,05/13/2011 12:51:02,1,0,Bash Script - If statement within quoted command,"Within a bash script I am running a sql query via 'psql -c <select command here>'. Based off of the arguements given to the bash script, the where claus of the select command will be different. So basically I need to know if its possible to do something like this:

psql -c ""select statement here until we get to the where clause at which point we break out of statement and do""
if (arg1 was given)
    concatenate ""where arg1"" to the end of the above select statement
if (arg2 was given)
    concatenate ""where arg2"" to the end of the above select statement


and so on for as many arguments. I know I could do this much easier in a sql function if I just passed the arguments but that really isnt an option. Thanks!",sql,linux,bash,select,,,open,0,136,8,"Bash Script - If statement within quoted command Within a bash script I am running a sql query via 'psql -c <select command here>'. Based off of the arguements given to the bash script, the where claus of the select command will be different. So basically I need to know if its possible to do something like this:

psql -c ""select statement here until we get to the where clause at which point we break out of statement and do""
if (arg1 was given)
    concatenate ""where arg1"" to the end of the above select statement
if (arg2 was given)
    concatenate ""where arg2"" to the end of the above select statement


and so on for as many arguments. I know I could do this much easier in a sql function if I just passed the arguments but that really isnt an option. Thanks!",4
4046422,10/28/2010 19:18:08,107166,05/14/2009 15:39:11,513,42,Get data across the same table,"I have table sort of like

    Name      |DateOfEvent|EventType
    Smith     |10/1/2005  |New
    Thomas    |1/1/2002   |Updated
    Johnson   |6/1/2002   |New
    Smith     |7/1/2008   |Updated
    Smith     |7/1/2000   |New

I want to return rows where the event is say New and the date is before a row with the same name but the EventType is Updated with a later date.

My thought is to iterate over the table with each row with the name but that seems really inefficient. Is there a better way to do this?",sql,select,,,,,open,0,128,6,"Get data across the same table I have table sort of like

    Name      |DateOfEvent|EventType
    Smith     |10/1/2005  |New
    Thomas    |1/1/2002   |Updated
    Johnson   |6/1/2002   |New
    Smith     |7/1/2008   |Updated
    Smith     |7/1/2000   |New

I want to return rows where the event is say New and the date is before a row with the same name but the EventType is Updated with a later date.

My thought is to iterate over the table with each row with the name but that seems really inefficient. Is there a better way to do this?",2
6786539,07/22/2011 06:45:18,855281,07/21/2011 06:02:55,6,0,how can select last 7 max salaries from fallowing table?,"NAME                        AGE     DEPTNO     SALARY
-------------------- ---------- ---------- ----------
shasank                      25         11       2025
raju                         27         12       2027
bali                         31         10       2031
rambo                        32         11       2121
chir                         34         10       2123
son                          33         12       2131
don                          33         11       2132
ram                          28         13       2141
nag                          35         10       2213
dimpu                        33         12       2314",sql,,,,,07/22/2011 13:06:02,not a real question,1,447,10,"how can select last 7 max salaries from fallowing table? NAME                        AGE     DEPTNO     SALARY
-------------------- ---------- ---------- ----------
shasank                      25         11       2025
raju                         27         12       2027
bali                         31         10       2031
rambo                        32         11       2121
chir                         34         10       2123
son                          33         12       2131
don                          33         11       2132
ram                          28         13       2141
nag                          35         10       2213
dimpu                        33         12       2314",1
10578081,05/14/2012 05:56:43,882978,08/07/2011 17:26:07,67,0,query cache or not to cache,"I have just started looking into query cache and enabled it for a my local apache server to see how it works and run commands on the sql command line. However, the next step would be to apply this to my website hosted online, how do i go about accessing information that would help me find out if my cache is working properly?

Am a little concerned about the cache, is it possible to do more harm than good with it?

My database will hold a max of 400 results in the primary table, with 7 other tables.
The primary table in use has approx 14 pieces of data to return.

AM trying to find out whether i should enable query cache to speed up queries, am not sure how i can monitor them, but from online reading about higher performance query cache reappears.
Thanks",sql,query,caching,server,,05/20/2012 01:07:47,not constructive,1,140,6,"query cache or not to cache I have just started looking into query cache and enabled it for a my local apache server to see how it works and run commands on the sql command line. However, the next step would be to apply this to my website hosted online, how do i go about accessing information that would help me find out if my cache is working properly?

Am a little concerned about the cache, is it possible to do more harm than good with it?

My database will hold a max of 400 results in the primary table, with 7 other tables.
The primary table in use has approx 14 pieces of data to return.

AM trying to find out whether i should enable query cache to speed up queries, am not sure how i can monitor them, but from online reading about higher performance query cache reappears.
Thanks",4
5658878,04/14/2011 05:17:07,670867,03/22/2011 08:58:31,6,0,update a sql using subquery and aggregate function,"Below is the sql where i am getting the error retuns more than 1 value

update Tab2 
set monthly_calls  = (select a.month from (select accountid,max(annual_calls)/12 as month from cpo group by accountid) a inner join tab2 on tab2.accountid = a.accountid)

 FYI... my select query  which is left of  = is working fine ",sql,sql-server-2005,,,,,open,0,55,8,"update a sql using subquery and aggregate function Below is the sql where i am getting the error retuns more than 1 value

update Tab2 
set monthly_calls  = (select a.month from (select accountid,max(annual_calls)/12 as month from cpo group by accountid) a inner join tab2 on tab2.accountid = a.accountid)

 FYI... my select query  which is left of  = is working fine ",2
11536989,07/18/2012 08:14:44,1469330,06/20/2012 13:01:35,11,0,retrieving multiple records from grandchild table,"the following sql query is not working.






select UserName from [User] where UserID Like (select UserID from UserRoles where RoleID =(select RoleID from Roles where RoleName='Manager'))





here we are working with 3 tables User, UserRoles, Roles.
It shows the error as follows





Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.
",sql,sql-server-2008,,,,,open,0,68,6,"retrieving multiple records from grandchild table the following sql query is not working.






select UserName from [User] where UserID Like (select UserID from UserRoles where RoleID =(select RoleID from Roles where RoleName='Manager'))





here we are working with 3 tables User, UserRoles, Roles.
It shows the error as follows





Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.
",2
11243402,06/28/2012 11:13:33,1228988,02/23/2012 17:29:03,1,0,"Error de conversion date sur pc client est ça marche normale sur mon pc   - sql server  , vb.net","Bonjour ,

mon client reçois l'erreur de conversion de string a une date , tant que dans mon pc tous marche bien !!!!!

 String not recognized as valide date

es qu'il manque un composant dans son pc ou quoi .

cette application est développé par vb.net et sql server",sql,date,,,,06/28/2012 13:43:00,not a real question,1,46,22,"Error de conversion date sur pc client est ça marche normale sur mon pc   - sql server  , vb.net Bonjour ,

mon client reçois l'erreur de conversion de string a une date , tant que dans mon pc tous marche bien !!!!!

 String not recognized as valide date

es qu'il manque un composant dans son pc ou quoi .

cette application est développé par vb.net et sql server",2
7008208,08/10/2011 08:57:56,428073,08/23/2010 05:58:43,135,5,Why we use scalar valued fuction in SQL,"If performance of Scalar valued function or any user defined  function is slower than SP's
Why we need to go through User defined function rather to go with simple SP's ???",sql,,,,,08/10/2011 09:32:24,not a real question,1,31,8,"Why we use scalar valued fuction in SQL If performance of Scalar valued function or any user defined  function is slower than SP's
Why we need to go through User defined function rather to go with simple SP's ???",1
8131695,11/15/2011 04:59:56,708502,04/14/2011 18:11:14,38,3,How to count repeated records in sql?,"Hi have a table name is Pattern

  

    S.No      type      Id_Section
        1          A        IPS
        2          A        IPS
        3          A        IPS
        4          A        IPS
        1          B        IPS
        2          B        IPS
        3          B        IPS
        1          C        IPS
        2          C        IPS


I want a query to count records  where type ""A"" ...I tried some examples..But i am getting whole records count..Please any one help me..

    ",sql,,,,,,open,0,287,7,"How to count repeated records in sql? Hi have a table name is Pattern

  

    S.No      type      Id_Section
        1          A        IPS
        2          A        IPS
        3          A        IPS
        4          A        IPS
        1          B        IPS
        2          B        IPS
        3          B        IPS
        1          C        IPS
        2          C        IPS


I want a query to count records  where type ""A"" ...I tried some examples..But i am getting whole records count..Please any one help me..

    ",1
9226201,02/10/2012 10:22:10,648223,03/07/2011 13:34:09,266,11,"Excel VBA ""Group by""-like selection","I would want to get data from an Excel worksheet in an SQL-like mode. Meaning, I have following columns : code, type, name, product_code, price, quantity.

What i would want to do is get the data from this sheet like it was an db table and i would do following :

    select code, type, name, product_code, sum(price), sum(quantity) from table
    group by code, type, name, product_code

How could i do this in VBA ?
Thank you!",sql,excel,vba,excel-vba,,,open,0,79,5,"Excel VBA ""Group by""-like selection I would want to get data from an Excel worksheet in an SQL-like mode. Meaning, I have following columns : code, type, name, product_code, price, quantity.

What i would want to do is get the data from this sheet like it was an db table and i would do following :

    select code, type, name, product_code, sum(price), sum(quantity) from table
    group by code, type, name, product_code

How could i do this in VBA ?
Thank you!",4
11452422,07/12/2012 13:01:34,1234548,02/26/2012 23:55:55,7,0,Magento: How to bulk edit product position?,"I have several hundred grouped products, every grouped product has 2 simple products attached. These simple products arent shown in the correct order. So i need to change the ""position"" value of those simple products.

I tried to achieve that by exporting a csv and edit it there but unfortunately the export doesnt support the ""position"" value.

How to bulk edit those values? ",sql,magento,,,,07/30/2012 11:32:08,off topic,1,62,7,"Magento: How to bulk edit product position? I have several hundred grouped products, every grouped product has 2 simple products attached. These simple products arent shown in the correct order. So i need to change the ""position"" value of those simple products.

I tried to achieve that by exporting a csv and edit it there but unfortunately the export doesnt support the ""position"" value.

How to bulk edit those values? ",2
11687798,07/27/2012 12:30:32,805288,06/19/2011 11:49:18,8,0,Compare current time with a time in a row using SQL in MySql,"first of all i have a table like this:

userID       Day         Hour       Class

-----       ---      ----   -----

65       Monday   08:00  Math 

65       Monday   09:00  Bio

65       Monday   13:00  History

65       Tuesday  08:00  Sports

I am choosing the classes according to the current time.
When it is 08:30  then i need to choose the next Hour which is 09:00 and it is Bio.And it is fine.
But when it is 10:00 then i need to choose 13:00 which is  History.How can i choose the next listed Hour and Class using SQL?



",sql,,,,,,open,0,152,13,"Compare current time with a time in a row using SQL in MySql first of all i have a table like this:

userID       Day         Hour       Class

-----       ---      ----   -----

65       Monday   08:00  Math 

65       Monday   09:00  Bio

65       Monday   13:00  History

65       Tuesday  08:00  Sports

I am choosing the classes according to the current time.
When it is 08:30  then i need to choose the next Hour which is 09:00 and it is Bio.And it is fine.
But when it is 10:00 then i need to choose 13:00 which is  History.How can i choose the next listed Hour and Class using SQL?



",1
8226995,11/22/2011 12:41:29,1059689,09/06/2010 13:09:50,1,0,how would look a sql insert for this database tables?,"i how would look an sql insert for this database tables?

language

languageID| language

        1 | german
        2 | english


word

id | language | text
 
 1 | 2        | lucky

 2 | 2        | happy

 3 | 1        | glücklich



translation

word1_id | word2_id

1 | 3

2 | 3

> Blockquote



Please help people. i have no idea.
PLEASE help.
",sql,,,,,11/22/2011 13:00:05,not a real question,1,87,10,"how would look a sql insert for this database tables? i how would look an sql insert for this database tables?

language

languageID| language

        1 | german
        2 | english


word

id | language | text
 
 1 | 2        | lucky

 2 | 2        | happy

 3 | 1        | glücklich



translation

word1_id | word2_id

1 | 3

2 | 3

> Blockquote



Please help people. i have no idea.
PLEASE help.
",1
6061613,05/19/2011 16:13:23,676512,03/25/2011 10:18:39,42,0,Techniques/Tricks for Hiding/Abstracting SQL in PL/SQL,"According to http://www.toadworld.com/Portals/0/stevenf/Say%20Goodbye%20to%20Hard-Coding.pdf the author talks about hiding cursors/SQL in PL/SQL, but I couldn't find how it's done. Can someone enlighten with any simple approach on how it's done?. Thanks.",sql,oracle,plsql,,,12/21/2011 14:15:48,not constructive,1,30,6,"Techniques/Tricks for Hiding/Abstracting SQL in PL/SQL According to http://www.toadworld.com/Portals/0/stevenf/Say%20Goodbye%20to%20Hard-Coding.pdf the author talks about hiding cursors/SQL in PL/SQL, but I couldn't find how it's done. Can someone enlighten with any simple approach on how it's done?. Thanks.",3
10894688,06/05/2012 09:20:58,399145,07/22/2010 13:40:20,916,5,How to execute .sql file using powershell?,"I am having .sql file. I am trying to pass connection string details through powershell script
and invoke the .sql file.

I was searching and come up with some cmdlet related to Invoke-sqlcmd.

While i was trying to find the module which is corresponding to SQL , i did not find any one in my machine.

Should i install any thing in my machine (the machine already has ssms 2008 R2) to get the modules?

or is there any easy way to execute .sql files using powershell?",sql,powershell,powershell-module,,,,open,0,82,7,"How to execute .sql file using powershell? I am having .sql file. I am trying to pass connection string details through powershell script
and invoke the .sql file.

I was searching and come up with some cmdlet related to Invoke-sqlcmd.

While i was trying to find the module which is corresponding to SQL , i did not find any one in my machine.

Should i install any thing in my machine (the machine already has ssms 2008 R2) to get the modules?

or is there any easy way to execute .sql files using powershell?",3
9044420,01/28/2012 10:05:27,1174000,01/27/2012 17:14:48,1,0,complex sql query with multiple left joins,"I am developing an online travel guide with al lot of hotels. I want to make a complex query from 4 tables in order to get the total number of hotels per hotels category <b>(having min_price of each hotel between 2 values which are adjusted by a slider)</b>.   

My tables look like:

 - <b>Categories</b>
 - id_category
 - category_name


----------

 - <b>Hotels</b>
 - id_hotel
 - hotel_name
 - category_id
 - ......


----------
 - <b>hotels_room_types</b>
 - id_hotels_room_type
 - hotel_id
 - room_type_id
 - ......


----------
 - <b>hotels_room_types_seasons</b>
 - hotels_room_types_id
 - season_id
 - price
 - ......

I would like my results to be like:

<pre >Hotels  32<br>
apartments   0<br>
hostels 5<br>

<br>

Could anyone help me how to write the appropriate query?<br>
Thanks!!!

",sql,count,left-join,min,,01/29/2012 14:04:16,too localized,1,113,7,"complex sql query with multiple left joins I am developing an online travel guide with al lot of hotels. I want to make a complex query from 4 tables in order to get the total number of hotels per hotels category <b>(having min_price of each hotel between 2 values which are adjusted by a slider)</b>.   

My tables look like:

 - <b>Categories</b>
 - id_category
 - category_name


----------

 - <b>Hotels</b>
 - id_hotel
 - hotel_name
 - category_id
 - ......


----------
 - <b>hotels_room_types</b>
 - id_hotels_room_type
 - hotel_id
 - room_type_id
 - ......


----------
 - <b>hotels_room_types_seasons</b>
 - hotels_room_types_id
 - season_id
 - price
 - ......

I would like my results to be like:

<pre >Hotels  32<br>
apartments   0<br>
hostels 5<br>

<br>

Could anyone help me how to write the appropriate query?<br>
Thanks!!!

",4
8820126,01/11/2012 13:32:20,1143165,01/11/2012 12:23:59,1,0,store procedure -- SaveTableAsHTML.sql,"   my name is Mohd
    would you please give me some help
    i found a store procedure (SaveTableAsHTML.sql)that save any query to html file and i tested it is work properly but the problem when the data is write it in arabic in the table it will appear in the html not readble
    tx in advance",sql,,,,,01/11/2012 18:02:32,not a real question,1,67,4,"store procedure -- SaveTableAsHTML.sql    my name is Mohd
    would you please give me some help
    i found a store procedure (SaveTableAsHTML.sql)that save any query to html file and i tested it is work properly but the problem when the data is write it in arabic in the table it will appear in the html not readble
    tx in advance",1
9382598,02/21/2012 17:55:41,839187,07/11/2011 15:32:36,188,25,MS Sql table setup design,"This is a question that is very difficult to search for.  I did try but I didn't find the kind of thing I am looking for.

I will try to explain this as best as I can.

I have a database setup and I am trying to add on some functionality.  I have a concern about performance, data redundancy, and so-called best practices.

I have multiple users in the database and I am trying to set up ""benchmarks"" for each user.  Each user can have a theoretically infinite number of benchmarks (though in reality it is almost always less than 5 but I don't want to constrain myself to that) and each benchmark can have a different set of values for each YEAR moving forward and management estimates the benchmarks for the upcoming 3-4 years.  That means each year another benchmark value will exist.

Here is an example.

Person A

Benchmark 1:  2010, 2011, 2012, 2013, 2014, 2015
Benchmark 2:  2010, 2011, 2012, 2013, 2014, 2015

So on and so forth for each user and each benchmark.

**My question is this:**

How should I set up the tables for this?  

Option 1:  Set up a benchmark table that has a relationship to the user and COLUMNS for each year.  I would have to actually update the database each year and add another column for the new year and it could grow out of hand over an extremely long period of time.  

Option 2:  Set up a table for the benchmark names with a relationship to the user, a table with years, and a table with benchmark data that has a relationship to the benchmark and the year?  This seems like a better approach for maintenance sake but it would also mean the same benchmark name would exist multiple times but with a different year and value.  I wouldn't have to add a column during a new year, just make sure the year existed in the years table.

Option 3:  Something you guys tell me is a better option?  I'm hoping.

Assume the data sets are large and there are many users. 

Thanks.",sql,sql-server,,,,,open,0,355,5,"MS Sql table setup design This is a question that is very difficult to search for.  I did try but I didn't find the kind of thing I am looking for.

I will try to explain this as best as I can.

I have a database setup and I am trying to add on some functionality.  I have a concern about performance, data redundancy, and so-called best practices.

I have multiple users in the database and I am trying to set up ""benchmarks"" for each user.  Each user can have a theoretically infinite number of benchmarks (though in reality it is almost always less than 5 but I don't want to constrain myself to that) and each benchmark can have a different set of values for each YEAR moving forward and management estimates the benchmarks for the upcoming 3-4 years.  That means each year another benchmark value will exist.

Here is an example.

Person A

Benchmark 1:  2010, 2011, 2012, 2013, 2014, 2015
Benchmark 2:  2010, 2011, 2012, 2013, 2014, 2015

So on and so forth for each user and each benchmark.

**My question is this:**

How should I set up the tables for this?  

Option 1:  Set up a benchmark table that has a relationship to the user and COLUMNS for each year.  I would have to actually update the database each year and add another column for the new year and it could grow out of hand over an extremely long period of time.  

Option 2:  Set up a table for the benchmark names with a relationship to the user, a table with years, and a table with benchmark data that has a relationship to the benchmark and the year?  This seems like a better approach for maintenance sake but it would also mean the same benchmark name would exist multiple times but with a different year and value.  I wouldn't have to add a column during a new year, just make sure the year existed in the years table.

Option 3:  Something you guys tell me is a better option?  I'm hoping.

Assume the data sets are large and there are many users. 

Thanks.",2
8943093,01/20/2012 14:42:26,280501,02/24/2010 16:29:27,143,9,sql query getting groups of two or more similar rows,"I have a table with this schema:

![enter image description here][1]

  [1]: http://i.stack.imgur.com/iOVMr.jpg

The context is people who are traveling the same day and almost same hour.

What i need to obtain from it is:  
**Groups of people who have a similar date (2 +/- hours max of diference) same place and same type and they have to appear two or more times together with that constrains.**

In the image above John and Steve should appear in the results since they share all the requisites for the query.  


Thanks in advance.
",sql,query,,,,,open,0,90,10,"sql query getting groups of two or more similar rows I have a table with this schema:

![enter image description here][1]

  [1]: http://i.stack.imgur.com/iOVMr.jpg

The context is people who are traveling the same day and almost same hour.

What i need to obtain from it is:  
**Groups of people who have a similar date (2 +/- hours max of diference) same place and same type and they have to appear two or more times together with that constrains.**

In the image above John and Steve should appear in the results since they share all the requisites for the query.  


Thanks in advance.
",2
8912988,01/18/2012 15:44:43,327918,04/28/2010 13:47:26,372,12,SQL Join on two columns where equal on 1 and Not equal on the other,"I am having trouble joining 2 different tables on 2 columns where one column is equal and the other is not.

    Table A
    ID                  Email
    1                   bob
    2                   mike
    3                   dave
    
    Table B
    ID                  Email
    1                   bob
    2                   mike
    4                   dave

What I need in my result is the Table B record with ID:4 Email:qwer

Bonus points if you can do it in LINQ to Entities",sql,linq-to-entities,,,,,open,0,240,15,"SQL Join on two columns where equal on 1 and Not equal on the other I am having trouble joining 2 different tables on 2 columns where one column is equal and the other is not.

    Table A
    ID                  Email
    1                   bob
    2                   mike
    3                   dave
    
    Table B
    ID                  Email
    1                   bob
    2                   mike
    4                   dave

What I need in my result is the Table B record with ID:4 Email:qwer

Bonus points if you can do it in LINQ to Entities",2
8165479,11/17/2011 10:18:33,384529,07/06/2010 12:24:20,384,17,SQL Stored Procedure only ever successfully completes first few times,"I have a SQL stored procedure which is performing a pretty basic SELECT statement.

However, it only works a few times, then it stops returning results. Even with the same parameters passed.

To get it working again it needs to be dropped and re-created.

SQL Management Studio Activity Monitor doesn't show anything suspect.

Is there a common reason this could be happening? Once dropped and re-created it works a few times, then just stops returning results and runs forever.

I've tested this with the exact same paramters so it's doing the same query each time. Any ideas?",sql,stored-procedures,,,,11/19/2011 03:07:45,not a real question,1,92,10,"SQL Stored Procedure only ever successfully completes first few times I have a SQL stored procedure which is performing a pretty basic SELECT statement.

However, it only works a few times, then it stops returning results. Even with the same parameters passed.

To get it working again it needs to be dropped and re-created.

SQL Management Studio Activity Monitor doesn't show anything suspect.

Is there a common reason this could be happening? Once dropped and re-created it works a few times, then just stops returning results and runs forever.

I've tested this with the exact same paramters so it's doing the same query each time. Any ideas?",2
8368919,12/03/2011 16:04:26,1076663,12/02/2011 03:23:32,8,0,changing sql JOIN Syntax to LINQ,"There is two table called Posts and Tags. and another table called PostsTags having both id of Posts and Tags table. what is the corresponding LINQ for below SQL query.

    SELECT        *
     FROM            Posts INNER JOIN
                         Tags ON Posts.ID = Tags.ID

and how can I retrieve the value of both table",sql,linq,inner-join,,,,open,0,99,6,"changing sql JOIN Syntax to LINQ There is two table called Posts and Tags. and another table called PostsTags having both id of Posts and Tags table. what is the corresponding LINQ for below SQL query.

    SELECT        *
     FROM            Posts INNER JOIN
                         Tags ON Posts.ID = Tags.ID

and how can I retrieve the value of both table",3
8529059,12/16/2011 02:14:40,858905,07/23/2011 02:38:48,21,1,Suggested techniques for storing multiple versions of SQL row data,"I am developing an application that is required to store previous versions of database table rows to maintain a history of changes. I am recording the history in the same table but need the most current data to be accessible by a unique identifier that doesn't change with new versions. I have a few ideas on how this could be done and was just looking for some ideas on the best way of doing this or whether there is any reason not to use one of my ideas:

1. Create a new row for each row version, with a field to indicate which row was the current row. The drawback of this is that the new version has a different primary key and any references to the old version will not return the current version.

2. When data is updated, the old row version is duplicated to a new row, and the new version replaces the old row. The current row can be accessed by the same primary key.

3. Add a second table with only a primary key, add a column to the other table which is foreign key to new table's primary key. Use same method as described in option 1 for storing multiple versions and create a view which finds the current version by using the new table's primary key.",sql,version-control,,,,,open,0,220,10,"Suggested techniques for storing multiple versions of SQL row data I am developing an application that is required to store previous versions of database table rows to maintain a history of changes. I am recording the history in the same table but need the most current data to be accessible by a unique identifier that doesn't change with new versions. I have a few ideas on how this could be done and was just looking for some ideas on the best way of doing this or whether there is any reason not to use one of my ideas:

1. Create a new row for each row version, with a field to indicate which row was the current row. The drawback of this is that the new version has a different primary key and any references to the old version will not return the current version.

2. When data is updated, the old row version is duplicated to a new row, and the new version replaces the old row. The current row can be accessed by the same primary key.

3. Add a second table with only a primary key, add a column to the other table which is foreign key to new table's primary key. Use same method as described in option 1 for storing multiple versions and create a view which finds the current version by using the new table's primary key.",2
102591,09/19/2008 15:04:51,15279,09/17/2008 07:56:43,1,2,SQL strip text and convert to integer,"In my database (SQL 2005) I have a field which holds a comment but in the comment I have an id and I would like to strip out just the id, and IF possible convert it to an int:

'activation successful of id 1010101'

The line above is the exact structure of the data in the db field.

And no I don't want to do this in the code of the application, I actually don't want to touch it, just in case you were wondering ;-)

Any help would be much appreciated!

Thanks!",sql,text,strip,,,,open,0,88,7,"SQL strip text and convert to integer In my database (SQL 2005) I have a field which holds a comment but in the comment I have an id and I would like to strip out just the id, and IF possible convert it to an int:

'activation successful of id 1010101'

The line above is the exact structure of the data in the db field.

And no I don't want to do this in the code of the application, I actually don't want to touch it, just in case you were wondering ;-)

Any help would be much appreciated!

Thanks!",3
10822212,05/30/2012 18:36:17,1113251,12/23/2011 10:36:38,100,2,Different Rules to Handle duplicate values in Table,"Duplicates in Table 1 are indentifies as follows ;

select quote_ref, count (*) 
from table 1 
group by quote_ref 
having count(*) > 1 

Now I want the eliminate the duplicates based on the 2 rules below .

Take the entry that has the Status= Complete 
If none in complete status then take the one with max ( [created_date ])
Else Flag to look at ?


Suppose I need a CASE statement with a delete, but not sure how to construct ?",sql,sql-server,,,,,open,0,77,8,"Different Rules to Handle duplicate values in Table Duplicates in Table 1 are indentifies as follows ;

select quote_ref, count (*) 
from table 1 
group by quote_ref 
having count(*) > 1 

Now I want the eliminate the duplicates based on the 2 rules below .

Take the entry that has the Status= Complete 
If none in complete status then take the one with max ( [created_date ])
Else Flag to look at ?


Suppose I need a CASE statement with a delete, but not sure how to construct ?",2
10521906,05/09/2012 18:23:56,1381502,05/08/2012 08:07:56,1,0,PL/SQL FUNCTIONS,"I would like to know if my answers is correct, please help me, and thanks in advance
 
a)	Create a function ‘Display_Employee_Name_In_Uppercase’ that accepts the ‘Employee_ID’ from the ‘Empoyees’ table and returns the first and the last name of the employee in uppercase.


    CREATE OR REPLACE FUNCTION DISPLAY_EMPLOYEE_NAME
    (EMP_ID IN NUMBER) RETURN VARCHAR2
    IS
    EMPNAME VARCHAR(25);
    BEGIN
    SELECT FNAME ||' '|| LNAME INTO EMP_NAME FROM EMPLOYEES
    WHERE EMPLOYEE_ID = EMP_ID;
    RETURN UPPER(EMPNAME);
    EXCEPTION 
    WHEN OTHERS THEN NULL;
    END DISPLAY_EMPLOYEE_NAME;


b)	Write a small PL/SQL program to display the names of the employees whose  Employee_IDs are 107, 200 and 205. 

    SET SERVEROUTPUT ON;
    DECLARE 
    EMP_ID VARCHAR2(25);
    entEMPNAME VARCHAR2(25);
    BEGIN 
    EMP_ID :=107,200,205;
    EMPNAME :=DISPLAY_EMPLOYEE_NAME(EMP_ID);
    DBMS_OUTPUT.PUT_LINE('EMPLOYEE NAME: '||EMPNAME);
    END;

",sql,plsql,,,,05/10/2012 21:05:16,not a real question,1,178,2,"PL/SQL FUNCTIONS I would like to know if my answers is correct, please help me, and thanks in advance
 
a)	Create a function ‘Display_Employee_Name_In_Uppercase’ that accepts the ‘Employee_ID’ from the ‘Empoyees’ table and returns the first and the last name of the employee in uppercase.


    CREATE OR REPLACE FUNCTION DISPLAY_EMPLOYEE_NAME
    (EMP_ID IN NUMBER) RETURN VARCHAR2
    IS
    EMPNAME VARCHAR(25);
    BEGIN
    SELECT FNAME ||' '|| LNAME INTO EMP_NAME FROM EMPLOYEES
    WHERE EMPLOYEE_ID = EMP_ID;
    RETURN UPPER(EMPNAME);
    EXCEPTION 
    WHEN OTHERS THEN NULL;
    END DISPLAY_EMPLOYEE_NAME;


b)	Write a small PL/SQL program to display the names of the employees whose  Employee_IDs are 107, 200 and 205. 

    SET SERVEROUTPUT ON;
    DECLARE 
    EMP_ID VARCHAR2(25);
    entEMPNAME VARCHAR2(25);
    BEGIN 
    EMP_ID :=107,200,205;
    EMPNAME :=DISPLAY_EMPLOYEE_NAME(EMP_ID);
    DBMS_OUTPUT.PUT_LINE('EMPLOYEE NAME: '||EMPNAME);
    END;

",2
7654987,10/04/2011 22:59:53,277671,02/20/2010 14:28:36,297,2,Desktop SQL clients for PostgreSQL,"Are there any desktop clients that I can use to connect to my web hosting PostgreSQL database?

This is so that I can run test queries without having to use the web interface.",sql,postgresql,desktop-application,,,03/13/2012 15:19:39,not constructive,1,32,5,"Desktop SQL clients for PostgreSQL Are there any desktop clients that I can use to connect to my web hosting PostgreSQL database?

This is so that I can run test queries without having to use the web interface.",3
5753579,04/22/2011 08:18:21,463621,10/01/2010 07:41:02,1142,77,(My)SQL: Get new ids in an 'INSERT INTO ... SELECT',"I have to insert into one table the records selected from another table and (then) update the former table with the generated id for the latter. How can I do it?

E.g.

input_table:
    
    input_table:  code  new_id
                   aa    NULL
                   bb    NULL


    output_table:  id(auto_increment)  code
                    ...                ... 


SQL:

    INSERT INTO output_table (code) SELECT code FROM input_table;

    UPDATE input_table ""WITH THE NEW IDS""

Result:

    input_table:   code  new_id
                    aa    100
                    bb    101

    output_table:   id   code
                    ...  ...
                    100  aa
                    101  bb


For several reasons I cannot rely on the uniqueness of `code` in `output_table`.

Any hint?


    ",sql,auto-increment,bulkinsert,,,,open,0,304,10,"(My)SQL: Get new ids in an 'INSERT INTO ... SELECT' I have to insert into one table the records selected from another table and (then) update the former table with the generated id for the latter. How can I do it?

E.g.

input_table:
    
    input_table:  code  new_id
                   aa    NULL
                   bb    NULL


    output_table:  id(auto_increment)  code
                    ...                ... 


SQL:

    INSERT INTO output_table (code) SELECT code FROM input_table;

    UPDATE input_table ""WITH THE NEW IDS""

Result:

    input_table:   code  new_id
                    aa    100
                    bb    101

    output_table:   id   code
                    ...  ...
                    100  aa
                    101  bb


For several reasons I cannot rely on the uniqueness of `code` in `output_table`.

Any hint?


    ",3
10185176,04/17/2012 04:43:53,1252398,03/06/2012 14:09:20,46,0,set serveroutput ON permanently?,"I am new in oracle and doing practice for the PL/SQL. I have one question i.e. :
how to set serveroutput ON permanently in oracle. Is their any way that we  use to set it permanently ON?
  ",sql,oracle,plsqldeveloper,,,,open,0,39,4,"set serveroutput ON permanently? I am new in oracle and doing practice for the PL/SQL. I have one question i.e. :
how to set serveroutput ON permanently in oracle. Is their any way that we  use to set it permanently ON?
  ",3
10041132,04/06/2012 08:42:31,1014299,10/26/2011 09:47:58,23,0,SQL Server: How to specify particular default date format with getdate()?,"I have SQL Server 2008 R2 and one of my tables has a date field. When an insert from my ASP.NET page happens, the date is automatically inserted by setting the default field value to getdate(). However, this adds the date in the format YYYY-MM-DD HH:MM:SS.0000000. I really only need the time up to seconds and not the trailing zeros after it.
How do I do this?
Thanks,
J.",sql,datetime,,,,,open,0,66,11,"SQL Server: How to specify particular default date format with getdate()? I have SQL Server 2008 R2 and one of my tables has a date field. When an insert from my ASP.NET page happens, the date is automatically inserted by setting the default field value to getdate(). However, this adds the date in the format YYYY-MM-DD HH:MM:SS.0000000. I really only need the time up to seconds and not the trailing zeros after it.
How do I do this?
Thanks,
J.",2
11686768,07/27/2012 11:22:48,1425693,05/30/2012 09:41:50,8,0,"default size of a table,database in sql","provide me the details for default size allocated when we create a database in sql server 2008.Also need to know the memory size for table,rows,cells etc.",sql,sql-server,sql-server-2008,,,07/27/2012 11:34:32,not a real question,1,26,7,"default size of a table,database in sql provide me the details for default size allocated when we create a database in sql server 2008.Also need to know the memory size for table,rows,cells etc.",3
9679051,03/13/2012 05:57:15,648164,03/07/2011 12:47:14,42,3,Why = operator doesn't work with ROWNUM other than for value 1?,"I have the following query:

select * from abc where rownum = 10

Output: No records to display

I sure have more than 25 records in the abc table and my objective is to display the nth record.

If I write the query as select * from abc where rownum = 1 it works fine and gives me the first record. Not any other record other than first.

Any idea?",sql,oracle11g,,,,,open,0,65,12,"Why = operator doesn't work with ROWNUM other than for value 1? I have the following query:

select * from abc where rownum = 10

Output: No records to display

I sure have more than 25 records in the abc table and my objective is to display the nth record.

If I write the query as select * from abc where rownum = 1 it works fine and gives me the first record. Not any other record other than first.

Any idea?",2
7125274,08/19/2011 17:34:54,902857,08/19/2011 17:24:24,1,0,Can we use Request.QueryString in classic ASP if using URL masking?,"I'm writing a website for a local club of ours. I've got all the site written in ASP linked to our backend SQL server and it works lovely. I want to create player profiles now. Normally I would use ""(a href=playerdetails.asp?ID=1) Player 1 (/a)"" then in the ASP section of the page use strsql = ""SELECT * FROM Players Where ID="" & request.querystring(""ID"").

However, this is where my problems starts. To save money for the club, I am also hosting the site for them on my private domain. We have registered there domain and instead of paying for hosting, we're just redirecting the traffic via the domain registers URL forwarding, using masking. Therefore instead of the URL saying www.mydomain.com/club/ it says www.club.com.

Thus the original question... Can I use request.querystring with the setup we have? If not, is there a way around it as the club doesn't really have the budet for a hosted site with SQL in the backend.

Thanks in advance,

Paul.

PS <'s in the link replaced with ('s to display correctly.",sql,asp,request.querystring,,,,open,0,170,11,"Can we use Request.QueryString in classic ASP if using URL masking? I'm writing a website for a local club of ours. I've got all the site written in ASP linked to our backend SQL server and it works lovely. I want to create player profiles now. Normally I would use ""(a href=playerdetails.asp?ID=1) Player 1 (/a)"" then in the ASP section of the page use strsql = ""SELECT * FROM Players Where ID="" & request.querystring(""ID"").

However, this is where my problems starts. To save money for the club, I am also hosting the site for them on my private domain. We have registered there domain and instead of paying for hosting, we're just redirecting the traffic via the domain registers URL forwarding, using masking. Therefore instead of the URL saying www.mydomain.com/club/ it says www.club.com.

Thus the original question... Can I use request.querystring with the setup we have? If not, is there a way around it as the club doesn't really have the budet for a hosted site with SQL in the backend.

Thanks in advance,

Paul.

PS <'s in the link replaced with ('s to display correctly.",3
11268743,06/29/2012 20:47:30,139618,07/16/2009 16:17:44,718,8,SQL Server Select After Merge Join on Column,"Using a populated Table Type as the source for a TSQL-Merge. I want to execute a select statement after the merge,
retrieving all columns/rows of the table type, but instead of the '-1' value, I want the new 
inserted id. I am not sure I can do this in a fully set-based manner, can I?

This is for a UI that is sending a pile of inserts into the DB, and needs back the same objects, but with each of their ID column values populated. There is no 'common column' for the SQL JOIN operation.

    CREATE TYPE instype AS TABLE(
    	instypeid [smallint] NOT NULL,
    	instext [varchar](64) NOT NULL
    )
    Go
    create table #desttable ( instypeid smallint identity(1,1) primary key , instext varchar(64) )
    Go
    declare @newids table ( idvalue smallint )
    declare @thing1 instype
    insert into @thing1 values ( -1 , 'zero' )
    insert into @thing1 values ( -1 , 'one' )
    	Merge #desttable desttbl
    			Using @thing1  srctbl
    			On desttbl.instypeid = srctbl.instypeid
    			When Not Matched Then
    				Insert ( instext )
    				Values ( instext )
    			Output inserted.instypeid Into @newids
    		;
    	
    /*
    		Wanted shape of the result set
    		instypeid	instext
    		0			zero
    		1			one
    
    */




Thanks.",sql,sql-server-2008,select,join,,,open,0,272,8,"SQL Server Select After Merge Join on Column Using a populated Table Type as the source for a TSQL-Merge. I want to execute a select statement after the merge,
retrieving all columns/rows of the table type, but instead of the '-1' value, I want the new 
inserted id. I am not sure I can do this in a fully set-based manner, can I?

This is for a UI that is sending a pile of inserts into the DB, and needs back the same objects, but with each of their ID column values populated. There is no 'common column' for the SQL JOIN operation.

    CREATE TYPE instype AS TABLE(
    	instypeid [smallint] NOT NULL,
    	instext [varchar](64) NOT NULL
    )
    Go
    create table #desttable ( instypeid smallint identity(1,1) primary key , instext varchar(64) )
    Go
    declare @newids table ( idvalue smallint )
    declare @thing1 instype
    insert into @thing1 values ( -1 , 'zero' )
    insert into @thing1 values ( -1 , 'one' )
    	Merge #desttable desttbl
    			Using @thing1  srctbl
    			On desttbl.instypeid = srctbl.instypeid
    			When Not Matched Then
    				Insert ( instext )
    				Values ( instext )
    			Output inserted.instypeid Into @newids
    		;
    	
    /*
    		Wanted shape of the result set
    		instypeid	instext
    		0			zero
    		1			one
    
    */




Thanks.",4
9622338,03/08/2012 17:51:37,970008,09/28/2011 21:39:55,149,6,Copy One Table from Another Database Won't Let Me Drop or Insert Into,"There are many similar questions, but I have not found exactly what I am looking for.

I want to copy and completely update one table from one database to another. Then, each day, the SP will drop, and insert into the local database with the master database data. Or some other way to update the local copy.

Thinking of creating a stored procedure that does an ""insert into"" from the master database to the local database. When I did this, I get an error that the table already exists however. 

Do I need to drop the entire table and then do the insert into? If so, can you post an example SQL please?


My problems:
1) When I try to drop the table and then do the insert into, I get the error that the the table does not exist in the context. It won't let me drop it.
2) When I do the insert into without the drop, it says the table already exists.
3) What is the best way to schedule the daily import?

    USE Local_DB
    CREATE PROCEDURE TransferProductTable;
    DROP TABLE Local_DB.dbo.tbProduct
    SELECT *
    INTO Local_DB.dbo.tbProduct
    FROM Master_DB.dbo.tbProduct
    GO;

When I run this, I get the error that Local_DB.dbo.tbProduct already exists or when I add the drop table, I get that I cannot drop it because it does not exist. 

I also read on here that SQL Management Studio has an Import Data task. Would it be better to created a scheduled task that ran that, or is that the same thing as creating scheduled task that runs a stored procedure?

This is running on a Windows box with MS SQL 2008.
",sql,database,insert,drop,into,,open,0,287,13,"Copy One Table from Another Database Won't Let Me Drop or Insert Into There are many similar questions, but I have not found exactly what I am looking for.

I want to copy and completely update one table from one database to another. Then, each day, the SP will drop, and insert into the local database with the master database data. Or some other way to update the local copy.

Thinking of creating a stored procedure that does an ""insert into"" from the master database to the local database. When I did this, I get an error that the table already exists however. 

Do I need to drop the entire table and then do the insert into? If so, can you post an example SQL please?


My problems:
1) When I try to drop the table and then do the insert into, I get the error that the the table does not exist in the context. It won't let me drop it.
2) When I do the insert into without the drop, it says the table already exists.
3) What is the best way to schedule the daily import?

    USE Local_DB
    CREATE PROCEDURE TransferProductTable;
    DROP TABLE Local_DB.dbo.tbProduct
    SELECT *
    INTO Local_DB.dbo.tbProduct
    FROM Master_DB.dbo.tbProduct
    GO;

When I run this, I get the error that Local_DB.dbo.tbProduct already exists or when I add the drop table, I get that I cannot drop it because it does not exist. 

I also read on here that SQL Management Studio has an Import Data task. Would it be better to created a scheduled task that ran that, or is that the same thing as creating scheduled task that runs a stored procedure?

This is running on a Windows box with MS SQL 2008.
",5
3002133,06/08/2010 23:37:24,361905,06/08/2010 23:37:24,1,0,not including null values in sql join,"I have two tables CustomerAddress(CustomerId, City, Country) and CustomerTransactions(TransactionId, CustomerId, CustomerContact). Here are the values in the tables:

For CustomerAddress:


1001, El Paso, USA

1002, Paris, France

1003, Essen, Germany

For CustomerTransactions:

98, 1001, Phillip

99, 1001, NULL

100, 1001, NULL

101, 1003, Carmen

102, 1003, Carmen

103, 1003, Lola

104, 1003, NULL

105, 1002, NULL


I'm trying to join both tables and have the following result set:

1001, El Paso, USA, Phillip

1002, Paris, France, (empty string)

1003, Essen, Germany, Carmen

1003, Essen, Germany, Lola

It seems like a simple join but I'm having trouble coming up with the above result set. Please help.

Thanks.
",sql,sql-server,distinct-values,,,,open,0,86,7,"not including null values in sql join I have two tables CustomerAddress(CustomerId, City, Country) and CustomerTransactions(TransactionId, CustomerId, CustomerContact). Here are the values in the tables:

For CustomerAddress:


1001, El Paso, USA

1002, Paris, France

1003, Essen, Germany

For CustomerTransactions:

98, 1001, Phillip

99, 1001, NULL

100, 1001, NULL

101, 1003, Carmen

102, 1003, Carmen

103, 1003, Lola

104, 1003, NULL

105, 1002, NULL


I'm trying to join both tables and have the following result set:

1001, El Paso, USA, Phillip

1002, Paris, France, (empty string)

1003, Essen, Germany, Carmen

1003, Essen, Germany, Lola

It seems like a simple join but I'm having trouble coming up with the above result set. Please help.

Thanks.
",3
4437039,12/14/2010 08:02:42,118584,06/06/2009 16:11:16,755,24,Using Case in a Cursor with T-SQL,"With the code below, I'd like make a ""switch"", check a field value and set another field depending of the value. I have to do this for each row then it's in a cursor. But something is missing ...

Thanks for your help

    DECLARE @Res int
    OPEN MyCursor;
    
     FETCH NEXT FROM MyCursor 
     INTO @field1, @field2, @field3, @field4
    
     WHILE @@FETCH_STATUS = 0
     BEGIN
      SELECT
      CASE @field1
       WHEN 'A' THEN @Res = 1
       WHEN 'B' THEN @Res = 2
       WHEN 'C' THEN @Res = 3
       WHEN 'D' THEN @Res = 4
       WHEN 'E' THEN @Res = 5
      END
    
      FETCH NEXT FROM MyCursor 
      INTO @field1, @field2, @field3, @field4
    
     END
    
    CLOSE MyCursor;",sql,sql-server,tsql,,,,open,0,213,7,"Using Case in a Cursor with T-SQL With the code below, I'd like make a ""switch"", check a field value and set another field depending of the value. I have to do this for each row then it's in a cursor. But something is missing ...

Thanks for your help

    DECLARE @Res int
    OPEN MyCursor;
    
     FETCH NEXT FROM MyCursor 
     INTO @field1, @field2, @field3, @field4
    
     WHILE @@FETCH_STATUS = 0
     BEGIN
      SELECT
      CASE @field1
       WHEN 'A' THEN @Res = 1
       WHEN 'B' THEN @Res = 2
       WHEN 'C' THEN @Res = 3
       WHEN 'D' THEN @Res = 4
       WHEN 'E' THEN @Res = 5
      END
    
      FETCH NEXT FROM MyCursor 
      INTO @field1, @field2, @field3, @field4
    
     END
    
    CLOSE MyCursor;",3
11303038,07/03/2012 00:36:20,736940,05/03/2011 21:20:59,16,0,"table design approach, what is the flaw?","I have a table like below

tblQuestions	<br>
---------------<br>
ID(pk)	int<br>
CustomerID(fk) int<br>
QTypeID(fk)	int<br>
QNumber	int<br>
FieldName	varchar(max)<br>
FieldValue	varchar(max)<br>

clustered indexs on CustomerID, QTypeID, QNumber.<br>
For each combination CustomerID, QTypeID and QNumber, there will be 4 to 5 records. 
and, for each customerID there would be at max 250 records.<br><br>
Another way to design is to create 5 to 6 different tables with defined fields and customerid as foreign key with one record per customer. <BR><BR>

My Question is, after how many records does the first approach starts to effect perfomance or would it ever?<BR>

Do you see any thing wrong with this approach?  The maximum possible records might go upto 50 million records. <BR>

thank you

",sql,sql-server,table,database-design,,07/04/2012 01:24:30,not a real question,1,100,7,"table design approach, what is the flaw? I have a table like below

tblQuestions	<br>
---------------<br>
ID(pk)	int<br>
CustomerID(fk) int<br>
QTypeID(fk)	int<br>
QNumber	int<br>
FieldName	varchar(max)<br>
FieldValue	varchar(max)<br>

clustered indexs on CustomerID, QTypeID, QNumber.<br>
For each combination CustomerID, QTypeID and QNumber, there will be 4 to 5 records. 
and, for each customerID there would be at max 250 records.<br><br>
Another way to design is to create 5 to 6 different tables with defined fields and customerid as foreign key with one record per customer. <BR><BR>

My Question is, after how many records does the first approach starts to effect perfomance or would it ever?<BR>

Do you see any thing wrong with this approach?  The maximum possible records might go upto 50 million records. <BR>

thank you

",4
10251168,04/20/2012 17:58:23,1330006,04/12/2012 19:10:46,6,0,Generate percentile from histogram type data in SQL,"I have a table with histogram type data. There are 3 columns: Bucket, Count, and Avg Value.

Bucket is the histogram bucket, Count is the number of values in that bucket, and Avg Value is the Average value of all the items in that bucket.

Now my buckets are ordered so for example, let's say that the bucket indicates minutes it took to complete a task. We could have buckets such as 0-5 minutes, 5-10 minutes, 10-15, etc.

What I'm trying to compute is which bucket falls in the XXth percentile. For example, if 90% of tasks complete in 12 minutes, then I want to know that 90% of tasks are in the 10-15 bucket or less.

Is there a way to compute this in SQL?

Thanks!",sql,sql-server,,,,,open,0,122,8,"Generate percentile from histogram type data in SQL I have a table with histogram type data. There are 3 columns: Bucket, Count, and Avg Value.

Bucket is the histogram bucket, Count is the number of values in that bucket, and Avg Value is the Average value of all the items in that bucket.

Now my buckets are ordered so for example, let's say that the bucket indicates minutes it took to complete a task. We could have buckets such as 0-5 minutes, 5-10 minutes, 10-15, etc.

What I'm trying to compute is which bucket falls in the XXth percentile. For example, if 90% of tasks complete in 12 minutes, then I want to know that 90% of tasks are in the 10-15 bucket or less.

Is there a way to compute this in SQL?

Thanks!",2
9296406,02/15/2012 15:43:16,45664,12/12/2008 10:37:47,28697,863,How to efficiently check if a database contains an identical record to a pending insert?,"I have some records that I want to ""insert or update"" into a SQL Server database, via a stored procedure.  These records have a globally unique and stable ID, and a bunch of value attributes (about a dozen).

Checking for insert is straightforward enough - see if the key exists in the table.

Assuming that the key does exist, I then need to check whether the existing record contains exactly the same values as the current instance that I'm passing into the function.  At the moment I'm doing this via:

    SELECT @identical = CASE WHEN COUNT(*) > 0 THEN 1 ELSE 0 END FROM Table
        WHERE idCol = @newId
          AND valueCol1 = @newValue1
          AND valueCol2 = @newValue2
          AND ...

This works, but it's not very efficient; I'm able to insert about 70 records per second which is a lot slower than I'd expect.

My first thought was to add an index - but this will be indexing almost every column in the table.  Would that even make sense or would it just be a second copy of the table?  (The ID column is a clustered PK if that's relevant.)

Is there any sensible way to speed up a query that has to check the values of every column?  I'm considering using some sort of hash to detect duplicates, but this adds some space overhead, complexity to the sprocs and small (acceptable) possibility of false positives, so I'd much rather a solution based on indices or rewriting the SQL if one exists.",sql,performance,query,indexing,,,open,0,288,15,"How to efficiently check if a database contains an identical record to a pending insert? I have some records that I want to ""insert or update"" into a SQL Server database, via a stored procedure.  These records have a globally unique and stable ID, and a bunch of value attributes (about a dozen).

Checking for insert is straightforward enough - see if the key exists in the table.

Assuming that the key does exist, I then need to check whether the existing record contains exactly the same values as the current instance that I'm passing into the function.  At the moment I'm doing this via:

    SELECT @identical = CASE WHEN COUNT(*) > 0 THEN 1 ELSE 0 END FROM Table
        WHERE idCol = @newId
          AND valueCol1 = @newValue1
          AND valueCol2 = @newValue2
          AND ...

This works, but it's not very efficient; I'm able to insert about 70 records per second which is a lot slower than I'd expect.

My first thought was to add an index - but this will be indexing almost every column in the table.  Would that even make sense or would it just be a second copy of the table?  (The ID column is a clustered PK if that's relevant.)

Is there any sensible way to speed up a query that has to check the values of every column?  I'm considering using some sort of hash to detect duplicates, but this adds some space overhead, complexity to the sprocs and small (acceptable) possibility of false positives, so I'd much rather a solution based on indices or rewriting the SQL if one exists.",4
3164877,07/02/2010 10:23:07,315301,04/13/2010 09:14:35,33,1,incorrect syntax near '-',"i am trying to run a query in another server and  need to specify it in the select statement but the server name has got an '-' in it, like server-name.
this is producing the error in the title.
How can i fix it?",sql,server,2005,,,,open,0,43,4,"incorrect syntax near '-' i am trying to run a query in another server and  need to specify it in the select statement but the server name has got an '-' in it, like server-name.
this is producing the error in the title.
How can i fix it?",3
5940862,05/09/2011 18:23:48,745621,05/09/2011 18:15:45,1,0,"Named Pipes Provider, error: 40 - Could not open a connection to SQL Server","Has anybody encountered this error?
I added the TCP port 1433 to the inbound firewall rules, also i made sure that the named pipes are enabled.  But still, I cannot connect to the Sql server (sql server 08 R2)
I appreciate any suggestions. Thanks!

**A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) (Microsoft SQL Server, error:2)**",sql,sharepoint,server,,,05/21/2011 22:11:33,off topic,1,100,14,"Named Pipes Provider, error: 40 - Could not open a connection to SQL Server Has anybody encountered this error?
I added the TCP port 1433 to the inbound firewall rules, also i made sure that the named pipes are enabled.  But still, I cannot connect to the Sql server (sql server 08 R2)
I appreciate any suggestions. Thanks!

**A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) (Microsoft SQL Server, error:2)**",3
6942904,08/04/2011 14:07:48,858953,07/23/2011 04:13:02,1399,85,Senior SQL Developer Interview Questions - Too Difficult?,"Warning, this is a long post. TL/DR: Am I being too harsh with my interview questions?

OK, after ~9 months of total disappointment in the applicant pool, I want to make sure we're not expecting too much from our senior developer applicants. 

**Background**

We're a business intelligence shop. However, we don't expect candidates to come in with BI knowledge. If you have a solid T-SQL background, that's all we need. We'll get you the rest of the way there with regards to Analysis Services, Dimensional Modeling, etc. So all we test is T-SQL skills. Everything happens within SSMS.

If candidates pass a phone screening, we bring them in for a coding interview where we give them 7 questions and a generous 90 minutes. I'm present during the coding to watch for various things like how they navigate through the tools, what they research, etc. It should be noted that we make it very clear that any resources are available to them, including the internet, BOL, etc.

**Questions**

Here are the questions in abbreviated form in an attempt to not give too much away (since they might google this question :P)

 1. Fizzbuzz - I want to see how they generate their rowset. If they use variables/loops, I die inside
 2. Aggregation - The question basically forces candidates to use the full scope of the select statement (select, from, where, group by, having)
 3. How NULLs work - I give a ""tricky"" question where an `IN` subquery doesn't return anything because of a NULL value in the subqueried table. I ask for the workaround to make the query work and then an explanation on why it didn't in the first place. I want to know that they understand what a NULL value is/means and how SQL evaluates them.
 4. Indexing - A simple 2 join query with no indexes. I ask that candidates improve the entire queries sub-tree cost by 20%. I quickly find out whether or not they've indexed before. I make it a point to inform them ""READ THE QUESTION. GIVE ME WHAT I ASK FOR"". Sadly, I don't think a single applicant as even noted the beginning or ending sub-tree cost.
 5. Running Totals - I give a table with a PK/date/numeric values and ask them to update another column with a running total per PK. This isn't easy and it's a weird task. I don't really care if they finish in time, but I want to see research if they haven't done it or a decent attempt (even if its inefficient, at least start writing some correlated subqueries).
 6. XML - I ask them to retrieve a value from a XML-typed column. I don't expect candidates to know how to do this, and I tell them that. The point of this one is to watch them do research, etc., just like any other time they encounter a new problem at work and need to solve it.
 7. CTE - I just ask them to write a CTE. That's it. Bonus if it does something creative/interesting.

And that's it. So, my question is how fair are these questions? We're looking for someone with actual experience. Its unfathomable to me that someone with 10 years of SQL experience can't even get 1 or 2 of these questions. Am I being too harsh? Should I add/remove stuff from this?

",sql,sql-server,tsql,interview-questions,,08/04/2011 14:18:32,off topic,1,553,8,"Senior SQL Developer Interview Questions - Too Difficult? Warning, this is a long post. TL/DR: Am I being too harsh with my interview questions?

OK, after ~9 months of total disappointment in the applicant pool, I want to make sure we're not expecting too much from our senior developer applicants. 

**Background**

We're a business intelligence shop. However, we don't expect candidates to come in with BI knowledge. If you have a solid T-SQL background, that's all we need. We'll get you the rest of the way there with regards to Analysis Services, Dimensional Modeling, etc. So all we test is T-SQL skills. Everything happens within SSMS.

If candidates pass a phone screening, we bring them in for a coding interview where we give them 7 questions and a generous 90 minutes. I'm present during the coding to watch for various things like how they navigate through the tools, what they research, etc. It should be noted that we make it very clear that any resources are available to them, including the internet, BOL, etc.

**Questions**

Here are the questions in abbreviated form in an attempt to not give too much away (since they might google this question :P)

 1. Fizzbuzz - I want to see how they generate their rowset. If they use variables/loops, I die inside
 2. Aggregation - The question basically forces candidates to use the full scope of the select statement (select, from, where, group by, having)
 3. How NULLs work - I give a ""tricky"" question where an `IN` subquery doesn't return anything because of a NULL value in the subqueried table. I ask for the workaround to make the query work and then an explanation on why it didn't in the first place. I want to know that they understand what a NULL value is/means and how SQL evaluates them.
 4. Indexing - A simple 2 join query with no indexes. I ask that candidates improve the entire queries sub-tree cost by 20%. I quickly find out whether or not they've indexed before. I make it a point to inform them ""READ THE QUESTION. GIVE ME WHAT I ASK FOR"". Sadly, I don't think a single applicant as even noted the beginning or ending sub-tree cost.
 5. Running Totals - I give a table with a PK/date/numeric values and ask them to update another column with a running total per PK. This isn't easy and it's a weird task. I don't really care if they finish in time, but I want to see research if they haven't done it or a decent attempt (even if its inefficient, at least start writing some correlated subqueries).
 6. XML - I ask them to retrieve a value from a XML-typed column. I don't expect candidates to know how to do this, and I tell them that. The point of this one is to watch them do research, etc., just like any other time they encounter a new problem at work and need to solve it.
 7. CTE - I just ask them to write a CTE. That's it. Bonus if it does something creative/interesting.

And that's it. So, my question is how fair are these questions? We're looking for someone with actual experience. Its unfathomable to me that someone with 10 years of SQL experience can't even get 1 or 2 of these questions. Am I being too harsh? Should I add/remove stuff from this?

",4
4275287,11/25/2010 09:05:46,341791,05/15/2010 06:11:45,107,10,Option Recompile makes query fast - good or bad?,"I have two SQL queries with about 2-3 INNER JOINS each. I need to do an INTERSECT between them.

Problem is that indiividually the queryes work fast, but after intersecting take about 4 seconds in total.

Now, if I put an OPTION (RECOMPILE) at the end of this whole query, the query works great again working quite fast returning almost instantly!.

I understand that option recopile forces a rebuild of execution plan, so I am confused now if my earler query taking 4 seconds is better or now the one with recompile, but taking 0 seconds is better.",sql,sql-server,optimization,,,,open,0,95,9,"Option Recompile makes query fast - good or bad? I have two SQL queries with about 2-3 INNER JOINS each. I need to do an INTERSECT between them.

Problem is that indiividually the queryes work fast, but after intersecting take about 4 seconds in total.

Now, if I put an OPTION (RECOMPILE) at the end of this whole query, the query works great again working quite fast returning almost instantly!.

I understand that option recopile forces a rebuild of execution plan, so I am confused now if my earler query taking 4 seconds is better or now the one with recompile, but taking 0 seconds is better.",3
11293042,07/02/2012 11:47:51,1185230,02/02/2012 13:21:59,21,1,Difference between Alter and Update SQL,"I am  busy studying my SQL and i understand that update is usednto update a record or row in a table. so what does alter do that is so diff? seems they the same.

Thanks any help will be appreciated",sql,update,alter,,,07/02/2012 18:39:53,not a real question,1,40,6,"Difference between Alter and Update SQL I am  busy studying my SQL and i understand that update is usednto update a record or row in a table. so what does alter do that is so diff? seems they the same.

Thanks any help will be appreciated",3
10542914,05/10/2012 22:13:22,1388178,05/10/2012 21:40:58,1,0,How to create sql procedure for reporting from two table,"i have two tables called shipment and payment with the following columns

Shipment

    1.Executivename
    2.shipername
    3.shiperaddress
    4.acountno
    5.invoiceno	
    6.shipdate	
    etc.


Payment

   1.InvoiceNo	
   2.accountno	
   3.Date	
   4.Discount	
   5.ReceivedAmount
   6.MoneyReceiptNo

Now I want to generate report by Executive name with the field of ""Payment"" table.I tried to do that by following Stored procedure-
   
***CREATE PROCEDURE [dbo].[rptexecutivepayment] @executivename varchar(20) AS BEGIN select Executivename,[shipment].accountno,[date],discount,receivedamount,moneyreceiptno from shipment full join payment on shipment.accountno=payment.accountno and shipment.invoiceno=payment.invoiceno where Executivename=@executivename order by Executivename end
GO***
 
But, the report r generating data duplication. What can i do now? Please, somebody help me.	",sql,sql-server,visual-studio,crystal-reports,,,open,0,122,10,"How to create sql procedure for reporting from two table i have two tables called shipment and payment with the following columns

Shipment

    1.Executivename
    2.shipername
    3.shiperaddress
    4.acountno
    5.invoiceno	
    6.shipdate	
    etc.


Payment

   1.InvoiceNo	
   2.accountno	
   3.Date	
   4.Discount	
   5.ReceivedAmount
   6.MoneyReceiptNo

Now I want to generate report by Executive name with the field of ""Payment"" table.I tried to do that by following Stored procedure-
   
***CREATE PROCEDURE [dbo].[rptexecutivepayment] @executivename varchar(20) AS BEGIN select Executivename,[shipment].accountno,[date],discount,receivedamount,moneyreceiptno from shipment full join payment on shipment.accountno=payment.accountno and shipment.invoiceno=payment.invoiceno where Executivename=@executivename order by Executivename end
GO***
 
But, the report r generating data duplication. What can i do now? Please, somebody help me.	",4
11508180,07/16/2012 16:06:48,704906,04/12/2011 21:20:59,62,2,AlwaysOn SQL Server setup questions,"I just have a few questions regarding the setup of Always On HA, and Clusters. When you setup an AG, and it gets to setting up your IP address for the cluster how can i switch from using DHCP to a static IP address? I have it working with DHCP right now but in the future I would like to change that for my existing AG and also for future groups I setup. It does not seem like I'm being given the option in my setup though. 

The second question is when setting up the group to use full sync it works just fine. However What I am trying to figure out is where that sync data is stored. I am using Synchronous-commit mode. From what it looks like the initial sync, and the data that is mirrored is stored and applied in a basic log I just cannot seem to find where that log is stored. 

Any information or links would be greatly appreciated.  ",sql,sql-server,high-availability,,,07/16/2012 16:28:18,off topic,1,167,5,"AlwaysOn SQL Server setup questions I just have a few questions regarding the setup of Always On HA, and Clusters. When you setup an AG, and it gets to setting up your IP address for the cluster how can i switch from using DHCP to a static IP address? I have it working with DHCP right now but in the future I would like to change that for my existing AG and also for future groups I setup. It does not seem like I'm being given the option in my setup though. 

The second question is when setting up the group to use full sync it works just fine. However What I am trying to figure out is where that sync data is stored. I am using Synchronous-commit mode. From what it looks like the initial sync, and the data that is mirrored is stored and applied in a basic log I just cannot seem to find where that log is stored. 

Any information or links would be greatly appreciated.  ",3
8227274,11/22/2011 13:03:55,833266,07/07/2011 09:47:23,21,1,Can a database schema enforce any given business logic by use of referential integrity alone?,I understand referential integrity to mean primary & foreign keys and check constraints.,sql,database-design,referential-integrity,,,11/23/2011 09:38:04,not constructive,1,13,15,Can a database schema enforce any given business logic by use of referential integrity alone? I understand referential integrity to mean primary & foreign keys and check constraints.,3
11073276,06/17/2012 17:17:24,1431160,06/01/2012 16:34:14,1,0,T-sql to sql conversion,"How would I convert a temporary table(with three columns deifned) from t-sql into simple sql?
Here is the code that have 


BEGIN

	SELECT  CLUB.organisationRef,CLUB.organisationname AS [Club Name], LAU.OrganisationName AS LAU, 
		count(L.display) as [Members],L.Display as [Role],  
		DBO.fncGetClubRecentRegDate( CLUB.OrganisationID) AS ExpDate
		
	FROM FWBOrganisation CLUB (NOLOCK)
		INNER JOIN FWXOrgRelationship CLUBLAU (NOLOCK)
			ON CLUBLAU.ParentOrgID = CLUB.OrganisationID
			
	INNER JOIN (fwbcontact C (nolock) 
		INNER JOIN   fwslists L
		 ON C.ROLENAME = L.value  
		AND (L.value IN (SELECT Rolename from @RoleNames)))
	
	Group by L.display,CLUB.OrganisationName,LAU.OrganisationName,LAU.OrganisationName,CLUB.OrganisationID,CLUB.Organisationref , Ord.OrderStatus
	order by CLUB.OrganisationName 

END",sql,tsql,table,,,06/18/2012 16:55:08,not a real question,1,78,4,"T-sql to sql conversion How would I convert a temporary table(with three columns deifned) from t-sql into simple sql?
Here is the code that have 


BEGIN

	SELECT  CLUB.organisationRef,CLUB.organisationname AS [Club Name], LAU.OrganisationName AS LAU, 
		count(L.display) as [Members],L.Display as [Role],  
		DBO.fncGetClubRecentRegDate( CLUB.OrganisationID) AS ExpDate
		
	FROM FWBOrganisation CLUB (NOLOCK)
		INNER JOIN FWXOrgRelationship CLUBLAU (NOLOCK)
			ON CLUBLAU.ParentOrgID = CLUB.OrganisationID
			
	INNER JOIN (fwbcontact C (nolock) 
		INNER JOIN   fwslists L
		 ON C.ROLENAME = L.value  
		AND (L.value IN (SELECT Rolename from @RoleNames)))
	
	Group by L.display,CLUB.OrganisationName,LAU.OrganisationName,LAU.OrganisationName,CLUB.OrganisationID,CLUB.Organisationref , Ord.OrderStatus
	order by CLUB.OrganisationName 

END",3
6298703,06/09/2011 20:14:00,791666,06/09/2011 20:14:00,1,0,"max(), group by and order by","I have following SQL statement.
 
        SELECT t.client_id,max(t.points) AS ""max"" FROM sessions GROUP BY t.client_id;
 
It simply lists client id's with maximum amount of points they've achieved. Now I want to sort the results by max(t.points). Normally I would use ORDER BY, but I have no idea how to use it with groups. I know using value from SELECT list is prohibited in following clauses, so adding ORDER BY max at the end of query won't work.

How can I sort those results after grouping, then?

Best regards",sql,postgresql,group-by,order-by,max,,open,0,93,6,"max(), group by and order by I have following SQL statement.
 
        SELECT t.client_id,max(t.points) AS ""max"" FROM sessions GROUP BY t.client_id;
 
It simply lists client id's with maximum amount of points they've achieved. Now I want to sort the results by max(t.points). Normally I would use ORDER BY, but I have no idea how to use it with groups. I know using value from SELECT list is prohibited in following clauses, so adding ORDER BY max at the end of query won't work.

How can I sort those results after grouping, then?

Best regards",5
1124468,07/14/2009 09:58:25,54522,01/13/2009 10:05:29,50,0,SQL - Concatanation of all values in a foreign table to use in the primary table,"I have one table that has sales records and another table that has additional details on each record. What I need to do is build a query that will query the first table and, for each record, list additional details in a virtual column, like this:
""Additional detail #1 for record 1: some additional detail; Additional detail #2 for record 1: more additional details;..."" Basically, this column is a concatenation of all additional field record values.

There is no limit on how many additional details (records in the additional details table) one record from the primary table can have.

Do you have any suggestions on how to do this?",sql,,,,,,open,0,106,16,"SQL - Concatanation of all values in a foreign table to use in the primary table I have one table that has sales records and another table that has additional details on each record. What I need to do is build a query that will query the first table and, for each record, list additional details in a virtual column, like this:
""Additional detail #1 for record 1: some additional detail; Additional detail #2 for record 1: more additional details;..."" Basically, this column is a concatenation of all additional field record values.

There is no limit on how many additional details (records in the additional details table) one record from the primary table can have.

Do you have any suggestions on how to do this?",1
9660291,03/12/2012 00:18:49,1263022,03/12/2012 00:06:24,1,0,MS SQL Server 2008: updating and keeping tracking of anuual price increase,"I have a project right now where it ask me to update the prices on a list of products, the prices for 1/1/2007 to 12/31/2011 is given, i need to increase the price by 5% each year till the end of 2015. Here is what i have, but i getting stuck at updating the prices (5% increase) its telling me its duplicate data. Thanks in advance for any help/hint !


1. Tables:

create table PriceChange

(ProductID INTEGER NOT NULL PRIMARY KEY,

StartDate DATE,

EndingDate DATE,

UnitPrice MONEY,

);


--------

ALTER TABLE PriceChange ADD FOREIGN KEY (ProductID) REFERENCES PRODUCT(ProductID)


----

create table PriceChange_History

(History_ProductID INTEGER NOT NULL PRIMARY KEY,

History_StartDate DATE,

History_EndingDate DATE,

History_UnitPrice MONEY,

Modified_date datetime,

ChangeType varchar(20),

);

------------


ALTER TABLE PriceChange_History ADD FOREIGN KEY (History_ProductID) REFERENCES PRODUCT(ProductID)

--------

2. Triggers

create trigger [insert_history] on PriceChange

for insert

as

insert PriceChange_History (History_ProductID,History_StartDate,History_EndingDate,History_UnitPrice,
                            Modified_date,ChangeType)

select ProductID,StartDate,EndingDate,UnitPrice,GETDATE(),'INSERTED'
from inserted



-------


create trigger [update_history] on PriceChange

for update

as

insert PriceChange_History (History_ProductID,History_StartDate,History_EndingDate,History_UnitPrice,
                            Modified_date,ChangeType)

select ProductID,StartDate,EndingDate,UnitPrice,GETDATE(),'BEFORE UPDATE'
from deleted

insert PriceChange_History (History_ProductID,History_StartDate,History_EndingDate,History_UnitPrice,
                            Modified_date,ChangeType)

select     ProductID,StartDate,EndingDate,UnitPrice,GETDATE(),'AFTER UPDATE'

from inserted
-----

3. INSERT + UPDATE

INSERT INTO PriceChange VALUES(1,'1/1/2007','12/31/2011',500) <---  this will record the query into both pricechange and pricechange history

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2012',EndingDate='12/31/2012' Where ProductID = 1

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2013',EndingDate='12/31/2013' Where ProductID = 1

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2014',EndingDate='12/31/2014' Where ProductID = 1

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2015',EndingDate='12/31/2015' Where ProductID = 1


--------
error message:

Msg 2627, Level 14, State 1, Procedure update_history, Line 9
Violation of PRIMARY KEY constraint 'PK__PriceCha__207F7DE23A81B327'. Cannot insert duplicate key in object 'dbo.PriceChange_History'.



--------
",sql,sql-server,sql-server-2008,,,,open,0,291,12,"MS SQL Server 2008: updating and keeping tracking of anuual price increase I have a project right now where it ask me to update the prices on a list of products, the prices for 1/1/2007 to 12/31/2011 is given, i need to increase the price by 5% each year till the end of 2015. Here is what i have, but i getting stuck at updating the prices (5% increase) its telling me its duplicate data. Thanks in advance for any help/hint !


1. Tables:

create table PriceChange

(ProductID INTEGER NOT NULL PRIMARY KEY,

StartDate DATE,

EndingDate DATE,

UnitPrice MONEY,

);


--------

ALTER TABLE PriceChange ADD FOREIGN KEY (ProductID) REFERENCES PRODUCT(ProductID)


----

create table PriceChange_History

(History_ProductID INTEGER NOT NULL PRIMARY KEY,

History_StartDate DATE,

History_EndingDate DATE,

History_UnitPrice MONEY,

Modified_date datetime,

ChangeType varchar(20),

);

------------


ALTER TABLE PriceChange_History ADD FOREIGN KEY (History_ProductID) REFERENCES PRODUCT(ProductID)

--------

2. Triggers

create trigger [insert_history] on PriceChange

for insert

as

insert PriceChange_History (History_ProductID,History_StartDate,History_EndingDate,History_UnitPrice,
                            Modified_date,ChangeType)

select ProductID,StartDate,EndingDate,UnitPrice,GETDATE(),'INSERTED'
from inserted



-------


create trigger [update_history] on PriceChange

for update

as

insert PriceChange_History (History_ProductID,History_StartDate,History_EndingDate,History_UnitPrice,
                            Modified_date,ChangeType)

select ProductID,StartDate,EndingDate,UnitPrice,GETDATE(),'BEFORE UPDATE'
from deleted

insert PriceChange_History (History_ProductID,History_StartDate,History_EndingDate,History_UnitPrice,
                            Modified_date,ChangeType)

select     ProductID,StartDate,EndingDate,UnitPrice,GETDATE(),'AFTER UPDATE'

from inserted
-----

3. INSERT + UPDATE

INSERT INTO PriceChange VALUES(1,'1/1/2007','12/31/2011',500) <---  this will record the query into both pricechange and pricechange history

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2012',EndingDate='12/31/2012' Where ProductID = 1

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2013',EndingDate='12/31/2013' Where ProductID = 1

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2014',EndingDate='12/31/2014' Where ProductID = 1

UPDATE PriceChange SET UnitPrice=(UnitPrice*1.05),StartDate='1/1/2015',EndingDate='12/31/2015' Where ProductID = 1


--------
error message:

Msg 2627, Level 14, State 1, Procedure update_history, Line 9
Violation of PRIMARY KEY constraint 'PK__PriceCha__207F7DE23A81B327'. Cannot insert duplicate key in object 'dbo.PriceChange_History'.



--------
",3
9911828,03/28/2012 16:28:11,1278192,03/19/2012 09:00:52,101,0,Convert numeric value to uniqueidentifier in sql,"I have one table with auto generate id(identity column) 
I take that value using @@identity.How can convert this to unique identifier????

select @@IDENTITY 
 set @Id = CONVERT(uniqueidentifier, @@IDENTITY ) ",sql,sql-server,,,,03/29/2012 06:07:10,not a real question,1,30,7,"Convert numeric value to uniqueidentifier in sql I have one table with auto generate id(identity column) 
I take that value using @@identity.How can convert this to unique identifier????

select @@IDENTITY 
 set @Id = CONVERT(uniqueidentifier, @@IDENTITY ) ",2
3754474,09/20/2010 18:47:58,387423,07/09/2010 06:02:37,31,2,how to write query to check status is present in list or not?,"
 status = 'Returned','Cancelled','Rejected'

 i pass parameter 'processing' and 'Completed'

   i want to find out 'processing' and 'Completed' is presented in Status group or not.

   if it is presented trun true else false.

  plz help me ....
 

  ",sql,sql-server-2008,,,,,open,0,45,13,"how to write query to check status is present in list or not? 
 status = 'Returned','Cancelled','Rejected'

 i pass parameter 'processing' and 'Completed'

   i want to find out 'processing' and 'Completed' is presented in Status group or not.

   if it is presented trun true else false.

  plz help me ....
 

  ",2
8867518,01/15/2012 04:25:49,1150048,01/15/2012 04:20:18,1,0,SQL: nobel prize table on sqlzoo,"I am learning SQL and do some practice on the internet.

I cannot find the answer for the problem 4a and 4b on http://sqlzoo.net/2b.htm
The table's name is nobel and have 3 colums (yr, subject, winner)

The question is:

Show the years in which three prizes were given for Physics.

Show winners who have won more than once.

Thanks",sql,zoo,,,,01/16/2012 10:37:37,not a real question,1,53,6,"SQL: nobel prize table on sqlzoo I am learning SQL and do some practice on the internet.

I cannot find the answer for the problem 4a and 4b on http://sqlzoo.net/2b.htm
The table's name is nobel and have 3 colums (yr, subject, winner)

The question is:

Show the years in which three prizes were given for Physics.

Show winners who have won more than once.

Thanks",2
7179260,08/24/2011 16:51:35,910048,08/24/2011 16:18:25,1,0,"SQL: how to select a single id (""row"") that meets multiple criteria from a single column","I'm sure this question has been asked before, but I am not thinking of the correct keywords / syntax to be able to search and find the answer.  I apologize in advance for possibly re-asking a question.

I have a very narrow table: user_id, ancestry.

The user_id column is self explanatory.

The ancestry column contains the country from where the user's ancestors hail.

A user can have multiple rows on the table, as a user can have ancestors from multiple countries.

My question is this: how do I select users whose ancestor's hail from multiple, specified countries?

For instance, show me all user's who have ancestor's from England, France and Germany, and return 1 row per user that met that criteria.

What is that SQL?

 user_id     ancestry

---------   ----------

    1        England
    1        Ireland
    2        France
    3        Germany
    3        Poland
    4        England
    4        France
    4        Germany
    5        France
    5        Germany

In the case of the data above, I would expect the result to be ""4"" as user_id 4 has ancestors from England, France and Germany.

Thanks in advance.",sql,select,,,,,open,0,274,16,"SQL: how to select a single id (""row"") that meets multiple criteria from a single column I'm sure this question has been asked before, but I am not thinking of the correct keywords / syntax to be able to search and find the answer.  I apologize in advance for possibly re-asking a question.

I have a very narrow table: user_id, ancestry.

The user_id column is self explanatory.

The ancestry column contains the country from where the user's ancestors hail.

A user can have multiple rows on the table, as a user can have ancestors from multiple countries.

My question is this: how do I select users whose ancestor's hail from multiple, specified countries?

For instance, show me all user's who have ancestor's from England, France and Germany, and return 1 row per user that met that criteria.

What is that SQL?

 user_id     ancestry

---------   ----------

    1        England
    1        Ireland
    2        France
    3        Germany
    3        Poland
    4        England
    4        France
    4        Germany
    5        France
    5        Germany

In the case of the data above, I would expect the result to be ""4"" as user_id 4 has ancestors from England, France and Germany.

Thanks in advance.",2
6244381,06/05/2011 16:55:04,596134,01/30/2011 22:37:51,22,1,Issue with SQL thinking my table name is a full table when I cast or convert it to a string,"So I got a problem looks like with string conversion. I have tried everything under the sun. My goal is to inert the values from the loop into the table. However I can get the field value but I can not get the table name value due to sql thinks I am calling a table rather than a string. I have tried casting converting everything. Here is the code sample:

    DECLARE @C varchar(65)
    DECLARE @FieldName varchar(50)
    SET @FieldName = 'ProjectID'
    SELECT @C = MIN(TABLE_NAME) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'Base Table'
    
    CREATE TABLE #temp_t (
    	[field] varchar(100),
    	[tblname] varchar(100)
    	)
    
    WHILE @C is not null
    	BEGIN
    		DECLARE @qbExists int
    		DECLARE @tblname varchar(100)
    		SET @tblname = CONVERT(varchar(100), @C)
    		SELECT @qbExists = COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @C AND COLUMN_NAME = @FieldName
    		IF @qbExists = 1 AND 
    		   @C <> 'TimeExpenseUnionQuery' AND 
    		   @C <> 'TimeExpense' AND
    		   @C <> 'BC_BA' AND
    		   @C <> 'BC_BE' AND
    		   @C <> 'BC_EL' AND
    		   @C <> 'BC_TE'
    		  BEGIN
    			EXEC('
    				  SELECT ' + @FieldName + ', ' + @C + ' FROM ' + @tblName +'
    				 ')
    		  END
    		
    		SELECT @C = MIN( TABLE_NAME ) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME > @C
    END
    
    SELECT * FROM #temp_t 
    
    DROP TABLE #temp_t
The problem child lies within the SELECT ' + @FieldName + ', ' + @C + ' FROM ' + @tblName.
Now if I do not use the @C it works fine. If I try to CONVERT or CAST the @C I get an invalid column name? What gives?

",sql,sql-server,tsql,,,,open,0,384,20,"Issue with SQL thinking my table name is a full table when I cast or convert it to a string So I got a problem looks like with string conversion. I have tried everything under the sun. My goal is to inert the values from the loop into the table. However I can get the field value but I can not get the table name value due to sql thinks I am calling a table rather than a string. I have tried casting converting everything. Here is the code sample:

    DECLARE @C varchar(65)
    DECLARE @FieldName varchar(50)
    SET @FieldName = 'ProjectID'
    SELECT @C = MIN(TABLE_NAME) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'Base Table'
    
    CREATE TABLE #temp_t (
    	[field] varchar(100),
    	[tblname] varchar(100)
    	)
    
    WHILE @C is not null
    	BEGIN
    		DECLARE @qbExists int
    		DECLARE @tblname varchar(100)
    		SET @tblname = CONVERT(varchar(100), @C)
    		SELECT @qbExists = COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = @C AND COLUMN_NAME = @FieldName
    		IF @qbExists = 1 AND 
    		   @C <> 'TimeExpenseUnionQuery' AND 
    		   @C <> 'TimeExpense' AND
    		   @C <> 'BC_BA' AND
    		   @C <> 'BC_BE' AND
    		   @C <> 'BC_EL' AND
    		   @C <> 'BC_TE'
    		  BEGIN
    			EXEC('
    				  SELECT ' + @FieldName + ', ' + @C + ' FROM ' + @tblName +'
    				 ')
    		  END
    		
    		SELECT @C = MIN( TABLE_NAME ) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME > @C
    END
    
    SELECT * FROM #temp_t 
    
    DROP TABLE #temp_t
The problem child lies within the SELECT ' + @FieldName + ', ' + @C + ' FROM ' + @tblName.
Now if I do not use the @C it works fine. If I try to CONVERT or CAST the @C I get an invalid column name? What gives?

",3
11204709,06/26/2012 09:49:06,358261,06/04/2010 08:47:38,126,0,SQL or NoSQL for survey application tool,"I am designing a survey tool which users can use to build their surveys or polls etc. So a basic survey tool needs to allow users to design a questions , upload files , login , register , share the survey, notify and set activation of survey constraints.

I did some study to take decision to use which kind of database at backend, either sql or nosql. 
I have experience of designing only Relational database so I a unable to take into consideration IF Mongo DB or some other Nosql database will satisfy my Web tool requirements.

Please give me suggestion along with reason how to select database type for my Web tool.

Thanks",sql,mongodb,web,nosql,relational-database,06/26/2012 12:22:00,not constructive,1,111,7,"SQL or NoSQL for survey application tool I am designing a survey tool which users can use to build their surveys or polls etc. So a basic survey tool needs to allow users to design a questions , upload files , login , register , share the survey, notify and set activation of survey constraints.

I did some study to take decision to use which kind of database at backend, either sql or nosql. 
I have experience of designing only Relational database so I a unable to take into consideration IF Mongo DB or some other Nosql database will satisfy my Web tool requirements.

Please give me suggestion along with reason how to select database type for my Web tool.

Thanks",5
11363832,07/06/2012 14:08:08,67249,02/17/2009 07:48:40,1113,57,How do I suppress results from multiple stored procedures,"I have a stored procedure sp_1 that calls another stored procedure sp_1_1.  

I know how to suppress the results from sp_1_1 using [this trick][1].  

The real problem is that sp_1_1 itself also call another stored procedure sp_1_1_1 which ALSO returns it's results to sp_1_1!! I.N.C.E.P.T.I.O.N AARGH!!

I may not change either sp_1_1 or sp_1_1_1, and can only change sp_1.  

The results returned to sp_1 is 2 recordsets, with the first from sp_1_1 and the second from sp_1_1_1.

**SUMMARY:**  

sp_1  (Needs to suppress two recordsets returned from below)

+---- sp_1_1 (returns its own results, then results from below)  

+----------sp_1_1_1  (returns results)




  [1]: http://stackoverflow.com/q/571670/67249",sql,sql-server-2008,suppress,,,,open,0,107,9,"How do I suppress results from multiple stored procedures I have a stored procedure sp_1 that calls another stored procedure sp_1_1.  

I know how to suppress the results from sp_1_1 using [this trick][1].  

The real problem is that sp_1_1 itself also call another stored procedure sp_1_1_1 which ALSO returns it's results to sp_1_1!! I.N.C.E.P.T.I.O.N AARGH!!

I may not change either sp_1_1 or sp_1_1_1, and can only change sp_1.  

The results returned to sp_1 is 2 recordsets, with the first from sp_1_1 and the second from sp_1_1_1.

**SUMMARY:**  

sp_1  (Needs to suppress two recordsets returned from below)

+---- sp_1_1 (returns its own results, then results from below)  

+----------sp_1_1_1  (returns results)




  [1]: http://stackoverflow.com/q/571670/67249",3
4274753,11/25/2010 07:51:57,51109,01/03/2009 06:41:15,22,3,I need a sql query,"Please find the two tables below

TableA

ADq     47             
qww     2.65           
QY     	2.26           
QY     	2.39

My result should be in this way

ADq     47             
qww     2.65           
QY     	0.13

Thanks
Kishh

    ",sql,,,,,11/25/2010 08:01:02,not a real question,1,110,5,"I need a sql query Please find the two tables below

TableA

ADq     47             
qww     2.65           
QY     	2.26           
QY     	2.39

My result should be in this way

ADq     47             
qww     2.65           
QY     	0.13

Thanks
Kishh

    ",1
1696807,11/08/2009 15:05:29,138627,07/15/2009 10:24:43,94,4,Reportins services Timeout expired,"I'm developing a Report Service and while excecuting the query getting :

> An error has occurred during report processing.
Exception has been thrown by the target of an invocation.
Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding.

I know that on the SQL server the query running for a minute ot two.

I setted the Connection string in the web.config like that:

> ""Data Source=servA;Initial
> Catalog=myPortal;Integrated
> Security=True;connection timeout=1000""

It didn't work for me.

 ",sql,sql-server,reporting-services,,,,open,0,78,4,"Reportins services Timeout expired I'm developing a Report Service and while excecuting the query getting :

> An error has occurred during report processing.
Exception has been thrown by the target of an invocation.
Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding.

I know that on the SQL server the query running for a minute ot two.

I setted the Connection string in the web.config like that:

> ""Data Source=servA;Initial
> Catalog=myPortal;Integrated
> Security=True;connection timeout=1000""

It didn't work for me.

 ",3
9559116,03/04/2012 21:47:01,607846,02/08/2011 09:16:51,766,10,Coalesce latest time,"With regard to Sql Server 2005, how do I coalesce this statement with the current time if this select returns null -

    select coelesetop 1 OrderDate as OldestOrderDate from ordersview

OrderDate is of type datettime.",sql,sql-server-2005,,,,,open,0,37,3,"Coalesce latest time With regard to Sql Server 2005, how do I coalesce this statement with the current time if this select returns null -

    select coelesetop 1 OrderDate as OldestOrderDate from ordersview

OrderDate is of type datettime.",2
3559713,08/24/2010 18:24:44,429902,08/24/2010 18:24:44,1,0,Update with a Min in the the table,"I want to update a Column in a Table, based on the minimum of another column of the same table.

eg.

JobPositonId | JobPositonName | JobDescriptionId | ContactId
1            | 1              | 1                | 1
2            | 1              | 1                | 0
3            | 1             | 1                | 0

I want to update ContactId to be 1, if it is 0 and where JobPositionId is the lowest.

Any help will be appreciated

Thanks

Robert ",sql,query,update,min,,,open,0,182,8,"Update with a Min in the the table I want to update a Column in a Table, based on the minimum of another column of the same table.

eg.

JobPositonId | JobPositonName | JobDescriptionId | ContactId
1            | 1              | 1                | 1
2            | 1              | 1                | 0
3            | 1             | 1                | 0

I want to update ContactId to be 1, if it is 0 and where JobPositionId is the lowest.

Any help will be appreciated

Thanks

Robert ",4
5866607,05/03/2011 07:48:17,149199,08/02/2009 05:46:33,94,1,sql performance,"which sql below have better performance, and why?

1. table A(100 rows), table B(1000 rows)
    
   (1)select * from A, B; (2) select * from B, A;
2. 
   (1) select * from T;
   (2) select col1, col2 from T;",sql,,,,,05/03/2011 09:15:35,not a real question,1,47,2,"sql performance which sql below have better performance, and why?

1. table A(100 rows), table B(1000 rows)
    
   (1)select * from A, B; (2) select * from B, A;
2. 
   (1) select * from T;
   (2) select col1, col2 from T;",1
6344950,06/14/2011 14:15:48,196499,10/26/2009 08:41:35,133,9,SQL Query to get aggregated result in comma seperators along with group by column in SQL Server,"I need to write a sql query on the table such that the result would have the group by column along with the aggregated column with comma separators.

My table would be in the below format

       |`````````|````````|
       |    ID   |  Value |
       |_________|________|
       |    1    |   a    |
       |_________|________|
       |    1    |   b    |
       |_________|________|
       |    2    |   c    |
       |_________|________|
Expected result should be in the below format

       |`````````|````````|
       |    ID   |  Value |
       |_________|________|
       |    1    |  a,b   |
       |_________|________|
       |    2    |   c    |
       |_________|________|
",sql,sql-server,,,,,open,0,247,17,"SQL Query to get aggregated result in comma seperators along with group by column in SQL Server I need to write a sql query on the table such that the result would have the group by column along with the aggregated column with comma separators.

My table would be in the below format

       |`````````|````````|
       |    ID   |  Value |
       |_________|________|
       |    1    |   a    |
       |_________|________|
       |    1    |   b    |
       |_________|________|
       |    2    |   c    |
       |_________|________|
Expected result should be in the below format

       |`````````|````````|
       |    ID   |  Value |
       |_________|________|
       |    1    |  a,b   |
       |_________|________|
       |    2    |   c    |
       |_________|________|
",2
2162978,01/29/2010 15:37:14,100516,05/03/2009 22:15:07,1347,92,Why sql-script isn't executed?,"    CREATE TABLE PERMISSIONS(
       ID BIGINT NOT NULL PRIMARY KEY,
       NAME VARCHAR(255) NOT NULL, UNIQUE(ID)
    ) 
    CREATE TABLE ROLES(
       ID BIGINT NOT NULL PRIMARY KEY, 
       NAME VARCHAR(255)
    )

I want to run this in MySql. When I try to execute separately each create-query everything works fine but they don't work together. I thought that separator was missed and tried to put semicolon after each query but MySql says that I have syntax mistake near "";"" . Where is the mistake?",sql,ddl,mysql,,,,open,0,117,4,"Why sql-script isn't executed?     CREATE TABLE PERMISSIONS(
       ID BIGINT NOT NULL PRIMARY KEY,
       NAME VARCHAR(255) NOT NULL, UNIQUE(ID)
    ) 
    CREATE TABLE ROLES(
       ID BIGINT NOT NULL PRIMARY KEY, 
       NAME VARCHAR(255)
    )

I want to run this in MySql. When I try to execute separately each create-query everything works fine but they don't work together. I thought that separator was missed and tried to put semicolon after each query but MySql says that I have syntax mistake near "";"" . Where is the mistake?",3
6310839,06/10/2011 18:54:33,393077,07/15/2010 18:18:57,3851,158,SQL Group By including empty rows,"For the sake of this question, let's suppose this table structure:

    People:
    PersonID int PK
    Name varchar(50)
    Place int NULL FK -> Places.PlaceID
    MovedIn datetime

    Places:
    PlaceID int PK
    Name varchar(50)

I want to determine how many people live at each place:

    SELECT pla.PlaceID, COUNT(*)
    FROM Places AS pla
    LEFT JOIN People as peo ON peo.PlaceID = pla.PlaceID

This query will omit places that have no people living there. Is there any way to make it count 0 instead?

(I'm targetting SQL Server 2005, in the off chance that it matters)",sql,sql-server,group-by,,,,open,0,121,6,"SQL Group By including empty rows For the sake of this question, let's suppose this table structure:

    People:
    PersonID int PK
    Name varchar(50)
    Place int NULL FK -> Places.PlaceID
    MovedIn datetime

    Places:
    PlaceID int PK
    Name varchar(50)

I want to determine how many people live at each place:

    SELECT pla.PlaceID, COUNT(*)
    FROM Places AS pla
    LEFT JOIN People as peo ON peo.PlaceID = pla.PlaceID

This query will omit places that have no people living there. Is there any way to make it count 0 instead?

(I'm targetting SQL Server 2005, in the off chance that it matters)",3
7166103,08/23/2011 18:57:01,577979,01/17/2011 02:06:29,116,11,SQL CONTAINS or FREETEXT,"Im trying to use either CONTAINS or FREETEXT in SQL programing to be able to search couple words all at the same time. The issue is when you search couple words FREETEXT or CONTAINS will search by column not by row for example:  
Imagine this is my database

    id        | c1      | c2 
    ===============================
    a         | 1       | 2     
    b         | 1       | 3     
    c         | 1       | 2     
    d         | 2       | 2     
    e         | 3       | 3     
    f         | 2       | 1 

When you search `CONTAINS(*, '1,2')` OR off curse `FREETEXT(*, '1 2')` it will return  

    id        | c1      | c2 
    ===============================
    a         | 1       | 2     
    b         | 1       | 3     
    c         | 1       | 1     
    d         | 2       | 2     
    e         | 2       | 3     
    f         | 2       | 1 

Which is basically entire database. But what I wanted was this  

    id        | c1      | c2 
    ===============================
    a         | 1       | 2     
    f         | 2       | 1 

Which is the rows that contains 1 and 2 combine.  

By the way I'm using SQL 2008 and ASP classic.

I would really appreciate for your suggestion.",sql,sql-server-2008,asp,,,,open,0,543,4,"SQL CONTAINS or FREETEXT Im trying to use either CONTAINS or FREETEXT in SQL programing to be able to search couple words all at the same time. The issue is when you search couple words FREETEXT or CONTAINS will search by column not by row for example:  
Imagine this is my database

    id        | c1      | c2 
    ===============================
    a         | 1       | 2     
    b         | 1       | 3     
    c         | 1       | 2     
    d         | 2       | 2     
    e         | 3       | 3     
    f         | 2       | 1 

When you search `CONTAINS(*, '1,2')` OR off curse `FREETEXT(*, '1 2')` it will return  

    id        | c1      | c2 
    ===============================
    a         | 1       | 2     
    b         | 1       | 3     
    c         | 1       | 1     
    d         | 2       | 2     
    e         | 2       | 3     
    f         | 2       | 1 

Which is basically entire database. But what I wanted was this  

    id        | c1      | c2 
    ===============================
    a         | 1       | 2     
    f         | 2       | 1 

Which is the rows that contains 1 and 2 combine.  

By the way I'm using SQL 2008 and ASP classic.

I would really appreciate for your suggestion.",3
9318985,02/16/2012 21:01:15,1214744,02/16/2012 20:10:50,1,0,"Multiple totals,total, subtotals for different conditions grouP WISE in one query","i want the count for THREE DIFFERENT GROUP(SAY THREE MONTHS,JANUARY, FEB,MARCH), WHILE I SHOULD GET COUNT FOR THE SAME DIFFERENT GROUPS,THE SALES DONE ONLY BY JHON (jhON AND ROBERT ARE THE ONLY TWO SALESMAN),


LET THE TABLE BE LIKE THIS

  UNIQUEACCOUNTNO  CUSTOMERNAME CUSTOMERTYPE 

   CUSTOMERTYPE TOTALPEOPLE   BALANCEGREATERTHANZEROPEOPLE    BALANCEEQUALSZEROPEOPLE
   LT1           2            1                                1
   LT2           1            1                                0
   LT3           0            0                                0     
      ",sql,,,,,02/16/2012 21:23:16,not a real question,1,241,11,"Multiple totals,total, subtotals for different conditions grouP WISE in one query i want the count for THREE DIFFERENT GROUP(SAY THREE MONTHS,JANUARY, FEB,MARCH), WHILE I SHOULD GET COUNT FOR THE SAME DIFFERENT GROUPS,THE SALES DONE ONLY BY JHON (jhON AND ROBERT ARE THE ONLY TWO SALESMAN),


LET THE TABLE BE LIKE THIS

  UNIQUEACCOUNTNO  CUSTOMERNAME CUSTOMERTYPE 

   CUSTOMERTYPE TOTALPEOPLE   BALANCEGREATERTHANZEROPEOPLE    BALANCEEQUALSZEROPEOPLE
   LT1           2            1                                1
   LT2           1            1                                0
   LT3           0            0                                0     
      ",1
2211766,02/06/2010 02:32:59,3085,08/26/2008 15:02:28,515,15,"How to delete a ""tree"" of data from sql?","I have a table structure similar to:

    Portfolios
      Properties
       Units
        Leases

All tables are setup with foreign key relationships and cascade deletes.  I want to be able to delete a portfolio, which would in turn delete all properties assigned to that portfolio, all units assigned to those properties, and all leases assigned to those units. 

I'm getting errors similar to:

    The DELETE statement conflicted with the REFERENCE constraint ""FK_Leases_Units"". The conflict occurred in database ""MyDb"", table ""Leases"", column 'UnitId'.

What is the proper way to delete a ""tree"" of data like this?

If it matters, I'm using MS SQL Server 2008.",sql,sql-server,,,,,open,0,123,9,"How to delete a ""tree"" of data from sql? I have a table structure similar to:

    Portfolios
      Properties
       Units
        Leases

All tables are setup with foreign key relationships and cascade deletes.  I want to be able to delete a portfolio, which would in turn delete all properties assigned to that portfolio, all units assigned to those properties, and all leases assigned to those units. 

I'm getting errors similar to:

    The DELETE statement conflicted with the REFERENCE constraint ""FK_Leases_Units"". The conflict occurred in database ""MyDb"", table ""Leases"", column 'UnitId'.

What is the proper way to delete a ""tree"" of data like this?

If it matters, I'm using MS SQL Server 2008.",2
3019073,06/10/2010 22:43:55,364028,06/10/2010 22:14:40,1,0,How to select first entry of the day grouped by user in SQL,"I've looked around and can't quite grasp the whole answer to this SQL query question needed to extract data from an MS Access 2000 table.



Here's an example of what the table [Time Sub] looks like:

**CLIENT_ID, DATE_ENTERED, CODE, MINUTES**  
11111, 5/12/2008 3:50:52 PM, M, 38  
11111, 5/12/2008 2:55:50 PM, M, 2  
11714, 5/13/2008 1:15:32 PM, M, 28  
11111, 5/13/2008 6:15:12 PM, W, 11  
11112, 5/12/2008 2:50:52 PM, M, 89  
11112, 5/12/2008 5:10:52 PM, M, 9  
91112, 5/14/2008 1:10:52 PM, L, 96
11112, 5/12/2008 5:11:52 PM, M, 12

I need to select the first entry of each day per client that's NOT code L or W.  

I know this can be done in a SQL statement, but I just can't figure out how.  I can get close, but never come up with the right output.

Any help is appreciated.

Thanks,
Mike
   
",sql,ms-access,select,statement,,,open,0,146,13,"How to select first entry of the day grouped by user in SQL I've looked around and can't quite grasp the whole answer to this SQL query question needed to extract data from an MS Access 2000 table.



Here's an example of what the table [Time Sub] looks like:

**CLIENT_ID, DATE_ENTERED, CODE, MINUTES**  
11111, 5/12/2008 3:50:52 PM, M, 38  
11111, 5/12/2008 2:55:50 PM, M, 2  
11714, 5/13/2008 1:15:32 PM, M, 28  
11111, 5/13/2008 6:15:12 PM, W, 11  
11112, 5/12/2008 2:50:52 PM, M, 89  
11112, 5/12/2008 5:10:52 PM, M, 9  
91112, 5/14/2008 1:10:52 PM, L, 96
11112, 5/12/2008 5:11:52 PM, M, 12

I need to select the first entry of each day per client that's NOT code L or W.  

I know this can be done in a SQL statement, but I just can't figure out how.  I can get close, but never come up with the right output.

Any help is appreciated.

Thanks,
Mike
   
",4
37640,09/01/2008 09:04:42,3742,08/30/2008 14:08:11,1,2,Best GUI tool for documenting a SQL Server DB,What tool(s) do you use to generate documentation for a database (preferably into a .chm help file)?,sql,documentation,,,,,open,0,17,9,Best GUI tool for documenting a SQL Server DB What tool(s) do you use to generate documentation for a database (preferably into a .chm help file)?,2
270325,11/06/2008 21:20:55,20178,09/22/2008 03:00:27,2163,86,How to Write a Query to Merge Two Accounts and their Activity Logs into One?,"We frequently have users that create multiple accounts and then end up storing the same lesson activity data more than once. Once they realize the error, then they contact us to merge the accounts into a single one that they can use. 

I've been beating myself to death trying to figure out how to write a query in MySQL that will merge their activity logs into a single profile so that I can then delete the other profiles, but I still can't find the query that will work.

The tables look like this:

	CREATE TABLE user_rtab (
		user_id int PRIMARY KEY,
		username varchar,
		last_name varchar,
		first_name varchar
	);

	CREATE TABLE lessonstatus_rtab (
		lesson_id int,
		user_id int,
		accessdate timestamp,
		score double,
	);

What happens is that a user ends up taking the same lessons and also different lessons under two or more accounts and then they want to take all of their lesson statuses and have them assigned under one user account.

Can anyone provide a query that would accomplish this based on the lastname and firstname fields from the user table to determine all user accounts and then use only the user or username field to migrate all necessary statuses to the one single account?",sql,mysql,query,,,11/06/2008 21:44:17,off topic,1,190,15,"How to Write a Query to Merge Two Accounts and their Activity Logs into One? We frequently have users that create multiple accounts and then end up storing the same lesson activity data more than once. Once they realize the error, then they contact us to merge the accounts into a single one that they can use. 

I've been beating myself to death trying to figure out how to write a query in MySQL that will merge their activity logs into a single profile so that I can then delete the other profiles, but I still can't find the query that will work.

The tables look like this:

	CREATE TABLE user_rtab (
		user_id int PRIMARY KEY,
		username varchar,
		last_name varchar,
		first_name varchar
	);

	CREATE TABLE lessonstatus_rtab (
		lesson_id int,
		user_id int,
		accessdate timestamp,
		score double,
	);

What happens is that a user ends up taking the same lessons and also different lessons under two or more accounts and then they want to take all of their lesson statuses and have them assigned under one user account.

Can anyone provide a query that would accomplish this based on the lastname and firstname fields from the user table to determine all user accounts and then use only the user or username field to migrate all necessary statuses to the one single account?",3
10087098,04/10/2012 10:33:21,1193202,02/06/2012 20:07:09,3,1,SQL filtering syntax,"I have table ""TableA"" which contain several data, I need run query which sort out items which have EAN prefix 423 *and* with price higher 100.

What would be correct query for this case?

Another table is ""TableB"", where I need match all items that have prefix 406 in column ""EAN"", have any values in column ""DPA"", have names ""toro"" or ""nevo"" in column ""Description"", have any values in column ""EAN"". I.e. list all items that match any of these criteria.

Can someone specify a proper SQL syntax for queries?






 ",sql,excel,,,,,open,0,88,3,"SQL filtering syntax I have table ""TableA"" which contain several data, I need run query which sort out items which have EAN prefix 423 *and* with price higher 100.

What would be correct query for this case?

Another table is ""TableB"", where I need match all items that have prefix 406 in column ""EAN"", have any values in column ""DPA"", have names ""toro"" or ""nevo"" in column ""Description"", have any values in column ""EAN"". I.e. list all items that match any of these criteria.

Can someone specify a proper SQL syntax for queries?






 ",2
7887827,10/25/2011 10:21:50,998616,10/17/2011 06:15:51,1,0,sql 2008 r2 query error: Incorrect syntax near ':',"i have a problem with a certain query given to me and i dont know how to solve that problem.. here is the query..

      SELECT dcm.code DCM_No, 
             dcm.datetime_created DCM_Date,  
             lne.seq_number,
             par.code,
             par.description particular,
             ft.description fee_type,
    	 lne.amount, 
             case when lne.drcr =1 then 'Debit' else 'Credit' end DrCr,  
     
             case when isnull(dcm.is_sd,'N') = 'Y' then 'Salary Deduction' else null end is_sd,   
             org.description Company,
             org.postal_address company_addr,
             'S.Y. ' + substring(sy.school_year,1,4)+'-'+substring(sy.school_year,5,4) +' '+sem.description SY,
             entity_a.code + ' - ' + coalesce(entity_a.stud_lname,'') +', '+coalesce(entity_a.stud_fname,'') +' '+coalesce(entity_a.stud_mname,'') Student,
    
    	 case when   isnull(dm.description2,'') = '' then 
                  crs.course_short_name + '-'+convert(char(1),entity_a.stud_grade)
    		else    crs2.course_short_name + '-'+convert(char(1),reg.stud_grade) end as Course,
             isnull(dm.description2,'Not Enrolled')
    
        FROM  es.lib_rgn_students entity_a
    	    left join  ars.ars_dcm dcm on dcm.entity_id = entity_a.id
             LEFT JOIN afs.entity entity_b ON dcm.prepared_by_id = entity_b.id 
             LEFT JOIN ua.user_account ON dcm.prepared_by_id = ua.user_account.id
             left join ars.ars_dcm_line lne on lne.ars_dcm_id = dcm.id
             left join es.lib_fin_fees_master par on par.id = lne.ars_particular_id
             left join es.lib_fin_feetype ft on ft.code = lne.fee_code
    	    left join es.stp_sysem sy on sy.id = dcm.period_id
             inner join es.stp_semesterms sem on sem.code = sy.semester and sem.trimester = 0
             inner join afs.organization org on org.id = sy.company_id
             inner join es.lib_crs crs on crs.id = entity_a.course_id
             left join es.trn_rgn_reg_hdr reg on reg.period = sy.id and reg.stud_id = :as_studid
             left join document_status_map dm on dm.code = reg.document_status
             left join es.lib_crs crs2 on crs2.id = reg.course_id
    
       WHERE 
             (dcm.entity_id = :as_studid ) AND  
             ( dcm.period_id = :as_period ) AND  
             ( dcm.document_status_code not in(2,3) )    

and i have this error:


Incorrect syntax near ':'.


pls help i am not good with this :(

thanks!",sql,sql-server-2008,query,,,10/25/2011 22:17:13,too localized,1,661,9,"sql 2008 r2 query error: Incorrect syntax near ':' i have a problem with a certain query given to me and i dont know how to solve that problem.. here is the query..

      SELECT dcm.code DCM_No, 
             dcm.datetime_created DCM_Date,  
             lne.seq_number,
             par.code,
             par.description particular,
             ft.description fee_type,
    	 lne.amount, 
             case when lne.drcr =1 then 'Debit' else 'Credit' end DrCr,  
     
             case when isnull(dcm.is_sd,'N') = 'Y' then 'Salary Deduction' else null end is_sd,   
             org.description Company,
             org.postal_address company_addr,
             'S.Y. ' + substring(sy.school_year,1,4)+'-'+substring(sy.school_year,5,4) +' '+sem.description SY,
             entity_a.code + ' - ' + coalesce(entity_a.stud_lname,'') +', '+coalesce(entity_a.stud_fname,'') +' '+coalesce(entity_a.stud_mname,'') Student,
    
    	 case when   isnull(dm.description2,'') = '' then 
                  crs.course_short_name + '-'+convert(char(1),entity_a.stud_grade)
    		else    crs2.course_short_name + '-'+convert(char(1),reg.stud_grade) end as Course,
             isnull(dm.description2,'Not Enrolled')
    
        FROM  es.lib_rgn_students entity_a
    	    left join  ars.ars_dcm dcm on dcm.entity_id = entity_a.id
             LEFT JOIN afs.entity entity_b ON dcm.prepared_by_id = entity_b.id 
             LEFT JOIN ua.user_account ON dcm.prepared_by_id = ua.user_account.id
             left join ars.ars_dcm_line lne on lne.ars_dcm_id = dcm.id
             left join es.lib_fin_fees_master par on par.id = lne.ars_particular_id
             left join es.lib_fin_feetype ft on ft.code = lne.fee_code
    	    left join es.stp_sysem sy on sy.id = dcm.period_id
             inner join es.stp_semesterms sem on sem.code = sy.semester and sem.trimester = 0
             inner join afs.organization org on org.id = sy.company_id
             inner join es.lib_crs crs on crs.id = entity_a.course_id
             left join es.trn_rgn_reg_hdr reg on reg.period = sy.id and reg.stud_id = :as_studid
             left join document_status_map dm on dm.code = reg.document_status
             left join es.lib_crs crs2 on crs2.id = reg.course_id
    
       WHERE 
             (dcm.entity_id = :as_studid ) AND  
             ( dcm.period_id = :as_period ) AND  
             ( dcm.document_status_code not in(2,3) )    

and i have this error:


Incorrect syntax near ':'.


pls help i am not good with this :(

thanks!",3
6786052,07/22/2011 05:34:01,855281,07/21/2011 06:02:55,1,0,"how can i select 1,4,7,10,13,... numbered records from table","     ID NAME                        AGE     DEPTNO     SALARY
------- -------------------- ---------- ---------- ----------
      1 shasank                      25         11       2025
      2 raju                         27         12       2027
      3 son                          33         12       2131
      6 bali                         31         10       2031
      4 don                          33         11       2132
      5 rambo                        32         11       2121
      7 dimpu                        33         12       2314
      8 chir                         34         10       2123
      9 nag                          35         10       2213
     10 ram                          28         13       2141
",sql,,,,,07/22/2011 13:05:20,not a real question,1,523,9,"how can i select 1,4,7,10,13,... numbered records from table      ID NAME                        AGE     DEPTNO     SALARY
------- -------------------- ---------- ---------- ----------
      1 shasank                      25         11       2025
      2 raju                         27         12       2027
      3 son                          33         12       2131
      6 bali                         31         10       2031
      4 don                          33         11       2132
      5 rambo                        32         11       2121
      7 dimpu                        33         12       2314
      8 chir                         34         10       2123
      9 nag                          35         10       2213
     10 ram                          28         13       2141
",1
2758649,05/03/2010 14:15:50,323926,04/23/2010 05:55:05,1,0,Icannot create a table. I get this message: ERROR 1064 (42000): You have an error in your SQL syntax,"I'm trying to execute this simple command:

    create table foo
    (clo int primary key unsigned auto_increment);

But I get this error:

> ERROR 1064 (42000): You have an error
> in your SQL syntax; check the manual
> that corresponds to your MySQL server
> version for the right syntax to use
> near 'unsigned auto_increment)' at
> line 2",sql,mysql,mysql-error-1064,,,,open,0,59,19,"Icannot create a table. I get this message: ERROR 1064 (42000): You have an error in your SQL syntax I'm trying to execute this simple command:

    create table foo
    (clo int primary key unsigned auto_increment);

But I get this error:

> ERROR 1064 (42000): You have an error
> in your SQL syntax; check the manual
> that corresponds to your MySQL server
> version for the right syntax to use
> near 'unsigned auto_increment)' at
> line 2",3
3871432,10/06/2010 10:11:45,16989,09/17/2008 23:43:12,1836,63,T-SQL Reverse Pivot on every character of a string,"We have a table like below in an sql server 2005 db:

    event_id   staff_id   weeks

    1          1          NNNYYYYNNYYY
    1          2          YYYNNNYYYNNN
    2          1          YYYYYYYYNYYY

This is from a piece of timetabling software and is basically saying which staff members are assigned to an event (register) and the set of weeks they are teaching that register. So staff_id 1 isn't teaching the first 3 weeks of event 1 but is teaching the following 4....

Is there an easy way to convert that to an easier form such as:

    event_id   staff_id   week
    1          1          4
    1          1          5
    1          1          6
    1          1          7
    1          1          10
    1          1          11
    1          1          12
    1          2          1
    1          2          2
    1          2          3
    1          2          7
    1          2          8
    1          2          9
    2          1          1
    2          1          2
    2          1          3
    2          1          4
    2          1          5
    2          1          6
    2          1          7
    2          1          8
    2          1          10
    2          1          11
    2          1          12


",sql,sql-server,sql-server-2005,tsql,,,open,0,741,9,"T-SQL Reverse Pivot on every character of a string We have a table like below in an sql server 2005 db:

    event_id   staff_id   weeks

    1          1          NNNYYYYNNYYY
    1          2          YYYNNNYYYNNN
    2          1          YYYYYYYYNYYY

This is from a piece of timetabling software and is basically saying which staff members are assigned to an event (register) and the set of weeks they are teaching that register. So staff_id 1 isn't teaching the first 3 weeks of event 1 but is teaching the following 4....

Is there an easy way to convert that to an easier form such as:

    event_id   staff_id   week
    1          1          4
    1          1          5
    1          1          6
    1          1          7
    1          1          10
    1          1          11
    1          1          12
    1          2          1
    1          2          2
    1          2          3
    1          2          7
    1          2          8
    1          2          9
    2          1          1
    2          1          2
    2          1          3
    2          1          4
    2          1          5
    2          1          6
    2          1          7
    2          1          8
    2          1          10
    2          1          11
    2          1          12


",4
1709206,11/10/2009 16:24:01,58279,01/23/2009 12:34:19,53,2,Updating Order field in SQL,"We're required to add Ordering to our EventVenue table, which we've done by adding an int field to store the EventVenue's placing in the order. The ordering is based upon the parent Event's ID and the Event's VenueGrouping.

If the VenueGrouping is false the EventVenues will be ordered sequentially. However, if true, the EventVenues for the same Event and derived from the same parent Event will have the same ordering. For example [assuming we've filtered by Event]:

    EVID | VenueID | Not Grouped | Grouped
      1  |    1    |      1      |   1
      2  |    2    |      2      |   2
      3  |    2    |      3      |   2
      4  |    3    |      4      |   3

The problem is when the grouping is changed. I need some SQL to update the Event's Venue Ordering appropriately but am finding it tricky to get my head round it, especially when going from ungrouped to grouped without leaving gaps.

I'd presume it needs to be in an if statement like below, but if a more efficient/DRY solution is suitable, all the better: 

    -- Changing from Ungrouped to Grouped
    IF @OldGrouping=0 AND @NewGrouping=1
       BEGIN
          UPDATE EventVenues SET Ordering=...
       END
    -- Changing from Grouped to Ungrouped
    ELSE IF @OldGrouping=1 AND @NewGrouping=0
       BEGIN
          UPDATE EventVenues SET Ordering=...
       END

Any help appreciated.",sql,mssql,tsql,update,ordering,,open,0,362,5,"Updating Order field in SQL We're required to add Ordering to our EventVenue table, which we've done by adding an int field to store the EventVenue's placing in the order. The ordering is based upon the parent Event's ID and the Event's VenueGrouping.

If the VenueGrouping is false the EventVenues will be ordered sequentially. However, if true, the EventVenues for the same Event and derived from the same parent Event will have the same ordering. For example [assuming we've filtered by Event]:

    EVID | VenueID | Not Grouped | Grouped
      1  |    1    |      1      |   1
      2  |    2    |      2      |   2
      3  |    2    |      3      |   2
      4  |    3    |      4      |   3

The problem is when the grouping is changed. I need some SQL to update the Event's Venue Ordering appropriately but am finding it tricky to get my head round it, especially when going from ungrouped to grouped without leaving gaps.

I'd presume it needs to be in an if statement like below, but if a more efficient/DRY solution is suitable, all the better: 

    -- Changing from Ungrouped to Grouped
    IF @OldGrouping=0 AND @NewGrouping=1
       BEGIN
          UPDATE EventVenues SET Ordering=...
       END
    -- Changing from Grouped to Ungrouped
    ELSE IF @OldGrouping=1 AND @NewGrouping=0
       BEGIN
          UPDATE EventVenues SET Ordering=...
       END

Any help appreciated.",5
5597164,04/08/2011 15:17:40,300485,03/24/2010 03:31:41,33,0,How to Write the SQL Query,"I have a table in my Database with Three columns,

one is  Code, Description, days

data will be:    2 , Years, 730
                 1 , Years ,365

Recently I added days column to calculate number of days per year.

Can any body tel me the query how to write the query to check 

Description as Years and and convert that Code in to Number of days

2*365 in Days Coulumn..

Thanks",sql,sql-server-2008,,,,04/09/2011 07:06:57,not a real question,1,84,6,"How to Write the SQL Query I have a table in my Database with Three columns,

one is  Code, Description, days

data will be:    2 , Years, 730
                 1 , Years ,365

Recently I added days column to calculate number of days per year.

Can any body tel me the query how to write the query to check 

Description as Years and and convert that Code in to Number of days

2*365 in Days Coulumn..

Thanks",2
7798318,10/17/2011 19:08:21,996554,10/15/2011 06:20:09,1,0,how to get common data based on two other field,"I have a table with two name. NAME1 and NAME2 as author of a book
how can I get their common author names ?

For example

I have 

John Marry 

John Paul 

John Nancy

John Alex

Paul Marry

Nancy Marry


I'm looking to get John Marry 2 


",sql,,,,,10/19/2011 15:46:19,not a real question,1,41,10,"how to get common data based on two other field I have a table with two name. NAME1 and NAME2 as author of a book
how can I get their common author names ?

For example

I have 

John Marry 

John Paul 

John Nancy

John Alex

Paul Marry

Nancy Marry


I'm looking to get John Marry 2 


",1
10858844,06/02/2012 00:22:43,1204749,02/12/2012 05:57:33,30,3,Creating DDL scripts from JPA/Hibernate Annotation Classes Using ANT,"I would like to generate SQL DDL scripts from Hibernate/JPA Annotation Classes using ANT.

Below is the ANT script that I wrote based on Hibernate Dev Docs URL: http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/

    <?xml version=""1.0"" encoding=""UTF-8""?>
    <project name=""changeme"" default=""all"" basedir=""."">
    <target name=""ddl_generation"">
     <!-- paths to required jars  -->
    <path location=""web/WEB-INF/lib/hibernate-annotations.jar"" />
    <path location=""web/WEB-INF/lib/ejb3-persistence.jar"" />
    <path location=""web/WEB-INF/lib/hibernate-entitymanager.jar"" />
    <path location=""web/WEB-INF/lib/javaassist.jar"" />
    <path location=""web/WEB-INF/lib/hibernate-tools.jar"" id=""hibernate-tools""/>
    
    <taskdef name=""hibernatetool"" classname=""org.hibernate.tool.ant.HibernateToolTask"" >
           <classpath path=""${build.dir}/web/WEB-INF/lib""/>
        </taskdef>
    <hibernatetool destdir=""${build.dir}"">
        <!-- were the annotation beans files are located-->
    <classpath>
    <path location=""${build.dir}/web/WEB-INF/classes/com/yourmarketnet/beans"" />
    </classpath>
    <!-- list exporters here -->
    <hbm2ddl
    export=""false""
    update=""false""
    drop=""true""
    create=""true""
    outputfilename=""myApps.ddl""
    delimiter="";""
    format=""false""
    haltonerror=""true""/>
    </hibernatetool>
    </target>
    </project>

Im getting ERROR taskdef class org.hibernate.tool.ant.HibernateToolTask cannot be found
 using the classloader AntClassLoader[]",sql,hibernate,java-ee,orm,ant,,open,0,220,9,"Creating DDL scripts from JPA/Hibernate Annotation Classes Using ANT I would like to generate SQL DDL scripts from Hibernate/JPA Annotation Classes using ANT.

Below is the ANT script that I wrote based on Hibernate Dev Docs URL: http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/

    <?xml version=""1.0"" encoding=""UTF-8""?>
    <project name=""changeme"" default=""all"" basedir=""."">
    <target name=""ddl_generation"">
     <!-- paths to required jars  -->
    <path location=""web/WEB-INF/lib/hibernate-annotations.jar"" />
    <path location=""web/WEB-INF/lib/ejb3-persistence.jar"" />
    <path location=""web/WEB-INF/lib/hibernate-entitymanager.jar"" />
    <path location=""web/WEB-INF/lib/javaassist.jar"" />
    <path location=""web/WEB-INF/lib/hibernate-tools.jar"" id=""hibernate-tools""/>
    
    <taskdef name=""hibernatetool"" classname=""org.hibernate.tool.ant.HibernateToolTask"" >
           <classpath path=""${build.dir}/web/WEB-INF/lib""/>
        </taskdef>
    <hibernatetool destdir=""${build.dir}"">
        <!-- were the annotation beans files are located-->
    <classpath>
    <path location=""${build.dir}/web/WEB-INF/classes/com/yourmarketnet/beans"" />
    </classpath>
    <!-- list exporters here -->
    <hbm2ddl
    export=""false""
    update=""false""
    drop=""true""
    create=""true""
    outputfilename=""myApps.ddl""
    delimiter="";""
    format=""false""
    haltonerror=""true""/>
    </hibernatetool>
    </target>
    </project>

Im getting ERROR taskdef class org.hibernate.tool.ant.HibernateToolTask cannot be found
 using the classloader AntClassLoader[]",5
209615,10/16/2008 17:58:50,16631,09/17/2008 19:15:20,11,4,Query a single value from a column that pulls multiple values,"Using the following query:

    
        SELECT pe.prodtree_element_name_l, MAX(rs.resource_value) AS resource_value
        FROM prodtree_element pe
        LEFT JOIN resource_shortstrings rs
            ON pe.prodtree_element_name_l_rk = rs.resource_key
        WHERE rs.language_id = '5'
            AND pe.prodtree_element_name_l <> ''
        GROUP BY prodtree_element_name_l
    

I'm trying to figure out how to grab ANY of the ""resource_value"".  The problem being that while this works for a number of other queries, I have one particular table that uses ntext datatypes instead of varchars (which can utilize the MAX function).  So basically, MAX doesn't work here.  Is there a substitute I can use on MS SQL Server 2005?

I need the prodtree_element_name_l column grouped, but I only need one value from the resource_value column, and I don't care what it is as most of them are identical regardless (although some are not, hence I can't group that one as well).",sql,function,,,,,open,0,200,11,"Query a single value from a column that pulls multiple values Using the following query:

    
        SELECT pe.prodtree_element_name_l, MAX(rs.resource_value) AS resource_value
        FROM prodtree_element pe
        LEFT JOIN resource_shortstrings rs
            ON pe.prodtree_element_name_l_rk = rs.resource_key
        WHERE rs.language_id = '5'
            AND pe.prodtree_element_name_l <> ''
        GROUP BY prodtree_element_name_l
    

I'm trying to figure out how to grab ANY of the ""resource_value"".  The problem being that while this works for a number of other queries, I have one particular table that uses ntext datatypes instead of varchars (which can utilize the MAX function).  So basically, MAX doesn't work here.  Is there a substitute I can use on MS SQL Server 2005?

I need the prodtree_element_name_l column grouped, but I only need one value from the resource_value column, and I don't care what it is as most of them are identical regardless (although some are not, hence I can't group that one as well).",2
5012940,02/16/2011 05:47:54,619074,02/16/2011 05:34:15,1,0,Sql String Function,"Need help to do a simple task in sql string
       in my table there is a field comment(user comments).
 in my procedure i am passing a paremeter @input ,i want to check whether the string contains the string @input and if it contains add some style to the substring(that same as @input).

eg: if the Comment string like - ""i have added the user Test user""  and 
    @input - ""tes""
   i want the output as ""i have added the user <span style=""color:red"">Tes</span>t user""

plese help
Thanks in Advance",sql,,,,,,open,0,98,3,"Sql String Function Need help to do a simple task in sql string
       in my table there is a field comment(user comments).
 in my procedure i am passing a paremeter @input ,i want to check whether the string contains the string @input and if it contains add some style to the substring(that same as @input).

eg: if the Comment string like - ""i have added the user Test user""  and 
    @input - ""tes""
   i want the output as ""i have added the user <span style=""color:red"">Tes</span>t user""

plese help
Thanks in Advance",1
9820187,03/22/2012 10:13:24,1285525,03/22/2012 09:39:45,1,0,student registration by using Data warehousing with ms sql 2010,"I hear a lot about this site,

First i wanna thank you all for your help

I am a student in a computer Information system,
I have a project and I need to complete it in 2 weeks

student registration by using Data warehousing with ms sql 2010.

Where should I start from? and what is the programs should I install in my laptop windows  
    ",sql,,,,,03/23/2012 19:54:31,not constructive,1,66,10,"student registration by using Data warehousing with ms sql 2010 I hear a lot about this site,

First i wanna thank you all for your help

I am a student in a computer Information system,
I have a project and I need to complete it in 2 weeks

student registration by using Data warehousing with ms sql 2010.

Where should I start from? and what is the programs should I install in my laptop windows  
    ",1
32000,08/28/2008 10:37:39,1344,08/14/2008 16:03:00,1319,98,C# - SQLClient - Simplest INSERT,"Before someone gets in a tizzy because this was answered elsewhere (not sure if it was,but...), the 5 ""related questions"" shown right now do not match what I'm looking for, and I searched the string ""sql insert"" and did not find quite what I was looking for.

So I'm basically trying to figure out the simplest way to perform your basic insert operation in C#.NET using the SqlClient namespace. I'm using SqlConnection for my db link, I've already had success executing some reads, and I want to know the simplest way to insert data. I'm finding what seem to be pretty verbose methods when I google.",sql,t-sql,query,sql-server,c#,,open,0,105,6,"C# - SQLClient - Simplest INSERT Before someone gets in a tizzy because this was answered elsewhere (not sure if it was,but...), the 5 ""related questions"" shown right now do not match what I'm looking for, and I searched the string ""sql insert"" and did not find quite what I was looking for.

So I'm basically trying to figure out the simplest way to perform your basic insert operation in C#.NET using the SqlClient namespace. I'm using SqlConnection for my db link, I've already had success executing some reads, and I want to know the simplest way to insert data. I'm finding what seem to be pretty verbose methods when I google.",5
3055170,06/16/2010 16:16:04,208066,11/10/2009 18:56:35,1203,30,"Is it appropriate to raise exceptions in stored procedures that wrap around CRUD operations, when the number of rows affected != 1?","This is a pretty specific question, albeit possibly subjective, but I've been using this pattern very frequently while not seeing others use it very often.  Am I missing out on something or being too paranoid?

I wrap all my `UPDATE`,`DELETE`,`INSERT` operations in stored procedures, and only give `EXECUTE` on my package and `SELECT` on my tables, to my application.  For the `UPDATE` and `DELETE` procedures I have an `IF` statement at the end in which I do the following:

    IF SQL%ROWCOUNT <> 1 THEN
      RAISE_APPLICATION_ERROR(-20001, 'Invalid number of rows affected: ' || SQL%ROWCOUNT);
    END IF;

One could also do this check in the application code, as the number of rows affected is usually available after a SQL statement is executed.

So am I missing something or is this not the safest way to ensure you're updating or deleting exactly what you want to, nothing more, nothing less?",sql,oracle,plsql,,,,open,0,157,22,"Is it appropriate to raise exceptions in stored procedures that wrap around CRUD operations, when the number of rows affected != 1? This is a pretty specific question, albeit possibly subjective, but I've been using this pattern very frequently while not seeing others use it very often.  Am I missing out on something or being too paranoid?

I wrap all my `UPDATE`,`DELETE`,`INSERT` operations in stored procedures, and only give `EXECUTE` on my package and `SELECT` on my tables, to my application.  For the `UPDATE` and `DELETE` procedures I have an `IF` statement at the end in which I do the following:

    IF SQL%ROWCOUNT <> 1 THEN
      RAISE_APPLICATION_ERROR(-20001, 'Invalid number of rows affected: ' || SQL%ROWCOUNT);
    END IF;

One could also do this check in the application code, as the number of rows affected is usually available after a SQL statement is executed.

So am I missing something or is this not the safest way to ensure you're updating or deleting exactly what you want to, nothing more, nothing less?",3
2904690,05/25/2010 12:47:59,349910,05/25/2010 12:47:59,1,0,Try..Catch SQL Question,Is there any way of know which of my update or insert statements executed the catch block by failing,sql,,,,,,open,0,19,3,Try..Catch SQL Question Is there any way of know which of my update or insert statements executed the catch block by failing,1
9489874,02/28/2012 21:19:37,507153,11/14/2010 03:44:09,515,12,Trying to write SQL statement... matching pares,"This is my table sample:

    ID1   ID2       
    ===========
     1     2
     1     3
     1     4
     5     6
     5     7
              
Here is what I would like to achieve:

If I search for 1, the result I want is 2,3,4  
If I search for 2, the result I want is 1,3,4  
If I search for 3, the result I want is 1,2,4  
If I search for 4, the result I want is 1,2,3  
In all cases, 1,2,3,4 would be good result too...

I need some directions.

Thanks


",sql,matching,,,,02/28/2012 22:33:27,not a real question,1,153,7,"Trying to write SQL statement... matching pares This is my table sample:

    ID1   ID2       
    ===========
     1     2
     1     3
     1     4
     5     6
     5     7
              
Here is what I would like to achieve:

If I search for 1, the result I want is 2,3,4  
If I search for 2, the result I want is 1,3,4  
If I search for 3, the result I want is 1,2,4  
If I search for 4, the result I want is 1,2,3  
In all cases, 1,2,3,4 would be good result too...

I need some directions.

Thanks


",2
2055576,01/13/2010 09:23:32,108869,04/27/2009 03:23:36,871,10,sql optimize search many-many,"    usertable
    ----
    id, username
    
    grouptable
    ----
    id, groupname
    
    group_user
    --------
    uid, gid
    
    books
    ----
    id, groupname


Input parameters:  groupname, username   
output:  list of books 

Is it possible to use 1 sql statement to get list of books when username is inside groupname



Question 2:  any good book to recommand to master complex sql statement..
",sql,database,challenge,mysql,hibernate,,open,0,106,4,"sql optimize search many-many     usertable
    ----
    id, username
    
    grouptable
    ----
    id, groupname
    
    group_user
    --------
    uid, gid
    
    books
    ----
    id, groupname


Input parameters:  groupname, username   
output:  list of books 

Is it possible to use 1 sql statement to get list of books when username is inside groupname



Question 2:  any good book to recommand to master complex sql statement..
",5
10670732,05/20/2012 04:12:12,1405838,05/20/2012 03:57:58,1,0,Sql statement to find difference of dates from group of records based on,"I have a table like this
----------------------
ID   Mindate   Maxdate
1    1-12-81  1-15-81
1    1-18-81  1-18-81
1    2-9-81  3-1-81
2    5-2-81  7-5-81
2    8-18-81  8-18-81
2    9-9-81  10-21-81
3    3-12-81  4-15-81
3    6-17-81  8-19-81
------------------------
I need to find the Minimum date and MaxDate for each ID  under the condition that Difference between Minimum data and Maxdate should  be less than 90 days

-------
So the result I am expecting is something like this

-----------
ID  Mindate  MaxDate
1   1-12-81  3-1-81
2   8-18-81  12-21-81
3   6-17-81  8-19-81

 
",sql,sql-server-2008,,,,05/21/2012 16:53:17,not a real question,1,118,13,"Sql statement to find difference of dates from group of records based on I have a table like this
----------------------
ID   Mindate   Maxdate
1    1-12-81  1-15-81
1    1-18-81  1-18-81
1    2-9-81  3-1-81
2    5-2-81  7-5-81
2    8-18-81  8-18-81
2    9-9-81  10-21-81
3    3-12-81  4-15-81
3    6-17-81  8-19-81
------------------------
I need to find the Minimum date and MaxDate for each ID  under the condition that Difference between Minimum data and Maxdate should  be less than 90 days

-------
So the result I am expecting is something like this

-----------
ID  Mindate  MaxDate
1   1-12-81  3-1-81
2   8-18-81  12-21-81
3   6-17-81  8-19-81

 
",2
8596196,12/21/2011 20:53:40,1100190,12/15/2011 15:27:15,8,0,What is the best compression method (7-zip) for SQL Server backup file?,"Given an arbitrary *.bak file (up to 50GB) with a SQL server database backup created using a standard BACKUP DATABASE command, in my program (.NET) I need to compress it to the *.zip file the best way possible (balancing speed and size). 
I had a bad experience with SharpZipLib and Xceed often chokes on large files. I plan just to use 7-zip directly (assuming it is installed). What is the best (7-zip) compression method to use for this type of data?

",sql,sql-server,compression,backup,7zip,12/21/2011 21:10:05,off topic,1,81,12,"What is the best compression method (7-zip) for SQL Server backup file? Given an arbitrary *.bak file (up to 50GB) with a SQL server database backup created using a standard BACKUP DATABASE command, in my program (.NET) I need to compress it to the *.zip file the best way possible (balancing speed and size). 
I had a bad experience with SharpZipLib and Xceed often chokes on large files. I plan just to use 7-zip directly (assuming it is installed). What is the best (7-zip) compression method to use for this type of data?

",5
4348583,12/03/2010 18:22:58,183020,10/02/2009 10:36:05,99,2,Extract elements in xml to rows in select statement,"I have got xml column in my sql server 2008 database. XML sample in each row of my table

    <document>
     <part1>
       <listitem>val1</listitem>
       <listitem>val2</listitem>
       <listitem>val3</listitem>
     </part1>
     <part2>
       <listitem>val4</listitem>
     </part2>
    </document>

I would like to select all </listitem> elements from all rows. From sample above I should get four rows with listitem value.",sql,xml,xquery-sql,,,,open,0,96,9,"Extract elements in xml to rows in select statement I have got xml column in my sql server 2008 database. XML sample in each row of my table

    <document>
     <part1>
       <listitem>val1</listitem>
       <listitem>val2</listitem>
       <listitem>val3</listitem>
     </part1>
     <part2>
       <listitem>val4</listitem>
     </part2>
    </document>

I would like to select all </listitem> elements from all rows. From sample above I should get four rows with listitem value.",3
9280528,02/14/2012 16:30:22,68105,02/18/2009 22:50:24,5435,275,oracle distinct doing sort,"I'm getting poor performance from DISTINCT.  The explain plan indicates that it is doing SORT (GROUP BY) which doesn't sound right.  I would expect some kind of HASH aggregation to produce much better result.  Is there a hint to tell oracle to use HASH for DISTINCT rather than sort?
I've used /*+ USE_HASH_AGGREGATION */ in similar situations, but it is not working for DISTINCT.

So this is my original query:

    SELECT
    count(distinct userid) n, col
    FROM users
    GROUP BY col;

users has 30M rows, each userid is there 12 times.  This query takes 70 seconds.

Now we rewrite it as

    SELECT
    count(userid) n, col
    FROM
    (SELECT distinct userid, col FROM users)
    GROUP BY col

And it takes 40 seconds.
Now add the hint to do hash instead of sort:

    SELECT
    count(userid) n, col
    FROM
    (SELECT /*+ USE_HASH_AGGREGATION */ distinct userid, col FROM users)
    GROUP BY col

and it takes 10 seconds.

If somebody can explain to me why this is happening or how I can beat the first simple query into working as good as the 3rd one, that would be fantastic.  
The reason I care about query simplicity is because these queries are actually generated.",sql,oracle,query,,,02/14/2012 20:49:23,off topic,1,235,4,"oracle distinct doing sort I'm getting poor performance from DISTINCT.  The explain plan indicates that it is doing SORT (GROUP BY) which doesn't sound right.  I would expect some kind of HASH aggregation to produce much better result.  Is there a hint to tell oracle to use HASH for DISTINCT rather than sort?
I've used /*+ USE_HASH_AGGREGATION */ in similar situations, but it is not working for DISTINCT.

So this is my original query:

    SELECT
    count(distinct userid) n, col
    FROM users
    GROUP BY col;

users has 30M rows, each userid is there 12 times.  This query takes 70 seconds.

Now we rewrite it as

    SELECT
    count(userid) n, col
    FROM
    (SELECT distinct userid, col FROM users)
    GROUP BY col

And it takes 40 seconds.
Now add the hint to do hash instead of sort:

    SELECT
    count(userid) n, col
    FROM
    (SELECT /*+ USE_HASH_AGGREGATION */ distinct userid, col FROM users)
    GROUP BY col

and it takes 10 seconds.

If somebody can explain to me why this is happening or how I can beat the first simple query into working as good as the 3rd one, that would be fantastic.  
The reason I care about query simplicity is because these queries are actually generated.",3
3330159,07/25/2010 17:08:37,56061,01/16/2009 23:52:16,60,2,Query with multi tables,"I have three tables: characters, arena_team, arena_table_member, arena_team_stats.

characters table has guid, name

arena_team table has arenateamid, name, type

arena_table_member table has guid(this is the same as in characters table), arenateamid

arena_team_stats table has arenateamid, rating, wins, wins2, played

How do I get the list of arena teams where character is? I tried:

    $result=mysql_query(""SELECT characters.guid,characters.name,arena_team.arenateamid,arena_team.name,arena_team_stats.rating,arena_team_stats.wins,arena_team_stats.wins2,arena_team_stats.played,arena_team.type FROM characters,arena_team_stats,arena_team WHERE characters.name LIKE '%$q%' AND arena_team.arenateamid = arena_team_stats.arenateamid ORDER BY arena_team_stats.rating DESC"") or die(mysql_error());

but it returns all arena teams which are in arena_team table.",sql,multi-table,,,,,open,0,79,4,"Query with multi tables I have three tables: characters, arena_team, arena_table_member, arena_team_stats.

characters table has guid, name

arena_team table has arenateamid, name, type

arena_table_member table has guid(this is the same as in characters table), arenateamid

arena_team_stats table has arenateamid, rating, wins, wins2, played

How do I get the list of arena teams where character is? I tried:

    $result=mysql_query(""SELECT characters.guid,characters.name,arena_team.arenateamid,arena_team.name,arena_team_stats.rating,arena_team_stats.wins,arena_team_stats.wins2,arena_team_stats.played,arena_team.type FROM characters,arena_team_stats,arena_team WHERE characters.name LIKE '%$q%' AND arena_team.arenateamid = arena_team_stats.arenateamid ORDER BY arena_team_stats.rating DESC"") or die(mysql_error());

but it returns all arena teams which are in arena_team table.",2
1273855,08/13/2009 18:46:12,104849,05/11/2009 14:59:01,447,43,Y or N in an SQL result,Is there a way to have a query return either a 'Y' or 'N' for a column if that column has a value above a certain number say '25',sql,,,,,,open,0,29,7,Y or N in an SQL result Is there a way to have a query return either a 'Y' or 'N' for a column if that column has a value above a certain number say '25',1
6513941,06/28/2011 22:42:38,494901,11/02/2010 15:14:22,366,10,SQL Server 2008: What resources do I need to get up to speed?,"We're running SQL Server 2008 at my job here, both myself and the other developer have taught ourselves SQL. We need to come up to speed fast on SQL Server 2008 and the Language of SQL. 

What books, videos or other resources would you recommend? ",sql,sql-server-2008,education,,,06/28/2011 22:49:37,off topic,1,46,13,"SQL Server 2008: What resources do I need to get up to speed? We're running SQL Server 2008 at my job here, both myself and the other developer have taught ourselves SQL. We need to come up to speed fast on SQL Server 2008 and the Language of SQL. 

What books, videos or other resources would you recommend? ",3
8156819,11/16/2011 18:35:13,1027620,11/03/2011 12:02:26,136,2,SQL Server 2008 - A Calculated Column,"I have two tables:

1) Streams

2) Comments

Inside Streams I want to create a Comments columns. I would like to have the Comments column in the Streams table calculated depending on how many Comments there are with the matching StreamId.

Is there an easy way to alter the current Streams table? Thank you.",sql,sql-server,calculated-columns,,,,open,0,50,7,"SQL Server 2008 - A Calculated Column I have two tables:

1) Streams

2) Comments

Inside Streams I want to create a Comments columns. I would like to have the Comments column in the Streams table calculated depending on how many Comments there are with the matching StreamId.

Is there an easy way to alter the current Streams table? Thank you.",3
7909871,10/26/2011 22:53:26,546896,12/18/2010 09:38:11,36,2,Sql Query - Optimizing query,"i have a particular query

    select H1.name,H1.grade 
     from Highschooler H1, Highschooler H2, Highschooler H3 
      where H1.ID <>H2.ID and H2.ID<>H3.ID and H1.ID <> H3.ID and 
      H2.ID  in (Select L.ID2 from Likes L where L.ID1=H1.ID) and
      H3.ID  in (Select L.ID2 from Likes L where L.ID1=H2.ID)
    union
    select H2.name,H2.grade
    from Highschooler H1, Highschooler H2, Highschooler H3 
      where H1.ID <>H2.ID and H2.ID<>H3.ID and H1.ID <> H3.ID and 
      H2.ID  in (Select L.ID2 from Likes L where L.ID1=H1.ID) and
      H3.ID  in (Select L.ID2 from Likes L where L.ID1=H2.ID)
    union
    Select H3.name,H3.grade
    from Highschooler H1, Highschooler H2, Highschooler H3 
      where H1.ID <>H2.ID and H2.ID<>H3.ID and H1.ID <> H3.ID and 
      H2.ID  in (Select L.ID2 from Likes L where L.ID1=H1.ID) and
      H3.ID  in (Select L.ID2 from Likes L where L.ID1=H2.ID);

I know it's quite dirty and there must be way to optimize/shorten it. Can anyone please give hints and point me in right direction?

Problem 4. [Here][1]


  [1]: http://openclassroom.stanford.edu/MainFolder/DocumentPage.php?course=IntroToDatabases&doc=/docs/social-exercises.html ""MIT openclassroom""",sql,homework,,,,10/27/2011 01:25:49,not a real question,1,234,5,"Sql Query - Optimizing query i have a particular query

    select H1.name,H1.grade 
     from Highschooler H1, Highschooler H2, Highschooler H3 
      where H1.ID <>H2.ID and H2.ID<>H3.ID and H1.ID <> H3.ID and 
      H2.ID  in (Select L.ID2 from Likes L where L.ID1=H1.ID) and
      H3.ID  in (Select L.ID2 from Likes L where L.ID1=H2.ID)
    union
    select H2.name,H2.grade
    from Highschooler H1, Highschooler H2, Highschooler H3 
      where H1.ID <>H2.ID and H2.ID<>H3.ID and H1.ID <> H3.ID and 
      H2.ID  in (Select L.ID2 from Likes L where L.ID1=H1.ID) and
      H3.ID  in (Select L.ID2 from Likes L where L.ID1=H2.ID)
    union
    Select H3.name,H3.grade
    from Highschooler H1, Highschooler H2, Highschooler H3 
      where H1.ID <>H2.ID and H2.ID<>H3.ID and H1.ID <> H3.ID and 
      H2.ID  in (Select L.ID2 from Likes L where L.ID1=H1.ID) and
      H3.ID  in (Select L.ID2 from Likes L where L.ID1=H2.ID);

I know it's quite dirty and there must be way to optimize/shorten it. Can anyone please give hints and point me in right direction?

Problem 4. [Here][1]


  [1]: http://openclassroom.stanford.edu/MainFolder/DocumentPage.php?course=IntroToDatabases&doc=/docs/social-exercises.html ""MIT openclassroom""",2
6949649,08/04/2011 23:05:48,184046,10/04/2009 20:35:01,6082,42,Inserting missing entries when doing a GROUP BY?,"I am trying to use `GROUP BY` on my table to group my entries according to weeks. However, if there are no entries in certain week, how can I insert a 0 as opposed to a missing entry?

    CREATE TABLE #TEMP (startdate datetime)
    
    INSERT INTO #TEMP VALUES('2011-02-01')
    INSERT INTO #TEMP VALUES('2011-02-02')
    INSERT INTO #TEMP VALUES('2011-02-03')
    INSERT INTO #TEMP VALUES('2011-02-04')
    INSERT INTO #TEMP VALUES('2011-02-05')
    INSERT INTO #TEMP VALUES('2011-02-18')
    INSERT INTO #TEMP VALUES('2011-02-19')
    INSERT INTO #TEMP VALUES('2011-02-20')
    INSERT INTO #TEMP VALUES('2011-02-21')
    
    SELECT DATEPART(YEAR,startdate) AS 'AYear',
           DATEPART(wk,startdate) AS 'AWeek',
           COUNT(*)
    FROM #TEMP
    GROUP BY DATEPART(YEAR,startdate),DATEPART(wk,startdate)
    ORDER BY 1,2
    
    DROP TABLE #TEMP

I am getting:

    AYear	AWeek	(No column name)
    2011        6       5
    2011        8       2
    2011        9       2

but I want this:

    AYear	AWeek	(No column name)
    2011        6       5
    2011        7       0
    2011        8       2
    2011        9       2

Any suggestions on how to do this?",sql,sql-server,sql-server-2008,query,,,open,0,331,8,"Inserting missing entries when doing a GROUP BY? I am trying to use `GROUP BY` on my table to group my entries according to weeks. However, if there are no entries in certain week, how can I insert a 0 as opposed to a missing entry?

    CREATE TABLE #TEMP (startdate datetime)
    
    INSERT INTO #TEMP VALUES('2011-02-01')
    INSERT INTO #TEMP VALUES('2011-02-02')
    INSERT INTO #TEMP VALUES('2011-02-03')
    INSERT INTO #TEMP VALUES('2011-02-04')
    INSERT INTO #TEMP VALUES('2011-02-05')
    INSERT INTO #TEMP VALUES('2011-02-18')
    INSERT INTO #TEMP VALUES('2011-02-19')
    INSERT INTO #TEMP VALUES('2011-02-20')
    INSERT INTO #TEMP VALUES('2011-02-21')
    
    SELECT DATEPART(YEAR,startdate) AS 'AYear',
           DATEPART(wk,startdate) AS 'AWeek',
           COUNT(*)
    FROM #TEMP
    GROUP BY DATEPART(YEAR,startdate),DATEPART(wk,startdate)
    ORDER BY 1,2
    
    DROP TABLE #TEMP

I am getting:

    AYear	AWeek	(No column name)
    2011        6       5
    2011        8       2
    2011        9       2

but I want this:

    AYear	AWeek	(No column name)
    2011        6       5
    2011        7       0
    2011        8       2
    2011        9       2

Any suggestions on how to do this?",4
828582,05/06/2009 08:26:14,82004,03/24/2009 13:09:43,392,28,SQL: To primary key or not to primary key?,"I have a table with user sets of settings for users, it has the following columns:

    UserID INT
    Set VARCHAR(50)
    Key VARCHAR(50)
    Value NVARCHAR(MAX)
    TimeStamp DATETIME

UserID together with Set and Key are unique. So a specific user cannot have two of the same keys in a particular set of settings. The settings are retrieved by set, so if a user requests a certain key from a certain set, the whole set is downloaded, so that the next time a key from the same set is needed, it doesn't have to go to the database.

Should I create a primary key on all three columns (userid, set, and key) or should I create an extra field that has a primary key (for example an autoincrement integer called SettingID, bad idea i guess), or not create a primary key, and just create a unique index?



",sql,primary-key,indexing,,,,open,0,157,9,"SQL: To primary key or not to primary key? I have a table with user sets of settings for users, it has the following columns:

    UserID INT
    Set VARCHAR(50)
    Key VARCHAR(50)
    Value NVARCHAR(MAX)
    TimeStamp DATETIME

UserID together with Set and Key are unique. So a specific user cannot have two of the same keys in a particular set of settings. The settings are retrieved by set, so if a user requests a certain key from a certain set, the whole set is downloaded, so that the next time a key from the same set is needed, it doesn't have to go to the database.

Should I create a primary key on all three columns (userid, set, and key) or should I create an extra field that has a primary key (for example an autoincrement integer called SettingID, bad idea i guess), or not create a primary key, and just create a unique index?



",3
4447369,12/15/2010 06:39:53,264052,02/02/2010 04:03:26,1414,7,Could some explain this TSQL code for me? ,"I got the following store procedure, but I am new to TSQL and not quite sure about its syntax. Could some explain a little to me?

Question:

**- What does the #tmp syntax stand for?**

**- Where is the c in c.RootCategoryId defined?**




    ALTER PROCEDURE [dbo].[GetAllTopCategories]
    	@prewin7 bit
    AS
    SELECT * INTO #tmp FROM dbo.fnGetCategories(@prewin7)
    
    SELECT
    	c.RootCategoryId CategoryId,
    	c.CategoryName + ' [' + CAST(g.DiagnosticCount AS nvarchar(max)) + ']' CategoryName,
    	@prewin7 as PreWin7
    FROM (
    	SELECT
    		c.RootCategoryId CategoryId,
    		SUM(c.DiagnosticCount) DiagnosticCount
    	FROM #tmp c
    	GROUP BY c.RootCategoryId
    ) g
    INNER JOIN #tmp c ON c.CategoryId = g.CategoryId
    ORDER BY c.CategoryName
    
    DROP TABLE #tmp


",sql,tsql,,,,,open,0,160,9,"Could some explain this TSQL code for me?  I got the following store procedure, but I am new to TSQL and not quite sure about its syntax. Could some explain a little to me?

Question:

**- What does the #tmp syntax stand for?**

**- Where is the c in c.RootCategoryId defined?**




    ALTER PROCEDURE [dbo].[GetAllTopCategories]
    	@prewin7 bit
    AS
    SELECT * INTO #tmp FROM dbo.fnGetCategories(@prewin7)
    
    SELECT
    	c.RootCategoryId CategoryId,
    	c.CategoryName + ' [' + CAST(g.DiagnosticCount AS nvarchar(max)) + ']' CategoryName,
    	@prewin7 as PreWin7
    FROM (
    	SELECT
    		c.RootCategoryId CategoryId,
    		SUM(c.DiagnosticCount) DiagnosticCount
    	FROM #tmp c
    	GROUP BY c.RootCategoryId
    ) g
    INNER JOIN #tmp c ON c.CategoryId = g.CategoryId
    ORDER BY c.CategoryName
    
    DROP TABLE #tmp


",2
1290050,08/17/2009 19:52:26,84424,03/30/2009 02:54:02,165,14,How to: select normalized view from denormalized data using CTE?,"This is a very standard newbie question, but I am looking for an expert clever way to do this with little code.  (I know how to do this long hand, with procedural code and cursors, so we can skip that part of the answer.) **Basically, I have a de-normalized data set for which I need to extract a normalized table in a set processing way**.  The raw data comes from Excel, which I attach as a table to query from MS SQL.  A single field (in Excel and therefore SQL) has a comma separated list of departments that each product participates.

I know that I should normalize the data, but it is coming from Excel (and it is not practical for the user to do so).  I know I can do this with a procedure to loop through each record (like a cursor or with statement) but that seems unnecessary with the tools available today.  **Is there a single statement where I can extract a primary key with a ""participates"" field for these records?**

Think of the source as:

<kbd>ProductID</kbd><kbd>Departments</kbd><br />
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;1,3,5,15&nbsp;&nbsp;</kbd><br />
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;2,4,5,16&nbsp;&nbsp;</kbd><br />

I did the normal select * from dbo.split( CommaSepField) but this only works on one record at a time (and you cannot provide a field's value in with a table valued function.  Not to mention, how do you union all these single result sets?

Unionizing all the result sets got me thinking about Common Table Expressions, but I cannot quite figure out how to (1) get the primary key in with the expanded fields, and (2) how to format the query to work.

The output of course would be:

<kbd>ProductID</kbd><kbd>Dept</kbd><br />
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;1&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;3&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;5&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;15&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;2&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;4&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;5&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;16&nbsp;</kbd><br/>

I researched this quite a bit in StackOverflow and Google, but didn't really find an answer that could apply. I apologize if I missed it.  Please send links :D.",sql,common-table-expression,normalize,data,select,,open,0,302,10,"How to: select normalized view from denormalized data using CTE? This is a very standard newbie question, but I am looking for an expert clever way to do this with little code.  (I know how to do this long hand, with procedural code and cursors, so we can skip that part of the answer.) **Basically, I have a de-normalized data set for which I need to extract a normalized table in a set processing way**.  The raw data comes from Excel, which I attach as a table to query from MS SQL.  A single field (in Excel and therefore SQL) has a comma separated list of departments that each product participates.

I know that I should normalize the data, but it is coming from Excel (and it is not practical for the user to do so).  I know I can do this with a procedure to loop through each record (like a cursor or with statement) but that seems unnecessary with the tools available today.  **Is there a single statement where I can extract a primary key with a ""participates"" field for these records?**

Think of the source as:

<kbd>ProductID</kbd><kbd>Departments</kbd><br />
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;1,3,5,15&nbsp;&nbsp;</kbd><br />
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;2,4,5,16&nbsp;&nbsp;</kbd><br />

I did the normal select * from dbo.split( CommaSepField) but this only works on one record at a time (and you cannot provide a field's value in with a table valued function.  Not to mention, how do you union all these single result sets?

Unionizing all the result sets got me thinking about Common Table Expressions, but I cannot quite figure out how to (1) get the primary key in with the expanded fields, and (2) how to format the query to work.

The output of course would be:

<kbd>ProductID</kbd><kbd>Dept</kbd><br />
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;1&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;3&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;5&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;123&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;15&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;2&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;4&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;5&nbsp;&nbsp;</kbd><br/>
<kbd>&nbsp;456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</kbd><kbd>&nbsp;16&nbsp;</kbd><br/>

I researched this quite a bit in StackOverflow and Google, but didn't really find an answer that could apply. I apologize if I missed it.  Please send links :D.",5
3679148,09/09/2010 17:48:19,443695,09/09/2010 17:48:19,1,0,sql query to find sum of all rows and count of duplicates ,"If data is in the following format,  
SID TID Tdatetime  QID QTotal  
100 1 01/12/97 9:00AM 66 110   
100 1 01/12/97 9:00AM 66 110  
100 1 01/12/97 10:00AM 67 110  
100 2 01/19/97 9:00AM 66 .  
100 2 01/19/97 9:00AM  66 110  
100 2 01/19/97 10:00AM  66 110  
100 3 01/26/97 9:00AM  68 120  
100 3 01/26/97 9:00AM  68 120  
110 1 02/03/97 10:00AM  68 110  
110 3 02/12/97 9:00AM  64 115  
110 3 02/12/97 9:00AM  64 115  
120 1 04/05/97 9:00AM  66 105  
120 1 04/05/97 10:00AM  66 105  

I would like to be able to write a query to sum the QTotal column for all rows and find the count of duplicate rows for the Tdatetime column.

The output would look like
Year 97 | 1340 | 4

Thanks for your help.

ARK",sql,query,duplicates,sum,,,open,0,157,13,"sql query to find sum of all rows and count of duplicates  If data is in the following format,  
SID TID Tdatetime  QID QTotal  
100 1 01/12/97 9:00AM 66 110   
100 1 01/12/97 9:00AM 66 110  
100 1 01/12/97 10:00AM 67 110  
100 2 01/19/97 9:00AM 66 .  
100 2 01/19/97 9:00AM  66 110  
100 2 01/19/97 10:00AM  66 110  
100 3 01/26/97 9:00AM  68 120  
100 3 01/26/97 9:00AM  68 120  
110 1 02/03/97 10:00AM  68 110  
110 3 02/12/97 9:00AM  64 115  
110 3 02/12/97 9:00AM  64 115  
120 1 04/05/97 9:00AM  66 105  
120 1 04/05/97 10:00AM  66 105  

I would like to be able to write a query to sum the QTotal column for all rows and find the count of duplicate rows for the Tdatetime column.

The output would look like
Year 97 | 1340 | 4

Thanks for your help.

ARK",4
8188074,11/18/2011 19:33:42,158008,08/17/2009 20:35:44,942,4,Select statement for mulitple tables in SQL,"I have 3 tables 'Table A', 'Table B' and 'Table C'. 'Table A' combination of 'Table B' and 'Table C'. Now I need found out select GLIDs not in Table B but in Table A and  Vochersid in Table C and  A.

All Should equal to datasource in all 3 tables

Example Data

    Table A

    ap_GLID	Doc Type	Doc No
    5000000	AEXB	20073145
    5000001	AEXB	20073145
    5000019	GJRN	20070090
    5000020	GJRN	20070090
    5000021	GJRN	20070090
    5000058	AEXB	20073148
    5000059	AEXB	20073148
    5000060	AEXB	20073148

Table B

    GLID	   DataSource
    5000012	   3
    5000030	   3
    5000034	   3
    5000035	   3
    5000038	   3
    5000039	   3
    5000048	   3


    Table C
    VoucherId	DocType	DocNumber	DataSource
    AIN1 20080009	AIN1	20080009	3
    AIN1 20080014	AIN1	20080014	3
    AIN1 20080016	AIN1	20080016	3
    AIN1 20080022	AIN1	20080022	3
    AIN1 20080024	AIN1	20080024	3
    AIN1 20080025	AIN1	20080025	3
    AIN1 20080028	AIN1	20080028	3
    AIN1 20080029	AIN1	20080029	3
    AIN1 20080030	AIN1	20080030	3



",sql,sql-server-2005,select,,,11/18/2011 19:44:07,not a real question,1,207,7,"Select statement for mulitple tables in SQL I have 3 tables 'Table A', 'Table B' and 'Table C'. 'Table A' combination of 'Table B' and 'Table C'. Now I need found out select GLIDs not in Table B but in Table A and  Vochersid in Table C and  A.

All Should equal to datasource in all 3 tables

Example Data

    Table A

    ap_GLID	Doc Type	Doc No
    5000000	AEXB	20073145
    5000001	AEXB	20073145
    5000019	GJRN	20070090
    5000020	GJRN	20070090
    5000021	GJRN	20070090
    5000058	AEXB	20073148
    5000059	AEXB	20073148
    5000060	AEXB	20073148

Table B

    GLID	   DataSource
    5000012	   3
    5000030	   3
    5000034	   3
    5000035	   3
    5000038	   3
    5000039	   3
    5000048	   3


    Table C
    VoucherId	DocType	DocNumber	DataSource
    AIN1 20080009	AIN1	20080009	3
    AIN1 20080014	AIN1	20080014	3
    AIN1 20080016	AIN1	20080016	3
    AIN1 20080022	AIN1	20080022	3
    AIN1 20080024	AIN1	20080024	3
    AIN1 20080025	AIN1	20080025	3
    AIN1 20080028	AIN1	20080028	3
    AIN1 20080029	AIN1	20080029	3
    AIN1 20080030	AIN1	20080030	3



",3
5937526,05/09/2011 13:27:30,745199,05/09/2011 13:12:41,1,0,Calculating time worked during lunch break - shift workers,"I am trying to create a query that will calculate the hours worked by employees working during a might shift, ie. from 18:00 to 3:00AM the next morning.  They are given a break between 10PM and 11PM everyday.

If i take clockins like this:

Name         ClockTime      Direction
Person A      18:00:15         IN
Person A      10:05:10         OUT
Person A      10:35:45         IN
Person A      03:35:10         OUT

I need to get the person's first and last clockin for the shift, as well as how many hours he worked.  I also need to know how long he worked during his lunchbreak.  I have the following code at the moment.  Can anyone help me to get this working?

; with emp_clock as (Select distinct Rules_ID = Rules.Rules_ID,  Personel_ID = Pers.Personel_ID, SDay_ID = SDay.SDay_ID, NormalDay = case when SDay.NormalDay = 1 then 'True'  when SRDay.NormalDay = 0 then 'False' end, FullName	= Pers.[Name] + ' ' + Pers.Surname,   
RowNo = row_number() over (partition by Pers.Personel_ID order by C.ClockTime),  
ClockDate = dateadd(day, datediff(day, 0, C.ClockTime), 0),  
DayAdj = case when Default_Shift_End < Default_Shift_Start then 0 else 1 end,  
ClockTime	= RC.ClockTime, 
DirectionName = Dir.[Name], 
ShiftRuleGroup = Rules.[Name],  
ShiftStartTime = convert(varchar(10), Rules.Default_Shift_Start, 108),  
ShiftEndTime = convert(varchar(10), Rules.Default_Shift_End, 108),  StartRoundingUp = SRDay.StartRounding_Up, EndRoundingUp = SRDay.EndRounding_Up,  
StartRoundingHours = SRDay.StartRounding_Hrs_Num,  
EndRoundingHours = SRDay.EndRounding_Num_Hrs,  
Rules_SRBreak	= SRBreak.[Name],  
BreakStartTime	= SRBreak.SR_Break_StartTime,  
BreakEndTime	= SRBreak.SR_Break_EndTime  
FROM Personnel Pers  
INNER JOIN ClockIns C ON Pers.Personel_ID = C.Person_ID  
INNER JOIN Direction Dir ON	RC.Direction_ID = Dir.Direction_ID  
INNER JOIN EmpShiftGroup ON Pers.Personel_ID = EmpShiftGroup.Employee_ID  
INNER JOIN Rules Rules ON Rules.Rules_ID = EmpShiftGroup.Rules_ID  
INNER JOIN SDay ON Rules.Rules_ID = SDay.Rules_ID   
--	And sday.cycledayno=EmpShiftGroup.StartDate_CycleDayNo + (day(C.ClockTime - EmpShiftGroup.  
--	EmpSR_StartDate) % Rules.SRShiftCycle_Days)-1  
AND (dateadd(day, datediff(day, 0, RC.ClockTime), 0) = dateadd(day, datediff(day, 0, SRDay.Start_Time), 0))
LEFT OUTER JOIN SRBreak ON SRBreak.SRDay_ID = SRDay.SRDay_ID),  timelog 
as  (select
Rules_ID = coalesce(ci.Rules_ID, co.Rules_ID),  Personel_ID = coalesce(ci.Personel_ID, co.Personel_ID),  SRDay_ID = coalesce(ci.SRDay_ID, co.SDay_ID), NormalDay = coalesce(ci.NormalDay, co.NormalDay),  FullName = coalesce(ci.FullName, co.FullName), DailyHrsName = coalesce(ci.DailyHrsName, co.DailyHrsName), ClockTime = coalesce(ci.ClockTime, co.ClockTime), ShiftRuleGroup = coalesce(ci.Rule, co.Rule),  ShiftStartTime = coalesce(ci.ShiftStartTime, co.ShiftStartTime), ShiftEndTime	= coalesce(ci.ShiftEndTime, co.ShiftEndTime),  StartRoundingUp = coalesce(ci.StartRoundingUp, co.StartRoundingUp),  EndRoundingUp = coalesce(ci.EndRoundingUp, co.EndRoundingUp),  StartRoundingHours = coalesce(ci.StartRoundingHours, co.StartRoundingHours),  EndRoundingHours = coalesce(ci.EndRoundingHours, co.EndRoundingHours),  
SRBreak = coalesce(ci.SRBreak, co.SRBreak),  
BreakStartTime = coalesce(ci.BreakStartTime, co.BreakStartTime),  
BreakEndTime = coalesce(ci.BreakEndTime,	co.BreakEndTime),  
ClockIn = coalesce(ci.ClockTime, co.ClockDate - co.DayAdj + co.ShiftStartTime),
ClockOut = coalesce(co.ClockTime, ci.ClockDate + ci.DayAdj + ci.ShiftEndTime)  
from emp_clock ci  full outer join emp_clock co on	ci.Personel_ID	= co.Personel_ID  
and ci.RowNo = co.RowNo - 1  and co.ClockTime < dateadd(day, 1, ci.ClockDate) + ci.ShiftStartTime  
where not (ci.DirectionName is null and co.DirectionName = 'IN')  and not (ci.DirectionName = 'OUT'	and	co.DirectionName is null)  and (ci.DirectionName = 'IN' or ci.DirectionName is null)), detail as ( select distinct ShiftRulesGroup_ID, Personel_ID, SRDay_ID, NormalDay, FullName, DailyHrsName, ClockTime, ClockIn,ClockOut, ShiftStartTime, ShiftEndTime, StartRoundingUp, EndRoundingUp,  StartRoundingHours, EndRoundingHours, BreakStartTime, BreakEndTime,
TimeBeforeShiftStart = case when ClockIn - dateadd(day, datediff(day, 0, ClockIn), 0) <  ShiftStartTime then ClockIn - dateadd(day, datediff(day, 0, ClockIn), 0) end,  
TimeBeforeShiftEnd = case when ClockIn - dateadd(day, datediff(day, 0, ClockIn), 0) <  ShiftStartTime then ShiftStartTime end,
TimeAfterShiftStart = case when ClockOut - dateadd(day, datediff(day, 0, ClockOut), 0) >  ShiftEndTime then ShiftEndTime end,  
TimeAfterShiftEnd = case when ClockOut - dateadd(day, datediff(day, 0, ClockOut), 0) >  ShiftEndTime then ClockOut - dateadd(day, datediff(day, 0, ClockOut), 0) end  from timelog),  
summary as ( select distinct Personel_ID, rules_ID, SRDay_ID, NormalDay, FullName, DailyHrsName,  ClockDate = convert(nvarchar(10), dateadd(day, datediff(day, 0, ClockIn), 0),111), MIN(ClockTime) AS Calc_First_Clock, 
Calc_Last_Clock = case when (DATEDIFF(HH, ShiftStartTime, ClockIn) = 0  AND DATEDIFF(HH, ShiftStartTime, ClockOut) <= 8) OR (DATEDIFF(HH, ShiftStartTime, ClockIn) > 0  AND DATEDIFF(HH, ShiftStartTime, ClockOut) <=8) then ClockOut else max(ClockOut) end ,   
TotalWorkHours	= CAST(sum(datediff(minute, ClockIn, ClockOut) / 60.0) as decimal(4,2)),  
Before_Shift = CAST(isnull(sum(datediff(minute, TimeBeforeShiftStart, TimeBeforeShiftEnd)), 0) / 60.0 as decimal(4,2)),
After_Shift = CAST(isnull(sum(datediff(minute, TimeAfterShiftStart, TimeAfterShiftEnd)), 0) / 60.0 as decimal(4,2))  from detail  
group by  SRDay_ID, dateadd(day, datediff(day, 0, ClockTime), 0),  Personel_ID, FullName, ShiftRulesGroup_ID, NormalDay, DailyHrsName, ClockIn,ClockOut, ShiftStartTime, ShiftEndTime, StartRoundingUp,  EndRoundingUp, StartRoundingHours, EndRoundingHours, BreakStartTime, BreakEndTime )  select * from summary 

 ",sql,,,,,05/09/2011 14:06:43,too localized,1,751,9,"Calculating time worked during lunch break - shift workers I am trying to create a query that will calculate the hours worked by employees working during a might shift, ie. from 18:00 to 3:00AM the next morning.  They are given a break between 10PM and 11PM everyday.

If i take clockins like this:

Name         ClockTime      Direction
Person A      18:00:15         IN
Person A      10:05:10         OUT
Person A      10:35:45         IN
Person A      03:35:10         OUT

I need to get the person's first and last clockin for the shift, as well as how many hours he worked.  I also need to know how long he worked during his lunchbreak.  I have the following code at the moment.  Can anyone help me to get this working?

; with emp_clock as (Select distinct Rules_ID = Rules.Rules_ID,  Personel_ID = Pers.Personel_ID, SDay_ID = SDay.SDay_ID, NormalDay = case when SDay.NormalDay = 1 then 'True'  when SRDay.NormalDay = 0 then 'False' end, FullName	= Pers.[Name] + ' ' + Pers.Surname,   
RowNo = row_number() over (partition by Pers.Personel_ID order by C.ClockTime),  
ClockDate = dateadd(day, datediff(day, 0, C.ClockTime), 0),  
DayAdj = case when Default_Shift_End < Default_Shift_Start then 0 else 1 end,  
ClockTime	= RC.ClockTime, 
DirectionName = Dir.[Name], 
ShiftRuleGroup = Rules.[Name],  
ShiftStartTime = convert(varchar(10), Rules.Default_Shift_Start, 108),  
ShiftEndTime = convert(varchar(10), Rules.Default_Shift_End, 108),  StartRoundingUp = SRDay.StartRounding_Up, EndRoundingUp = SRDay.EndRounding_Up,  
StartRoundingHours = SRDay.StartRounding_Hrs_Num,  
EndRoundingHours = SRDay.EndRounding_Num_Hrs,  
Rules_SRBreak	= SRBreak.[Name],  
BreakStartTime	= SRBreak.SR_Break_StartTime,  
BreakEndTime	= SRBreak.SR_Break_EndTime  
FROM Personnel Pers  
INNER JOIN ClockIns C ON Pers.Personel_ID = C.Person_ID  
INNER JOIN Direction Dir ON	RC.Direction_ID = Dir.Direction_ID  
INNER JOIN EmpShiftGroup ON Pers.Personel_ID = EmpShiftGroup.Employee_ID  
INNER JOIN Rules Rules ON Rules.Rules_ID = EmpShiftGroup.Rules_ID  
INNER JOIN SDay ON Rules.Rules_ID = SDay.Rules_ID   
--	And sday.cycledayno=EmpShiftGroup.StartDate_CycleDayNo + (day(C.ClockTime - EmpShiftGroup.  
--	EmpSR_StartDate) % Rules.SRShiftCycle_Days)-1  
AND (dateadd(day, datediff(day, 0, RC.ClockTime), 0) = dateadd(day, datediff(day, 0, SRDay.Start_Time), 0))
LEFT OUTER JOIN SRBreak ON SRBreak.SRDay_ID = SRDay.SRDay_ID),  timelog 
as  (select
Rules_ID = coalesce(ci.Rules_ID, co.Rules_ID),  Personel_ID = coalesce(ci.Personel_ID, co.Personel_ID),  SRDay_ID = coalesce(ci.SRDay_ID, co.SDay_ID), NormalDay = coalesce(ci.NormalDay, co.NormalDay),  FullName = coalesce(ci.FullName, co.FullName), DailyHrsName = coalesce(ci.DailyHrsName, co.DailyHrsName), ClockTime = coalesce(ci.ClockTime, co.ClockTime), ShiftRuleGroup = coalesce(ci.Rule, co.Rule),  ShiftStartTime = coalesce(ci.ShiftStartTime, co.ShiftStartTime), ShiftEndTime	= coalesce(ci.ShiftEndTime, co.ShiftEndTime),  StartRoundingUp = coalesce(ci.StartRoundingUp, co.StartRoundingUp),  EndRoundingUp = coalesce(ci.EndRoundingUp, co.EndRoundingUp),  StartRoundingHours = coalesce(ci.StartRoundingHours, co.StartRoundingHours),  EndRoundingHours = coalesce(ci.EndRoundingHours, co.EndRoundingHours),  
SRBreak = coalesce(ci.SRBreak, co.SRBreak),  
BreakStartTime = coalesce(ci.BreakStartTime, co.BreakStartTime),  
BreakEndTime = coalesce(ci.BreakEndTime,	co.BreakEndTime),  
ClockIn = coalesce(ci.ClockTime, co.ClockDate - co.DayAdj + co.ShiftStartTime),
ClockOut = coalesce(co.ClockTime, ci.ClockDate + ci.DayAdj + ci.ShiftEndTime)  
from emp_clock ci  full outer join emp_clock co on	ci.Personel_ID	= co.Personel_ID  
and ci.RowNo = co.RowNo - 1  and co.ClockTime < dateadd(day, 1, ci.ClockDate) + ci.ShiftStartTime  
where not (ci.DirectionName is null and co.DirectionName = 'IN')  and not (ci.DirectionName = 'OUT'	and	co.DirectionName is null)  and (ci.DirectionName = 'IN' or ci.DirectionName is null)), detail as ( select distinct ShiftRulesGroup_ID, Personel_ID, SRDay_ID, NormalDay, FullName, DailyHrsName, ClockTime, ClockIn,ClockOut, ShiftStartTime, ShiftEndTime, StartRoundingUp, EndRoundingUp,  StartRoundingHours, EndRoundingHours, BreakStartTime, BreakEndTime,
TimeBeforeShiftStart = case when ClockIn - dateadd(day, datediff(day, 0, ClockIn), 0) <  ShiftStartTime then ClockIn - dateadd(day, datediff(day, 0, ClockIn), 0) end,  
TimeBeforeShiftEnd = case when ClockIn - dateadd(day, datediff(day, 0, ClockIn), 0) <  ShiftStartTime then ShiftStartTime end,
TimeAfterShiftStart = case when ClockOut - dateadd(day, datediff(day, 0, ClockOut), 0) >  ShiftEndTime then ShiftEndTime end,  
TimeAfterShiftEnd = case when ClockOut - dateadd(day, datediff(day, 0, ClockOut), 0) >  ShiftEndTime then ClockOut - dateadd(day, datediff(day, 0, ClockOut), 0) end  from timelog),  
summary as ( select distinct Personel_ID, rules_ID, SRDay_ID, NormalDay, FullName, DailyHrsName,  ClockDate = convert(nvarchar(10), dateadd(day, datediff(day, 0, ClockIn), 0),111), MIN(ClockTime) AS Calc_First_Clock, 
Calc_Last_Clock = case when (DATEDIFF(HH, ShiftStartTime, ClockIn) = 0  AND DATEDIFF(HH, ShiftStartTime, ClockOut) <= 8) OR (DATEDIFF(HH, ShiftStartTime, ClockIn) > 0  AND DATEDIFF(HH, ShiftStartTime, ClockOut) <=8) then ClockOut else max(ClockOut) end ,   
TotalWorkHours	= CAST(sum(datediff(minute, ClockIn, ClockOut) / 60.0) as decimal(4,2)),  
Before_Shift = CAST(isnull(sum(datediff(minute, TimeBeforeShiftStart, TimeBeforeShiftEnd)), 0) / 60.0 as decimal(4,2)),
After_Shift = CAST(isnull(sum(datediff(minute, TimeAfterShiftStart, TimeAfterShiftEnd)), 0) / 60.0 as decimal(4,2))  from detail  
group by  SRDay_ID, dateadd(day, datediff(day, 0, ClockTime), 0),  Personel_ID, FullName, ShiftRulesGroup_ID, NormalDay, DailyHrsName, ClockIn,ClockOut, ShiftStartTime, ShiftEndTime, StartRoundingUp,  EndRoundingUp, StartRoundingHours, EndRoundingHours, BreakStartTime, BreakEndTime )  select * from summary 

 ",1
3346832,07/27/2010 18:46:01,403760,07/27/2010 18:46:01,1,0,Select a nullable bit with a default value,"I need to select a nullable bit column in a view, but use a default value of FALSE whenever the value is NULL.  (For other reasons, I can't add the default value on the source table itself.)  Here is what I am doing.  

    CAST 
    (
        CASE 
	    WHEN bit_column IS NULL THEN 0 
	    ELSE bit_column  
	END 
        AS BIT
    ) AS bit_column,
    ...
I have to do this on four columns, so I'm wondering if there is a better/more efficient way to do this.",sql,tsql,sql-server-2000,bit,,,open,0,122,8,"Select a nullable bit with a default value I need to select a nullable bit column in a view, but use a default value of FALSE whenever the value is NULL.  (For other reasons, I can't add the default value on the source table itself.)  Here is what I am doing.  

    CAST 
    (
        CASE 
	    WHEN bit_column IS NULL THEN 0 
	    ELSE bit_column  
	END 
        AS BIT
    ) AS bit_column,
    ...
I have to do this on four columns, so I'm wondering if there is a better/more efficient way to do this.",4
3477319,08/13/2010 13:38:07,57083,01/20/2009 12:44:23,360,16,Multiple Joins on Temporary Table OR Subquery in SQL 2008,"I have the following SQL which gets a season for each day in a range of dates, then groups each season by start and end date with number of nights. What it does is not important but my question is which is better, the way I've done it below or use the first select statement as a subquery each time @dateSeasons is used in the second query. Both ways seem to run the same but this way looks neater. 

	DECLARE @dateSeasons TABLE ([date] date, seasonID int)

	INSERT INTO @dateSeasons
	SELECT D.[date], S.ID
	FROM @dates AS D
	CROSS APPLY (
	
		SELECT TOP 1 ID
		FROM dbo.Seasons
		WHERE bookingID = @bookingID 
		AND D.[date] BETWEEN startDate AND endDate
		ORDER BY ID DESC
	
	) AS S

	
	SELECT MIN([date]), endDate, DATEDIFF(DAY, MIN([date]), DATEADD(DAY, 1, endDate)), seasonID
	FROM (

		SELECT S1.seasonID, S1.[date], (
     
			SELECT MAX([date])
			FROM @dateSeasons S2
			WHERE S2.seasonID = S1.seasonID
			AND NOT EXISTS (

				SELECT NULL
				FROM @dateSeasons S3
				WHERE S3.[date] < S2.[date]
				AND S3.[date] > S1.[date]
				AND S3.seasonID <> S1.seasonID

			)

		) AS endDate
		FROM @dateSeasons S1
	) AS results
	GROUP BY endDate, seasonID
	ORDER BY MIN([date])",sql,join,temporary-tables,,,,open,0,162,10,"Multiple Joins on Temporary Table OR Subquery in SQL 2008 I have the following SQL which gets a season for each day in a range of dates, then groups each season by start and end date with number of nights. What it does is not important but my question is which is better, the way I've done it below or use the first select statement as a subquery each time @dateSeasons is used in the second query. Both ways seem to run the same but this way looks neater. 

	DECLARE @dateSeasons TABLE ([date] date, seasonID int)

	INSERT INTO @dateSeasons
	SELECT D.[date], S.ID
	FROM @dates AS D
	CROSS APPLY (
	
		SELECT TOP 1 ID
		FROM dbo.Seasons
		WHERE bookingID = @bookingID 
		AND D.[date] BETWEEN startDate AND endDate
		ORDER BY ID DESC
	
	) AS S

	
	SELECT MIN([date]), endDate, DATEDIFF(DAY, MIN([date]), DATEADD(DAY, 1, endDate)), seasonID
	FROM (

		SELECT S1.seasonID, S1.[date], (
     
			SELECT MAX([date])
			FROM @dateSeasons S2
			WHERE S2.seasonID = S1.seasonID
			AND NOT EXISTS (

				SELECT NULL
				FROM @dateSeasons S3
				WHERE S3.[date] < S2.[date]
				AND S3.[date] > S1.[date]
				AND S3.seasonID <> S1.seasonID

			)

		) AS endDate
		FROM @dateSeasons S1
	) AS results
	GROUP BY endDate, seasonID
	ORDER BY MIN([date])",3
5003364,02/15/2011 12:00:12,373426,06/22/2010 17:05:29,6,0,Is it possible to save EF changes to a different SQL server (connection string)?,"We have an ASP.NET application that will use several SQL servers with peer-to-peer transactional replication. Since the application doesn't do a lot of inserts/updates (perhaps 5% of all queries) we figured it would make sense that only one SQL server should be used for inserting/updating/deleting in order to avoid most conflict issues. All SQL servers will be used for selects in order to improve the performance.

Is it possible with EF4 to make sure that changes are only stored on the first SQL server? Overriding SaveChanges(..) and switching the connection string before saving comes as an idea but I am not sure if it is possible and if EF4 will like it.

If it is not possible then what are the best practices when using EF4 with multiple SQL servers and  peer-to-peer replication?",sql,entity-framework-4,replication,,,,open,0,132,14,"Is it possible to save EF changes to a different SQL server (connection string)? We have an ASP.NET application that will use several SQL servers with peer-to-peer transactional replication. Since the application doesn't do a lot of inserts/updates (perhaps 5% of all queries) we figured it would make sense that only one SQL server should be used for inserting/updating/deleting in order to avoid most conflict issues. All SQL servers will be used for selects in order to improve the performance.

Is it possible with EF4 to make sure that changes are only stored on the first SQL server? Overriding SaveChanges(..) and switching the connection string before saving comes as an idea but I am not sure if it is possible and if EF4 will like it.

If it is not possible then what are the best practices when using EF4 with multiple SQL servers and  peer-to-peer replication?",3
9883736,03/27/2012 05:18:49,735397,05/03/2011 03:21:36,1,0,Connect slient application to a remote database server,"I have a client and a server machines located in two different locations.Server machine has database server and the client machine has the application to that database.

 1. What is the best and the cost effictive method to access the database in the server from the cilent machine?
 2. What is the best method that i can use to avoid data lose cause by a network down?


Please note that both machines have internet.

Thank You!

",sql,networking,server,,,03/27/2012 16:20:07,not constructive,1,74,8,"Connect slient application to a remote database server I have a client and a server machines located in two different locations.Server machine has database server and the client machine has the application to that database.

 1. What is the best and the cost effictive method to access the database in the server from the cilent machine?
 2. What is the best method that i can use to avoid data lose cause by a network down?


Please note that both machines have internet.

Thank You!

",3
7838676,10/20/2011 15:52:58,996431,10/15/2011 02:40:34,31,0,SQL Server TRIM character,"I have the followig string: 'BOB*', how do I trim the * so it shows up as 'BOB'
I tried the RTRIM('BOB*','*') but does not work as says needs only 1 paramter.",sql,character,trim,,,,open,0,31,4,"SQL Server TRIM character I have the followig string: 'BOB*', how do I trim the * so it shows up as 'BOB'
I tried the RTRIM('BOB*','*') but does not work as says needs only 1 paramter.",3
11531409,07/17/2012 21:52:50,1521068,07/12/2012 14:20:54,6,0,Copy Table from SQL database to VB.NET database,"I have created a database (dbTest) and a table (tblFactSaleZ) in my VB (VS2010) project.

I would like to copy a table on our corporate SQL Server to my VB project database.

Here's what I've tried, and the results I've received.
    
        Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

        Dim con As SqlConnection = New SqlConnection(""Server = ovp-l-r8mxe5m;"" & ""Initial Catalog = dbTest;"" & ""Trusted_Connection=TRUE"")
        con.Open()

        Dim cmdA As SqlCommand = New SqlCommand(""SELECT * INTO tblFactSaleZ "" & _
                                                ""FROM [OVP-S-BPCDEVD].[CMP].[dbo].[tblFactSales] "" & _
                                                ""WHERE DATATYPE='FORECAST' AND TIMEID='20120700'"", con)

        cmdA.ExecuteNonQuery()

        MessageBox.Show(""Records Moved Successfully."", ""Move Complete"", _
            MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
    End Sub

RESULT: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)",sql,select-into,vb,,,08/01/2012 13:45:46,too localized,1,309,8,"Copy Table from SQL database to VB.NET database I have created a database (dbTest) and a table (tblFactSaleZ) in my VB (VS2010) project.

I would like to copy a table on our corporate SQL Server to my VB project database.

Here's what I've tried, and the results I've received.
    
        Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

        Dim con As SqlConnection = New SqlConnection(""Server = ovp-l-r8mxe5m;"" & ""Initial Catalog = dbTest;"" & ""Trusted_Connection=TRUE"")
        con.Open()

        Dim cmdA As SqlCommand = New SqlCommand(""SELECT * INTO tblFactSaleZ "" & _
                                                ""FROM [OVP-S-BPCDEVD].[CMP].[dbo].[tblFactSales] "" & _
                                                ""WHERE DATATYPE='FORECAST' AND TIMEID='20120700'"", con)

        cmdA.ExecuteNonQuery()

        MessageBox.Show(""Records Moved Successfully."", ""Move Complete"", _
            MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1)
    End Sub

RESULT: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)",3
6074144,05/20/2011 15:27:21,396335,07/19/2010 07:21:55,1101,34,Is SQL Server 2000 Free?,"Is SQL Server 2000 Free? I mean, can I use it for commercial use like SQL Server 2005 Express Edition?   ",sql,sql-server,,,,05/20/2011 15:30:48,off topic,1,23,5,"Is SQL Server 2000 Free? Is SQL Server 2000 Free? I mean, can I use it for commercial use like SQL Server 2005 Express Edition?   ",2
11671264,07/26/2012 14:15:55,1518362,07/11/2012 15:52:39,6,0,User friendly SQL query program?,"I doubt this could exist, but crazier things do. Is there a program or place where I could enter in just the tables/columns, and some criteria options and it will generate a working SQL query code for me?

I know there are programs that will make the code look all nice, but I mean truly generate the code/joins/FROMS/etc.

",sql,generate,,,,07/28/2012 11:01:09,not constructive,1,57,5,"User friendly SQL query program? I doubt this could exist, but crazier things do. Is there a program or place where I could enter in just the tables/columns, and some criteria options and it will generate a working SQL query code for me?

I know there are programs that will make the code look all nice, but I mean truly generate the code/joins/FROMS/etc.

",2
8571924,12/20/2011 07:10:07,725308,04/26/2011 11:51:24,52,1,SQL select with listing based on selected values,"I had a hard time coming up with a title, so I hope this is somewhat understandable...

I have the following table:

    items:  id|name|...|visibleItems

E.g. it contains:

     1|test1|...|2
     2|test2|...|1
     3|test3|...|2



This is then joined with another table (customers) and I would like to list it as follows:

     cust1|test1|...
     cust2|test1|...
     cust3|test2|...
     cust4|test3|...
     cust4|test3|...

...thus using the 'visibleItems' as the number for items listed. 

The SQL I have is something simple like:

    SELECT [values] FROM [tables] WHERE [statements] ORDER BY name


Does this make sense? If so, what to do? :)",sql,select,,,,,open,0,123,8,"SQL select with listing based on selected values I had a hard time coming up with a title, so I hope this is somewhat understandable...

I have the following table:

    items:  id|name|...|visibleItems

E.g. it contains:

     1|test1|...|2
     2|test2|...|1
     3|test3|...|2



This is then joined with another table (customers) and I would like to list it as follows:

     cust1|test1|...
     cust2|test1|...
     cust3|test2|...
     cust4|test3|...
     cust4|test3|...

...thus using the 'visibleItems' as the number for items listed. 

The SQL I have is something simple like:

    SELECT [values] FROM [tables] WHERE [statements] ORDER BY name


Does this make sense? If so, what to do? :)",2
6176382,05/30/2011 12:37:48,674547,03/24/2011 08:33:34,53,1,can we assign more than one variable in on SELECT Statement in SQL SERVER?,"can we assign  more than one variable in on SELECT Statement ?

LIKE

SELECT @variable1 = c1+c2  , @variable2 = c1-c2  from someView

it dosn't work in SQL SERVER
please help

Thanks...
",sql,sql-server-2005,tsql,sql-server-2008,,05/31/2011 14:56:16,not a real question,1,30,14,"can we assign more than one variable in on SELECT Statement in SQL SERVER? can we assign  more than one variable in on SELECT Statement ?

LIKE

SELECT @variable1 = c1+c2  , @variable2 = c1-c2  from someView

it dosn't work in SQL SERVER
please help

Thanks...
",4
7177707,08/24/2011 15:02:04,908380,08/23/2011 19:25:13,1,0,About exporting partial data using SQL Server,"I have a big SQL Server database, but I need to get some data from it for testing purpose. The problem is that as I said it is very large, and have many foreign keys in it. Is there any way to do some kind of ""partial data dump""?

Thanks!",sql,server,data,microsoft,dump,08/24/2011 20:03:41,not a real question,1,49,7,"About exporting partial data using SQL Server I have a big SQL Server database, but I need to get some data from it for testing purpose. The problem is that as I said it is very large, and have many foreign keys in it. Is there any way to do some kind of ""partial data dump""?

Thanks!",5
3315130,07/23/2010 03:16:39,392002,07/14/2010 19:48:38,1,1,Help forming a complex SQL statement,"I'm coming up stumped on forming a working SQL statement for a project of mine. First of all, I have a ""questions"" table and a ""response"" table. The response table is tied to the question table through a foreign id called ""question_id"" (tied to the questions ""id""). A question doesn't necessarily have to have a response, but the only working statement I can come up with will only pull a question that has a response, but I need it to show every question whether or not there is a response.

That SQL statement is:

`SELECT u.firstname, q.question, r.tutor_id, r.response FROM response r 
JOIN question q ON q.id = r.question_id
JOIN user u ON u.id = q.user_id`

My other problem is that I'm also trying to pull the firstname of the tutor, but can only pull the ""tutor_id"", so any help with that would also be awesome. If anyone has any tips, I'd appreciate it!",sql,mysql,database,table,join,,open,0,150,6,"Help forming a complex SQL statement I'm coming up stumped on forming a working SQL statement for a project of mine. First of all, I have a ""questions"" table and a ""response"" table. The response table is tied to the question table through a foreign id called ""question_id"" (tied to the questions ""id""). A question doesn't necessarily have to have a response, but the only working statement I can come up with will only pull a question that has a response, but I need it to show every question whether or not there is a response.

That SQL statement is:

`SELECT u.firstname, q.question, r.tutor_id, r.response FROM response r 
JOIN question q ON q.id = r.question_id
JOIN user u ON u.id = q.user_id`

My other problem is that I'm also trying to pull the firstname of the tutor, but can only pull the ""tutor_id"", so any help with that would also be awesome. If anyone has any tips, I'd appreciate it!",5
8153246,11/16/2011 14:28:46,1049836,11/16/2011 14:14:43,1,0,duplicate answers when predicate in more than one field SQL,"I'm so new to this that even the answers on questions similar to my one really don't make any sense to me (i started SQL last week)

I'm trying to list addresses from Table 1 where there are multiple in each address with the same first and surnames (ie John Smith and John Smith). I have first names and surnames in seperate fields. 

I tried 
`SELECT *
FROM addresses
WHERE EXISTS (
SELECT individuals.FirstName
AND individuals.Surname
FROM individuals
WHERE addresses.AddressID = individuals.AddressID
GROUP BY addresses.StreetName
HAVING COUNT( * ) >1`

but this just gives me a list of every address that has more than one person in it.. 
Can anyone give me a (simpleish) answer that I might get my head around. 
Thanks, Stacey",sql,predicates,,,,,open,0,114,10,"duplicate answers when predicate in more than one field SQL I'm so new to this that even the answers on questions similar to my one really don't make any sense to me (i started SQL last week)

I'm trying to list addresses from Table 1 where there are multiple in each address with the same first and surnames (ie John Smith and John Smith). I have first names and surnames in seperate fields. 

I tried 
`SELECT *
FROM addresses
WHERE EXISTS (
SELECT individuals.FirstName
AND individuals.Surname
FROM individuals
WHERE addresses.AddressID = individuals.AddressID
GROUP BY addresses.StreetName
HAVING COUNT( * ) >1`

but this just gives me a list of every address that has more than one person in it.. 
Can anyone give me a (simpleish) answer that I might get my head around. 
Thanks, Stacey",2
5342046,03/17/2011 16:25:40,124438,06/17/2009 15:35:08,552,15,MSSQL: how to acquire exclusive lock to prevent race condition?,"I have the following T-SQL code:

    SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
    BEGIN TRANSACTION T1_Test
    
        /*This is a dummy table used for ""locking"" 
    	and it doesn't contain any meaningful data.*/        
        UPDATE lockTable 
    		SET ID = 1    
    		WHERE ID = 1
    
        DECLARE @Count TINYINT 
        
        SELECT @Count = COUNT(*)
        FROM debugSP 
    
        WAITFOR DELAY '00:00:5';
    
        INSERT INTO debugSP 
    		(DateCreated, ClientId, Result)
        SELECT 
    		GETDATE(), @@SPID, @Count
    
    COMMIT TRANSACTION T1_Test

I am using ""locking"" hack marked with comment to acquire the exclusive lock.

NOTE: using TABLOCKX or UPDLOCK hints will not work because I have broken ATOMIC-ity by splitting statements and adding WAITFOR command in the middle for testing purposes.
I don't want something like that:

    INSERT INTO debugSP (DateCreated, ClientId, Result)
    SELECT GETDATE(), @@SPID, COUNT(*) 
    FROM debugSP

This is the correct result after running two simultaneous sessions (with lock table)

    Id DateCreated	         ClientId Result
    -- ----------------------- -------- ------
     1 2011-03-17 15:52:12.287       66      0
     2 2011-03-17 15:52:24.534       68      1

and that is the incorrect result of running the code with lock commented out

    Id DateCreated	         ClientId Result
    -- ----------------------- -------- ------
     1 2011-03-17 15:52:43.128       66      0
     2 2011-03-17 15:52:46.341       68      0


Is there a better way of acquiring transaction-wide exclusive lock without such hacks?",sql,sql-server,transactions,locking,isolation-level,,open,0,416,10,"MSSQL: how to acquire exclusive lock to prevent race condition? I have the following T-SQL code:

    SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
    BEGIN TRANSACTION T1_Test
    
        /*This is a dummy table used for ""locking"" 
    	and it doesn't contain any meaningful data.*/        
        UPDATE lockTable 
    		SET ID = 1    
    		WHERE ID = 1
    
        DECLARE @Count TINYINT 
        
        SELECT @Count = COUNT(*)
        FROM debugSP 
    
        WAITFOR DELAY '00:00:5';
    
        INSERT INTO debugSP 
    		(DateCreated, ClientId, Result)
        SELECT 
    		GETDATE(), @@SPID, @Count
    
    COMMIT TRANSACTION T1_Test

I am using ""locking"" hack marked with comment to acquire the exclusive lock.

NOTE: using TABLOCKX or UPDLOCK hints will not work because I have broken ATOMIC-ity by splitting statements and adding WAITFOR command in the middle for testing purposes.
I don't want something like that:

    INSERT INTO debugSP (DateCreated, ClientId, Result)
    SELECT GETDATE(), @@SPID, COUNT(*) 
    FROM debugSP

This is the correct result after running two simultaneous sessions (with lock table)

    Id DateCreated	         ClientId Result
    -- ----------------------- -------- ------
     1 2011-03-17 15:52:12.287       66      0
     2 2011-03-17 15:52:24.534       68      1

and that is the incorrect result of running the code with lock commented out

    Id DateCreated	         ClientId Result
    -- ----------------------- -------- ------
     1 2011-03-17 15:52:43.128       66      0
     2 2011-03-17 15:52:46.341       68      0


Is there a better way of acquiring transaction-wide exclusive lock without such hacks?",5
11196040,06/25/2012 19:28:59,1480877,06/25/2012 19:16:12,1,0,ASP.NET MVC - Complex Queries,"I'm new at MVC and I'm trying to find a strong architecture based on a complex projet I'm gona start. 

Regarding Data Layer and Business Logic (I come from ASP 2.0 and I was using a 3 layer logic) I'm trying to find out using MVC and matching the old ASP 2.0 how I build a class (old VB6 DLL) to split a search string (ex. ""bmw m5 in paris"") in a dynamic Query and execute it in SQL (Stored Procedure call from VB6 and void array has result).

Thank you.",sql,linq,query,mvc,complex,06/25/2012 23:39:13,not a real question,1,90,5,"ASP.NET MVC - Complex Queries I'm new at MVC and I'm trying to find a strong architecture based on a complex projet I'm gona start. 

Regarding Data Layer and Business Logic (I come from ASP 2.0 and I was using a 3 layer logic) I'm trying to find out using MVC and matching the old ASP 2.0 how I build a class (old VB6 DLL) to split a search string (ex. ""bmw m5 in paris"") in a dynamic Query and execute it in SQL (Stored Procedure call from VB6 and void array has result).

Thank you.",5
5429789,03/25/2011 07:42:38,240855,12/30/2009 12:14:16,68,2,select query for australian 1 up plan,"can someone give me the select query for australian 1 up plan?

explanation of australian 1 up plan:

say company the company is node ""zero"" 

say ""one"" is the root affiliate to join a company.(under ""zero"")
""two"" ""three"" ""four"" joins under ""one""(i,e with referal id of ""one"")

again in simailar manner 
""five"" ""six"" ""seven"" joins under ""two""
""eight"" ""nine""  ""ten"" joins under ""three""  and
""eleven"" ""twelve"" ""thirteen"" joins under ""four""


hope the diagram is clear in your mind till now (or plz draw it on a paper)

now the plan is every second member who joins under ""one"" becomes his downline.(here ""three"" and ""four"" are downlines of ""one""(""two"" is not ""one's"" downline cz ""one"" is passing ""two"" for his successor root ""zero"")

not only ""three"" and ""four"" are the downline of ""one"" but also every first member who joins under ""three"" or ""four"" (i,e under downline of ""one"") are also the downlines of ""one""
(i,e ""eight and ""eleven"" are also downline of ""one"")

(""five"" ""six"" seven"" are not downlines of ""one"" cz they are not the downline of downline of ""one"" i means they have joined under ""two"" who is not a downline of ""one"" thats why they are not in the tree)

                         one
                          |
        ----------------------------------------------------
        |                          |                       |
        two                       three                   four
         |                         |                       |
  ----------------------      ---------------------    ---------------------
  |      |             |       |       |          |     |        |         |
 five   six        seven      eight   nine      ten    eleven   twelve   thirteen



so finally i just need to have the select query to find all the downlines of ""one""


i will be really greatfull to get the answer.
",sql,,,,,03/26/2011 10:52:14,too localized,1,557,7,"select query for australian 1 up plan can someone give me the select query for australian 1 up plan?

explanation of australian 1 up plan:

say company the company is node ""zero"" 

say ""one"" is the root affiliate to join a company.(under ""zero"")
""two"" ""three"" ""four"" joins under ""one""(i,e with referal id of ""one"")

again in simailar manner 
""five"" ""six"" ""seven"" joins under ""two""
""eight"" ""nine""  ""ten"" joins under ""three""  and
""eleven"" ""twelve"" ""thirteen"" joins under ""four""


hope the diagram is clear in your mind till now (or plz draw it on a paper)

now the plan is every second member who joins under ""one"" becomes his downline.(here ""three"" and ""four"" are downlines of ""one""(""two"" is not ""one's"" downline cz ""one"" is passing ""two"" for his successor root ""zero"")

not only ""three"" and ""four"" are the downline of ""one"" but also every first member who joins under ""three"" or ""four"" (i,e under downline of ""one"") are also the downlines of ""one""
(i,e ""eight and ""eleven"" are also downline of ""one"")

(""five"" ""six"" seven"" are not downlines of ""one"" cz they are not the downline of downline of ""one"" i means they have joined under ""two"" who is not a downline of ""one"" thats why they are not in the tree)

                         one
                          |
        ----------------------------------------------------
        |                          |                       |
        two                       three                   four
         |                         |                       |
  ----------------------      ---------------------    ---------------------
  |      |             |       |       |          |     |        |         |
 five   six        seven      eight   nine      ten    eleven   twelve   thirteen



so finally i just need to have the select query to find all the downlines of ""one""


i will be really greatfull to get the answer.
",1
5353407,03/18/2011 14:28:39,250744,01/14/2010 14:00:19,6,0,"ms sql 2005, conversion failed for uniqueidentifier","i have the same trouble. 

Strored procedure is:

    USE [mytestdb]
    GO

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO

    ALTER PROCEDURE [dbo].[test_storedprocedure]
    	-- Add the parameters for the stored procedure here
    @MerchantID uniqueidentifier, 
    @CountMonth int out 
    
    AS
    BEGIN
And I call this procedure as

    USE [mytestdb]
    GO
    
    DECLARE	@return_value int,
    		@CountMonth int
    
    SELECT	@CountMonth = 0
    
    EXEC	@return_value = [dbo].[test_storedprocedure]
    		@MerchantID = '2C083422-A788-4343-A777-ACD406188F7D',
    		@CountMonth = @CountMonth OUTPUT
    
    SELECT	@CountMonth as N'@CountMonth'
    
    SELECT	'Return Value' = @return_value
    
    GO

and i have got the following error


> Msg 8169, Level 16, State 2, Procedure
> dlpws_StatByMerchant, Line 14
> Conversion failed when converting from
> a character string to
> uniqueidentifier.

can anybody help me with this?

PS: MS SQL 2005",sql,ms,,,,10/10/2011 07:28:33,too localized,1,204,7,"ms sql 2005, conversion failed for uniqueidentifier i have the same trouble. 

Strored procedure is:

    USE [mytestdb]
    GO

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO

    ALTER PROCEDURE [dbo].[test_storedprocedure]
    	-- Add the parameters for the stored procedure here
    @MerchantID uniqueidentifier, 
    @CountMonth int out 
    
    AS
    BEGIN
And I call this procedure as

    USE [mytestdb]
    GO
    
    DECLARE	@return_value int,
    		@CountMonth int
    
    SELECT	@CountMonth = 0
    
    EXEC	@return_value = [dbo].[test_storedprocedure]
    		@MerchantID = '2C083422-A788-4343-A777-ACD406188F7D',
    		@CountMonth = @CountMonth OUTPUT
    
    SELECT	@CountMonth as N'@CountMonth'
    
    SELECT	'Return Value' = @return_value
    
    GO

and i have got the following error


> Msg 8169, Level 16, State 2, Procedure
> dlpws_StatByMerchant, Line 14
> Conversion failed when converting from
> a character string to
> uniqueidentifier.

can anybody help me with this?

PS: MS SQL 2005",2
9008292,01/25/2012 18:39:21,1169846,01/25/2012 18:31:36,1,0,How to retrieve all indexes in a database along with their data types in SQL Server 2005?,"I have a maintenance task that's failing because there are a few indexes on the database that have a type which does not allow online rebuilding of the index. Offline is not an option in my industry, so I have to create my own T-SQL task that does the index rebuilding on specific indexes. The database is large with many tables and indexes, so is there a way to query the system for all indexes and their data types?",sql,indexing,maintenance-plan,,,,open,0,79,17,"How to retrieve all indexes in a database along with their data types in SQL Server 2005? I have a maintenance task that's failing because there are a few indexes on the database that have a type which does not allow online rebuilding of the index. Offline is not an option in my industry, so I have to create my own T-SQL task that does the index rebuilding on specific indexes. The database is large with many tables and indexes, so is there a way to query the system for all indexes and their data types?",3
8447074,12/09/2011 14:40:40,161922,09/15/2008 21:12:35,2713,76,Running a set returning function on all the rows in a postgres table and getting all the results back,"I have a PostgreSQL 9.1 database with a svn version of PostGIS 2.0. I have a set returning function from postgis (ST_DumpAsPolygon), which takes one row and returns many rows. I have a table of data and want to run the set returning function on each row of the input and return all the rows. However ``SELECT ST_DumpAsPolygon(rast) FROM mytable`` seems to return the values from only one row. Is there some way to get the set returning function to run on every row in the table, and collect all the results together, and return all those results?",sql,postgresql,postgis,postgresql-9.1,,12/09/2011 19:54:15,too localized,1,98,19,"Running a set returning function on all the rows in a postgres table and getting all the results back I have a PostgreSQL 9.1 database with a svn version of PostGIS 2.0. I have a set returning function from postgis (ST_DumpAsPolygon), which takes one row and returns many rows. I have a table of data and want to run the set returning function on each row of the input and return all the rows. However ``SELECT ST_DumpAsPolygon(rast) FROM mytable`` seems to return the values from only one row. Is there some way to get the set returning function to run on every row in the table, and collect all the results together, and return all those results?",4
5667304,04/14/2011 17:42:47,379378,11/20/2009 19:23:31,3927,294,How to improve performance of SQL MERGE statement,"I have a job that I am currenlty running to sync data between two databases on different internal servers. The one server is the backend database for the HEAT product from FrontRange. The second is our own reporting database we are using for report writing and other internal uses. 

Our first approach at the job went something like this:
Query all the data from the HEAT database tables we wanted and populate local temp tables. Then copy that data out to the appropriate table. That would work but they use to TRUNCATE the table every time and repopulate without doing anything for indexes or fragmentation. So I thought well this could be a good candidate to use the SQL merge statement.

So our second approach used a merge statement for each of the tables. It greatly improved the speed of the process but it seems to be locking the source table up so that users are noticing 15-30 second delays when they try to save information. To make the merge only handle records that have had changes or are new I added the BINARY_CHECKSUM function on the select and store it on my side so that I can avoid updating records that haven't changed. Seems expensive though to call that for every record. This table has about ~300k records.

I am wondering is there a better approach to try and synchronize these two tables that I am overlooking. My only constraint is that I really do not want to change anything on the source tables because it is a third party application.

Here is my mege statement I am using for the CallLog table:

    -- Merge CallLog
    MERGE INTO [CallLog] AS T
    USING (
    		SELECT
    			[CallID], [CustID], [CustType], [CallType], [Tracker], [CallStatus], [Priority], [CDuration], [CallCount], [StopWatch], [ClosedBy],
    			[ClosedDate], [ClosedTime], [Cause], [CallDesc], [CloseDesc], [RecvdBy], [RecvdDate], [RecvdTime], [ModBy], [ModDate], [ModTime],
    			[DTLastMod], [CallSource], [PriorityName], [QuickCall], [Category], [TotalAsgnmntTime], [CatHeading], [TotalJournalTime],
    			[TotalTime], [SL_Warn_Goal], [SL_Warn_Date], [SL_Warn_Time], [SL_Complete_Goal], [SL_Complete_Date], [SL_Complete_Time],
    			[SL_Clock_Status], [SL_Button_Status], [FirstResolution], [SL_Complete_Status], [SubCallType], [ImpactValue], [ImpactName],
    			[UrgencyValue], [UrgencyName], [LinkedToProblem], [LinkedToProblemCustID], [LinkedToProblemName], [LinkedToProblemBy],
    			[LinkedToProblemDate], [LinkedToProblemTime], [SLAStatus], [issue_text], [issue_number], [ResCheck], [AsgnAckBy], [AsgnAckDate],
    			[AsgnAckTime], [Resolvedby], [ResolvedDate], [ResolvedTime], [ACheck], [ACKEmail], [LinkedToChange], [LinkedToChangeCustID],
    			[LinkedToChangeName], [LinkedToChangeBy], [LInkedToChangeDate], [LinkedToChangeTime], [IssueTypeProblem], [IssueTypeChange],
    			[RespWarningD], [RespWarningT], [RespMissedD], [RespMissedT], [ResoWarningD], [ResoWarningT], [ResoMissedD], [ResoMissedT],
    			[IssueType], [SubCategory], [Diagnosis], [HSSAlert], [ErrorMessage], [ProblemType], [diagnosising], [KB], [CloseStatus],
    			[SuggestedAssignGrp], [DefaultGrp], [DefaultGrpTF], [OtherAssign], [WorkAround], [ChangeReason], [CloseProblem], [AssgnApp],
    			[AssgnAppRes], [DenyChk], [ImplementationApp], [ImplementationAppRes], [WorkAroundChk], [NoDenyChk], [ImpNoDenyChk],
    			[ImpDenyChk], [ChangeStatus], [ReadyToClose], [ResolveOrReAssign], [TicketLabel], [CatCallType], [IssueType_PK], [Category_PK],
    			[SubCategory_PK], [CallType_PK], [SubCallType_PK], BINARY_CHECKSUM(*) AS [Checksum]
    		FROM
    			[CHLA-HEATDB].SDIT.dbo.calllog
    	) AS S
    ON (T.[CallID] = S.[CallID])
    WHEN MATCHED AND T.[Checksum] <> S.[Checksum] THEN 
        UPDATE SET
    		T.[CallID] = S.[CallID], T.[CustID] = S.[CustID], T.[CustType] = S.[CustType], T.[CallType] = S.[CallType],
    		T.[Tracker] = S.[Tracker], t.[CallStatus] = S.[CallStatus], T.[Priority] = S.[Priority], T.[CDuration] = S.[CDuration],
    		T.[CallCount] = S.[CallCount], T.[StopWatch] = S.[StopWatch], T.[ClosedBy] = S.[ClosedBy],
    		T.[ClosedDate] = S.[ClosedDate], T.[ClosedTime] = S.[ClosedTime], T.[Cause] = S.[Cause], T.[CallDesc] = S.[CallDesc],
    		T.[CloseDesc] = S.[CloseDesc], T.[RecvdBy] = S.[RecvdBy], T.[RecvdDate] = S.[RecvdDate], T.[RecvdTime] = S.[RecvdTime],
    		T.[ModBy] = S.[ModBy], T.[ModDate] = S.[ModDate], T.[ModTime] = S.[ModTime], T.[DTLastMod] = S.[DTLastMod],
    		T.[CallSource] = S.[CallSource], T.[PriorityName] = S.[PriorityName], T.[QuickCall] = S.[QuickCall],
    		T.[Category] = S.[Category], T.[TotalAsgnmntTime] = S.[TotalAsgnmntTime], T.[CatHeading] = S.[CatHeading],
    		T.[TotalJournalTime] = S.[TotalJournalTime], T.[TotalTime] = S.[TotalTime], T.[SL_Warn_Goal] = S.[SL_Warn_Goal],
    		T.[SL_Warn_Date] = S.[SL_Warn_Date], T.[SL_Warn_Time] = S.[SL_Warn_Time], T.[SL_Complete_Goal] = S.[SL_Complete_Goal],
    		T.[SL_Complete_Date] = S.[SL_Complete_Date], T.[SL_Complete_Time] = S.[SL_Complete_Time],
    		T.[SL_Clock_Status] = S.[SL_Clock_Status], T.[SL_Button_Status] = S.[SL_Button_Status],
    		T.[FirstResolution] = S.[FirstResolution], T.[SL_Complete_Status] = S.[SL_Complete_Status],
    		T.[SubCallType] = S.[SubCallType], T.[ImpactValue] = S.[ImpactValue], T.[ImpactName] = S.[ImpactName],
    		T.[UrgencyValue] = S.[UrgencyValue], T.[UrgencyName] = S.[UrgencyName], T.[LinkedToProblem] = S.[LinkedToProblem],
    		T.[LinkedToProblemCustID] = S.[LinkedToProblemCustID], T.[LinkedToProblemName] = S.[LinkedToProblemName],
    		T.[LinkedToProblemBy] = S.[LinkedToProblemBy], T.[LinkedToProblemDate] = S.[LinkedToProblemDate],
    		T.[LinkedToProblemTime] = S.[LinkedToProblemTime], T.[SLAStatus] = S.[SLAStatus], T.[issue_text] = S.[issue_text],
    		T.[issue_number] = S.[issue_number], T.[ResCheck] = S.[ResCheck], T.[AsgnAckBy] = S.[AsgnAckBy],
    		T.[AsgnAckDate] = S.[AsgnAckDate], T.[AsgnAckTime] = S.[AsgnAckTime], T.[Resolvedby] = S.[Resolvedby],
    		T.[ResolvedDate] = S.[ResolvedDate], T.[ResolvedTime] = S.[ResolvedTime], T.[ACheck] = S.[ACheck],
    		T.[ACKEmail] = S.[ACKEmail], T.[LinkedToChange] = S.[LinkedToChange], T.[LinkedToChangeCustID] = S.[LinkedToChangeCustID],
    		T.[LinkedToChangeName] = S.[LinkedToChangeName], T.[LinkedToChangeBy] = S.[LinkedToChangeBy],
    		T.[LInkedToChangeDate] = S.[LInkedToChangeDate], T.[LinkedToChangeTime] = S.[LinkedToChangeTime],
    		T.[IssueTypeProblem] = S.[IssueTypeProblem], T.[IssueTypeChange] = S.[IssueTypeChange],
    		T.[RespWarningD] = S.[RespWarningD], T.[RespWarningT] = S.[RespWarningT], T.[RespMissedD] = S.[RespMissedD],
    		T.[RespMissedT] = S.[RespMissedT], T.[ResoWarningD] = S.[ResoWarningD], T.[ResoWarningT] = S.[ResoWarningT],
    		T.[ResoMissedD] = S.[ResoMissedD], T.[ResoMissedT] = S.[ResoMissedT], T.[IssueType] = S.[IssueType],
    		T.[SubCategory] = S.[SubCategory], T.[Diagnosis] = S.[Diagnosis], T.[HSSAlert] = S.[HSSAlert],
    		T.[ErrorMessage] = S.[ErrorMessage], T.[ProblemType] = S.[ProblemType], T.[diagnosising] = S.[diagnosising],
    		T.[KB] = S.[KB], T.[CloseStatus] = S.[CloseStatus], T.[SuggestedAssignGrp] = S.[SuggestedAssignGrp],
    		T.[DefaultGrp] = S.[DefaultGrp], T.[DefaultGrpTF] = S.[DefaultGrpTF], T.[OtherAssign] = S.[OtherAssign],
    		T.[WorkAround] = S.[WorkAround], T.[ChangeReason] = S.[ChangeReason], T.[CloseProblem] = S.[CloseProblem],
    		T.[AssgnApp] = S.[AssgnApp], T.[AssgnAppRes] = S.[AssgnAppRes], T.[DenyChk] = S.[DenyChk],
    		T.[ImplementationApp] = S.[ImplementationApp], T.[ImplementationAppRes] = S.[ImplementationAppRes],
    		T.[WorkAroundChk] = S.[WorkAroundChk], T.[NoDenyChk] = S.[NoDenyChk], T.[ImpNoDenyChk] = S.[ImpNoDenyChk],
    		T.[ImpDenyChk] = S.[ImpDenyChk], T.[ChangeStatus] = S.[ChangeStatus], T.[ReadyToClose] = S.[ReadyToClose],
    		T.[ResolveOrReAssign] = S.[ResolveOrReAssign], T.[TicketLabel] = S.[TicketLabel], T.[CatCallType] = S.[CatCallType],
    		T.[IssueType_PK] = S.[IssueType_PK], T.[Category_PK] = S.[Category_PK], T.[SubCategory_PK] = S.[SubCategory_PK],
    		T.[CallType_PK] = S.[CallType_PK], T.[SubCallType_PK] = S.[SubCallType_PK], T.[Checksum] = S.[Checksum]
    WHEN NOT MATCHED 
        THEN INSERT VALUES
        (
    		S.[CallID], S.[CustID], S.[CustType], S.[CallType], S.[Tracker], S.[CallStatus], S.[Priority], S.[CDuration],
    		S.[CallCount], S.[StopWatch], S.[ClosedBy], S.[ClosedDate], S.[ClosedTime], S.[Cause], S.[CallDesc], S.[CloseDesc],
    		S.[RecvdBy], S.[RecvdDate], S.[RecvdTime], S.[ModBy], S.[ModDate], S.[ModTime], S.[DTLastMod], S.[CallSource],
    		S.[PriorityName], S.[QuickCall], S.[Category], S.[TotalAsgnmntTime], S.[CatHeading], S.[TotalJournalTime], S.[TotalTime],
    		S.[SL_Warn_Goal], S.[SL_Warn_Date], S.[SL_Warn_Time], S.[SL_Complete_Goal], S.[SL_Complete_Date], S.[SL_Complete_Time],
    		S.[SL_Clock_Status], S.[SL_Button_Status], S.[FirstResolution], S.[SL_Complete_Status], S.[SubCallType], S.[ImpactValue],
    		S.[ImpactName], S.[UrgencyValue], S.[UrgencyName], S.[LinkedToProblem], S.[LinkedToProblemCustID], S.[LinkedToProblemName],
    		S.[LinkedToProblemBy], S.[LinkedToProblemDate], S.[LinkedToProblemTime], S.[SLAStatus], S.[issue_text], S.[issue_number],
    		S.[ResCheck], S.[AsgnAckBy], S.[AsgnAckDate], S.[AsgnAckTime], S.[Resolvedby], S.[ResolvedDate], S.[ResolvedTime], S.[ACheck],
    		S.[ACKEmail], S.[LinkedToChange], S.[LinkedToChangeCustID], S.[LinkedToChangeName], S.[LinkedToChangeBy],
    		S.[LInkedToChangeDate], S.[LinkedToChangeTime], S.[IssueTypeProblem], S.[IssueTypeChange], S.[RespWarningD],
    		S.[RespWarningT], S.[RespMissedD], S.[RespMissedT], S.[ResoWarningD], S.[ResoWarningT], S.[ResoMissedD], S.[ResoMissedT],
    		S.[IssueType], S.[SubCategory], S.[Diagnosis], S.[HSSAlert], S.[ErrorMessage], S.[ProblemType], S.[diagnosising], S.[KB],
    		S.[CloseStatus], S.[SuggestedAssignGrp], S.[DefaultGrp], S.[DefaultGrpTF], S.[OtherAssign], S.[WorkAround], S.[ChangeReason],
    		S.[CloseProblem], S.[AssgnApp], S.[AssgnAppRes], S.[DenyChk], S.[ImplementationApp], S.[ImplementationAppRes],
    		S.[WorkAroundChk], S.[NoDenyChk], S.[ImpNoDenyChk], S.[ImpDenyChk], S.[ChangeStatus], S.[ReadyToClose],
    		S.[ResolveOrReAssign], S.[TicketLabel], S.[CatCallType], S.[IssueType_PK], S.[Category_PK], S.[SubCategory_PK],
    		S.[CallType_PK], S.[SubCallType_PK], S.[Checksum]
    	);
    GO",sql,sql-server,sql-server-2008,heat,data-synchronization,,open,0,1168,8,"How to improve performance of SQL MERGE statement I have a job that I am currenlty running to sync data between two databases on different internal servers. The one server is the backend database for the HEAT product from FrontRange. The second is our own reporting database we are using for report writing and other internal uses. 

Our first approach at the job went something like this:
Query all the data from the HEAT database tables we wanted and populate local temp tables. Then copy that data out to the appropriate table. That would work but they use to TRUNCATE the table every time and repopulate without doing anything for indexes or fragmentation. So I thought well this could be a good candidate to use the SQL merge statement.

So our second approach used a merge statement for each of the tables. It greatly improved the speed of the process but it seems to be locking the source table up so that users are noticing 15-30 second delays when they try to save information. To make the merge only handle records that have had changes or are new I added the BINARY_CHECKSUM function on the select and store it on my side so that I can avoid updating records that haven't changed. Seems expensive though to call that for every record. This table has about ~300k records.

I am wondering is there a better approach to try and synchronize these two tables that I am overlooking. My only constraint is that I really do not want to change anything on the source tables because it is a third party application.

Here is my mege statement I am using for the CallLog table:

    -- Merge CallLog
    MERGE INTO [CallLog] AS T
    USING (
    		SELECT
    			[CallID], [CustID], [CustType], [CallType], [Tracker], [CallStatus], [Priority], [CDuration], [CallCount], [StopWatch], [ClosedBy],
    			[ClosedDate], [ClosedTime], [Cause], [CallDesc], [CloseDesc], [RecvdBy], [RecvdDate], [RecvdTime], [ModBy], [ModDate], [ModTime],
    			[DTLastMod], [CallSource], [PriorityName], [QuickCall], [Category], [TotalAsgnmntTime], [CatHeading], [TotalJournalTime],
    			[TotalTime], [SL_Warn_Goal], [SL_Warn_Date], [SL_Warn_Time], [SL_Complete_Goal], [SL_Complete_Date], [SL_Complete_Time],
    			[SL_Clock_Status], [SL_Button_Status], [FirstResolution], [SL_Complete_Status], [SubCallType], [ImpactValue], [ImpactName],
    			[UrgencyValue], [UrgencyName], [LinkedToProblem], [LinkedToProblemCustID], [LinkedToProblemName], [LinkedToProblemBy],
    			[LinkedToProblemDate], [LinkedToProblemTime], [SLAStatus], [issue_text], [issue_number], [ResCheck], [AsgnAckBy], [AsgnAckDate],
    			[AsgnAckTime], [Resolvedby], [ResolvedDate], [ResolvedTime], [ACheck], [ACKEmail], [LinkedToChange], [LinkedToChangeCustID],
    			[LinkedToChangeName], [LinkedToChangeBy], [LInkedToChangeDate], [LinkedToChangeTime], [IssueTypeProblem], [IssueTypeChange],
    			[RespWarningD], [RespWarningT], [RespMissedD], [RespMissedT], [ResoWarningD], [ResoWarningT], [ResoMissedD], [ResoMissedT],
    			[IssueType], [SubCategory], [Diagnosis], [HSSAlert], [ErrorMessage], [ProblemType], [diagnosising], [KB], [CloseStatus],
    			[SuggestedAssignGrp], [DefaultGrp], [DefaultGrpTF], [OtherAssign], [WorkAround], [ChangeReason], [CloseProblem], [AssgnApp],
    			[AssgnAppRes], [DenyChk], [ImplementationApp], [ImplementationAppRes], [WorkAroundChk], [NoDenyChk], [ImpNoDenyChk],
    			[ImpDenyChk], [ChangeStatus], [ReadyToClose], [ResolveOrReAssign], [TicketLabel], [CatCallType], [IssueType_PK], [Category_PK],
    			[SubCategory_PK], [CallType_PK], [SubCallType_PK], BINARY_CHECKSUM(*) AS [Checksum]
    		FROM
    			[CHLA-HEATDB].SDIT.dbo.calllog
    	) AS S
    ON (T.[CallID] = S.[CallID])
    WHEN MATCHED AND T.[Checksum] <> S.[Checksum] THEN 
        UPDATE SET
    		T.[CallID] = S.[CallID], T.[CustID] = S.[CustID], T.[CustType] = S.[CustType], T.[CallType] = S.[CallType],
    		T.[Tracker] = S.[Tracker], t.[CallStatus] = S.[CallStatus], T.[Priority] = S.[Priority], T.[CDuration] = S.[CDuration],
    		T.[CallCount] = S.[CallCount], T.[StopWatch] = S.[StopWatch], T.[ClosedBy] = S.[ClosedBy],
    		T.[ClosedDate] = S.[ClosedDate], T.[ClosedTime] = S.[ClosedTime], T.[Cause] = S.[Cause], T.[CallDesc] = S.[CallDesc],
    		T.[CloseDesc] = S.[CloseDesc], T.[RecvdBy] = S.[RecvdBy], T.[RecvdDate] = S.[RecvdDate], T.[RecvdTime] = S.[RecvdTime],
    		T.[ModBy] = S.[ModBy], T.[ModDate] = S.[ModDate], T.[ModTime] = S.[ModTime], T.[DTLastMod] = S.[DTLastMod],
    		T.[CallSource] = S.[CallSource], T.[PriorityName] = S.[PriorityName], T.[QuickCall] = S.[QuickCall],
    		T.[Category] = S.[Category], T.[TotalAsgnmntTime] = S.[TotalAsgnmntTime], T.[CatHeading] = S.[CatHeading],
    		T.[TotalJournalTime] = S.[TotalJournalTime], T.[TotalTime] = S.[TotalTime], T.[SL_Warn_Goal] = S.[SL_Warn_Goal],
    		T.[SL_Warn_Date] = S.[SL_Warn_Date], T.[SL_Warn_Time] = S.[SL_Warn_Time], T.[SL_Complete_Goal] = S.[SL_Complete_Goal],
    		T.[SL_Complete_Date] = S.[SL_Complete_Date], T.[SL_Complete_Time] = S.[SL_Complete_Time],
    		T.[SL_Clock_Status] = S.[SL_Clock_Status], T.[SL_Button_Status] = S.[SL_Button_Status],
    		T.[FirstResolution] = S.[FirstResolution], T.[SL_Complete_Status] = S.[SL_Complete_Status],
    		T.[SubCallType] = S.[SubCallType], T.[ImpactValue] = S.[ImpactValue], T.[ImpactName] = S.[ImpactName],
    		T.[UrgencyValue] = S.[UrgencyValue], T.[UrgencyName] = S.[UrgencyName], T.[LinkedToProblem] = S.[LinkedToProblem],
    		T.[LinkedToProblemCustID] = S.[LinkedToProblemCustID], T.[LinkedToProblemName] = S.[LinkedToProblemName],
    		T.[LinkedToProblemBy] = S.[LinkedToProblemBy], T.[LinkedToProblemDate] = S.[LinkedToProblemDate],
    		T.[LinkedToProblemTime] = S.[LinkedToProblemTime], T.[SLAStatus] = S.[SLAStatus], T.[issue_text] = S.[issue_text],
    		T.[issue_number] = S.[issue_number], T.[ResCheck] = S.[ResCheck], T.[AsgnAckBy] = S.[AsgnAckBy],
    		T.[AsgnAckDate] = S.[AsgnAckDate], T.[AsgnAckTime] = S.[AsgnAckTime], T.[Resolvedby] = S.[Resolvedby],
    		T.[ResolvedDate] = S.[ResolvedDate], T.[ResolvedTime] = S.[ResolvedTime], T.[ACheck] = S.[ACheck],
    		T.[ACKEmail] = S.[ACKEmail], T.[LinkedToChange] = S.[LinkedToChange], T.[LinkedToChangeCustID] = S.[LinkedToChangeCustID],
    		T.[LinkedToChangeName] = S.[LinkedToChangeName], T.[LinkedToChangeBy] = S.[LinkedToChangeBy],
    		T.[LInkedToChangeDate] = S.[LInkedToChangeDate], T.[LinkedToChangeTime] = S.[LinkedToChangeTime],
    		T.[IssueTypeProblem] = S.[IssueTypeProblem], T.[IssueTypeChange] = S.[IssueTypeChange],
    		T.[RespWarningD] = S.[RespWarningD], T.[RespWarningT] = S.[RespWarningT], T.[RespMissedD] = S.[RespMissedD],
    		T.[RespMissedT] = S.[RespMissedT], T.[ResoWarningD] = S.[ResoWarningD], T.[ResoWarningT] = S.[ResoWarningT],
    		T.[ResoMissedD] = S.[ResoMissedD], T.[ResoMissedT] = S.[ResoMissedT], T.[IssueType] = S.[IssueType],
    		T.[SubCategory] = S.[SubCategory], T.[Diagnosis] = S.[Diagnosis], T.[HSSAlert] = S.[HSSAlert],
    		T.[ErrorMessage] = S.[ErrorMessage], T.[ProblemType] = S.[ProblemType], T.[diagnosising] = S.[diagnosising],
    		T.[KB] = S.[KB], T.[CloseStatus] = S.[CloseStatus], T.[SuggestedAssignGrp] = S.[SuggestedAssignGrp],
    		T.[DefaultGrp] = S.[DefaultGrp], T.[DefaultGrpTF] = S.[DefaultGrpTF], T.[OtherAssign] = S.[OtherAssign],
    		T.[WorkAround] = S.[WorkAround], T.[ChangeReason] = S.[ChangeReason], T.[CloseProblem] = S.[CloseProblem],
    		T.[AssgnApp] = S.[AssgnApp], T.[AssgnAppRes] = S.[AssgnAppRes], T.[DenyChk] = S.[DenyChk],
    		T.[ImplementationApp] = S.[ImplementationApp], T.[ImplementationAppRes] = S.[ImplementationAppRes],
    		T.[WorkAroundChk] = S.[WorkAroundChk], T.[NoDenyChk] = S.[NoDenyChk], T.[ImpNoDenyChk] = S.[ImpNoDenyChk],
    		T.[ImpDenyChk] = S.[ImpDenyChk], T.[ChangeStatus] = S.[ChangeStatus], T.[ReadyToClose] = S.[ReadyToClose],
    		T.[ResolveOrReAssign] = S.[ResolveOrReAssign], T.[TicketLabel] = S.[TicketLabel], T.[CatCallType] = S.[CatCallType],
    		T.[IssueType_PK] = S.[IssueType_PK], T.[Category_PK] = S.[Category_PK], T.[SubCategory_PK] = S.[SubCategory_PK],
    		T.[CallType_PK] = S.[CallType_PK], T.[SubCallType_PK] = S.[SubCallType_PK], T.[Checksum] = S.[Checksum]
    WHEN NOT MATCHED 
        THEN INSERT VALUES
        (
    		S.[CallID], S.[CustID], S.[CustType], S.[CallType], S.[Tracker], S.[CallStatus], S.[Priority], S.[CDuration],
    		S.[CallCount], S.[StopWatch], S.[ClosedBy], S.[ClosedDate], S.[ClosedTime], S.[Cause], S.[CallDesc], S.[CloseDesc],
    		S.[RecvdBy], S.[RecvdDate], S.[RecvdTime], S.[ModBy], S.[ModDate], S.[ModTime], S.[DTLastMod], S.[CallSource],
    		S.[PriorityName], S.[QuickCall], S.[Category], S.[TotalAsgnmntTime], S.[CatHeading], S.[TotalJournalTime], S.[TotalTime],
    		S.[SL_Warn_Goal], S.[SL_Warn_Date], S.[SL_Warn_Time], S.[SL_Complete_Goal], S.[SL_Complete_Date], S.[SL_Complete_Time],
    		S.[SL_Clock_Status], S.[SL_Button_Status], S.[FirstResolution], S.[SL_Complete_Status], S.[SubCallType], S.[ImpactValue],
    		S.[ImpactName], S.[UrgencyValue], S.[UrgencyName], S.[LinkedToProblem], S.[LinkedToProblemCustID], S.[LinkedToProblemName],
    		S.[LinkedToProblemBy], S.[LinkedToProblemDate], S.[LinkedToProblemTime], S.[SLAStatus], S.[issue_text], S.[issue_number],
    		S.[ResCheck], S.[AsgnAckBy], S.[AsgnAckDate], S.[AsgnAckTime], S.[Resolvedby], S.[ResolvedDate], S.[ResolvedTime], S.[ACheck],
    		S.[ACKEmail], S.[LinkedToChange], S.[LinkedToChangeCustID], S.[LinkedToChangeName], S.[LinkedToChangeBy],
    		S.[LInkedToChangeDate], S.[LinkedToChangeTime], S.[IssueTypeProblem], S.[IssueTypeChange], S.[RespWarningD],
    		S.[RespWarningT], S.[RespMissedD], S.[RespMissedT], S.[ResoWarningD], S.[ResoWarningT], S.[ResoMissedD], S.[ResoMissedT],
    		S.[IssueType], S.[SubCategory], S.[Diagnosis], S.[HSSAlert], S.[ErrorMessage], S.[ProblemType], S.[diagnosising], S.[KB],
    		S.[CloseStatus], S.[SuggestedAssignGrp], S.[DefaultGrp], S.[DefaultGrpTF], S.[OtherAssign], S.[WorkAround], S.[ChangeReason],
    		S.[CloseProblem], S.[AssgnApp], S.[AssgnAppRes], S.[DenyChk], S.[ImplementationApp], S.[ImplementationAppRes],
    		S.[WorkAroundChk], S.[NoDenyChk], S.[ImpNoDenyChk], S.[ImpDenyChk], S.[ChangeStatus], S.[ReadyToClose],
    		S.[ResolveOrReAssign], S.[TicketLabel], S.[CatCallType], S.[IssueType_PK], S.[Category_PK], S.[SubCategory_PK],
    		S.[CallType_PK], S.[SubCallType_PK], S.[Checksum]
    	);
    GO",5
4311067,11/30/2010 06:17:59,128463,06/24/2009 20:36:58,2579,82,Good peice of software for practicing SQL on Windows?,"I brought 31 queries down to 3 for a certain page in my application by using a single join (provided by Django's ORM). Up until that very moment I thought of SQL optimization as something I didn't need to worry about. I instantly realized that there are probably so many areas that run slow which could use some SQL tomFOOlery (SQL FOO is for professionals).

Now I'm looking for a piece of open source software that will allow me to quickly create databases, and tables with a GUI, so I can quickly add data and experiment with queries. Is Access good for this (aside from not being free or open source)? Or, does Access use it's own SQL syntax?",sql,database,query,software-tools,,11/03/2011 15:22:43,not constructive,1,118,9,"Good peice of software for practicing SQL on Windows? I brought 31 queries down to 3 for a certain page in my application by using a single join (provided by Django's ORM). Up until that very moment I thought of SQL optimization as something I didn't need to worry about. I instantly realized that there are probably so many areas that run slow which could use some SQL tomFOOlery (SQL FOO is for professionals).

Now I'm looking for a piece of open source software that will allow me to quickly create databases, and tables with a GUI, so I can quickly add data and experiment with queries. Is Access good for this (aside from not being free or open source)? Or, does Access use it's own SQL syntax?",4
4959610,02/10/2011 16:12:27,416791,08/11/2010 02:28:37,130,4,SQL: Chaining Joins Efficiency,"I have a query in my WordPress plugin like this:

    SELECT users.*, U.`meta_value` AS first_name,M.`meta_value` AS last_name FROM `nwp_users` AS users LEFT JOIN `nwp_usermeta` U ON users.`ID`=U.`user_id` LEFT JOIN `nwp_usermeta` M ON users.`ID`=M.`user_id` LEFT JOIN `nwp_usermeta` C ON users.`ID`=C.`user_id` WHERE U.meta_key = 'first_name' AND M.meta_key = 'last_name' AND C.meta_key = 'nwp_capabilities' ORDER BY users.`user_login` ASC LIMIT 0,10

I'm new to using JOINs and I'm wondering how efficient it is to use so many JOINs in one query. Is it better to split it up into multiple queries?",sql,mysql,performance,,,,open,0,89,4,"SQL: Chaining Joins Efficiency I have a query in my WordPress plugin like this:

    SELECT users.*, U.`meta_value` AS first_name,M.`meta_value` AS last_name FROM `nwp_users` AS users LEFT JOIN `nwp_usermeta` U ON users.`ID`=U.`user_id` LEFT JOIN `nwp_usermeta` M ON users.`ID`=M.`user_id` LEFT JOIN `nwp_usermeta` C ON users.`ID`=C.`user_id` WHERE U.meta_key = 'first_name' AND M.meta_key = 'last_name' AND C.meta_key = 'nwp_capabilities' ORDER BY users.`user_login` ASC LIMIT 0,10

I'm new to using JOINs and I'm wondering how efficient it is to use so many JOINs in one query. Is it better to split it up into multiple queries?",3
9311840,02/16/2012 13:09:29,944940,09/14/2011 15:11:52,6,1,Select newest record where multiple records exist from where/like statement,"Forgive me if the tite (and my SQL knowledge) seems a bit vague but I will try and explain as clearly as I can.

I have a table DVE_GroupMember, in which Person_StaffNumber is a unique identifier for a person. In this table is a column GroupMember_GroupName which contains a group name that a person can be assigned to. There is also column GroupMember_StartDate which signified when that person was assigned to that GroupMember_GroupName. A person can have been assigned to various groups over a period of time, so if I run the following SQL, I get multiple results for the various Person_StaffNumber values in the database (where the group name contains 'muster')

    select * from DVE_GroupMember where GroupMember_GroupName like 'muster%'

What I am trying to do, is select the most recent GroupMember_GroupName that each person has been assigned to.

I have tried the following syntax but it is generating the error 'incorrect syntax near ')'

    select * from DVE_GroupMember where GroupMember_GroupName like 'muster%' and GroupMember_StartDate = (SELECT MAX(GroupMember_StartDate)

Would anyone be able to help me with this?

Thanks",sql,,,,,,open,0,179,10,"Select newest record where multiple records exist from where/like statement Forgive me if the tite (and my SQL knowledge) seems a bit vague but I will try and explain as clearly as I can.

I have a table DVE_GroupMember, in which Person_StaffNumber is a unique identifier for a person. In this table is a column GroupMember_GroupName which contains a group name that a person can be assigned to. There is also column GroupMember_StartDate which signified when that person was assigned to that GroupMember_GroupName. A person can have been assigned to various groups over a period of time, so if I run the following SQL, I get multiple results for the various Person_StaffNumber values in the database (where the group name contains 'muster')

    select * from DVE_GroupMember where GroupMember_GroupName like 'muster%'

What I am trying to do, is select the most recent GroupMember_GroupName that each person has been assigned to.

I have tried the following syntax but it is generating the error 'incorrect syntax near ')'

    select * from DVE_GroupMember where GroupMember_GroupName like 'muster%' and GroupMember_StartDate = (SELECT MAX(GroupMember_StartDate)

Would anyone be able to help me with this?

Thanks",1
10880002,06/04/2012 10:44:33,516175,11/22/2010 13:55:49,37,0,WP7 SQLCE query optimization,"I have a SQL CE 3.5 database with a single table, Entities, with about 146,000 records, the following columns: Id (int, primary key), Gloss (nvarchar(4000)), GlossLen (int), Meaning (nvarchar(4000), and indices on Gloss and Glosslen. This is used by a cross platform application I am developing for Windows (WPF) and WP7.5.

I then run the following query against the database using LINQ to SQL:

    (from d in Entities where d.Gloss.StartsWith(""searchstring"") orderby d.GlossLen ascending select new { Id = d.Id, WrittenForms = d.Gloss, MeaningsString = d.Meaning, MatchString = d.Gloss, MatchStringLen = d.GlossLen }).Take(200)

The problem is am facing is that, while the query executes at reasonable speed (2 seconds or less) in Windows, it becomes painfully slow (6+ seconds) on on an actual WP7 device (the emulator is almost as fast as WPF).

As far as I can see, the generated SQL seems reasonable: below is what LINQPad returns.

    SELECT TOP (200) [t0].[Id], [t0].[Gloss] AS [WrittenForms], [t0].[Meaning] AS [MeaningsString], [t0].[GlossLen] AS [MatchStringLen]
    FROM [Entities] AS [t0]
    WHERE [t0].[Gloss] LIKE @p0
    ORDER BY [t0].[GlossLen]

The query's execution plan as reported by Visual Studio is: Index Seek->Filter->Sort->Select, so I am not doing a table scan.

I have also already tried using CompiledQuery.Compile on the LINQ query, storing the generated Func for re-use, but have seen no improvement.

What am I doing wrong? The only difference between the WP7 and WPF code paths is that the WP7 database is opened from the installation folder as read only.",sql,windows-phone-7,linq-to-sql,sql-server-ce,,,open,0,252,4,"WP7 SQLCE query optimization I have a SQL CE 3.5 database with a single table, Entities, with about 146,000 records, the following columns: Id (int, primary key), Gloss (nvarchar(4000)), GlossLen (int), Meaning (nvarchar(4000), and indices on Gloss and Glosslen. This is used by a cross platform application I am developing for Windows (WPF) and WP7.5.

I then run the following query against the database using LINQ to SQL:

    (from d in Entities where d.Gloss.StartsWith(""searchstring"") orderby d.GlossLen ascending select new { Id = d.Id, WrittenForms = d.Gloss, MeaningsString = d.Meaning, MatchString = d.Gloss, MatchStringLen = d.GlossLen }).Take(200)

The problem is am facing is that, while the query executes at reasonable speed (2 seconds or less) in Windows, it becomes painfully slow (6+ seconds) on on an actual WP7 device (the emulator is almost as fast as WPF).

As far as I can see, the generated SQL seems reasonable: below is what LINQPad returns.

    SELECT TOP (200) [t0].[Id], [t0].[Gloss] AS [WrittenForms], [t0].[Meaning] AS [MeaningsString], [t0].[GlossLen] AS [MatchStringLen]
    FROM [Entities] AS [t0]
    WHERE [t0].[Gloss] LIKE @p0
    ORDER BY [t0].[GlossLen]

The query's execution plan as reported by Visual Studio is: Index Seek->Filter->Sort->Select, so I am not doing a table scan.

I have also already tried using CompiledQuery.Compile on the LINQ query, storing the generated Func for re-use, but have seen no improvement.

What am I doing wrong? The only difference between the WP7 and WPF code paths is that the WP7 database is opened from the installation folder as read only.",4
3979866,10/20/2010 15:59:42,369601,06/17/2010 17:15:45,1,3,How can I find all columns that are filled with 100% nulls in my schema?,"Is there a SQL way to find out which columns in my schema are completely full of null values?  There are some fields in a couple of tables that I know are not used by the application and will be dropped, but I wanted to see if there was an automated way/script to find this out across the whole database to find candidates for code review/possible removal.

Running SQL Server 2005 on x86 if it matters.

Thanks in advance!",sql,server,,database-schema,,,open,0,78,15,"How can I find all columns that are filled with 100% nulls in my schema? Is there a SQL way to find out which columns in my schema are completely full of null values?  There are some fields in a couple of tables that I know are not used by the application and will be dropped, but I wanted to see if there was an automated way/script to find this out across the whole database to find candidates for code review/possible removal.

Running SQL Server 2005 on x86 if it matters.

Thanks in advance!",3
5093868,02/23/2011 16:37:51,630587,02/23/2011 16:37:51,1,0,what is the sql query for create a new database in oracle10G Express,please answer it I want it very fast,sql,,,,,02/23/2011 16:50:50,not a real question,1,8,13,what is the sql query for create a new database in oracle10G Express please answer it I want it very fast,1
11015276,06/13/2012 12:53:26,1252398,03/06/2012 14:09:20,51,0,file does not read by utl_file.getline in oracle procedure,"I am doing api assignment. I am trying to load the data into the table by using UTL_File.
I have write a procedure for that and using this procedure I am going to transfer the data from .dat file to my staging table but I getting error because of : UTL_FILE.get_line (v_file, v_line).
and getting no data found error occurse.

I have also given the credentials to the file but after that I getting the same error.
So, could you tell me why should I getting this error .
Here is my procedure:


    CREATE OR REPLACE PROCEDURE ss_load_inv
    AS
       v_line        VARCHAR2 (5000);           -- Data line read from input file
       v_file        UTL_FILE.file_type;                      -- Data file handle
       v_dir         VARCHAR2 (250);        -- Directory containing the data file
       v_filename    VARCHAR2 (50);                              -- Data filename
       v_1st_comma   NUMBER;
       v_2nd_comma   NUMBER;
       v_3rd_comma   NUMBER;
       v_4th_comma   NUMBER;
       v_5th_comma   NUMBER;
       v_6th_comma   NUMBER;
       inv_num       VARCHAR (50);
       inv_date      DATE;
       trans_type    VARCHAR2 (50);
       inv_amt       NUMBER;
       cust_num      NUMBER;
       currency      VARCHAR2 (15);
    BEGIN
       v_dir := '/usr/tmp';
       DBMS_OUTPUT.put_line ('I m in v_directory');
       v_filename := 'ss_invapi.dat';
       DBMS_OUTPUT.put_line ('I m in file:' || v_filename);
       v_file := UTL_FILE.fopen (v_dir, v_filename, 'R');
       DBMS_OUTPUT.put_line ('The data in v_file is:  ');
    
       IF UTL_FILE.is_open (v_file)
       THEN
          DBMS_OUTPUT.put_line ('File is open in R');
    
          LOOP
             BEGIN
                UTL_FILE.get_line (v_file, v_line);
             EXCEPTION
                WHEN NO_DATA_FOUND
                THEN
                   DBMS_OUTPUT.put_line
                                     ('Data is not present in to the file...!!!!');
                                       UTL_FILE.fclose (v_file);
                EXIT;
    -- ----------------------------------------------------------
    -- Each field in the input record is delimited by commas. We
    -- need to find the locations of the two commas in the line,
    -- and use these locations to get the fields from v_line.
    -- ----------------------------------------------------------
             v_1st_comma := INSTR (v_line, ',', 1, 1);
             v_2nd_comma := INSTR (v_line, ',', 1, 2);
             v_3rd_comma := INSTR (v_line, ',', 1, 3);
             v_4th_comma := INSTR (v_line, ',', 1, 4);
             v_5th_comma := INSTR (v_line, ',', 1, 5);
             v_6th_comma := INSTR (v_line, ',', 1, 6);
             DBMS_OUTPUT.put_line (   v_1st_comma
                                   || ' '
                                   || v_2nd_comma
                                   || ' '
                                   || v_3rd_comma
                                   || ' '
                                   || v_4th_comma
                                   || ' '
                                   || v_5th_comma
                                   || ' '
                                   || v_6th_comma
                                  );
             inv_num := TO_NUMBER (SUBSTR (v_line, 1, v_1st_comma - 1));
             inv_date :=
                TO_DATE (SUBSTR (v_line,
                                 v_1st_comma + 1,
                                 v_2nd_comma - v_1st_comma - 1
                                ),
                         'DD-MON-YYYY'
                        );
             trans_type :=
                   SUBSTR (v_line, v_2nd_comma + 1, v_3rd_comma - v_2nd_comma - 1);
             inv_amt :=
                TO_NUMBER (SUBSTR (v_line,
                                   v_3rd_comma + 1,
                                   v_4th_comma - v_3rd_comma - 1
                                  )
                          );
             cust_num :=
                TO_NUMBER (SUBSTR (v_line,
                                   v_4th_comma + 1,
                                   v_5th_comma - v_4th_comma - 1
                                  )
                          );
             currency :=
                   SUBSTR (v_line, v_5th_comma + 1, v_6th_comma - v_5th_comma - 1);
             DBMS_OUTPUT.put_line (   inv_num
                                   || ' '
                                   || inv_date
                                   || ' '
                                   || trans_type
                                   || ' '
                                   || inv_amt
                                   || ' '
                                   || cust_num
                                   || ' '
                                   || currency
                                  );
    
    -- ------------------------------------------
    -- Insert the new record into the DEPT table.
    -- ------------------------------------------
             INSERT INTO ss_invapi
                  VALUES (inv_num, inv_date, trans_type, inv_amt, cust_num,
                          currency);
    
             DBMS_OUTPUT.put_line ('data is inserted into the table');
             COMMIT;
             
             END;
             
          END LOOP;
    
          DBMS_OUTPUT.put_line ('Out side of Loop ');
       ELSE
          DBMS_OUTPUT.put_line ('File is Not Open ');
       END IF;
    
       DBMS_OUTPUT.put_line ('Out of If ');
     
    --   COMMIT;
    END;

",sql,api,stored-procedures,oracle-apps,utl-file,,open,0,2588,9,"file does not read by utl_file.getline in oracle procedure I am doing api assignment. I am trying to load the data into the table by using UTL_File.
I have write a procedure for that and using this procedure I am going to transfer the data from .dat file to my staging table but I getting error because of : UTL_FILE.get_line (v_file, v_line).
and getting no data found error occurse.

I have also given the credentials to the file but after that I getting the same error.
So, could you tell me why should I getting this error .
Here is my procedure:


    CREATE OR REPLACE PROCEDURE ss_load_inv
    AS
       v_line        VARCHAR2 (5000);           -- Data line read from input file
       v_file        UTL_FILE.file_type;                      -- Data file handle
       v_dir         VARCHAR2 (250);        -- Directory containing the data file
       v_filename    VARCHAR2 (50);                              -- Data filename
       v_1st_comma   NUMBER;
       v_2nd_comma   NUMBER;
       v_3rd_comma   NUMBER;
       v_4th_comma   NUMBER;
       v_5th_comma   NUMBER;
       v_6th_comma   NUMBER;
       inv_num       VARCHAR (50);
       inv_date      DATE;
       trans_type    VARCHAR2 (50);
       inv_amt       NUMBER;
       cust_num      NUMBER;
       currency      VARCHAR2 (15);
    BEGIN
       v_dir := '/usr/tmp';
       DBMS_OUTPUT.put_line ('I m in v_directory');
       v_filename := 'ss_invapi.dat';
       DBMS_OUTPUT.put_line ('I m in file:' || v_filename);
       v_file := UTL_FILE.fopen (v_dir, v_filename, 'R');
       DBMS_OUTPUT.put_line ('The data in v_file is:  ');
    
       IF UTL_FILE.is_open (v_file)
       THEN
          DBMS_OUTPUT.put_line ('File is open in R');
    
          LOOP
             BEGIN
                UTL_FILE.get_line (v_file, v_line);
             EXCEPTION
                WHEN NO_DATA_FOUND
                THEN
                   DBMS_OUTPUT.put_line
                                     ('Data is not present in to the file...!!!!');
                                       UTL_FILE.fclose (v_file);
                EXIT;
    -- ----------------------------------------------------------
    -- Each field in the input record is delimited by commas. We
    -- need to find the locations of the two commas in the line,
    -- and use these locations to get the fields from v_line.
    -- ----------------------------------------------------------
             v_1st_comma := INSTR (v_line, ',', 1, 1);
             v_2nd_comma := INSTR (v_line, ',', 1, 2);
             v_3rd_comma := INSTR (v_line, ',', 1, 3);
             v_4th_comma := INSTR (v_line, ',', 1, 4);
             v_5th_comma := INSTR (v_line, ',', 1, 5);
             v_6th_comma := INSTR (v_line, ',', 1, 6);
             DBMS_OUTPUT.put_line (   v_1st_comma
                                   || ' '
                                   || v_2nd_comma
                                   || ' '
                                   || v_3rd_comma
                                   || ' '
                                   || v_4th_comma
                                   || ' '
                                   || v_5th_comma
                                   || ' '
                                   || v_6th_comma
                                  );
             inv_num := TO_NUMBER (SUBSTR (v_line, 1, v_1st_comma - 1));
             inv_date :=
                TO_DATE (SUBSTR (v_line,
                                 v_1st_comma + 1,
                                 v_2nd_comma - v_1st_comma - 1
                                ),
                         'DD-MON-YYYY'
                        );
             trans_type :=
                   SUBSTR (v_line, v_2nd_comma + 1, v_3rd_comma - v_2nd_comma - 1);
             inv_amt :=
                TO_NUMBER (SUBSTR (v_line,
                                   v_3rd_comma + 1,
                                   v_4th_comma - v_3rd_comma - 1
                                  )
                          );
             cust_num :=
                TO_NUMBER (SUBSTR (v_line,
                                   v_4th_comma + 1,
                                   v_5th_comma - v_4th_comma - 1
                                  )
                          );
             currency :=
                   SUBSTR (v_line, v_5th_comma + 1, v_6th_comma - v_5th_comma - 1);
             DBMS_OUTPUT.put_line (   inv_num
                                   || ' '
                                   || inv_date
                                   || ' '
                                   || trans_type
                                   || ' '
                                   || inv_amt
                                   || ' '
                                   || cust_num
                                   || ' '
                                   || currency
                                  );
    
    -- ------------------------------------------
    -- Insert the new record into the DEPT table.
    -- ------------------------------------------
             INSERT INTO ss_invapi
                  VALUES (inv_num, inv_date, trans_type, inv_amt, cust_num,
                          currency);
    
             DBMS_OUTPUT.put_line ('data is inserted into the table');
             COMMIT;
             
             END;
             
          END LOOP;
    
          DBMS_OUTPUT.put_line ('Out side of Loop ');
       ELSE
          DBMS_OUTPUT.put_line ('File is Not Open ');
       END IF;
    
       DBMS_OUTPUT.put_line ('Out of If ');
     
    --   COMMIT;
    END;

",5
5245370,03/09/2011 11:51:52,442496,09/08/2010 14:00:31,70,6,strongly typed views and decimals,"looking really for some advice on how i should handle the following scenario.
i have a inputviewmodel with a decimal field.  the value will be inserted into a SQL db with the following precision and scale: 18,2.
if the user enters 100000000000000000.00 an error is returned from the db:

> ""Parameter value
> '100000000000000000.00' is out of
> range.""

How should i be handling this?i.e. to stop the user from entering this value.  i do have a validation layer.. but this value does parse into a decimal.

many thanks in advance

",sql,asp.net-mvc-2,c#-4.0,,,,open,0,86,5,"strongly typed views and decimals looking really for some advice on how i should handle the following scenario.
i have a inputviewmodel with a decimal field.  the value will be inserted into a SQL db with the following precision and scale: 18,2.
if the user enters 100000000000000000.00 an error is returned from the db:

> ""Parameter value
> '100000000000000000.00' is out of
> range.""

How should i be handling this?i.e. to stop the user from entering this value.  i do have a validation layer.. but this value does parse into a decimal.

many thanks in advance

",3
11307336,07/03/2012 08:40:50,1138031,01/09/2012 05:10:08,1,0,latest version of oracle developer including forms and reports,"which latest version of oracle developer including forms and reports like 6i?
and i need the link of download it
because i have course in my college witch is Database Administrator and the doctor is install 


    the 6i but i want the latest version",sql,forms,oracle,report,,07/03/2012 09:26:48,off topic,1,46,9,"latest version of oracle developer including forms and reports which latest version of oracle developer including forms and reports like 6i?
and i need the link of download it
because i have course in my college witch is Database Administrator and the doctor is install 


    the 6i but i want the latest version",4
9482400,02/28/2012 13:00:56,1131384,01/05/2012 04:55:17,21,0,How an SQL Query is Parsed,"I would like to know how an SQL query is parsed.

For Eg:

    Select count(*) from Users where name = 'John' and age = '24'

Will it take the count of records with name 'John' first , and then from it filter according to Age? Or is it the other way round? ",sql,query,parsing,,,02/28/2012 19:03:37,not a real question,1,54,6,"How an SQL Query is Parsed I would like to know how an SQL query is parsed.

For Eg:

    Select count(*) from Users where name = 'John' and age = '24'

Will it take the count of records with name 'John' first , and then from it filter according to Age? Or is it the other way round? ",3
4930106,02/08/2011 06:06:02,459385,09/27/2010 10:49:05,1,0,How to find the value if it is exist in the table?,"am using **stock** table in sql, in that table am created **itemcode & netweight** field, how i ill get the msg like ***""The Stock is Not Available""***  **if the netweight is zero** where i enter the item code ,  anybody send the sql query...

                                                  Thank U ...",sql,sql-server,,,,02/08/2011 16:28:02,not a real question,1,98,12,"How to find the value if it is exist in the table? am using **stock** table in sql, in that table am created **itemcode & netweight** field, how i ill get the msg like ***""The Stock is Not Available""***  **if the netweight is zero** where i enter the item code ,  anybody send the sql query...

                                                  Thank U ...",2
7517087,09/22/2011 15:09:40,688412,04/01/2011 23:10:33,103,3,excel vba - transform an sql,"Has anyone had any luck with a vba macro that would convert this input:

    update my_table 
        set time = sysdate, 
        randfield1 = 'FAKE', 
        randfield5 = 'ME', 
        the_field8 = 'test' 
        where my_key = '84' 
        ;

into this output?


    select count(*) from my_table
    where (randfield1 <> 'FAKE'
    or randfield5 <> 'ME'
    or the_field8 <> 'TEST')
    and my_key = '84';",sql,excel,vba,scripting,macros,,open,0,122,6,"excel vba - transform an sql Has anyone had any luck with a vba macro that would convert this input:

    update my_table 
        set time = sysdate, 
        randfield1 = 'FAKE', 
        randfield5 = 'ME', 
        the_field8 = 'test' 
        where my_key = '84' 
        ;

into this output?


    select count(*) from my_table
    where (randfield1 <> 'FAKE'
    or randfield5 <> 'ME'
    or the_field8 <> 'TEST')
    and my_key = '84';",5
676614,03/24/2009 09:10:51,57388,01/21/2009 05:51:32,14,0,Best way to organise data,"JavaScript takes a string of 4 hyphen delimited id's and string of 4 hyphen delimited titles  and makes a request for JSON data to my C# web service. Then the C# web service makes a tracker with status ""pending"" and awaits the user to confirm the tracker before json can be served up on next request.

When the user confirms the tracker there will be a drop down of the 4 titles to choose the most appropriate match. Upon confirmation the title chosen form the drop down will be passed to an ActionResult in the web service that will set the status of the tracker to ""live"" and add the id associated with the title to the ID column of the tracker.

The way I was doing it was having the JavaScript send in the 4 ids and titles as two separate strings inside the REST request and then adding them in the same format to an one column in the row, then splitting them just before adding them to the drop down list.

Here is an example:  
**--Data--  
ID, TITLE**  
  SDJFJKLS83,Photoshop Digital Photographers Voices Matter    
  SDJFKS94k4,Adobe Photoshop CS4 Classroom Book  
  DJFB443B34,Adobe 65014838 Photoshop CS4 Upgrade    
  SDFHSKBF22,Adobe 65015634 Photoshop CS4  

**javascript sends to service as:**  
ids=""SDJFJKLS83-SDJFKS94k4-DJFB443B34-SDFHSKBF22"";  
titles=""Photoshop Digital Photographers Voices Matter- Photoshop CS4 Classroom Book-obe 65014838 Photoshop CS4 Upgrade-Adobe 65015634 Photoshop CS4"";
  
url = http://myurl/service/ids/title    
  

**Service Creates new Tracker Row in SQL Table**  
TrackerID:4   
**Ids:** SDJFJKLS83-SDJFKS94k4-DJFB443B34-SDFHSKBF22    
**Titles:** Photoshop Digital Photographers Voices Matter- Photoshop CS4 Classroom Book-obe 65014838 Photoshop CS4 Upgrade-Adobe 65015634 Photoshop     
**user:** randomperson13  
**total requests:** 1  
**last request:** 2009-03-24 20:12:45.310	  
**status:** 0  

The service then shows a drop down list with all the titles for the user to select one.
Tracker is updated to ""live"" status and the Id's column is cleared and filled with only one ID and same with the titles column.

The service can use the single ID and title the user select to get data from another SQL table.

--

Basically what I want to know is if there is a better way to store the ID's and associated titles instead of delimited in one datarow.

Sorry if this was a really long post :)

Thank You.


",sql,javascript,ajax,,,04/18/2012 16:07:46,not constructive,1,395,5,"Best way to organise data JavaScript takes a string of 4 hyphen delimited id's and string of 4 hyphen delimited titles  and makes a request for JSON data to my C# web service. Then the C# web service makes a tracker with status ""pending"" and awaits the user to confirm the tracker before json can be served up on next request.

When the user confirms the tracker there will be a drop down of the 4 titles to choose the most appropriate match. Upon confirmation the title chosen form the drop down will be passed to an ActionResult in the web service that will set the status of the tracker to ""live"" and add the id associated with the title to the ID column of the tracker.

The way I was doing it was having the JavaScript send in the 4 ids and titles as two separate strings inside the REST request and then adding them in the same format to an one column in the row, then splitting them just before adding them to the drop down list.

Here is an example:  
**--Data--  
ID, TITLE**  
  SDJFJKLS83,Photoshop Digital Photographers Voices Matter    
  SDJFKS94k4,Adobe Photoshop CS4 Classroom Book  
  DJFB443B34,Adobe 65014838 Photoshop CS4 Upgrade    
  SDFHSKBF22,Adobe 65015634 Photoshop CS4  

**javascript sends to service as:**  
ids=""SDJFJKLS83-SDJFKS94k4-DJFB443B34-SDFHSKBF22"";  
titles=""Photoshop Digital Photographers Voices Matter- Photoshop CS4 Classroom Book-obe 65014838 Photoshop CS4 Upgrade-Adobe 65015634 Photoshop CS4"";
  
url = http://myurl/service/ids/title    
  

**Service Creates new Tracker Row in SQL Table**  
TrackerID:4   
**Ids:** SDJFJKLS83-SDJFKS94k4-DJFB443B34-SDFHSKBF22    
**Titles:** Photoshop Digital Photographers Voices Matter- Photoshop CS4 Classroom Book-obe 65014838 Photoshop CS4 Upgrade-Adobe 65015634 Photoshop     
**user:** randomperson13  
**total requests:** 1  
**last request:** 2009-03-24 20:12:45.310	  
**status:** 0  

The service then shows a drop down list with all the titles for the user to select one.
Tracker is updated to ""live"" status and the Id's column is cleared and filled with only one ID and same with the titles column.

The service can use the single ID and title the user select to get data from another SQL table.

--

Basically what I want to know is if there is a better way to store the ID's and associated titles instead of delimited in one datarow.

Sorry if this was a really long post :)

Thank You.


",3
8914409,01/18/2012 17:20:01,638007,02/28/2011 16:17:19,610,26,Optimising Store Procedure for better performance,"I am using a SP which takes around a minute execute , any ideas of optimisation :

    SELECT     COUNT(tbAccessCode.abGUID) AS total, 
    tbAccessCode.abGUID, 
    tbAccessCode.allocatedVendorID, 
    derivedtbl_1.used, 
    tbV.name, 
    tbV.firstName, 
    tbV.lastName, 
    tbV.tel, 
    tbV.email, 
    tbV.contactName
    FROM tbAccessCode INNER JOIN
							  (SELECT     COUNT(abGUID) AS used, abGUID
								FROM          tbAccessCode AS tbAccessCode_1
								WHERE      (batchGUID = 'abc-def') AND (allocatedVendorID > 0) 
								AND (isVoided = 0) AND (isCodeUsed = 1)
								GROUP BY abGUID) AS derivedtbl_1 ON tbAccessCode.abGUID = derivedtbl_1.abGUID INNER JOIN
						  tbV ON tbAccessCode.allocatedVendorID = tbV.vendorID
	WHERE     (tbAccessCode.allocatedVendorID > 0) AND 
	(tbAccessCode.batchGUID = 'abc-def') AND (tbAccessCode.isVoided = 0) AND (lowLevelNotified = 0)
	GROUP BY tbAccessCode.abGUID, 
	tbAccessCode.allocatedVendorID, 
	derivedtbl_1.used, 
	tbV.name, 
	tbV.firstName, 
	tbV.lastName, 
	tbV.tel, 
	tbV.email, 
	tbV.contactName",sql,sql-server-2008,stored-procedures,query-optimization,relational-database,01/20/2012 12:06:43,not constructive,1,167,6,"Optimising Store Procedure for better performance I am using a SP which takes around a minute execute , any ideas of optimisation :

    SELECT     COUNT(tbAccessCode.abGUID) AS total, 
    tbAccessCode.abGUID, 
    tbAccessCode.allocatedVendorID, 
    derivedtbl_1.used, 
    tbV.name, 
    tbV.firstName, 
    tbV.lastName, 
    tbV.tel, 
    tbV.email, 
    tbV.contactName
    FROM tbAccessCode INNER JOIN
							  (SELECT     COUNT(abGUID) AS used, abGUID
								FROM          tbAccessCode AS tbAccessCode_1
								WHERE      (batchGUID = 'abc-def') AND (allocatedVendorID > 0) 
								AND (isVoided = 0) AND (isCodeUsed = 1)
								GROUP BY abGUID) AS derivedtbl_1 ON tbAccessCode.abGUID = derivedtbl_1.abGUID INNER JOIN
						  tbV ON tbAccessCode.allocatedVendorID = tbV.vendorID
	WHERE     (tbAccessCode.allocatedVendorID > 0) AND 
	(tbAccessCode.batchGUID = 'abc-def') AND (tbAccessCode.isVoided = 0) AND (lowLevelNotified = 0)
	GROUP BY tbAccessCode.abGUID, 
	tbAccessCode.allocatedVendorID, 
	derivedtbl_1.used, 
	tbV.name, 
	tbV.firstName, 
	tbV.lastName, 
	tbV.tel, 
	tbV.email, 
	tbV.contactName",5
11544621,07/18/2012 15:13:31,1532104,07/17/2012 14:32:38,1,0,SQL Server 2005 wont update records,"I currently have an SQL Server 2005 set up and has been running successfully for quite a long period of time without any issues.

As of this morning our website applications have been attempting to perform udpates on various records however everytime an update happens the data never gets updated in the database.

OUr Applications code hasnt been changed in anyway, and there appears to be no errors of any kind.

Is there anything in SQL Server that can prevent updates from being performed on a database 

Can the size of transaction logs prevent data from being updated on an SQL Database ?

Or anything at all that can cause this strange behaviour

thanks in advance



",sql,sql-server,,,,,open,0,111,6,"SQL Server 2005 wont update records I currently have an SQL Server 2005 set up and has been running successfully for quite a long period of time without any issues.

As of this morning our website applications have been attempting to perform udpates on various records however everytime an update happens the data never gets updated in the database.

OUr Applications code hasnt been changed in anyway, and there appears to be no errors of any kind.

Is there anything in SQL Server that can prevent updates from being performed on a database 

Can the size of transaction logs prevent data from being updated on an SQL Database ?

Or anything at all that can cause this strange behaviour

thanks in advance



",2
4949785,02/09/2011 19:57:14,602830,02/04/2011 08:17:31,6,0,What do do after being hacked.,"I've come across SQL injection vulnerabilitieson my companies ecommerce page. It was fairly pooprly put together. I believe I have prevented future attempts however we are getting calls about fraudulent credit card charges on our site and others. This leads me to believe that someone was able to get a list of our credit card numbers. What doesn't make sense is that we don't store that information and we use Authorize.net for the transaction. If someone was able to get the CC#s, what should I do next? Inform ALL of our customers that someone broken into our system and stole their information? I have a feeling that will be bad for business.",sql,security,injection,anti-hacking,,02/09/2011 20:02:20,off topic,1,112,6,"What do do after being hacked. I've come across SQL injection vulnerabilitieson my companies ecommerce page. It was fairly pooprly put together. I believe I have prevented future attempts however we are getting calls about fraudulent credit card charges on our site and others. This leads me to believe that someone was able to get a list of our credit card numbers. What doesn't make sense is that we don't store that information and we use Authorize.net for the transaction. If someone was able to get the CC#s, what should I do next? Inform ALL of our customers that someone broken into our system and stole their information? I have a feeling that will be bad for business.",4
6018374,05/16/2011 13:47:06,603536,02/04/2011 17:23:40,23,8,Swap two rows using sql query,"I am having a table name ticket in which I want to swap two rows when user click up/down button from front end.

for this i added a auto-generated field called ticket_index.but i am not able to perform this action. 

I wrote the following query
    
       UPDATE ticket as ticket1 JOIN ticket as ticket2 ON ( ticket1.ticket_index = 1 AND   
       ticket2.ticket_index = 4 ) OR ( ticket1.ticket_index = 4 AND ticket2.ticket_index = 1 
       ) SET ticket1.ticket_index = ticket2.ticket_index , ticket2.ticket_index = 
       ticket1.ticket_index

Can anyone give me the right sql query.please let me know if extra information is needed for this. Thanks",sql,,,,,,open,0,131,6,"Swap two rows using sql query I am having a table name ticket in which I want to swap two rows when user click up/down button from front end.

for this i added a auto-generated field called ticket_index.but i am not able to perform this action. 

I wrote the following query
    
       UPDATE ticket as ticket1 JOIN ticket as ticket2 ON ( ticket1.ticket_index = 1 AND   
       ticket2.ticket_index = 4 ) OR ( ticket1.ticket_index = 4 AND ticket2.ticket_index = 1 
       ) SET ticket1.ticket_index = ticket2.ticket_index , ticket2.ticket_index = 
       ticket1.ticket_index

Can anyone give me the right sql query.please let me know if extra information is needed for this. Thanks",1
1570082,10/15/2009 03:03:05,117658,06/04/2009 21:20:08,1160,101,(SQL) How would I return the result set from multiple executed stored procedures?,"Okay I have a queswtion about returning the recordset from multiple stored procedures.

If I have a sproc which does this:

    exec sproc1
    exec sproc2
    exec sproc3


Each sproc returns just one number, so it return

[no column name]
1500

[no column name]
18000

[no column name]
1253

Obviously a datareader won't be able to handle this, or at least I don't think it will.  So I thought about declaring a Table variable

    DECLARE @Table (Col1, Col2)
    
    INSERT INTO @Table
    exec sproc1,exec sproc2, etc...)

But that doesn't work.

Any ideas on how to handle this?",sql,stored-procedures,,,,,open,0,107,13,"(SQL) How would I return the result set from multiple executed stored procedures? Okay I have a queswtion about returning the recordset from multiple stored procedures.

If I have a sproc which does this:

    exec sproc1
    exec sproc2
    exec sproc3


Each sproc returns just one number, so it return

[no column name]
1500

[no column name]
18000

[no column name]
1253

Obviously a datareader won't be able to handle this, or at least I don't think it will.  So I thought about declaring a Table variable

    DECLARE @Table (Col1, Col2)
    
    INSERT INTO @Table
    exec sproc1,exec sproc2, etc...)

But that doesn't work.

Any ideas on how to handle this?",2
4096239,11/04/2010 11:36:59,278740,02/22/2010 14:19:15,20,6,table creation in pl/sql,"I want to merge a sql script which create a table and a pl/sql script which insert data in that table. Customer wishes

My idea was to do the table creation in pl sql. But it doesn't work. Create is not allowed in the begin part. A solution I've seen is to do this in an execute immediate statement. In practice I 've tried this :

    SET serveroutput ON
    spool 03_CREATE_CATEGORIEDECL.log
    
    BEGIN
     execute immediate 'create table CATEGORIEDECLARATION ( 
     nIdCategorieDeclaration  NUMBER(10)   not null,
     ...
     constraint PK_CATDECLA primary key (nIdCategorieDeclaration)
    );'
    END 
    /
    spool off
I get an error on the end keyword, it wasn't expected. So my question is how to create a table in a pl/sql script? Do I have to keep those 2 actions in 2 differents scripts?",sql,oracle,plsql,,,,open,0,173,4,"table creation in pl/sql I want to merge a sql script which create a table and a pl/sql script which insert data in that table. Customer wishes

My idea was to do the table creation in pl sql. But it doesn't work. Create is not allowed in the begin part. A solution I've seen is to do this in an execute immediate statement. In practice I 've tried this :

    SET serveroutput ON
    spool 03_CREATE_CATEGORIEDECL.log
    
    BEGIN
     execute immediate 'create table CATEGORIEDECLARATION ( 
     nIdCategorieDeclaration  NUMBER(10)   not null,
     ...
     constraint PK_CATDECLA primary key (nIdCategorieDeclaration)
    );'
    END 
    /
    spool off
I get an error on the end keyword, it wasn't expected. So my question is how to create a table in a pl/sql script? Do I have to keep those 2 actions in 2 differents scripts?",3
6239601,06/04/2011 21:47:26,784302,06/04/2011 21:47:26,1,0,Books on SQL ODBC,Are there any good books avaliable on writing SQL queries using ODBC?,sql,books,odbc,,,06/05/2011 01:43:29,off topic,1,12,4,Books on SQL ODBC Are there any good books avaliable on writing SQL queries using ODBC?,3
2524027,03/26/2010 14:38:05,302602,03/26/2010 14:38:05,1,0,SQL 2008 - db mail issue,"I have two instances of SQL 2008.  One was upgraded from SQL 2000 and one was 
a clean, new install.

SQL Mail operates perfectly on both instances.
DB Mail operates perfectly on the newly installed instance.
On the upgraded instance, DB Mail does not send any mail.  Of course, I am not positive that the fact this instance is upgraded has anything to do with the issue, but it might.

The configuration of my db mail profile and account looks identical to my functioning instance.  In the configuration of the 'alerts' tab in the SQL Agent properties i have tried selecting both DB Mail and SQL Mail to no avail.  Both instances use the same SMTP server with the same authentication (domain with db engine account).


All messages sent via sp_send_db mail and those sent via the 'test email' 
option are visible in the sysmail_allitems queue and remain there as 'unsent'.  The send_status eventually changes to 'failed'.

The only messages in the sysmail_event_log are 'mail queue stopped by login 
domain\myuser', 'mail queue started by login domain/myuser' and 'activiation 
successful.'.

selecting from the externalmailqueue has the same number of rows as sysmail_allitems.  i have tried bouncing the agent, the entire instance and moving the other functioning instance to the other node in the cluster.

any thoughts?
thx.

",sql,server,2008,db,mail,12/17/2011 17:05:16,not constructive,1,213,6,"SQL 2008 - db mail issue I have two instances of SQL 2008.  One was upgraded from SQL 2000 and one was 
a clean, new install.

SQL Mail operates perfectly on both instances.
DB Mail operates perfectly on the newly installed instance.
On the upgraded instance, DB Mail does not send any mail.  Of course, I am not positive that the fact this instance is upgraded has anything to do with the issue, but it might.

The configuration of my db mail profile and account looks identical to my functioning instance.  In the configuration of the 'alerts' tab in the SQL Agent properties i have tried selecting both DB Mail and SQL Mail to no avail.  Both instances use the same SMTP server with the same authentication (domain with db engine account).


All messages sent via sp_send_db mail and those sent via the 'test email' 
option are visible in the sysmail_allitems queue and remain there as 'unsent'.  The send_status eventually changes to 'failed'.

The only messages in the sysmail_event_log are 'mail queue stopped by login 
domain\myuser', 'mail queue started by login domain/myuser' and 'activiation 
successful.'.

selecting from the externalmailqueue has the same number of rows as sysmail_allitems.  i have tried bouncing the agent, the entire instance and moving the other functioning instance to the other node in the cluster.

any thoughts?
thx.

",5
9606955,03/07/2012 18:18:15,75381,03/08/2009 19:33:12,63,0,Collation To Code Page (SQL Server),How can I determine which code page a particular collation on SQL Server uses?,sql,sql-server,database,,,,open,0,14,6,Collation To Code Page (SQL Server) How can I determine which code page a particular collation on SQL Server uses?,3
4148486,11/10/2010 19:55:24,55640,01/15/2009 22:09:50,972,59,Solution to problem done in PL/SQL what would it look like in SQL?,"Friends,

Hope you can help. I've written a solution to problem using PL/SQL and SQL and I can't help thinking that it could be done 100% in SQL but am I am struggling to get started.

Here is the structure of the two tables (If it helps, the scripts to create them are at the end of the question)

Table t1 (primary key is both columns displayed)

    ID    TYPE
    1     A
    1     B
    1     C
    
    2     A
    2     B
    
    3     B

The Type column is a Foreign Key to table T2 which contains the following data:

Table t2 (primary key is Type)

    Type    Desc
    A       xx
    
    B       xx
    
    C       xx


So given the the data in T1 the result I need will be:

For ID 1 because it has all the types in the foreign key table I would return the literal ""All""

For ID 2 because it has two types I would like to return ""A & B"" (note the separator)

And finally for ID 3 because it has one type I would like to return just ""B"" 

As promised here are the scripts to create all the objects mentioned. 

Thanks in advance

    create table t2(type varchar2(1),
                    description varchar2(100)
                    )                
    /
    
    insert into t2
    values ('A', 'xx')
    /
    
    insert into t2
    values ('B', 'xx')
    /
    
    insert into t2
    values ('C', 'xx')
    /
    
    alter table t2 add constraint t2_pk primary key (type)
    /
    
    create table t1 (id number(10),
                     type varchar2(1)
                     )
    /
    
    alter table t1 add constraint t1_pk primary key(id, type)
    /
     
    alter table t1 add constraint t1_fk foreign key (type) 
    references t2(type)
    /
                     
    insert into t1
    values (1, 'A') 
    /
    
    insert into t1
    values (1, 'B')
    /
    
    insert into t1
    values (1, 'C')
    /
    
    insert into t1
    values (2, 'A')
    /
    
    insert into t1
    values (2, 'B')
    /
    
    insert into t1
    values (3, 'B')
    /

 

",sql,oracle,oracle10g,,,,open,0,675,13,"Solution to problem done in PL/SQL what would it look like in SQL? Friends,

Hope you can help. I've written a solution to problem using PL/SQL and SQL and I can't help thinking that it could be done 100% in SQL but am I am struggling to get started.

Here is the structure of the two tables (If it helps, the scripts to create them are at the end of the question)

Table t1 (primary key is both columns displayed)

    ID    TYPE
    1     A
    1     B
    1     C
    
    2     A
    2     B
    
    3     B

The Type column is a Foreign Key to table T2 which contains the following data:

Table t2 (primary key is Type)

    Type    Desc
    A       xx
    
    B       xx
    
    C       xx


So given the the data in T1 the result I need will be:

For ID 1 because it has all the types in the foreign key table I would return the literal ""All""

For ID 2 because it has two types I would like to return ""A & B"" (note the separator)

And finally for ID 3 because it has one type I would like to return just ""B"" 

As promised here are the scripts to create all the objects mentioned. 

Thanks in advance

    create table t2(type varchar2(1),
                    description varchar2(100)
                    )                
    /
    
    insert into t2
    values ('A', 'xx')
    /
    
    insert into t2
    values ('B', 'xx')
    /
    
    insert into t2
    values ('C', 'xx')
    /
    
    alter table t2 add constraint t2_pk primary key (type)
    /
    
    create table t1 (id number(10),
                     type varchar2(1)
                     )
    /
    
    alter table t1 add constraint t1_pk primary key(id, type)
    /
     
    alter table t1 add constraint t1_fk foreign key (type) 
    references t2(type)
    /
                     
    insert into t1
    values (1, 'A') 
    /
    
    insert into t1
    values (1, 'B')
    /
    
    insert into t1
    values (1, 'C')
    /
    
    insert into t1
    values (2, 'A')
    /
    
    insert into t1
    values (2, 'B')
    /
    
    insert into t1
    values (3, 'B')
    /

 

",3
7573337,09/27/2011 17:34:54,201926,11/03/2009 17:42:03,94,1,Architecture behind large-scale social sites like Twitter - help with a new startup.,"I apologize in advance for this not being a specific programming question, but I believe this is the best place for such an inquiry.

Basically, I have an idea for what I believe to be an interesting social networking site (not just a clone of existing things, but something useful and unique); I have a detailed specification document describing how everything works, but I'm not sure how best to proceed from here.  Architecturally, it seems like it would be most similar to something like Twitter, and I have some idea of what technologies are involved in this (SQL database, ajax, mobile integration, etc.).  I do not have the time to code everything myself, and honestly some of it is likely beyond me.  So, I suppose my pool of questions is something like this:

Assume I am non-programmer with a legitimately good idea for a new and large-scale social networking service, similar (in architecture) to Twitter, and some capital to make it happen: 

How do I proceed?  
What is the architecture behind a site like Twitter and what technologies does it use?  How do I find people with experience building these types of systems for consulting/development purposes?  
Are there any initiatives (government or otherwise) that can help me in such a start-up endeavor?   

I appreciate any help you can offer.  Thanks, and again I apologize for the broadness of this question.",sql,ajax,twitter,social-networking,large-data-volumes,09/27/2011 18:03:27,not a real question,1,237,13,"Architecture behind large-scale social sites like Twitter - help with a new startup. I apologize in advance for this not being a specific programming question, but I believe this is the best place for such an inquiry.

Basically, I have an idea for what I believe to be an interesting social networking site (not just a clone of existing things, but something useful and unique); I have a detailed specification document describing how everything works, but I'm not sure how best to proceed from here.  Architecturally, it seems like it would be most similar to something like Twitter, and I have some idea of what technologies are involved in this (SQL database, ajax, mobile integration, etc.).  I do not have the time to code everything myself, and honestly some of it is likely beyond me.  So, I suppose my pool of questions is something like this:

Assume I am non-programmer with a legitimately good idea for a new and large-scale social networking service, similar (in architecture) to Twitter, and some capital to make it happen: 

How do I proceed?  
What is the architecture behind a site like Twitter and what technologies does it use?  How do I find people with experience building these types of systems for consulting/development purposes?  
Are there any initiatives (government or otherwise) that can help me in such a start-up endeavor?   

I appreciate any help you can offer.  Thanks, and again I apologize for the broadness of this question.",5
3262257,07/16/2010 05:51:38,393506,07/16/2010 05:51:38,1,0,how to write follwing query?,"
SELECT column1 FROM table1 WHERE EXISTS ( SELECT column1 FROM table2 WHERE table1.column1 = table2.column1 );",sql,,,,,07/18/2010 01:50:40,not a real question,1,16,5,"how to write follwing query? 
SELECT column1 FROM table1 WHERE EXISTS ( SELECT column1 FROM table2 WHERE table1.column1 = table2.column1 );",1
7423011,09/14/2011 21:08:41,941705,09/13/2011 02:58:58,1,0,"SQL Server ""not exists"" on unique key attempts to insert rows?","In this example, table_a has a unique key constraint on visit_id.

Why doesn't ""and not exists select *..."" prevent SQL Server from attempting to insert rows from table_b with row_id's that already exist in table_a?

    insert table_a
    	(visit_id, value1, value2)
            select visit_id, value1, value2, is_new
            from table_b src
            where is_new = 1
                and not exists
                    (select *
                    from table_a
                    where visit_id = src.visit_id)

I am getting the error:

    Msg 2601, Level 14, State 1, Line ...
    Cannot insert duplicate key row in object 'dbo.table_a' with unique index 'IDX_table_a'.

The context here is an ETL routine that inserts new visits only, and updates existing visits in place. I know I can write it differently, but I don't understand why this statement isn't  evaluated such that it wouldn't attempt to insert rows with existing visit_id's.
",sql,sql-server,,,,,open,0,248,11,"SQL Server ""not exists"" on unique key attempts to insert rows? In this example, table_a has a unique key constraint on visit_id.

Why doesn't ""and not exists select *..."" prevent SQL Server from attempting to insert rows from table_b with row_id's that already exist in table_a?

    insert table_a
    	(visit_id, value1, value2)
            select visit_id, value1, value2, is_new
            from table_b src
            where is_new = 1
                and not exists
                    (select *
                    from table_a
                    where visit_id = src.visit_id)

I am getting the error:

    Msg 2601, Level 14, State 1, Line ...
    Cannot insert duplicate key row in object 'dbo.table_a' with unique index 'IDX_table_a'.

The context here is an ETL routine that inserts new visits only, and updates existing visits in place. I know I can write it differently, but I don't understand why this statement isn't  evaluated such that it wouldn't attempt to insert rows with existing visit_id's.
",2
5660768,04/14/2011 08:57:24,634270,02/25/2011 14:14:12,11,2,How to Insert special characters in SQL Server 2008 R2?,"I am trying to collect news articles and store the content in a db. I need to do it quickly say 300 news articles in less than 15mins time. The news content is having lots of special characters in between like ""'"" etc. Is there any way to say the database to ignore those characters while writing to the database? Insert query is failing.

Thanks.
",sql,sql-server,,,,,open,0,64,10,"How to Insert special characters in SQL Server 2008 R2? I am trying to collect news articles and store the content in a db. I need to do it quickly say 300 news articles in less than 15mins time. The news content is having lots of special characters in between like ""'"" etc. Is there any way to say the database to ignore those characters while writing to the database? Insert query is failing.

Thanks.
",2
5098582,02/23/2011 23:23:01,597680,01/31/2011 23:54:37,39,0,Help using left outer joins in SQL...,"I'm trying to create a list of people, their friends, and their friends of friends.

My table of people is this:

    People:
    NAME
    Jow
    Smith
    Sandy
    Phil
    
    Friends
    LIKER LIKEE
    jow   smith
    smith jow
    sandy phil

Now, what I want is a table like this:

    User Friend FriendofFriend
    Jow   smith  jow
    Smith jow    smith
    sandy phil
    phil

I'm trying to create a table using the following:

    SELECT P.NAME, F.LIKEE, F2.LIKEE
    FROM PEOPLE P
    LEFT OUTER JOIN FRIENDS F
    ON P.NAME = F.LIKER
    LEFT OUTER JOIN FRIENDS F2
    ON F.LIKEE = F2.LIKER

But the above isn't working. How can I get a table of people and their friends, regardless of whether or not they actually HAVE any friends? ",sql,left-join,,,,,open,0,192,7,"Help using left outer joins in SQL... I'm trying to create a list of people, their friends, and their friends of friends.

My table of people is this:

    People:
    NAME
    Jow
    Smith
    Sandy
    Phil
    
    Friends
    LIKER LIKEE
    jow   smith
    smith jow
    sandy phil

Now, what I want is a table like this:

    User Friend FriendofFriend
    Jow   smith  jow
    Smith jow    smith
    sandy phil
    phil

I'm trying to create a table using the following:

    SELECT P.NAME, F.LIKEE, F2.LIKEE
    FROM PEOPLE P
    LEFT OUTER JOIN FRIENDS F
    ON P.NAME = F.LIKER
    LEFT OUTER JOIN FRIENDS F2
    ON F.LIKEE = F2.LIKER

But the above isn't working. How can I get a table of people and their friends, regardless of whether or not they actually HAVE any friends? ",2
11268315,06/29/2012 20:08:33,8114,09/15/2008 15:12:34,9785,397,T-SQL query using completely different plan depending on number of rows I'm updating,"I have a SQL UPDATE statement with a ""TOP (X)"" clause, and the row I'm updating values in has about 4 billion rows. When I use ""TOP (10)"", I get one execution plan that executes almost instantly, but when I use ""TOP (50)"" or larger, the query never (at least, not while I'm waiting) finishes, and it uses a completely different execution plan. The smaller query uses a very simple plan with a pair of index seeks and a nested loop join, where the exact same query (with a different number of rows in the TOP clause of the UPDATE statement) uses a plan that involves two different index seeks, a table spool, parallelism, and a bunch of other complexity.

I've used ""OPTION (USE PLAN...)"" to force it to use the execution plan generated by the smaller query - when I do this, I can update as many as 100,000 rows in a few seconds. I know the query plan is good, but SQL Server will only choose that plan on its own when only a small number of rows are involved - any decently large row count in my update will result in the sub-optimal plan. 

I thought the parallelism might be to blame, so I set `MAXDOP 1` on the query, but to no effect - that step is gone, but the poor choice/performance isn't. I also ran `sp_updatestats` just this morning to ensure that wasn't the cause.

I've attached the two execution plans - the shorter one is also the quicker one. Additionally, here's the query in question (it's worth noting that the SELECT I've included seems to be quick in the cases of both small and large row counts):

		update top (10000) FactSubscriberUsage3
                   set AccountID = sma.CustomerID
		--select top 50 f.AccountID, sma.CustomerID
		  from FactSubscriberUsage3 f
		  join dimTime t
			on f.TimeID = t.TimeID
		  join #mac sma
			on f.macid = sma.macid
		   and t.TimeValue between sma.StartDate and sma.enddate 
		 where f.AccountID = 0 --There's a filtered index on the table for this


Here's the quick plan:
![Quick Execution Plan][1]

And here's the slower one:
![Slow Execution Plan][2]

Is there anything obvious in either the way I'm setting up my query or in the execution plan provided that would lend itself to the bad choice the query engine is making? If necessary, I can also include the table definitions involved and the indexes that are defined on them.

  [1]: http://i.stack.imgur.com/uBzn6.png
  [2]: http://i.stack.imgur.com/eAWfH.png",sql,sql-server,tsql,query-execution-plans,query-tuning,06/29/2012 20:49:46,off topic,1,416,13,"T-SQL query using completely different plan depending on number of rows I'm updating I have a SQL UPDATE statement with a ""TOP (X)"" clause, and the row I'm updating values in has about 4 billion rows. When I use ""TOP (10)"", I get one execution plan that executes almost instantly, but when I use ""TOP (50)"" or larger, the query never (at least, not while I'm waiting) finishes, and it uses a completely different execution plan. The smaller query uses a very simple plan with a pair of index seeks and a nested loop join, where the exact same query (with a different number of rows in the TOP clause of the UPDATE statement) uses a plan that involves two different index seeks, a table spool, parallelism, and a bunch of other complexity.

I've used ""OPTION (USE PLAN...)"" to force it to use the execution plan generated by the smaller query - when I do this, I can update as many as 100,000 rows in a few seconds. I know the query plan is good, but SQL Server will only choose that plan on its own when only a small number of rows are involved - any decently large row count in my update will result in the sub-optimal plan. 

I thought the parallelism might be to blame, so I set `MAXDOP 1` on the query, but to no effect - that step is gone, but the poor choice/performance isn't. I also ran `sp_updatestats` just this morning to ensure that wasn't the cause.

I've attached the two execution plans - the shorter one is also the quicker one. Additionally, here's the query in question (it's worth noting that the SELECT I've included seems to be quick in the cases of both small and large row counts):

		update top (10000) FactSubscriberUsage3
                   set AccountID = sma.CustomerID
		--select top 50 f.AccountID, sma.CustomerID
		  from FactSubscriberUsage3 f
		  join dimTime t
			on f.TimeID = t.TimeID
		  join #mac sma
			on f.macid = sma.macid
		   and t.TimeValue between sma.StartDate and sma.enddate 
		 where f.AccountID = 0 --There's a filtered index on the table for this


Here's the quick plan:
![Quick Execution Plan][1]

And here's the slower one:
![Slow Execution Plan][2]

Is there anything obvious in either the way I'm setting up my query or in the execution plan provided that would lend itself to the bad choice the query engine is making? If necessary, I can also include the table definitions involved and the indexes that are defined on them.

  [1]: http://i.stack.imgur.com/uBzn6.png
  [2]: http://i.stack.imgur.com/eAWfH.png",5
9980472,04/02/2012 16:52:29,184773,10/06/2009 06:16:54,3933,48,Is it possible to query a one-to-many with one query,"Lets take stackoverflow as an example:

**Post**

    Postid          Title          Mess
    --------------------------------------------------
    1               Title1         This is a question
    2               Title2         This is a question1
    3               Title3         This is a question2
    4               Title4         This is a question3
    5               Title5         This is a question4
    6               Title6         This is a question5

**Tags**

    TagId     PostId     Name
    -----------------------------
    1         1              Tag1
    2         1              Tag2
    3         1              Tag3
    4         1              Tag4
    5         2              Tag5
    6         3              Tag6
    7         4              Tag7
    8         5              Tag8
    9         6              Tag9
    10        3              Tag10

In this design how would I get all the questions with its associated tags in one query. is this even possible?",sql,sql-server-2008,,,,04/02/2012 19:40:26,not a real question,1,527,10,"Is it possible to query a one-to-many with one query Lets take stackoverflow as an example:

**Post**

    Postid          Title          Mess
    --------------------------------------------------
    1               Title1         This is a question
    2               Title2         This is a question1
    3               Title3         This is a question2
    4               Title4         This is a question3
    5               Title5         This is a question4
    6               Title6         This is a question5

**Tags**

    TagId     PostId     Name
    -----------------------------
    1         1              Tag1
    2         1              Tag2
    3         1              Tag3
    4         1              Tag4
    5         2              Tag5
    6         3              Tag6
    7         4              Tag7
    8         5              Tag8
    9         6              Tag9
    10        3              Tag10

In this design how would I get all the questions with its associated tags in one query. is this even possible?",2
8695189,01/01/2012 20:04:38,277632,01/03/2010 21:54:20,80,8,"select * on multiple tables,missing overview","Hello @all (and a Happy New Years Day),

i struggle to long now but it seem i dont see what i do wrong.

So pls dont ask what i tried so far.

But i have the following sql query:

    SELECT * FROM 
    customers_basket cb, 
    products p, 
    products_description pd 
    WHERE 
    cb.products_id = p.products_id 
    AND 
    cb.products_id = pd.products_id 
    AND customers_id=""1""

However i also need it to count on a table named: **customers_basket_attributes** , 
and that table also holds a colum named: **products_id**

it looks like i just cant it to work.

",sql,count,multiple,,,01/26/2012 03:44:11,not a real question,1,119,6,"select * on multiple tables,missing overview Hello @all (and a Happy New Years Day),

i struggle to long now but it seem i dont see what i do wrong.

So pls dont ask what i tried so far.

But i have the following sql query:

    SELECT * FROM 
    customers_basket cb, 
    products p, 
    products_description pd 
    WHERE 
    cb.products_id = p.products_id 
    AND 
    cb.products_id = pd.products_id 
    AND customers_id=""1""

However i also need it to count on a table named: **customers_basket_attributes** , 
and that table also holds a colum named: **products_id**

it looks like i just cant it to work.

",3
7486856,09/20/2011 14:28:27,441052,09/07/2010 02:43:52,6,0,Disadvantages of IN operator in sql server and alternate way not to use IN operator,Can anyone tell me why not to user IN operator in query in sql server and what is the alternative way to not use in operator.,sql,server,,,,09/21/2011 05:55:49,not constructive,1,26,15,Disadvantages of IN operator in sql server and alternate way not to use IN operator Can anyone tell me why not to user IN operator in query in sql server and what is the alternative way to not use in operator.,2
5718220,04/19/2011 14:43:22,715408,04/19/2011 14:39:00,1,0,Counting lines in case statement in SQL,"I am trying to get the lines count(entered) for Today, Month to date, year to date in one sql statement. but I am not sure why it is giving me the same values for all the the three.
here is my sql statement.

select BU,
count(CASE when a.date_added = trunc(sysdate) then (part) else '0' end) as TodayQuotes,
count(CASE when a.date_added > last_day(add_months(sysdate,-1)) then (part) else '0' end) as MTDQuotesValue,
COUNT(case when to_number(to_char(a.date_added,'yyyy'))='2011' then (part) else '0' end) as YTDRegularValue
from articles
group by BU;


any help will be appreciated",sql,count,case,statement,,,open,0,81,7,"Counting lines in case statement in SQL I am trying to get the lines count(entered) for Today, Month to date, year to date in one sql statement. but I am not sure why it is giving me the same values for all the the three.
here is my sql statement.

select BU,
count(CASE when a.date_added = trunc(sysdate) then (part) else '0' end) as TodayQuotes,
count(CASE when a.date_added > last_day(add_months(sysdate,-1)) then (part) else '0' end) as MTDQuotesValue,
COUNT(case when to_number(to_char(a.date_added,'yyyy'))='2011' then (part) else '0' end) as YTDRegularValue
from articles
group by BU;


any help will be appreciated",4
9205414,02/09/2012 04:26:24,95803,04/25/2009 01:27:03,35,0,simply sql boolean condition,"I need to check if a value lies in a range, however I can't guarantee that either end of the range isn't `NULL`. The values in this case are integers. '`mo`' represents employment

currently I have the following

    WHERE (r.year BETWEEN mo.startyear AND mo.endyear >= r.year) 
    OR (mo.startyear <= r.year AND mo.endyear IS null)
    OR (mo.startyear IS null AND mo.endyear IS null)
    OR (mo.startyear IS null AND mo.endyear >= r.year)

is this the only way to check the `mo` was 'employed' at a particular year (`r`)
",sql,,,,,,open,0,97,4,"simply sql boolean condition I need to check if a value lies in a range, however I can't guarantee that either end of the range isn't `NULL`. The values in this case are integers. '`mo`' represents employment

currently I have the following

    WHERE (r.year BETWEEN mo.startyear AND mo.endyear >= r.year) 
    OR (mo.startyear <= r.year AND mo.endyear IS null)
    OR (mo.startyear IS null AND mo.endyear IS null)
    OR (mo.startyear IS null AND mo.endyear >= r.year)

is this the only way to check the `mo` was 'employed' at a particular year (`r`)
",1
6939315,08/04/2011 09:51:55,6023,09/12/2008 00:46:22,341,11,How to change NOCOUNT setting within LinqToSQL because of ChangeConflictException in Linq to Sql update,"I am experiencing _exactly_ this problem (and am in exactly the same world of pain):
http://stackoverflow.com/questions/663822/changeconflictexception-in-linq-to-sql-update

Whereby I am offering an update to SQL using LinqToSQL and it is failing with a `ChangeConflictException` because `NOCOUNT` is set to `ON`.

Due to legacy databases also on the server I am targeting, I am not able to re-configure the default connection settings as is quite rightly stated in the accepted answer in http://stackoverflow.com/questions/663822/changeconflictexception-in-linq-to-sql-update/757276#757276.

My question is: How do you convince LinqToSQL to run a SQL `SET NOCOUNT OFF` before executing an update?",sql,linq,linq-to-sql,,,,open,0,86,15,"How to change NOCOUNT setting within LinqToSQL because of ChangeConflictException in Linq to Sql update I am experiencing _exactly_ this problem (and am in exactly the same world of pain):
http://stackoverflow.com/questions/663822/changeconflictexception-in-linq-to-sql-update

Whereby I am offering an update to SQL using LinqToSQL and it is failing with a `ChangeConflictException` because `NOCOUNT` is set to `ON`.

Due to legacy databases also on the server I am targeting, I am not able to re-configure the default connection settings as is quite rightly stated in the accepted answer in http://stackoverflow.com/questions/663822/changeconflictexception-in-linq-to-sql-update/757276#757276.

My question is: How do you convince LinqToSQL to run a SQL `SET NOCOUNT OFF` before executing an update?",3
5272218,03/11/2011 11:17:34,453747,09/21/2010 09:54:30,93,0,SQL Join on first matched field,"I have a query to join 2 tables in the following way.

Table1 has a field (LinkTo) that may (or may not) appear in one of three fields in table Table2 (Link, Link1, Link2).  I need try joining LinkTo to Link, then Link1 then Link2.  As soon as I match on one (say Link1) I should stop trying to join.

Thanks

Mark",sql,,,,,,open,0,61,6,"SQL Join on first matched field I have a query to join 2 tables in the following way.

Table1 has a field (LinkTo) that may (or may not) appear in one of three fields in table Table2 (Link, Link1, Link2).  I need try joining LinkTo to Link, then Link1 then Link2.  As soon as I match on one (say Link1) I should stop trying to join.

Thanks

Mark",1
2905808,05/25/2010 14:54:27,327946,04/28/2010 14:14:59,1,0,SQL statements in sepreate file,"I working on .net project and writing an application that interacts with database.  I currently have some sql statements in the code and I want to put these statements in separate file with solution.  So, later when the application gets deployed, and if I want to update sql statements, I could just update the statements in the file and just replace the file instead of redeploying the whole solution.

Thank you for your help.
",sql,,,,,,open,0,75,5,"SQL statements in sepreate file I working on .net project and writing an application that interacts with database.  I currently have some sql statements in the code and I want to put these statements in separate file with solution.  So, later when the application gets deployed, and if I want to update sql statements, I could just update the statements in the file and just replace the file instead of redeploying the whole solution.

Thank you for your help.
",1
6400193,06/19/2011 02:41:12,789067,06/08/2011 11:26:05,1,0,Where Clause with int,"How do you select all records from a table by int type field when it's not needed.

Say,

passedinValue is say = -1, That means it's not defined. So I need to omit that filter and return all customer records.

Select * from Customers where cityId = passedinValue

Thanks ",sql,where-clause,,,,06/19/2011 05:51:34,not a real question,1,46,4,"Where Clause with int How do you select all records from a table by int type field when it's not needed.

Say,

passedinValue is say = -1, That means it's not defined. So I need to omit that filter and return all customer records.

Select * from Customers where cityId = passedinValue

Thanks ",2
10510595,05/09/2012 06:02:12,703526,04/12/2011 07:05:01,106,0,sql query to search a word,"Greetings!

I have two tables in my database say Table1 and Table2.In Table1 i have skillid and skill.
In Table2 id , skill_desc and etc...
In Table2 skill_desc colum contains comma seperated description is added in each as below,
C#,Episerver,Asp.Net.
In tbale1 for example skillid----1 and skill--C#..
My requirement is , how to write an sql query to get the skillid from Table1 if the skill is present in skill_desc column which is a comma seperated string in Table2.
I have done a lot of googling and tried to write differnt queries but didnt able to find a better solution.Please help.
Thanks in Advance
Regards",sql,,,,,05/10/2012 03:54:04,too localized,1,96,6,"sql query to search a word Greetings!

I have two tables in my database say Table1 and Table2.In Table1 i have skillid and skill.
In Table2 id , skill_desc and etc...
In Table2 skill_desc colum contains comma seperated description is added in each as below,
C#,Episerver,Asp.Net.
In tbale1 for example skillid----1 and skill--C#..
My requirement is , how to write an sql query to get the skillid from Table1 if the skill is present in skill_desc column which is a comma seperated string in Table2.
I have done a lot of googling and tried to write differnt queries but didnt able to find a better solution.Please help.
Thanks in Advance
Regards",1
2332363,02/25/2010 07:29:55,70345,02/24/2009 13:09:03,1875,122,Why are SQL UDFs so limited?,"From the MSDN docs for `create function`:

`User-defined functions cannot be used to perform actions that modify the database state.`

My question is simply - **why**?

Yes, a UDF that modifies data may have potentially unwanted side-effects.  
Yes, there is overhead involved if a UDF is called thousands of times.

But that is the whole point of design and testing - to ensure that such issues are ironed out before deployment. So why do DB vendors insist on imposing these artificial limitations on developers? What is the point of a language construct that can essentially only be used as a wrapper for `select` statements?

The reason for this question is as follows: I am writing a function to return a GUID for a certain unique integer ID. If a GUID is already allocated for that ID I simply return it; otherwise I want to generate a new GUID, store that into a table, and return the newly-generated GUID. (Yes, this sounds long-winded and possibly crazy, but when you're sending data to another dev company who believes their design was handed down by God and cannot be improved upon, it's easier just to smile and nod and do what they ask).

I know that I can use a stored procedure with an output parameter to achieve the same result, but then I have to declare a new variable just to hold the result of the sproc. Not only that, I then have to convert my simple `select` into a while loop that inserts into a temporary table, and call the sproc for every iteration of that loop.",sql,sql-server,udf,,,,open,0,261,6,"Why are SQL UDFs so limited? From the MSDN docs for `create function`:

`User-defined functions cannot be used to perform actions that modify the database state.`

My question is simply - **why**?

Yes, a UDF that modifies data may have potentially unwanted side-effects.  
Yes, there is overhead involved if a UDF is called thousands of times.

But that is the whole point of design and testing - to ensure that such issues are ironed out before deployment. So why do DB vendors insist on imposing these artificial limitations on developers? What is the point of a language construct that can essentially only be used as a wrapper for `select` statements?

The reason for this question is as follows: I am writing a function to return a GUID for a certain unique integer ID. If a GUID is already allocated for that ID I simply return it; otherwise I want to generate a new GUID, store that into a table, and return the newly-generated GUID. (Yes, this sounds long-winded and possibly crazy, but when you're sending data to another dev company who believes their design was handed down by God and cannot be improved upon, it's easier just to smile and nod and do what they ask).

I know that I can use a stored procedure with an output parameter to achieve the same result, but then I have to declare a new variable just to hold the result of the sproc. Not only that, I then have to convert my simple `select` into a while loop that inserts into a temporary table, and call the sproc for every iteration of that loop.",3
11161096,06/22/2012 17:18:06,376113,06/25/2010 09:37:45,3119,147,Relational Algebra and R,"I'm new to R and I was wondering if you can do easily (or with a package) relational Algebra (or SQL like function) ? I might not been using the right tool, what I want is mainly analyze date and generate graphs from different 'group by ' perspective.",sql,r,relational-algebra,,,06/22/2012 18:22:36,not constructive,1,48,4,"Relational Algebra and R I'm new to R and I was wondering if you can do easily (or with a package) relational Algebra (or SQL like function) ? I might not been using the right tool, what I want is mainly analyze date and generate graphs from different 'group by ' perspective.",3
3190765,07/06/2010 22:46:10,9058,09/15/2008 17:35:57,384,18,Is there a better way to organize and make this SQL query more readable?,"I have inherited a piece of SQL that I am working on for a reporting system. The system is centered around Purchase Orders, and when they are Created, Transmitted, Acknowledged, and Confirmed. These states are a progressive state. The piece of SQL that I am reviewing is shown below and is from the WHERE clause:

    OR (CreateJob.endtime is NULL and DATEDIFF(hour, buy_date, getdate()) > Vendor.expected_create_hours)
    OR (TransmitJob.endtime is NULL and DATEDIFF(hour, CreateJob.endtime, getdate()) > Vendor.expected_transmit_hours)
    OR (AcknowledgeJob.endtime is NULL and DATEDIFF(hour, TransmitJob.endtime, getdate()) > Vendor.expected_acknowledge_hours)
    OR (ConfirmJob.endtime is NULL and DATEDIFF(hour, AcknowledgeJob.endtime, getdate()) > Vendor.expected_confirm_hours)

What I have found is that it is possible for a CreateJob to not have an end time because the job failed. However a job can execute more then one Purchase Order, so there are times when a given PO actually was created, but the job does not receive an end time because a sibling later failed. This creates a scenario where the states still progress for a PO, but it still shows up on this problem report because the CreateJob.endtime is NULL.

So first there are some obvious bugs with the system and architecture above, but that is a separate issue from what I am tackling at the moment.

It seems that I could fix the report though, by basically adding the progressive checks as AND statements. So the first check for the CreateJob changes too:

    ((CreateJob.endtime is NULL and DATEDIFF(hour, buy_date, getdate()) > Vendor.expected_create_hours) AND (TransmitJob.endtime is NULL and DATEDIFF(hour, CreateJob.endtime, getdate()) > Vendor.expected_transmit_hours) AND (AcknowledgeJob.endtime is NULL and DATEDIFF(hour, TransmitJob.endtime, getdate()) > Vendor.expected_acknowledge_hours) AND (ConfirmJob.endtime is NULL and DATEDIFF(hour, AcknowledgeJob.endtime, getdate()) > Vendor.expected_confirm_hours))

Which is ugly and begins to obfuscate things into oblivion. Is there some way I can do the equivalent of the following in SQL? Basically some kind of macro or #define system?

    CreateFailed = (CreateJob.endtime is NULL and DATEDIFF(hour, buy_date, getdate()) > Vendor.expected_create_hours)
    TransmitFailed = (TransmitJob.endtime is NULL and DATEDIFF(hour, CreateJob.endtime, getdate()) > Vendor.expected_transmit_hours)
    AcknowledgeFailed = (AcknowledgeJob.endtime is NULL and DATEDIFF(hour, TransmitJob.endtime, getdate()) > Vendor.expected_acknowledge_hours)
    ConfirmFailed = (ConfirmJob.endtime is NULL and DATEDIFF(hour, AcknowledgeJob.endtime, getdate()) > Vendor.expected_confirm_hours)
    
    
    OR (CreateFailed AND TransmitFailed AND AcknowledgeFailed AND ConfirmFailed)
    OR (TransmitFailed AND AcknowledgeFailed AND ConfirmFailed)
    OR (AcknowledgeFailed AND ConfirmFailed)
    OR (ConfirmFailed)

If there is a common term or name for what I am trying to do maybe someone could add it to the title?",sql,code-organization,,,,,open,0,432,14,"Is there a better way to organize and make this SQL query more readable? I have inherited a piece of SQL that I am working on for a reporting system. The system is centered around Purchase Orders, and when they are Created, Transmitted, Acknowledged, and Confirmed. These states are a progressive state. The piece of SQL that I am reviewing is shown below and is from the WHERE clause:

    OR (CreateJob.endtime is NULL and DATEDIFF(hour, buy_date, getdate()) > Vendor.expected_create_hours)
    OR (TransmitJob.endtime is NULL and DATEDIFF(hour, CreateJob.endtime, getdate()) > Vendor.expected_transmit_hours)
    OR (AcknowledgeJob.endtime is NULL and DATEDIFF(hour, TransmitJob.endtime, getdate()) > Vendor.expected_acknowledge_hours)
    OR (ConfirmJob.endtime is NULL and DATEDIFF(hour, AcknowledgeJob.endtime, getdate()) > Vendor.expected_confirm_hours)

What I have found is that it is possible for a CreateJob to not have an end time because the job failed. However a job can execute more then one Purchase Order, so there are times when a given PO actually was created, but the job does not receive an end time because a sibling later failed. This creates a scenario where the states still progress for a PO, but it still shows up on this problem report because the CreateJob.endtime is NULL.

So first there are some obvious bugs with the system and architecture above, but that is a separate issue from what I am tackling at the moment.

It seems that I could fix the report though, by basically adding the progressive checks as AND statements. So the first check for the CreateJob changes too:

    ((CreateJob.endtime is NULL and DATEDIFF(hour, buy_date, getdate()) > Vendor.expected_create_hours) AND (TransmitJob.endtime is NULL and DATEDIFF(hour, CreateJob.endtime, getdate()) > Vendor.expected_transmit_hours) AND (AcknowledgeJob.endtime is NULL and DATEDIFF(hour, TransmitJob.endtime, getdate()) > Vendor.expected_acknowledge_hours) AND (ConfirmJob.endtime is NULL and DATEDIFF(hour, AcknowledgeJob.endtime, getdate()) > Vendor.expected_confirm_hours))

Which is ugly and begins to obfuscate things into oblivion. Is there some way I can do the equivalent of the following in SQL? Basically some kind of macro or #define system?

    CreateFailed = (CreateJob.endtime is NULL and DATEDIFF(hour, buy_date, getdate()) > Vendor.expected_create_hours)
    TransmitFailed = (TransmitJob.endtime is NULL and DATEDIFF(hour, CreateJob.endtime, getdate()) > Vendor.expected_transmit_hours)
    AcknowledgeFailed = (AcknowledgeJob.endtime is NULL and DATEDIFF(hour, TransmitJob.endtime, getdate()) > Vendor.expected_acknowledge_hours)
    ConfirmFailed = (ConfirmJob.endtime is NULL and DATEDIFF(hour, AcknowledgeJob.endtime, getdate()) > Vendor.expected_confirm_hours)
    
    
    OR (CreateFailed AND TransmitFailed AND AcknowledgeFailed AND ConfirmFailed)
    OR (TransmitFailed AND AcknowledgeFailed AND ConfirmFailed)
    OR (AcknowledgeFailed AND ConfirmFailed)
    OR (ConfirmFailed)

If there is a common term or name for what I am trying to do maybe someone could add it to the title?",2
11648737,07/25/2012 11:30:27,1551264,07/25/2012 10:16:37,1,0,Use LINQ to SQL generated classes in RDLC report,"I'm working now for a long while on anapplication. Now that most forms and logic is implemented, it is time to add reporting.

The application uses many different assemblies. One is specific for database access and contains all the LINQ to SQL tables,views and stored procedures.

In another assembly that will be used solely for reporting, I want to use those classes.

When I create the report and datsource, you can use objects and select one of those classes. This generate a datasource with some XML.

When i run the report i get no result.

Is there still custom code needed to get results?

Thanks in advance,
Joeri
",sql,linq,reporting,,,07/27/2012 04:20:03,not a real question,1,101,9,"Use LINQ to SQL generated classes in RDLC report I'm working now for a long while on anapplication. Now that most forms and logic is implemented, it is time to add reporting.

The application uses many different assemblies. One is specific for database access and contains all the LINQ to SQL tables,views and stored procedures.

In another assembly that will be used solely for reporting, I want to use those classes.

When I create the report and datsource, you can use objects and select one of those classes. This generate a datasource with some XML.

When i run the report i get no result.

Is there still custom code needed to get results?

Thanks in advance,
Joeri
",3
4304381,11/29/2010 13:51:44,173718,09/15/2009 12:56:22,446,15,archiving the table : searching for the best way,"there is a table which has 80.000 rows.
Everyday I will clone this table to another log table giving a name like 20101129_TABLE
, and every day the prefix will be changed according to date..

As you calculate, the data will be 2400 000 rows every month..

Advices please for saving space, and getting fast service and other advantages and disadvantages!! how should i think to create the best archive or log..

it is a table has the accounts info. branch code balance etc",sql,sql-server-2008,logging,,,,open,0,79,9,"archiving the table : searching for the best way there is a table which has 80.000 rows.
Everyday I will clone this table to another log table giving a name like 20101129_TABLE
, and every day the prefix will be changed according to date..

As you calculate, the data will be 2400 000 rows every month..

Advices please for saving space, and getting fast service and other advantages and disadvantages!! how should i think to create the best archive or log..

it is a table has the accounts info. branch code balance etc",3
8640605,12/27/2011 02:15:51,222427,12/01/2009 21:04:28,1087,8,sql select into cursor example for entire tables,"This is my first time doing a cursor and i really have no idea how to do it.  I'm doing a select into and my code is below.  How can i modified this to make a cursor and keep it as simple as possible.  The point will be to call this programatically in C#, i can create the code for C# but not sure how to turn this into a cursor statement.

`SELECT * INTO targetDB.dbo.targetTable FROM sourceDB.dbo.sourceDB`

I need to cursor this in because the trigger that are on the DB don't handle multiple lines.  Any help would be great!  Thanks!",sql,,,,,,open,0,105,8,"sql select into cursor example for entire tables This is my first time doing a cursor and i really have no idea how to do it.  I'm doing a select into and my code is below.  How can i modified this to make a cursor and keep it as simple as possible.  The point will be to call this programatically in C#, i can create the code for C# but not sure how to turn this into a cursor statement.

`SELECT * INTO targetDB.dbo.targetTable FROM sourceDB.dbo.sourceDB`

I need to cursor this in because the trigger that are on the DB don't handle multiple lines.  Any help would be great!  Thanks!",1
6489981,06/27/2011 07:50:20,136141,07/10/2009 08:41:48,3015,34,What is POPULAR today when it comes to write SQL Queries: UPPER CASE or Lower Case?,"What is POPULAR today when it comes to write SQL Queries: UPPER CASE or Lower Case? And for specific reason?

SELECT * FROM tMyTable 

Or

Select * from tMytable

",sql,tsql,conventions,uppercase,lowercase,06/27/2011 09:47:00,not constructive,1,27,16,"What is POPULAR today when it comes to write SQL Queries: UPPER CASE or Lower Case? What is POPULAR today when it comes to write SQL Queries: UPPER CASE or Lower Case? And for specific reason?

SELECT * FROM tMyTable 

Or

Select * from tMytable

",5
3801188,09/27/2010 04:54:39,480096,08/25/2010 10:29:57,1,0,SQL Query Optimization,what are the basic principles for the query optimization in Postgres/PGSQL and oracle. Can any one elaborate it.,sql,,,,,09/29/2010 02:54:10,not a real question,1,18,3,SQL Query Optimization what are the basic principles for the query optimization in Postgres/PGSQL and oracle. Can any one elaborate it.,1
6565186,07/03/2011 19:50:55,745989,05/10/2011 00:33:49,27,1,SQL anagram efficiency and logic?,"I have an SQL db with about 200,000 words I need a query which I will be able to solve an anagram kind of.  The difference is that I need all the possible words that could be made with the inputed characters for example, If you input ofdg, it should output the words: do, go, and dog.  Can you estimate the amount of time a query like this would take.  How can I make it faster and more efficient?  Also, in general how long does it take SQL to parse a 200000 row database.",sql,performance,logic,,,07/04/2011 10:09:50,not a real question,1,98,5,"SQL anagram efficiency and logic? I have an SQL db with about 200,000 words I need a query which I will be able to solve an anagram kind of.  The difference is that I need all the possible words that could be made with the inputed characters for example, If you input ofdg, it should output the words: do, go, and dog.  Can you estimate the amount of time a query like this would take.  How can I make it faster and more efficient?  Also, in general how long does it take SQL to parse a 200000 row database.",3
7737534,10/12/2011 08:57:00,980376,10/05/2011 12:48:46,1,0,How to handle billing and Payments for the entire period of Loan,"Im developing a loan management application and Im able to create the Amortization schedule. but I need to know the following

1. How do I use the Schedule to actually bill the client for the duration of the contract

2. How to allocate Payments made to Capital and Interest accordingly


A structure of the SQL table(s) would be highly appreciated


Thanks",sql,,,,,10/15/2011 04:12:11,not a real question,1,57,12,"How to handle billing and Payments for the entire period of Loan Im developing a loan management application and Im able to create the Amortization schedule. but I need to know the following

1. How do I use the Schedule to actually bill the client for the duration of the contract

2. How to allocate Payments made to Capital and Interest accordingly


A structure of the SQL table(s) would be highly appreciated


Thanks",1
5661690,04/14/2011 10:12:54,669174,03/21/2011 09:44:12,25,0,Problem with User /SQL Permissions,"Please forgive me if this post is in the wrong place, but as your all the cleverest bunch of guys I know, advice would be appreciated.

Another user in my company wrote [and on another pc], installed the new application [written in vb.net I think - but maybe c#].

He left the company a month a go, and I have now started to get problems [or rather notice them for the first time] - the files were being logged to SQL Server on the network.  Now I notice that a month ago the Network SQL Server 2008 has not been logging the data, but in fact it has been accumulating under SQL 2005 on the local machine that the software is installed on, and the temp file is over 100mb big...


I suspect that the IT department froze his account when he left, and this disrupted the SQL access and program network permissions.  The Event Viewer seems to support this theory by logging red critical errors that basically say [unable to connect to SQL server etc etc].

The program runs now as a guest [It always ran as a guest]. So I cant see how freezing or deleting his account would affect things.

Do you know how I can fix this without re-installing everything?

Thanks in advance.
Jim.



",sql,permissions,,,,,open,0,213,5,"Problem with User /SQL Permissions Please forgive me if this post is in the wrong place, but as your all the cleverest bunch of guys I know, advice would be appreciated.

Another user in my company wrote [and on another pc], installed the new application [written in vb.net I think - but maybe c#].

He left the company a month a go, and I have now started to get problems [or rather notice them for the first time] - the files were being logged to SQL Server on the network.  Now I notice that a month ago the Network SQL Server 2008 has not been logging the data, but in fact it has been accumulating under SQL 2005 on the local machine that the software is installed on, and the temp file is over 100mb big...


I suspect that the IT department froze his account when he left, and this disrupted the SQL access and program network permissions.  The Event Viewer seems to support this theory by logging red critical errors that basically say [unable to connect to SQL server etc etc].

The program runs now as a guest [It always ran as a guest]. So I cant see how freezing or deleting his account would affect things.

Do you know how I can fix this without re-installing everything?

Thanks in advance.
Jim.



",2
4836391,01/29/2011 10:39:41,146077,07/28/2009 00:21:46,2923,218,Naming convention for unique constraint,"Naming conventions are important, and primary key and foreign key have commonly used and obvious conventions (`PK_Table` and `FK_Table_ReferencedTable`, respectively).  The `IX_Table_Column` naming for indexes is also fairly standard.

What about the UNIQUE constraint?  Is there a commonly accepted naming convention for this constraint?  I've seen `UK_TableName_Column`, `UQ_TableName_Column`, and someone recommending `AX_TableName_Column` - I don't know where that comes from.

I've typically used `UQ` but I don't particularly like it, and I do not enjoy having to defend my choice of using it against a `UK` advocate.

I would simply like to see if there is a consensus on the most prevalent naming, or a good reasoning as to why one makes more sense than the others.

",sql,sql-server,naming-conventions,unique-constraint,,06/02/2012 20:17:36,not constructive,1,117,5,"Naming convention for unique constraint Naming conventions are important, and primary key and foreign key have commonly used and obvious conventions (`PK_Table` and `FK_Table_ReferencedTable`, respectively).  The `IX_Table_Column` naming for indexes is also fairly standard.

What about the UNIQUE constraint?  Is there a commonly accepted naming convention for this constraint?  I've seen `UK_TableName_Column`, `UQ_TableName_Column`, and someone recommending `AX_TableName_Column` - I don't know where that comes from.

I've typically used `UQ` but I don't particularly like it, and I do not enjoy having to defend my choice of using it against a `UK` advocate.

I would simply like to see if there is a consensus on the most prevalent naming, or a good reasoning as to why one makes more sense than the others.

",4
6678310,07/13/2011 11:43:52,240141,12/29/2009 11:47:49,1080,187,Tip to analyze and write simple or complex sql queries ?,"I just want to know the ways you guys use while writing a complex queries depending upon the scenario. Any tool or instant logic or paper pen. I am asking so as Sql do not provide as much as flexibility (like API, Debuggers etc) than Visual Studio, where we can debug and fix code instantly. I has posted numerous questions here on SO regarding SQL and got the answer in a minute or two. 

I am not that much good in Sql programming, as I feel more comfortable in the C# or VB.net. But i am working on that part too. So, How Do I improve my programming skill in SQL query writing, apart from studying books.

Please guide...",sql,tsql,,,,07/14/2011 19:25:21,not a real question,1,118,11,"Tip to analyze and write simple or complex sql queries ? I just want to know the ways you guys use while writing a complex queries depending upon the scenario. Any tool or instant logic or paper pen. I am asking so as Sql do not provide as much as flexibility (like API, Debuggers etc) than Visual Studio, where we can debug and fix code instantly. I has posted numerous questions here on SO regarding SQL and got the answer in a minute or two. 

I am not that much good in Sql programming, as I feel more comfortable in the C# or VB.net. But i am working on that part too. So, How Do I improve my programming skill in SQL query writing, apart from studying books.

Please guide...",2
6702173,07/15/2011 02:44:27,293249,03/14/2010 04:12:52,360,3,MS SQL08 I just executed [delete from allMyHardWorkTable] why isn't there an undo?,"Help!
I just must have skipped a thought and executed that command. I know I'm a numbskull, thanks for any help!


What is the easiest way that I can get my data back?

Is there a way to created a stored procedure to make myself an undo? 

I'm using MS SQL 2005.

/cry",sql,sql-server-2005,restore,database-restore,,07/16/2011 07:29:00,off topic,1,49,13,"MS SQL08 I just executed [delete from allMyHardWorkTable] why isn't there an undo? Help!
I just must have skipped a thought and executed that command. I know I'm a numbskull, thanks for any help!


What is the easiest way that I can get my data back?

Is there a way to created a stored procedure to make myself an undo? 

I'm using MS SQL 2005.

/cry",4
9346714,02/19/2012 04:31:01,973671,09/30/2011 18:55:40,62,0,Sql Pivot table with two cross tab and multiple columns,"I am trying to build a table with two cross tabs and multiple columns. I have this so far, and when I run it

		create table test2(city nvarchar(10), race nvarchar(30), sex nvarchar(10), age int)
		insert into test2 values ('Austin',  'African-American', 'male', 21)
		insert into test2 values ('Austin',  'Asian', 'female', 22)
		insert into test2 values ('Austin',  'Caucasian', 'male', 23)
		insert into test2 values ('Austin',  'Hispanic', 'female', 24)
		insert into test2 values ('Austin',  'African-American', 'Unknown', 25)
		insert into test2 values ('Austin',  'Asian', 'male', 26)
		insert into test2 values ('Austin',  'Caucasian', 'female', 27)
		insert into test2 values ('Austin',  'Hispanic', 'Unknown', 28)
		insert into test2 values ('Austin',  'Asian', 'male', 29)
		insert into test2 values ('Austin',  'Caucasian', 'female', 31)
		insert into test2 values ('Dallas',  'Hispanic', 'Unknown', 32)
		insert into test2 values ('Dallas',  'African-American', 'male', 33)
		insert into test2 values ('Dallas',  'Asian', 'female', 34)
		insert into test2 values ('Dallas',  'Caucasian', 'Unknown', 35)
		insert into test2 values ('Dallas',  'Hispanic', 'male', 500)
		insert into test2 values ('Dallas',  'African-American', 'female', 36)
		insert into test2 values ('Dallas',  'Asian', 'Unknown', 37)
		insert into test2 values ('Dallas',  'Caucasian', 'male', 38)
		insert into test2 values ('Dallas',  'Hispanic', 'female', 39)
		insert into test2 values ('Dallas',  'African-American', 'Unknown', 41)
		insert into test2 values ('Houston',  'Asian', 'male', 42)
		insert into test2 values ('Houston',  'Caucasian', 'female', 43)
		insert into test2 values ('Houston',  'Hispanic', 'Unknown', 44)
		insert into test2 values ('Houston',  'African-American', 'male', 45)
		insert into test2 values ('Houston',  'Asian', 'female', 46)
		insert into test2 values ('Houston',  'Caucasian', 'Unknown', 47)
		insert into test2 values ('Houston',  'Hispanic', 'male', 48)
		insert into test2 values ('Houston',  'African-American', 'female', 49)
		insert into test2 values ('Houston',  'Asian', 'Unknown', 51)
		insert into test2 values ('Houston',  'Caucasian', 'male', 52)

		SELECT  *
		FROM
		(
		SELECT  a.city, a.sex
		FROM [AdventureWorksDW].[dbo].[test2] a

		) p
		PIVOT
		(
		COUNT (sex)
		FOR sex
		IN ([male], [female], [Unknown])
		) AS pvt

I get this

![s](http://realestateagenthealthinsurance.com/images/111.jpg)

But what I need is this, with two cross tabs on top and a option for multiple columns.

![s](http://realestateagenthealthinsurance.com/images/222.jpg)

Is this possible with a pivot or any other solution?
Thanks in advance
",sql,sql-server-2008,pivot-table,crosstab,,,open,0,318,10,"Sql Pivot table with two cross tab and multiple columns I am trying to build a table with two cross tabs and multiple columns. I have this so far, and when I run it

		create table test2(city nvarchar(10), race nvarchar(30), sex nvarchar(10), age int)
		insert into test2 values ('Austin',  'African-American', 'male', 21)
		insert into test2 values ('Austin',  'Asian', 'female', 22)
		insert into test2 values ('Austin',  'Caucasian', 'male', 23)
		insert into test2 values ('Austin',  'Hispanic', 'female', 24)
		insert into test2 values ('Austin',  'African-American', 'Unknown', 25)
		insert into test2 values ('Austin',  'Asian', 'male', 26)
		insert into test2 values ('Austin',  'Caucasian', 'female', 27)
		insert into test2 values ('Austin',  'Hispanic', 'Unknown', 28)
		insert into test2 values ('Austin',  'Asian', 'male', 29)
		insert into test2 values ('Austin',  'Caucasian', 'female', 31)
		insert into test2 values ('Dallas',  'Hispanic', 'Unknown', 32)
		insert into test2 values ('Dallas',  'African-American', 'male', 33)
		insert into test2 values ('Dallas',  'Asian', 'female', 34)
		insert into test2 values ('Dallas',  'Caucasian', 'Unknown', 35)
		insert into test2 values ('Dallas',  'Hispanic', 'male', 500)
		insert into test2 values ('Dallas',  'African-American', 'female', 36)
		insert into test2 values ('Dallas',  'Asian', 'Unknown', 37)
		insert into test2 values ('Dallas',  'Caucasian', 'male', 38)
		insert into test2 values ('Dallas',  'Hispanic', 'female', 39)
		insert into test2 values ('Dallas',  'African-American', 'Unknown', 41)
		insert into test2 values ('Houston',  'Asian', 'male', 42)
		insert into test2 values ('Houston',  'Caucasian', 'female', 43)
		insert into test2 values ('Houston',  'Hispanic', 'Unknown', 44)
		insert into test2 values ('Houston',  'African-American', 'male', 45)
		insert into test2 values ('Houston',  'Asian', 'female', 46)
		insert into test2 values ('Houston',  'Caucasian', 'Unknown', 47)
		insert into test2 values ('Houston',  'Hispanic', 'male', 48)
		insert into test2 values ('Houston',  'African-American', 'female', 49)
		insert into test2 values ('Houston',  'Asian', 'Unknown', 51)
		insert into test2 values ('Houston',  'Caucasian', 'male', 52)

		SELECT  *
		FROM
		(
		SELECT  a.city, a.sex
		FROM [AdventureWorksDW].[dbo].[test2] a

		) p
		PIVOT
		(
		COUNT (sex)
		FOR sex
		IN ([male], [female], [Unknown])
		) AS pvt

I get this

![s](http://realestateagenthealthinsurance.com/images/111.jpg)

But what I need is this, with two cross tabs on top and a option for multiple columns.

![s](http://realestateagenthealthinsurance.com/images/222.jpg)

Is this possible with a pivot or any other solution?
Thanks in advance
",4
7613555,09/30/2011 16:50:28,762844,05/20/2011 13:49:35,26,1,SQL: finding duplicate rows on more than one field,"I am using this query to find duplicates based on two fields:

    SELECT 
        last_name, 
        first_name,
        middle_initial,
        COUNT(last_name) AS Duplicates,
        IF(rec_id = '', 1, 0) AS has_REC_ID 
    FROM files
    GROUP BY last_name, first_name
    HAVING COUNT(last_name) > 1 AND COUNT(first_name) > 1;

Okay, what this returns is a set of rows with first, last, and middle names, a column called 'Duplicates' with a lot of 2s, and a column called has_REC_ID with mixed 1s and 0s.

Ultimately, what I'm trying to do is find which rows have matching first and last names--and then for each of those pairs, find the one that has ('') as a value for `rec_id`, assign the rec_id value from the one that DOES have a rec_id, and then delete the record that had a rec_id in the first place.

So for starters I though I would create a new column and do something like this:

    UPDATE files a 
    SET a.has_dup    --new column
        = if(a.last_name IN (
                             SELECT b.last_name
                             FROM files b
                             GROUP BY b.last_name 
                             HAVING COUNT(b.last_name) > 1
                            )
          , 1, null);

But MySQL returns: ""You can't specify target table 'a' for update in from clause""

I'll bet there's something much less ridiculous than the method I'm trying here. Can someone please help me figure out what that is?",sql,duplicates,,,,,open,0,423,9,"SQL: finding duplicate rows on more than one field I am using this query to find duplicates based on two fields:

    SELECT 
        last_name, 
        first_name,
        middle_initial,
        COUNT(last_name) AS Duplicates,
        IF(rec_id = '', 1, 0) AS has_REC_ID 
    FROM files
    GROUP BY last_name, first_name
    HAVING COUNT(last_name) > 1 AND COUNT(first_name) > 1;

Okay, what this returns is a set of rows with first, last, and middle names, a column called 'Duplicates' with a lot of 2s, and a column called has_REC_ID with mixed 1s and 0s.

Ultimately, what I'm trying to do is find which rows have matching first and last names--and then for each of those pairs, find the one that has ('') as a value for `rec_id`, assign the rec_id value from the one that DOES have a rec_id, and then delete the record that had a rec_id in the first place.

So for starters I though I would create a new column and do something like this:

    UPDATE files a 
    SET a.has_dup    --new column
        = if(a.last_name IN (
                             SELECT b.last_name
                             FROM files b
                             GROUP BY b.last_name 
                             HAVING COUNT(b.last_name) > 1
                            )
          , 1, null);

But MySQL returns: ""You can't specify target table 'a' for update in from clause""

I'll bet there's something much less ridiculous than the method I'm trying here. Can someone please help me figure out what that is?",2
10827268,05/31/2012 04:01:07,1417448,05/25/2012 12:59:52,80,3,Wrapping a Stored Procedure SQL,"using oracle to code the sql statement, been given some homework I don't thoroughly understand/struggling to grasp(so if you have any good tutorials/links for basic sql procedures/functions that would be appreciated.  


here is the question 
---------------------------------------
A Stored Procedure that lists all names, descriptions and values of items in the La Trobe e-Auction database system together with a column which displays:
‘Sold’ if the auction is already closed and the item is sold
‘No bid’ if the auction is already closed and no bid has been placed for the item
‘No sale’ if the auction is already closed but the reserve price was not met
‘On auction’ if the auction for the item is still open
-----------------------------------------------------------

    Item (itemNumber, itemName, itemDescription, itemValue, itemLocation, 
    categoryID, sellerUsername)   

    Auction (auctionNumber, currency, startDateTime, endDateTime, shippingTerms, 
    startBidAmount, reserveAmount, bidIncrementAmount, noOfItems, itemSold, 
    itemNumber feedbackDateAndTime, rating, comments, paymentDate, paymentid)

    Bid (bidderUsername, auctionNumber, bidDateTime,bidAmount)

     

here is the theory I have worked out but I am at a loss on how to code it.  

    status column -  a)sold, closed and item is sold
    				 b)no bid, auction is close and no bids
    				 c)no sale, the auction is closed but reserve wasnt met
    				 d)on auction, auction for the item is still open
    
    				 a) if i.itemnumber=a.itemnumber and itemSold='y'
    				 b) if a.auctionnumber != b.auctionnumber and systemdate>endDateTime
    				 c) if sysdate>endDatetime and a.auctionnumber=b.auctionnumber 
    				 and reserveamount>select b.bidAmount 
    				 from bid where a.auctionnumber=b.auctionnumber 
    				 and b.bidAmount.max;
    				 d) if itemSold ='n' and sysdate<endDateTime;
    
    
  

    CREATE OR REPLACE PROCEDURE allItemStatus
    AS 
    	p_itemName Item.itemName%TYPE;
    	p_itemDescription Item.itemDescription%TYPE;
    	p_itemValue Item.itemValue%TYPE;
    	P_itemSold Auction.itemSold%TYPE;
    	BEGIN
    SELECT i.itemName, i.itemDescription, i.itemValue, a.itemSold
    INTO p_itemName, p_itemDescription, p_itemValue , p_itemSold
    FROM dbf12.Item i, dbf12.Auction a
    WHERE i.itemNumber=a.itemNumber 
    AND a.itemSold='Y';
    DBMS_OUTPUT.PUT_LINE('Item Name: '||p_itemName);
    DBMS_OUTPUT.PUT_LINE('Item Description: '||p_itemDescription);
    DBMS_OUTPUT.PUT_LINE('Item Value: '||p_itemValue);
    	    DBMS_OUTPUT.PUT_LINE('Item Sold: '||p_itemSold);
      	END allItemStatus;
	



any help would be greatly appreciated. I know I've barely written out the entire thing but I am not sure where to go with this.",sql,oracle,function,procedure,,,open,0,451,5,"Wrapping a Stored Procedure SQL using oracle to code the sql statement, been given some homework I don't thoroughly understand/struggling to grasp(so if you have any good tutorials/links for basic sql procedures/functions that would be appreciated.  


here is the question 
---------------------------------------
A Stored Procedure that lists all names, descriptions and values of items in the La Trobe e-Auction database system together with a column which displays:
‘Sold’ if the auction is already closed and the item is sold
‘No bid’ if the auction is already closed and no bid has been placed for the item
‘No sale’ if the auction is already closed but the reserve price was not met
‘On auction’ if the auction for the item is still open
-----------------------------------------------------------

    Item (itemNumber, itemName, itemDescription, itemValue, itemLocation, 
    categoryID, sellerUsername)   

    Auction (auctionNumber, currency, startDateTime, endDateTime, shippingTerms, 
    startBidAmount, reserveAmount, bidIncrementAmount, noOfItems, itemSold, 
    itemNumber feedbackDateAndTime, rating, comments, paymentDate, paymentid)

    Bid (bidderUsername, auctionNumber, bidDateTime,bidAmount)

     

here is the theory I have worked out but I am at a loss on how to code it.  

    status column -  a)sold, closed and item is sold
    				 b)no bid, auction is close and no bids
    				 c)no sale, the auction is closed but reserve wasnt met
    				 d)on auction, auction for the item is still open
    
    				 a) if i.itemnumber=a.itemnumber and itemSold='y'
    				 b) if a.auctionnumber != b.auctionnumber and systemdate>endDateTime
    				 c) if sysdate>endDatetime and a.auctionnumber=b.auctionnumber 
    				 and reserveamount>select b.bidAmount 
    				 from bid where a.auctionnumber=b.auctionnumber 
    				 and b.bidAmount.max;
    				 d) if itemSold ='n' and sysdate<endDateTime;
    
    
  

    CREATE OR REPLACE PROCEDURE allItemStatus
    AS 
    	p_itemName Item.itemName%TYPE;
    	p_itemDescription Item.itemDescription%TYPE;
    	p_itemValue Item.itemValue%TYPE;
    	P_itemSold Auction.itemSold%TYPE;
    	BEGIN
    SELECT i.itemName, i.itemDescription, i.itemValue, a.itemSold
    INTO p_itemName, p_itemDescription, p_itemValue , p_itemSold
    FROM dbf12.Item i, dbf12.Auction a
    WHERE i.itemNumber=a.itemNumber 
    AND a.itemSold='Y';
    DBMS_OUTPUT.PUT_LINE('Item Name: '||p_itemName);
    DBMS_OUTPUT.PUT_LINE('Item Description: '||p_itemDescription);
    DBMS_OUTPUT.PUT_LINE('Item Value: '||p_itemValue);
    	    DBMS_OUTPUT.PUT_LINE('Item Sold: '||p_itemSold);
      	END allItemStatus;
	



any help would be greatly appreciated. I know I've barely written out the entire thing but I am not sure where to go with this.",4
7242835,08/30/2011 12:02:18,900205,08/18/2011 08:37:01,26,1,Wich normalization Form is commonly used?,"In rational Databases, of course.",sql,database,normalization,,,08/30/2011 12:08:16,not a real question,1,5,6,"Wich normalization Form is commonly used? In rational Databases, of course.",3
5867461,05/03/2011 09:15:50,168535,09/04/2009 13:36:52,732,22,MSSQL how to get last inserted data?,"I ran a large query (~30mb) which inserts data in ~20 tables. Accidentally, I selected wrong database. There are only 2 tables with same name but with different columns. Now I want to make sure that no data is inserted in this database, I just don't know how.",sql,sql-server,logging,,,,open,0,48,7,"MSSQL how to get last inserted data? I ran a large query (~30mb) which inserts data in ~20 tables. Accidentally, I selected wrong database. There are only 2 tables with same name but with different columns. Now I want to make sure that no data is inserted in this database, I just don't know how.",3
11395003,07/09/2012 12:27:46,1511953,07/09/2012 12:24:21,1,0,error while creating table in procedure,"i want to create a procedure in which i can create a table.
so i have done this


CREATE OR REPLACE PROCEDURE test_proc
 
BEGIN
execute immediate 'CREATE TABLE ABC_TABLE AS SELECT * FROM XYZ_TABLE WHERE 1=0';
END;

 
but after compiling i get following error.
 

**Encountered the symbol ""BEGIN"" when expecting one of the following: ( ; is with authid as cluster compress order using compiled wrapped external deterministic parallel_enable pipelined The symbol ""is"" was substituted for ""BEGIN"" to continue.**
 

can any one tell me reason for this and how to create the table in procedure.
 
thanks in advance... ",sql,oracle,,,,07/10/2012 04:30:13,too localized,1,95,6,"error while creating table in procedure i want to create a procedure in which i can create a table.
so i have done this


CREATE OR REPLACE PROCEDURE test_proc
 
BEGIN
execute immediate 'CREATE TABLE ABC_TABLE AS SELECT * FROM XYZ_TABLE WHERE 1=0';
END;

 
but after compiling i get following error.
 

**Encountered the symbol ""BEGIN"" when expecting one of the following: ( ; is with authid as cluster compress order using compiled wrapped external deterministic parallel_enable pipelined The symbol ""is"" was substituted for ""BEGIN"" to continue.**
 

can any one tell me reason for this and how to create the table in procedure.
 
thanks in advance... ",2
11643974,07/25/2012 06:36:10,1031725,11/06/2011 01:11:22,21,2,SQL view with date calculations,"I have a database that tracks the location of inventory. 

The application was poorly written and is a mess of spaghetti code with no MVC separation and updates to the model can happen in any number of files.

When the application was first written it only needed to track the location the inventory currently resides in so a SiteID column exists in the inventory table that lists it's currently assigned to.

Since then the owner has decided he wants to maintain a history of which locations the inventory is assigned to. Rather than trawl through all the code to try and find all the places it possibly updates I added a trigger `ON UPDATE`and `ON INSERT` to the inventory table that records movements in a history table.

The initial requirement was to be able to view the movement history of a piece of inventory which is easily solved with `SELECT * FROM history WHERE InvID = X ORDER BY timestamp DESC`

Now I've been asked to produce a list for a given location that shows when a piece of inventory is assigned to the site, and the date it leaves (example below). Ideally I'd like to achieve this without modifying the existing schema and triggers if possible.

I'm able to retrieve a list of all the inventory that was assigned to the site at one point and the date which it was assigned. What I'm struggling with is how to find the date that piece of inventory left the site. I could do it within the application but I wondered if it's possible with SQL.


**Inventory table**

    InventoryID     InventoryName    SiteID
    ===========     =============    ======
              1     Widget A         $ID
              2     Widget B         $ID
              3     Widget C         $ID

**Locations table**

    SiteID    SiteName
    ======    ========
         1    Somewhere
         2    Nowhere
         3    Anywhere

**History table**

    InvID    SiteID    Timestamp
    =====    ======    =========
        1         1    2012-01-01
        1         2    2012-01-02
        2         1    2012-01-03
        1         1    2012-01-04

**New view should look something like this**

    InvID    DateIn        DateOut
    =====    ==========    ==========
        1    2012-01-01    2012-01-02
        2    2012-01-03    NULL
        1    2012-01-04    NULL   

**Psuedo code to produce table with a programming language (post-processing SQL query**

    SELECT * FROM history WHERE SiteID = 1

    foreach (row in result) {
        DateOut = SELECT * FROM history WHERE InvID = result.InvID AND timestamp > result.timestamp LIMIT 1
    }",sql,,,,,,open,0,681,5,"SQL view with date calculations I have a database that tracks the location of inventory. 

The application was poorly written and is a mess of spaghetti code with no MVC separation and updates to the model can happen in any number of files.

When the application was first written it only needed to track the location the inventory currently resides in so a SiteID column exists in the inventory table that lists it's currently assigned to.

Since then the owner has decided he wants to maintain a history of which locations the inventory is assigned to. Rather than trawl through all the code to try and find all the places it possibly updates I added a trigger `ON UPDATE`and `ON INSERT` to the inventory table that records movements in a history table.

The initial requirement was to be able to view the movement history of a piece of inventory which is easily solved with `SELECT * FROM history WHERE InvID = X ORDER BY timestamp DESC`

Now I've been asked to produce a list for a given location that shows when a piece of inventory is assigned to the site, and the date it leaves (example below). Ideally I'd like to achieve this without modifying the existing schema and triggers if possible.

I'm able to retrieve a list of all the inventory that was assigned to the site at one point and the date which it was assigned. What I'm struggling with is how to find the date that piece of inventory left the site. I could do it within the application but I wondered if it's possible with SQL.


**Inventory table**

    InventoryID     InventoryName    SiteID
    ===========     =============    ======
              1     Widget A         $ID
              2     Widget B         $ID
              3     Widget C         $ID

**Locations table**

    SiteID    SiteName
    ======    ========
         1    Somewhere
         2    Nowhere
         3    Anywhere

**History table**

    InvID    SiteID    Timestamp
    =====    ======    =========
        1         1    2012-01-01
        1         2    2012-01-02
        2         1    2012-01-03
        1         1    2012-01-04

**New view should look something like this**

    InvID    DateIn        DateOut
    =====    ==========    ==========
        1    2012-01-01    2012-01-02
        2    2012-01-03    NULL
        1    2012-01-04    NULL   

**Psuedo code to produce table with a programming language (post-processing SQL query**

    SELECT * FROM history WHERE SiteID = 1

    foreach (row in result) {
        DateOut = SELECT * FROM history WHERE InvID = result.InvID AND timestamp > result.timestamp LIMIT 1
    }",1
4969108,02/11/2011 12:42:20,326821,04/27/2010 11:43:16,626,7,insert and convert null to 0,"Ive got table with null values in it. I would like to copy this table to another and replace null value from one column to for example 0. Is it possible cause my target table doesnt accept null values in this colum

`Insert into MyNewTable (A, B, C) select (AA, BB, CC) from MyOldTable`

And CC may be null


thanks for any help
",sql,sql-server-2005,,,,,open,0,60,6,"insert and convert null to 0 Ive got table with null values in it. I would like to copy this table to another and replace null value from one column to for example 0. Is it possible cause my target table doesnt accept null values in this colum

`Insert into MyNewTable (A, B, C) select (AA, BB, CC) from MyOldTable`

And CC may be null


thanks for any help
",2
6571246,07/04/2011 12:08:15,611641,01/01/2011 21:18:05,24,0,MS SQL 2008 - Picking all records from a table that match smallest date.,"I have a table that has a few hundred records. Let's say, for simplicity, that it has only two fields (ID and DateModified).

I need to get all records that match the smallest DateModifiedvalue in the table. 

For example, I have 6 records (ID / DateModified):

 - 344 / 11-June-2011
 - 345 / 5-June-2011
 - 346 / 5-June-2011
 - 347 / 20-June-2011
 - 348 / 5-June-2011
 - 349 / 16-June-2011

The query should return records 345, 346 and 348. How would I do this?

Thanks!!!

",sql,sql-server-2008,query,table,,,open,0,82,14,"MS SQL 2008 - Picking all records from a table that match smallest date. I have a table that has a few hundred records. Let's say, for simplicity, that it has only two fields (ID and DateModified).

I need to get all records that match the smallest DateModifiedvalue in the table. 

For example, I have 6 records (ID / DateModified):

 - 344 / 11-June-2011
 - 345 / 5-June-2011
 - 346 / 5-June-2011
 - 347 / 20-June-2011
 - 348 / 5-June-2011
 - 349 / 16-June-2011

The query should return records 345, 346 and 348. How would I do this?

Thanks!!!

",4
3496907,08/16/2010 20:06:18,422125,08/16/2010 20:06:18,1,0,Storing objects in SQL with Linq,"http://stackoverflow.com/questions/1118296/c-how-would-you-store-arbitrary-objects-in-an-sql-server

I'm trying to do the same thing but am having problems.
Can you share with me how you prepared your objects prior to inserting and updating the database?
I have a List<myObjext> that I want to store as a VarBinery(max) in SQL 2k8.

thanks,
ryan",sql,linq,,,,,open,0,41,6,"Storing objects in SQL with Linq http://stackoverflow.com/questions/1118296/c-how-would-you-store-arbitrary-objects-in-an-sql-server

I'm trying to do the same thing but am having problems.
Can you share with me how you prepared your objects prior to inserting and updating the database?
I have a List<myObjext> that I want to store as a VarBinery(max) in SQL 2k8.

thanks,
ryan",2
2964097,06/03/2010 07:44:42,356711,06/02/2010 17:33:36,38,0,"Error 18456. State 6 ""Attempting to use an NT account name with SQL Server Authentication.""","2010-05-06 17:21:22.30 Logon       Error: 18456, Severity: 14, State: 6.
2010-05-06 17:21:22.30 Logon       Login failed for user <domain\user>. Reason: Attempting to use an NT account name with SQL Server Authentication. [CLIENT: <IP>]

The authentication mode is ""Mixed"". And its MS SQL Server 2008.

What might be the issue? Do you think the user name was not configured properly?

Is there any link available for giving the right privileges and configuring the user account?
So that I can check the rights and privileges for the acc I am using...

thanks",sql,sql-server,,,,01/31/2012 16:43:44,off topic,1,94,15,"Error 18456. State 6 ""Attempting to use an NT account name with SQL Server Authentication."" 2010-05-06 17:21:22.30 Logon       Error: 18456, Severity: 14, State: 6.
2010-05-06 17:21:22.30 Logon       Login failed for user <domain\user>. Reason: Attempting to use an NT account name with SQL Server Authentication. [CLIENT: <IP>]

The authentication mode is ""Mixed"". And its MS SQL Server 2008.

What might be the issue? Do you think the user name was not configured properly?

Is there any link available for giving the right privileges and configuring the user account?
So that I can check the rights and privileges for the acc I am using...

thanks",2
10133971,04/13/2012 01:02:00,532797,12/06/2010 20:04:03,2069,88,"Database design suggestions for large, multi-part questionairre","Are there any good database design patterns for applications that collect many pieces of seemingly unrelated data?

I'm helping out with an app that will include a large, multi-part form, similar to an insurance application. There will be 60-80 questions in this form. Many of the questions are yes/no. Some do seem to be logically related, such as several questions yes/no questions on a person's criminal background, but they're really not true relational data in the same way that a mailing address relates to a user.

The most logical way to view this data is as a unit--the form itself. But that would be a massive table and would become a nightmare.

I've also thought about having a table for questions and another table for answers, where each row maps one user to one answer with a link back to the question. One drawback here is that all answers would end up being `varchar`.

It seems like there has to be a better way. Any suggestions?",sql,,,,,,open,0,162,7,"Database design suggestions for large, multi-part questionairre Are there any good database design patterns for applications that collect many pieces of seemingly unrelated data?

I'm helping out with an app that will include a large, multi-part form, similar to an insurance application. There will be 60-80 questions in this form. Many of the questions are yes/no. Some do seem to be logically related, such as several questions yes/no questions on a person's criminal background, but they're really not true relational data in the same way that a mailing address relates to a user.

The most logical way to view this data is as a unit--the form itself. But that would be a massive table and would become a nightmare.

I've also thought about having a table for questions and another table for answers, where each row maps one user to one answer with a link back to the question. One drawback here is that all answers would end up being `varchar`.

It seems like there has to be a better way. Any suggestions?",1
11543780,07/18/2012 14:31:54,661801,03/16/2011 03:51:40,43,2,sql update codeigniter,"I am using codeIgniter..
I want to update a table column `is_close` when `id=$ticket_id` of my `table= tbl_tickets.`
I am doing this :-

    $data=array(
                'is_close'=>1
                );
            $this->db->where('id',$title_id);
            $this->db->update('tbl_tickets',$data);

and I have also done this :-

    $sql = ""UPDATE tbl_tickets SET is_close={1} WHERE id='$title_id'"";
    $this->db->query($sql);

both are not working,i.e., my table is not updating the value to 1 and also no error is being shown in the broswer. :(",sql,codeigniter,sql-update,,,,open,0,125,3,"sql update codeigniter I am using codeIgniter..
I want to update a table column `is_close` when `id=$ticket_id` of my `table= tbl_tickets.`
I am doing this :-

    $data=array(
                'is_close'=>1
                );
            $this->db->where('id',$title_id);
            $this->db->update('tbl_tickets',$data);

and I have also done this :-

    $sql = ""UPDATE tbl_tickets SET is_close={1} WHERE id='$title_id'"";
    $this->db->query($sql);

both are not working,i.e., my table is not updating the value to 1 and also no error is being shown in the broswer. :(",3
9103542,02/01/2012 21:21:35,915839,08/27/2011 20:13:53,12,0,"SQL model/schema design, check constraints, FK or table redesign?","I have the following models (simplified leaving all other fields out, focusing on primary key ID's):

    [invoice]
     invoice_id
     customer_id
     invoice_description

    [customer]
      customer_id
      company_id
      customer_name

    [company]
     company_id
     company_name

    [strategy]
     strategy_id
     strategy_descripton

A company contains many customers, which in turn can have many invoices belonging to that customer.

Although not shown above, I also wish to have a list of strategies, that belong to a company (and only one company).

I would like the customer, invoice, and company, to be able to define a 'default strategy' which references a strategy of the company to which they belong.

I know i could put an extra FK field called strategy_id in each table (invoice, customer and company), but how can i ensure that if changes are made (someone tries to move a strategy to a different company) we do not end up with an invoice, or customer pointing to a strategy that belongs in another company's strategy list?

How would i deal with this - Do i need to check all this in business logic, or use check constraints, or can this be achieved through table redesign and foreign keys?

Many thanks in advance,

Chris",sql,entity-relationship,database-schema,,,,open,0,239,9,"SQL model/schema design, check constraints, FK or table redesign? I have the following models (simplified leaving all other fields out, focusing on primary key ID's):

    [invoice]
     invoice_id
     customer_id
     invoice_description

    [customer]
      customer_id
      company_id
      customer_name

    [company]
     company_id
     company_name

    [strategy]
     strategy_id
     strategy_descripton

A company contains many customers, which in turn can have many invoices belonging to that customer.

Although not shown above, I also wish to have a list of strategies, that belong to a company (and only one company).

I would like the customer, invoice, and company, to be able to define a 'default strategy' which references a strategy of the company to which they belong.

I know i could put an extra FK field called strategy_id in each table (invoice, customer and company), but how can i ensure that if changes are made (someone tries to move a strategy to a different company) we do not end up with an invoice, or customer pointing to a strategy that belongs in another company's strategy list?

How would i deal with this - Do i need to check all this in business logic, or use check constraints, or can this be achieved through table redesign and foreign keys?

Many thanks in advance,

Chris",3
8007468,11/04/2011 09:57:30,1088313,01/19/2011 04:08:55,138,0,How to get view to work,"I am working on this view. I am trying to add a view called StoreSales_vw in the Pubs database that shows the store name from all stores in California that match this criteria in the sales table: sales with quantities greater than 20 payterms greater than 'Net 30'. THis is what I have so far:

    CREATE VIEW StoreSales_vw
    AS
    SELECT	dbo.stores.state,
                dbo.sales.qty,
               dbo.sales.payterms
    FROM   dbo.sales 
    INNER JOIN
             dbo.stores ON dbo.sales.stor_id = dbo.stores.stor_id
    Where state ='California' quantites >20,payterm > 'Net 30'

I am getting an error on the StoreSales_vw and then by the quantities. Im not to sure how to do the last part when it is asking to do the city = california and the payterm, and quantities. I can usually do it if it is one but its asking for three things. Now would I put in more joins. Can someone explain this a little bit to me I am still new at it.

",sql,,,,,,open,0,215,6,"How to get view to work I am working on this view. I am trying to add a view called StoreSales_vw in the Pubs database that shows the store name from all stores in California that match this criteria in the sales table: sales with quantities greater than 20 payterms greater than 'Net 30'. THis is what I have so far:

    CREATE VIEW StoreSales_vw
    AS
    SELECT	dbo.stores.state,
                dbo.sales.qty,
               dbo.sales.payterms
    FROM   dbo.sales 
    INNER JOIN
             dbo.stores ON dbo.sales.stor_id = dbo.stores.stor_id
    Where state ='California' quantites >20,payterm > 'Net 30'

I am getting an error on the StoreSales_vw and then by the quantities. Im not to sure how to do the last part when it is asking to do the city = california and the payterm, and quantities. I can usually do it if it is one but its asking for three things. Now would I put in more joins. Can someone explain this a little bit to me I am still new at it.

",1
11255367,06/29/2012 02:35:45,1490121,06/29/2012 02:19:29,1,0,SQL Select statement - The thing i am querying for has a single quotation mark,"Hi everyone I am new to StackOverflow and SQL. I am not sure how to phrase the title so google was not very helpful.

I am doing a simple SELECT query:

    SELECT * FROM Department WHERE DepartmentName = ""Controller's Office""

I would like to return all results that has DepartmentName of ""Controller's Office"". The name itself has a single quotation that must not be removed(because boss said so). Using single quotation marks does not work. and returns an error:

    Invalid column name 'Controller's Office'.

How can i do the query so that it works? If you are doing anything complicated please explain because i am new thanks!",sql,,,,,,open,0,110,15,"SQL Select statement - The thing i am querying for has a single quotation mark Hi everyone I am new to StackOverflow and SQL. I am not sure how to phrase the title so google was not very helpful.

I am doing a simple SELECT query:

    SELECT * FROM Department WHERE DepartmentName = ""Controller's Office""

I would like to return all results that has DepartmentName of ""Controller's Office"". The name itself has a single quotation that must not be removed(because boss said so). Using single quotation marks does not work. and returns an error:

    Invalid column name 'Controller's Office'.

How can i do the query so that it works? If you are doing anything complicated please explain because i am new thanks!",1
6944116,08/04/2011 15:23:36,574663,01/13/2011 17:54:58,86,2,MSSQL SQL Clause where value is convertible,"Hi is there a way in MSSQL T-SQL to say 

`WHERE CONVERT(date, mat1_04_05, 101) = true ?`

I'm doing some reporting against a an app that I don't have source for and the column is varchar and I can't rely on user data.",sql,tsql,,,,,open,0,42,7,"MSSQL SQL Clause where value is convertible Hi is there a way in MSSQL T-SQL to say 

`WHERE CONVERT(date, mat1_04_05, 101) = true ?`

I'm doing some reporting against a an app that I don't have source for and the column is varchar and I can't rely on user data.",2
6984311,08/08/2011 15:13:04,549273,12/20/2010 22:57:49,92,0,Please critique my proposed database design,"I'm looking to get some feedback on my proposed database schema.  Here's the business scenario.  We need to maintain a list of a few million households identified by some anonymous ID.  We also need to maintain a list of demographics and other attributes that describe those households.  The list of attributes will grow over time by appending new attributes from external data files.  For example, imagine marketing buys a list of dog lovers and asks for it to be loaded as a new attribute called ""Likes Dogs"".

Here's my proposed schema.  I have separate tables for the households and for the related attributes.  In the household table there's an identity column and a hashed identifier that will come from our data suppliers.  The hashed value is there for privacy reasons.  We're not allowed to know who the households are (e.g. we won't have name, address, etc).  There will also be attribute columns for each attribute that indicate in a binary way whether the household has that attribute.  The actual definition of the attributes I've separated out into another table.


    HOUSEHOLD TABLE
    ID | External ID | Attribute 1 | Attribute 2 | Attribute N
    0  | hash val    |      1      |      0      |    0
    1  | hash val    |      1      |      0      |    1
    2  | hash val    |      0      |      0      |    0
    3  | hash val    |      1      |      0      |    0
    4  | hash val    |      0      |      1      |    1 
    5  | hash val    |      1      |      0      |    0
    N  | hash val    |      1      |      0      |    0



    HOUSEHOLD ATTRIBUTE TABLE
    AttributeID  | Attribute Name | Attribute Description
    0            |       Rich     |  Has income over $x
    1            |       SUV      |  Drives SUV
    2            |       XBox     |  Owns an XBox
    N            |       Urban    |  Lives in urban area

When we load new attributes and/or households we're likely receive flat files that indicate the hash val for the household the and the binary values for the attributes.  The name and descriptions for the attributes will, I anticipate, be in a meta data document.

That's about all the background I have to go on at this point.  I'd appreciate answers that critique my proposed schema in terms of performance (we'll be running a lot of counts against the database from a web gui) and in terms of maintainability (e.g. ease of loading new data & updating existing data). Is my proposed schema how you would approach the problem? Why/Why not? What would your design look like if you would do it differently?

Assume for the moment that we do not need to maintain versioning on these tables (though that may be a future requirement).",sql,sql-server,database-design,,,08/10/2011 12:27:46,not a real question,1,780,6,"Please critique my proposed database design I'm looking to get some feedback on my proposed database schema.  Here's the business scenario.  We need to maintain a list of a few million households identified by some anonymous ID.  We also need to maintain a list of demographics and other attributes that describe those households.  The list of attributes will grow over time by appending new attributes from external data files.  For example, imagine marketing buys a list of dog lovers and asks for it to be loaded as a new attribute called ""Likes Dogs"".

Here's my proposed schema.  I have separate tables for the households and for the related attributes.  In the household table there's an identity column and a hashed identifier that will come from our data suppliers.  The hashed value is there for privacy reasons.  We're not allowed to know who the households are (e.g. we won't have name, address, etc).  There will also be attribute columns for each attribute that indicate in a binary way whether the household has that attribute.  The actual definition of the attributes I've separated out into another table.


    HOUSEHOLD TABLE
    ID | External ID | Attribute 1 | Attribute 2 | Attribute N
    0  | hash val    |      1      |      0      |    0
    1  | hash val    |      1      |      0      |    1
    2  | hash val    |      0      |      0      |    0
    3  | hash val    |      1      |      0      |    0
    4  | hash val    |      0      |      1      |    1 
    5  | hash val    |      1      |      0      |    0
    N  | hash val    |      1      |      0      |    0



    HOUSEHOLD ATTRIBUTE TABLE
    AttributeID  | Attribute Name | Attribute Description
    0            |       Rich     |  Has income over $x
    1            |       SUV      |  Drives SUV
    2            |       XBox     |  Owns an XBox
    N            |       Urban    |  Lives in urban area

When we load new attributes and/or households we're likely receive flat files that indicate the hash val for the household the and the binary values for the attributes.  The name and descriptions for the attributes will, I anticipate, be in a meta data document.

That's about all the background I have to go on at this point.  I'd appreciate answers that critique my proposed schema in terms of performance (we'll be running a lot of counts against the database from a web gui) and in terms of maintainability (e.g. ease of loading new data & updating existing data). Is my proposed schema how you would approach the problem? Why/Why not? What would your design look like if you would do it differently?

Assume for the moment that we do not need to maintain versioning on these tables (though that may be a future requirement).",3
11259660,06/29/2012 09:52:55,1490844,06/29/2012 09:45:41,1,0,I want a Database related project Idea for my final year,"I have some basic knowledge about database management system i have learned about rdbms, sql, transaction management, oop concepts, query optimization etc...
Can some one please advice me a database related project
It should be be some what big enough a I will have 5 months for it.",sql,database,project,,,06/29/2012 10:11:04,not constructive,1,46,11,"I want a Database related project Idea for my final year I have some basic knowledge about database management system i have learned about rdbms, sql, transaction management, oop concepts, query optimization etc...
Can some one please advice me a database related project
It should be be some what big enough a I will have 5 months for it.",3
4967744,02/11/2011 10:06:25,227865,12/09/2009 10:21:52,677,27,Does a SQL UNION with a LIMIT optimize away uneeded queries?,"Say I have a sequence of queries that progressively get more expensive. I can join all these with a union but I'm only interested in the top 10 results so I add a LIMIT. The query looks something like this:

    (SELECT col1, col2 FROM table WHERE colx = 'x')
    UNION
    (SELECT col1, col2 FROM table WHERE colx LIKE '%x%')
    UNION
    (SELECT col1, col2 FROM table WHERE colx LIKE '%x%' AND unindexedcol LIKE '%y%')
    LIMIT 10

I know that this is not guaranteed to be the top 10 from the first query as the MySQL documentation states 

> UNION by default produces an unordered
> set of rows

but in practice it appears that the results are ordered select 1 followed by select 2 etc until the limit is reached.

So does MySQL execute the queries sequentially and stop when it hits the limit? If not then what is a better way to execute this style of query where only a subset of results are needed and prioritisation of less expensive queries is preferred to minimize execution time?",sql,mysql,query-optimization,union,,,open,0,191,11,"Does a SQL UNION with a LIMIT optimize away uneeded queries? Say I have a sequence of queries that progressively get more expensive. I can join all these with a union but I'm only interested in the top 10 results so I add a LIMIT. The query looks something like this:

    (SELECT col1, col2 FROM table WHERE colx = 'x')
    UNION
    (SELECT col1, col2 FROM table WHERE colx LIKE '%x%')
    UNION
    (SELECT col1, col2 FROM table WHERE colx LIKE '%x%' AND unindexedcol LIKE '%y%')
    LIMIT 10

I know that this is not guaranteed to be the top 10 from the first query as the MySQL documentation states 

> UNION by default produces an unordered
> set of rows

but in practice it appears that the results are ordered select 1 followed by select 2 etc until the limit is reached.

So does MySQL execute the queries sequentially and stop when it hits the limit? If not then what is a better way to execute this style of query where only a subset of results are needed and prioritisation of less expensive queries is preferred to minimize execution time?",4
10992637,06/12/2012 08:01:42,1374181,05/04/2012 05:37:00,15,0,CSV data import using sql developer,"I have installed SQL Developer in my system and want to create database of wikpedia-miner CSV's. I am new to this and i want to import datas but the problem is that the number columns are not constant in all the rows hence not able to use import wizard. I tried to use different delimiter but in that case character count goes more than the allowed one, is there a way that columns can be auto-generated so that no data is lost.

Thanks in advance
",sql,sql-developer,plsqldeveloper,oracle-sqldeveloper,,06/27/2012 13:12:06,not a real question,1,84,6,"CSV data import using sql developer I have installed SQL Developer in my system and want to create database of wikpedia-miner CSV's. I am new to this and i want to import datas but the problem is that the number columns are not constant in all the rows hence not able to use import wizard. I tried to use different delimiter but in that case character count goes more than the allowed one, is there a way that columns can be auto-generated so that no data is lost.

Thanks in advance
",4
219716,10/20/2008 20:11:15,27765,10/14/2008 08:22:07,50,6,What are the uses for Cross Join?,"A cross join performs a cartesian product on the tuples of the two sets.

    SELECT *
    FROM Table1 CROSS JOIN Table2

Which circumstances render such an SQL operation particularly useful?",sql,join,,,,07/18/2012 14:12:08,not constructive,1,35,7,"What are the uses for Cross Join? A cross join performs a cartesian product on the tuples of the two sets.

    SELECT *
    FROM Table1 CROSS JOIN Table2

Which circumstances render such an SQL operation particularly useful?",2
9850780,03/24/2012 09:58:15,170931,09/09/2009 15:33:15,1864,14,How to determine the SQL query tuing aim?,"How to determine the SQL query tuning aim? If a query takes 20 minutes before I modify it, now it takes 15 minutes, is it good enough? May be the query can be changed further and will take just 1 minute, but who knows? Anyone can give some ideas? Thanks!",sql,methodology,sql-tuning,,,03/25/2012 05:01:13,not constructive,1,50,8,"How to determine the SQL query tuing aim? How to determine the SQL query tuning aim? If a query takes 20 minutes before I modify it, now it takes 15 minutes, is it good enough? May be the query can be changed further and will take just 1 minute, but who knows? Anyone can give some ideas? Thanks!",3
5038745,02/18/2011 07:36:46,353760,05/29/2010 21:30:18,783,21,Access Query - Compare Multiple User Selections Against Each Other,"I'm running into a conceptual problem that I cannot seem to conquer in my mind.

Let's say I want a user to enter what they're currently wearing into a database via a form.  Throwing 'T-Shirt' and 'Blue' in a new row is incredibly easy.  However, let's say I want to compare one users against others, and rank in order from most similar to least.

This becomes a huge nightmare when you consider the amount of options available.

 - Undershirt
 - Overshirt
 - Jacket
 - Scarf/Necklaces
 - Headwear
 - Pants
 - Underwear
 - Leggings
 - Socks
 - Footwear
 - Accessories

As I see it, I could hard-code in the 11 categories above and let a user make selections from drop-drop boxes tailored to each category. Now, let's use an example of 'Undershirt' and 'Overshirt'.  Depending on the person, a long-sleeved shirt could be used as either; they're still wearing one. If I make users put values in categories, User A might put it in one and User B might but it in another category.  And they wouldn't get compared because of that, separate categories.

Now, instead of hard-coding in categories (and thus making a limit of how much a user can enter), I could put each item into its own row and search by User ID.  But let's say a person enters in shorts one day, and next throws in jeans and a shirt.  How can I make sure that they're compared separately (e.g., dress compared to shorts, dress compared to jeans+shirt) and not (dress compared to shorts+jeans+shirt).

As to actually comparing, each item vs. each other could be performed via a 2d lookup table. (Row Dress vs. Column Jeans would net a zero, Row Dress vs. Column Dress would net a one)",sql,database,query,database-design,access,,open,0,293,10,"Access Query - Compare Multiple User Selections Against Each Other I'm running into a conceptual problem that I cannot seem to conquer in my mind.

Let's say I want a user to enter what they're currently wearing into a database via a form.  Throwing 'T-Shirt' and 'Blue' in a new row is incredibly easy.  However, let's say I want to compare one users against others, and rank in order from most similar to least.

This becomes a huge nightmare when you consider the amount of options available.

 - Undershirt
 - Overshirt
 - Jacket
 - Scarf/Necklaces
 - Headwear
 - Pants
 - Underwear
 - Leggings
 - Socks
 - Footwear
 - Accessories

As I see it, I could hard-code in the 11 categories above and let a user make selections from drop-drop boxes tailored to each category. Now, let's use an example of 'Undershirt' and 'Overshirt'.  Depending on the person, a long-sleeved shirt could be used as either; they're still wearing one. If I make users put values in categories, User A might put it in one and User B might but it in another category.  And they wouldn't get compared because of that, separate categories.

Now, instead of hard-coding in categories (and thus making a limit of how much a user can enter), I could put each item into its own row and search by User ID.  But let's say a person enters in shorts one day, and next throws in jeans and a shirt.  How can I make sure that they're compared separately (e.g., dress compared to shorts, dress compared to jeans+shirt) and not (dress compared to shorts+jeans+shirt).

As to actually comparing, each item vs. each other could be performed via a 2d lookup table. (Row Dress vs. Column Jeans would net a zero, Row Dress vs. Column Dress would net a one)",5
4893907,02/04/2011 02:15:25,558904,12/31/2010 02:51:49,7,1,Problem with count in SQL query,"Hello I want to create a query that show the name of the employee and the sum of all service that arent not closed. The result of the query is not giving me the correct value.

Here is my query:

'SELECT DISTINCT a.AssignedEmp, COUNT( a.TipoStatus ) AS 'Service Request Count'
<p>FROM Service a, employee b  </br>
<p>WHERE b.Classification_ClassificationID =2 </p>
<p>AND a.TipoStatus = 'Open'</br>
<p>OR a.TipoStatus = 'Pending'</br>
<p>OR a.TipoStatus = 'Hold'</br>
<p>OR a.TipoStatus = 'Warranty'</br>
<p>AND a.AssignedEmp = b.UserName</br>
<p>GROUP BY a.AssignedEmp</br>
<p>LIMIT 0 , 30
'

There result that this query gives me is: </p>
dpadil    16</p>
epadil     8

The correct values suppose to be 2 and 1. Please help me!!",sql,,,,,,open,0,105,6,"Problem with count in SQL query Hello I want to create a query that show the name of the employee and the sum of all service that arent not closed. The result of the query is not giving me the correct value.

Here is my query:

'SELECT DISTINCT a.AssignedEmp, COUNT( a.TipoStatus ) AS 'Service Request Count'
<p>FROM Service a, employee b  </br>
<p>WHERE b.Classification_ClassificationID =2 </p>
<p>AND a.TipoStatus = 'Open'</br>
<p>OR a.TipoStatus = 'Pending'</br>
<p>OR a.TipoStatus = 'Hold'</br>
<p>OR a.TipoStatus = 'Warranty'</br>
<p>AND a.AssignedEmp = b.UserName</br>
<p>GROUP BY a.AssignedEmp</br>
<p>LIMIT 0 , 30
'

There result that this query gives me is: </p>
dpadil    16</p>
epadil     8

The correct values suppose to be 2 and 1. Please help me!!",1
7361105,09/09/2011 11:42:59,835292,07/08/2011 11:47:50,117,3,Database Paging by stored procedure,"I want a stored procedure to Take x number of data rows for the y number of page. 
For example

i have 20 datarow
my page size is 2
if i choose page 2
i will get data row 17,18 

I can use top 200 and use order by to select first and the last datarow but how do i get pages in between.


	
    @PageNumber INT
    As
    BEGIN
	SELECT COUNT(rate.RateID)/200 FROM  dbo.Rate where dbo.Rate.Hourly =0 
	
	DECLARE @LastIndex INT
	SET @LastIndex= (SELECT TOP 1 rate.RateID FROM  dbo.Rate where dbo.Rate.Hourly =0  ORDER BY rate.RateID ASC) 
	
	Select TOP 200
		[RateID],
		[PairID],
		[Open],
		[Close],
		[High],
		[Low],
		[Difference],
		[Average],
		[Percentage],
		[InfoDate],
		[Hourly],
		[CaptureDateTime]
	From Rate
	WHERE Hourly =0 AND RateID >=(@LastIndex+(200* @PageNumber))
	ORDER BY [RateID] ASC
	
	
End
this is what i have now but its not working properly",sql,stored-procedures,,,,,open,0,122,5,"Database Paging by stored procedure I want a stored procedure to Take x number of data rows for the y number of page. 
For example

i have 20 datarow
my page size is 2
if i choose page 2
i will get data row 17,18 

I can use top 200 and use order by to select first and the last datarow but how do i get pages in between.


	
    @PageNumber INT
    As
    BEGIN
	SELECT COUNT(rate.RateID)/200 FROM  dbo.Rate where dbo.Rate.Hourly =0 
	
	DECLARE @LastIndex INT
	SET @LastIndex= (SELECT TOP 1 rate.RateID FROM  dbo.Rate where dbo.Rate.Hourly =0  ORDER BY rate.RateID ASC) 
	
	Select TOP 200
		[RateID],
		[PairID],
		[Open],
		[Close],
		[High],
		[Low],
		[Difference],
		[Average],
		[Percentage],
		[InfoDate],
		[Hourly],
		[CaptureDateTime]
	From Rate
	WHERE Hourly =0 AND RateID >=(@LastIndex+(200* @PageNumber))
	ORDER BY [RateID] ASC
	
	
End
this is what i have now but its not working properly",2
8587025,12/21/2011 08:40:49,1085316,12/07/2011 09:38:13,1,0,How to get this answer,"i have a table team<br/>

id    player   event    date
--------------------------------

 - 1     1         a     18/12/2011<br/>
 - 2     2         a     18/12/2011<br/>
 - 3     3         a     18/12/2011<br/>
 - 4     1         b     19/12/2011<br/>
 - 5     3         b     19/12/2011<br/>
 - 6     1         c     20/12/2011<br/>

<br/>
how can i get this result<br/>

id   player     event     date
---------------------

 - 2     2         a     18/12/2011<br/>
 - 5     3         b     19/12/2011<br/>
 - 6     1         c     20/12/2011<br/>

plz any one help me...<br/>

",sql,sql-server,,,,12/21/2011 09:23:17,not a real question,1,227,5,"How to get this answer i have a table team<br/>

id    player   event    date
--------------------------------

 - 1     1         a     18/12/2011<br/>
 - 2     2         a     18/12/2011<br/>
 - 3     3         a     18/12/2011<br/>
 - 4     1         b     19/12/2011<br/>
 - 5     3         b     19/12/2011<br/>
 - 6     1         c     20/12/2011<br/>

<br/>
how can i get this result<br/>

id   player     event     date
---------------------

 - 2     2         a     18/12/2011<br/>
 - 5     3         b     19/12/2011<br/>
 - 6     1         c     20/12/2011<br/>

plz any one help me...<br/>

",2
9154948,02/06/2012 02:18:30,1113921,12/23/2011 19:43:24,300,19,SQL large table VS. muiltiple smaller tables,"I have the option to use a single table that will expand upwards of 1,000,000 records per year.

With that said, I could use a foreign key to break up this table into muitiple smaller tables, which will reduce this expansion to each smaller table of 100,000 records per year.

50% of the time, users will query all of the records where the other 50% of the time users will query the segmented smaller table data set. ( think based on all geographic areas vs. specific geographic areas)

Using a database managed by a shared hosting account ( think site5, godaddy, etc... ), is it faster to use a single larger table or to use several smaller segmented tables given this situation?",sql,,,,,02/06/2012 15:42:00,off topic,1,119,7,"SQL large table VS. muiltiple smaller tables I have the option to use a single table that will expand upwards of 1,000,000 records per year.

With that said, I could use a foreign key to break up this table into muitiple smaller tables, which will reduce this expansion to each smaller table of 100,000 records per year.

50% of the time, users will query all of the records where the other 50% of the time users will query the segmented smaller table data set. ( think based on all geographic areas vs. specific geographic areas)

Using a database managed by a shared hosting account ( think site5, godaddy, etc... ), is it faster to use a single larger table or to use several smaller segmented tables given this situation?",1
8111247,11/13/2011 11:36:42,939583,09/11/2011 21:03:36,1,0,How to move a DB2 sql result table into a physical file?,"OS: IBM i v6.1
Database: DB2

I would like to get a Result Table form a Select statement, and then move it into a physical file.

What I have tried:


----------


I was hoping to use (per http://www.w3schools.com/sql/sql_select_into.asp)

    SELECT column_name(s)
    INTO new_table_name [IN externaldatabase]
    FROM old_tablename 

unfortunately per the IBM Manual: ""DB2 for i SQL reference""

> The SELECT INTO statement produces a result table consisting of at **most one row**,
and assigns the values in that row to variables.


----------


So then I thought maybe I could use:

> The INSERT statement inserts rows into a table or view

>     There are three forms of this statement:  
> 1. The INSERT using *fullselect* form is used to insert one or more rows into the table or view using values from other tables or views.

unfortunately it does not seem to work for me.

    INSERT INTO <tablename> 
    FROM ( Select (*) FROM <querytableA>
           UNION
           Select (*) FROM <querytableB>)


----------
I am able to move a result table into a physical file, but to do this I have to declare a cursor and then with a do while write to the physical file, 1 record at a time.

I consider this **""ugly and unelegant""** and was hoping to be able to use a ""Select into"" or a ""INSERT into"" statment.

Q:
Please help me to ""dump"" the result table into a physical file with 1 elegant statement.

Warm Regards,
Christoff",sql,db2,ibm-midrange,rpgle,,,open,0,261,12,"How to move a DB2 sql result table into a physical file? OS: IBM i v6.1
Database: DB2

I would like to get a Result Table form a Select statement, and then move it into a physical file.

What I have tried:


----------


I was hoping to use (per http://www.w3schools.com/sql/sql_select_into.asp)

    SELECT column_name(s)
    INTO new_table_name [IN externaldatabase]
    FROM old_tablename 

unfortunately per the IBM Manual: ""DB2 for i SQL reference""

> The SELECT INTO statement produces a result table consisting of at **most one row**,
and assigns the values in that row to variables.


----------


So then I thought maybe I could use:

> The INSERT statement inserts rows into a table or view

>     There are three forms of this statement:  
> 1. The INSERT using *fullselect* form is used to insert one or more rows into the table or view using values from other tables or views.

unfortunately it does not seem to work for me.

    INSERT INTO <tablename> 
    FROM ( Select (*) FROM <querytableA>
           UNION
           Select (*) FROM <querytableB>)


----------
I am able to move a result table into a physical file, but to do this I have to declare a cursor and then with a do while write to the physical file, 1 record at a time.

I consider this **""ugly and unelegant""** and was hoping to be able to use a ""Select into"" or a ""INSERT into"" statment.

Q:
Please help me to ""dump"" the result table into a physical file with 1 elegant statement.

Warm Regards,
Christoff",4
9802347,03/21/2012 10:08:07,1283041,03/21/2012 09:56:34,1,0,SELECT Sql Query joins the same table twice,"I have two tables like below
table 1:emp
Emp ID	SupervisorID
001	005
002	001
003	004
004	005

table 2:empdetails
ID	Name
001	John
002	Krish
003	Ramesh
004	Smith
005	Ranga

I need a sql query to display result of two tables
Result:
ID	Name
John	ranga
Krish	John
Ramesh	Smith
Smith	prasad


Thanks in Advance

",sql,oracle,,,,03/21/2012 12:07:34,not a real question,1,21,8,"SELECT Sql Query joins the same table twice I have two tables like below
table 1:emp
Emp ID	SupervisorID
001	005
002	001
003	004
004	005

table 2:empdetails
ID	Name
001	John
002	Krish
003	Ramesh
004	Smith
005	Ranga

I need a sql query to display result of two tables
Result:
ID	Name
John	ranga
Krish	John
Ramesh	Smith
Smith	prasad


Thanks in Advance

",2
6946786,08/04/2011 18:38:48,196066,10/25/2009 03:05:30,36,1,Synchronization of Views to Tables,"I have written the following code to do a comparision of a View and its corresponding production table. I am looking for better ways to write this code for efficiency, any pointers would be greatly appreciated. The code gives me the desired results, Now it's just a point of learning new approaches and concepts to it. 

http://pastebin.com/pSTdCx3L",sql,tsql,sql-server-2008,,,08/04/2011 19:42:03,not a real question,1,57,5,"Synchronization of Views to Tables I have written the following code to do a comparision of a View and its corresponding production table. I am looking for better ways to write this code for efficiency, any pointers would be greatly appreciated. The code gives me the desired results, Now it's just a point of learning new approaches and concepts to it. 

http://pastebin.com/pSTdCx3L",3
10710367,05/22/2012 21:21:43,1089623,12/09/2011 11:29:08,584,2,SQL query for 2 tables,"There are 2 SQL tables:

    Table1
        ID | field1
        1  | a
        2  | b

    Table2
            field1 | field2
            a      | 111
            a      | 222
            b      | 333
            b      | 444
            b      | 555

I need to get the following `Table3`:

    ID | field1 | field2
    1  | a      | 111
    1  | a      | 222
    2  | b      | 333
    2  | b      | 444
    2  | b      | 555

I tired to run such SQL query:

    SELECT t1.ID, t1.field1, t2.field2 FROM table1 t1, table2 t2 WHERE t1.field1=t2.field1;

but as a result I received duplicated entries, sth like this
    ID | field1 | field2
    1  | a      | 111
    1  | a      | 111
    2  | a      | 222
    2  | a      | 222
etc.

Please help.",sql,query,select,,,05/23/2012 11:09:52,not a real question,1,333,5,"SQL query for 2 tables There are 2 SQL tables:

    Table1
        ID | field1
        1  | a
        2  | b

    Table2
            field1 | field2
            a      | 111
            a      | 222
            b      | 333
            b      | 444
            b      | 555

I need to get the following `Table3`:

    ID | field1 | field2
    1  | a      | 111
    1  | a      | 222
    2  | b      | 333
    2  | b      | 444
    2  | b      | 555

I tired to run such SQL query:

    SELECT t1.ID, t1.field1, t2.field2 FROM table1 t1, table2 t2 WHERE t1.field1=t2.field1;

but as a result I received duplicated entries, sth like this
    ID | field1 | field2
    1  | a      | 111
    1  | a      | 111
    2  | a      | 222
    2  | a      | 222
etc.

Please help.",3
5340545,03/17/2011 14:39:03,664541,03/17/2011 14:39:03,1,0,How to split SQL results within groups of ordered letters?,"I was asking myself how to split my SQL records within groups of letters, like this example:

<b>A-----</b><br>
    Andrew<br>
    Arnold<br>
<b>B-----</b><br>
  Bernard<br>
<b>C-----</b><br>
  Carol<br>
  Christine<br>
  Costantine<br>

etc.

With few PHP rows I found a pretty simple solution.<br>-----------------------------------------------------------------<br>

*// keep track of previous letter<br>*
$prevLetter = '';

foreach($yourarray as $row) {

$letter = substr($row, 0,1);<br><br>
if($letter != $prevLetter) {<br>
$prevLetter = $letter;<br>
echo $letter
<br>;}

}


Hope you'll find this helpful in your projects!

Luke :)
",sql,split,groups,records,alphabetical,03/17/2011 14:55:03,not a real question,1,69,10,"How to split SQL results within groups of ordered letters? I was asking myself how to split my SQL records within groups of letters, like this example:

<b>A-----</b><br>
    Andrew<br>
    Arnold<br>
<b>B-----</b><br>
  Bernard<br>
<b>C-----</b><br>
  Carol<br>
  Christine<br>
  Costantine<br>

etc.

With few PHP rows I found a pretty simple solution.<br>-----------------------------------------------------------------<br>

*// keep track of previous letter<br>*
$prevLetter = '';

foreach($yourarray as $row) {

$letter = substr($row, 0,1);<br><br>
if($letter != $prevLetter) {<br>
$prevLetter = $letter;<br>
echo $letter
<br>;}

}


Hope you'll find this helpful in your projects!

Luke :)
",5
7877549,10/24/2011 14:53:05,841246,07/12/2011 17:31:54,3,0,An sql IF statement in VB,"I need to know if this particular block of code will work, and if not, what i need to do to make it work. I'm doing touchy business and i'd prefer to have it right the first time.

>strsql = ""IF COL_LENGTH('orders','nosign') IS NULL"" & _
>		""BEGIN"" & _
>		""ALTER TABLE orders"" >& _
>		""ADD nosign bit;"" & _
>		""END""",sql,database,string,vb,,02/02/2012 04:23:46,not a real question,1,55,6,"An sql IF statement in VB I need to know if this particular block of code will work, and if not, what i need to do to make it work. I'm doing touchy business and i'd prefer to have it right the first time.

>strsql = ""IF COL_LENGTH('orders','nosign') IS NULL"" & _
>		""BEGIN"" & _
>		""ALTER TABLE orders"" >& _
>		""ADD nosign bit;"" & _
>		""END""",4
4174599,11/13/2010 20:42:31,362479,06/09/2010 13:33:56,36,0,sql stored procedure parameter problem,"I have this weird problem with one of my SP's. 
I have a SP and one of the parameters is nvarchar type. 
and I am declaring the parameter, I am including value too, but when I am running there is no data returned. 
short example: 

     @BookName nvarchar = null

Then in the where clause I have:

    AND (o.BookName = @BookName OR @BookName IS NULL)

No data is returned.

But when I am doing:

    AND (o.BookName = 'SQL Book' OR @BookName IS NULL)

I am getting the proper results.
Just to let you know that the field is no FK.

Any ideas what can be the reason?
Thanks
",sql,stored-procedures,,,,,open,0,111,5,"sql stored procedure parameter problem I have this weird problem with one of my SP's. 
I have a SP and one of the parameters is nvarchar type. 
and I am declaring the parameter, I am including value too, but when I am running there is no data returned. 
short example: 

     @BookName nvarchar = null

Then in the where clause I have:

    AND (o.BookName = @BookName OR @BookName IS NULL)

No data is returned.

But when I am doing:

    AND (o.BookName = 'SQL Book' OR @BookName IS NULL)

I am getting the proper results.
Just to let you know that the field is no FK.

Any ideas what can be the reason?
Thanks
",2
7589756,09/28/2011 21:21:16,553482,12/24/2010 18:01:17,3,0,How to find average without using group by statement in sql,"I want to know if its possible to get the functionality of group by with using it.
I need to find average without using group by.
basically i am looking for alternative for the below simple query without using ""Group by"".

select avg(salary), g.emp_id from #emp e,#salary d where e.emp_id=d.emp_id group by e.emp_id
 
Thanks and Regards,
-Tushar",sql,,,,,,open,0,53,11,"How to find average without using group by statement in sql I want to know if its possible to get the functionality of group by with using it.
I need to find average without using group by.
basically i am looking for alternative for the below simple query without using ""Group by"".

select avg(salary), g.emp_id from #emp e,#salary d where e.emp_id=d.emp_id group by e.emp_id
 
Thanks and Regards,
-Tushar",1
6381352,06/17/2011 04:32:41,69224,09/25/2008 13:16:11,2530,171,SQL Server: UPDATE statement where MAX query.,"I'm doing a data migration in SQL Server 2008 R2. I'm a SQL-Server noob, but I know Ingres and MySql pretty well.

I need to set ""default values"" for two new fields to ""the current values"" from another table. Here's my first naive attempt (how I'd do it in Ingres).

	update  rk_risk
	set     n_target_probability_ID = a.n_probability_ID
	      , n_target_consequence_ID = a.n_consequence_ID
	from    rk_assess a
	WHERE   a.n_assess_id = (
	    SELECT  MAX(n_assess_id)
	    FROM    rk_assess a2
	    WHERE   a2.n_risk_id = a.n_risk_id
	);

The above query executes without error in sequel, but it sets **ALL** the n_target_probability_ID's & n_target_consequence_ID's to the **same value**... that of the OUTRIGHT last assessment (as apposed to ""the last assessment OF THIS RISK"").

The `rk_assess` table contains a complete history of assessment records for `rk_risk`s, and my mission is to ""default"" the new target probability & consequence column of the risk table to the values from ""the current"" (i.e. the last) assessment record. The `rk_assess.n_assess_id` column is an auto-incremented identifier (immutable once set), so the max-id should allways be the last-entered record.

I've had a bit of a search, both in google and SO, and tried a few different version of the query, but I'm still stuck. Here's a couple of other epic-fails, with references. 

	update  rk_risk
	set     n_target_probability_ID = (select a.n_probability_ID from rk_assess a where a.n_assess_id = (select max(n_assess_id) from rk_assess a2 where a2.n_risk_id = a.n_risk_id) as ca)
	      , n_target_consequence_ID = (select a.n_consequence_ID from rk_assess a where a.n_assess_id = (select max(n_assess_id) from rk_assess a2 where a2.n_risk_id = a.n_risk_id) as ca)
	;
	
	http://stackoverflow.com/questions/6256844/sql-server-update-from-select
	
	update  r 
	set     r.n_target_probability_ID = ca.n_probability_ID
	      , r.n_target_consequence_ID = ca.n_consequence_ID
	from    rk_risk r
	join    rk_assess a
	on      a.n_risk_id = r.n_risk_id
	
	select  r.n_risk_id
              , r.n_target_probability_ID, r.n_target_consequence_ID
              , ca.n_probability_ID, ca.n_consequence_ID
	from    rk_risk r
	join    rk_assess a
	on      a.n_risk_id = r.n_risk_id
	
	http://stackoverflow.com/questions/4024489/sql-server-max-statement-returns-multiple-results
	
	UPDATE  rk_risk
	SET     n_target_probability_ID = ca.n_probability_ID
	      , n_target_consequence_ID = ca.n_consequence_ID
	FROM    ( rk_assess a
	INNER JOIN (
	       SELECT MAX(a2.n_assess_id)
	       FROM   rk_assess a2
	       WHERE  a2.n_risk_id = a.n_risk_id
	) ca -- current assessment
	
	
	
	
Any pointers would be greatly appreciated. Thank you all in advance, for even reading this far.

Cheers. Keith.",sql,sql-server,update,subquery,max,,open,0,445,7,"SQL Server: UPDATE statement where MAX query. I'm doing a data migration in SQL Server 2008 R2. I'm a SQL-Server noob, but I know Ingres and MySql pretty well.

I need to set ""default values"" for two new fields to ""the current values"" from another table. Here's my first naive attempt (how I'd do it in Ingres).

	update  rk_risk
	set     n_target_probability_ID = a.n_probability_ID
	      , n_target_consequence_ID = a.n_consequence_ID
	from    rk_assess a
	WHERE   a.n_assess_id = (
	    SELECT  MAX(n_assess_id)
	    FROM    rk_assess a2
	    WHERE   a2.n_risk_id = a.n_risk_id
	);

The above query executes without error in sequel, but it sets **ALL** the n_target_probability_ID's & n_target_consequence_ID's to the **same value**... that of the OUTRIGHT last assessment (as apposed to ""the last assessment OF THIS RISK"").

The `rk_assess` table contains a complete history of assessment records for `rk_risk`s, and my mission is to ""default"" the new target probability & consequence column of the risk table to the values from ""the current"" (i.e. the last) assessment record. The `rk_assess.n_assess_id` column is an auto-incremented identifier (immutable once set), so the max-id should allways be the last-entered record.

I've had a bit of a search, both in google and SO, and tried a few different version of the query, but I'm still stuck. Here's a couple of other epic-fails, with references. 

	update  rk_risk
	set     n_target_probability_ID = (select a.n_probability_ID from rk_assess a where a.n_assess_id = (select max(n_assess_id) from rk_assess a2 where a2.n_risk_id = a.n_risk_id) as ca)
	      , n_target_consequence_ID = (select a.n_consequence_ID from rk_assess a where a.n_assess_id = (select max(n_assess_id) from rk_assess a2 where a2.n_risk_id = a.n_risk_id) as ca)
	;
	
	http://stackoverflow.com/questions/6256844/sql-server-update-from-select
	
	update  r 
	set     r.n_target_probability_ID = ca.n_probability_ID
	      , r.n_target_consequence_ID = ca.n_consequence_ID
	from    rk_risk r
	join    rk_assess a
	on      a.n_risk_id = r.n_risk_id
	
	select  r.n_risk_id
              , r.n_target_probability_ID, r.n_target_consequence_ID
              , ca.n_probability_ID, ca.n_consequence_ID
	from    rk_risk r
	join    rk_assess a
	on      a.n_risk_id = r.n_risk_id
	
	http://stackoverflow.com/questions/4024489/sql-server-max-statement-returns-multiple-results
	
	UPDATE  rk_risk
	SET     n_target_probability_ID = ca.n_probability_ID
	      , n_target_consequence_ID = ca.n_consequence_ID
	FROM    ( rk_assess a
	INNER JOIN (
	       SELECT MAX(a2.n_assess_id)
	       FROM   rk_assess a2
	       WHERE  a2.n_risk_id = a.n_risk_id
	) ca -- current assessment
	
	
	
	
Any pointers would be greatly appreciated. Thank you all in advance, for even reading this far.

Cheers. Keith.",5
5853681,05/02/2011 05:19:31,733953,05/02/2011 05:15:06,1,0,SQL SERVER 2008,SQL MANAGEMENT STUDIO IS NOT CONNECTING WITH THE SERVER NAME IN CLIENT MACHINE. BUT ITS WORKING FINE WITH SERVER IP ADDRESS. ,sql,,,,,05/02/2011 12:45:14,off topic,1,22,3,SQL SERVER 2008 SQL MANAGEMENT STUDIO IS NOT CONNECTING WITH THE SERVER NAME IN CLIENT MACHINE. BUT ITS WORKING FINE WITH SERVER IP ADDRESS. ,1
3239532,07/13/2010 17:03:11,117700,06/04/2009 23:04:34,1656,5,SSMS: connecting to a network server database,"i need to connect to a database that is on a different server on the company network

i am using sql server 2005

i went to connect to server --> browse for more --> Network servers

but in the network servers list i am not seeing the server that i need.

how do i find the server that i need and connect to it?",sql,sql-server-2005,,,,,open,0,60,7,"SSMS: connecting to a network server database i need to connect to a database that is on a different server on the company network

i am using sql server 2005

i went to connect to server --> browse for more --> Network servers

but in the network servers list i am not seeing the server that i need.

how do i find the server that i need and connect to it?",2
1358886,08/31/2009 18:57:07,106586,05/13/2009 19:31:57,15,0,Is there a way to return multiple results with a subquery?,"I have need to return multiple results from a subquery and have been unable to figure it out.  The end result will produce the persons name across the vertical axis, various actions based on an action category across the horizontal axis. So the end result looking like:


----------
**NAME            CATEGORY 1             CATEGORY 2**

Smith, John     Action 1, Action 2     Action 1, Action 2, Action 3


----------


Is there a way to do this in a single query?

    select
       name,
       (select action from actionitemtable where actioncategory = category1 and contact = contactid)
    from
       contact c
       inner join actionitemtable a
         on c.contactid = a.contactid


If more than one result is returned in that subquery I would like to be able to display it as a single comma seperated string, or list of actions, etc.

Thank you.

Microsoft Sql Server 2005 is being used.",sql,tsql,,,,,open,0,203,11,"Is there a way to return multiple results with a subquery? I have need to return multiple results from a subquery and have been unable to figure it out.  The end result will produce the persons name across the vertical axis, various actions based on an action category across the horizontal axis. So the end result looking like:


----------
**NAME            CATEGORY 1             CATEGORY 2**

Smith, John     Action 1, Action 2     Action 1, Action 2, Action 3


----------


Is there a way to do this in a single query?

    select
       name,
       (select action from actionitemtable where actioncategory = category1 and contact = contactid)
    from
       contact c
       inner join actionitemtable a
         on c.contactid = a.contactid


If more than one result is returned in that subquery I would like to be able to display it as a single comma seperated string, or list of actions, etc.

Thank you.

Microsoft Sql Server 2005 is being used.",2
5722714,04/19/2011 21:06:25,574409,01/13/2011 15:00:44,8,2,SQL Help Requested: SELECT Table A Joined with Table B (Max or Null),"In table A (alias ai), I have a list of items.  In table B (alias aib), I have the price history for all of the items of table A, but not all items, for those, I need to SELECT NULL.  I need to select the item from table A, it's maximum price from table B or NULL.

Here's what I have, but it's not quite working, I'm getting duplicate records if table B has an extensive price history.

Here's the not exactly working query:

SELECT *

FROM ItemGroup aig 

INNER JOIN Item ai ON ai.groupID = aig.ID 

LEFT JOIN Item_Prices aib ON ai.ID = aib.ItemID 

WHERE aig.ID = @groupID AND 
(aib.max_price = (SELECT MAX(price) AS highprice FROM Item_Prices WHERE ItemID = ai.ID) 
OR aib.price IS NULL) 

ORDER BY end_date

All suggestions are welcome.

Respectfully,

Ray",sql,select,left-join,max,inner-join,,open,0,130,13,"SQL Help Requested: SELECT Table A Joined with Table B (Max or Null) In table A (alias ai), I have a list of items.  In table B (alias aib), I have the price history for all of the items of table A, but not all items, for those, I need to SELECT NULL.  I need to select the item from table A, it's maximum price from table B or NULL.

Here's what I have, but it's not quite working, I'm getting duplicate records if table B has an extensive price history.

Here's the not exactly working query:

SELECT *

FROM ItemGroup aig 

INNER JOIN Item ai ON ai.groupID = aig.ID 

LEFT JOIN Item_Prices aib ON ai.ID = aib.ItemID 

WHERE aig.ID = @groupID AND 
(aib.max_price = (SELECT MAX(price) AS highprice FROM Item_Prices WHERE ItemID = ai.ID) 
OR aib.price IS NULL) 

ORDER BY end_date

All suggestions are welcome.

Respectfully,

Ray",5
4839522,01/29/2011 21:22:50,595291,01/29/2011 21:13:13,1,0,Can't create a sql database in system partition,"I am developing a mini application to manage sql databases, and i have a problem creating the database on my system partition (C:) in any folder, but if i create it in partition D for exeample it works. I am looking for a solution to this, maybe are the permissions. I am using the 'sa' user...",sql,,,,,,open,0,56,8,"Can't create a sql database in system partition I am developing a mini application to manage sql databases, and i have a problem creating the database on my system partition (C:) in any folder, but if i create it in partition D for exeample it works. I am looking for a solution to this, maybe are the permissions. I am using the 'sa' user...",1
11725082,07/30/2012 15:56:54,397940,07/21/2010 12:34:30,57,4,How to run a set of SQL queries and generate a report with each result?,"I am working with a large Oracle 11g database under Oracle SQL Developer (Version 3.1.07). I would need to automatically run a sequence of SQL queries and output each individual result in an external file. I recently came across the SQL Developer reporting features, would that be the best place to start?

Thanks,

I. ",sql,report,,,,07/31/2012 22:22:13,not constructive,1,53,15,"How to run a set of SQL queries and generate a report with each result? I am working with a large Oracle 11g database under Oracle SQL Developer (Version 3.1.07). I would need to automatically run a sequence of SQL queries and output each individual result in an external file. I recently came across the SQL Developer reporting features, would that be the best place to start?

Thanks,

I. ",2
10736261,05/24/2012 11:05:05,1345690,04/20/2012 05:37:09,51,1,"What are candidate key, alternate key, composite key in sql?","  what are **candidate key** , **alternate key** and **composite key**  
 and why we use all of these ",sql,sql-server,database,sql-server-2008,sql-server-2005,05/24/2012 12:46:16,not a real question,1,22,10,"What are candidate key, alternate key, composite key in sql?   what are **candidate key** , **alternate key** and **composite key**  
 and why we use all of these ",5
11509023,07/16/2012 17:00:37,1529472,07/16/2012 16:16:11,1,0,Front-end/Client Side Software,"I have my database created in MS SQL 2012. it's a very simple database. I need a program or some instruction on how to make this database accessible to the end-user. I have heard of using MS Access as a front-end but what are the other methods of software that I can use to do this. Paid or Free it doesn't matter. I'm just looking for a GUI for the end user. 

Thanks.",sql,sql-server,,,,07/19/2012 03:12:07,not a real question,1,73,3,"Front-end/Client Side Software I have my database created in MS SQL 2012. it's a very simple database. I need a program or some instruction on how to make this database accessible to the end-user. I have heard of using MS Access as a front-end but what are the other methods of software that I can use to do this. Paid or Free it doesn't matter. I'm just looking for a GUI for the end user. 

Thanks.",2
7123293,08/19/2011 14:44:53,114386,05/29/2009 16:09:51,340,8,What is causing PGError: ERROR: there is no parameter $1 in my Rails app,"![enter image description here][1]

I started getting this error on edit/show of a Rank object.  I've never seen it before and am not sure how to resolve it.  Any input?

  [1]: http://i.stack.imgur.com/SWaKD.png",sql,ruby-on-rails,ruby-on-rails-3,postgresql,rails-postgresql,,open,0,34,14,"What is causing PGError: ERROR: there is no parameter $1 in my Rails app ![enter image description here][1]

I started getting this error on edit/show of a Rank object.  I've never seen it before and am not sure how to resolve it.  Any input?

  [1]: http://i.stack.imgur.com/SWaKD.png",5
6023657,05/16/2011 21:27:32,263320,02/01/2010 07:45:04,1,0,Database Merge Replication on two static IP servers,"I'm working on two separate servers in two different locations connected together via internet, and both of them have a static IP, and I need to create a merge replication between both of them such one server will act as distributor and publisher and the other server will be the subscriber.

My question is during configuring I have to set the snapshot folder in such a way to be visible for both server, and if I shared a folder on the publisher it will not be accessible to the other server (ex. **\\111.555.3.8\SnapshotFolder**), how can I solve this problem? is there any way to share a folder over the internet like this???",sql,sql-server-2008,snapshot,merge-replication,,05/16/2011 21:53:47,off topic,1,111,8,"Database Merge Replication on two static IP servers I'm working on two separate servers in two different locations connected together via internet, and both of them have a static IP, and I need to create a merge replication between both of them such one server will act as distributor and publisher and the other server will be the subscriber.

My question is during configuring I have to set the snapshot folder in such a way to be visible for both server, and if I shared a folder on the publisher it will not be accessible to the other server (ex. **\\111.555.3.8\SnapshotFolder**), how can I solve this problem? is there any way to share a folder over the internet like this???",4
8066390,11/09/2011 14:22:36,999896,10/17/2011 19:59:05,23,0,SQL Server 2005 Query is very slow when using different ranges in Between clause,"I am using ""Between"" Operator in where cluase with differnt ranges, and my query become very slow. Like if I use this range then

        Where Project_key Between 3 AND 432        --fast:  6   seconds

With this range

	Where Project_key Between 3 AND 16042      --fast: 14   seconds

And with this range its very Slow

	Where Project_key Between 15678 AND 16042  --slow: 5:45 minutes

I am very surprise When I use Between 3 and 16042 then the query is fast but When I give very less range then like "" Between 15678  AND 16042"" then query is very slow.

I have many tables but the project_Key belong to one table and this Project_Key is on Clustered Index",sql,performance,query,between,,11/25/2011 13:54:46,not a real question,1,134,14,"SQL Server 2005 Query is very slow when using different ranges in Between clause I am using ""Between"" Operator in where cluase with differnt ranges, and my query become very slow. Like if I use this range then

        Where Project_key Between 3 AND 432        --fast:  6   seconds

With this range

	Where Project_key Between 3 AND 16042      --fast: 14   seconds

And with this range its very Slow

	Where Project_key Between 15678 AND 16042  --slow: 5:45 minutes

I am very surprise When I use Between 3 and 16042 then the query is fast but When I give very less range then like "" Between 15678  AND 16042"" then query is very slow.

I have many tables but the project_Key belong to one table and this Project_Key is on Clustered Index",4
5080869,02/22/2011 16:25:39,628664,02/22/2011 16:25:39,1,0,How to show information from an access 2007 database in a datagridview?,"What says in the tittle :)
PS: I don't know anything about visual studio 2010, the last language I saw was Visual Basic 6.",sql,visual-studio-2010,ms-access,,,02/23/2011 01:01:16,not a real question,1,23,12,"How to show information from an access 2007 database in a datagridview? What says in the tittle :)
PS: I don't know anything about visual studio 2010, the last language I saw was Visual Basic 6.",3
7190568,08/25/2011 12:44:25,703760,03/31/2011 05:15:52,32,9,Select Dates Between Two Columns,"I jus need a query in sql if i hava two columns STARTDATE and END DATE. I HAVE TO SELECT THE DATAS BETWEEN STARTDATE and END DATE..


> EG: START DATE =1/1/2011 AND END DATE = 2/2/2011.

I have to Select The Datas Between The Given Dates.

Any Ideas??",sql,,,,,08/25/2011 14:10:25,not a real question,1,46,5,"Select Dates Between Two Columns I jus need a query in sql if i hava two columns STARTDATE and END DATE. I HAVE TO SELECT THE DATAS BETWEEN STARTDATE and END DATE..


> EG: START DATE =1/1/2011 AND END DATE = 2/2/2011.

I have to Select The Datas Between The Given Dates.

Any Ideas??",1
4041327,10/28/2010 09:07:09,489872,10/28/2010 09:03:12,1,0,How do I delete multiple rows with different IDs,"I want to do something like this:

... DELETE FROM table WHERE id IN (SELECT ....)


How can I do that?",sql,delete,,,,10/28/2010 09:48:23,not a real question,1,19,9,"How do I delete multiple rows with different IDs I want to do something like this:

... DELETE FROM table WHERE id IN (SELECT ....)


How can I do that?",2
11670234,07/26/2012 13:20:48,1417337,05/25/2012 12:02:05,6,0,SQL Function to replace characters in string,"i am writing a funtion to replace a string's characters with another character. I think the below should work, but it doersnt. It doesnt seem to be updatingt he variable for @input correctly 

Any idea how i can fix this?

     DECLARE @Input AS VarChar(1000)
     DECLARE @i AS TinyInt
     Declare @Substring AS VarChar(1000)
     Declare @Prestring  AS VarChar(1000)
     Declare @Poststring  AS VarChar(1000)
    
     Select @Input='ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789'
    
     SELECT @i = 1
     Select @Substring ='na'
     WHILE @i <= LEN(@Input) BEGIN
    
    Select @Prestring = SUBSTRING(@Input,-1,@i)
    Select @Poststring = SUBSTRING(@Input,@i+1,LEN(@Input))
    
    
    
    
     SELECT @Substring =  replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace
    (replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace
    (SUBSTRING(@Input,@i,1), 'A', 'N'),'B', 'O'), 'C', 'P'), 'D', 'Q'), 'E', 'R'), 'F', 'S'), 'G', 'T'), 'H', 'U'), 'I', 'V'), 'J', 'W'), 'K', 'X'), 'L', 'Y'), 'M', 'Z'), 'N', 'A'), '0', 'B'), 'P', 'C')
    , 'Q', 'D'),'R', 'E'),'S', 'E'),'T', 'E'),'U', 'F'),'V', 'G'),'W', 'H'),'X', 'I'),'Y', 'J'), '1', '9'),'2','8'),'3','7'),'4','6'),'5','5'),'6','4'),'7','3'),'8','2'),'9','1'),' ','')
    
    Select @Input = @Prestring + @Substring + @Poststring
    
     SELECT @i = @i + 1
    
    
     print 'END
     '
    
     END",sql,string,replace,while-loops,,07/28/2012 10:56:19,not a real question,1,276,7,"SQL Function to replace characters in string i am writing a funtion to replace a string's characters with another character. I think the below should work, but it doersnt. It doesnt seem to be updatingt he variable for @input correctly 

Any idea how i can fix this?

     DECLARE @Input AS VarChar(1000)
     DECLARE @i AS TinyInt
     Declare @Substring AS VarChar(1000)
     Declare @Prestring  AS VarChar(1000)
     Declare @Poststring  AS VarChar(1000)
    
     Select @Input='ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789'
    
     SELECT @i = 1
     Select @Substring ='na'
     WHILE @i <= LEN(@Input) BEGIN
    
    Select @Prestring = SUBSTRING(@Input,-1,@i)
    Select @Poststring = SUBSTRING(@Input,@i+1,LEN(@Input))
    
    
    
    
     SELECT @Substring =  replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace
    (replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace
    (SUBSTRING(@Input,@i,1), 'A', 'N'),'B', 'O'), 'C', 'P'), 'D', 'Q'), 'E', 'R'), 'F', 'S'), 'G', 'T'), 'H', 'U'), 'I', 'V'), 'J', 'W'), 'K', 'X'), 'L', 'Y'), 'M', 'Z'), 'N', 'A'), '0', 'B'), 'P', 'C')
    , 'Q', 'D'),'R', 'E'),'S', 'E'),'T', 'E'),'U', 'F'),'V', 'G'),'W', 'H'),'X', 'I'),'Y', 'J'), '1', '9'),'2','8'),'3','7'),'4','6'),'5','5'),'6','4'),'7','3'),'8','2'),'9','1'),' ','')
    
    Select @Input = @Prestring + @Substring + @Poststring
    
     SELECT @i = @i + 1
    
    
     print 'END
     '
    
     END",4
3242070,07/13/2010 22:28:44,76066,03/10/2009 10:06:51,476,41,How do I remove redundant namespace in nested query when using FOR XML PATH,"When using `FOR XML PATH` and `WITH XMLNAMESPACES` to declare a default namespace, I will get the namespace decleration duplicated in any top level nodes for nested queries that use FOR XML, I've stumbled across a few solutions on-line, but I'm not totally convinced... 

What's the best solution?

 ",sql,xml,sql-server-2008,,,,open,0,49,14,"How do I remove redundant namespace in nested query when using FOR XML PATH When using `FOR XML PATH` and `WITH XMLNAMESPACES` to declare a default namespace, I will get the namespace decleration duplicated in any top level nodes for nested queries that use FOR XML, I've stumbled across a few solutions on-line, but I'm not totally convinced... 

What's the best solution?

 ",3
6594125,07/06/2011 09:20:56,635809,02/26/2011 19:06:16,150,2,Swap ID's in Sql Server,"I took a look at the question: http://stackoverflow.com/questions/2810606/sql-swap-primary-key-values

So I got the following script:

    UPDATE t, t as t2
    SET t.id = t2.id, t2.id = t.id
    WHERE t.id = 1 AND t2.id = 2

But i can not translate this to a valid SQL Server syntax.

Please help me :)

Thanks in advance!



",sql,server,foreign-keys,keys,swap,,open,0,58,5,"Swap ID's in Sql Server I took a look at the question: http://stackoverflow.com/questions/2810606/sql-swap-primary-key-values

So I got the following script:

    UPDATE t, t as t2
    SET t.id = t2.id, t2.id = t.id
    WHERE t.id = 1 AND t2.id = 2

But i can not translate this to a valid SQL Server syntax.

Please help me :)

Thanks in advance!



",5
8449712,12/09/2011 17:57:08,1090248,12/09/2011 17:52:08,1,0,"Grouping Data inside the rows having (N1, N2, N3, N4 etc) Data?","I have a table in which there are two Rows, the data in the field ""Numerator"" which is like this N1, N2, N3, N4, N5, After N1, N2, etc each their is space. i am applying group by function.I have also another field ""population"" which contains the data like 1, 2 or 3.
i want to group them and count these values and tell me that population 1,2 or 3 contains how many Numerators?

Please help I need it urgently? ",sql,,,,,12/12/2011 17:52:36,not a real question,1,79,12,"Grouping Data inside the rows having (N1, N2, N3, N4 etc) Data? I have a table in which there are two Rows, the data in the field ""Numerator"" which is like this N1, N2, N3, N4, N5, After N1, N2, etc each their is space. i am applying group by function.I have also another field ""population"" which contains the data like 1, 2 or 3.
i want to group them and count these values and tell me that population 1,2 or 3 contains how many Numerators?

Please help I need it urgently? ",1
10605762,05/15/2012 17:20:46,144419,07/24/2009 10:55:13,1390,68,sql - group by in ranges to include ranges without values,"Suppose a scenario similar to this [question][1]. I want to get the following results:

    score range  | number of occurrences
    -------------------------------------
       0-9       |        11
      10-19      |        14
      20-29      |         3
       ...       |       ...

And I can use the selected answer as a solution:

    select t.range as [score range], count(*) as [number of occurences]
    from (
      select case  
        when score between 0 and 9 then ' 0- 9'
        when score between 10 and 19 then '10-19'
        else '20-99' end as range
      from scores) t
    group by t.range

How can I assure that the score range of 30-39 will be display even when there are no results on that range?

  [1]: http://stackoverflow.com/questions/232387/in-sql-how-can-you-group-by-in-ranges
",sql,postgresql,,,,,open,0,230,11,"sql - group by in ranges to include ranges without values Suppose a scenario similar to this [question][1]. I want to get the following results:

    score range  | number of occurrences
    -------------------------------------
       0-9       |        11
      10-19      |        14
      20-29      |         3
       ...       |       ...

And I can use the selected answer as a solution:

    select t.range as [score range], count(*) as [number of occurences]
    from (
      select case  
        when score between 0 and 9 then ' 0- 9'
        when score between 10 and 19 then '10-19'
        else '20-99' end as range
      from scores) t
    group by t.range

How can I assure that the score range of 30-39 will be display even when there are no results on that range?

  [1]: http://stackoverflow.com/questions/232387/in-sql-how-can-you-group-by-in-ranges
",2
750934,04/15/2009 09:34:03,49971,12/29/2008 21:06:58,75,4,Time Slot SQL Query,"![alt text][1]I trying to write a query to see if an engineer visited his job in a agreed time slot.

This is my query so far:

    SELECT	v.[VISITDATE], 
		CONVERT(VARCHAR, v.[STARTTIME], 105) AS 'Startdate', 
		CONVERT(VARCHAR, v.[STARTTIME], 108) AS 'StartTime', 
		CONVERT(VARCHAR, v.[bookeddate], 105) AS 'BookedDate', 
		CONVERT(VARCHAR, t.[starttime], 108) AS 'TimeSlotStart', 
		CONVERT(VARCHAR, t.[endtime], 108) AS 'TimeSlotEnd',
		v.[Status]
		
FROM [tbl_repair_visit] v INNER JOIN [ltbl_TimeSlots] t ON v.timeslot = t.[Slot]


  [1]: http://img24.imageshack.us/img24/1156/capturebcn.jpg

The 'StartDate' and 'StartTime' is the date and time the engineer went. 'BookedDate' is hedate he should of gone and 'TimeSlotStart' and 'TimeSlotEnd' is the timeslot he shold of gone between. So I need a column that is a Ture/False value to say if he went in the correct time or not.",sql,sql-server-2005,sqlserver,query,,,open,0,118,4,"Time Slot SQL Query ![alt text][1]I trying to write a query to see if an engineer visited his job in a agreed time slot.

This is my query so far:

    SELECT	v.[VISITDATE], 
		CONVERT(VARCHAR, v.[STARTTIME], 105) AS 'Startdate', 
		CONVERT(VARCHAR, v.[STARTTIME], 108) AS 'StartTime', 
		CONVERT(VARCHAR, v.[bookeddate], 105) AS 'BookedDate', 
		CONVERT(VARCHAR, t.[starttime], 108) AS 'TimeSlotStart', 
		CONVERT(VARCHAR, t.[endtime], 108) AS 'TimeSlotEnd',
		v.[Status]
		
FROM [tbl_repair_visit] v INNER JOIN [ltbl_TimeSlots] t ON v.timeslot = t.[Slot]


  [1]: http://img24.imageshack.us/img24/1156/capturebcn.jpg

The 'StartDate' and 'StartTime' is the date and time the engineer went. 'BookedDate' is hedate he should of gone and 'TimeSlotStart' and 'TimeSlotEnd' is the timeslot he shold of gone between. So I need a column that is a Ture/False value to say if he went in the correct time or not.",4
11301243,07/02/2012 21:12:02,484390,10/22/2010 15:45:33,888,0,Modeling Tool for Data Warehouse,What data modelling tool for data warehouse do you recommend me to use?,sql,sql-server,,,,07/03/2012 15:14:45,not constructive,1,13,5,Modeling Tool for Data Warehouse What data modelling tool for data warehouse do you recommend me to use?,2
8860811,01/14/2012 07:26:41,461502,09/29/2010 08:33:00,46,0,Row_Count with date and reset count with name,"I have following data

11/10/2011  john Maths
12/10/2011  Max  Geometry
11/10/2011  John Geometry
12/10/2011  Max  Maths



So I want Following result

1 11/10/2011  john Maths
2 12/10/2011  John Geometry
1 11/10/2011  Max  Geometry
2 12/10/2011  John Geometry
",sql,sql-server,sql-server-2008,sql-server-2005,,,open,0,39,8,"Row_Count with date and reset count with name I have following data

11/10/2011  john Maths
12/10/2011  Max  Geometry
11/10/2011  John Geometry
12/10/2011  Max  Maths



So I want Following result

1 11/10/2011  john Maths
2 12/10/2011  John Geometry
1 11/10/2011  Max  Geometry
2 12/10/2011  John Geometry
",4
5831343,04/29/2011 11:21:40,582729,01/20/2011 09:29:15,39,5,Interview question for Beginners and Exprience holders??,"I am working on question paper for Beginnners and experience guys on Oracle,SQL/PL SQL??
Cen any suggest me some links or give me best ideas to judge a person on specified technology!",sql,oracle10g,,,,04/29/2011 11:29:52,not a real question,1,31,7,"Interview question for Beginners and Exprience holders?? I am working on question paper for Beginnners and experience guys on Oracle,SQL/PL SQL??
Cen any suggest me some links or give me best ideas to judge a person on specified technology!",2
6745608,07/19/2011 10:18:41,680865,03/28/2011 19:39:15,22,0,verifying dates in T-SQL,"My Enddate is 2009-05-31    (using sql server)

@EndDate  datetime
select startdate = dateadd(mm,-12,@EndDate)

If my EndDate = 2009-05-31
with code above will my
StartDate = 31-05-2008    is my code correct?


I want my senddate to be in the month of April so

month(senddate) = month(dateadd(day,-1,dateadd(mm,-1,@EndDate))    

is my code above correct?
",sql,sql-server-2005,tsql,,,07/19/2011 11:58:45,not a real question,1,53,4,"verifying dates in T-SQL My Enddate is 2009-05-31    (using sql server)

@EndDate  datetime
select startdate = dateadd(mm,-12,@EndDate)

If my EndDate = 2009-05-31
with code above will my
StartDate = 31-05-2008    is my code correct?


I want my senddate to be in the month of April so

month(senddate) = month(dateadd(day,-1,dateadd(mm,-1,@EndDate))    

is my code above correct?
",3
11272002,06/30/2012 06:28:23,1429865,06/01/2012 04:28:15,1,0,plz help me get date in sql server,"I used DATEPART(WW,getdate()) but 
I want to calculate first day and last day of a week in a month.For Example,

june 01 2012 - june 02 2011, 1st week
june 03 2012 - june 09 2011, 2rd week
june 10 2012 - june 16 2011,
june 17 2012 - june 23 2011,
june 24 2012 - june 30 2011
",sql,date,,,,06/30/2012 10:53:51,not a real question,1,54,8,"plz help me get date in sql server I used DATEPART(WW,getdate()) but 
I want to calculate first day and last day of a week in a month.For Example,

june 01 2012 - june 02 2011, 1st week
june 03 2012 - june 09 2011, 2rd week
june 10 2012 - june 16 2011,
june 17 2012 - june 23 2011,
june 24 2012 - june 30 2011
",2
4042317,10/28/2010 11:16:02,255562,01/21/2010 07:22:32,1514,103,Sql server 2005 - Cascade delete in all related tables ,"    CREATE Table A
    (
     AId int ,
     AName varchar(100)
    )
    
    CREATE Table B
    (
     BId int,
     AId int,
     CId int,
     BName varchar(100)
    )
    
    CREATE Table C
    (
     CId int,
     CName varchar (100)
    
    )

""A"" has foreign key in ""B"" and ""C"" also has foreign key in B. Both foreign keys have Cascade delete enabled.

-- Sample data

    INSERT INTO A
    VALUES (1, 'Ashish')
    INSERT INTO A
    VALUES (2, 'Sanjay')
    INSERT INTO A
    VALUES (3, 'Vivek')
    
    INSERT INTO B
    VALUES
    (1,1,10,'Ashish1')
    INSERT INTO B
    VALUES
    (2,1,11,'Ashish2')
    INSERT INTO B
    VALUES
    (3,1,12,'Ashish3')
    
    
    INSERT INTO B
    VALUES
    (4,2,13,'Ashish1')
    INSERT INTO B
    VALUES
    (5,2,14,'Sanjay')
    INSERT INTO B
    VALUES
    (6,3,15,'Vivek')
    
    INSERT INTO C
    VALUES
    (10, 'Ashish Data1')
    INSERT INTO C
    VALUES
    (11, 'Ashish Data2')
    
    INSERT INTO C
    VALUES
    (12, 'Ashish Data3')
    
    INSERT INTO C
    VALUES
    (13, 'Ashish Data4')
    
    INSERT INTO C
    VALUES
    (14, 'sanjay Data1')
    
    INSERT INTO C
    VALUES
    (15, 'Vivek Data1')



I thought following would delete all data from all the tables:-

    DELETE a FROM A a
    INNER JOIN B ON A.AId = B.AId
    INNER JOIN C ON B.CId = C.CID

instead I had to write this:-

    DELETE a FROM A a
    INNER JOIN B ON A.AId = B.AId
    
    DELETE b FROM B b
    INNER JOIN C ON B.CId = C.CID


Is there any way to delete all data in s single delete statement?

",sql,server,2005,,,,open,0,470,11,"Sql server 2005 - Cascade delete in all related tables      CREATE Table A
    (
     AId int ,
     AName varchar(100)
    )
    
    CREATE Table B
    (
     BId int,
     AId int,
     CId int,
     BName varchar(100)
    )
    
    CREATE Table C
    (
     CId int,
     CName varchar (100)
    
    )

""A"" has foreign key in ""B"" and ""C"" also has foreign key in B. Both foreign keys have Cascade delete enabled.

-- Sample data

    INSERT INTO A
    VALUES (1, 'Ashish')
    INSERT INTO A
    VALUES (2, 'Sanjay')
    INSERT INTO A
    VALUES (3, 'Vivek')
    
    INSERT INTO B
    VALUES
    (1,1,10,'Ashish1')
    INSERT INTO B
    VALUES
    (2,1,11,'Ashish2')
    INSERT INTO B
    VALUES
    (3,1,12,'Ashish3')
    
    
    INSERT INTO B
    VALUES
    (4,2,13,'Ashish1')
    INSERT INTO B
    VALUES
    (5,2,14,'Sanjay')
    INSERT INTO B
    VALUES
    (6,3,15,'Vivek')
    
    INSERT INTO C
    VALUES
    (10, 'Ashish Data1')
    INSERT INTO C
    VALUES
    (11, 'Ashish Data2')
    
    INSERT INTO C
    VALUES
    (12, 'Ashish Data3')
    
    INSERT INTO C
    VALUES
    (13, 'Ashish Data4')
    
    INSERT INTO C
    VALUES
    (14, 'sanjay Data1')
    
    INSERT INTO C
    VALUES
    (15, 'Vivek Data1')



I thought following would delete all data from all the tables:-

    DELETE a FROM A a
    INNER JOIN B ON A.AId = B.AId
    INNER JOIN C ON B.CId = C.CID

instead I had to write this:-

    DELETE a FROM A a
    INNER JOIN B ON A.AId = B.AId
    
    DELETE b FROM B b
    INNER JOIN C ON B.CId = C.CID


Is there any way to delete all data in s single delete statement?

",3
8598171,12/22/2011 00:42:31,192741,10/19/2009 23:11:14,3633,157,Workaround for DELETE ... LIMIT clause (SQL),"I am working on a database query abstraction layer that supports SQLite.

Unfortunately, SQLite does not support the `LIMIT` clause in DELETE (and UPDATE etc.) queries - except if compiled with a special flag in more recent versions.

So is there any workaround that I could implement so that that query type can still be supported?",sql,sqlite,workaround,,,,open,0,54,7,"Workaround for DELETE ... LIMIT clause (SQL) I am working on a database query abstraction layer that supports SQLite.

Unfortunately, SQLite does not support the `LIMIT` clause in DELETE (and UPDATE etc.) queries - except if compiled with a special flag in more recent versions.

So is there any workaround that I could implement so that that query type can still be supported?",3
2219450,02/08/2010 03:45:38,268399,02/08/2010 03:39:15,1,0,"Newb SQL question: Is there a ""foreign key"" equivalent for referencing columns, or is it logical to store column names as strings in another table?","(Sorry if this was posted twice... I'm not used to the interface of this site yet)

Disclaimer: I'm an SQL newb, just discovering the great possibilities of sqlite embedded in applications.  

I'm designing a small database for an application that primarily handles data storage for plotting.  Say I have several instrument data tables (one for each type of instrument) called <instrument_type>_DATA with a column for each data field, such as pressure, temperature, humidity, etc.  I would like to join these data tables, pull out the column names, and assign a more human-readable column ""description"" made available to the user for selecting the independent/dependent variables for plotting.  Getting the column names in sqlite is easy enough, but I'm not sure if I should store the resulting names (and longer descriptions) as another table in the db or in a list of some sort in the application.  If it were another table in the db, I think I would have to store the column name as a string... unless there is some way to reference a column in SQL?  I'm not sure if there is a foreign key equivalent for columns, or if this is just a sign of bad database design needing restructuring.  

Thanks for any suggestions, stack overflowers.  
",sql,foreign,column,names,,,open,0,216,25,"Newb SQL question: Is there a ""foreign key"" equivalent for referencing columns, or is it logical to store column names as strings in another table? (Sorry if this was posted twice... I'm not used to the interface of this site yet)

Disclaimer: I'm an SQL newb, just discovering the great possibilities of sqlite embedded in applications.  

I'm designing a small database for an application that primarily handles data storage for plotting.  Say I have several instrument data tables (one for each type of instrument) called <instrument_type>_DATA with a column for each data field, such as pressure, temperature, humidity, etc.  I would like to join these data tables, pull out the column names, and assign a more human-readable column ""description"" made available to the user for selecting the independent/dependent variables for plotting.  Getting the column names in sqlite is easy enough, but I'm not sure if I should store the resulting names (and longer descriptions) as another table in the db or in a list of some sort in the application.  If it were another table in the db, I think I would have to store the column name as a string... unless there is some way to reference a column in SQL?  I'm not sure if there is a foreign key equivalent for columns, or if this is just a sign of bad database design needing restructuring.  

Thanks for any suggestions, stack overflowers.  
",4
10441124,05/04/2012 00:21:05,1373852,05/04/2012 00:10:12,1,0,Invalid object name 'ctd_priority_db'?,"I need help with inserting data to a database ? Gives an error Invalid object name 'ctd_priority_db' ?

    
    protected void Button1_Click(object sender, EventArgs e)
    
    { 
    SqlConnection myConn = new SqlConnection(""server =10.12.24.143; uid = xxxxxx ; pwd = xxxxx; database = ctd_priority_db;"");
    myConn.Open();
    string pname = TextTwo.Text;
    string sqlquery = (""INSERT INTO [ctd_priority_db] (Name) VALUES (' "" + TextTwo.Text + ""')"");
    SqlCommand myCom = new SqlCommand(sqlquery, myConn);
    myCom.Parameters.AddWithValue(""Name "", pname);
    myCom.ExecuteNonQuery();

    }


",sql,database,visual-studio,connection,,05/09/2012 11:48:13,too localized,1,110,4,"Invalid object name 'ctd_priority_db'? I need help with inserting data to a database ? Gives an error Invalid object name 'ctd_priority_db' ?

    
    protected void Button1_Click(object sender, EventArgs e)
    
    { 
    SqlConnection myConn = new SqlConnection(""server =10.12.24.143; uid = xxxxxx ; pwd = xxxxx; database = ctd_priority_db;"");
    myConn.Open();
    string pname = TextTwo.Text;
    string sqlquery = (""INSERT INTO [ctd_priority_db] (Name) VALUES (' "" + TextTwo.Text + ""')"");
    SqlCommand myCom = new SqlCommand(sqlquery, myConn);
    myCom.Parameters.AddWithValue(""Name "", pname);
    myCom.ExecuteNonQuery();

    }


",4
10652716,05/18/2012 12:31:41,998696,10/17/2011 07:30:07,762,52,Group days by week in Sql Server,"There is a way to group dates by week of month in sql server ?

For example 

    Week 2: 05/07/2012 - 05/14/2012
    Week 3: 05/14/2012 - 05/21/2012

but with Sql server statement

I tried

    SELECT SOMETHING, 
    	 datediff(wk, convert(varchar(6), getdate(), 112) + '01', getdate()) + 1 AS TIME_
    FROM CP_STATISTICS_
    GROUP BY something, TIME_
    ORDER BY TIME_

but it returns the week number of month. (means 3)

How to get the pair of days for current week ?

For example, now we are in third (3rd) week and I want to show `05/14/2012 - 05/21/2012`

Thanks",sql,sql-server,,,,,open,0,112,7,"Group days by week in Sql Server There is a way to group dates by week of month in sql server ?

For example 

    Week 2: 05/07/2012 - 05/14/2012
    Week 3: 05/14/2012 - 05/21/2012

but with Sql server statement

I tried

    SELECT SOMETHING, 
    	 datediff(wk, convert(varchar(6), getdate(), 112) + '01', getdate()) + 1 AS TIME_
    FROM CP_STATISTICS_
    GROUP BY something, TIME_
    ORDER BY TIME_

but it returns the week number of month. (means 3)

How to get the pair of days for current week ?

For example, now we are in third (3rd) week and I want to show `05/14/2012 - 05/21/2012`

Thanks",2
6598132,07/06/2011 14:33:29,817688,06/27/2011 15:37:26,8,1,Question about UNION two tables with plain SQL in Grails and Pagination.,"I solve my [QUESTION][2] by referencing this [ANSWER][1]. But the way that I implement pagination is too ugly... I would like to know if there is any better/compact/easier way to do the same? Thanks!!

My controller is:

    import groovy.sql.Sql

class T1T2Controller {

    T1 t1
    T2 t2

    def dataSource // the Spring-Bean ""dataSource"" is auto-injected

    def index = {
        redirect(action: ""list"", params: params)
    }

    def list = {
        def db = new Sql(dataSource) // Create a new instance of groovy.sql.Sql with the DB of the Grails app

        def sqlStatement = ""SELECT A1 AS A, B1 AS B, C1 AS C, D1 AS D FROM T1 ""+
                     ""UNION ""+
                     ""SELECT A2 AS A, B2 AS B, C2 AS C, D2 AS D FROM T2 ""+
                     ""ORDER BY D DESC;"";

        def list_rs = db.rows(sqlStatement) // Perform the query    
        def list_rs_offset=[]
        
        params.max = Math.min(params.max ? params.int('max') : 2, 100)
        
        if (params.offset!=null){
            int maxPos=Integer.valueOf(params.offset)+params.max;
            for (int i=Integer.valueOf(params.offset); i<maxPos; i++){
                list_rs_offset.push(list_rs.get(i));
            }
        }else{
            for (int i=0; i<params.max; i++){
                list_rs_offset.push(list_rs.get(i));
            }
        }

        [ t1T2InstanceList: list_rs_offset, t1T2InstanceTotal: list_rs.size()]
    }
}


  [1]: http://stackoverflow.com/questions/425294/sql-database-views-in-grails/
  [2]: http://stackoverflow.com/questions/6549010/in-grails-how-to-union-two-tables-in-a-single-controller",sql,database,grails,controller,,07/07/2011 18:48:08,off topic,1,434,12,"Question about UNION two tables with plain SQL in Grails and Pagination. I solve my [QUESTION][2] by referencing this [ANSWER][1]. But the way that I implement pagination is too ugly... I would like to know if there is any better/compact/easier way to do the same? Thanks!!

My controller is:

    import groovy.sql.Sql

class T1T2Controller {

    T1 t1
    T2 t2

    def dataSource // the Spring-Bean ""dataSource"" is auto-injected

    def index = {
        redirect(action: ""list"", params: params)
    }

    def list = {
        def db = new Sql(dataSource) // Create a new instance of groovy.sql.Sql with the DB of the Grails app

        def sqlStatement = ""SELECT A1 AS A, B1 AS B, C1 AS C, D1 AS D FROM T1 ""+
                     ""UNION ""+
                     ""SELECT A2 AS A, B2 AS B, C2 AS C, D2 AS D FROM T2 ""+
                     ""ORDER BY D DESC;"";

        def list_rs = db.rows(sqlStatement) // Perform the query    
        def list_rs_offset=[]
        
        params.max = Math.min(params.max ? params.int('max') : 2, 100)
        
        if (params.offset!=null){
            int maxPos=Integer.valueOf(params.offset)+params.max;
            for (int i=Integer.valueOf(params.offset); i<maxPos; i++){
                list_rs_offset.push(list_rs.get(i));
            }
        }else{
            for (int i=0; i<params.max; i++){
                list_rs_offset.push(list_rs.get(i));
            }
        }

        [ t1T2InstanceList: list_rs_offset, t1T2InstanceTotal: list_rs.size()]
    }
}


  [1]: http://stackoverflow.com/questions/425294/sql-database-views-in-grails/
  [2]: http://stackoverflow.com/questions/6549010/in-grails-how-to-union-two-tables-in-a-single-controller",4
10660941,05/18/2012 23:25:23,716118,04/19/2011 22:31:55,2436,81,"Check if table exists, before performing operations on it?","In searching for an answer to this question, I found this [popular post on StackOverflow][1]. Unfortunately, it doesn't work completely. The question is this:

Is there a way to check for existence of a table (or another object) _before_ performing modifications (e.g. `INSERT`)? The before mentioned post suggests this:

    IF (EXISTS (SELECT * 
                     FROM INFORMATION_SCHEMA.TABLES 
                     WHERE TABLE_SCHEMA = 'dbo' 
                     AND  TABLE_NAME = 'questionableTable'))
    BEGIN
        INSERT INTO dbo.questionableTable VALUES ('success!');
    END

Error: `Invalid object name 'dbo.questionableTable'.`

The problem with this is that SQL Server fails when it parses the `INSERT` statement, stating that `dbo.questionableTable` doesn't exist. The previous `INFORMATION_SCHEMA` check doesn't seem to affect it.

**Is there a way to write this kind of query?** For SQL Server, in particular. But I would also like to see similar operations for other database systems, if such things exist.

The motivation behind this question is because we have multiple databases which contain subsets of each others' tables. What I would like is to have a single script that can be applied to all databases, and which only modified the tables that exist there (and doesn't error upon execution).

  [1]: http://stackoverflow.com/questions/167576/sql-server-check-if-table-exists",sql,sql-server,tsql,,,05/19/2012 03:07:29,too localized,1,263,9,"Check if table exists, before performing operations on it? In searching for an answer to this question, I found this [popular post on StackOverflow][1]. Unfortunately, it doesn't work completely. The question is this:

Is there a way to check for existence of a table (or another object) _before_ performing modifications (e.g. `INSERT`)? The before mentioned post suggests this:

    IF (EXISTS (SELECT * 
                     FROM INFORMATION_SCHEMA.TABLES 
                     WHERE TABLE_SCHEMA = 'dbo' 
                     AND  TABLE_NAME = 'questionableTable'))
    BEGIN
        INSERT INTO dbo.questionableTable VALUES ('success!');
    END

Error: `Invalid object name 'dbo.questionableTable'.`

The problem with this is that SQL Server fails when it parses the `INSERT` statement, stating that `dbo.questionableTable` doesn't exist. The previous `INFORMATION_SCHEMA` check doesn't seem to affect it.

**Is there a way to write this kind of query?** For SQL Server, in particular. But I would also like to see similar operations for other database systems, if such things exist.

The motivation behind this question is because we have multiple databases which contain subsets of each others' tables. What I would like is to have a single script that can be applied to all databases, and which only modified the tables that exist there (and doesn't error upon execution).

  [1]: http://stackoverflow.com/questions/167576/sql-server-check-if-table-exists",3
8415798,12/07/2011 13:08:29,1083433,12/06/2011 11:53:27,11,0,BUILDING WCF RESTFUL SERVICE WITH SQL SERVER,"HOW CAN A WCF RESTFUL SERVICE BE BUILT TO PUBLISH THE FOLLOWING XML WHILE FETCHING CONTENTS FROM A SQL SERVER DATABASE?

    <nlt:entertainment xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" 
    xmlns:nlt=""http://nokia.com/nlt/entertainment
    xsi:schemaLocation=""http://nokia.com/nlt/entertainment entertainment.xsd"">
    <nlt:jist createdate=""2010-01-02"">
     <nlt:content-group lang=""en"" regions="""">
      <nlt:content id=""1"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
      <nlt:content id=""2"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
     </nlt:content-group>
     <nlt:content-group lang=""en"" regions="""">
      <nlt:content id=""3"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
      <nlt:content id=""4"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
     </nlt:content-group>
    </nlt:jist>
    </nlt:entertainment>

   



        
",sql,wcf,rest,,,12/07/2011 14:51:39,not a real question,1,220,7,"BUILDING WCF RESTFUL SERVICE WITH SQL SERVER HOW CAN A WCF RESTFUL SERVICE BE BUILT TO PUBLISH THE FOLLOWING XML WHILE FETCHING CONTENTS FROM A SQL SERVER DATABASE?

    <nlt:entertainment xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" 
    xmlns:nlt=""http://nokia.com/nlt/entertainment
    xsi:schemaLocation=""http://nokia.com/nlt/entertainment entertainment.xsd"">
    <nlt:jist createdate=""2010-01-02"">
     <nlt:content-group lang=""en"" regions="""">
      <nlt:content id=""1"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
      <nlt:content id=""2"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
     </nlt:content-group>
     <nlt:content-group lang=""en"" regions="""">
      <nlt:content id=""3"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
      <nlt:content id=""4"" sourceId=""bbc"" valid=""2010-06-01"">
        <nlt:title>Sample title</nlt:title>
        <nlt:body>Example gossip contents</nlt:body>
      </nlt:content>
     </nlt:content-group>
    </nlt:jist>
    </nlt:entertainment>

   



        
",3
1312101,08/21/2009 13:56:10,28482,10/16/2008 06:29:36,688,31,"How to find a ""gap"" in running counter with SQL?","I'd like to find first ""gap"" in a counter column in SQL table. For example, if there are values 1,2,4 and 5 I'd like to find out 3.

I can of course get the values in order and go through it manually but I'd like to know if there would be a way to do it in SQL.

In addition, it should be quite standard SQL, working with different DBMSs. 

",sql,,,,,,open,0,69,10,"How to find a ""gap"" in running counter with SQL? I'd like to find first ""gap"" in a counter column in SQL table. For example, if there are values 1,2,4 and 5 I'd like to find out 3.

I can of course get the values in order and go through it manually but I'd like to know if there would be a way to do it in SQL.

In addition, it should be quite standard SQL, working with different DBMSs. 

",1
7523368,09/23/2011 01:36:23,46571,12/16/2008 08:32:48,3047,86,"How to implement a ""conditional foreign key"" restriction?","I have the following table definition:

    CREATE TABLE X (
        A SOMETYPE NOT NULL,
        B SOMETYPE NOT NULL,
        C SOMETYPE NULL,
        PRIMARY KEY (A,B),
        FOREIGN KEY (A) REFERENCES Y (A)
    );

I want to add the following constraint: If `C IS NOT NULL`, then `FOREIGN KEY (A,C) REFERENCES X (A,B)`. How do I do that (without using a trigger, if possible)?

I am using SQL Server 2008 R2, but this should be irrelevant to the question.",sql,,,,,,open,0,115,8,"How to implement a ""conditional foreign key"" restriction? I have the following table definition:

    CREATE TABLE X (
        A SOMETYPE NOT NULL,
        B SOMETYPE NOT NULL,
        C SOMETYPE NULL,
        PRIMARY KEY (A,B),
        FOREIGN KEY (A) REFERENCES Y (A)
    );

I want to add the following constraint: If `C IS NOT NULL`, then `FOREIGN KEY (A,C) REFERENCES X (A,B)`. How do I do that (without using a trigger, if possible)?

I am using SQL Server 2008 R2, but this should be irrelevant to the question.",1
4494361,12/20/2010 21:58:02,549229,12/20/2010 21:58:02,1,0,SQL Native Client 10.0 Login Failed,"I'm setting up a Classic ASP site in IIS 7.5 (Windows Server 2008 R2). I set the site and the application pool to run as a specific domain account. I added the domain account to the SQL Server 2008 instance running on the same server. I'm getting the following error:

<code>
[Microsoft][SQL Server Native Client 10.0][SQL Server]Login failed for user 'DOMAIN\Account'.
</code>

Here is my connection string:

<code>
Driver={SQL Server Native Client 10.0};Server=server;Trusted_Connection=Yes;Database=db
</code>

I have the exact same setup on another site on the same server. The other site works flawlessly. Any thoughts?",sql,sql-server-2008,asp,classic-asp,,02/20/2011 05:01:51,too localized,1,86,6,"SQL Native Client 10.0 Login Failed I'm setting up a Classic ASP site in IIS 7.5 (Windows Server 2008 R2). I set the site and the application pool to run as a specific domain account. I added the domain account to the SQL Server 2008 instance running on the same server. I'm getting the following error:

<code>
[Microsoft][SQL Server Native Client 10.0][SQL Server]Login failed for user 'DOMAIN\Account'.
</code>

Here is my connection string:

<code>
Driver={SQL Server Native Client 10.0};Server=server;Trusted_Connection=Yes;Database=db
</code>

I have the exact same setup on another site on the same server. The other site works flawlessly. Any thoughts?",4
6339153,06/14/2011 04:43:23,548128,12/20/2010 02:12:30,13,0,On Denormalization. How can I make this query shorter or better? (SQL SERVER 2000),"    INSERT INTO
    denormalizedTable
    
    SELECT
    table1.userName,
    MAX(CASE WHEN table2.Type = 1 THEN table2.Question END) AS question_1,
    MAX(CASE WHEN table2.Type = 1 THEN table2.Answer END) AS answer_1,
    MAX(CASE WHEN table2.Type = 2 THEN table2.Question END) AS question_2,
    MAX(CASE WHEN table2.Type = 2 THEN table2.Answer END) AS answer_2,
    MAX(CASE WHEN table2.Type = 3 THEN table2.Question END) AS question_3,
    MAX(CASE WHEN table2.Type = 3 THEN table2.Answer END) AS answer_3,
    MAX(CASE WHEN table2.Type = 4 THEN table2.Question END) AS question_4,
    MAX(CASE WHEN table2.Type = 4 THEN table2.Answer END) AS answer_4,
    MAX(CASE WHEN table2.Type = 5 THEN table2.Question END) AS question_5,
    MAX(CASE WHEN table2.Type = 5 THEN table2.Answer END) AS answer_5,
    MAX(CASE WHEN table2.Type = 6 THEN table2.Question END) AS question_6,
    MAX(CASE WHEN table2.Type = 6 THEN table2.Answer END) AS answer_6,
    MAX(CASE WHEN table2.Type = 7 THEN table2.Question END) AS question_7,
    MAX(CASE WHEN table2.Type = 7 THEN table2.Answer END) AS answer_7,
    MAX(CASE WHEN table2.Type = 8 THEN table2.Question END) AS question_8,
    MAX(CASE WHEN table2.Type = 8 THEN table2.Answer END) AS answer_8
    
    FROM
    table1
    JOIN
    table2
    ON
    table1.userID = table2.userID 
    
    GROUP BY table1.userName",sql,sql-server-2000,normalization,denormalization,,04/20/2012 12:29:54,too localized,1,271,14,"On Denormalization. How can I make this query shorter or better? (SQL SERVER 2000)     INSERT INTO
    denormalizedTable
    
    SELECT
    table1.userName,
    MAX(CASE WHEN table2.Type = 1 THEN table2.Question END) AS question_1,
    MAX(CASE WHEN table2.Type = 1 THEN table2.Answer END) AS answer_1,
    MAX(CASE WHEN table2.Type = 2 THEN table2.Question END) AS question_2,
    MAX(CASE WHEN table2.Type = 2 THEN table2.Answer END) AS answer_2,
    MAX(CASE WHEN table2.Type = 3 THEN table2.Question END) AS question_3,
    MAX(CASE WHEN table2.Type = 3 THEN table2.Answer END) AS answer_3,
    MAX(CASE WHEN table2.Type = 4 THEN table2.Question END) AS question_4,
    MAX(CASE WHEN table2.Type = 4 THEN table2.Answer END) AS answer_4,
    MAX(CASE WHEN table2.Type = 5 THEN table2.Question END) AS question_5,
    MAX(CASE WHEN table2.Type = 5 THEN table2.Answer END) AS answer_5,
    MAX(CASE WHEN table2.Type = 6 THEN table2.Question END) AS question_6,
    MAX(CASE WHEN table2.Type = 6 THEN table2.Answer END) AS answer_6,
    MAX(CASE WHEN table2.Type = 7 THEN table2.Question END) AS question_7,
    MAX(CASE WHEN table2.Type = 7 THEN table2.Answer END) AS answer_7,
    MAX(CASE WHEN table2.Type = 8 THEN table2.Question END) AS question_8,
    MAX(CASE WHEN table2.Type = 8 THEN table2.Answer END) AS answer_8
    
    FROM
    table1
    JOIN
    table2
    ON
    table1.userID = table2.userID 
    
    GROUP BY table1.userName",4
10839856,05/31/2012 19:15:18,1365968,04/30/2012 14:05:46,6,0,Using SQL LOADER in Oracle to import CSV file,"I'm pretty new to databases and programming. Im not very good with the computer lingo so stick with me. I have a csv file that I'm trying to load into my oracle database. It contains account information such as name telephone number service dates ect. I've installed Oracle 11g Release 2. This is what I've done so far step by step..

1) Ran SQL Loader

      I created a new table with the columns that I needed. For example

    create table Billing ( TAP_ID char(10), ACCT_NUM char(10), MR_ID char(10), HOUSE_NUM char(10), STREET char(30), NAME char(50)

2) It prompted me that the Table was created. Next I created a control file for the data in notepad which was located in the same directory as my Billing table and has a .ctl extension. GIS.csv is the file im getting the data from and is also in the same directory and named it Billing.ctl, which looked like so..

load data
infile GIS.csv
into table Billing
fields terminated by ','
(TAP_ID, ACCT_NUM, MR_ID, HOUSE_NUM, STREET, NAME)

3) Run sqlldr from command line to use the control file
     
 sqlldr myusername/mypassword  Billing.ctl

This is where I am stuck. Ive seen video tutorials of exactly what I'm doing but I get this error:

SQL*Loader-522: lfiopn failed for file (Billing.log)

Any ideas on what I could be doing wrong here? ",sql,database-design,oracle11g,database-connection,sql-loader,,open,0,225,9,"Using SQL LOADER in Oracle to import CSV file I'm pretty new to databases and programming. Im not very good with the computer lingo so stick with me. I have a csv file that I'm trying to load into my oracle database. It contains account information such as name telephone number service dates ect. I've installed Oracle 11g Release 2. This is what I've done so far step by step..

1) Ran SQL Loader

      I created a new table with the columns that I needed. For example

    create table Billing ( TAP_ID char(10), ACCT_NUM char(10), MR_ID char(10), HOUSE_NUM char(10), STREET char(30), NAME char(50)

2) It prompted me that the Table was created. Next I created a control file for the data in notepad which was located in the same directory as my Billing table and has a .ctl extension. GIS.csv is the file im getting the data from and is also in the same directory and named it Billing.ctl, which looked like so..

load data
infile GIS.csv
into table Billing
fields terminated by ','
(TAP_ID, ACCT_NUM, MR_ID, HOUSE_NUM, STREET, NAME)

3) Run sqlldr from command line to use the control file
     
 sqlldr myusername/mypassword  Billing.ctl

This is where I am stuck. Ive seen video tutorials of exactly what I'm doing but I get this error:

SQL*Loader-522: lfiopn failed for file (Billing.log)

Any ideas on what I could be doing wrong here? ",5
9216575,02/09/2012 18:27:42,456532,09/23/2010 18:41:39,725,101,What bad can happen when dropping indexes?,"Whats the worst that can happen if I drop existing indexes in SQL Server 2000 (and are the effects similar in 2008 R2?)?  

I understand it may slow down some queries, but is that the worst thing that can happen?

I'm looking at the Index Tuning Wizard and trying to decide if I need to keep all existing indexes or not.",sql,sql-server,database,sql-server-2000,,02/12/2012 07:51:15,off topic,1,61,7,"What bad can happen when dropping indexes? Whats the worst that can happen if I drop existing indexes in SQL Server 2000 (and are the effects similar in 2008 R2?)?  

I understand it may slow down some queries, but is that the worst thing that can happen?

I'm looking at the Index Tuning Wizard and trying to decide if I need to keep all existing indexes or not.",4
10496227,05/08/2012 09:44:52,1381657,05/08/2012 09:19:34,1,1,Updating Client DataSet after Insert/delete querry on same data: connection is busy with other command,"Im writing a simple database editor as my first Delphi program.
I don't have any problems with delphi, only with the connection through the database.


i load the data in the datagrid with a -> sqlConnection -> sqlDataSet -> sqlDataprovider -> Clientdataset -> Datasource

i insert/delete records with a separate connection + SQLquerry for each.
i change the records with DBEdit

The problems occur when after I insert/delete a record, and i make a change to a record, and want to update the changes, i get the following error 
>Connection is busy for results from anther command.

    procedure TDatabaseApp.bNieuwClick(Sender: TObject);

    begin

    //Waardes invullen in de querry statement!

    SQLInsert.ParamByName('naam').asString := txtNaam2.Text;
    SQLInsert.ParamByName('brouwernr').asString := txtBrouwerNR.Text;
    SQLInsert.ParamByName('soortnr').asString := TXTSoortNR.Text;
    SQLInsert.ParamByName('alcohol').asString := TxtAlcohol.Text;
    
    //querry
    SQLInsert.ExecSQL();
    SQLInsert.Close();

    //Reload datagrid after record has been inserted!
    Refresh();

    end;
Refresh code

    procedure   TDatabaseApp.Refresh();
    begin

    //After a insert/delete query i call this statement, and changes made with the DBEdit are cancelled = temp solution.
      ClientDataSet1.CancelUpdates();  

      SQLDataSet1.Open();
      ClientDataSet1.Open();
      SQLDataSet1.Refresh();
      ClientDataSet1.Refresh();



    end;
",sql,query,delphi,dataset,sqlconnection,,open,0,239,15,"Updating Client DataSet after Insert/delete querry on same data: connection is busy with other command Im writing a simple database editor as my first Delphi program.
I don't have any problems with delphi, only with the connection through the database.


i load the data in the datagrid with a -> sqlConnection -> sqlDataSet -> sqlDataprovider -> Clientdataset -> Datasource

i insert/delete records with a separate connection + SQLquerry for each.
i change the records with DBEdit

The problems occur when after I insert/delete a record, and i make a change to a record, and want to update the changes, i get the following error 
>Connection is busy for results from anther command.

    procedure TDatabaseApp.bNieuwClick(Sender: TObject);

    begin

    //Waardes invullen in de querry statement!

    SQLInsert.ParamByName('naam').asString := txtNaam2.Text;
    SQLInsert.ParamByName('brouwernr').asString := txtBrouwerNR.Text;
    SQLInsert.ParamByName('soortnr').asString := TXTSoortNR.Text;
    SQLInsert.ParamByName('alcohol').asString := TxtAlcohol.Text;
    
    //querry
    SQLInsert.ExecSQL();
    SQLInsert.Close();

    //Reload datagrid after record has been inserted!
    Refresh();

    end;
Refresh code

    procedure   TDatabaseApp.Refresh();
    begin

    //After a insert/delete query i call this statement, and changes made with the DBEdit are cancelled = temp solution.
      ClientDataSet1.CancelUpdates();  

      SQLDataSet1.Open();
      ClientDataSet1.Open();
      SQLDataSet1.Refresh();
      ClientDataSet1.Refresh();



    end;
",5
6120819,05/25/2011 07:16:17,662742,03/16/2011 15:10:59,55,0,Sql Server 2005 - Insert if not exists,"There is lots of information in the internet regarding this common ""problem"".

Solutions like: 

    IF NOT EXISTS() BEGIN INSERT INTO (...) END

are not thread-safe in my opinion and you will probably agree.

However could you confirm that putting the exist into the where clause of one single select would solve the problem of the highest concurrency in sql engine?
Is it enough?

    insert into Table (columns)
    select column1, column2, column3
    where not exists (select top 1 1 from Table where something)

Should be there also added some higher transaction level or
can this be executed on a default one: committed?

Would this work under uncommitted level?

Thanks!









",sql,server,transactions,insert,exists,,open,0,113,8,"Sql Server 2005 - Insert if not exists There is lots of information in the internet regarding this common ""problem"".

Solutions like: 

    IF NOT EXISTS() BEGIN INSERT INTO (...) END

are not thread-safe in my opinion and you will probably agree.

However could you confirm that putting the exist into the where clause of one single select would solve the problem of the highest concurrency in sql engine?
Is it enough?

    insert into Table (columns)
    select column1, column2, column3
    where not exists (select top 1 1 from Table where something)

Should be there also added some higher transaction level or
can this be executed on a default one: committed?

Would this work under uncommitted level?

Thanks!









",5
582514,02/24/2009 16:48:44,18309,09/18/2008 22:13:45,419,19,Multiple WHEN inside no-expression CASE in SQL?,"        DECLARE @TestVal int
    SET @TestVal = 5
    
    SELECT
    	CASE
    		WHEN @TestVal <=3 THEN 'Top 3'
    		ELSE 'Other'
    	END

I saw this sample code online but I couldn't find an example where there was no expression and it had more than one WHEN, so I am wondering if this type of thing is OK:

        DECLARE @TestVal int
    SET @TestVal = 5
    
    SELECT
    	CASE
    		WHEN @TestVal <=3 THEN 'Top 3'
                    WHEN (select ...) = 1 THEN 'Other Value'
                    WHEN (select ...) = 2 THEN 'Other Value 2'
    		ELSE 'Other'
    	END

Or do I need to say CASE WHEN for each line?",sql,case,when,,,,open,0,194,7,"Multiple WHEN inside no-expression CASE in SQL?         DECLARE @TestVal int
    SET @TestVal = 5
    
    SELECT
    	CASE
    		WHEN @TestVal <=3 THEN 'Top 3'
    		ELSE 'Other'
    	END

I saw this sample code online but I couldn't find an example where there was no expression and it had more than one WHEN, so I am wondering if this type of thing is OK:

        DECLARE @TestVal int
    SET @TestVal = 5
    
    SELECT
    	CASE
    		WHEN @TestVal <=3 THEN 'Top 3'
                    WHEN (select ...) = 1 THEN 'Other Value'
                    WHEN (select ...) = 2 THEN 'Other Value 2'
    		ELSE 'Other'
    	END

Or do I need to say CASE WHEN for each line?",3
10284164,04/23/2012 16:09:17,970008,09/28/2011 21:39:55,196,10,MS SQL Check if Variable is Null for Where Statement,"When searching for a list of products, the @SearchType is optional. If SearchType is null then it should return all products and not use the Where clause. Otherwise, if it passed ""Equipment"" it would then use that instead.

    ALTER PROCEDURE [dbo].[psProducts] 
    (
    @SearchType varchar(50)
    )
    AS
    BEGIN

	
	SET NOCOUNT ON;

	SELECT 
	
	P.[ProductId]
      ,P.[ProductName]
      ,P.[ProductPrice]
      ,P.[Type]
	  FROM [Product] P
	  
    -- if @Searchtype is not null then use the where clause
    WHERE p.[Type] = @SearchType
    
    END

",sql,if-statement,where-clause,,,,open,0,122,10,"MS SQL Check if Variable is Null for Where Statement When searching for a list of products, the @SearchType is optional. If SearchType is null then it should return all products and not use the Where clause. Otherwise, if it passed ""Equipment"" it would then use that instead.

    ALTER PROCEDURE [dbo].[psProducts] 
    (
    @SearchType varchar(50)
    )
    AS
    BEGIN

	
	SET NOCOUNT ON;

	SELECT 
	
	P.[ProductId]
      ,P.[ProductName]
      ,P.[ProductPrice]
      ,P.[Type]
	  FROM [Product] P
	  
    -- if @Searchtype is not null then use the where clause
    WHERE p.[Type] = @SearchType
    
    END

",3
7472105,09/19/2011 13:57:30,952735,09/19/2011 13:13:57,1,0,Login Error while trying to connect to SQL,"Im trying to Make a SQL Connection for my proj and i get this error : 

Login failed for user ''.",sql,error-message,,,,09/19/2011 15:18:17,not a real question,1,21,8,"Login Error while trying to connect to SQL Im trying to Make a SQL Connection for my proj and i get this error : 

Login failed for user ''.",2
9537080,03/02/2012 16:45:44,1245541,03/02/2012 16:35:52,1,0,TSQL/SQL - Loop,"I am New to TSQL/SQL and i want to learn 'While Loops' in TSQL/SQL. IS there any Good  sites/books which can help improve my knowledge regarding 'Loops'.  Your input is greatly appreciated.

",sql,sql-server,sql-server-2008,sql-server-2005,tsql,03/03/2012 03:39:04,not constructive,1,34,3,"TSQL/SQL - Loop I am New to TSQL/SQL and i want to learn 'While Loops' in TSQL/SQL. IS there any Good  sites/books which can help improve my knowledge regarding 'Loops'.  Your input is greatly appreciated.

",5
3124810,06/26/2010 17:29:45,207399,11/09/2009 23:53:43,65,3,Why compute geodistance with lat/lon instead of caching cartesean points?,"When researching on how to do the classic ""get POI in range"" problem I've found that the most used algorithms are Haversine and if you need real accuracy then Vincenty's formula. I went the first one because high accuracy wasn't an issue. However, it got me thinking on something that hits me as odd, why is that I found no references to caching the Cartesean coordinates on the database instead of using the haversine formula with the lat/lon?

The issue here is, of course, performance. The haversine formula requires a ton of cos/sin function calls, but wouldn't it be simpler to store the projected X, Y and Z of a lat/lon point on the database and apply the dot product directly? That would require a single arccos call unless I'm mistaken.",sql,math,geolocation,query-optimization,gis,,open,0,130,10,"Why compute geodistance with lat/lon instead of caching cartesean points? When researching on how to do the classic ""get POI in range"" problem I've found that the most used algorithms are Haversine and if you need real accuracy then Vincenty's formula. I went the first one because high accuracy wasn't an issue. However, it got me thinking on something that hits me as odd, why is that I found no references to caching the Cartesean coordinates on the database instead of using the haversine formula with the lat/lon?

The issue here is, of course, performance. The haversine formula requires a ton of cos/sin function calls, but wouldn't it be simpler to store the projected X, Y and Z of a lat/lon point on the database and apply the dot product directly? That would require a single arccos call unless I'm mistaken.",5
1920456,12/17/2009 09:25:41,17507,09/18/2008 10:22:55,656,31,Finding any rows where the latest event time is over a specified period,"The relates to OpenNMS where I'm trying to write an automation in SQL. I have a system which sends events to a table every time the backup succeeds. I want to detect if the backup is overdue for any given node. So for example the (simplified) table looks like:

    nodeid, eventid, eventuei, eventtime
      1   ,  1     , backupOk, 09:20 15/12/09
      2   ,  2     , backupOk, 09:25 15/12/09
      3   ,  3     , backupOk, 09:30 15/12/09
      1   ,  4     , backupOk, 09:20 16/12/09
      2   ,  5     , backupOk, 09:25 16/12/09
      2   ,  6     , backupOk, 09:25 17/12/09
      3   ,  7     , backupOk, 09:30 17/12/09

So what I need is a list of nodeid's where the backup is overdue by 24 hours (and I guess where no backup has occurred at all, although there are nodes in this database that don't get backed up (as they are different types of node)).

",sql,postgres,postgresql,opennms,,,open,0,234,13,"Finding any rows where the latest event time is over a specified period The relates to OpenNMS where I'm trying to write an automation in SQL. I have a system which sends events to a table every time the backup succeeds. I want to detect if the backup is overdue for any given node. So for example the (simplified) table looks like:

    nodeid, eventid, eventuei, eventtime
      1   ,  1     , backupOk, 09:20 15/12/09
      2   ,  2     , backupOk, 09:25 15/12/09
      3   ,  3     , backupOk, 09:30 15/12/09
      1   ,  4     , backupOk, 09:20 16/12/09
      2   ,  5     , backupOk, 09:25 16/12/09
      2   ,  6     , backupOk, 09:25 17/12/09
      3   ,  7     , backupOk, 09:30 17/12/09

So what I need is a list of nodeid's where the backup is overdue by 24 hours (and I guess where no backup has occurred at all, although there are nodes in this database that don't get backed up (as they are different types of node)).

",4
5362475,03/19/2011 13:48:41,457148,09/24/2010 10:15:21,406,14,Haversine formula using SQL server to find closest venue - vb.net,"I am grabbing a postcode from a form. I can then convert this postcode to lng,lat coordinates as I have these stored in a table.

`SELECT lng, lat from postcodeLngLat WHERE postcode = 'CV1'`

I have another table which stores the lng,lat of a selection of venues.

`SELECT v.lat, v.lng, v.name, p.lat, p.lng, p.postcode, 'HAVERSINE' AS distance FROM venuepostcodes v, postcodeLngLat p WHERE p.outcode = 'CB6' ORDER BY distance` 

What I am trying to do is create a datagrid which shows the distance of each venue from the postcode (CV1 in this case). I know that the Haversine formula should do what I am trying to achieve but I'm lost as to where I should start incorporating it into my query. I think the formula needs to go where I've put `'HAVERSINE'` in the query above.

Any ideas?",sql,sql-server,haversine,,,,open,0,134,11,"Haversine formula using SQL server to find closest venue - vb.net I am grabbing a postcode from a form. I can then convert this postcode to lng,lat coordinates as I have these stored in a table.

`SELECT lng, lat from postcodeLngLat WHERE postcode = 'CV1'`

I have another table which stores the lng,lat of a selection of venues.

`SELECT v.lat, v.lng, v.name, p.lat, p.lng, p.postcode, 'HAVERSINE' AS distance FROM venuepostcodes v, postcodeLngLat p WHERE p.outcode = 'CB6' ORDER BY distance` 

What I am trying to do is create a datagrid which shows the distance of each venue from the postcode (CV1 in this case). I know that the Haversine formula should do what I am trying to achieve but I'm lost as to where I should start incorporating it into my query. I think the formula needs to go where I've put `'HAVERSINE'` in the query above.

Any ideas?",3
10630733,05/17/2012 06:14:20,901729,08/19/2011 03:39:50,47,7,Is there a cleaner way to implement a Multi-tenant database with the following requirements?,"I have been working with Salesforce.com for several years, and for a mental exercise/challenge I've tried to come up with a similar solution to how they handle their ""database"" (Yes I know they aren't really using tables and view, but Metadata).  This turned out to be much more challenging then first anticipated.

Please keep in mind I am not trying to re-invent SFDC.  I was just trying to explore solutions to multi-tenant implementations.

Requirements

 1. Must be able to handle multiple customers/tenants with out exposing customer specific data to other customers and without using customer specific databases.
 2. All customers must have a standardized access to a set of standard tables (i.e.  Select * from Account returns all the Accounts associated with requesting customer)
 3. All customers must be able to add custom fields to all Standard tables.
 4. All customers must be able to add custom tables.
 5. Any customer's custom fields must only be visible to that customer, even if ""added"" to a standard table.
 6. Any customer's custom table must only be visible to that customer.
 7. Ideally this solution will not be specific to one RDBMS. (Can't rely on PostgreSQL's search_path)

My Solution

1. Create a multi-schema database design, where the standard tables are stored in the ""Primary"" schema (Primary.TrueAccounts).  
2. For each customer create a separate schema with base tables to hold a FK linking them back to the Primary.TrueAccounts (Cust1.AccountCustomFields).  This table is where any Custom Fields will be added.  
3. A customer's custom tables will only be added to their schema.
4. For each Standard table create a view in the customers Schema left joining the Standard columns with that customer's custom columns (CREATE VIEW Cust1.Accounts AS SELECT t1.field1, t1.field2, t2.* FROM Primary.TrueAccounts AS t1 LEFT JOIN Cust1.AccountCustomFields AS t2 ON t1.id = tw.Accountid WHERE t1.CustomerId = 1)

I have mocked this basic solution up in MySQL workbench, so I know it at least is possible as described.

My ultimate question is ""How did I do?"".  Is there a Better/Standard/less ugly/more efficient way of accomplishing the requirements as laid out above?",sql,database-design,multi-tenant,,,06/23/2012 17:14:23,not constructive,1,348,14,"Is there a cleaner way to implement a Multi-tenant database with the following requirements? I have been working with Salesforce.com for several years, and for a mental exercise/challenge I've tried to come up with a similar solution to how they handle their ""database"" (Yes I know they aren't really using tables and view, but Metadata).  This turned out to be much more challenging then first anticipated.

Please keep in mind I am not trying to re-invent SFDC.  I was just trying to explore solutions to multi-tenant implementations.

Requirements

 1. Must be able to handle multiple customers/tenants with out exposing customer specific data to other customers and without using customer specific databases.
 2. All customers must have a standardized access to a set of standard tables (i.e.  Select * from Account returns all the Accounts associated with requesting customer)
 3. All customers must be able to add custom fields to all Standard tables.
 4. All customers must be able to add custom tables.
 5. Any customer's custom fields must only be visible to that customer, even if ""added"" to a standard table.
 6. Any customer's custom table must only be visible to that customer.
 7. Ideally this solution will not be specific to one RDBMS. (Can't rely on PostgreSQL's search_path)

My Solution

1. Create a multi-schema database design, where the standard tables are stored in the ""Primary"" schema (Primary.TrueAccounts).  
2. For each customer create a separate schema with base tables to hold a FK linking them back to the Primary.TrueAccounts (Cust1.AccountCustomFields).  This table is where any Custom Fields will be added.  
3. A customer's custom tables will only be added to their schema.
4. For each Standard table create a view in the customers Schema left joining the Standard columns with that customer's custom columns (CREATE VIEW Cust1.Accounts AS SELECT t1.field1, t1.field2, t2.* FROM Primary.TrueAccounts AS t1 LEFT JOIN Cust1.AccountCustomFields AS t2 ON t1.id = tw.Accountid WHERE t1.CustomerId = 1)

I have mocked this basic solution up in MySQL workbench, so I know it at least is possible as described.

My ultimate question is ""How did I do?"".  Is there a Better/Standard/less ugly/more efficient way of accomplishing the requirements as laid out above?",3
11406221,07/10/2012 03:34:35,797215,06/14/2011 07:48:26,26,1,How to adjust ActiveRecord (or straight SQL) query to include zero count records on a JOIN with a WHERE clause,"I have a question about forming a query in ActiveRecord but also provided the SQL for those that aren’t familiar with ActiveRecord.

I have the following model class:

    class Shoe < ActiveRecord::Base
      has_many :purchases
      
      def self.available_shoes
        #show all shoes that have been purchased less than num_in_stock
        num_in_stock = 3
        Shoe.includes(:purchases)
            .group(""purchases.shoe_id"")
            .having(""COUNT(purchases.shoe_id) < ?"", num_in_stock)
      end
 
      def self.available_shoes_for_user(user)
        #show all available_shoes that a user hasn’t already purchased
        Shoe.available_shoes.where(""purchases.user_id != ?"", user.id)
      end
    end

The method `Shoe.available_shoes` works as expected in that it will return all shoes that have been purchased less times than the amount available in stock (in this case 3) including shoes that have been purchased zero times.

The problem arises when I call `Shoe.available_shoes_for_user(user)`, it will show all shoes that have existing purchases, but it doesn’t show available shoes that have zero purchases.

I have extracted the raw SQL below:

    #Shoe.available_shoes
    SELECT shoes.*, purchases.* FROM shoes LEFT OUTER JOIN purchases ON purchases.shoe_id = shoes.id GROUP BY shoe_id HAVING COUNT(purchases.shoe_id) < 3
    
    #Shoe.available_shoes_for_user(User.find(5))
    SELECT shoes.*, purchases.* FROM shoes LEFT OUTER JOIN purchases ON purchases.shoe_id = shoes.id WHERE (purchases.user_id != 5) GROUP BY shoe_id HAVING COUNT(purchases.shoe_id) < 3


**Question 1:** How can I get `Shoe.available_shoes_for_user(user)` to work as intended (ie, show all shoes purchased less than 3 times (including zero times) that the client hasn’t already purchased?

**Question 2:** In the long run, what would be the optimal solution to this problem when there are hundreds of thousands/millions of shoes?

Thanks in advance!",sql,ruby-on-rails,activerecord,,,,open,0,348,20,"How to adjust ActiveRecord (or straight SQL) query to include zero count records on a JOIN with a WHERE clause I have a question about forming a query in ActiveRecord but also provided the SQL for those that aren’t familiar with ActiveRecord.

I have the following model class:

    class Shoe < ActiveRecord::Base
      has_many :purchases
      
      def self.available_shoes
        #show all shoes that have been purchased less than num_in_stock
        num_in_stock = 3
        Shoe.includes(:purchases)
            .group(""purchases.shoe_id"")
            .having(""COUNT(purchases.shoe_id) < ?"", num_in_stock)
      end
 
      def self.available_shoes_for_user(user)
        #show all available_shoes that a user hasn’t already purchased
        Shoe.available_shoes.where(""purchases.user_id != ?"", user.id)
      end
    end

The method `Shoe.available_shoes` works as expected in that it will return all shoes that have been purchased less times than the amount available in stock (in this case 3) including shoes that have been purchased zero times.

The problem arises when I call `Shoe.available_shoes_for_user(user)`, it will show all shoes that have existing purchases, but it doesn’t show available shoes that have zero purchases.

I have extracted the raw SQL below:

    #Shoe.available_shoes
    SELECT shoes.*, purchases.* FROM shoes LEFT OUTER JOIN purchases ON purchases.shoe_id = shoes.id GROUP BY shoe_id HAVING COUNT(purchases.shoe_id) < 3
    
    #Shoe.available_shoes_for_user(User.find(5))
    SELECT shoes.*, purchases.* FROM shoes LEFT OUTER JOIN purchases ON purchases.shoe_id = shoes.id WHERE (purchases.user_id != 5) GROUP BY shoe_id HAVING COUNT(purchases.shoe_id) < 3


**Question 1:** How can I get `Shoe.available_shoes_for_user(user)` to work as intended (ie, show all shoes purchased less than 3 times (including zero times) that the client hasn’t already purchased?

**Question 2:** In the long run, what would be the optimal solution to this problem when there are hundreds of thousands/millions of shoes?

Thanks in advance!",3
4442910,12/14/2010 18:43:26,297591,03/19/2010 17:38:02,39,0,combine tables related to each other by a linking table and not to worry if the linking table is missing some data,"I have a simple relational database set up similar to the example below

    [Customer] --< [CGLink] >-- [Order]
    
    Person:
    Alias Name(PK)
    A     Bill
    B     Ben
    C     Bob
    D     Jim
    E     John
    
    CGLink:
    ID(PK) Alias Type
    1      A     W
    2      A     X
    3      B     W
    4      B     X
    5      B     Y
    6      B     Z
    7      C     Y
    8      E     Z
    
    Group:
    Type(PK) Group
    W        Double-U
    X        Eks
    Y        Whai
    Z        Zed

And I want to return a set of results like

    Alias   Name   Group
    A       Bill   Double-U
    A       Bill   Eks
    B       Ben    Double-U
    B       Ben    Eks
    B       Ben    Whai
    B       Ben    Zed
    C       Bob    Whai
    D       Jim    
    E       John   Zed

As you can see Jim had no associated data in the linking table and I want to avoid having to place a row of dummy data that I can link all people to who don't have a group in order to let me return this data.

The query I am using is

    SELECT p.Alias, p.Name, g.Group
    FROM Person AS p, Group AS s, CGLink AS l
    WHERE (p.Alias=l.Alias
    AND l.Type=s.Type)
    ORDER BY p.Alias, p.Name;

This returns

    Alias   Name   Group
    A       Bill   Double-U
    A       Bill   Eks
    B       Ben    Double-U
    B       Ben    Eks
    B       Ben    Whai
    B       Ben    Zed
    C       Bob    Whai
    E       John   Zed

Which as you can see, is missing Jim because he had no associated group.
How can I obtain the results I really want?

Cheers",sql,ms-access,join,relational-database,,,open,0,661,22,"combine tables related to each other by a linking table and not to worry if the linking table is missing some data I have a simple relational database set up similar to the example below

    [Customer] --< [CGLink] >-- [Order]
    
    Person:
    Alias Name(PK)
    A     Bill
    B     Ben
    C     Bob
    D     Jim
    E     John
    
    CGLink:
    ID(PK) Alias Type
    1      A     W
    2      A     X
    3      B     W
    4      B     X
    5      B     Y
    6      B     Z
    7      C     Y
    8      E     Z
    
    Group:
    Type(PK) Group
    W        Double-U
    X        Eks
    Y        Whai
    Z        Zed

And I want to return a set of results like

    Alias   Name   Group
    A       Bill   Double-U
    A       Bill   Eks
    B       Ben    Double-U
    B       Ben    Eks
    B       Ben    Whai
    B       Ben    Zed
    C       Bob    Whai
    D       Jim    
    E       John   Zed

As you can see Jim had no associated data in the linking table and I want to avoid having to place a row of dummy data that I can link all people to who don't have a group in order to let me return this data.

The query I am using is

    SELECT p.Alias, p.Name, g.Group
    FROM Person AS p, Group AS s, CGLink AS l
    WHERE (p.Alias=l.Alias
    AND l.Type=s.Type)
    ORDER BY p.Alias, p.Name;

This returns

    Alias   Name   Group
    A       Bill   Double-U
    A       Bill   Eks
    B       Ben    Double-U
    B       Ben    Eks
    B       Ben    Whai
    B       Ben    Zed
    C       Bob    Whai
    E       John   Zed

Which as you can see, is missing Jim because he had no associated group.
How can I obtain the results I really want?

Cheers",4
11732423,07/31/2012 02:49:15,710502,04/15/2011 20:32:50,1742,19,How to evaluate an input in the WHERE clause,"I am getting an input in one of my variables and basically I want to do something like


    SELECT * FROM PEOPLE
    WHERE 
         IF @INPUT = 1
             ITEMID = 16 OR ITEMID = 13
         ELSE IF @INPUT = 2
             ITEMID = 11 OR ITEMID = 14
         ELSE
             ITEMID = 0

Is there a way to do this, please forgive if this is wrong but I wanted to portray my issue as easily understandable as possible. 

I tried with CASE before this like

    WHERE 
        CASE @INPUT
           WHEN 1 THEN ITEMID = 16 OR ITEMID = 13
           WHEN 2 THEN ITEMID = 11 OR ITEMID = 14
           ELSE ITEMID = 0
        END

But all of these approaches throw errors, I would appreciate a good advise, more efficient way to do this if possible.

Thank you for the help.",sql,sql-server-2008,tsql,,,,open,0,248,9,"How to evaluate an input in the WHERE clause I am getting an input in one of my variables and basically I want to do something like


    SELECT * FROM PEOPLE
    WHERE 
         IF @INPUT = 1
             ITEMID = 16 OR ITEMID = 13
         ELSE IF @INPUT = 2
             ITEMID = 11 OR ITEMID = 14
         ELSE
             ITEMID = 0

Is there a way to do this, please forgive if this is wrong but I wanted to portray my issue as easily understandable as possible. 

I tried with CASE before this like

    WHERE 
        CASE @INPUT
           WHEN 1 THEN ITEMID = 16 OR ITEMID = 13
           WHEN 2 THEN ITEMID = 11 OR ITEMID = 14
           ELSE ITEMID = 0
        END

But all of these approaches throw errors, I would appreciate a good advise, more efficient way to do this if possible.

Thank you for the help.",3
551894,02/16/2009 00:13:15,23341,09/29/2008 04:41:59,223,3,"What's the best way to store co-ordinates (longitude/latitude, from Google Maps) in SQL Server?","I'm designing a table in SQL Server 2008 that will store a list of users and a Google Maps co-ordinate (longitude & latitude).

Will I need two fields, or can it be done with 1?

What's the best (or most common) data-type to use for storing this kind of data?",sql,server,2008,longitude,latitude,,open,0,48,14,"What's the best way to store co-ordinates (longitude/latitude, from Google Maps) in SQL Server? I'm designing a table in SQL Server 2008 that will store a list of users and a Google Maps co-ordinate (longitude & latitude).

Will I need two fields, or can it be done with 1?

What's the best (or most common) data-type to use for storing this kind of data?",5
2413471,03/09/2010 23:41:37,117700,06/04/2009 23:04:34,1106,21,where can i find exercises to practice SQL statements?,do you know where i can find some practice SQL problems? where i can write select statements,sql,,,,,12/10/2011 06:10:12,not constructive,1,17,9,where can i find exercises to practice SQL statements? do you know where i can find some practice SQL problems? where i can write select statements,1
5871183,05/03/2011 14:37:20,461834,09/29/2010 14:20:34,219,10,Which implementation of SQL is most standard?,"I was reading up on SQL Server's implementation of MERGE, and it got me thinking, how do different SQL implementations (Oracal, Microsoft, MySql, etc.) compare when it comes to standards-compliance?  Which is most/least standards-compliant?",sql,,,,,05/03/2011 14:45:34,not constructive,1,35,7,"Which implementation of SQL is most standard? I was reading up on SQL Server's implementation of MERGE, and it got me thinking, how do different SQL implementations (Oracal, Microsoft, MySql, etc.) compare when it comes to standards-compliance?  Which is most/least standards-compliant?",1
3140160,06/29/2010 11:24:41,221284,11/30/2009 11:31:19,248,43,MySQL export indices,"I'm sure it must have been asked before, but I can't find it:

I have a CMS that is under constant development. I have built a number of websites using the CMS, so their are a number of databases in existence.

I want to extract the indices from the development db and apply them to the production dbs. Is there an easy way to extract indices as SQL?",sql,mysql,export,index,extract,,open,0,66,3,"MySQL export indices I'm sure it must have been asked before, but I can't find it:

I have a CMS that is under constant development. I have built a number of websites using the CMS, so their are a number of databases in existence.

I want to extract the indices from the development db and apply them to the production dbs. Is there an easy way to extract indices as SQL?",5
8269867,11/25/2011 13:29:30,808148,06/21/2011 09:31:41,73,0,how to generate 4 digit unique alpha random num in sql server,"can any one suggest a logic for to generate 4 digit alpha random number in sql server 2008 

ex:

   **02G4: 4digit unique alphanumeric random no. to be generated** ",sql,,,,,11/26/2011 03:22:11,not a real question,1,31,12,"how to generate 4 digit unique alpha random num in sql server can any one suggest a logic for to generate 4 digit alpha random number in sql server 2008 

ex:

   **02G4: 4digit unique alphanumeric random no. to be generated** ",1
7893235,10/25/2011 17:22:32,1013181,10/25/2011 17:00:15,1,0,how to loop use sql xml variable,"i want to loop all my xml nodes in sql, and add attribute on the nodes


input example:

    <Customer><FirstName>tom</FirstName><LastName>hamel</LastName></Customer>

i want add 'editTime' attribute to the node: FirstName/LastName

expected result:

    <Customer><FirstName editTime='2011-10-25 10:13:13.787'>tom</FirstName><LastName editTime='2011-10-25 10:13:13.787'>hamel</LastName></Customer>

please help me about the code in sql?",sql,xml,,,,10/25/2011 21:09:46,not a real question,1,45,7,"how to loop use sql xml variable i want to loop all my xml nodes in sql, and add attribute on the nodes


input example:

    <Customer><FirstName>tom</FirstName><LastName>hamel</LastName></Customer>

i want add 'editTime' attribute to the node: FirstName/LastName

expected result:

    <Customer><FirstName editTime='2011-10-25 10:13:13.787'>tom</FirstName><LastName editTime='2011-10-25 10:13:13.787'>hamel</LastName></Customer>

please help me about the code in sql?",2
6022329,05/16/2011 19:28:16,675640,03/24/2011 20:20:14,92,0,Where would you look for a Entry-Level SQL Developer position?,"I live in Clarksville, TN and I do not want to move far, however I need a job. I just graduated with a B.S. in CSCI with a concentration in Database Management, and I am ready to find a job, however I do not know where to look. Do most companies post positions online? If so is there a particular Job site that is better then the rest? ",sql,jobs,sql-developer,,,05/16/2011 19:30:58,off topic,1,69,10,"Where would you look for a Entry-Level SQL Developer position? I live in Clarksville, TN and I do not want to move far, however I need a job. I just graduated with a B.S. in CSCI with a concentration in Database Management, and I am ready to find a job, however I do not know where to look. Do most companies post positions online? If so is there a particular Job site that is better then the rest? ",3
1782339,11/23/2009 10:46:15,139357,07/16/2009 10:05:53,177,6,What is the difference between these two queries?,"I am writing my join query by the following way 

  
        UPDATE  UPLOAD_TEMP
        SET     UPLOAD_TEMP.Borr_Add_Req = t2.YesNoResponse,
                
        FROM    UPLOAD_TEMP t1
                INNER JOIN GB_RequiredFields t2 ON t1.State = t2.StateCode
                                                      AND t1.County_Id = t2.CountyId
                                                      AND t1.Group_code = t2.Doc_type_group_code


However it can also be written this way as well

        UPDATE  UPLOAD_TEMP
        SET     UPLOAD_TEMP.Borr_Add_Req = t2.YesNoResponse,
                
        FROM    UPLOAD_TEMP t1
                INNER JOIN GB_RequiredFields t2 ON t1.State = t2.StateCode
                                                      where t1.County_Id = t2.CountyId
                                                      AND t1.Group_code = t2.Doc_type_group_code


IS there any difference between both and which is the preferred way to code.
                                                      ",sql,sql-server,,,,,open,0,471,8,"What is the difference between these two queries? I am writing my join query by the following way 

  
        UPDATE  UPLOAD_TEMP
        SET     UPLOAD_TEMP.Borr_Add_Req = t2.YesNoResponse,
                
        FROM    UPLOAD_TEMP t1
                INNER JOIN GB_RequiredFields t2 ON t1.State = t2.StateCode
                                                      AND t1.County_Id = t2.CountyId
                                                      AND t1.Group_code = t2.Doc_type_group_code


However it can also be written this way as well

        UPDATE  UPLOAD_TEMP
        SET     UPLOAD_TEMP.Borr_Add_Req = t2.YesNoResponse,
                
        FROM    UPLOAD_TEMP t1
                INNER JOIN GB_RequiredFields t2 ON t1.State = t2.StateCode
                                                      where t1.County_Id = t2.CountyId
                                                      AND t1.Group_code = t2.Doc_type_group_code


IS there any difference between both and which is the preferred way to code.
                                                      ",2
1527208,10/06/2009 18:15:43,107166,05/14/2009 15:39:11,302,32,mMS SQL 2008 data types,"What are the different MS SQL 2008 data types?

I am specifically trying to find the equivalent of a long int.",sql,sql-server-2008,database-design,,,,open,0,20,5,"mMS SQL 2008 data types What are the different MS SQL 2008 data types?

I am specifically trying to find the equivalent of a long int.",3
121700,09/23/2008 15:23:30,15766,09/17/2008 12:31:20,8,1,What Exception should be thrown when an ADO.NET query cannot retrieve the requested data?,"In an attempt to add some parameter validation and correct usage semantics to our application, we are trying to add correct exception handling to our .NET applications.

My question is this: When throwing exceptions in ADO.NET if a particular query returns no data or the data could not be found, what type of exception should I use?

Psuedocode:
(read, don't scrutinize the semantics of the code, I know it won't compile)

    public void GetData(int identifier)
    {
        dataAdapter.Command.Text = ""Select * from table1 Where ident = "" + identifier.toString();
        DataSet ds = dataAdapter.Fill(ds);
        if (ds.table1.Rows.Count == 0)
            throw new Exception(""Data not found"");
    }",sql,exception,.net,ado.net,,,open,0,140,14,"What Exception should be thrown when an ADO.NET query cannot retrieve the requested data? In an attempt to add some parameter validation and correct usage semantics to our application, we are trying to add correct exception handling to our .NET applications.

My question is this: When throwing exceptions in ADO.NET if a particular query returns no data or the data could not be found, what type of exception should I use?

Psuedocode:
(read, don't scrutinize the semantics of the code, I know it won't compile)

    public void GetData(int identifier)
    {
        dataAdapter.Command.Text = ""Select * from table1 Where ident = "" + identifier.toString();
        DataSet ds = dataAdapter.Fill(ds);
        if (ds.table1.Rows.Count == 0)
            throw new Exception(""Data not found"");
    }",4
5279984,03/12/2011 00:47:26,82187,03/24/2009 19:10:57,43947,1380,Defining a 1:1 relationship within a relational database,"Based upon discussion in the comments to [this question][1], it's been suggested that it is possible to define a true 1:1 (not 1:0..1) relationship within a relational database.

From my understanding, here are a couple of basic definitions (again, as I understand them), just to make sure everyone is on the same page; perhaps my definitions within the context of relational databases is wrong, and that's where the problem is:

* 1:1 means that for every instance of a row on left, there is a single corresponding row on the right
* 1:0..1 means that for every instance of a row on the left, then there is either no row or a single row on the right

In the aforementioned question, the accepted answer used a simple supertype-subtype relationship as an example of a 1:1 relationship. In other words, something akin to this:

    Parent
    ------------
    ParentKey PK
    
    Child
    ------------
    ChildKey PK FK references Parent (ParentKey)

Simple; every row of `Child` must have a single corresponding row of `Parent`. But this does not seem to fit the other side, as it's obviously possible to have a row of `Parent` that does not have a corresponding row in `Child`.

Of course, my business rules could mandate that every row in `Parent` must have a row in `Child` (and that the ""orphaned"" row in `Parent` would only exist within the confines of a transaction, where I would also add the `Child` row to satisfy the relationship), but there's no actual enforcement of this relationship at the database level.

I'm having a difficult time figuring out how this could be considered 1:1 rather than 1:0..1, but I am anxious to hear an explanation. Is my definition wrong, or am I missing something?

  [1]: http://stackoverflow.com/questions/1722741/defining-a-one-to-one-relationship-in-sql-server/",sql,relational-database,,,,03/28/2011 20:26:35,too localized,1,306,8,"Defining a 1:1 relationship within a relational database Based upon discussion in the comments to [this question][1], it's been suggested that it is possible to define a true 1:1 (not 1:0..1) relationship within a relational database.

From my understanding, here are a couple of basic definitions (again, as I understand them), just to make sure everyone is on the same page; perhaps my definitions within the context of relational databases is wrong, and that's where the problem is:

* 1:1 means that for every instance of a row on left, there is a single corresponding row on the right
* 1:0..1 means that for every instance of a row on the left, then there is either no row or a single row on the right

In the aforementioned question, the accepted answer used a simple supertype-subtype relationship as an example of a 1:1 relationship. In other words, something akin to this:

    Parent
    ------------
    ParentKey PK
    
    Child
    ------------
    ChildKey PK FK references Parent (ParentKey)

Simple; every row of `Child` must have a single corresponding row of `Parent`. But this does not seem to fit the other side, as it's obviously possible to have a row of `Parent` that does not have a corresponding row in `Child`.

Of course, my business rules could mandate that every row in `Parent` must have a row in `Child` (and that the ""orphaned"" row in `Parent` would only exist within the confines of a transaction, where I would also add the `Child` row to satisfy the relationship), but there's no actual enforcement of this relationship at the database level.

I'm having a difficult time figuring out how this could be considered 1:1 rather than 1:0..1, but I am anxious to hear an explanation. Is my definition wrong, or am I missing something?

  [1]: http://stackoverflow.com/questions/1722741/defining-a-one-to-one-relationship-in-sql-server/",2
5814534,04/28/2011 06:29:46,358329,06/04/2010 10:11:41,13,0,SQL query statment,"how can I change from

    SID Name Math English French
    1   Sam  16   17      19
    2   Tom  18   14      12
    3   Al   90   33      2

to:

    SID subject   Mark
    1   Math      16
    1   English   17
    1   French    19
    2   Math      18
    2   English   14
    2   French    12
    3   Math      90
    3   English   33
    3   French    2  


using SQL
thanks :)",sql,,,,,,open,0,182,3,"SQL query statment how can I change from

    SID Name Math English French
    1   Sam  16   17      19
    2   Tom  18   14      12
    3   Al   90   33      2

to:

    SID subject   Mark
    1   Math      16
    1   English   17
    1   French    19
    2   Math      18
    2   English   14
    2   French    12
    3   Math      90
    3   English   33
    3   French    2  


using SQL
thanks :)",1
8712293,01/03/2012 12:27:34,787044,06/07/2011 07:59:34,61,0,selecting as column using join on 3 tables,"warning: very very new to SQL!!!

Hello,

I have three tables as such:

A with fields x and y

B with fields y and z

C with fields z and t

At the moment I preform 3 SQL selects to retrieve the information I need:

Using a specific x value I select as column from table A to retrieve a list of y values.

I then go over each of the y values I got and select as column from table B using it. I generate one long list of the z values retrieved by each of the selects.

I then go over each of the z values and select as column from table C using it. I generate one long list of the t values retrieved by each of the selects.

I was wondering if there is a way to replace all this by one call using JOIN.

I tried writing something like so:

my @final_list_of_t_vals = select_as_column(""select C.t from A join B on (A.y = B.y) join C on (B.z = C.z) where A.x=?"", $my_x_val);

But it fails.

Could you please offer some guidance?

Thanks!!!
",sql,perl,select,join,,01/06/2012 02:41:21,too localized,1,172,8,"selecting as column using join on 3 tables warning: very very new to SQL!!!

Hello,

I have three tables as such:

A with fields x and y

B with fields y and z

C with fields z and t

At the moment I preform 3 SQL selects to retrieve the information I need:

Using a specific x value I select as column from table A to retrieve a list of y values.

I then go over each of the y values I got and select as column from table B using it. I generate one long list of the z values retrieved by each of the selects.

I then go over each of the z values and select as column from table C using it. I generate one long list of the t values retrieved by each of the selects.

I was wondering if there is a way to replace all this by one call using JOIN.

I tried writing something like so:

my @final_list_of_t_vals = select_as_column(""select C.t from A join B on (A.y = B.y) join C on (B.z = C.z) where A.x=?"", $my_x_val);

But it fails.

Could you please offer some guidance?

Thanks!!!
",4
11360311,07/06/2012 10:19:39,324249,12/14/2009 19:03:44,958,16,string SQL compilation,"Could someone give an answer to the following please?

    Statement statement;
    
    string sql;
    
    sql = ""SELECT gender FROM people WHERE gender = 'M' "";
    
    results = statement.executeQuery(sql);
    
    What kind of formatting do I have to do to represent 'M' in my string SQL query?

Many thanks.
",sql,,,,,,open,0,76,3,"string SQL compilation Could someone give an answer to the following please?

    Statement statement;
    
    string sql;
    
    sql = ""SELECT gender FROM people WHERE gender = 'M' "";
    
    results = statement.executeQuery(sql);
    
    What kind of formatting do I have to do to represent 'M' in my string SQL query?

Many thanks.
",1
6250728,06/06/2011 10:30:54,746987,05/10/2011 13:50:56,6,0,Nvarchar perform better than varchar?,"I am really surprise to see that in my MS SQL table, I am defining a field varchar and doing group by with other table's field.

samething I am doing with nvarchar. I just change the datatype. data is same.

but I find out nvarchar is 3 second faster than varchar.
theoretically, varchar will be faster because of 1 byte char.

can anyone explain me why nvarchar is faster?

thanks in advance.
 

",sql,performance,varchar,nvarchar,,,open,0,68,5,"Nvarchar perform better than varchar? I am really surprise to see that in my MS SQL table, I am defining a field varchar and doing group by with other table's field.

samething I am doing with nvarchar. I just change the datatype. data is same.

but I find out nvarchar is 3 second faster than varchar.
theoretically, varchar will be faster because of 1 byte char.

can anyone explain me why nvarchar is faster?

thanks in advance.
 

",4
2001648,01/04/2010 19:36:49,155966,08/13/2009 17:20:21,7,1,Getting row before and after a query,"I currently have this query

    SELECT `short_url,type,file_thumbnail,file_embed,media.id,user,media.file_url,votes,comments,GROUP_CONCAT(info.itemTime) AS time,info.title,media.time AS oldTime,media.title,info.topic,GROUP_CONCAT(votes) AS totalVotes,GROUP_CONCAT(votes) AS listVotes, GROUP_CONCAT(comments) AS listComments, GROUP_CONCAT(url) AS listSites from info JOIN media on info.mid=media.id WHERE media.id='$id' GROUP BY mid ORDER BY media.id DESC LIMIT 0,1`

I'm adding a new feature that lets you easily navigate to the previous or next item. Is there an easy way to modify the above query so that it pulls the prior row, current row and the next row? Or would it be easier to just do another query?",sql,,,,,,open,0,89,7,"Getting row before and after a query I currently have this query

    SELECT `short_url,type,file_thumbnail,file_embed,media.id,user,media.file_url,votes,comments,GROUP_CONCAT(info.itemTime) AS time,info.title,media.time AS oldTime,media.title,info.topic,GROUP_CONCAT(votes) AS totalVotes,GROUP_CONCAT(votes) AS listVotes, GROUP_CONCAT(comments) AS listComments, GROUP_CONCAT(url) AS listSites from info JOIN media on info.mid=media.id WHERE media.id='$id' GROUP BY mid ORDER BY media.id DESC LIMIT 0,1`

I'm adding a new feature that lets you easily navigate to the previous or next item. Is there an easy way to modify the above query so that it pulls the prior row, current row and the next row? Or would it be easier to just do another query?",1
10236836,04/19/2012 21:11:15,201875,11/03/2009 16:44:16,17,0,Not able to install SQL Server,"I am trying to install MS SQL Server 2008 on Windows 7.
But it gives me error ""**Invoke or BeginInvoke cannot be called on a control until the window handle had been created..**""

Please help me in this regards.

Thanks in advance...",sql,windows,,,,04/19/2012 23:13:09,off topic,1,39,6,"Not able to install SQL Server I am trying to install MS SQL Server 2008 on Windows 7.
But it gives me error ""**Invoke or BeginInvoke cannot be called on a control until the window handle had been created..**""

Please help me in this regards.

Thanks in advance...",2
8232940,11/22/2011 19:56:22,704905,04/12/2011 21:20:39,416,15,"Which project is more mature, ScalaQuery or Squeryl?","For me both of them looks quite similar if it's going to features, but it's hard to say without using them (yet). So I have few questions:

1) Are they really feature comparable (more or less)? <br/>
2) Are they any example of enterprise or big open source system using any of them? <br/>
3) I have impression that Squeryl have better documentation, is lack of documentation in case of ScalaQuery real problem? <br/>
4) Which of them is growing faster and/or is faster on fixing the bugs? <br/>
5) Is any of them easier to use / more productive?

",sql,scala,jdbc,scalaquery,squeryl,11/23/2011 07:00:39,not constructive,1,95,8,"Which project is more mature, ScalaQuery or Squeryl? For me both of them looks quite similar if it's going to features, but it's hard to say without using them (yet). So I have few questions:

1) Are they really feature comparable (more or less)? <br/>
2) Are they any example of enterprise or big open source system using any of them? <br/>
3) I have impression that Squeryl have better documentation, is lack of documentation in case of ScalaQuery real problem? <br/>
4) Which of them is growing faster and/or is faster on fixing the bugs? <br/>
5) Is any of them easier to use / more productive?

",5
10831906,05/31/2012 10:34:53,321172,04/20/2010 10:04:19,718,8,Oracle SQL - Sub-queries,"I making a report in EM and I need to figure out somthing here

I have this query that I made:

    SELECT
    *
    FROM
    (
        SELECT DISTINCT
        patch.host as ""PHost"",
        patch.home_location as ""PDirectory"",
        patch.home_name as ""PHome"",
        MAX(patch.INSTALLATION_TIME) as ""Patched (Date)"",
        MAX(patch.PATCH_RELEASE) as ""PVersion"",
        listagg(patch,',') WITHIN GROUP (ORDER BY patch) ""Patches""
        FROM
        mgmt$applied_patches patch
        GROUP BY patch.host, patch.home_location,patch.home_name
        ORDER BY patch.host, patch.home_location
    ) ""PCH"",
    (
        SELECT DISTINCT 
        T1.PROPERTY_VALUE as ""MHost"",
        T2.PROPERTY_VALUE as ""MDirectory"",
        T3.PROPERTY_VALUE as ""MVersion"",
        count(T4.PROPERTY_VALUE) as ""Count of SID"",
        listagg(T4.PROPERTY_VALUE,',') WITHIN GROUP (ORDER BY T4.PROPERTY_VALUE) as ""SID""
        FROM
        MGMT$TARGET_PROPERTIES T1,
        MGMT$TARGET_PROPERTIES T2,
        MGMT$TARGET_PROPERTIES T3,
        MGMT$TARGET_PROPERTIES T4
        WHERE
        T1.TARGET_GUID = T2.TARGET_GUID
        and T1.TARGET_GUID = T3.TARGET_GUID
        and T1.TARGET_GUID = T4.TARGET_GUID
        and T1.PROPERTY_NAME = 'MachineName'
        and T2.PROPERTY_NAME = 'OracleHome'
        and T3.PROPERTY_NAME = 'Version'
        and T4.PROPERTY_NAME = 'SID'
        GROUP BY T1.PROPERTY_VALUE, T2.PROPERTY_VALUE, T3.PROPERTY_VALUE
    ) ""MGM""
    WHERE
    PDirectory = MDirectory

I'm getting error ORA-00904: ""MDIRECTORY"":....

I tried many combinations! (PCH.PDirectory = MGM.MDirectory, ......) nothing works

cheers",sql,oracle,oracle11g,,,,open,0,393,4,"Oracle SQL - Sub-queries I making a report in EM and I need to figure out somthing here

I have this query that I made:

    SELECT
    *
    FROM
    (
        SELECT DISTINCT
        patch.host as ""PHost"",
        patch.home_location as ""PDirectory"",
        patch.home_name as ""PHome"",
        MAX(patch.INSTALLATION_TIME) as ""Patched (Date)"",
        MAX(patch.PATCH_RELEASE) as ""PVersion"",
        listagg(patch,',') WITHIN GROUP (ORDER BY patch) ""Patches""
        FROM
        mgmt$applied_patches patch
        GROUP BY patch.host, patch.home_location,patch.home_name
        ORDER BY patch.host, patch.home_location
    ) ""PCH"",
    (
        SELECT DISTINCT 
        T1.PROPERTY_VALUE as ""MHost"",
        T2.PROPERTY_VALUE as ""MDirectory"",
        T3.PROPERTY_VALUE as ""MVersion"",
        count(T4.PROPERTY_VALUE) as ""Count of SID"",
        listagg(T4.PROPERTY_VALUE,',') WITHIN GROUP (ORDER BY T4.PROPERTY_VALUE) as ""SID""
        FROM
        MGMT$TARGET_PROPERTIES T1,
        MGMT$TARGET_PROPERTIES T2,
        MGMT$TARGET_PROPERTIES T3,
        MGMT$TARGET_PROPERTIES T4
        WHERE
        T1.TARGET_GUID = T2.TARGET_GUID
        and T1.TARGET_GUID = T3.TARGET_GUID
        and T1.TARGET_GUID = T4.TARGET_GUID
        and T1.PROPERTY_NAME = 'MachineName'
        and T2.PROPERTY_NAME = 'OracleHome'
        and T3.PROPERTY_NAME = 'Version'
        and T4.PROPERTY_NAME = 'SID'
        GROUP BY T1.PROPERTY_VALUE, T2.PROPERTY_VALUE, T3.PROPERTY_VALUE
    ) ""MGM""
    WHERE
    PDirectory = MDirectory

I'm getting error ORA-00904: ""MDIRECTORY"":....

I tried many combinations! (PCH.PDirectory = MGM.MDirectory, ......) nothing works

cheers",3
11043802,06/15/2012 02:06:54,1165681,01/23/2012 19:42:04,111,4,Recurring Billing Database Design,"I'm writing an application that will involve recurring billing of a monthly (or weekly) fixed amount, and it can last until subscription is canceled.
The customer can pay several periods in advance.
He can cancel subscription, and then come back after certain unpaid periods.
I need the sistem to let me know when a period is past due.

So I'm burning my brain on how to design the database (maybe is not a database issue but a programming one),

Has any one come to this kind of applications? what approach has been taken?",sql,database-design,atk4,,,06/18/2012 12:16:20,not a real question,1,88,4,"Recurring Billing Database Design I'm writing an application that will involve recurring billing of a monthly (or weekly) fixed amount, and it can last until subscription is canceled.
The customer can pay several periods in advance.
He can cancel subscription, and then come back after certain unpaid periods.
I need the sistem to let me know when a period is past due.

So I'm burning my brain on how to design the database (maybe is not a database issue but a programming one),

Has any one come to this kind of applications? what approach has been taken?",3
2866427,05/19/2010 14:29:17,281572,02/25/2010 20:22:08,27,0,Keeping SQL Server Dev Environment up to date,"I'm trying to figure out the best way to keep my Development servers synced up to the Production servers. Initially, I was just going to restore the backups from the production environment to the dev environment every week or so, however I realized that this would wipe out any actual development work that had taken place during the week. 

I feel like this is a pretty common obstacle, so I'm hoping someone out there can shed some light on how they tackle the issue. I looked online briefly, but didn't really see anything, so any suggestions would be greatly appreciated. 

Thanks!",sql,sql-server-2008,development-environment,database-restore,,,open,0,101,8,"Keeping SQL Server Dev Environment up to date I'm trying to figure out the best way to keep my Development servers synced up to the Production servers. Initially, I was just going to restore the backups from the production environment to the dev environment every week or so, however I realized that this would wipe out any actual development work that had taken place during the week. 

I feel like this is a pretty common obstacle, so I'm hoping someone out there can shed some light on how they tackle the issue. I looked online briefly, but didn't really see anything, so any suggestions would be greatly appreciated. 

Thanks!",4
735589,04/09/2009 19:25:24,23667,09/30/2008 03:58:53,774,70,ADVICE on billing Query in SQL Server 2000,"I need some advice in tackling a query. I can handle this in a front-end application, however, due to design, I have to inplement this in the back-end. I have the following

<pre>
<code>
CREATE TABLE [dbo].[openitems](
	[id] [varchar](8) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[type] [char](5) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[date] [smalldatetime] NULL,
	[amount] [decimal](9, 2) NULL,
	[daysOpen] [smallint] NULL,
	[balance] [decimal](9, 2) NULL
) ON [PRIMARY]




insert into openitems values('A12399','INV','2008-12-05',491.96,123)

insert into openitems values('A12399','INV','2008-12-12',4911.37,116)

insert into openitems values('A12399','INV','2008-12-05',3457.69,109)

</pre>
</code>

The table above have all open invoices for a customer. I need to apply a payment to these invoices starting from the oldest invoice (daysOpen column in the table). So if I have a $550.00 payment, I'll first apply it to the invoice with 123 daysOld, that's $491.96 -$500 (which leaves $8.04 to be applied to the next invoice... and so on), then update that record (balance column in table) to 0.00 and move to the next and apply the remaining. That would be $4911.37 - $8.04, which would leave $4903.33. Since there is no balance left to be applied, the loop exits.

The balance column should now read
<pre>
0
4903.33
3457.69
</pre>

Note: I need to do this for all customers in a table (around 10,000). A customer has an average of about 20 invoices open.

Thanks
",sql,sql-server2000,billing,,,,open,0,193,8,"ADVICE on billing Query in SQL Server 2000 I need some advice in tackling a query. I can handle this in a front-end application, however, due to design, I have to inplement this in the back-end. I have the following

<pre>
<code>
CREATE TABLE [dbo].[openitems](
	[id] [varchar](8) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[type] [char](5) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[date] [smalldatetime] NULL,
	[amount] [decimal](9, 2) NULL,
	[daysOpen] [smallint] NULL,
	[balance] [decimal](9, 2) NULL
) ON [PRIMARY]




insert into openitems values('A12399','INV','2008-12-05',491.96,123)

insert into openitems values('A12399','INV','2008-12-12',4911.37,116)

insert into openitems values('A12399','INV','2008-12-05',3457.69,109)

</pre>
</code>

The table above have all open invoices for a customer. I need to apply a payment to these invoices starting from the oldest invoice (daysOpen column in the table). So if I have a $550.00 payment, I'll first apply it to the invoice with 123 daysOld, that's $491.96 -$500 (which leaves $8.04 to be applied to the next invoice... and so on), then update that record (balance column in table) to 0.00 and move to the next and apply the remaining. That would be $4911.37 - $8.04, which would leave $4903.33. Since there is no balance left to be applied, the loop exits.

The balance column should now read
<pre>
0
4903.33
3457.69
</pre>

Note: I need to do this for all customers in a table (around 10,000). A customer has an average of about 20 invoices open.

Thanks
",3
9486496,02/28/2012 17:11:56,470183,10/08/2010 11:28:09,83,7,Group By Having and Count as LINQ query with multiply nested tables,"I have the following SQL query to return all Customers who have no OrderLines with no Parts assigned - i.e. I only want the customers within which **every** order line of every order has no parts assigned - (in the actual problem I am dealing with a different domain but have translated to customers/orders to illustrate the problem)

    SELECT c.Customer_PK
    FROM Customers c
      INNER JOIN Orders o
      ON c.Customer_PK = o.Customer_FK
      LEFT OUTER JOIN OrderLines l
      ON o.Order_PK = l.Order_FK
      LEFT OUTER JOIN Parts p
      ON l.OrderLine_PK = p.OrderLine_FK
    GROUP BY c.Customer_PK
    HAVING COUNT(p.Part_PK) = 0

The best I have come up with in LINQ is as follows:

    Dim qry =     
    (From c In context.Customers
     Select New With { c.Customer_PK,
                      .CountParts = 
                          (From o In c.Orders
			   From l In o.OrderLines
                           Select l.Parts.Count).DefaultIfEmpty.Sum})

    qry = (From grp In qry
           Where grp.CountParts  = 0
           Select grp.Customer_PK)

This works but generates less than optimal SQL - it is doing a subquery for Count on each row of the customers query rather than using Group By and Having. I tried making the LINQ Group By syntax work but it kept putting the filter as a WHERE not a HAVING clause.

Any ideas?",sql,vb.net,linq,linq-to-entities,entity-framework-4.1,,open,0,351,12,"Group By Having and Count as LINQ query with multiply nested tables I have the following SQL query to return all Customers who have no OrderLines with no Parts assigned - i.e. I only want the customers within which **every** order line of every order has no parts assigned - (in the actual problem I am dealing with a different domain but have translated to customers/orders to illustrate the problem)

    SELECT c.Customer_PK
    FROM Customers c
      INNER JOIN Orders o
      ON c.Customer_PK = o.Customer_FK
      LEFT OUTER JOIN OrderLines l
      ON o.Order_PK = l.Order_FK
      LEFT OUTER JOIN Parts p
      ON l.OrderLine_PK = p.OrderLine_FK
    GROUP BY c.Customer_PK
    HAVING COUNT(p.Part_PK) = 0

The best I have come up with in LINQ is as follows:

    Dim qry =     
    (From c In context.Customers
     Select New With { c.Customer_PK,
                      .CountParts = 
                          (From o In c.Orders
			   From l In o.OrderLines
                           Select l.Parts.Count).DefaultIfEmpty.Sum})

    qry = (From grp In qry
           Where grp.CountParts  = 0
           Select grp.Customer_PK)

This works but generates less than optimal SQL - it is doing a subquery for Count on each row of the customers query rather than using Group By and Having. I tried making the LINQ Group By syntax work but it kept putting the filter as a WHERE not a HAVING clause.

Any ideas?",5
1635328,10/28/2009 05:21:56,157705,08/17/2009 11:31:04,133,1,Does this SQL statement needs to be refactored?,"    SELECT DISTINCT group_id, supplier_id, supplier_name, site_division_id, site_division_name FROM view_supplier_site 
    WHERE supplier_id IN (SELECT DISTINCT supplier_id FROM view_supplier WHERE YEAR IN (2008, 2009) AND received_quantity > 0 AND COE_SUPPLIER NOT IN ('X - LG', 'Y - LG', 'Z - LG') ) 

",sql,oracle9i,oracle,,,,open,0,49,8,"Does this SQL statement needs to be refactored?     SELECT DISTINCT group_id, supplier_id, supplier_name, site_division_id, site_division_name FROM view_supplier_site 
    WHERE supplier_id IN (SELECT DISTINCT supplier_id FROM view_supplier WHERE YEAR IN (2008, 2009) AND received_quantity > 0 AND COE_SUPPLIER NOT IN ('X - LG', 'Y - LG', 'Z - LG') ) 

",3
1336449,08/26/2009 17:52:33,123108,06/15/2009 13:09:07,457,22,EAV over MS SQL,I'm interested in playing around with the EAV model over an MS SQL Database.  Is anybody able to point me to an article or framework for an existing model/schema (I'm not intrested in Saas for this)?  ,sql,entity-attribute-value,,,,,open,0,39,4,EAV over MS SQL I'm interested in playing around with the EAV model over an MS SQL Database.  Is anybody able to point me to an article or framework for an existing model/schema (I'm not intrested in Saas for this)?  ,2
10027468,04/05/2012 11:10:45,338972,05/12/2010 05:20:20,97,5,How can i update table by using select statement in sqllite,"I want to update one table with the help of the foreign key of others table.
i am try to do like 

  
UPDATE tbl_1 SET field1 = 6,  field12= NULL WHERE field3  = (SELECT tbl_2.item1 FROM tbl_1, tbl_2 WHERE tbl_1.field3   = tbl_2.item1  AND tbl_2.item2 = 135)

OR

UPDATE tbl_1 SET field1 = 6,  field12= NULL WHERE field3  = (SELECT item1 FROM tbl_2 WHERE item2 = 135)
",sql,sqlite,,,,,open,0,72,11,"How can i update table by using select statement in sqllite I want to update one table with the help of the foreign key of others table.
i am try to do like 

  
UPDATE tbl_1 SET field1 = 6,  field12= NULL WHERE field3  = (SELECT tbl_2.item1 FROM tbl_1, tbl_2 WHERE tbl_1.field3   = tbl_2.item1  AND tbl_2.item2 = 135)

OR

UPDATE tbl_1 SET field1 = 6,  field12= NULL WHERE field3  = (SELECT item1 FROM tbl_2 WHERE item2 = 135)
",2
8036927,11/07/2011 13:08:13,1033772,11/07/2011 13:03:36,1,0,SQL Server 2008 Navtie Client issue,"We have two virtual machines on a server. We have Sql server installed on one vm and on another vm sybase is installed. We cann't find ""SQL Server 2008 Navtie Client"" driver on the machine where we have intalled sybase. We have tried to install it using ""sqlncli.msi""  but could not install it. We have got the following error during installation.

""An error occured during the installtion of assembly 'Microsoft.VC80.CRT,version=""8.0.50727.1833"",type=""win32"",publikeyToken=""1fc8b3b9a18e3b"",processorArchitectre=""x86"". Please rfer to help Help and Support for more infoemation.HRESULT: 0x8007054F.""

Can you please help us to sort it out.


Thanks in advance.


Kavita Nemad 

Palewar Techno Solutions 

(www.palewar.com)",sql,sybase,,,,11/11/2011 10:57:33,off topic,1,96,6,"SQL Server 2008 Navtie Client issue We have two virtual machines on a server. We have Sql server installed on one vm and on another vm sybase is installed. We cann't find ""SQL Server 2008 Navtie Client"" driver on the machine where we have intalled sybase. We have tried to install it using ""sqlncli.msi""  but could not install it. We have got the following error during installation.

""An error occured during the installtion of assembly 'Microsoft.VC80.CRT,version=""8.0.50727.1833"",type=""win32"",publikeyToken=""1fc8b3b9a18e3b"",processorArchitectre=""x86"". Please rfer to help Help and Support for more infoemation.HRESULT: 0x8007054F.""

Can you please help us to sort it out.


Thanks in advance.


Kavita Nemad 

Palewar Techno Solutions 

(www.palewar.com)",2
4190404,11/16/2010 01:21:57,478225,10/16/2010 23:15:28,8,0,How many stored procedure calls per transaction?,"I guess it's a bit rude to ask this question, as I should make an effort (more than googling) to figure it out myself, but maybe some one knows the answer off the top of his head.

How many stored procedure calls are made per transaction (MS SQL 2005/2008)? Say, I created a stored procedure which triggers on inserts and from within a Java application, I commit only once all the insert statements were sent. Does the stored procedure trigger at every insert or only after I commit? Or does it depends on how I set up the stored procedure?

Cheers,
Max",sql,stored-procedures,transactions,ms,,,open,0,99,7,"How many stored procedure calls per transaction? I guess it's a bit rude to ask this question, as I should make an effort (more than googling) to figure it out myself, but maybe some one knows the answer off the top of his head.

How many stored procedure calls are made per transaction (MS SQL 2005/2008)? Say, I created a stored procedure which triggers on inserts and from within a Java application, I commit only once all the insert statements were sent. Does the stored procedure trigger at every insert or only after I commit? Or does it depends on how I set up the stored procedure?

Cheers,
Max",4
11636544,07/24/2012 17:53:29,1058646,11/21/2011 21:34:49,314,4,Trying to add 10 values to sql database,"This is easy enough task under sql management studio. I clicked on edit top 200 rows. And entered first set of values as:

Everything should be same except Index and rollnumber

    Index class rollnumber age 
    1      A      1         10
    2      A      2         10
    3      A      3         10
    ...
    10     A      10        10

Problem i am having is:
I copied first row and pasted in second row and when i try to change it in sql editor i am unable to. 
Can anyone please tell me what is the best way to do this through sql editor?

Or if there is easier way to do SQL insert in this case? 
",sql,sql-server-2008,,,,07/25/2012 02:31:17,too localized,1,195,8,"Trying to add 10 values to sql database This is easy enough task under sql management studio. I clicked on edit top 200 rows. And entered first set of values as:

Everything should be same except Index and rollnumber

    Index class rollnumber age 
    1      A      1         10
    2      A      2         10
    3      A      3         10
    ...
    10     A      10        10

Problem i am having is:
I copied first row and pasted in second row and when i try to change it in sql editor i am unable to. 
Can anyone please tell me what is the best way to do this through sql editor?

Or if there is easier way to do SQL insert in this case? 
",2
3333440,07/26/2010 09:01:26,279244,02/23/2010 07:47:32,37,1,Lost connection to MySQL server in Windows XP while adding Data Source - ODBC,"When I am trying to connect to the localhost, there is no problem. But when I am connecting to my server, I am getting this error.

[08S01][MySQL][ODBC 5.1 Driver] Lost connection to MySQL server at ‘reading initial communication packet’, system error: 2

Please tell me how to work around this.
I have tried with MySQL ODBC Drivers, both 3.51 and 5.1 drivers.
",sql,mysql,windows-xp,odbc,odbc-sql-server-driver,,open,0,59,14,"Lost connection to MySQL server in Windows XP while adding Data Source - ODBC When I am trying to connect to the localhost, there is no problem. But when I am connecting to my server, I am getting this error.

[08S01][MySQL][ODBC 5.1 Driver] Lost connection to MySQL server at ‘reading initial communication packet’, system error: 2

Please tell me how to work around this.
I have tried with MySQL ODBC Drivers, both 3.51 and 5.1 drivers.
",5
9971664,04/02/2012 06:17:23,1259315,03/09/2012 12:48:26,20,0,Concept Behind Advance salary and remaining salary,"I have developed a project(employee management system) now I am on reporting part.

Wanted to show advance and remaining salary to the user, For this I am thinking to put the calculated value inside a remaining_salary column of database, however I saw a article in which it was mentioned that never put calculated values inside database, best practice is to do calculation on form.

If I wouldn't put calculated value inside database than how I'll Show advance and remaining to user.


Thanks ",sql,reporting,,,,04/03/2012 07:07:55,not a real question,1,80,7,"Concept Behind Advance salary and remaining salary I have developed a project(employee management system) now I am on reporting part.

Wanted to show advance and remaining salary to the user, For this I am thinking to put the calculated value inside a remaining_salary column of database, however I saw a article in which it was mentioned that never put calculated values inside database, best practice is to do calculation on form.

If I wouldn't put calculated value inside database than how I'll Show advance and remaining to user.


Thanks ",2
7324145,09/06/2011 18:01:59,348434,05/16/2010 06:45:57,76,0,Creating a vew for summary,"I have a table of questions. The questions can be high priority, low priority, open/answered. What is the best way to create a summary. Should I use a view or several stored procedures? 

Table example: 

    CREATE TABLE [dbo].[question] (
        [Id]            INT          NOT NULL,
        [Priority]      INT          NOT NULL,
        [State]         INT          NOT NULL)

I think creating a view with 4 columns is the best: OpenQuestionHighPriority, OpenQuestionLowPriority, ClosedQuestionHighPriority,ClosedQuestionLowPriority. 

Like to know how to do this or other suggestions.
Thanks,

",sql,database,script,,,,open,0,150,5,"Creating a vew for summary I have a table of questions. The questions can be high priority, low priority, open/answered. What is the best way to create a summary. Should I use a view or several stored procedures? 

Table example: 

    CREATE TABLE [dbo].[question] (
        [Id]            INT          NOT NULL,
        [Priority]      INT          NOT NULL,
        [State]         INT          NOT NULL)

I think creating a view with 4 columns is the best: OpenQuestionHighPriority, OpenQuestionLowPriority, ClosedQuestionHighPriority,ClosedQuestionLowPriority. 

Like to know how to do this or other suggestions.
Thanks,

",3
1840847,12/03/2009 15:54:43,94561,04/22/2009 19:12:59,30,3,can someone copyright an sql query?,"I work for a school district. Every year we have to export a list of students from our student management system and send it to a company that handles our online exams.

So to do this export, we had to hire someone who knew the inner workings of our student management system. He wrote an sql (Adaptive Sybase SQL Anywhere) query to export the students to a csv file like we needed. This was before I started working for the district, so for a while I assumed this was an actually application, until it came time for me to do the export myself.

And every year he charges us $500 to update this query to export the students for the current year. So when I discovered it was only a query (.bat file and .sql file), my thought was ""I can update this myself"". All I have to do is change the years in the query (eg. 2009 to 2010).

The query (.sql file) itself has this comment at the top:

    // This code was writtend by [the guy]
    // and is the property of [his company]...Copyright 2005,2006,2008,2009
    // This code MAY NOT BE USED without the expressed written consent of 
    // [his company].

(Yes, it really does says ""writtend"".)

So now my boss is worried that we're violating the copyright. And that the guy is gonna find out that I updated the query myself because we haven't asked him to update it this year and take legal action.

So back to the subject's question:
Can he really copyright this query?
And if so, is modifying it ourselves a copyright violation?
In my mind, a single query isn't program code. It's more a command line command. But I don't know what it's considered legally.",sql,copyright,,,,05/07/2011 10:20:04,not constructive,1,298,6,"can someone copyright an sql query? I work for a school district. Every year we have to export a list of students from our student management system and send it to a company that handles our online exams.

So to do this export, we had to hire someone who knew the inner workings of our student management system. He wrote an sql (Adaptive Sybase SQL Anywhere) query to export the students to a csv file like we needed. This was before I started working for the district, so for a while I assumed this was an actually application, until it came time for me to do the export myself.

And every year he charges us $500 to update this query to export the students for the current year. So when I discovered it was only a query (.bat file and .sql file), my thought was ""I can update this myself"". All I have to do is change the years in the query (eg. 2009 to 2010).

The query (.sql file) itself has this comment at the top:

    // This code was writtend by [the guy]
    // and is the property of [his company]...Copyright 2005,2006,2008,2009
    // This code MAY NOT BE USED without the expressed written consent of 
    // [his company].

(Yes, it really does says ""writtend"".)

So now my boss is worried that we're violating the copyright. And that the guy is gonna find out that I updated the query myself because we haven't asked him to update it this year and take legal action.

So back to the subject's question:
Can he really copyright this query?
And if so, is modifying it ourselves a copyright violation?
In my mind, a single query isn't program code. It's more a command line command. But I don't know what it's considered legally.",2
7809762,10/18/2011 15:27:03,943127,09/13/2011 18:00:37,6,0,SQL removing duplicate rows with binary relations,"I'm working with a table with two columns that are the same key where the rows contain duplicate values but in different columns:

    A1 | A2
    -------
    b  |  c
    c  |  b

Is there a way to reduce this to just one row? Thanks.",sql,,,,,,open,0,60,7,"SQL removing duplicate rows with binary relations I'm working with a table with two columns that are the same key where the rows contain duplicate values but in different columns:

    A1 | A2
    -------
    b  |  c
    c  |  b

Is there a way to reduce this to just one row? Thanks.",1
3971278,10/19/2010 18:06:24,477189,10/15/2010 16:54:13,6,0,How I send a data from Yahoo quotes to MySQL with Perl?,"After download data from Yahoo and Google finance, how I do a Perl script to send these to MySQL Database automatic?
",sql,mysql,perl,google,yahoo,10/20/2010 01:03:24,not a real question,1,21,12,"How I send a data from Yahoo quotes to MySQL with Perl? After download data from Yahoo and Google finance, how I do a Perl script to send these to MySQL Database automatic?
",5
262450,11/04/2008 16:52:26,14673,09/17/2008 01:55:17,122,6,Why using '*' to build a view is bad ?,"Why using '*' to build a view is bad ?
 
Suppose that you have a complex join and all fields may be use somewhere.
 
Then you just have to chose fields needed.
 

    SELECT field1, field2 FROM aview WHERE ...

 
The view ""aview"" could be SELECT table1.*, table2.* ... FROM table1 INNER JOIN table2 ...
 
We have a problem if 2 fields have the same name in table1 and table2.
 
Is it only the reason why using '*' in a view is bad ?
 
With '*', you may use the view in different context because the information is there.
 
What am I missing ?
 
Regards
",sql,view,,,,,open,0,108,10,"Why using '*' to build a view is bad ? Why using '*' to build a view is bad ?
 
Suppose that you have a complex join and all fields may be use somewhere.
 
Then you just have to chose fields needed.
 

    SELECT field1, field2 FROM aview WHERE ...

 
The view ""aview"" could be SELECT table1.*, table2.* ... FROM table1 INNER JOIN table2 ...
 
We have a problem if 2 fields have the same name in table1 and table2.
 
Is it only the reason why using '*' in a view is bad ?
 
With '*', you may use the view in different context because the information is there.
 
What am I missing ?
 
Regards
",2
9023879,01/26/2012 19:15:52,1152145,01/16/2012 15:27:53,1,0,SQL UPDATE statement with WHERE EXISTS,"Im trying to write a query that updates a date only if the group im updating has a LINE_CD of 50.  Would i do it like this?



    UPDATE EMPLOYER_ADDL  
	SET EMPLOYER_ADDL.GTL_UW_APPRV_DT = EMPLOYER_ADDL.DNTL_UW_APPRV_DT 
	WHERE EXISTS
		( 
		  SELECT EMP_PLAN_LINE_INFO.LINE_CD
		  FROM EMP_PLAN_LINE_INFO
		  Where EMP_PLAN_LINE_INFO.GR_NBR = EMPLOYER_ADDL.GR_NBR and
		   EMP_PLAN_LINE_INFO.LINE_CD = 50
		 )",sql,sql-server,,,,01/27/2012 22:16:36,not a real question,1,59,6,"SQL UPDATE statement with WHERE EXISTS Im trying to write a query that updates a date only if the group im updating has a LINE_CD of 50.  Would i do it like this?



    UPDATE EMPLOYER_ADDL  
	SET EMPLOYER_ADDL.GTL_UW_APPRV_DT = EMPLOYER_ADDL.DNTL_UW_APPRV_DT 
	WHERE EXISTS
		( 
		  SELECT EMP_PLAN_LINE_INFO.LINE_CD
		  FROM EMP_PLAN_LINE_INFO
		  Where EMP_PLAN_LINE_INFO.GR_NBR = EMPLOYER_ADDL.GR_NBR and
		   EMP_PLAN_LINE_INFO.LINE_CD = 50
		 )",2
4292452,11/27/2010 15:47:56,422039,08/16/2010 18:29:33,16,2,Insert Fail because of wrong non-numeric character,"hy

table:

    create table Players (PlayerNo number (4) not null, Name varchar2(15), date_of_birth date,leagno varchar(4));

wrong insert:

    insert into PLAYERS (PlayerNo,Name,date_of_birth,leagno) VALUES (1,'Philipp K','Jan-10-1999','1')

whats wrong?

error code:


    Fehler beim Start in Zeile 1 in Befehl:
    insert into PLAYERS (PlayerNo,Name,date_of_birth,leagno) VALUES (1,'Philipp K','Jan-10-1999','1')
    Fehlerbericht:
    SQL-Fehler: ORA-01858: Ein nicht-numerisches Zeichen wurde gefunden, während ein numerisches Zeichen erwartet wurde
    01858. 00000 -  ""a non-numeric character was found where a numeric was expected""
    *Cause:    The input data to be converted using a date format model was
               incorrect.  The input data did not contain a number where a number was
               required by the format model.
    *Action:   Fix the input data or the date format model to make sure the
               elements match in number and type.  Then retry the operation.

",sql,oracle,,,,,open,0,198,7,"Insert Fail because of wrong non-numeric character hy

table:

    create table Players (PlayerNo number (4) not null, Name varchar2(15), date_of_birth date,leagno varchar(4));

wrong insert:

    insert into PLAYERS (PlayerNo,Name,date_of_birth,leagno) VALUES (1,'Philipp K','Jan-10-1999','1')

whats wrong?

error code:


    Fehler beim Start in Zeile 1 in Befehl:
    insert into PLAYERS (PlayerNo,Name,date_of_birth,leagno) VALUES (1,'Philipp K','Jan-10-1999','1')
    Fehlerbericht:
    SQL-Fehler: ORA-01858: Ein nicht-numerisches Zeichen wurde gefunden, während ein numerisches Zeichen erwartet wurde
    01858. 00000 -  ""a non-numeric character was found where a numeric was expected""
    *Cause:    The input data to be converted using a date format model was
               incorrect.  The input data did not contain a number where a number was
               required by the format model.
    *Action:   Fix the input data or the date format model to make sure the
               elements match in number and type.  Then retry the operation.

",2
3850816,10/03/2010 17:36:57,462400,09/30/2010 02:07:51,35,0,SQL : Represent a subquery in relational algebra,"How do I represent a subquery in relation algebra.


Do I put the new select under the previous select condition.",sql,,,,,,open,0,19,8,"SQL : Represent a subquery in relational algebra How do I represent a subquery in relation algebra.


Do I put the new select under the previous select condition.",1
4439369,12/14/2010 12:55:07,528696,12/02/2010 23:15:42,61,1,[SQL][MSaccess] Question about ms access query (combining 2 query),"I have this query:  

    SELECT ""I1"" & "","" & ""I2"" AS Item_set, Round(Sum([T1].Fuzzy_Value)/Count(*),15) AS Support
        FROM (SELECT *
        FROM Prune AS t
        WHERE t.Trans_ID IN 
        
            (SELECT t1.Trans_ID FROM (
        
             SELECT *FROM Prune WHERE [Nama]=""I1"")  AS t1 
             INNER JOIN (SELECT * FROM Prune WHERE [Nama]=""I2"")  AS t2 ON t1.Trans_ID = t2.Trans_ID)
        
        AND t.Nama IN (""I1"",""I2""))  AS T1;

And ttrans query

    SELECT Count([Trans_ID].[Trans_ID]) AS Expr1
    FROM Trans_ID;

i need to change **Count (*)** from :

     SELECT ""I1"" & "","" & ""I2"" AS Item_set, Round(Sum([T1].Fuzzy_Value)/Count(*),15)

into ttrans query.

i've tried using 

    SELECT ""I1"" & "","" & ""I2"" AS Item_set, Round(Sum([T1].Fuzzy_Value)/ttrans.Expr1,15) AS Support
    FROM (SELECT *
    FROM Prune AS t
    WHERE t.Trans_ID IN 
    
        (SELECT t1.Trans_ID FROM (
    
         SELECT *FROM Prune WHERE [Nama]=""I1"")  AS t1 
         INNER JOIN (SELECT * FROM Prune WHERE [Nama]=""I2"")  AS t2 ON t1.Trans_ID = t2.Trans_ID)

    AND t.Nama IN (""I1"",""I2""))  AS T1, ttrans;

But i got error like this :

    You tried to execute a query that does not include the specified expression 
    'Round(sum([T1].Fuzzy_Value/ttrans.Expr1,15)' as part of an aggregate function

any idea how to fix it?

**note : i'm trying to find 2 combination of all item in transaction database and get a result like this

    ITEM       Support
    I1, I2     0.xxxxxxxxx

where support is (total transaction containing item I1 and I2 / total transaction) -> note that i'm using ttrans query to get total transaction value

**note2 : i'm using msaccess
**note3 :

Ttrans table will look like this

    Expr1
    270200",sql,query,ms-access,,,,open,0,416,9,"[SQL][MSaccess] Question about ms access query (combining 2 query) I have this query:  

    SELECT ""I1"" & "","" & ""I2"" AS Item_set, Round(Sum([T1].Fuzzy_Value)/Count(*),15) AS Support
        FROM (SELECT *
        FROM Prune AS t
        WHERE t.Trans_ID IN 
        
            (SELECT t1.Trans_ID FROM (
        
             SELECT *FROM Prune WHERE [Nama]=""I1"")  AS t1 
             INNER JOIN (SELECT * FROM Prune WHERE [Nama]=""I2"")  AS t2 ON t1.Trans_ID = t2.Trans_ID)
        
        AND t.Nama IN (""I1"",""I2""))  AS T1;

And ttrans query

    SELECT Count([Trans_ID].[Trans_ID]) AS Expr1
    FROM Trans_ID;

i need to change **Count (*)** from :

     SELECT ""I1"" & "","" & ""I2"" AS Item_set, Round(Sum([T1].Fuzzy_Value)/Count(*),15)

into ttrans query.

i've tried using 

    SELECT ""I1"" & "","" & ""I2"" AS Item_set, Round(Sum([T1].Fuzzy_Value)/ttrans.Expr1,15) AS Support
    FROM (SELECT *
    FROM Prune AS t
    WHERE t.Trans_ID IN 
    
        (SELECT t1.Trans_ID FROM (
    
         SELECT *FROM Prune WHERE [Nama]=""I1"")  AS t1 
         INNER JOIN (SELECT * FROM Prune WHERE [Nama]=""I2"")  AS t2 ON t1.Trans_ID = t2.Trans_ID)

    AND t.Nama IN (""I1"",""I2""))  AS T1, ttrans;

But i got error like this :

    You tried to execute a query that does not include the specified expression 
    'Round(sum([T1].Fuzzy_Value/ttrans.Expr1,15)' as part of an aggregate function

any idea how to fix it?

**note : i'm trying to find 2 combination of all item in transaction database and get a result like this

    ITEM       Support
    I1, I2     0.xxxxxxxxx

where support is (total transaction containing item I1 and I2 / total transaction) -> note that i'm using ttrans query to get total transaction value

**note2 : i'm using msaccess
**note3 :

Ttrans table will look like this

    Expr1
    270200",3
11300762,07/02/2012 20:32:40,331393,05/03/2010 12:20:59,517,4,What is the primary key on a temporal table?,"If I use the following table design to capture history...:

    CREATE TABLE MyTable (
        insertion_timestamp TIMESTAMP,
        deleted_flag BOOLEAN,
        natural_key INT,
        attribute VARCHAR
    );

... then what should the primary key be?


(The history mechanism is `INSERT`-only: updated rows are inserted with a different `insertion_timestamp`, and deleted rows are inserted with a different timestamp and the `deleted_flag` set to `true`.)

I'm thinking `PRIMARY KEY (insertion_timestamp, deleted_flag, natural_key)`, but the only reason for including `deleted_flag` is to account for the possibility of a row being inserted and then (soft) deleted immediately, sooner than the next tick of the granularity of the `TIMESTAMP` data type. This feels overly paranoid...
",sql,database-design,temporal-database,,,07/05/2012 14:33:05,off topic,1,137,9,"What is the primary key on a temporal table? If I use the following table design to capture history...:

    CREATE TABLE MyTable (
        insertion_timestamp TIMESTAMP,
        deleted_flag BOOLEAN,
        natural_key INT,
        attribute VARCHAR
    );

... then what should the primary key be?


(The history mechanism is `INSERT`-only: updated rows are inserted with a different `insertion_timestamp`, and deleted rows are inserted with a different timestamp and the `deleted_flag` set to `true`.)

I'm thinking `PRIMARY KEY (insertion_timestamp, deleted_flag, natural_key)`, but the only reason for including `deleted_flag` is to account for the possibility of a row being inserted and then (soft) deleted immediately, sooner than the next tick of the granularity of the `TIMESTAMP` data type. This feels overly paranoid...
",3
11285202,07/01/2012 19:57:47,1494696,07/01/2012 19:49:48,1,0,Enable double-hop kerberos authentication for SQL queries and SQL Reports.,Want to run sql queries from my desktop PC (SQL 2008 R2) via ServerA (SQL 2008 R2) on ServerB (SQL 2008 R2). Heard they call this double-hop kerberos authentication. Will be using Windows Authentication. How do you accomplish this ? ,sql,,,,,07/02/2012 20:24:06,off topic,1,41,10,Enable double-hop kerberos authentication for SQL queries and SQL Reports. Want to run sql queries from my desktop PC (SQL 2008 R2) via ServerA (SQL 2008 R2) on ServerB (SQL 2008 R2). Heard they call this double-hop kerberos authentication. Will be using Windows Authentication. How do you accomplish this ? ,1
7127200,08/19/2011 20:44:40,362461,06/05/2010 10:37:41,577,30,help with sqlite replace function,"am trying to update my database table that looks like this

    name  | file_name
    ----------------
    name1 | name1\data

what i want to do is, to replace all the name1 from `name` found in `file_name` column with empty string

    update cache set
    file_name=replace(file_name,name,'')
    where file_name like '%'||name||""%'""

When i execute the query above, i get an empty recordset.

can anybody help me fix this
",sql,sqlite,find-and-replace,,,,open,0,79,5,"help with sqlite replace function am trying to update my database table that looks like this

    name  | file_name
    ----------------
    name1 | name1\data

what i want to do is, to replace all the name1 from `name` found in `file_name` column with empty string

    update cache set
    file_name=replace(file_name,name,'')
    where file_name like '%'||name||""%'""

When i execute the query above, i get an empty recordset.

can anybody help me fix this
",3
6167495,05/29/2011 11:27:44,775091,05/29/2011 11:27:44,1,0,SQL GROUP BY with COUNT() Not grouping correctly,"Hi so i'm doing a small hobby project and i'm trying to get a GROUP BY clause to work correctly but it's not grouping the results instead it just takes one column.
Example:
Table classes ( guID, className )
Table student ( guID, name, classID)
Table grades  ( s_id, c_id, grade)

For example return the number of a certain grade for a whole class:
Students:
""Alex"", ""class1""
""Kevin"", ""class1""
""Lisa"", ""class2""

Grades:
""alex_id"", ""course_id"", ""B""
""alex_id"", ""course_id"", ""A""
""kevin_id"", ""course_id"", ""A""
""lisa_id"", ""course_id"", ""C""

QUERY:
    SELECT classes.className, (SELECT COUNT(*) FROM grades WHERE s_id = student.guID 
    AND grade = ""A"") as Total_Grades
    FROM classes
    INNER JOIN student
    ON classes.guID = student.classID
    WHERE classes.guID = 1
    GROUP BY classes.className;

This only gives the result:
""class1"", 1

Where it should give:
""class1"", 2

Would appriciate some help if someone got some spare time.",sql,hobby-project,,,,,open,0,143,8,"SQL GROUP BY with COUNT() Not grouping correctly Hi so i'm doing a small hobby project and i'm trying to get a GROUP BY clause to work correctly but it's not grouping the results instead it just takes one column.
Example:
Table classes ( guID, className )
Table student ( guID, name, classID)
Table grades  ( s_id, c_id, grade)

For example return the number of a certain grade for a whole class:
Students:
""Alex"", ""class1""
""Kevin"", ""class1""
""Lisa"", ""class2""

Grades:
""alex_id"", ""course_id"", ""B""
""alex_id"", ""course_id"", ""A""
""kevin_id"", ""course_id"", ""A""
""lisa_id"", ""course_id"", ""C""

QUERY:
    SELECT classes.className, (SELECT COUNT(*) FROM grades WHERE s_id = student.guID 
    AND grade = ""A"") as Total_Grades
    FROM classes
    INNER JOIN student
    ON classes.guID = student.classID
    WHERE classes.guID = 1
    GROUP BY classes.className;

This only gives the result:
""class1"", 1

Where it should give:
""class1"", 2

Would appriciate some help if someone got some spare time.",2
10264897,04/22/2012 03:07:21,1161080,01/20/2012 17:06:05,8,0,Confused about setting up SQL,"I need to run some basic SQL code for a class assignment, but I'm having trouble setting up an environment to work in. I have xampp downloaded on my Ubuntu machine, but what else do I need to download to make it work? How do I create a SQL document and actually run it?",sql,,,,,04/22/2012 18:04:44,not a real question,1,54,5,"Confused about setting up SQL I need to run some basic SQL code for a class assignment, but I'm having trouble setting up an environment to work in. I have xampp downloaded on my Ubuntu machine, but what else do I need to download to make it work? How do I create a SQL document and actually run it?",1
5347054,03/18/2011 01:17:26,665335,03/18/2011 01:05:50,1,0,Seeking Reporting tools,"We are looking for a web-based reporting tool solution. Either freeware or commercial would be considered. The requirement is that the web UI would allow user to select various options, and run them against database, which returns data to UI to render a report. The reporting tool should support high volume of queries, and produce good performance.

The architecture and system we are using are below:
SQL Server 2008
.NET 4
AJAX-based Web UI

Any idea would be very much appreciated

",sql,windows,server,tools,reporting,03/18/2011 10:29:56,not a real question,1,76,3,"Seeking Reporting tools We are looking for a web-based reporting tool solution. Either freeware or commercial would be considered. The requirement is that the web UI would allow user to select various options, and run them against database, which returns data to UI to render a report. The reporting tool should support high volume of queries, and produce good performance.

The architecture and system we are using are below:
SQL Server 2008
.NET 4
AJAX-based Web UI

Any idea would be very much appreciated

",5
149772,09/29/2008 17:32:45,9403,09/15/2008 18:42:58,761,65,How to use GROUP BY to concatenate strings in MySQL?,"Basically the question is how to get from this:

<pre>
id    string
1          A
1          B
2          C
</pre>

to this:

<pre>
id    string
1          A B
2          C
</pre>",sql,mysql,string,aggregate,concatenation,,open,0,69,10,"How to use GROUP BY to concatenate strings in MySQL? Basically the question is how to get from this:

<pre>
id    string
1          A
1          B
2          C
</pre>

to this:

<pre>
id    string
1          A B
2          C
</pre>",5
10000962,04/03/2012 20:33:10,1311334,04/03/2012 20:09:54,1,0,Sql database search query made by 4 drop down menus,"I hope i dont sound like ""make my homework please"", but I really dont get the answer to this. For starters, Im very starting learning php, and I got stuck on this.
I have 4 drop down: breed, color, size, gender. All this are saved in one table named pets.
I need that the client selects any of the options displayed in the dropdown, and get the rows displayed in the same window. It should have one last input text box to show the rows by postal code. For what ive read, It should be managed with arrays, but I dont really dont know how to implement it. This is the code I got so far. FYI, this code by the way is somewhat copy, pasting from other examples, so it might have many sintax errors.
In advanced, thanks a lot for your help.
-------------

        <table border=""0"" cellpadding=""3"" cellspacing=""0"" width=""100%"" class=""searchtable"">
    <tr>
    	<td colspan=""7"" class=""h2""><h2>Busqueda Perros Perdidos</h2></td>
    </tr>
     <table border=""0"" align=""left"" cellspacing=""7"" cellpadding=""2"">
          <tr>
       <form action=""<?=$_SERVER['php_SELF']?>"" method=""post""> 
       
          
      <tr>
            <td class=""label"">Raza</td>
            <td class=""label"">Color</td>
            <td class=""label"">Tamano</td>
            <td class=""label"">Genero</td>
            <td class=""label"">Codigo Postal</td>
          </tr>
          <tr>
            <td valign=""top"">
            <select name=""breed"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Affenpinscher</option>
            <option value=""150"">Whippet</option>
            <option value=""151"">Wire Fox Terrier</option>
            <option value=""152"">Wirehaired Pointing
    Griffon</option>
            <option value=""153"">Yorkshire Terrier</option>
            <option value="""">---------------</option>
            <option value=""154"">Mutt</option>
            <option value=""155"">Other</option>
            </select>
            </td>
            <td valign=""top"">
            <select name=""color"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Negro</option>
            <option value=""7"">Cafe</option>
            <option value=""6"">Dorado</option>
            <option value=""4"">Rojo</option>
            <option value=""3"">Plateado</option>
            <option value=""5"">Bronceado</option>
            <option value=""2"">Blanco</option>
            </select>
            </td>
            <td valign=""top"">
            <select name=""size"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Pequeño</option>
            <option value=""2"">Mediano</option>
            <option value=""3"">Grande</option>
            </select>
            </td>
            <td valign=""top"">
            <select name=""gender"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Macho</option>
            <option value=""2"">Hembra</option>
            </select>
            </td>
            <td valign=""top""><input name=""postal_code""
     value="""" size=""7"" maxlength=""8"" class=""smalltext""
     type=""text""></td>
            <td align=""right""><input
     src=""/images/button_search.jpg"" name=""Submit""
     style=""position: relative; top: -15px; width: 95px; height: 45px;""
     type=""image""></td>
          </tr>
          
       </form>    
     
     
    <?php 
    
    
    // form submitted 
    // set server access variables 
    $host = ""****""; 
    $user = ""****""; 
    $pass = ""****""; 
    $db = ""****""; 
    
    
    // Open Connection 
    
    $connect = mysql_connect($host, $user, $pass) or die (""Unable to connect to host""); 
    
    //Select Database 
    
    mysql_select_db($db) or die (""Unable to connect to database""); 
    
    //Create Query 
    
    $strSQL = ""SELECT breed, color, size, gender,  
    FROM pets 
    WHERE  
    (@breed IS NULL OR breed LIKE '%' +  @breed + '%') AND 
    (@color IS NULL OR color LIKE '%' + @color + '%') AND  
    (@size IS NULL OR size LIKE '%' + @size + '%') AND  
    (@gender IS NULL OR gender LIKE '%' + @gender + '%')"";
    
    $objQuery = mysql_query($strSQL) or die (""Error Query ["".$strSQL.""]"");  
    $Num_Rows = mysql_num_rows($objQuery);  
      
    $Per_Page = 2;   // Per Page  
      
    $Page = $_GET[""Page""];  
    if(!$_GET[""Page""])  
    {  
    $Page=1;  
    }  
      
    $Prev_Page = $Page-1;  
    $Next_Page = $Page+1;  
      
    $Page_Start = (($Per_Page*$Page)-$Per_Page);  
    if($Num_Rows<=$Per_Page)  
    {  
    $Num_Pages =1;  
    }  
    else if(($Num_Rows % $Per_Page)==0)  
    {  
    $Num_Pages =($Num_Rows/$Per_Page) ;  
    }  
    else  
    {  
    $Num_Pages =($Num_Rows/$Per_Page)+1;  
    $Num_Pages = (int)$Num_Pages;  
    }  
      
    $strSQL .="" order  by reg_num ASC LIMIT $Page_Start , $Per_Page"";  
    $objQuery  = mysql_query($strSQL);  
      
    ?>  
    <table width=""600"" border=""1"">  
    <tr>  
    
    <th width=""98""> <div align=""center"">Raza </div></th>  
    <th width=""198""> <div align=""center"">Color </div></th>
    <th width=""98""> <div align=""center"">Tamano </div></th>
    
    </tr>  
    <?  
    while($objResult = mysql_fetch_array($objQuery))  
    {  
    ?>
    
    <tr>  
    
    <td><?=$objResult[""breed""];?></td>  
    <td><?=$objResult[""color""];?></td>
    <td><?=$objResult[""size""];?></td>    
    </tr>  
    <?  
    }  
    ?>  
    </table>  
    <br>  
    Total <?= $Num_Rows;?> Registros : <?=$Num_Pages;?> Pagina :  
    <?  
    if($Prev_Page)  
    {  
    echo "" <a href='$_SERVER[SCRIPT_NAME]?Page=$Prev_Page&txtKeyword=$_GET[txtKeyword]'><< Back</a> "";  
    }  
      
    for($i=1; $i<=$Num_Pages; $i++){  
    if($i != $Page)  
    {  
    echo ""[ <a href='$_SERVER[SCRIPT_NAME]?Page=$i&txtKeyword=$_GET[txtKeyword]'>$i</a> ]"";  
    }  
    else  
    {  
    echo ""<b> $i </b>"";  
    }  
    }  
    if($Page!=$Num_Pages)  
    {  
    echo "" <a href ='$_SERVER[SCRIPT_NAME]?Page=$Next_Page&txtKeyword=$_GET[txtKeyword]'>Next>></a> "";  
    }  
    
     
      
      if (mysql_num_rows($objQuery) <= 0) {
       // no results
       { 
       echo 'No hay resultados en su busqueda.';
       }
    } else {
       do {
        // output
       } while($objResult = mysql_fetch_array($objQuery));
    }
      
      
    mysql_close($objConnect);  
    }  
    	?>

 

",sql,query,drop-down-menu,,,04/04/2012 20:44:07,not a real question,1,1841,10,"Sql database search query made by 4 drop down menus I hope i dont sound like ""make my homework please"", but I really dont get the answer to this. For starters, Im very starting learning php, and I got stuck on this.
I have 4 drop down: breed, color, size, gender. All this are saved in one table named pets.
I need that the client selects any of the options displayed in the dropdown, and get the rows displayed in the same window. It should have one last input text box to show the rows by postal code. For what ive read, It should be managed with arrays, but I dont really dont know how to implement it. This is the code I got so far. FYI, this code by the way is somewhat copy, pasting from other examples, so it might have many sintax errors.
In advanced, thanks a lot for your help.
-------------

        <table border=""0"" cellpadding=""3"" cellspacing=""0"" width=""100%"" class=""searchtable"">
    <tr>
    	<td colspan=""7"" class=""h2""><h2>Busqueda Perros Perdidos</h2></td>
    </tr>
     <table border=""0"" align=""left"" cellspacing=""7"" cellpadding=""2"">
          <tr>
       <form action=""<?=$_SERVER['php_SELF']?>"" method=""post""> 
       
          
      <tr>
            <td class=""label"">Raza</td>
            <td class=""label"">Color</td>
            <td class=""label"">Tamano</td>
            <td class=""label"">Genero</td>
            <td class=""label"">Codigo Postal</td>
          </tr>
          <tr>
            <td valign=""top"">
            <select name=""breed"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Affenpinscher</option>
            <option value=""150"">Whippet</option>
            <option value=""151"">Wire Fox Terrier</option>
            <option value=""152"">Wirehaired Pointing
    Griffon</option>
            <option value=""153"">Yorkshire Terrier</option>
            <option value="""">---------------</option>
            <option value=""154"">Mutt</option>
            <option value=""155"">Other</option>
            </select>
            </td>
            <td valign=""top"">
            <select name=""color"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Negro</option>
            <option value=""7"">Cafe</option>
            <option value=""6"">Dorado</option>
            <option value=""4"">Rojo</option>
            <option value=""3"">Plateado</option>
            <option value=""5"">Bronceado</option>
            <option value=""2"">Blanco</option>
            </select>
            </td>
            <td valign=""top"">
            <select name=""size"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Pequeño</option>
            <option value=""2"">Mediano</option>
            <option value=""3"">Grande</option>
            </select>
            </td>
            <td valign=""top"">
            <select name=""gender"" class=""smalltext"">
            <option value=""0"">- Todos -</option>
            <option value=""1"">Macho</option>
            <option value=""2"">Hembra</option>
            </select>
            </td>
            <td valign=""top""><input name=""postal_code""
     value="""" size=""7"" maxlength=""8"" class=""smalltext""
     type=""text""></td>
            <td align=""right""><input
     src=""/images/button_search.jpg"" name=""Submit""
     style=""position: relative; top: -15px; width: 95px; height: 45px;""
     type=""image""></td>
          </tr>
          
       </form>    
     
     
    <?php 
    
    
    // form submitted 
    // set server access variables 
    $host = ""****""; 
    $user = ""****""; 
    $pass = ""****""; 
    $db = ""****""; 
    
    
    // Open Connection 
    
    $connect = mysql_connect($host, $user, $pass) or die (""Unable to connect to host""); 
    
    //Select Database 
    
    mysql_select_db($db) or die (""Unable to connect to database""); 
    
    //Create Query 
    
    $strSQL = ""SELECT breed, color, size, gender,  
    FROM pets 
    WHERE  
    (@breed IS NULL OR breed LIKE '%' +  @breed + '%') AND 
    (@color IS NULL OR color LIKE '%' + @color + '%') AND  
    (@size IS NULL OR size LIKE '%' + @size + '%') AND  
    (@gender IS NULL OR gender LIKE '%' + @gender + '%')"";
    
    $objQuery = mysql_query($strSQL) or die (""Error Query ["".$strSQL.""]"");  
    $Num_Rows = mysql_num_rows($objQuery);  
      
    $Per_Page = 2;   // Per Page  
      
    $Page = $_GET[""Page""];  
    if(!$_GET[""Page""])  
    {  
    $Page=1;  
    }  
      
    $Prev_Page = $Page-1;  
    $Next_Page = $Page+1;  
      
    $Page_Start = (($Per_Page*$Page)-$Per_Page);  
    if($Num_Rows<=$Per_Page)  
    {  
    $Num_Pages =1;  
    }  
    else if(($Num_Rows % $Per_Page)==0)  
    {  
    $Num_Pages =($Num_Rows/$Per_Page) ;  
    }  
    else  
    {  
    $Num_Pages =($Num_Rows/$Per_Page)+1;  
    $Num_Pages = (int)$Num_Pages;  
    }  
      
    $strSQL .="" order  by reg_num ASC LIMIT $Page_Start , $Per_Page"";  
    $objQuery  = mysql_query($strSQL);  
      
    ?>  
    <table width=""600"" border=""1"">  
    <tr>  
    
    <th width=""98""> <div align=""center"">Raza </div></th>  
    <th width=""198""> <div align=""center"">Color </div></th>
    <th width=""98""> <div align=""center"">Tamano </div></th>
    
    </tr>  
    <?  
    while($objResult = mysql_fetch_array($objQuery))  
    {  
    ?>
    
    <tr>  
    
    <td><?=$objResult[""breed""];?></td>  
    <td><?=$objResult[""color""];?></td>
    <td><?=$objResult[""size""];?></td>    
    </tr>  
    <?  
    }  
    ?>  
    </table>  
    <br>  
    Total <?= $Num_Rows;?> Registros : <?=$Num_Pages;?> Pagina :  
    <?  
    if($Prev_Page)  
    {  
    echo "" <a href='$_SERVER[SCRIPT_NAME]?Page=$Prev_Page&txtKeyword=$_GET[txtKeyword]'><< Back</a> "";  
    }  
      
    for($i=1; $i<=$Num_Pages; $i++){  
    if($i != $Page)  
    {  
    echo ""[ <a href='$_SERVER[SCRIPT_NAME]?Page=$i&txtKeyword=$_GET[txtKeyword]'>$i</a> ]"";  
    }  
    else  
    {  
    echo ""<b> $i </b>"";  
    }  
    }  
    if($Page!=$Num_Pages)  
    {  
    echo "" <a href ='$_SERVER[SCRIPT_NAME]?Page=$Next_Page&txtKeyword=$_GET[txtKeyword]'>Next>></a> "";  
    }  
    
     
      
      if (mysql_num_rows($objQuery) <= 0) {
       // no results
       { 
       echo 'No hay resultados en su busqueda.';
       }
    } else {
       do {
        // output
       } while($objResult = mysql_fetch_array($objQuery));
    }
      
      
    mysql_close($objConnect);  
    }  
    	?>

 

",3
2942839,05/31/2010 10:16:01,193605,10/21/2009 06:12:56,476,0,"Why there is ""GO"" after USE db"" in T-SQL examples?","Looking at the msdn, there was an example on ""GO"" command. Why there is:

    USE somedb
    GO
    ...
    ...

It it neccesary to select db in different batch? Thanks for explanation!",sql,mssql,,,,,open,0,42,10,"Why there is ""GO"" after USE db"" in T-SQL examples? Looking at the msdn, there was an example on ""GO"" command. Why there is:

    USE somedb
    GO
    ...
    ...

It it neccesary to select db in different batch? Thanks for explanation!",2
9756964,03/18/2012 08:14:59,1050548,11/16/2011 21:23:24,58,0,How to select within one column where the fields are similar,"I'm using sql... I have a table name Table1 with 2 columns: column1 and column2. First i need to select both columns where column 1 contains ""andrew"" or ""brandon"". Then i want to compare within column2 and return the results for strings that are similar for the fields within column2.

    column1 column2
    andrew  hi
    brandon hello
    andrew  hello
    carl    hi

return:

    brandon hello
    andrew  hello

",sql,,,,,03/19/2012 13:58:22,not a real question,1,91,11,"How to select within one column where the fields are similar I'm using sql... I have a table name Table1 with 2 columns: column1 and column2. First i need to select both columns where column 1 contains ""andrew"" or ""brandon"". Then i want to compare within column2 and return the results for strings that are similar for the fields within column2.

    column1 column2
    andrew  hi
    brandon hello
    andrew  hello
    carl    hi

return:

    brandon hello
    andrew  hello

",1
1420226,09/14/2009 08:00:03,97526,04/29/2009 05:48:00,138,7,Strange Behaviour: SQL And operator with multiple IN operators,"I am using multiple IN operators with AND in my sql query where clause as given below...

    ---
    where ID in (1, 3, 234, 2332, 2123, 989) AND tag in ('wow', 'wonderful')

But surprisingly behaviour of result seems to be of OR type rather then AND type. What I mean is it is ignoring AND operator...


Can you please explain me why?",sql,sql-server,,,,,open,0,66,9,"Strange Behaviour: SQL And operator with multiple IN operators I am using multiple IN operators with AND in my sql query where clause as given below...

    ---
    where ID in (1, 3, 234, 2332, 2123, 989) AND tag in ('wow', 'wonderful')

But surprisingly behaviour of result seems to be of OR type rather then AND type. What I mean is it is ignoring AND operator...


Can you please explain me why?",2
5349790,03/18/2011 08:52:11,259328,01/26/2010 15:24:33,294,8,How do I use a complex $criteria inside the repository of a doctrine 2 entity?,"Lets say I have a table that holds information about festivals.  
Each festival has a start and end date.

I want to select all the festivals that are live (that happen) on a given date.  
Meaning, I want to select all the festivals that their start date is before or on a given date, and that their end date is after or on a the same given date.

So I went on to the repository class of the festival entity, and created a method to do just that.  
But the criteria argument ""findBy"" expects is an array, which all the examples only treat as a simple criteria (eg. ""array('name' => 'billy')"" will select all the rows that have the value billy in their name column), which uses only the comparison operator.

How can I use other operators such as

    >, <, !=, IN, NOT IN, LIKE    

and etc. ?

Thanks",sql,doctrine,criteria,doctrine2,,,open,0,155,15,"How do I use a complex $criteria inside the repository of a doctrine 2 entity? Lets say I have a table that holds information about festivals.  
Each festival has a start and end date.

I want to select all the festivals that are live (that happen) on a given date.  
Meaning, I want to select all the festivals that their start date is before or on a given date, and that their end date is after or on a the same given date.

So I went on to the repository class of the festival entity, and created a method to do just that.  
But the criteria argument ""findBy"" expects is an array, which all the examples only treat as a simple criteria (eg. ""array('name' => 'billy')"" will select all the rows that have the value billy in their name column), which uses only the comparison operator.

How can I use other operators such as

    >, <, !=, IN, NOT IN, LIKE    

and etc. ?

Thanks",4
10813361,05/30/2012 09:18:41,1407463,05/21/2012 09:06:00,1,0,How to generate column data value in Sql server 2008,"I have a table with following structure

Year     Zone     Is_issueable     Amount

2000    East            i                   15266

2000    East           n                   2165

2001    West         i                    55151

My problem is that if Is_issueable value for n is absent then i want that for that particular year & zone the Is_issueable column value should

come equal to n and amount to 0.In some of my records Value for i is also missing....Vice-versa case...!

How do i achieve it......Thanks in Advance..! ",sql,sql-server-2008,sql-server-2008-r2,,,05/31/2012 08:39:27,not a real question,1,174,10,"How to generate column data value in Sql server 2008 I have a table with following structure

Year     Zone     Is_issueable     Amount

2000    East            i                   15266

2000    East           n                   2165

2001    West         i                    55151

My problem is that if Is_issueable value for n is absent then i want that for that particular year & zone the Is_issueable column value should

come equal to n and amount to 0.In some of my records Value for i is also missing....Vice-versa case...!

How do i achieve it......Thanks in Advance..! ",3
4386044,12/08/2010 09:42:43,290613,03/10/2010 14:55:37,494,15,How to get an array size (and the biggest) with an SQL statement?,"I am using postgres and some of my table's field are arrays.
I am looking for the biggest array is there any way to find this info with a SQL statement ?

    CREATE TABLE chapter
    (....
    chapter_path integer[],
    .....)

My chapter path are like that `{x,y,z} {x,y} {x}`

How with a SQL statement can I get **3** corresponding to `{x,y,z}` integer array size ?",sql,postgresql,,,,,open,0,73,13,"How to get an array size (and the biggest) with an SQL statement? I am using postgres and some of my table's field are arrays.
I am looking for the biggest array is there any way to find this info with a SQL statement ?

    CREATE TABLE chapter
    (....
    chapter_path integer[],
    .....)

My chapter path are like that `{x,y,z} {x,y} {x}`

How with a SQL statement can I get **3** corresponding to `{x,y,z}` integer array size ?",2
7491224,09/20/2011 20:13:12,955595,09/20/2011 20:13:12,1,0,MS SQL 2008: Replace string with date (us and uk format) and 12h time to uk format (dd/mm/yyyy) and 24h time format,"Hello i have an application that stores date and time in as a string field in an sql 2008 table. 

The application stores the date and time according to the regional settings of the pc that is running and we can’t change this behavor. 

The problem is that some pcs have to be in UK date format with 12h time (eg. 22/10/2011 1:22:35 pm) some with UK date format with 24h time (eg. 22/10/2011 13:22:25) and some have to be US date format (eg. 10/22/2011 1:22:35 pm) and (eg. 10/22/2011 13:22:25). 

Is there any automatic way to change the string every time it changing/added to the table to UK 24h format so it will be always the same format in the database? 

Can it be done using some trigger on update or insert? is there any build in function that already does that? 

Even a script to run it from time to time may be do the job.
I’m thinking to break apart the string to day, month , year, hour, minute, second , ampm and then put the day and month part in the dd/mm order and somehow change the hour part to 24h if pm and then get rid off the “am” and “pm” and then put the modified date/time back to the table.

For example the table has (ignore the dots i put them for formating only)

id……datesting…………………………value

1………15/10/2011 11:55:01 pm……BLAHBLAH

2………15/10/2011 13:12:20…………BLAKBLAK

3………10/15/2011 6:00:01 pm……..SOMESTUFF

4………10/15/2011 20:16:43…………SOMEOTHERSTUFF



and we want to be

id……..datesting…………………………value

1………15/10/2011 23:55:01…………BLAHBLAH

2………15/10/2011 13:12:20…………BLAKBLAK

3………10/15/2011 18:00:01…………SOMESTUFF

4………10/15/2011 20:16:43…………SOMEOTHERSTUFF


We can display the date parts (day,month,year) correctly using the datepart function if but with the time part we have problems because it changes to many ways.

Maybe I’m thinking it with very complicated way of doing it, or not?

Thank you in advance....",sql,string,datetime,date,convert,,open,0,283,22,"MS SQL 2008: Replace string with date (us and uk format) and 12h time to uk format (dd/mm/yyyy) and 24h time format Hello i have an application that stores date and time in as a string field in an sql 2008 table. 

The application stores the date and time according to the regional settings of the pc that is running and we can’t change this behavor. 

The problem is that some pcs have to be in UK date format with 12h time (eg. 22/10/2011 1:22:35 pm) some with UK date format with 24h time (eg. 22/10/2011 13:22:25) and some have to be US date format (eg. 10/22/2011 1:22:35 pm) and (eg. 10/22/2011 13:22:25). 

Is there any automatic way to change the string every time it changing/added to the table to UK 24h format so it will be always the same format in the database? 

Can it be done using some trigger on update or insert? is there any build in function that already does that? 

Even a script to run it from time to time may be do the job.
I’m thinking to break apart the string to day, month , year, hour, minute, second , ampm and then put the day and month part in the dd/mm order and somehow change the hour part to 24h if pm and then get rid off the “am” and “pm” and then put the modified date/time back to the table.

For example the table has (ignore the dots i put them for formating only)

id……datesting…………………………value

1………15/10/2011 11:55:01 pm……BLAHBLAH

2………15/10/2011 13:12:20…………BLAKBLAK

3………10/15/2011 6:00:01 pm……..SOMESTUFF

4………10/15/2011 20:16:43…………SOMEOTHERSTUFF



and we want to be

id……..datesting…………………………value

1………15/10/2011 23:55:01…………BLAHBLAH

2………15/10/2011 13:12:20…………BLAKBLAK

3………10/15/2011 18:00:01…………SOMESTUFF

4………10/15/2011 20:16:43…………SOMEOTHERSTUFF


We can display the date parts (day,month,year) correctly using the datepart function if but with the time part we have problems because it changes to many ways.

Maybe I’m thinking it with very complicated way of doing it, or not?

Thank you in advance....",5
4833661,01/28/2011 22:27:16,271976,02/12/2010 16:19:15,163,12,Why does this SQL result in Index Scan instead of an Index Seek?,"Can someone please help me tune this SQL query?


    SELECT	a.BuildingID, a.ApplicantID, a.ACH, a.Address, a.Age, a.AgentID, a.AmenityFee, a.ApartmentID, a.Applied, a.AptStatus, a.BikeLocation, a.BikeRent, a.Children, 
    		a.CurrentResidence, a.Email, a.Employer, a.FamilyStatus, a.HCMembers, a.HCPayment, a.Income, a.Industry, a.Name, a.OccupancyTimeframe, a.OnSiteID,
    		a.Other, a.ParkingFee, a.Pets, a.PetFee, a.Phone, a.Source, a.StorageLocation, a.StorageRent, a.TenantSigned, a.WasherDryer, a.WasherRent, a.WorkLocation, 
    		a.WorkPhone, a.CreationDate, a.CreatedBy, a.LastUpdated, a.UpdatedBy
    FROM	dbo.NPapplicants AS a INNER JOIN
    		dbo.NPapartments AS apt ON a.BuildingID = apt.BuildingID AND a.ApartmentID = apt.ApartmentID
    WHERE	(apt.Offline = 0)
    AND		(apt.MA = 'M')


.

Here's what the Execution Plan looks like:

.

![enter image description here][1]

What I don't understand is why I'm getting a Index Scan for NPapplicants.  I have an Index that covers BuildingID and ApartmentID.  Shouldn't that be used?

  [1]: http://i.stack.imgur.com/XX86I.png",sql,sql-server,performance,query-execution-plans,,,open,0,137,13,"Why does this SQL result in Index Scan instead of an Index Seek? Can someone please help me tune this SQL query?


    SELECT	a.BuildingID, a.ApplicantID, a.ACH, a.Address, a.Age, a.AgentID, a.AmenityFee, a.ApartmentID, a.Applied, a.AptStatus, a.BikeLocation, a.BikeRent, a.Children, 
    		a.CurrentResidence, a.Email, a.Employer, a.FamilyStatus, a.HCMembers, a.HCPayment, a.Income, a.Industry, a.Name, a.OccupancyTimeframe, a.OnSiteID,
    		a.Other, a.ParkingFee, a.Pets, a.PetFee, a.Phone, a.Source, a.StorageLocation, a.StorageRent, a.TenantSigned, a.WasherDryer, a.WasherRent, a.WorkLocation, 
    		a.WorkPhone, a.CreationDate, a.CreatedBy, a.LastUpdated, a.UpdatedBy
    FROM	dbo.NPapplicants AS a INNER JOIN
    		dbo.NPapartments AS apt ON a.BuildingID = apt.BuildingID AND a.ApartmentID = apt.ApartmentID
    WHERE	(apt.Offline = 0)
    AND		(apt.MA = 'M')


.

Here's what the Execution Plan looks like:

.

![enter image description here][1]

What I don't understand is why I'm getting a Index Scan for NPapplicants.  I have an Index that covers BuildingID and ApartmentID.  Shouldn't that be used?

  [1]: http://i.stack.imgur.com/XX86I.png",4
6352278,06/15/2011 02:14:46,637142,02/28/2011 04:31:33,472,17,outer join on same table sql,"I am creating a time machine with c#. A time machine is a way of creating a backup of my files in the way where I can access a specific file like it was at a specific time. Anyways the way I am doing so is by looking for all the files inside a directory and I store those files information in a table named table1. So if the first time I scan my computer lets assume I only have 3 files therefore my table will look something like:

    ID   FullName   DateModified   DateInsertedToDatabase
     1     C:\A       456588731             0
     2     C:\B       955588762             0
     3     C:\C       854587783             0

lets say that next time I perform a back up I have the same 3 files but I have created a new file and modified file C. As a result my table should now look like:

        ID   FullName   DateModified   DateInsertedToDatabase
         1     C:\A       456588731             0
         2     C:\B       955588762             0
         3     C:\C       854587783             0
         4     C:\A       456588731             1
         5     C:\B       955588762             1
         6     C:\C       111122212             1
         7     C:\X       123212321             1

now I will like to copy file C and File X because those are the files that have been changed or created. How could I build a query where I could obtain file X and file C ? In other words I want to get all the files that have a DateInsertedToDatabase = 1 and that don't match files where DateInsertedToDatabase is less than 1. 


if I am not being clear here is the continuation of my example:
lets say that I continue with my example and I delete files: B and C, I modify file X, I create a new file Z.  My table should look like:

        ID   FullName   DateModified   DateInsertedToDatabase
         1     C:\A       456588731             0
         2     C:\B       955588762             0
         3     C:\C       854587783             0
         4     C:\A       456588731             1
         5     C:\B       955588762             1
         6     C:\C       111122212             1
         7     C:\X       123212321             1
         8     C:\A       456588731             2
         9     C:\X       898989898             2
         10    C:\Z       789564545             2

here I will like to get files X and Z because file X was modified and File Z was created. I will not want to get file A because that file already exist with the same DateModified. How could I build that query?

",sql,sqlite,,,,,open,0,987,6,"outer join on same table sql I am creating a time machine with c#. A time machine is a way of creating a backup of my files in the way where I can access a specific file like it was at a specific time. Anyways the way I am doing so is by looking for all the files inside a directory and I store those files information in a table named table1. So if the first time I scan my computer lets assume I only have 3 files therefore my table will look something like:

    ID   FullName   DateModified   DateInsertedToDatabase
     1     C:\A       456588731             0
     2     C:\B       955588762             0
     3     C:\C       854587783             0

lets say that next time I perform a back up I have the same 3 files but I have created a new file and modified file C. As a result my table should now look like:

        ID   FullName   DateModified   DateInsertedToDatabase
         1     C:\A       456588731             0
         2     C:\B       955588762             0
         3     C:\C       854587783             0
         4     C:\A       456588731             1
         5     C:\B       955588762             1
         6     C:\C       111122212             1
         7     C:\X       123212321             1

now I will like to copy file C and File X because those are the files that have been changed or created. How could I build a query where I could obtain file X and file C ? In other words I want to get all the files that have a DateInsertedToDatabase = 1 and that don't match files where DateInsertedToDatabase is less than 1. 


if I am not being clear here is the continuation of my example:
lets say that I continue with my example and I delete files: B and C, I modify file X, I create a new file Z.  My table should look like:

        ID   FullName   DateModified   DateInsertedToDatabase
         1     C:\A       456588731             0
         2     C:\B       955588762             0
         3     C:\C       854587783             0
         4     C:\A       456588731             1
         5     C:\B       955588762             1
         6     C:\C       111122212             1
         7     C:\X       123212321             1
         8     C:\A       456588731             2
         9     C:\X       898989898             2
         10    C:\Z       789564545             2

here I will like to get files X and Z because file X was modified and File Z was created. I will not want to get file A because that file already exist with the same DateModified. How could I build that query?

",2
6616057,07/07/2011 19:33:25,454671,09/17/2010 04:17:12,718,17,Oracle query not displaying date properly,"In Oracle, there is a column(dateColumn) in a table with column type = DATE and the value for a particular record is showing as '10/03/2010' when I do a `select * from table.`
Now, when I do:

    select * from table where dateColumn < '01-JAN-11'

Nothing shows up. When I do:

    select * from table where dateColumn > '01-JAN-11'

The record shows up.
Why is this behaving this way? 10/03/2010 is 10th MArch 2010 so clearly that is < 01 Jan 2011.",sql,oracle,oracle9i,,,,open,0,84,6,"Oracle query not displaying date properly In Oracle, there is a column(dateColumn) in a table with column type = DATE and the value for a particular record is showing as '10/03/2010' when I do a `select * from table.`
Now, when I do:

    select * from table where dateColumn < '01-JAN-11'

Nothing shows up. When I do:

    select * from table where dateColumn > '01-JAN-11'

The record shows up.
Why is this behaving this way? 10/03/2010 is 10th MArch 2010 so clearly that is < 01 Jan 2011.",3
1788248,11/24/2009 06:33:42,167741,09/03/2009 08:52:12,19,0,how to neglect this error in sql query,"In my application i have got an error while running sql query from remote access
ERROR:Operation must use an updateable query.

please give me a solution",sql,query,,,,11/24/2009 06:59:55,not a real question,1,24,8,"how to neglect this error in sql query In my application i have got an error while running sql query from remote access
ERROR:Operation must use an updateable query.

please give me a solution",2
9723279,03/15/2012 15:47:47,1271909,03/15/2012 15:21:58,1,0,Update Query - multiple row in same table SQL Server,"I want to create guery which will update TimeStamp column and write data in it from
another column DateOfInsert. (for each row data in column DateOfInsert is different) 

Thank you!",sql,,,,,03/16/2012 21:56:23,not a real question,1,29,10,"Update Query - multiple row in same table SQL Server I want to create guery which will update TimeStamp column and write data in it from
another column DateOfInsert. (for each row data in column DateOfInsert is different) 

Thank you!",1
2912062,05/26/2010 10:27:52,350794,05/26/2010 10:27:52,1,0,Xquery get value from attribute,"I have some xml and need to extract values using sql

    <?xml version=""1.0"" ?>  
    <fields>  

    <field name=""fld_AccomAttic"">  
    <value>0</value>  
    </field>  
    <field name=""fld_AccomBathroom"">  
    <value>1</value>  
    </field>
    </fields>  
    
    </xml>

I need to get 
column name 
fld_AccomAttic  
Value 
1

The xml is held in a sql server 2005 db

I have used xquery before and it has worked.

Can any one show me how to extract these values

Im baffeled as to why i am unable to do this

Thanks
Sp",sql,xml,xquery,,,,open,0,120,5,"Xquery get value from attribute I have some xml and need to extract values using sql

    <?xml version=""1.0"" ?>  
    <fields>  

    <field name=""fld_AccomAttic"">  
    <value>0</value>  
    </field>  
    <field name=""fld_AccomBathroom"">  
    <value>1</value>  
    </field>
    </fields>  
    
    </xml>

I need to get 
column name 
fld_AccomAttic  
Value 
1

The xml is held in a sql server 2005 db

I have used xquery before and it has worked.

Can any one show me how to extract these values

Im baffeled as to why i am unable to do this

Thanks
Sp",3
4157166,11/11/2010 17:17:27,424296,08/18/2010 16:50:33,1,0,SQL Query support based on language settings in android,"Can someone tell me if there is way to write an SQL query to get list
of contact names from phonebook which matches its english name given
that the phone language is set to Spanish.

E.g., If I write a query to get a contacts whose last name ends with
""Dad"", but for some contacts the last name ""Dad"" will be stored as
**""papá""** in **Spanish**.
So the query where I write to match for lastname=""dad"" will not work
as they are different characters. Is there a way in SQL which takes
care of language translation as well while quering?

Appreicate your help!
",sql,android,query,,,,open,0,94,9,"SQL Query support based on language settings in android Can someone tell me if there is way to write an SQL query to get list
of contact names from phonebook which matches its english name given
that the phone language is set to Spanish.

E.g., If I write a query to get a contacts whose last name ends with
""Dad"", but for some contacts the last name ""Dad"" will be stored as
**""papá""** in **Spanish**.
So the query where I write to match for lastname=""dad"" will not work
as they are different characters. Is there a way in SQL which takes
care of language translation as well while quering?

Appreicate your help!
",3
6874027,07/29/2011 13:39:07,549090,12/20/2010 19:38:41,1,0,Best tool to move from Oracle to SQL,"I have a big Oracle DB: 4+ GB of data, 200 Tables, 1000+ Stored Procedures and Functions.

Does anyone recommend a tool for the DB structure and data migration? ",sql,oracle,database-migration,,,07/30/2011 21:05:56,off topic,1,29,8,"Best tool to move from Oracle to SQL I have a big Oracle DB: 4+ GB of data, 200 Tables, 1000+ Stored Procedures and Functions.

Does anyone recommend a tool for the DB structure and data migration? ",3
10326364,04/26/2012 02:16:56,1349094,04/22/2012 04:03:37,11,0,MS SQL Compare issue,"I have the below sql query:

    select @table1 as DataState, *  from
    (select * from importedcsvclients 
    except 
    select * from tblClients) x
    union all
    select @table2 as DataState, *  from
    (select * from tblClients 
    except select *  
    from importedcsvclients) x

The above code works fine, however, if table1 and table2 consist similar data, both records will show.
Can anyone assist me to make the query work as:
get the results of both table1 and table2, but only show table2 data if data exist in table1.

Thanks.",sql,stored-procedures,,,,,open,0,116,4,"MS SQL Compare issue I have the below sql query:

    select @table1 as DataState, *  from
    (select * from importedcsvclients 
    except 
    select * from tblClients) x
    union all
    select @table2 as DataState, *  from
    (select * from tblClients 
    except select *  
    from importedcsvclients) x

The above code works fine, however, if table1 and table2 consist similar data, both records will show.
Can anyone assist me to make the query work as:
get the results of both table1 and table2, but only show table2 data if data exist in table1.

Thanks.",2
2730577,04/28/2010 14:56:42,327987,04/28/2010 14:56:42,1,0,Database Tagging Structure,"I have three tables in my database. News, reviews and tutorials. I would like to implement tagging functionality.

I have done this before by having a tag table to define my tags, and a lookup table which has the type (news, tutorial, review), itemId and the tagId.

This has worked fine, however for my new site, I want to have PK FK relationships between the tables (as I am using linq to entities).

How can I do this? The tag lookup table cant be the foreign key for news, reviews and tutorials because when I add an row to the lookup table, a value will need to exist for all three types!

Whats the best way to go about this?

",sql,,,,,,open,0,116,3,"Database Tagging Structure I have three tables in my database. News, reviews and tutorials. I would like to implement tagging functionality.

I have done this before by having a tag table to define my tags, and a lookup table which has the type (news, tutorial, review), itemId and the tagId.

This has worked fine, however for my new site, I want to have PK FK relationships between the tables (as I am using linq to entities).

How can I do this? The tag lookup table cant be the foreign key for news, reviews and tutorials because when I add an row to the lookup table, a value will need to exist for all three types!

Whats the best way to go about this?

",1
11436699,07/11/2012 16:00:09,1283562,03/21/2012 13:55:35,25,0,Sql error : Cannot insert duplicate id on inserting new data with existing one,"I've a textbox on my modify page which holds the existing data from db.these datas are seperate rows in sql db but displayed as single row separated by comma in the textbox.

for eg : sql table
 
         keyid   name

          101     ss
          105     hh
          109     tt

In my webform it's displayed in a textbox like  ss,hh,tt.there's a bridge table (Keysproducts) which holds the keyid and  productid(product that's related to the keyid)

My issue here is
On adding more datas along with existing ones in my textbox i get this error msg saying duplicate values not be inserted and shows my existing id's.Below is my SP for it.I checking if the keyname exists if not insert otherwise update.Please guide me if my approach is wrong.

         create PROCEDURE [dbo].[modify] 
          (
            @keyName nvarchar(256),
            @productdbid uniqueidentifier

          )
         AS
         Begin
         declare 
        @productid uniqueidentifier,
        @keyid uniqueidentifier,
        @id uniqueidentifier;
        
       
        declare @keydata table (keyid uniqueidentifier);
        
        set @productid =(select ProductID from Products where ProductID = @productdbid );

	Begin
        
        
        if not exists(select keyname from keys where KeyName = @keyName)
        begin
         insert into Keys(KeyId,KeyName)
         output inserted.KeyId into @keydata(keyid)
         values (newid(),@keyName);
         select @keyid = keyid from @keydata;
          insert into KeysProducts(KeyId,productId)
          values (@keyid,@productid);
         end
         else
         begin
         set @id = (select keyid  from keys where KeyName = @keyName)
         update keywords set KeyId=@id, KeyName=@keyName where KeyName= @keyName;
        end
        if not exists(select * from Keysproducts where ProductID = @productid and KeyId= @id) 
       
      
         begin
          insert into Keysproducts(KeyId,ProductID)
          values (@id,@productid);       
         end

         else

         begin
         update Keysproducts set KeyId=@id,productID=@productid;
         end
         
        
          
          
  end
  end
  end

               












  ",sql,sql-server-2008,,,,,open,0,700,14,"Sql error : Cannot insert duplicate id on inserting new data with existing one I've a textbox on my modify page which holds the existing data from db.these datas are seperate rows in sql db but displayed as single row separated by comma in the textbox.

for eg : sql table
 
         keyid   name

          101     ss
          105     hh
          109     tt

In my webform it's displayed in a textbox like  ss,hh,tt.there's a bridge table (Keysproducts) which holds the keyid and  productid(product that's related to the keyid)

My issue here is
On adding more datas along with existing ones in my textbox i get this error msg saying duplicate values not be inserted and shows my existing id's.Below is my SP for it.I checking if the keyname exists if not insert otherwise update.Please guide me if my approach is wrong.

         create PROCEDURE [dbo].[modify] 
          (
            @keyName nvarchar(256),
            @productdbid uniqueidentifier

          )
         AS
         Begin
         declare 
        @productid uniqueidentifier,
        @keyid uniqueidentifier,
        @id uniqueidentifier;
        
       
        declare @keydata table (keyid uniqueidentifier);
        
        set @productid =(select ProductID from Products where ProductID = @productdbid );

	Begin
        
        
        if not exists(select keyname from keys where KeyName = @keyName)
        begin
         insert into Keys(KeyId,KeyName)
         output inserted.KeyId into @keydata(keyid)
         values (newid(),@keyName);
         select @keyid = keyid from @keydata;
          insert into KeysProducts(KeyId,productId)
          values (@keyid,@productid);
         end
         else
         begin
         set @id = (select keyid  from keys where KeyName = @keyName)
         update keywords set KeyId=@id, KeyName=@keyName where KeyName= @keyName;
        end
        if not exists(select * from Keysproducts where ProductID = @productid and KeyId= @id) 
       
      
         begin
          insert into Keysproducts(KeyId,ProductID)
          values (@id,@productid);       
         end

         else

         begin
         update Keysproducts set KeyId=@id,productID=@productid;
         end
         
        
          
          
  end
  end
  end

               












  ",2
5669067,04/14/2011 20:10:17,490735,10/28/2010 23:46:19,79,2,Is there an sql reindenter?,I'm looking to pretty print oracle code. Preferably online based.,sql,,,,,,open,0,10,5,Is there an sql reindenter? I'm looking to pretty print oracle code. Preferably online based.,1
11344743,07/05/2012 12:52:01,958429,09/22/2011 06:35:10,170,1,Restore a sql database to an offline copy,I've got MS SQL Server Management Studio.  I need to access a backup file (*.bak).  How do I create a new database engine that is OFFLINE (Running from my PC not the server) and then restore the database to that offline database engine?  Help will be greatly appreciated.,sql,,,,,07/05/2012 15:06:35,off topic,1,51,8,Restore a sql database to an offline copy I've got MS SQL Server Management Studio.  I need to access a backup file (*.bak).  How do I create a new database engine that is OFFLINE (Running from my PC not the server) and then restore the database to that offline database engine?  Help will be greatly appreciated.,1
6172026,05/30/2011 03:27:04,775759,05/30/2011 02:12:20,1,0,transaction script and domain model,i am confused how to compare and contrast transaction script and domain model in seperating Business Logic from Persistence Logic. can anybody help me in clearing this answer?,sql,plsql,,,,05/30/2011 05:11:07,not a real question,1,28,5,transaction script and domain model i am confused how to compare and contrast transaction script and domain model in seperating Business Logic from Persistence Logic. can anybody help me in clearing this answer?,2
3880885,10/07/2010 10:49:56,463334,09/30/2010 21:56:00,11,0,PhpMyadmin CSV Import data order? Mine is jubmled from CSV order?,"I'm trying to import my CSV data file back into my database in the same order it is in the CSv file. However when I import the order is all jumbled from how it appears in the file.

Is there a way to force PHPmyadmin to import in the exact same order as the CSV?",sql,mysql,phpmyadmin,,,,open,0,54,11,"PhpMyadmin CSV Import data order? Mine is jubmled from CSV order? I'm trying to import my CSV data file back into my database in the same order it is in the CSv file. However when I import the order is all jumbled from how it appears in the file.

Is there a way to force PHPmyadmin to import in the exact same order as the CSV?",3
7863456,10/23/2011 00:03:51,102946,05/07/2009 14:54:56,56,1,How to combine these two complicated queries into one query without union?,"

    (SELECT posts.id FROM posts 
    INNER JOIN discussions ON discussions.post_id = posts.id 
    INNER JOIN companies ON discussions.company_id = companies.id 
    INNER JOIN subscriptions ON subscriptions.subscribable_id = companies.id AND subscriptions.subscribable_type = 'Company' 
    INNER JOIN users ON subscriptions.user_id = users.id WHERE users.id = 6)
    
    UNION 
    
    (SELECT posts.id FROM posts 
    INNER JOIN users users_2 ON posts.analyst_id = users_2.id 
    INNER JOIN subscriptions ON subscriptions.subscribable_id = users_2.id AND subscriptions.subscribable_type = 'User'
    INNER JOIN users ON subscriptions.user_id = users.id WHERE users.id = 6)

It should be obvious that the last join is the same in both queries.. Just not sure how to ""or"" together joins.",sql,join,union,,,,open,0,142,12,"How to combine these two complicated queries into one query without union? 

    (SELECT posts.id FROM posts 
    INNER JOIN discussions ON discussions.post_id = posts.id 
    INNER JOIN companies ON discussions.company_id = companies.id 
    INNER JOIN subscriptions ON subscriptions.subscribable_id = companies.id AND subscriptions.subscribable_type = 'Company' 
    INNER JOIN users ON subscriptions.user_id = users.id WHERE users.id = 6)
    
    UNION 
    
    (SELECT posts.id FROM posts 
    INNER JOIN users users_2 ON posts.analyst_id = users_2.id 
    INNER JOIN subscriptions ON subscriptions.subscribable_id = users_2.id AND subscriptions.subscribable_type = 'User'
    INNER JOIN users ON subscriptions.user_id = users.id WHERE users.id = 6)

It should be obvious that the last join is the same in both queries.. Just not sure how to ""or"" together joins.",3
3325542,07/24/2010 14:55:28,137520,07/13/2009 15:44:44,92,2,SQL Server 2005 Database Backup,">  i m created a Database Backup job in SQL server 2005 under maintainace Plan,
but when  i run below query SQL sever return 0 Rows

Why?



select * from   sysdbmaintplan_databases",sql,server,2005,,,,open,0,32,5,"SQL Server 2005 Database Backup >  i m created a Database Backup job in SQL server 2005 under maintainace Plan,
but when  i run below query SQL sever return 0 Rows

Why?



select * from   sysdbmaintplan_databases",3
888731,05/20/2009 15:45:42,44330,12/08/2008 16:01:37,6454,377,two SQL COUNT() queries?,"I want to count both the total # of records in a table, and the total # of records that match certain conditions. I can do these with two separate queries:

    SELECT COUNT(*) AS TotalCount FROM MyTable;
    SELECT COUNT(*) AS QualifiedCount FROM MyTable WHERE {conditions};

Is there a way to combine these into one query so that I get two fields in one row?

    SELECT {something} AS TotalCount, 
      {something else} AS QualifiedCount 
      FROM MyTable WHERE {some conditions}

If not, I can issue two queries and wrap them in a transaction so they are consistent, but I was hoping to do it with one.",sql,,,,,,open,0,122,4,"two SQL COUNT() queries? I want to count both the total # of records in a table, and the total # of records that match certain conditions. I can do these with two separate queries:

    SELECT COUNT(*) AS TotalCount FROM MyTable;
    SELECT COUNT(*) AS QualifiedCount FROM MyTable WHERE {conditions};

Is there a way to combine these into one query so that I get two fields in one row?

    SELECT {something} AS TotalCount, 
      {something else} AS QualifiedCount 
      FROM MyTable WHERE {some conditions}

If not, I can issue two queries and wrap them in a transaction so they are consistent, but I was hoping to do it with one.",1
4613835,01/06/2011 10:15:40,139357,07/16/2009 10:05:53,652,10,How to find id of duplicate records in SQL SERVER 2005,"Table Entry has the following data. Certain records are duplicate. Duplicate criteria is same NoOfEntry and TypeOfEntry. Out of a record which has same NoOfEntry and TypeOfEntry, i want the EntryId of record which has min(dateOfEntry).

For Eg- We have 3 duplicate records for T1, I want record with EntryID 1001 as it was enterd first(minimum DateOfEntry). 




![alt text][1]


  [1]: http://i.stack.imgur.com/g0gnw.png",sql,sql-server-2005,,,,,open,0,61,11,"How to find id of duplicate records in SQL SERVER 2005 Table Entry has the following data. Certain records are duplicate. Duplicate criteria is same NoOfEntry and TypeOfEntry. Out of a record which has same NoOfEntry and TypeOfEntry, i want the EntryId of record which has min(dateOfEntry).

For Eg- We have 3 duplicate records for T1, I want record with EntryID 1001 as it was enterd first(minimum DateOfEntry). 




![alt text][1]


  [1]: http://i.stack.imgur.com/g0gnw.png",2
5946767,05/10/2011 07:41:27,416729,05/09/2010 10:13:32,413,6,how to shows todays programs from this sql,"how to shows todays programs from this sql

    CREATE TABLE `programs` (
         `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
         `p_category_id` int(11) NOT NULL,
         `p_name` varchar(255) NOT NULL,
         `p_detail` varchar(500) NOT NULL,
         `p_promo` varchar(500) NOT NULL,
         `p_start` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
         `p_end` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
         `p_channel` enum('A','B','C') NOT NULL,
         `p_feature` enum('true','false') NOT NULL,
         PRIMARY KEY (`id`)
        ) ENGINE=InnoDB AUTO_INCREMENT=41 DEFAULT CHARSET=latin1",sql,,,,,05/10/2011 12:08:25,too localized,1,154,8,"how to shows todays programs from this sql how to shows todays programs from this sql

    CREATE TABLE `programs` (
         `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
         `p_category_id` int(11) NOT NULL,
         `p_name` varchar(255) NOT NULL,
         `p_detail` varchar(500) NOT NULL,
         `p_promo` varchar(500) NOT NULL,
         `p_start` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
         `p_end` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
         `p_channel` enum('A','B','C') NOT NULL,
         `p_feature` enum('true','false') NOT NULL,
         PRIMARY KEY (`id`)
        ) ENGINE=InnoDB AUTO_INCREMENT=41 DEFAULT CHARSET=latin1",1
6210773,06/02/2011 05:26:15,713029,04/18/2011 08:16:33,23,0,want to display positive and negative values in different columns thru a single query,"I have one column table with negative and positive values and want to display positive and negative values in different columns thru a single query.

Column
-10000

-17000

 16000

 25000


output should be like

A           
-10000     

   

-17000   


B
 
 16000

 25000

 I am using oracle and pl sql developer. any suggestions pls",sql,,,,,06/02/2011 08:22:58,not a real question,1,66,14,"want to display positive and negative values in different columns thru a single query I have one column table with negative and positive values and want to display positive and negative values in different columns thru a single query.

Column
-10000

-17000

 16000

 25000


output should be like

A           
-10000     

   

-17000   


B
 
 16000

 25000

 I am using oracle and pl sql developer. any suggestions pls",1
5335136,03/17/2011 05:13:01,396506,06/29/2010 04:22:41,139,3,how do i get the rowcount of table variables?,how do i get the rowcount of table variables?,sql,sql-server,,,,,open,0,9,9,how do i get the rowcount of table variables? how do i get the rowcount of table variables?,2
8973940,01/23/2012 15:20:31,1025915,11/02/2011 15:08:20,184,11,SQL rtrim select and group by,"If you put an rtrim in the SELECT and also again in the GROUP BY, is this inefficient because its rtriming twice, one in the select and one in the group by? e.g....

    SELECT
    rtrim(people.FORENAME1)+ ' ' + rtrim(people.SURNAME)AS Full_Name,
    
    FROM 
    my table
    
    GROUP BY 
    rtrim(people.FORENAME1)+ ' ' + rtrim(people.SURNAME)",sql,sql-server,syntax,ssrs-2008,trim,,open,0,78,6,"SQL rtrim select and group by If you put an rtrim in the SELECT and also again in the GROUP BY, is this inefficient because its rtriming twice, one in the select and one in the group by? e.g....

    SELECT
    rtrim(people.FORENAME1)+ ' ' + rtrim(people.SURNAME)AS Full_Name,
    
    FROM 
    my table
    
    GROUP BY 
    rtrim(people.FORENAME1)+ ' ' + rtrim(people.SURNAME)",5
10017202,04/04/2012 18:31:35,519753,11/25/2010 06:54:41,43,0,How to tell in a Query I don't want duplicates?,"So I got this query and it's pulling from tables like this:

Plantation TABLE
PLANT ID,   Color Description 
1           Red
2           Green
3           Purple


Vegetable Table
VegetabkeID, PLANT ID, Feeldesc
199            1        Harsh
200            1        Sticky
201            2        Bitter
202            3        Bland


and now in my Query I join them using PLANT ID ( I Use a left join)

PLANT ID, Color Description, Feeldesc
1           Red               Harsh             
1           Red               Sticky
2           Green             Bitter
3           Purple            Bland


So the problem is that in the Query you can see Red shows up twice! I can't have this, and 
I'm not sure how to make the joins happen but stop reds from coming up twice.",sql,query,postgresql,,,,open,0,303,10,"How to tell in a Query I don't want duplicates? So I got this query and it's pulling from tables like this:

Plantation TABLE
PLANT ID,   Color Description 
1           Red
2           Green
3           Purple


Vegetable Table
VegetabkeID, PLANT ID, Feeldesc
199            1        Harsh
200            1        Sticky
201            2        Bitter
202            3        Bland


and now in my Query I join them using PLANT ID ( I Use a left join)

PLANT ID, Color Description, Feeldesc
1           Red               Harsh             
1           Red               Sticky
2           Green             Bitter
3           Purple            Bland


So the problem is that in the Query you can see Red shows up twice! I can't have this, and 
I'm not sure how to make the joins happen but stop reds from coming up twice.",3
808613,04/30/2009 19:20:19,60758,01/30/2009 18:49:07,1,0,Concatenate a selected column in a single query?,"I know you can do this, because I've seen it done once before, but I forget where and up until now I haven't need to do it.

I have a table called Employees, and it has various employee data (duh). I need a query that will do a select on the first and last name of all rows in the table, and then contenate all of them into a comma delimited string.

For example, I have a few rows (a lot more than that actually, but for the sake of this question just assume two) of data that look like:

FName LName
----- -----
Richard Prescott
Jill Sentieri
Carol Winger

I need to a select that can return the aforementioned data in this form:

Richard Prescott, Jill Sentieri, Carol Winger

Thank you in advance for your help!",sql,server,concatenation,select,,,open,0,127,8,"Concatenate a selected column in a single query? I know you can do this, because I've seen it done once before, but I forget where and up until now I haven't need to do it.

I have a table called Employees, and it has various employee data (duh). I need a query that will do a select on the first and last name of all rows in the table, and then contenate all of them into a comma delimited string.

For example, I have a few rows (a lot more than that actually, but for the sake of this question just assume two) of data that look like:

FName LName
----- -----
Richard Prescott
Jill Sentieri
Carol Winger

I need to a select that can return the aforementioned data in this form:

Richard Prescott, Jill Sentieri, Carol Winger

Thank you in advance for your help!",4
6356263,06/15/2011 10:22:47,294642,03/16/2010 10:29:58,1644,50,SQL: How do I port sql server database via t-sql scripts,"I have to port sql server (2008) database with t-sql scripts. I can generate ""create"" script per each database object (stored procedure, table) from Sql Server Management Studio (though it looks to take much time) 

How do I port data for tables? I'd like to have scripts like that:

    INSERT INTO ... VALUES(...)
    INSERT INTO ... VALUES(...)
    INSERT INTO ... VALUES(...)
    ...


Can I generate such scripts from Sql Server Management Studio or is there some free 3'rd party utility for that? (I guess there should be). 

Thank you in advance! 


",sql,sql-server,tsql,ssms,,,open,0,103,11,"SQL: How do I port sql server database via t-sql scripts I have to port sql server (2008) database with t-sql scripts. I can generate ""create"" script per each database object (stored procedure, table) from Sql Server Management Studio (though it looks to take much time) 

How do I port data for tables? I'd like to have scripts like that:

    INSERT INTO ... VALUES(...)
    INSERT INTO ... VALUES(...)
    INSERT INTO ... VALUES(...)
    ...


Can I generate such scripts from Sql Server Management Studio or is there some free 3'rd party utility for that? (I guess there should be). 

Thank you in advance! 


",4
6845297,07/27/2011 13:40:02,865508,07/27/2011 13:40:02,1,0,SQL Count distinct absence periods of students,"I'm looking for a way to count the distincts periods students have been absence:

Each time a student turns in an absence I create a record in the absence table, some absences can overlap, some prolounge a previous absence.

StuId    StrPer       EndPer
------   -----------  -----------
111111   2011-01-10   2011-01-15
222222   2011-02-01   2011-02-05
222222   2011-02-06   2011-02-08
333333   2011-04-07   2011-04-14
444444   2011-04-20   2011-04-25
444444   2011-04-23   2011-04-28
111111   2011-05-01   2011-05-03

Now I want to count the number of unique absence periods, the result should be:

StuId   NbrAbs
------  ------
111111  2
222222  1
333333  1
444444  1

Who can help me with a query for this.

Thx in advance and sorry for my bad english...

Christophe",sql,,,,,,open,0,139,7,"SQL Count distinct absence periods of students I'm looking for a way to count the distincts periods students have been absence:

Each time a student turns in an absence I create a record in the absence table, some absences can overlap, some prolounge a previous absence.

StuId    StrPer       EndPer
------   -----------  -----------
111111   2011-01-10   2011-01-15
222222   2011-02-01   2011-02-05
222222   2011-02-06   2011-02-08
333333   2011-04-07   2011-04-14
444444   2011-04-20   2011-04-25
444444   2011-04-23   2011-04-28
111111   2011-05-01   2011-05-03

Now I want to count the number of unique absence periods, the result should be:

StuId   NbrAbs
------  ------
111111  2
222222  1
333333  1
444444  1

Who can help me with a query for this.

Thx in advance and sorry for my bad english...

Christophe",1
11613305,07/23/2012 13:16:01,1485882,06/27/2012 13:56:55,1,1,Any good pie charts?,"Does anyone know a good, fairly easy to use, pie chart for use in html which I can link to an SQL Data Source?

Ive only really found ones which need json, php, or jquery, and I'm new to all of this so need the quickest and easiest solution. 

I was using the kendo ui dataviz pie chart but can't work that out, and I've also tried the telerik:RadHtmlChart but had no luck so far as the database I'm using has multiple fields!

Thanks in advance!",sql,telerik,pie-chart,kendo-ui,,07/23/2012 14:39:41,not constructive,1,84,4,"Any good pie charts? Does anyone know a good, fairly easy to use, pie chart for use in html which I can link to an SQL Data Source?

Ive only really found ones which need json, php, or jquery, and I'm new to all of this so need the quickest and easiest solution. 

I was using the kendo ui dataviz pie chart but can't work that out, and I've also tried the telerik:RadHtmlChart but had no luck so far as the database I'm using has multiple fields!

Thanks in advance!",4
349092,12/08/2008 10:28:59,23230,09/28/2008 17:59:50,171,3,Can a sql server table have two identity columns?,I need to have one column as the primary key and another to auto increment an order number field. Is this possible?,sql,,,,,,open,0,22,9,Can a sql server table have two identity columns? I need to have one column as the primary key and another to auto increment an order number field. Is this possible?,1
3161036,07/01/2010 19:28:04,117700,06/04/2009 23:04:34,2041,5,ms-access: query (concat multiple records into one),"here's a glimpse of the original table:

    Occurrence Number	Occurrence Date	1 0 Preanalytical (Before Testing)	Cup Type	2 0 Analytical (Testing Phase)	2 0 Area	3 0 Postanalytical ( After Testing)	4 0 Other	Practice Code	Comments
    1477	2/5/2010	1.1 Specimen Mislabeled						PURSLEY	
    1476	2/5/2010	1.1 Specimen Mislabeled						HPMR	
    1475	2/5/2010	1.1 Specimen Mislabeled						ACCIM	N008710
    1474	2/5/2010	1.1 Specimen Mislabeled						ACCIM	N008636
    1473	2/5/2010	1.3 QNS-Quantity Not Sufficient						SAPMC	
    1472	2/5/2010	1.3 QNS-Quantity Not Sufficient						RMG	
    1471	2/5/2010	1.1 Specimen Mislabeled						NMED	
    1470	2/5/2010	1.9 QNS- Specimen Spilled in transit						MRPS	
    1469	2/5/2010	1.9 QNS- Specimen Spilled in transit						ANESPC	
    1468	2/5/2010			2.22 Instrument Problem-reinject				LAB	
    1525	2/8/2010			2.5 Other - False (+) Blanks	Tecan 2			LAB	
    1524	2/8/2010			2.5 Other - False (+) Blanks	Tecan #1			LAB	Blank 019
    1523	2/8/2010			2.22 Instrument Problem, 2.5 Other	Tecan			LAB	
    1519	2/8/2010					3.3A Reporting Error	4.1 LIS Problem? (see LOM 1418,1520)	LAB/SJC	F356028
    1518	2/8/2010	1.4 Tests Missed/Wrong Test Ordered						SDPTC	F316628
    1516	2/8/2010	1.6 Test Requisition Missing						TPMCF	2 specimens both unlabeled
    1515	2/8/2010	1.1 Specimen Mislabeled						PALMETTO	
    1514	2/8/2010	1.1 Specimen Mislabeled						THWR	
    1513	2/8/2010	1.1 Specimen Mislabeled						THWR	


**i am getting information from this table using the following statement:**


    select mid(Lom1,1,4) as LOM, sum([Count1]) as [Count] from (
    
    SELECT [Lab Occurrence Form].[1 0 Preanalytical (Before Testing)] as Lom1,Count([Lab Occurrence Form].[1 0 Preanalytical (Before Testing)]) AS [Count1]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY [Lab Occurrence Form].[1 0 Preanalytical (Before Testing)]
    HAVING Count([Lab Occurrence Form].[1 0 Preanalytical (Before Testing)])<>0
    
    UNION SELECT [Lab Occurrence Form].[2 0 Analytical (Testing Phase)], Count([Lab Occurrence Form].[2 0 Analytical (Testing Phase)]) AS [CountOf2 0 Analytical (Testing Phase)]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY [Lab Occurrence Form].[2 0 Analytical (Testing Phase)]
    HAVING Count([Lab Occurrence Form].[2 0 Analytical (Testing Phase)])<>0
    
    union
    
    SELECT  [Lab Occurrence Form].[3 0 Postanalytical ( After Testing)], Count([Lab Occurrence Form].[3 0 Postanalytical ( After Testing)]) AS [CountOf3 0 Postanalytical ( After Testing)]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY  [Lab Occurrence Form].[3 0 Postanalytical ( After Testing)]
    HAVING Count([Lab Occurrence Form].[3 0 Postanalytical ( After Testing)])<>0
    
    UNION SELECT [Lab Occurrence Form].[4 0 Other], Count([Lab Occurrence Form].[4 0 Other]) AS [CountOf4 0 Other]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY [Lab Occurrence Form].[4 0 Other]
    HAVING Count([Lab Occurrence Form].[4 0 Other])<>0
    ORDER BY 1, 2)
    
    group by mid(Lom1,1,4);



**this is what the query returns:**


    LOM	Count
    1.1 	231
    1.11	21
    1.3 	103
    1.4 	6
    1.5 	1
    1.6 	25
    1.8 	2
    1.9 	88
    2.1 	8
    2.22	5
    2.24	1
    2.3 	1
    2.4 	1
    2.5 	29
    3.2 	13
    3.3 	8
    3.3A	4
    4.1 	2
    4.6 	1
    4.8 	7


i need to add another column here. let's say it is `column3`

this is the output that need:

    LOM	Count	column3
    1.1 	231	everything from original table where LOM LIKE *1.1* separated by "",""
    1.11	21	everything from original table where LOM=1.11 separated by "",""
    1.3 	103	everything from original table where LOM=1.3 separated by "",""
    1.4 	6	everything from original table where LOM=1.4 separated by "",""
    1.5 	1	everything from original table where LOM=1.5 separated by "",""
    1.6 	25	
    1.8 	2	
    1.9 	88	
    2.1 	8	
    2.22	5	
    2.24	1	
    2.3 	1	
    2.4 	1	
    2.5 	29	
    3.2 	13	
    3.3 	8	
    3.3A	4	
    4.1 	2	
    4.6 	1	
    4.8 	7	
    prac	1	
		


that would mean the first element in column 3 would be ""something1, something2, etc...somethingelse231""

i apologize if this explanation is horrible, please let me know if i can clarify anything",sql,ms-access,,,,,open,0,794,7,"ms-access: query (concat multiple records into one) here's a glimpse of the original table:

    Occurrence Number	Occurrence Date	1 0 Preanalytical (Before Testing)	Cup Type	2 0 Analytical (Testing Phase)	2 0 Area	3 0 Postanalytical ( After Testing)	4 0 Other	Practice Code	Comments
    1477	2/5/2010	1.1 Specimen Mislabeled						PURSLEY	
    1476	2/5/2010	1.1 Specimen Mislabeled						HPMR	
    1475	2/5/2010	1.1 Specimen Mislabeled						ACCIM	N008710
    1474	2/5/2010	1.1 Specimen Mislabeled						ACCIM	N008636
    1473	2/5/2010	1.3 QNS-Quantity Not Sufficient						SAPMC	
    1472	2/5/2010	1.3 QNS-Quantity Not Sufficient						RMG	
    1471	2/5/2010	1.1 Specimen Mislabeled						NMED	
    1470	2/5/2010	1.9 QNS- Specimen Spilled in transit						MRPS	
    1469	2/5/2010	1.9 QNS- Specimen Spilled in transit						ANESPC	
    1468	2/5/2010			2.22 Instrument Problem-reinject				LAB	
    1525	2/8/2010			2.5 Other - False (+) Blanks	Tecan 2			LAB	
    1524	2/8/2010			2.5 Other - False (+) Blanks	Tecan #1			LAB	Blank 019
    1523	2/8/2010			2.22 Instrument Problem, 2.5 Other	Tecan			LAB	
    1519	2/8/2010					3.3A Reporting Error	4.1 LIS Problem? (see LOM 1418,1520)	LAB/SJC	F356028
    1518	2/8/2010	1.4 Tests Missed/Wrong Test Ordered						SDPTC	F316628
    1516	2/8/2010	1.6 Test Requisition Missing						TPMCF	2 specimens both unlabeled
    1515	2/8/2010	1.1 Specimen Mislabeled						PALMETTO	
    1514	2/8/2010	1.1 Specimen Mislabeled						THWR	
    1513	2/8/2010	1.1 Specimen Mislabeled						THWR	


**i am getting information from this table using the following statement:**


    select mid(Lom1,1,4) as LOM, sum([Count1]) as [Count] from (
    
    SELECT [Lab Occurrence Form].[1 0 Preanalytical (Before Testing)] as Lom1,Count([Lab Occurrence Form].[1 0 Preanalytical (Before Testing)]) AS [Count1]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY [Lab Occurrence Form].[1 0 Preanalytical (Before Testing)]
    HAVING Count([Lab Occurrence Form].[1 0 Preanalytical (Before Testing)])<>0
    
    UNION SELECT [Lab Occurrence Form].[2 0 Analytical (Testing Phase)], Count([Lab Occurrence Form].[2 0 Analytical (Testing Phase)]) AS [CountOf2 0 Analytical (Testing Phase)]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY [Lab Occurrence Form].[2 0 Analytical (Testing Phase)]
    HAVING Count([Lab Occurrence Form].[2 0 Analytical (Testing Phase)])<>0
    
    union
    
    SELECT  [Lab Occurrence Form].[3 0 Postanalytical ( After Testing)], Count([Lab Occurrence Form].[3 0 Postanalytical ( After Testing)]) AS [CountOf3 0 Postanalytical ( After Testing)]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY  [Lab Occurrence Form].[3 0 Postanalytical ( After Testing)]
    HAVING Count([Lab Occurrence Form].[3 0 Postanalytical ( After Testing)])<>0
    
    UNION SELECT [Lab Occurrence Form].[4 0 Other], Count([Lab Occurrence Form].[4 0 Other]) AS [CountOf4 0 Other]
    FROM [Lab Occurrence Form]
    WHERE ((([Lab Occurrence Form].[Occurrence Date]) Between [Forms]![Meeting_Reasons_Frequency]![Text4] And [Forms]![Meeting_Reasons_Frequency]![Text2]))
    GROUP BY [Lab Occurrence Form].[4 0 Other]
    HAVING Count([Lab Occurrence Form].[4 0 Other])<>0
    ORDER BY 1, 2)
    
    group by mid(Lom1,1,4);



**this is what the query returns:**


    LOM	Count
    1.1 	231
    1.11	21
    1.3 	103
    1.4 	6
    1.5 	1
    1.6 	25
    1.8 	2
    1.9 	88
    2.1 	8
    2.22	5
    2.24	1
    2.3 	1
    2.4 	1
    2.5 	29
    3.2 	13
    3.3 	8
    3.3A	4
    4.1 	2
    4.6 	1
    4.8 	7


i need to add another column here. let's say it is `column3`

this is the output that need:

    LOM	Count	column3
    1.1 	231	everything from original table where LOM LIKE *1.1* separated by "",""
    1.11	21	everything from original table where LOM=1.11 separated by "",""
    1.3 	103	everything from original table where LOM=1.3 separated by "",""
    1.4 	6	everything from original table where LOM=1.4 separated by "",""
    1.5 	1	everything from original table where LOM=1.5 separated by "",""
    1.6 	25	
    1.8 	2	
    1.9 	88	
    2.1 	8	
    2.22	5	
    2.24	1	
    2.3 	1	
    2.4 	1	
    2.5 	29	
    3.2 	13	
    3.3 	8	
    3.3A	4	
    4.1 	2	
    4.6 	1	
    4.8 	7	
    prac	1	
		


that would mean the first element in column 3 would be ""something1, something2, etc...somethingelse231""

i apologize if this explanation is horrible, please let me know if i can clarify anything",2
9668707,03/12/2012 14:15:16,1186009,02/02/2012 19:46:14,59,0,SQL Server 2008 Import/Export data,"New to SQL Server and not very well-versed in how things run with it.  Can anyone point me to what exactly this error means? http://imgur.com/cVRT9
It happens when I try to select a database name when importing data.",sql,sql-server,,,,03/12/2012 14:27:44,off topic,1,38,5,"SQL Server 2008 Import/Export data New to SQL Server and not very well-versed in how things run with it.  Can anyone point me to what exactly this error means? http://imgur.com/cVRT9
It happens when I try to select a database name when importing data.",2
10145413,04/13/2012 17:23:02,1054727,11/18/2011 23:02:41,82,0,getting sql records,"when i run this code, it returns the topic fine...

    $query = mysql_query(""SELECT topic
    FROM question 
    WHERE id = '$id'"");
    	if(mysql_num_rows($query) > 0) {
    		$row = mysql_fetch_array($query) or die(mysql_error());
    		$topic = $row['topic'];
    	}

but when I change it to this, it doesn't run at all.  why is this happening?

    $query = mysql_query(""SELECT topic, lock
    FROM question 
    WHERE id = '$id'"");
    	if(mysql_num_rows($query) > 0) {
    		$row = mysql_fetch_array($query) or die(mysql_error());
    		$topic = $row['topic'];
    		$lockedThread = $row['lock'];
    		echo ""here: "" . $lockedThread;
    	}",sql,,,,,04/18/2012 19:51:49,too localized,1,131,3,"getting sql records when i run this code, it returns the topic fine...

    $query = mysql_query(""SELECT topic
    FROM question 
    WHERE id = '$id'"");
    	if(mysql_num_rows($query) > 0) {
    		$row = mysql_fetch_array($query) or die(mysql_error());
    		$topic = $row['topic'];
    	}

but when I change it to this, it doesn't run at all.  why is this happening?

    $query = mysql_query(""SELECT topic, lock
    FROM question 
    WHERE id = '$id'"");
    	if(mysql_num_rows($query) > 0) {
    		$row = mysql_fetch_array($query) or die(mysql_error());
    		$topic = $row['topic'];
    		$lockedThread = $row['lock'];
    		echo ""here: "" . $lockedThread;
    	}",1
11687797,07/27/2012 12:30:32,1333866,04/14/2012 22:40:12,62,0,Why are the rows missing?,"Is there any tool or method or something else which can help me with analysis of the process.
The process contains around 15 steps and each job step is represented with one SQL script. I am working with Teradata.
Here is my problem - the colleague of mine has changed one of the SQL scripts. This change caused some addition of some new rows. The problem is - the added rows are not seen at the end of the process in the final report.
Since there are a lot of tables, joins, filtering inside this process (15 sql scripts) I can#t grasp all the process and find the answer why are those rows missing in the final report?
THerefore, is there any piece of software, method or some suggestion from your side about what should I do to find the answer on the question ""Why are the rows missing""

Thanks, D.",sql,database,teradata,,,07/28/2012 20:29:30,not constructive,1,146,5,"Why are the rows missing? Is there any tool or method or something else which can help me with analysis of the process.
The process contains around 15 steps and each job step is represented with one SQL script. I am working with Teradata.
Here is my problem - the colleague of mine has changed one of the SQL scripts. This change caused some addition of some new rows. The problem is - the added rows are not seen at the end of the process in the final report.
Since there are a lot of tables, joins, filtering inside this process (15 sql scripts) I can#t grasp all the process and find the answer why are those rows missing in the final report?
THerefore, is there any piece of software, method or some suggestion from your side about what should I do to find the answer on the question ""Why are the rows missing""

Thanks, D.",3
4222585,11/19/2010 06:20:19,359047,06/05/2010 05:50:22,32,1,SQL Server 2005,which version of SQL Server 2005 supports four CPUs?,sql,sql-server-2005,server,,,11/19/2010 16:21:03,not a real question,1,9,3,SQL Server 2005 which version of SQL Server 2005 supports four CPUs?,3
9761296,03/18/2012 19:00:13,602348,02/03/2011 22:21:16,16,0,Database system for high speed insert,"I am implementing a system with the following requirements:

 - A process constantly inserts data in a daily table at very high speed (10K rows / sec). There is one table per day. The data inserted is never updated or deleted.
 - The most recent of the daily tables above are queried from time to time and the queries need to be fast.
 - Once or twice per day some aggregation calculations are executed on the daily table. These calculations do not need to be very fast.

MySQL is not an option because of its licensing model and postgres is too slow. So, I am looking into any other database system, possibly with a small footprint. Any suggestions?

Thank you.",sql,,,,,03/18/2012 22:27:43,not constructive,1,118,6,"Database system for high speed insert I am implementing a system with the following requirements:

 - A process constantly inserts data in a daily table at very high speed (10K rows / sec). There is one table per day. The data inserted is never updated or deleted.
 - The most recent of the daily tables above are queried from time to time and the queries need to be fast.
 - Once or twice per day some aggregation calculations are executed on the daily table. These calculations do not need to be very fast.

MySQL is not an option because of its licensing model and postgres is too slow. So, I am looking into any other database system, possibly with a small footprint. Any suggestions?

Thank you.",1
10514388,05/09/2012 10:38:16,1287366,03/23/2012 02:32:50,25,0,Assistance with an SQL function,"This past week I was given an SQL lab involving functions. My knowledge of SQL pre-dating this lab was minimal at best and am having a hard time getting my head around a particular function.

Four tables:

![enter image description here][1]


  [1]: http://i.stack.imgur.com/nP8Rg.jpg


I am to create a stored function called teamsize which returns the number of players in a given teams name for a particular year. The team name is to be supplied as a parameter passed to the function. To my knowledge a join is required but that is about all I know.

Any help is appreciated",sql,homework,function,join,,05/10/2012 03:58:54,not a real question,1,96,5,"Assistance with an SQL function This past week I was given an SQL lab involving functions. My knowledge of SQL pre-dating this lab was minimal at best and am having a hard time getting my head around a particular function.

Four tables:

![enter image description here][1]


  [1]: http://i.stack.imgur.com/nP8Rg.jpg


I am to create a stored function called teamsize which returns the number of players in a given teams name for a particular year. The team name is to be supplied as a parameter passed to the function. To my knowledge a join is required but that is about all I know.

Any help is appreciated",4
10012426,04/04/2012 13:47:01,1213555,02/16/2012 10:11:09,8,0,Joining 4 queries,"I have to create a query which on the entry of the user_name should display the responsibilities under that particular user_name. How can I do that?
The tables that should be used are:
FND_USER
FND_RESPONSIBILITITY_VL
FND_APPLICATION_VL
FND_USER_RESP_GROUPS_DIRECT

Please help...
the username is the mandatory field. ",sql,,,,,04/05/2012 08:40:05,not a real question,1,39,3,"Joining 4 queries I have to create a query which on the entry of the user_name should display the responsibilities under that particular user_name. How can I do that?
The tables that should be used are:
FND_USER
FND_RESPONSIBILITITY_VL
FND_APPLICATION_VL
FND_USER_RESP_GROUPS_DIRECT

Please help...
the username is the mandatory field. ",1
7488765,09/20/2011 16:50:45,679475,03/28/2011 00:13:13,31,8,How To Query A VB.NET Datasource,"I have added a Datasoruce to my current project and the following has been added to my App.config file:

    <connectionStrings>
            <add name=""WindowsApplication1.My.MySettings.dbConnectionString""
                connectionString=""Provider=Microsoft.ACE.OLEDB.12.0;Data Source=|DataDirectory|\db.accdb""
                providerName=""System.Data.OleDb"" />
        </connectionStrings>

How can I now query and update this datasource?

I have the following query:

    Dim sqlstr As String = ""INSERT INTO Accounts(Username,Password)VALUES('"" & Trim(Account(0)) & ""','"" & Trim(Account(1)) & ""')""

But am not too sure how to actually run the query (New to VB, used to PHP and a single database connection file!)",sql,vb.net,visual-studio,visual-studio-2010,vb,,open,0,131,6,"How To Query A VB.NET Datasource I have added a Datasoruce to my current project and the following has been added to my App.config file:

    <connectionStrings>
            <add name=""WindowsApplication1.My.MySettings.dbConnectionString""
                connectionString=""Provider=Microsoft.ACE.OLEDB.12.0;Data Source=|DataDirectory|\db.accdb""
                providerName=""System.Data.OleDb"" />
        </connectionStrings>

How can I now query and update this datasource?

I have the following query:

    Dim sqlstr As String = ""INSERT INTO Accounts(Username,Password)VALUES('"" & Trim(Account(0)) & ""','"" & Trim(Account(1)) & ""')""

But am not too sure how to actually run the query (New to VB, used to PHP and a single database connection file!)",5
8052499,11/08/2011 15:04:58,1088313,01/19/2011 04:08:55,156,0,Setting a variable,"Well I have a few questions and I like to make sure I am understanding what I am doing. So here it is I am working on a project and I am suppose to Create a variable called MinOrder and populate it with the smallest line item amount after discount for the Northwind CustomerNo ‘ALFKI’ (Careful: we’re dealing with currency here, so don’t just assume you’re going to use an int.) Output the final value of MinOrder. Now this is what I have:

 

       Use Northwind
    Declare @MinOrder money;
    Set @MinOrder = (Select MIN(UnitPrice) From [Order Details]);
    Select @MinOrder

I notice that I didn't put in the ALFKI. Well I seen it said not use really use the int. I went and declare the minorder because it does with a variable and then I am taking that variable using it for the unitprice even though it says discount but when I try to put discount there it showed a red error. I am wounder if I should use another set to do the customerId = ALFKI or if I can throw it into this code. I know my code might be way off but thats why I am posting it so I can have an understanding when it comes to this only because it is a part of programming. Thanks",sql,homework,,,,,open,0,234,3,"Setting a variable Well I have a few questions and I like to make sure I am understanding what I am doing. So here it is I am working on a project and I am suppose to Create a variable called MinOrder and populate it with the smallest line item amount after discount for the Northwind CustomerNo ‘ALFKI’ (Careful: we’re dealing with currency here, so don’t just assume you’re going to use an int.) Output the final value of MinOrder. Now this is what I have:

 

       Use Northwind
    Declare @MinOrder money;
    Set @MinOrder = (Select MIN(UnitPrice) From [Order Details]);
    Select @MinOrder

I notice that I didn't put in the ALFKI. Well I seen it said not use really use the int. I went and declare the minorder because it does with a variable and then I am taking that variable using it for the unitprice even though it says discount but when I try to put discount there it showed a red error. I am wounder if I should use another set to do the customerId = ALFKI or if I can throw it into this code. I know my code might be way off but thats why I am posting it so I can have an understanding when it comes to this only because it is a part of programming. Thanks",2
6510700,06/28/2011 17:34:42,804379,06/18/2011 09:10:10,1,0,Sql update command,"please if you can help me i have a problem with my sql command

the code is as follows

'UPDATE       ReviewPaperCriteria
SET                Grate=@id 
WHERE        (Reveiw_paper_id = Criteria_ID);'  

thanks in advance",sql,sql-server-2008,,,,06/28/2011 18:57:54,not a real question,1,56,3,"Sql update command please if you can help me i have a problem with my sql command

the code is as follows

'UPDATE       ReviewPaperCriteria
SET                Grate=@id 
WHERE        (Reveiw_paper_id = Criteria_ID);'  

thanks in advance",2
4795836,01/25/2011 16:08:37,39590,11/21/2008 07:45:38,3513,109,"Ordered insertion at next unused index, generic SQL","There have been various similar questions, but they either referred to a too specific DB or assumed unsorted data.

In my case, the SQL should be portable if possible. The index column in question is a clustered PK containing a timestamp.

The timestamp is 99% of the time larger than previously inserted value. On rare occasions however, it can be smaller, or collide with an existing value.

I'm currently using this code to insert new values:

    IF NOT EXISTS (select * from Foo where Timestamp = @ts) BEGIN
    	INSERT INTO Foo ([Timestamp]) VALUES (@ts);
    END
    ELSE BEGIN
    	INSERT INTO Foo ([Timestamp]) VALUES (
    	(SELECT Max (t1.Timestamp) - 1
    	FROM Foo t1
    	WHERE Timestamp < @ts
    	AND NOT EXISTS (select * from Foo t2 where t2.Timestamp = t1.Timestamp - 1))
    	);
    END;

If the row is unused yet, just insert. Else, find the closest free row with a smaller value using an `EXISTS` check.

I am a novice when it comes to databases, so I'm not sure if there is a better way. I'm open for any ideas to make the code simpler and/or faster (around 100-1000 insertions per second), or to use a different approach altogether.
",sql,sql-server,algorithm,query,index,,open,0,224,8,"Ordered insertion at next unused index, generic SQL There have been various similar questions, but they either referred to a too specific DB or assumed unsorted data.

In my case, the SQL should be portable if possible. The index column in question is a clustered PK containing a timestamp.

The timestamp is 99% of the time larger than previously inserted value. On rare occasions however, it can be smaller, or collide with an existing value.

I'm currently using this code to insert new values:

    IF NOT EXISTS (select * from Foo where Timestamp = @ts) BEGIN
    	INSERT INTO Foo ([Timestamp]) VALUES (@ts);
    END
    ELSE BEGIN
    	INSERT INTO Foo ([Timestamp]) VALUES (
    	(SELECT Max (t1.Timestamp) - 1
    	FROM Foo t1
    	WHERE Timestamp < @ts
    	AND NOT EXISTS (select * from Foo t2 where t2.Timestamp = t1.Timestamp - 1))
    	);
    END;

If the row is unused yet, just insert. Else, find the closest free row with a smaller value using an `EXISTS` check.

I am a novice when it comes to databases, so I'm not sure if there is a better way. I'm open for any ideas to make the code simpler and/or faster (around 100-1000 insertions per second), or to use a different approach altogether.
",5
11268364,06/29/2012 20:12:33,780257,06/01/2011 22:07:42,16,0,SQL Server DateTime out of order,"Good Afternoon, 

Having a small issue with my SQL Queries (posted below above data example).  I am taking raw data, grouping them by the hour.  However when I run the queries that are below: I get the error below, where the 6/22/2012 shows up in between 6/21/2012 data.  

SQL Query:

    INSERT INTO AverageRawData(DateTime,
    SCR1_EXHAUST_GAS_TEMP,SCR1_NOX_LEVEL,SCR1_NH3_FLOW_RATE,SCR1_O2_LEVEL,SCR1_NOx,
    SCR2_EXHAUST_GAS_TEMP,SCR2_NOX_LEVEL,SCR2_NH3_FLOW_RATE,SCR2_O2_LEVEL,SCR2_NOx,
    SCR3_EXHAUST_GAS_TEMP,SCR3_NOX_LEVEL,SCR3_NH3_FLOW_RATE,SCR3_O2_LEVEL,SCR3_NOx,
    SCR4_EXHAUST_GAS_TEMP,SCR4_NOX_LEVEL,SCR4_NH3_FLOW_RATE,SCR4_O2_LEVEL,SCR4_NOx,
    CAT1_FUEL_FLOW_RATE,CAT2_FUEL_FLOW_RATE,CAT3_FUEL_FLOW_RATE,VOLVO1_FUEL_FLOW_RATE,VOLVO2_FUEL_FLOW_RATE,VOLVO3_FUEL_FLOW_RATE,VOLVO4_FUEL_FLOW_RATE,VOLVO5_FUEL_FLOW_RATE,
    TOTAL_NOx)
    SELECT MIN(Datetime),
    AVG(Convert(decimal(10,3),SCR1_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR1_NOX_LEVEL)     ),AVG(Convert(decimal(10,3),SCR1_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR1_O2_LEVEL)),    AVG(Convert(decimal(10,3),SCR1_NOx)),
    AVG(Convert(decimal(10,3),SCR2_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR2_NOX_LEVEL)     ),AVG(Convert(decimal(10,3),SCR2_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR2_O2_LEVEL)),     AVG(Convert(decimal(10,3),SCR2_NOx)),
    AVG(Convert(decimal(10,3),SCR3_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR3_NOX_LEVEL)    ),AVG(Convert(decimal(10,3),SCR3_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR3_O2_LEVEL)),    AVG(Convert(decimal(10,3),SCR3_NOx)),
    AVG(Convert(decimal(10,3),SCR4_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR4_NOX_LEVEL)    ),AVG(Convert(decimal(10,3),SCR4_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR4_O2_LEVEL)),    AVG(Convert(decimal(10,3),SCR4_NOx)),
    AVG(Convert(decimal(10,3),CAT1_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),CAT2_FUEL_FLOW_RA    TE)),AVG(Convert(decimal(10,3),CAT3_FUEL_FLOW_RATE)),
    AVG(Convert(decimal(10,3),VOLVO1_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),VOLVO2_FUEL_FLO    W_RATE)),AVG(Convert(decimal(10,3),VOLVO3_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),VOLVO4_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),VOLVO5_FUEL_FLOW_RATE)),
    AVG(Convert(decimal(10,3),TOTAL_NOx))
    FROM jmusa_LOG1 
    GROUP BY DATEPART(D,jmusa_LOG1.DateTime),DATEPART(HH,jmusa_LOG1.DateTime)
    HAVING MIN(jmusa_LOG1.DateTime) NOT IN(SELECT DateTime FROM AverageRawData)
    ORDER BY MIN(DateTime)


6/21/2012
6/21/2012 1:00
6/21/2012 2:00
6/21/2012 3:00
6/21/2012 4:00
6/21/2012 5:00
6/21/2012 6:00
6/21/2012 7:00
**6/22/2012 5:00
6/22/2012 6:00
6/22/2012 7:00
6/22/2012 8:00
6/22/2012 9:00
6/22/2012 10:00
6/22/2012 11:00
6/22/2012 12:00
6/22/2012 13:00
6/22/2012 14:00**
6/21/2012 8:00
6/21/2012 9:00
6/21/2012 10:00
6/21/2012 11:00
6/21/2012 12:00
6/21/2012 13:00
6/21/2012 14:00
6/21/2012 15:00
6/21/2012 16:00
6/21/2012 17:00
6/21/2012 18:00
6/21/2012 19:00
6/21/2012 20:00
6/21/2012 21:00
6/21/2012 22:00
6/21/2012 23:00
6/22/2012
6/22/2012 1:00
6/22/2012 2:00
6/22/2012 3:00
6/22/2012 4:00
6/22/2012 15:00
6/22/2012 16:00
6/22/2012 17:00
6/22/2012 18:00
6/22/2012 19:00
6/22/2012 20:00
6/22/2012 21:00
6/22/2012 22:00
6/22/2012 23:00
",sql,sql-server,sql-server-2008,datetime,datepart,06/30/2012 22:52:53,not a real question,1,233,6,"SQL Server DateTime out of order Good Afternoon, 

Having a small issue with my SQL Queries (posted below above data example).  I am taking raw data, grouping them by the hour.  However when I run the queries that are below: I get the error below, where the 6/22/2012 shows up in between 6/21/2012 data.  

SQL Query:

    INSERT INTO AverageRawData(DateTime,
    SCR1_EXHAUST_GAS_TEMP,SCR1_NOX_LEVEL,SCR1_NH3_FLOW_RATE,SCR1_O2_LEVEL,SCR1_NOx,
    SCR2_EXHAUST_GAS_TEMP,SCR2_NOX_LEVEL,SCR2_NH3_FLOW_RATE,SCR2_O2_LEVEL,SCR2_NOx,
    SCR3_EXHAUST_GAS_TEMP,SCR3_NOX_LEVEL,SCR3_NH3_FLOW_RATE,SCR3_O2_LEVEL,SCR3_NOx,
    SCR4_EXHAUST_GAS_TEMP,SCR4_NOX_LEVEL,SCR4_NH3_FLOW_RATE,SCR4_O2_LEVEL,SCR4_NOx,
    CAT1_FUEL_FLOW_RATE,CAT2_FUEL_FLOW_RATE,CAT3_FUEL_FLOW_RATE,VOLVO1_FUEL_FLOW_RATE,VOLVO2_FUEL_FLOW_RATE,VOLVO3_FUEL_FLOW_RATE,VOLVO4_FUEL_FLOW_RATE,VOLVO5_FUEL_FLOW_RATE,
    TOTAL_NOx)
    SELECT MIN(Datetime),
    AVG(Convert(decimal(10,3),SCR1_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR1_NOX_LEVEL)     ),AVG(Convert(decimal(10,3),SCR1_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR1_O2_LEVEL)),    AVG(Convert(decimal(10,3),SCR1_NOx)),
    AVG(Convert(decimal(10,3),SCR2_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR2_NOX_LEVEL)     ),AVG(Convert(decimal(10,3),SCR2_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR2_O2_LEVEL)),     AVG(Convert(decimal(10,3),SCR2_NOx)),
    AVG(Convert(decimal(10,3),SCR3_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR3_NOX_LEVEL)    ),AVG(Convert(decimal(10,3),SCR3_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR3_O2_LEVEL)),    AVG(Convert(decimal(10,3),SCR3_NOx)),
    AVG(Convert(decimal(10,3),SCR4_EXHAUST_GAS_TEMP)),AVG(Convert(decimal(10,3),SCR4_NOX_LEVEL)    ),AVG(Convert(decimal(10,3),SCR4_NH3_FLOW_RATE)),AVG(Convert(decimal(10,3),SCR4_O2_LEVEL)),    AVG(Convert(decimal(10,3),SCR4_NOx)),
    AVG(Convert(decimal(10,3),CAT1_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),CAT2_FUEL_FLOW_RA    TE)),AVG(Convert(decimal(10,3),CAT3_FUEL_FLOW_RATE)),
    AVG(Convert(decimal(10,3),VOLVO1_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),VOLVO2_FUEL_FLO    W_RATE)),AVG(Convert(decimal(10,3),VOLVO3_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),VOLVO4_FUEL_FLOW_RATE)),AVG(Convert(decimal(10,3),VOLVO5_FUEL_FLOW_RATE)),
    AVG(Convert(decimal(10,3),TOTAL_NOx))
    FROM jmusa_LOG1 
    GROUP BY DATEPART(D,jmusa_LOG1.DateTime),DATEPART(HH,jmusa_LOG1.DateTime)
    HAVING MIN(jmusa_LOG1.DateTime) NOT IN(SELECT DateTime FROM AverageRawData)
    ORDER BY MIN(DateTime)


6/21/2012
6/21/2012 1:00
6/21/2012 2:00
6/21/2012 3:00
6/21/2012 4:00
6/21/2012 5:00
6/21/2012 6:00
6/21/2012 7:00
**6/22/2012 5:00
6/22/2012 6:00
6/22/2012 7:00
6/22/2012 8:00
6/22/2012 9:00
6/22/2012 10:00
6/22/2012 11:00
6/22/2012 12:00
6/22/2012 13:00
6/22/2012 14:00**
6/21/2012 8:00
6/21/2012 9:00
6/21/2012 10:00
6/21/2012 11:00
6/21/2012 12:00
6/21/2012 13:00
6/21/2012 14:00
6/21/2012 15:00
6/21/2012 16:00
6/21/2012 17:00
6/21/2012 18:00
6/21/2012 19:00
6/21/2012 20:00
6/21/2012 21:00
6/21/2012 22:00
6/21/2012 23:00
6/22/2012
6/22/2012 1:00
6/22/2012 2:00
6/22/2012 3:00
6/22/2012 4:00
6/22/2012 15:00
6/22/2012 16:00
6/22/2012 17:00
6/22/2012 18:00
6/22/2012 19:00
6/22/2012 20:00
6/22/2012 21:00
6/22/2012 22:00
6/22/2012 23:00
",5
4382315,12/07/2010 22:32:14,107166,05/14/2009 15:39:11,542,42,Getting first record from two tables,"I am looking to get the first date with the customer and item description from the following example table

To create my example

    CREATE TABLE cust
    (
    CUSTNO int,
    ENAME varchar(50)
    )
    
    CREATE TABLE orders
    (
    CUSTNO int,
    Description varchar(50),
    ORDERDATE date
    )
    
    INSERT INTO cust VALUES (7369, 'SMITH');
    INSERT INTO cust VALUES (7499, 'ALLEN');
    INSERT INTO cust VALUES (7521, 'WARD');
    INSERT INTO cust VALUES (7566, 'JONES');
    INSERT INTO cust VALUES (7654, 'MARTIN');
    INSERT INTO cust VALUES (7698, 'BLAKE');
    INSERT INTO cust VALUES (7782, 'CLARK');
    INSERT INTO cust VALUES (7788, 'SCOTT');
    INSERT INTO cust VALUES (7839, 'KING');
    INSERT INTO cust VALUES (7844, 'TURNER');
    INSERT INTO cust VALUES (7876, 'ADAMS');
    INSERT INTO cust VALUES (7900, 'JAMES');
    INSERT INTO cust VALUES (7902, 'FORD');
    INSERT INTO cust VALUES (7934, 'MILLER');
    
    INSERT INTO orders VALUES (7782, 'Something','17-DEC-1980');
    INSERT INTO orders VALUES (7782, 'Something else', '17-DEC-2000');
    INSERT INTO orders VALUES (7900, 'Something', '17-DEC-1980');
    INSERT INTO orders VALUES (7900, 'Something else','17-DEC-1990');
    INSERT INTO orders VALUES (7934, 'Something','17-DEC-1980');

 Was trying something like this

      select [ENAME],[cust].[CUSTNO], MIN([ORDERDATE]),[Description]
      from [cust],[orders]
      where [cust].[CUSTNO]=[orders].[CUSTNO]
      group by [cust].[CUSTNO],[ENAME],[Description]

My problem is this returns too many rows. I just want to see each customer and then list there first date (blank or null if there is no order).

Any ideas?",sql,query,,,,,open,0,326,6,"Getting first record from two tables I am looking to get the first date with the customer and item description from the following example table

To create my example

    CREATE TABLE cust
    (
    CUSTNO int,
    ENAME varchar(50)
    )
    
    CREATE TABLE orders
    (
    CUSTNO int,
    Description varchar(50),
    ORDERDATE date
    )
    
    INSERT INTO cust VALUES (7369, 'SMITH');
    INSERT INTO cust VALUES (7499, 'ALLEN');
    INSERT INTO cust VALUES (7521, 'WARD');
    INSERT INTO cust VALUES (7566, 'JONES');
    INSERT INTO cust VALUES (7654, 'MARTIN');
    INSERT INTO cust VALUES (7698, 'BLAKE');
    INSERT INTO cust VALUES (7782, 'CLARK');
    INSERT INTO cust VALUES (7788, 'SCOTT');
    INSERT INTO cust VALUES (7839, 'KING');
    INSERT INTO cust VALUES (7844, 'TURNER');
    INSERT INTO cust VALUES (7876, 'ADAMS');
    INSERT INTO cust VALUES (7900, 'JAMES');
    INSERT INTO cust VALUES (7902, 'FORD');
    INSERT INTO cust VALUES (7934, 'MILLER');
    
    INSERT INTO orders VALUES (7782, 'Something','17-DEC-1980');
    INSERT INTO orders VALUES (7782, 'Something else', '17-DEC-2000');
    INSERT INTO orders VALUES (7900, 'Something', '17-DEC-1980');
    INSERT INTO orders VALUES (7900, 'Something else','17-DEC-1990');
    INSERT INTO orders VALUES (7934, 'Something','17-DEC-1980');

 Was trying something like this

      select [ENAME],[cust].[CUSTNO], MIN([ORDERDATE]),[Description]
      from [cust],[orders]
      where [cust].[CUSTNO]=[orders].[CUSTNO]
      group by [cust].[CUSTNO],[ENAME],[Description]

My problem is this returns too many rows. I just want to see each customer and then list there first date (blank or null if there is no order).

Any ideas?",2
7087937,08/17/2011 04:25:04,191997,10/18/2009 12:36:17,3535,170,What are the principles for writing an optimized sql query?,"If somebody has best Practices for Query Optimization, please write it as an answer.",sql,sql-server,performance,query,,08/17/2011 04:42:45,not a real question,1,14,10,"What are the principles for writing an optimized sql query? If somebody has best Practices for Query Optimization, please write it as an answer.",4
11352876,07/05/2012 21:32:35,822208,06/30/2011 01:52:12,141,5,what replication option should I coose?,"Just looking for some feedback here, there are lots of replication options out there, and I'd like to try something that those more expert than I have found to be successful. Here's my scenario:

1 SQL STD 2008 R2 SP2, few desktop clients, many web-clients edit and read;  
1 SQL ENT 2008 R2 SP2, desktop clients only;

lots of SP's and triggers;

Many (but not all) tables have App-managed Primary key (not an identity!) and/or a GUID;

Many (but not all) tables that have a GUID, use that GUID in 1-n relationships with 1 or more tables;
Some app-managed tables have neither a PK or a GUID;

The schema of the app-managed tables and sp's cannot be changed in order to satisfy a replication requirement (e.g remove @@rowcount or add not for replication contraint to a PK);

I'd like to try to achieve two-way replication, as updates can occur at either end. Redundancy (hot-swap, failover) is not an issue for us, as our business strategey isn't dependent upon 5-9's uptime, instead the ability to recover from failures, which we can do very well. Real-time replication may be very limited due to horrific WAN performance, is log shipping a good solution here? The goal is to make a DB available to clients in two physcial locations whom cannot oridinarily communicate otherwise. In addition, having updates lag a few hours or even a day is not a roadblock, as long as we can force a synch if we need a more recent one. Icing on the cake would be the ability to have SQL express clients participate in this topology as well, giving our mobile clients the ability to grab a copy of the DB when they can, and check in edits when they can (again). 

I look forward to hearing how others have achieved this sort of environment. Thanks!",sql,sql-server,sql-server-2008,,,07/06/2012 04:06:01,off topic,1,302,6,"what replication option should I coose? Just looking for some feedback here, there are lots of replication options out there, and I'd like to try something that those more expert than I have found to be successful. Here's my scenario:

1 SQL STD 2008 R2 SP2, few desktop clients, many web-clients edit and read;  
1 SQL ENT 2008 R2 SP2, desktop clients only;

lots of SP's and triggers;

Many (but not all) tables have App-managed Primary key (not an identity!) and/or a GUID;

Many (but not all) tables that have a GUID, use that GUID in 1-n relationships with 1 or more tables;
Some app-managed tables have neither a PK or a GUID;

The schema of the app-managed tables and sp's cannot be changed in order to satisfy a replication requirement (e.g remove @@rowcount or add not for replication contraint to a PK);

I'd like to try to achieve two-way replication, as updates can occur at either end. Redundancy (hot-swap, failover) is not an issue for us, as our business strategey isn't dependent upon 5-9's uptime, instead the ability to recover from failures, which we can do very well. Real-time replication may be very limited due to horrific WAN performance, is log shipping a good solution here? The goal is to make a DB available to clients in two physcial locations whom cannot oridinarily communicate otherwise. In addition, having updates lag a few hours or even a day is not a roadblock, as long as we can force a synch if we need a more recent one. Icing on the cake would be the ability to have SQL express clients participate in this topology as well, giving our mobile clients the ability to grab a copy of the DB when they can, and check in edits when they can (again). 

I look forward to hearing how others have achieved this sort of environment. Thanks!",3
10767590,05/26/2012 15:40:11,254346,01/19/2010 20:11:54,404,8,"How would one build a relational database on a key-value store, a-la Berkeley DB's SQL interface?","I've been checking out Berkeley DB and was impressed to find that it supported a SQL interface that is ""nearly identical"" to SQLite.

http://docs.oracle.com/cd/E17076_02/html/bdb-sql/dbsqlbasics.html#identicalusage

I'm very curious, at a high-level, how this kind of interface might have been architected.  For instance:

- since values are ""transparent"", how do you efficiently query and sort by value
- how are limits and offsets performed efficiently on large result sets
- how would the keys be structured and serialized for good average-case performance",sql,nosql,relational-database,berkeley-db,,05/29/2012 13:23:09,not a real question,1,76,16,"How would one build a relational database on a key-value store, a-la Berkeley DB's SQL interface? I've been checking out Berkeley DB and was impressed to find that it supported a SQL interface that is ""nearly identical"" to SQLite.

http://docs.oracle.com/cd/E17076_02/html/bdb-sql/dbsqlbasics.html#identicalusage

I'm very curious, at a high-level, how this kind of interface might have been architected.  For instance:

- since values are ""transparent"", how do you efficiently query and sort by value
- how are limits and offsets performed efficiently on large result sets
- how would the keys be structured and serialized for good average-case performance",4
11268388,06/29/2012 20:14:30,793309,06/10/2011 19:51:10,407,15,Tool to generate worst-case data for a given SQL query,"I would like to populate some tables with a large amount of data, in order to empirically test the performance of an SQL query in the worst case scenario (well, as close to it as possible).

At first, I considered using random values. But this would require some manual adjustment to get anywhere close to true worst case. Unconstrained random values are no good for a worst case because they tend mostly to be unique -- an index on a single column will perform just as well as a compound index. On the other hand, random values chosen from too small a set will result in a large fraction of the rows being returned, which is uninteresting because it reflects not so much *search* performance as *list* performance.

I also considered just looking at EXPLAIN PLAN, but this is (1) not empirical, and (2) the explanation can vary depending on the data that you already have.

**Is there a tool that analyzes a given SQL query (and the db schema and ideally indexes), then generates a large data set (of a given size) that will cause the query to perform as close to worst-case as possible?**

Any RDBMS is fine.

I would also be interested in alternative approaches to this kind of analysis and testing.
",sql,database,performance,testing,optimization,,open,0,210,10,"Tool to generate worst-case data for a given SQL query I would like to populate some tables with a large amount of data, in order to empirically test the performance of an SQL query in the worst case scenario (well, as close to it as possible).

At first, I considered using random values. But this would require some manual adjustment to get anywhere close to true worst case. Unconstrained random values are no good for a worst case because they tend mostly to be unique -- an index on a single column will perform just as well as a compound index. On the other hand, random values chosen from too small a set will result in a large fraction of the rows being returned, which is uninteresting because it reflects not so much *search* performance as *list* performance.

I also considered just looking at EXPLAIN PLAN, but this is (1) not empirical, and (2) the explanation can vary depending on the data that you already have.

**Is there a tool that analyzes a given SQL query (and the db schema and ideally indexes), then generates a large data set (of a given size) that will cause the query to perform as close to worst-case as possible?**

Any RDBMS is fine.

I would also be interested in alternative approaches to this kind of analysis and testing.
",5
11504478,07/16/2012 12:37:53,1306836,04/01/2012 20:50:14,1,1,Cannot telnet SQL Server port 1433,"I have windows 2008 web server and SQL Server 2012 Enterprise installed on it.
I disabled windows firewalls and I'm sure that there isn't another firewall.
But still cannot telnet my server?

I enabled TCP/IP, named pipes etc... on SQL Server Configuration Manager.
Restart everything.

By the way I can telnet locally, th eproblem is remote connection.

Any idea why I cannot telnet?
Thanks in advance.",sql,connection,telnet,server,,07/16/2012 13:06:06,off topic,1,59,6,"Cannot telnet SQL Server port 1433 I have windows 2008 web server and SQL Server 2012 Enterprise installed on it.
I disabled windows firewalls and I'm sure that there isn't another firewall.
But still cannot telnet my server?

I enabled TCP/IP, named pipes etc... on SQL Server Configuration Manager.
Restart everything.

By the way I can telnet locally, th eproblem is remote connection.

Any idea why I cannot telnet?
Thanks in advance.",4
5138598,02/28/2011 05:38:13,792709,02/04/2011 09:14:08,1,0,what value will i get on @WorkingDayson the following querry,"set @WorkingDays= day(DateAdd(d, -1, DateAdd(m, 1,@dtDate )))


here what will i get on @WorkingDays if @dtDate is 1/3/2011",sql,,,,,02/28/2011 05:50:12,not a real question,1,17,10,"what value will i get on @WorkingDayson the following querry set @WorkingDays= day(DateAdd(d, -1, DateAdd(m, 1,@dtDate )))


here what will i get on @WorkingDays if @dtDate is 1/3/2011",1
10808973,05/30/2012 01:40:23,945775,09/15/2011 00:37:44,1,0,Which exploit/audit tool produces output like this?,"I would like to audit the security of my site against SQL injections, and I have people showing me results like this (that's not my site, just an example of the output I'm being shown). 

http://pastebin.com/WPCzCBZb

I would like to know what audit tool that comes from so I can test it myself. 

Does anyone know?",sql,security,injection,audit,exploit,06/01/2012 03:14:48,off topic,1,55,7,"Which exploit/audit tool produces output like this? I would like to audit the security of my site against SQL injections, and I have people showing me results like this (that's not my site, just an example of the output I'm being shown). 

http://pastebin.com/WPCzCBZb

I would like to know what audit tool that comes from so I can test it myself. 

Does anyone know?",5
11687842,07/27/2012 12:33:38,1538370,07/19/2012 15:24:55,6,0,My database's table cleaning itself (SQL Server 2008 Exp.),"I got an epic problem about my datas that in my tables. I insert some datas to table and i wail 5 or 10 mins and table clear itself. I dont know why. My application doesnt have a code bug, but i think sql server has a bug. PLease help...",sql,table,clear,,,07/28/2012 07:00:21,not a real question,1,50,9,"My database's table cleaning itself (SQL Server 2008 Exp.) I got an epic problem about my datas that in my tables. I insert some datas to table and i wail 5 or 10 mins and table clear itself. I dont know why. My application doesnt have a code bug, but i think sql server has a bug. PLease help...",3
11261151,06/29/2012 11:43:05,1491064,06/29/2012 11:38:56,1,0,SQL Server 2005 delete corrupt table,"We are having a database in which one table name dbo.ONOA is corrupt. We need to delete this table. Please let me is there any way to force delete the table?
 
Regards,
Naushad Khan
",sql,,,,,06/29/2012 12:34:49,off topic,1,33,6,"SQL Server 2005 delete corrupt table We are having a database in which one table name dbo.ONOA is corrupt. We need to delete this table. Please let me is there any way to force delete the table?
 
Regards,
Naushad Khan
",1
6355777,06/15/2011 09:40:07,470567,10/08/2010 18:59:39,70,6,Build a timesheet application,"I've got my users table, but the times table and application logic is whats playing tricks on my mind. 

Staff Table

    StaffID [int] IDENTITY(1,1) NOT NULL
    SFName [nvarchar](50) NULL
    SLName [nvarchar](50) NULL
    RoleID [int] NULL
    ManagerID [int] NULL CONSTRAINT [DF_qasiteStaff_ManagerID]  DEFAULT ((0))
    IsHead [int] NULL CONSTRAINT [DF_qasiteStaff_IsManager]  DEFAULT ((0))
    pxusername [nvarchar](50) NULL
    pxpassphrase [nvarchar](50) NULL


TimeSelected

    timeid
    StaffID
    DateEntered
    TimeStarted
    TimeEnded
    LunchTimeUsed (increments of 15 mins)

That's all relatively easy i just cant see how the user can add the timesheet.

    1. If they forget to add todays values is that it?
    2. The insert form should that consist of The whole week and they can add as they please?
    3. I'm stumped, without sounding
    4. Do i need more fields in the TimesSelected table?

Some help would be appreciated

Thanks
    ",sql,sql-server-2005,asp-classic,,,06/15/2011 11:32:27,not a real question,1,187,4,"Build a timesheet application I've got my users table, but the times table and application logic is whats playing tricks on my mind. 

Staff Table

    StaffID [int] IDENTITY(1,1) NOT NULL
    SFName [nvarchar](50) NULL
    SLName [nvarchar](50) NULL
    RoleID [int] NULL
    ManagerID [int] NULL CONSTRAINT [DF_qasiteStaff_ManagerID]  DEFAULT ((0))
    IsHead [int] NULL CONSTRAINT [DF_qasiteStaff_IsManager]  DEFAULT ((0))
    pxusername [nvarchar](50) NULL
    pxpassphrase [nvarchar](50) NULL


TimeSelected

    timeid
    StaffID
    DateEntered
    TimeStarted
    TimeEnded
    LunchTimeUsed (increments of 15 mins)

That's all relatively easy i just cant see how the user can add the timesheet.

    1. If they forget to add todays values is that it?
    2. The insert form should that consist of The whole week and they can add as they please?
    3. I'm stumped, without sounding
    4. Do i need more fields in the TimesSelected table?

Some help would be appreciated

Thanks
    ",3
7481532,09/20/2011 07:26:26,649962,03/08/2011 14:37:31,595,3,SQL query returning wrong column,"I'm trying to figure out how return only the unique values from a SQL table, here's the command string : `SELECT DISTINCT Rep FROM Inventory` , only thing is, it returns data from a completely different column... any clues?
NOTE : I'm using SQL Server Express 2008 R2.",sql,query,,,,09/21/2011 04:52:54,too localized,1,47,5,"SQL query returning wrong column I'm trying to figure out how return only the unique values from a SQL table, here's the command string : `SELECT DISTINCT Rep FROM Inventory` , only thing is, it returns data from a completely different column... any clues?
NOTE : I'm using SQL Server Express 2008 R2.",2
6185625,05/31/2011 09:34:17,174892,09/17/2009 11:03:14,129,10,SQL select first weekday prior to certain date,"Hello I have a report that is currently being run manually on the first weekday prior to the 20th of the month.  I would like to automate this so am going to create a job to run monthly. What I need is to figure out is how to have it run on the first weekday prior to the 20th of the current month.  So if the 20th falls on a Saturday run on Friday 19th.  If 20th falls on Sunday, run on Friday 18th.  It always needs to default to first working day... am not sure how to do this so need help! Clarification i.e. SELECT DATE WHERE DATE <20th Current Month and weekday",sql,sql-server,sql-server-2008,,,,open,0,118,8,"SQL select first weekday prior to certain date Hello I have a report that is currently being run manually on the first weekday prior to the 20th of the month.  I would like to automate this so am going to create a job to run monthly. What I need is to figure out is how to have it run on the first weekday prior to the 20th of the current month.  So if the 20th falls on a Saturday run on Friday 19th.  If 20th falls on Sunday, run on Friday 18th.  It always needs to default to first working day... am not sure how to do this so need help! Clarification i.e. SELECT DATE WHERE DATE <20th Current Month and weekday",3
8769254,01/07/2012 11:18:56,484390,10/22/2010 15:45:33,646,0,Add characters in the variable,"I need to make the string/varchar variable with value ""20061212"" to be string/varchar value ""2006-12-12 00:00:00""

I can't find the right sql syntax code to make it happened in SQL server.

The code can be created as stored procedure or similiar in SQL server.

// Fullmetalboy",sql,sql-server,stored-procedures,,,,open,0,43,5,"Add characters in the variable I need to make the string/varchar variable with value ""20061212"" to be string/varchar value ""2006-12-12 00:00:00""

I can't find the right sql syntax code to make it happened in SQL server.

The code can be created as stored procedure or similiar in SQL server.

// Fullmetalboy",3
4463971,12/16/2010 18:10:13,328397,04/28/2010 23:54:42,1355,26,Easy to understand SQL resources for non-programmers?,"I need to teach my brother SQL, and perhaps some Access so he can work with JD Edwards Enterprise one.

Does anyone have recommendations on how a non-techie/non-programmer can learn SQL?  ",sql,oracle,ms-access,career-development,jdedwards,01/23/2012 23:00:03,off topic,1,32,7,"Easy to understand SQL resources for non-programmers? I need to teach my brother SQL, and perhaps some Access so he can work with JD Edwards Enterprise one.

Does anyone have recommendations on how a non-techie/non-programmer can learn SQL?  ",5
9962966,04/01/2012 08:28:31,1289282,03/23/2012 22:39:14,26,0,SQL - Select invalid column,"I ran into a little error trying to select off of my table. I am sure it is an easy fix but I can't seem to locate the problem. It seems that my error message is telling me that I am selecting off a column that does not exist, even though it does.

**The code**

    ""SELECT TOP (20) id FROM school b WHERE b.state = school.state AND b.id <> school.id ORDER BY NEWID()""

**The table ""school""**

![School table][1]


**The error msg**

![Error msg][2]


  [1]: http://i.stack.imgur.com/Egqwa.png
  [2]: http://i.stack.imgur.com/2U6aS.png",sql,,,,,,open,0,87,5,"SQL - Select invalid column I ran into a little error trying to select off of my table. I am sure it is an easy fix but I can't seem to locate the problem. It seems that my error message is telling me that I am selecting off a column that does not exist, even though it does.

**The code**

    ""SELECT TOP (20) id FROM school b WHERE b.state = school.state AND b.id <> school.id ORDER BY NEWID()""

**The table ""school""**

![School table][1]


**The error msg**

![Error msg][2]


  [1]: http://i.stack.imgur.com/Egqwa.png
  [2]: http://i.stack.imgur.com/2U6aS.png",1
7098184,08/17/2011 19:14:34,341184,05/14/2010 11:28:12,372,11,Blackberry Server migration from windows 2003 to windows 2008 64bit,"We have a Black Berry Enterprise server express running on Windows 2003(32Bit) and we want to move this to Windows 2008 R2 (64Bit). 

We would like to know, best procedure and tool for this task.

Thanks in advance.

Harsha ",sql,blackberry,migration,,,08/17/2011 20:38:13,not a real question,1,38,10,"Blackberry Server migration from windows 2003 to windows 2008 64bit We have a Black Berry Enterprise server express running on Windows 2003(32Bit) and we want to move this to Windows 2008 R2 (64Bit). 

We would like to know, best procedure and tool for this task.

Thanks in advance.

Harsha ",3
3189409,07/06/2010 19:07:55,199751,10/30/2009 15:49:45,48,4,"SQL SERVER 2008 - Estimated Subtree Cost Wildly Off, Terrible Optimization","
I am joining a table that has two record id fields (record1, record2) to a view twice--once on each record--and selecting the top 1000.  The view consists of several rather large tables, and it's id field is a string concatenation of their respective Ids (this was necessary for some third party software that requires a unique ID for the view.  Row numbering was abysmally slow).  There is also a where clause in the view calling a function that compares dates.

The estimated execution plan produces a ""No Join Predicate"" warning unless I use OPTION(FORCE ORDER).  With forcing the ordering, the execution plan has multiple nodes displaying 100% cost.  In both cases, the estimated subtree cost at the endpoint is thirteen orders of magnitude smaller than just one of it's nodes (it's doing a *lot* or nested loop joins with cpu costs as high 35927400000000)

What is going on here with the numbers in the execution plan?  And why is sql server having such a hard time optimizing the query?

Simply adding an index to the view on the concatenated string and using the NOEXPAND table hint fixed the problem entirely.  It ran in all of 12 seconds.  But why did sql stumble so bad (even requiring the noexpand hint after I added the index)?  

Running SQL Server 2008 SP1 with CU 8.",sql,sql-server,tsql,sql-server-2008,,,open,0,228,11,"SQL SERVER 2008 - Estimated Subtree Cost Wildly Off, Terrible Optimization 
I am joining a table that has two record id fields (record1, record2) to a view twice--once on each record--and selecting the top 1000.  The view consists of several rather large tables, and it's id field is a string concatenation of their respective Ids (this was necessary for some third party software that requires a unique ID for the view.  Row numbering was abysmally slow).  There is also a where clause in the view calling a function that compares dates.

The estimated execution plan produces a ""No Join Predicate"" warning unless I use OPTION(FORCE ORDER).  With forcing the ordering, the execution plan has multiple nodes displaying 100% cost.  In both cases, the estimated subtree cost at the endpoint is thirteen orders of magnitude smaller than just one of it's nodes (it's doing a *lot* or nested loop joins with cpu costs as high 35927400000000)

What is going on here with the numbers in the execution plan?  And why is sql server having such a hard time optimizing the query?

Simply adding an index to the view on the concatenated string and using the NOEXPAND table hint fixed the problem entirely.  It ran in all of 12 seconds.  But why did sql stumble so bad (even requiring the noexpand hint after I added the index)?  

Running SQL Server 2008 SP1 with CU 8.",4
8982172,01/24/2012 04:56:20,1153597,01/17/2012 09:44:51,1,0,delete primary key row which is foreign key of another table,Suppose there is a main table containing a primary key and there is another table which contains a foreign key to this main table. So if we delete the row of main table only not child table.,sql,sql-server-2008,,,,01/24/2012 06:39:58,not a real question,1,37,11,delete primary key row which is foreign key of another table Suppose there is a main table containing a primary key and there is another table which contains a foreign key to this main table. So if we delete the row of main table only not child table.,2
112249,09/21/2008 21:35:53,20088,09/21/2008 21:35:53,1,0,Update VERY LARGE PostgresQL database table efficiently,"I have a very large database table in PostgresQL and a column like ""copied"". Every new row starts uncopied and will later be replicated to another thing by a background programm. There is an partial index on that table ""btree(ID) WHERE replicated=0"". The background programm does a select for at most 2000 entries (LIMIT 2000), works on them and then commits the changes in one transaction using 2000 prepared sql-commands.

Now the problem ist that I want to give the user an option to reset this replicated-value, make it all zero again.

An update table set replicated=0;

is not possible:
- It takes very much time
- It duplicates the size of the tabel because of MVCC
- It is done in one transaction: It either fails or goes through.

I actually don't need transaction-features for this case: If the system goes down, it shall process only parts of it.

Several other problems:
Doing an update set replicated=0 where id >10000 and id<20000
is also bad:
It does a sequential scan all over the whole table which is too slow.
If it weren't doing that, it would still be slow because it would be too many seeks.


What I really need is a way of going through all rows, changing them and not being bound to a giant transaction.

Strangely, an
UPDATE table SET replicated=0 WHERE ID in (SELECT id from table WHERE replicated= LIMIT 10000)

is also slow, although it should be a good thing: Go through the table in DISK-order...

(Note that in that case there was also an index that covered this)

(An update LIMIT like Mysql is unavailable for PostgresQL)


BTW: The real problem is more complicated and we're talking about an embedded system here that is already deployed, so remote schema changes are difficult, but possible
It's PostgresQL 7.4 unfortunately.

The amount of rows I'm talking about is e.g. 90000000. The size of the databse can be several dozend gigabytes.

The database itself only contains 5 tables, one is a very large one.
But that is not bad design, because these embedded boxes only operate with one kind of entity, it's not an ERP-system or something like that!



Any ideas?",sql,database,postgresql,update,mvcc,,open,0,341,7,"Update VERY LARGE PostgresQL database table efficiently I have a very large database table in PostgresQL and a column like ""copied"". Every new row starts uncopied and will later be replicated to another thing by a background programm. There is an partial index on that table ""btree(ID) WHERE replicated=0"". The background programm does a select for at most 2000 entries (LIMIT 2000), works on them and then commits the changes in one transaction using 2000 prepared sql-commands.

Now the problem ist that I want to give the user an option to reset this replicated-value, make it all zero again.

An update table set replicated=0;

is not possible:
- It takes very much time
- It duplicates the size of the tabel because of MVCC
- It is done in one transaction: It either fails or goes through.

I actually don't need transaction-features for this case: If the system goes down, it shall process only parts of it.

Several other problems:
Doing an update set replicated=0 where id >10000 and id<20000
is also bad:
It does a sequential scan all over the whole table which is too slow.
If it weren't doing that, it would still be slow because it would be too many seeks.


What I really need is a way of going through all rows, changing them and not being bound to a giant transaction.

Strangely, an
UPDATE table SET replicated=0 WHERE ID in (SELECT id from table WHERE replicated= LIMIT 10000)

is also slow, although it should be a good thing: Go through the table in DISK-order...

(Note that in that case there was also an index that covered this)

(An update LIMIT like Mysql is unavailable for PostgresQL)


BTW: The real problem is more complicated and we're talking about an embedded system here that is already deployed, so remote schema changes are difficult, but possible
It's PostgresQL 7.4 unfortunately.

The amount of rows I'm talking about is e.g. 90000000. The size of the databse can be several dozend gigabytes.

The database itself only contains 5 tables, one is a very large one.
But that is not bad design, because these embedded boxes only operate with one kind of entity, it's not an ERP-system or something like that!



Any ideas?",5
9958836,03/31/2012 19:09:28,1305397,03/31/2012 18:39:29,1,0,Join Statements,"Please explain the SQL query given below. I m new with SQL and struggling with **Join Statements**.
Thanks in advance.  

    select a.ename    as attendee
    ,      t.ename    as trainer
    from   employees     t
           join
           offerings     o on  (o.trainer = t.empno)
           join
           registrations r using (course, begindate)
           join
           employees     a on (r.attendee = a.empno)
     where  course = 'SQL';",sql,join,self-join,,,04/01/2012 06:49:32,not a real question,1,156,2,"Join Statements Please explain the SQL query given below. I m new with SQL and struggling with **Join Statements**.
Thanks in advance.  

    select a.ename    as attendee
    ,      t.ename    as trainer
    from   employees     t
           join
           offerings     o on  (o.trainer = t.empno)
           join
           registrations r using (course, begindate)
           join
           employees     a on (r.attendee = a.empno)
     where  course = 'SQL';",3
10848878,06/01/2012 10:49:32,169992,09/08/2009 06:08:26,9652,168,How do you store datetimes in a database on the scale of the history of the universe?,"Is there a standard approach to storing datetimes in a database (PostgreSQL/MongoDB/Neo4j) that can handle timescales down to a millisecond up to the age of the universe?

Some examples of times would be:

- 13.7 billion years ago: origin of the universe
- Photon epoch: Between 10 seconds and 380,000 years after the Big Bang (so 13.7 Billion years - 10 seconds ago)
- 8,000 BCE: end of last ice age
- 356 BCE: Alexander the Great's birth

Is it possible to build an actual timeline of this scale.  The examples above aren't necessarily exact.",sql,database,datetime,nosql,,,open,0,90,17,"How do you store datetimes in a database on the scale of the history of the universe? Is there a standard approach to storing datetimes in a database (PostgreSQL/MongoDB/Neo4j) that can handle timescales down to a millisecond up to the age of the universe?

Some examples of times would be:

- 13.7 billion years ago: origin of the universe
- Photon epoch: Between 10 seconds and 380,000 years after the Big Bang (so 13.7 Billion years - 10 seconds ago)
- 8,000 BCE: end of last ice age
- 356 BCE: Alexander the Great's birth

Is it possible to build an actual timeline of this scale.  The examples above aren't necessarily exact.",4
4069653,11/01/2010 14:16:45,142019,07/21/2009 13:42:41,3090,146,My correct SQL query gives an error.,"I have this query:

    SELECT * FROM references WHERE title LIKE '%NSObject%'

Giving this error:

>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near `references WHERE title LIKE '%NSObject%'` at line 1

However, I cannot find my mistake. What is wrong with this query?",sql,,,,,,open,0,60,7,"My correct SQL query gives an error. I have this query:

    SELECT * FROM references WHERE title LIKE '%NSObject%'

Giving this error:

>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near `references WHERE title LIKE '%NSObject%'` at line 1

However, I cannot find my mistake. What is wrong with this query?",1
6429512,06/21/2011 17:34:27,559744,01/01/2011 11:15:13,157,2,What can be implemented to prevent any tables from being changed?,"Q2. You want to prevent changes to tables in one of the databases in your SQL Server instance since
changes to any of the tables can cause the associated client application to stop functioning. What can be implemented to prevent any tables from being changed?
a. A stored procedure
b. A database‐level DDL trigger
c. A DML trigger
d. A server‐level DDL trigger

thanks",sql,,,,,06/22/2011 13:57:57,not constructive,1,58,11,"What can be implemented to prevent any tables from being changed? Q2. You want to prevent changes to tables in one of the databases in your SQL Server instance since
changes to any of the tables can cause the associated client application to stop functioning. What can be implemented to prevent any tables from being changed?
a. A stored procedure
b. A database‐level DDL trigger
c. A DML trigger
d. A server‐level DDL trigger

thanks",1
6290855,06/09/2011 09:40:20,767543,05/24/2011 10:20:33,47,1,Connect to MS SQL SERVER without ODBC,"Is it possible to connect directly to SQL Server, without ODBC? Just like MySQL or PostgreSQL, by just linking a library and connecting. Can I? If yes, how?

Thanks in advance

Ali Veli",sql,sql-server,database,odbc,,06/09/2011 13:14:21,not a real question,1,31,7,"Connect to MS SQL SERVER without ODBC Is it possible to connect directly to SQL Server, without ODBC? Just like MySQL or PostgreSQL, by just linking a library and connecting. Can I? If yes, how?

Thanks in advance

Ali Veli",4
3002070,06/08/2010 23:24:35,7883,09/15/2008 14:37:57,3877,214,IN statement performance in PostgreSQL (and in general),"I know this has probably been asked before, but I can't find it with SO's search.

Lets say i've TABLE1 and TABLE2, who should I expect the performance of a query such as this:

    SELECT * FROM TABLE1 WHERE id IN SUBQUERY_ON_TABLE2;

as the number of rows in TABLE1 and TABLE2 grow and id is a primary key on TABLE1.

Yes, I know using IN is such a n00b mistake, but TABLE2 has a generic relation (django generic relation) to multiple other tables so I can't think of another way to filter the data. At what (aproximate) ammount of rows in TABLE1 and TABLE2 should I expect to notice performance issues because of this? Will performance degrade linearly, exponentially etc. depending on the number of rows?
",sql,django,postgresql,,,,open,0,126,8,"IN statement performance in PostgreSQL (and in general) I know this has probably been asked before, but I can't find it with SO's search.

Lets say i've TABLE1 and TABLE2, who should I expect the performance of a query such as this:

    SELECT * FROM TABLE1 WHERE id IN SUBQUERY_ON_TABLE2;

as the number of rows in TABLE1 and TABLE2 grow and id is a primary key on TABLE1.

Yes, I know using IN is such a n00b mistake, but TABLE2 has a generic relation (django generic relation) to multiple other tables so I can't think of another way to filter the data. At what (aproximate) ammount of rows in TABLE1 and TABLE2 should I expect to notice performance issues because of this? Will performance degrade linearly, exponentially etc. depending on the number of rows?
",3
11425175,07/11/2012 03:37:27,516801,11/23/2010 00:03:48,74,1,Imort XMP into SQL 2005 data not imported,"I have a table titled Code, with two fields, ID and Code. 

I have an XML file: 

     <DataSet>
       <scan>
         <ID>4</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>5</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>6</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>4</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>5</ID>
         <Code>420</Code>
       </scan>
      </DataSet>

and am using this 

     INSERT INTO code (id,code) 
     SELECT X.scan.query('id').value('.','INT'),
       X.scan.query('code').value('.','VARCHAR(30)')
     FROM ( 
     SELECT CAST(x AS XML)
     FROM OPENROWSET(
          BULK 'C:\dataimport.xml',
          SINGLE_BLOB) AS T(x)
           ) AS T(x)
     CROSS APPLY x.nodes('dataset/scan') AS X(scan);

The query runs without error, but no data is inserted into the Code table. 
I can't see what I'm missing. 

Thanks for your help. ",sql,xml,sql-server-2005,import,,,open,0,305,8,"Imort XMP into SQL 2005 data not imported I have a table titled Code, with two fields, ID and Code. 

I have an XML file: 

     <DataSet>
       <scan>
         <ID>4</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>5</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>6</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>4</ID>
         <Code>420</Code>
       </scan>
       <scan>
         <ID>5</ID>
         <Code>420</Code>
       </scan>
      </DataSet>

and am using this 

     INSERT INTO code (id,code) 
     SELECT X.scan.query('id').value('.','INT'),
       X.scan.query('code').value('.','VARCHAR(30)')
     FROM ( 
     SELECT CAST(x AS XML)
     FROM OPENROWSET(
          BULK 'C:\dataimport.xml',
          SINGLE_BLOB) AS T(x)
           ) AS T(x)
     CROSS APPLY x.nodes('dataset/scan') AS X(scan);

The query runs without error, but no data is inserted into the Code table. 
I can't see what I'm missing. 

Thanks for your help. ",4
9949977,03/30/2012 20:25:25,1062284,11/23/2011 16:04:38,17,2,EntifyFramework June 2011 CTP and SQL Server 2012,"I have a spatial Model definition which used to be working with SQL 2008 but not with  2012 anymore.

I don't know why but I can't get it working...

    model.Location = DbGeography.Parse(""POINT("" + model.Latitude + "" "" + model.Longitude + "")"");


I am getting this exception:

    System.Reflection.TargetInvocationException was unhandled by user code
      HResult=-2146232828
      Message=Exception has been thrown by the target of an invocation.
      Source=mscorlib
      StackTrace:
           at System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor)
           at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
           at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
           at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
           at System.Data.SqlClient.SqlSpatialServices.GeographyFromText(String geographyText)
           at System.Data.Spatial.DbGeography.Parse(String geographyText)
           at b.Helpers.Repository.saveFoursquareMarkers(List`1 fs) in C:\Users\Administrator\Documents\Visual Studio 2010\Projects\b\Helpers\Repository.cs:line 182
           at b.Controllers.KayController.GetMarkers(String lat, String lng, String type, Double dist, String today, String google) in C:\Users\Administrator\Documents\Visual Studio 2010\Projects\b\Controllers\KayController.cs:line 29
           at lambda_method(Closure , ControllerBase , Object[] )
           at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
           at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
           at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.InvokeSynchronousActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()
           at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
           at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
           at System.Web.Mvc.Async.AsyncResultWrapper.End[TResult](IAsyncResult asyncResult, Object tag)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
      InnerException: System.FormatException
           HResult=-2146233033
           Message=24141: A number is expected at position 21 of the input. The input has ,905651030368.
           Source=Microsoft.SqlServer.Types
           StackTrace:
                at Microsoft.SqlServer.Types.OpenGisWktReader.RecognizeDouble()
                at Microsoft.SqlServer.Types.OpenGisWktReader.ParsePointText(Boolean parseParentheses)
                at Microsoft.SqlServer.Types.OpenGisWktReader.ParseTaggedText(OpenGisType type)
                at Microsoft.SqlServer.Types.OpenGisWktReader.Read(OpenGisType type, Int32 srid)
                at Microsoft.SqlServer.Types.SqlGeography.GeographyFromText(OpenGisType type, SqlChars taggedText, Int32 srid)
                at Microsoft.SqlServer.Types.SqlGeography.STGeomFromText(SqlChars geometryTaggedText, Int32 srid)
                at Microsoft.SqlServer.Types.SqlGeography.Parse(SqlString s)
           InnerException: 

Any help ?",sql,entity-framework,ctp,,,,open,0,622,8,"EntifyFramework June 2011 CTP and SQL Server 2012 I have a spatial Model definition which used to be working with SQL 2008 but not with  2012 anymore.

I don't know why but I can't get it working...

    model.Location = DbGeography.Parse(""POINT("" + model.Latitude + "" "" + model.Longitude + "")"");


I am getting this exception:

    System.Reflection.TargetInvocationException was unhandled by user code
      HResult=-2146232828
      Message=Exception has been thrown by the target of an invocation.
      Source=mscorlib
      StackTrace:
           at System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor)
           at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
           at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
           at System.Reflection.MethodBase.Invoke(Object obj, Object[] parameters)
           at System.Data.SqlClient.SqlSpatialServices.GeographyFromText(String geographyText)
           at System.Data.Spatial.DbGeography.Parse(String geographyText)
           at b.Helpers.Repository.saveFoursquareMarkers(List`1 fs) in C:\Users\Administrator\Documents\Visual Studio 2010\Projects\b\Helpers\Repository.cs:line 182
           at b.Controllers.KayController.GetMarkers(String lat, String lng, String type, Double dist, String today, String google) in C:\Users\Administrator\Documents\Visual Studio 2010\Projects\b\Controllers\KayController.cs:line 29
           at lambda_method(Closure , ControllerBase , Object[] )
           at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
           at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
           at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.InvokeSynchronousActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()
           at System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
           at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
           at System.Web.Mvc.Async.AsyncResultWrapper.End[TResult](IAsyncResult asyncResult, Object tag)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()
           at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
      InnerException: System.FormatException
           HResult=-2146233033
           Message=24141: A number is expected at position 21 of the input. The input has ,905651030368.
           Source=Microsoft.SqlServer.Types
           StackTrace:
                at Microsoft.SqlServer.Types.OpenGisWktReader.RecognizeDouble()
                at Microsoft.SqlServer.Types.OpenGisWktReader.ParsePointText(Boolean parseParentheses)
                at Microsoft.SqlServer.Types.OpenGisWktReader.ParseTaggedText(OpenGisType type)
                at Microsoft.SqlServer.Types.OpenGisWktReader.Read(OpenGisType type, Int32 srid)
                at Microsoft.SqlServer.Types.SqlGeography.GeographyFromText(OpenGisType type, SqlChars taggedText, Int32 srid)
                at Microsoft.SqlServer.Types.SqlGeography.STGeomFromText(SqlChars geometryTaggedText, Int32 srid)
                at Microsoft.SqlServer.Types.SqlGeography.Parse(SqlString s)
           InnerException: 

Any help ?",3
11069386,06/17/2012 06:33:58,640374,03/02/2011 01:00:55,388,24,"SQL query with 'WITH' runs outside stored procedure, but not as the body of stored procedure","On SQL Server 2008

Working SQL query:



    declare @start datetime = '01 jun 2012'
    declare @end   datetime = '01 jul 2012'
    declare @articleId int = 4
    declare @beforeDate datetime = '31 jul 2012';
    
    WITH amonth(day) as
    (
        select @start as day
            union all
        select day + 1
            from amonth
            where day < @end
    )
    
    (select total=(
    	select SUM(UnitPrice * NewQuantity) as Value from InventoryBatch invBatches
    	inner join
    	(select * from
    	 (SELECT
    		  TOP 100 PERCENT
    		  [B].[InventoryBatchId] AS [InventoryBatchId],
    		  RANK() over (partition by [B].[InventoryBatchId] order by [B].[MutationDate] desc) AS [MutationDate],
    		  [B].[MutationDate] as [RealDate],
    		  [B].[Id],
    		  [B].NewQuantity
    		FROM
    		  [InventoryBatchHistory] [B]
    		WHERE
    		  ([B].[ArticleId] = @articleId AND [B].[DeliveryDate] <= amonth.day)
    		GROUP BY
    		  [B].[InventoryBatchId], [MutationDate], [B].Id, B.NewQuantity) INV where MutationDate = 1) latest
    		  on invBatches.Id = latest.InventoryBatchId),
     amonth.day
        from amonth 
        left join #t on #t.DT = amonth.day
    group by amonth.day)


Gives me a list of calculated totals for each day, nice.

Now I want to reuse this as a StoredProcedure:

    SET ANSI_NULLS ON
    GO
    
    SET QUOTED_IDENTIFIER ON
    GO
    
    SET NOCOUNT ON
    GO
    
    ALTER PROCEDURE [dbo].[GetTotalQuantityForArticleRange](
    	@articleId INT,
    	@start DATETIME,
    	@end DATETIME)
    AS
    BEGIN
    
    WITH amonth(day) as
    (
        select @start as day
            union all
        select day + 1
            from amonth
            where day < @end
    )
    
    (select total=(
    	select SUM(UnitPrice * NewQuantity) as Value from InventoryBatch invBatches
    	inner join
    	(select * from
    	 (SELECT
    		  TOP 100 PERCENT
    		  [B].[InventoryBatchId] AS [InventoryBatchId],
    		  RANK() over (partition by [B].[InventoryBatchId] order by [B].[MutationDate] desc) AS [MutationDate],
    		  [B].[MutationDate] as [RealDate],
    		  [B].[Id],
    		  [B].NewQuantity
    		FROM
    		  [InventoryBatchHistory] [B]
    		WHERE
    		  ([B].[ArticleId] = @articleId AND [B].[DeliveryDate] <= amonth.day)
    		GROUP BY
    		  [B].[InventoryBatchId], [MutationDate], [B].Id, B.NewQuantity) INV where MutationDate = 1) latest
    		  on invBatches.Id = latest.InventoryBatchId),
     amonth.day
        from amonth 
        left join #t on #t.DT = amonth.day
    group by amonth.day)
    
    select * from InventoryBatch
    
    
    END



Called as:



    DECLARE @p_date DATETIME
    SET     @p_date = CONVERT( DATETIME, '20 JUNE 2012', 106 )
    declare @start1 datetime = '17 jun 2012'
    declare @end1  datetime = '20 jun 2012'
    
    
    exec GetTotalQuantityForArticleRange 4, @start = @start1, @end = @end1


And I consistently get a NULL result. What am I missing?

Thanks in advance.
",sql,sql-server,stored-procedures,,,,open,0,757,16,"SQL query with 'WITH' runs outside stored procedure, but not as the body of stored procedure On SQL Server 2008

Working SQL query:



    declare @start datetime = '01 jun 2012'
    declare @end   datetime = '01 jul 2012'
    declare @articleId int = 4
    declare @beforeDate datetime = '31 jul 2012';
    
    WITH amonth(day) as
    (
        select @start as day
            union all
        select day + 1
            from amonth
            where day < @end
    )
    
    (select total=(
    	select SUM(UnitPrice * NewQuantity) as Value from InventoryBatch invBatches
    	inner join
    	(select * from
    	 (SELECT
    		  TOP 100 PERCENT
    		  [B].[InventoryBatchId] AS [InventoryBatchId],
    		  RANK() over (partition by [B].[InventoryBatchId] order by [B].[MutationDate] desc) AS [MutationDate],
    		  [B].[MutationDate] as [RealDate],
    		  [B].[Id],
    		  [B].NewQuantity
    		FROM
    		  [InventoryBatchHistory] [B]
    		WHERE
    		  ([B].[ArticleId] = @articleId AND [B].[DeliveryDate] <= amonth.day)
    		GROUP BY
    		  [B].[InventoryBatchId], [MutationDate], [B].Id, B.NewQuantity) INV where MutationDate = 1) latest
    		  on invBatches.Id = latest.InventoryBatchId),
     amonth.day
        from amonth 
        left join #t on #t.DT = amonth.day
    group by amonth.day)


Gives me a list of calculated totals for each day, nice.

Now I want to reuse this as a StoredProcedure:

    SET ANSI_NULLS ON
    GO
    
    SET QUOTED_IDENTIFIER ON
    GO
    
    SET NOCOUNT ON
    GO
    
    ALTER PROCEDURE [dbo].[GetTotalQuantityForArticleRange](
    	@articleId INT,
    	@start DATETIME,
    	@end DATETIME)
    AS
    BEGIN
    
    WITH amonth(day) as
    (
        select @start as day
            union all
        select day + 1
            from amonth
            where day < @end
    )
    
    (select total=(
    	select SUM(UnitPrice * NewQuantity) as Value from InventoryBatch invBatches
    	inner join
    	(select * from
    	 (SELECT
    		  TOP 100 PERCENT
    		  [B].[InventoryBatchId] AS [InventoryBatchId],
    		  RANK() over (partition by [B].[InventoryBatchId] order by [B].[MutationDate] desc) AS [MutationDate],
    		  [B].[MutationDate] as [RealDate],
    		  [B].[Id],
    		  [B].NewQuantity
    		FROM
    		  [InventoryBatchHistory] [B]
    		WHERE
    		  ([B].[ArticleId] = @articleId AND [B].[DeliveryDate] <= amonth.day)
    		GROUP BY
    		  [B].[InventoryBatchId], [MutationDate], [B].Id, B.NewQuantity) INV where MutationDate = 1) latest
    		  on invBatches.Id = latest.InventoryBatchId),
     amonth.day
        from amonth 
        left join #t on #t.DT = amonth.day
    group by amonth.day)
    
    select * from InventoryBatch
    
    
    END



Called as:



    DECLARE @p_date DATETIME
    SET     @p_date = CONVERT( DATETIME, '20 JUNE 2012', 106 )
    declare @start1 datetime = '17 jun 2012'
    declare @end1  datetime = '20 jun 2012'
    
    
    exec GetTotalQuantityForArticleRange 4, @start = @start1, @end = @end1


And I consistently get a NULL result. What am I missing?

Thanks in advance.
",3
1850227,12/04/2009 23:02:11,6266,09/13/2008 12:51:36,2087,57,Cross language development problem,"I'm working on a project that involves a database (My SQL), website (PHP) and a custom high performance server application (C++). The C++ application (and its accompanying client application) make up the main bulk of the project, with the database storing long term data for it. The website is primarily for displaying various statistics, and administration.


1) I want the PHP scripts and c++ application to be able to communicate in some way, since the database is only used for persistent data, and additionally the c++ application may cache some things so needs to be told to reload the data in some cases. It is highly likely they will be on different machines, and even possibly different OS's. I've been considering the idea that TCP may be the best option with some simple command - response protocol?

2) What is the best way to write the common database interface code once, and be able to use it from both the PHP website and the c++ applications?",sql,mysql,php,c++,code-reuse,,open,0,164,4,"Cross language development problem I'm working on a project that involves a database (My SQL), website (PHP) and a custom high performance server application (C++). The C++ application (and its accompanying client application) make up the main bulk of the project, with the database storing long term data for it. The website is primarily for displaying various statistics, and administration.


1) I want the PHP scripts and c++ application to be able to communicate in some way, since the database is only used for persistent data, and additionally the c++ application may cache some things so needs to be told to reload the data in some cases. It is highly likely they will be on different machines, and even possibly different OS's. I've been considering the idea that TCP may be the best option with some simple command - response protocol?

2) What is the best way to write the common database interface code once, and be able to use it from both the PHP website and the c++ applications?",5
7563509,09/27/2011 02:11:45,239242,12/27/2009 18:11:44,560,8,"How can I selecting multiple columns, only one of which is distinct? (ORACLE SQL)","I want to be able to do this:

    INSERT INTO TABLE_1(<LIST OF ROWS>)
    SELECT <LIST OF ROWS> FROM (SELECT DISTINCT <OTHER ROWS> FROM TABLE_2);

How can I do this? I receive an error when I try to do it now.

Note that `<LIST OF ROWS>` is the same in both cases I use it, and also not that the fields in `<OTHER ROWS>` could, but do not necessarily exist in <LIST_OF ROWS>.
",sql,oracle,,,,,open,0,76,14,"How can I selecting multiple columns, only one of which is distinct? (ORACLE SQL) I want to be able to do this:

    INSERT INTO TABLE_1(<LIST OF ROWS>)
    SELECT <LIST OF ROWS> FROM (SELECT DISTINCT <OTHER ROWS> FROM TABLE_2);

How can I do this? I receive an error when I try to do it now.

Note that `<LIST OF ROWS>` is the same in both cases I use it, and also not that the fields in `<OTHER ROWS>` could, but do not necessarily exist in <LIST_OF ROWS>.
",2
10984355,06/11/2012 16:52:54,1449455,06/11/2012 16:40:31,1,0,Select non null columns where id<=number,"I have a table with many columns like id,versionid,field 1, field2 , field3 etc

data is as follows

Id,VersionId, field1 ,field 2, field3

101  1         xxx     null     zzz
102  2         null    yyyy     null
101  3         null    mmmm     null
    
i want to select row for versionid=3 but I want data as follows,

102,3, xxx,yyyy,zzz( field1,filed3 i want from previous version i.e 1 (not null columns))

please can any one suggest me on this

Thanks,







",sql,server,,,,06/13/2012 07:13:30,not a real question,1,117,6,"Select non null columns where id<=number I have a table with many columns like id,versionid,field 1, field2 , field3 etc

data is as follows

Id,VersionId, field1 ,field 2, field3

101  1         xxx     null     zzz
102  2         null    yyyy     null
101  3         null    mmmm     null
    
i want to select row for versionid=3 but I want data as follows,

102,3, xxx,yyyy,zzz( field1,filed3 i want from previous version i.e 1 (not null columns))

please can any one suggest me on this

Thanks,







",2
5209579,03/06/2011 08:55:35,646764,03/06/2011 08:55:35,1,0,help in sql server 2008,"i want to make web site where user will login using sql authentication and then they can access the databases created by them.... so i want query to get all the databases name created by a particular user..... also the user can give privileges to other user so he can either read, modify or delete the table columns.... so plz help me with this... should i use sql login authentication or database user or both????? plz give me the query???",sql,server,login,user,,03/06/2011 14:34:46,not a real question,1,80,5,"help in sql server 2008 i want to make web site where user will login using sql authentication and then they can access the databases created by them.... so i want query to get all the databases name created by a particular user..... also the user can give privileges to other user so he can either read, modify or delete the table columns.... so plz help me with this... should i use sql login authentication or database user or both????? plz give me the query???",4
4945661,02/09/2011 13:44:35,609822,02/09/2011 13:44:35,1,0,Stop SQL Reporting Server Hijacking /Reports,"How do you stop SQL server reporting services from hijacking the /reports virtual folder on ALL websites on the server it's installed on. Have just discovered that all the websites on the box with the reporting server on (its a dev box), have /Reports overridden by the reporting services manager. How do I turn this off?

Have tried stopping the service, disabling it in the config file, all to no avail (the service is still hijacking the url, you just get a ""service unavailable"" error instead of the report manager). Short of uninstalling reporting services, is there a way to switch this off?",sql,server,,,,,open,0,102,6,"Stop SQL Reporting Server Hijacking /Reports How do you stop SQL server reporting services from hijacking the /reports virtual folder on ALL websites on the server it's installed on. Have just discovered that all the websites on the box with the reporting server on (its a dev box), have /Reports overridden by the reporting services manager. How do I turn this off?

Have tried stopping the service, disabling it in the config file, all to no avail (the service is still hijacking the url, you just get a ""service unavailable"" error instead of the report manager). Short of uninstalling reporting services, is there a way to switch this off?",2
4227542,11/19/2010 17:11:50,352157,04/28/2010 15:30:52,431,21,sql select data from XML param,"whats the SQL for selecting the values from this XML chunk like done in the sample below?

    <RWFCriteria reportType=""OPRAProject"">
       <item id=""88"" name="""" value="""" type=""Project"" />
       <item id=""112"" name="""" value=""12"" type=""Milestone"" />
       <item id=""43"" name="""" value=""11"" type=""Milestone"" />
    </RWFCriteria>


i want to select out similar to this but with the above XML data


    DECLARE @Param XML  
    SET @Param = '<data>  
          <release id=""1""><milestone id=""1"" /><milestone id=""2"" /></release>  
          <release id=""3""><milestone id=""1"" /><milestone id=""27""/></release>  
        </data>'  
     
    SELECT c.value('../@id', 'INT') AS ReleaseId, c.value('@id', 'INT') AS MilestoneId  
     FROM @Param.nodes('/data/release/milestone') AS T(c)


",sql,xml,sql-server-2005,,,,open,0,162,6,"sql select data from XML param whats the SQL for selecting the values from this XML chunk like done in the sample below?

    <RWFCriteria reportType=""OPRAProject"">
       <item id=""88"" name="""" value="""" type=""Project"" />
       <item id=""112"" name="""" value=""12"" type=""Milestone"" />
       <item id=""43"" name="""" value=""11"" type=""Milestone"" />
    </RWFCriteria>


i want to select out similar to this but with the above XML data


    DECLARE @Param XML  
    SET @Param = '<data>  
          <release id=""1""><milestone id=""1"" /><milestone id=""2"" /></release>  
          <release id=""3""><milestone id=""1"" /><milestone id=""27""/></release>  
        </data>'  
     
    SELECT c.value('../@id', 'INT') AS ReleaseId, c.value('@id', 'INT') AS MilestoneId  
     FROM @Param.nodes('/data/release/milestone') AS T(c)


",3
4072735,11/01/2010 20:20:33,240566,12/30/2009 01:04:06,1529,170,Does Oracle allow cross schema views?,"In MySQL, I can create a view which points to a table in another schema.  Does Oracle allow this?  ",sql,oracle,schema,,,,open,0,22,6,"Does Oracle allow cross schema views? In MySQL, I can create a view which points to a table in another schema.  Does Oracle allow this?  ",3
4095625,11/04/2010 10:14:22,326821,04/27/2010 11:43:16,449,4,insert into doesnt work,"Why query below doesnt work:


    insert into [ProcessStatus] ([ProcessId])
    SELECT TMP.[ProcessId]`
    
    from (
    select distinct	
    	 [ProcessId]
    FROM [Process]
    ) TMP

error message is:

    Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.

",sql,sql-server-2008,,,,,open,0,81,4,"insert into doesnt work Why query below doesnt work:


    insert into [ProcessStatus] ([ProcessId])
    SELECT TMP.[ProcessId]`
    
    from (
    select distinct	
    	 [ProcessId]
    FROM [Process]
    ) TMP

error message is:

    Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.

",2
7175938,08/24/2011 13:08:45,908922,08/24/2011 05:01:39,18,0,"Msg 8152, Level 16, State 14, Line 5 String or binary data would be truncated","Msg 8152, Level 16, State 14, Line 5
String or binary data would be truncated. 

that error shows up, why is that???

    create table model(
	mod_code varchar(10),
	constraint PK_model primary key(mod_code),
	mod_manufacturer varchar(10),
	mod_name varchar(20),
	mod_seats int,
	mod_chg_mile varchar(10),
	)
	insert into model(mod_code,mod_manufacturer,mod_name,mod_seats,mod_chg_mile)
	values('c-90a','beechcraft','kingair',8,'$2.67')
	insert into model(mod_code,mod_manufacturer,mod_name,mod_seats,mod_chg_mile)
	values('pa23-250','piper','aztec',6,'$1.93')
	insert into model(mod_code,mod_manufacturer,mod_name,mod_seats,mod_chg_mile)
	values('pa31-350','piper','navajo chiefain',10,'$2.35')",sql,server,,,,08/24/2011 14:44:55,not a real question,1,42,15,"Msg 8152, Level 16, State 14, Line 5 String or binary data would be truncated Msg 8152, Level 16, State 14, Line 5
String or binary data would be truncated. 

that error shows up, why is that???

    create table model(
	mod_code varchar(10),
	constraint PK_model primary key(mod_code),
	mod_manufacturer varchar(10),
	mod_name varchar(20),
	mod_seats int,
	mod_chg_mile varchar(10),
	)
	insert into model(mod_code,mod_manufacturer,mod_name,mod_seats,mod_chg_mile)
	values('c-90a','beechcraft','kingair',8,'$2.67')
	insert into model(mod_code,mod_manufacturer,mod_name,mod_seats,mod_chg_mile)
	values('pa23-250','piper','aztec',6,'$1.93')
	insert into model(mod_code,mod_manufacturer,mod_name,mod_seats,mod_chg_mile)
	values('pa31-350','piper','navajo chiefain',10,'$2.35')",2
10650445,05/18/2012 09:55:25,1403021,05/18/2012 09:40:25,1,0,inserting the value to the table,"Am trying to run this query in sql serve 2005 .when i run this statement Am getting the result the 1 row inserted but the problem is DateOut and TimeOut Field values are not inserting..

insert into timecardtest(DateIn,TimeIn,DateOut,TimeOut,companyid,
subcompanyid,EID,Surname,MiddleName,FirstName,Shift,Department,
RegularHours,LunchHours,OverTime1,OverTime2,DueTime,Breaks,
TotalHours,Status,Late,Early,Holiday,Absent,Vacation,Sick,
Personel,PaidLeave,UnPaidLeave,HalfPaidLeave,OtherLeave,
HolidayWorkHrs,NumOfRecordsInLog,machineid,overWriteflag,
LeaveDesc,productId,WeeklyOff,latehours,ManHour ) values 
( '2012-05-11','1/1/1900 06:54:00 AM','2012-05-11','1/1/1900 06:49:00 PM', 
3, 3,'10378', 'H', 'R', 'RAJA KUMAR BOROVH', 7, 7,715,0,0,0,0 ,0 ,
715,1,0,1,0, 0, 0, 0 , 0, 0, 0 , 0, 0, 0, 0,  '0',1, 'Present' , 3 ,0,0,0)


Please Help me to solve the issue

Regards,
Shashikala A

",sql,server,,,,05/19/2012 06:08:17,not constructive,1,81,6,"inserting the value to the table Am trying to run this query in sql serve 2005 .when i run this statement Am getting the result the 1 row inserted but the problem is DateOut and TimeOut Field values are not inserting..

insert into timecardtest(DateIn,TimeIn,DateOut,TimeOut,companyid,
subcompanyid,EID,Surname,MiddleName,FirstName,Shift,Department,
RegularHours,LunchHours,OverTime1,OverTime2,DueTime,Breaks,
TotalHours,Status,Late,Early,Holiday,Absent,Vacation,Sick,
Personel,PaidLeave,UnPaidLeave,HalfPaidLeave,OtherLeave,
HolidayWorkHrs,NumOfRecordsInLog,machineid,overWriteflag,
LeaveDesc,productId,WeeklyOff,latehours,ManHour ) values 
( '2012-05-11','1/1/1900 06:54:00 AM','2012-05-11','1/1/1900 06:49:00 PM', 
3, 3,'10378', 'H', 'R', 'RAJA KUMAR BOROVH', 7, 7,715,0,0,0,0 ,0 ,
715,1,0,1,0, 0, 0, 0 , 0, 0, 0 , 0, 0, 0, 0,  '0',1, 'Present' , 3 ,0,0,0)


Please Help me to solve the issue

Regards,
Shashikala A

",2
4078746,11/02/2010 14:39:42,22996,09/27/2008 15:12:31,2252,33,recursive query problem,"Trying not to select same connection multiple times I have tried to use charindex() = 0 condition the following way:

    WITH Cluster(calling_party, called_party, link_strength, Path)
    AS
    (SELECT calling_party, called_party, link_strength, CONVERT(varchar(max), calling_party + '.' + called_party) AS Path FROM monthly_connections_test WHERE link_strength > 0.1 AND calling_party = 'b'
    UNION ALL
    SELECT mc.calling_party, mc.called_party, mc.link_strength, CONVERT(varchar(max), cl.Path + '.' + mc.calling_party + '.' + mc.called_party) AS Path FROM monthly_connections_test mc INNER JOIN Cluster cl ON (mc.called_party = cl.called_party OR mc.called_party = cl.calling_party) AND (CHARINDEX(cl.called_party + '.' + mc.calling_party, Path) = 0 AND CHARINDEX(cl.called_party + '.' + mc.called_party, Path) = 0) WHERE mc.link_strength > 0.1
    )
    SELECT calling_party, called_party, link_strength, Path FROM Cluster OPTION (maxrecursion 30000)

The condition however does not fulfill its purpose as the same rows are selected multiple times. The example query result is the following:

    b	d	0.5000000	b.d
    b	c	0.5000000	b.c
    b	c	0.5000000	b.c.b.c
    d	b	0.4000000	b.c.d.b
    a	d	0.2000000	b.c.d.b.a.d
    b	d	0.5000000	b.c.d.b.b.d
    d	b	0.4000000	b.c.d.b.d.b
    a	d	0.2000000	b.c.d.b.b.d.a.d
    a	d	0.2000000	b.c.d.b.a.d.a.d
    c	a	0.4000000	b.c.d.b.a.d.c.a
    c	a	0.4000000	b.c.d.b.a.d.c.a.c.a
    b	c	0.5000000	b.c.d.b.a.d.c.a.b.c
    b	c	0.5000000	b.c.d.b.a.d.c.a.b.c.b.c
    a	d	0.2000000	b.d.a.d
    b	d	0.5000000	b.d.b.d
    d	b	0.4000000	b.d.d.b
    a	d	0.2000000	b.d.b.d.a.d
    b	d	0.5000000	b.d.a.d.b.d

In the above result the same rows (which represent connections) are selected multiple times (e.g. b,d; b,c; a,d...) although from the last column which represents the string already contains the combination of characters and therefore the connection should not be selected: in the first row string b.d is created and in the fourth row the same string is concatenated even though CAHRINDEX('b.d', Path) shouldn't be equal to zero.

Does anyone know how to modify the query statement above in order not to select same connections multiple times?

Thank you",sql,recursion,,,,,open,0,315,3,"recursive query problem Trying not to select same connection multiple times I have tried to use charindex() = 0 condition the following way:

    WITH Cluster(calling_party, called_party, link_strength, Path)
    AS
    (SELECT calling_party, called_party, link_strength, CONVERT(varchar(max), calling_party + '.' + called_party) AS Path FROM monthly_connections_test WHERE link_strength > 0.1 AND calling_party = 'b'
    UNION ALL
    SELECT mc.calling_party, mc.called_party, mc.link_strength, CONVERT(varchar(max), cl.Path + '.' + mc.calling_party + '.' + mc.called_party) AS Path FROM monthly_connections_test mc INNER JOIN Cluster cl ON (mc.called_party = cl.called_party OR mc.called_party = cl.calling_party) AND (CHARINDEX(cl.called_party + '.' + mc.calling_party, Path) = 0 AND CHARINDEX(cl.called_party + '.' + mc.called_party, Path) = 0) WHERE mc.link_strength > 0.1
    )
    SELECT calling_party, called_party, link_strength, Path FROM Cluster OPTION (maxrecursion 30000)

The condition however does not fulfill its purpose as the same rows are selected multiple times. The example query result is the following:

    b	d	0.5000000	b.d
    b	c	0.5000000	b.c
    b	c	0.5000000	b.c.b.c
    d	b	0.4000000	b.c.d.b
    a	d	0.2000000	b.c.d.b.a.d
    b	d	0.5000000	b.c.d.b.b.d
    d	b	0.4000000	b.c.d.b.d.b
    a	d	0.2000000	b.c.d.b.b.d.a.d
    a	d	0.2000000	b.c.d.b.a.d.a.d
    c	a	0.4000000	b.c.d.b.a.d.c.a
    c	a	0.4000000	b.c.d.b.a.d.c.a.c.a
    b	c	0.5000000	b.c.d.b.a.d.c.a.b.c
    b	c	0.5000000	b.c.d.b.a.d.c.a.b.c.b.c
    a	d	0.2000000	b.d.a.d
    b	d	0.5000000	b.d.b.d
    d	b	0.4000000	b.d.d.b
    a	d	0.2000000	b.d.b.d.a.d
    b	d	0.5000000	b.d.a.d.b.d

In the above result the same rows (which represent connections) are selected multiple times (e.g. b,d; b,c; a,d...) although from the last column which represents the string already contains the combination of characters and therefore the connection should not be selected: in the first row string b.d is created and in the fourth row the same string is concatenated even though CAHRINDEX('b.d', Path) shouldn't be equal to zero.

Does anyone know how to modify the query statement above in order not to select same connections multiple times?

Thank you",2
6647182,07/11/2011 07:50:03,349853,05/25/2010 11:47:41,153,5,how to update this kind of table,"    /*
    Duties
    */
    
    duty_id , duty_name 
    
    //duty_names are duty1,duty2,duty3,duty4,duty5
    
    /*
    Members-Duties
    */
    
    id , members_id , duty_id 
    
    /*
    Members-Duty-Scores
    */
    
    id , members_id , duty1 , duty2 , duty3 , duty4 , duty5

I want to update table **'Members-Duty-Scores'** but first i want to know the duties a  member is assigned by querying the **'Members-Duties'** table.A member can do all or some duties.How do i update table **'Members-Duty-Scores'**.

",sql,sqlite3,,,,07/11/2011 10:21:07,too localized,1,134,7,"how to update this kind of table     /*
    Duties
    */
    
    duty_id , duty_name 
    
    //duty_names are duty1,duty2,duty3,duty4,duty5
    
    /*
    Members-Duties
    */
    
    id , members_id , duty_id 
    
    /*
    Members-Duty-Scores
    */
    
    id , members_id , duty1 , duty2 , duty3 , duty4 , duty5

I want to update table **'Members-Duty-Scores'** but first i want to know the duties a  member is assigned by querying the **'Members-Duties'** table.A member can do all or some duties.How do i update table **'Members-Duty-Scores'**.

",2
7878830,10/24/2011 16:33:37,568262,01/08/2011 19:19:05,109,5,How to clear identity column to start value after delete first rows,"I have a little problem.

I had 50 rows with identity column id- autoincrement. So, first row had id 1, last row had id 50. Then, i delete rows from 1 to 25 and now i have rows with id 26-50.

Question:

How could i ""reinit"" this rows (26-50) to (1-25)? I don't need empty id's in table. Thx.

SQL Server 2008",sql,sql-server,,,,10/24/2011 17:32:49,not constructive,1,58,12,"How to clear identity column to start value after delete first rows I have a little problem.

I had 50 rows with identity column id- autoincrement. So, first row had id 1, last row had id 50. Then, i delete rows from 1 to 25 and now i have rows with id 26-50.

Question:

How could i ""reinit"" this rows (26-50) to (1-25)? I don't need empty id's in table. Thx.

SQL Server 2008",2
4624894,01/07/2011 11:14:24,558491,12/30/2010 16:41:02,1,0,AFTER INSERT ON TRIGGER MYSQL HELP URGENT,"Table abc fields aa(text/string),bb(text/string),cc(date),dd(date),ee(int/double),ff(int/double)

Problem 1: everytime i insert some value in the table abc for (""aa"",""bb"",""cc"" only 3 fields), i want the trigger to **create another table with newly or last added row** with name as ""i_like_you_aa_bb_(year of cc)"" and field values as ""bb"",""cc"" the trigger should cross check whether the new table exists. 

if yes then dont do anything 
if no then create another table

i will be entering around 3000 values for aa,bb,cc using csv file so 3000 new tables should be created. the amount of values in each of the newly created tables will be touching close to 50~100 million rows.

Problem 2: i want to validate the values entering into the table abc for the fields (aa,bb,cc) the value for aa field should have custome format like i_like_you_aa_bb_(year of cc)

Problem 3: everytime i upload the csv file(data) into the newly created table from the trigger of abc, a trigger should activate which will update the values in abc for the fields ""dd"",""ee"" & ""ff"" after the upload is done.

**abc is more like (table of contents ) and the each newly created table using aa (i_like_you_aa_bb_(year of cc)) will be the chapters and the page number needs to be updated into the abc (which is table of contents).**",sql,mysql,validation,triggers,insert-update,01/07/2011 11:30:55,not a real question,1,209,7,"AFTER INSERT ON TRIGGER MYSQL HELP URGENT Table abc fields aa(text/string),bb(text/string),cc(date),dd(date),ee(int/double),ff(int/double)

Problem 1: everytime i insert some value in the table abc for (""aa"",""bb"",""cc"" only 3 fields), i want the trigger to **create another table with newly or last added row** with name as ""i_like_you_aa_bb_(year of cc)"" and field values as ""bb"",""cc"" the trigger should cross check whether the new table exists. 

if yes then dont do anything 
if no then create another table

i will be entering around 3000 values for aa,bb,cc using csv file so 3000 new tables should be created. the amount of values in each of the newly created tables will be touching close to 50~100 million rows.

Problem 2: i want to validate the values entering into the table abc for the fields (aa,bb,cc) the value for aa field should have custome format like i_like_you_aa_bb_(year of cc)

Problem 3: everytime i upload the csv file(data) into the newly created table from the trigger of abc, a trigger should activate which will update the values in abc for the fields ""dd"",""ee"" & ""ff"" after the upload is done.

**abc is more like (table of contents ) and the each newly created table using aa (i_like_you_aa_bb_(year of cc)) will be the chapters and the page number needs to be updated into the abc (which is table of contents).**",5
11734864,07/31/2012 07:06:06,1017257,10/27/2011 20:04:06,563,34,select @variable=case when...end from... order by len(@variable),"What I'm trying to do is concatenate two fields of a table, sort them by the descending length of the concatenated fields and get the top result... 

Here's the SQL I'm using to try and achieve this... 

    declare @color nvarchar(255);
    declare @board_name nvarchar(255);

    select top(1)
		@board_name = board_name, 
		@color = base_color + case when shade_color is null then '' else '/' + shade_color end 
	from 
		cut_vinyl
	order by 
		len(@color) desc;

	select @board_name, @color;


So, if I had the following table for `cut_vinyl`

<pre>
<strong>board_name</strong> | <strong>base_color</strong> | <strong>shade_color</strong>
=====================================
board0001  | clear      | <em>NULL</em>
board0002  | clear      | blue
board0003  | bronze     | bronze
board0004  | bronze     | green
board0005  | bronze     | blue
board0006  | bronze     | <em>NULL</em>
</pre>

Then I would expect **`@board_name`** to be **board0003** and **`@color`** to be **bronze/bronze**, yet what I seem to be getting instead is a result like **`@board_name`** = **board0001**, and **`@color`** = **clear**

",sql,sql-server-2008,sql-server-2008r2-express,,,,open,0,179,7,"select @variable=case when...end from... order by len(@variable) What I'm trying to do is concatenate two fields of a table, sort them by the descending length of the concatenated fields and get the top result... 

Here's the SQL I'm using to try and achieve this... 

    declare @color nvarchar(255);
    declare @board_name nvarchar(255);

    select top(1)
		@board_name = board_name, 
		@color = base_color + case when shade_color is null then '' else '/' + shade_color end 
	from 
		cut_vinyl
	order by 
		len(@color) desc;

	select @board_name, @color;


So, if I had the following table for `cut_vinyl`

<pre>
<strong>board_name</strong> | <strong>base_color</strong> | <strong>shade_color</strong>
=====================================
board0001  | clear      | <em>NULL</em>
board0002  | clear      | blue
board0003  | bronze     | bronze
board0004  | bronze     | green
board0005  | bronze     | blue
board0006  | bronze     | <em>NULL</em>
</pre>

Then I would expect **`@board_name`** to be **board0003** and **`@color`** to be **bronze/bronze**, yet what I seem to be getting instead is a result like **`@board_name`** = **board0001**, and **`@color`** = **clear**

",3
515429,02/05/2009 11:01:21,4964,09/07/2008 03:07:41,94,2,How to round a Column defined as Float on INSERT and UPDATE in SQl Server 2005,"I am working on a Database that uses the Float data type to store values that should only be 2 decimal positions (dollars and cents). Using Float appears to work OK, as long as the person updating the Float column does a ROUND. Of course, this does not always happen and then when a SUM is done it is always off a few pennies from what is displayed because the display is formatted to show only 2 decmial positions. This database has hundreds of tables using Float and it would be helpful to be able to automatically ROUND the float columns.

Can this be done?

Can a TRIGGER be used on INSERT and UPDATE to do a ROUND on the Column?

If it can would you recommend it?

Any other ideas?

We are using SQL Server 2005.

Here is a post that asks the question [Use Float or Decimal for Accounting Application Dollar Amount?][1] and I like the one responce that said 

""You should really consider using some type of fixed point / arbitrary-precision number package (e.g. java BigNum, python decimal module) otherwise you'll be in for a **world of hurt**"". 

I feel the pain!


  [1]: http://stackoverflow.com/questions/61872/use-float-or-decimal-for-accounting-application-dollar-amount",sql,sql-server,triggers,insert-update,rounding,,open,0,192,16,"How to round a Column defined as Float on INSERT and UPDATE in SQl Server 2005 I am working on a Database that uses the Float data type to store values that should only be 2 decimal positions (dollars and cents). Using Float appears to work OK, as long as the person updating the Float column does a ROUND. Of course, this does not always happen and then when a SUM is done it is always off a few pennies from what is displayed because the display is formatted to show only 2 decmial positions. This database has hundreds of tables using Float and it would be helpful to be able to automatically ROUND the float columns.

Can this be done?

Can a TRIGGER be used on INSERT and UPDATE to do a ROUND on the Column?

If it can would you recommend it?

Any other ideas?

We are using SQL Server 2005.

Here is a post that asks the question [Use Float or Decimal for Accounting Application Dollar Amount?][1] and I like the one responce that said 

""You should really consider using some type of fixed point / arbitrary-precision number package (e.g. java BigNum, python decimal module) otherwise you'll be in for a **world of hurt**"". 

I feel the pain!


  [1]: http://stackoverflow.com/questions/61872/use-float-or-decimal-for-accounting-application-dollar-amount",5
4022592,10/26/2010 10:02:51,1104408,10/26/2010 08:55:12,1,0,Can not access SQL server 2005?,A specified SQL Server instance name is not valid.,sql,sql-server-2005,,,,10/26/2010 10:06:12,not a real question,1,9,6,Can not access SQL server 2005? A specified SQL Server instance name is not valid.,2
6016434,05/16/2011 11:04:33,214470,11/19/2009 10:13:15,460,9,In Sql Server 2005 is there any way to change the collation of a whole database at once?,"Using Sql Server management studio, I have backed up a database from one server and restored it to my local copy of Sql Server 2005. But the collation of the backed up database is LATIN_GENERAL_CP1_CI_AI and I am attempting to compare columns to a database which is LATIN_GENERAL_CI_AI.

The database has a lot of keys and constraints which makes changing each column individually throw errors.

What is the best way to change the collation of a whole database in SQL Server 2005? 

",sql,sql-server,tsql,,,,open,0,81,18,"In Sql Server 2005 is there any way to change the collation of a whole database at once? Using Sql Server management studio, I have backed up a database from one server and restored it to my local copy of Sql Server 2005. But the collation of the backed up database is LATIN_GENERAL_CP1_CI_AI and I am attempting to compare columns to a database which is LATIN_GENERAL_CI_AI.

The database has a lot of keys and constraints which makes changing each column individually throw errors.

What is the best way to change the collation of a whole database in SQL Server 2005? 

",3
7773054,10/14/2011 20:12:46,995992,10/14/2011 18:41:36,1,0,How to change update execution plan in Oracle?,"I have a large table foo_large and a relatively small (a few hundred thousand rows) table foo_small. The large table has a primary-key column ""id""; the small one also has ""id"" column that is a foreign key to foo_large. I want to update foo_small so that for every row its col_y has a value equal to col_x in the corresponding row of foo_large. The most straightforward way seems to be like this:

    update foo_small sm
    set col_y = (
      select col_x
      from foo_large
      where id = sm.id);

This is, however, very inefficient. For each row of foo_small, the corresponding row of foo_large is accessed by the index on its primary key. Though foo_small is small compared to foo_large, it still leads to several hundred thousand of index scans on that table. A better solution would be to hash foo_small in memory and perform a (possibly parallelized) full scan on foo_large once, updating the matching rows of foo_small encountered. I can do that in the following way:

    update
    (
      select /*+ ordered use_hash(lg) parallel(lg 2) */
        sm.*, lg.col_x
      from
        foo_small sm,
        foo_large lg
      where sm.id = lg.id
    )
    set col_y = col_x;

This query finishes within a minute. Unfortunately, it has another disadvantage: It requires that the user launching this query has a privilege to update not only foo_small, but also foo_large even though the latter table is not actually updated. Is there a solution to force the latter execution plan without updating a join? I know I could write a piece of procedural PL/SQL code with bulk fetch/update and probably keep most of the performance gain, but I suppose there must be a way to do it in a single query.

Thanks in advance.",sql,oracle,query,,,,open,0,350,8,"How to change update execution plan in Oracle? I have a large table foo_large and a relatively small (a few hundred thousand rows) table foo_small. The large table has a primary-key column ""id""; the small one also has ""id"" column that is a foreign key to foo_large. I want to update foo_small so that for every row its col_y has a value equal to col_x in the corresponding row of foo_large. The most straightforward way seems to be like this:

    update foo_small sm
    set col_y = (
      select col_x
      from foo_large
      where id = sm.id);

This is, however, very inefficient. For each row of foo_small, the corresponding row of foo_large is accessed by the index on its primary key. Though foo_small is small compared to foo_large, it still leads to several hundred thousand of index scans on that table. A better solution would be to hash foo_small in memory and perform a (possibly parallelized) full scan on foo_large once, updating the matching rows of foo_small encountered. I can do that in the following way:

    update
    (
      select /*+ ordered use_hash(lg) parallel(lg 2) */
        sm.*, lg.col_x
      from
        foo_small sm,
        foo_large lg
      where sm.id = lg.id
    )
    set col_y = col_x;

This query finishes within a minute. Unfortunately, it has another disadvantage: It requires that the user launching this query has a privilege to update not only foo_small, but also foo_large even though the latter table is not actually updated. Is there a solution to force the latter execution plan without updating a join? I know I could write a piece of procedural PL/SQL code with bulk fetch/update and probably keep most of the performance gain, but I suppose there must be a way to do it in a single query.

Thanks in advance.",3
3777748,09/23/2010 11:19:41,423887,08/18/2010 11:04:23,20,0,Changing Column Ordinal_position Positions,"My scenario:
           
        I can change the ordinal position of a column in a table.Is there a way to change the ordinal position of a column in a table without recreating the table?",sql,,,,,,open,0,50,4,"Changing Column Ordinal_position Positions My scenario:
           
        I can change the ordinal position of a column in a table.Is there a way to change the ordinal position of a column in a table without recreating the table?",1
6636216,07/09/2011 17:08:55,836906,07/09/2011 17:08:55,1,0,Use of @ in sql statements or in declaring variables?,Is there anyone who told me what is the use of @ in sql statements specially while declaring variables in sql query......thnx for any response.,sql,stored-procedures,plsql,,,,open,0,25,10,Use of @ in sql statements or in declaring variables? Is there anyone who told me what is the use of @ in sql statements specially while declaring variables in sql query......thnx for any response.,3
11612265,07/23/2012 12:10:24,426332,08/20/2010 12:23:05,2444,73,SQL BULK Insert eating up All available RAM,"I have created a very basic SQL table as following    

    CREATE TABLE [dbo].[TickData](
	[Date] [varchar](12) NULL,
	[Time] [varchar](12) NOT NULL,
	[Symbol] [varchar](12) NOT NULL,
	[Side] [varchar](2) NOT NULL,
	[Depth] [varchar](2) NOT NULL,
	[Quote] [varchar](12) NOT NULL,
	[Size] [varchar](18) NOT NULL
        ) ON [PRIMARY]

I then performed a 3 Gig Bulk Insert
    
        BULK
        INSERT TickData
        FROM 
        'C:\SUMO.csv'
        GO

Then RAM usage for SQL server went Skyrocking, eating up ~30Go of RAM : 

![enter image description here][1]

![enter image description here][2]


I prefer to think this is an abnormal behavior and that action can be taken to avoid this.

  [1]: http://i.stack.imgur.com/w0ABg.jpg
  [2]: http://i.stack.imgur.com/uV1Xg.jpg",sql,sql-server,,,,07/23/2012 12:51:07,off topic,1,146,8,"SQL BULK Insert eating up All available RAM I have created a very basic SQL table as following    

    CREATE TABLE [dbo].[TickData](
	[Date] [varchar](12) NULL,
	[Time] [varchar](12) NOT NULL,
	[Symbol] [varchar](12) NOT NULL,
	[Side] [varchar](2) NOT NULL,
	[Depth] [varchar](2) NOT NULL,
	[Quote] [varchar](12) NOT NULL,
	[Size] [varchar](18) NOT NULL
        ) ON [PRIMARY]

I then performed a 3 Gig Bulk Insert
    
        BULK
        INSERT TickData
        FROM 
        'C:\SUMO.csv'
        GO

Then RAM usage for SQL server went Skyrocking, eating up ~30Go of RAM : 

![enter image description here][1]

![enter image description here][2]


I prefer to think this is an abnormal behavior and that action can be taken to avoid this.

  [1]: http://i.stack.imgur.com/w0ABg.jpg
  [2]: http://i.stack.imgur.com/uV1Xg.jpg",2
3353496,07/28/2010 13:48:56,233421,12/17/2009 00:41:31,816,0,What is Locking in MySQL and when would you use it?,"What is Locking in MySQL (or any RDBMS) and when would you use it? A Layman explanation with a Example would be great!

Thank you in advance;-)",sql,mysql,sql-server,oracle,postgresql,07/19/2012 02:02:30,not constructive,1,26,11,"What is Locking in MySQL and when would you use it? What is Locking in MySQL (or any RDBMS) and when would you use it? A Layman explanation with a Example would be great!

Thank you in advance;-)",5
1926444,12/18/2009 05:21:39,179151,09/25/2009 16:18:49,19,4,How to implement Publishing subscriber Replication topology in SQL?,How to implement Publishing subscriber Replication topology in SQL?,sql,sql-server,sql-server-2005,,,,open,0,9,9,How to implement Publishing subscriber Replication topology in SQL? How to implement Publishing subscriber Replication topology in SQL?,3
6623802,07/08/2011 11:31:12,377407,06/27/2010 13:51:43,1,1,comparing two strings in SQL server,"Is there any way to compare two strings in SQL server 2008 stored procedure like below?

<br>
int returnval = STRCMP(str1, str2)
<br>
  

 - returns 0 if the strings are
   the same.<br>
 - returns -1 if the first
   argument is smaller than the second
   according to the current sort order.
 - returns 1 otherwise.

above method i find in the MySQL but not in SQLServer.",sql,string,sql-server-2008,comparision,,,open,0,69,6,"comparing two strings in SQL server Is there any way to compare two strings in SQL server 2008 stored procedure like below?

<br>
int returnval = STRCMP(str1, str2)
<br>
  

 - returns 0 if the strings are
   the same.<br>
 - returns -1 if the first
   argument is smaller than the second
   according to the current sort order.
 - returns 1 otherwise.

above method i find in the MySQL but not in SQLServer.",4
9073356,01/31/2012 01:37:21,1017513,10/28/2011 00:02:44,6,0,SQL Injection in a Disguise,"Sometimes SQL Inject queries may come in a disguise by using a different character set that you are used to. But even in those disguise modes, the query string would still include familiar words such as union and cast and varchar etc.. 

My question is this;

Is it possible to even disguise those words too? In other words, could ""union"" or ""cast"" be disguised as well?

",sql,injection,,,,01/31/2012 13:07:59,not constructive,1,65,5,"SQL Injection in a Disguise Sometimes SQL Inject queries may come in a disguise by using a different character set that you are used to. But even in those disguise modes, the query string would still include familiar words such as union and cast and varchar etc.. 

My question is this;

Is it possible to even disguise those words too? In other words, could ""union"" or ""cast"" be disguised as well?

",2
4766854,01/22/2011 08:17:48,585434,12/26/2010 10:13:49,1,0,SQL Performance: Using Union and Subqueries ,"Hi stackoverflow(My first question!), 

We're doing something like an SNS, and got a question about optimizing queries.

Using mysql 5.1, the current table was created with:
    CREATE TABLE friends(
     user_id BIGINT NOT NULL,
     friend_id BIGINT NOT NULL,
     PRIMARY KEY (user_id, friend_id)
    ) ENGINE INNODB;

Sample data is populated like:
    INSERT INTO friends VALUES
    (1,2),
    (1,3),
    (1,4),
    (1,5),
    (2,1),
    (2,3),
    (2,4),
    (3,1),
    (3,2),
    (4,1),
    (4,2),
    (5,1),
    (5,6),
    (6,5),
    (7,8),
    (8,7);

The business logic: we need to figure out which users are friends or friends of friends for a given user.
The current query for this for a user with user_id=1 is:
    SELECT friend_id FROM friends WHERE user_id = 1
     UNION
     SELECT DISTINCT friend_id FROM friends WHERE user_id IN (
     SELECT friend_id FROM friends WHERE user_id = 1
    );

As you can see, the above query performs the subquery ""SELECT friend_id FROM friends WHERE user_id = 1"" twice.

So, here is the question. If performance is your primary concern, how would you change the above query or schema?

Thanks in advance.
",sql,select,subquery,union,,,open,0,249,7,"SQL Performance: Using Union and Subqueries  Hi stackoverflow(My first question!), 

We're doing something like an SNS, and got a question about optimizing queries.

Using mysql 5.1, the current table was created with:
    CREATE TABLE friends(
     user_id BIGINT NOT NULL,
     friend_id BIGINT NOT NULL,
     PRIMARY KEY (user_id, friend_id)
    ) ENGINE INNODB;

Sample data is populated like:
    INSERT INTO friends VALUES
    (1,2),
    (1,3),
    (1,4),
    (1,5),
    (2,1),
    (2,3),
    (2,4),
    (3,1),
    (3,2),
    (4,1),
    (4,2),
    (5,1),
    (5,6),
    (6,5),
    (7,8),
    (8,7);

The business logic: we need to figure out which users are friends or friends of friends for a given user.
The current query for this for a user with user_id=1 is:
    SELECT friend_id FROM friends WHERE user_id = 1
     UNION
     SELECT DISTINCT friend_id FROM friends WHERE user_id IN (
     SELECT friend_id FROM friends WHERE user_id = 1
    );

As you can see, the above query performs the subquery ""SELECT friend_id FROM friends WHERE user_id = 1"" twice.

So, here is the question. If performance is your primary concern, how would you change the above query or schema?

Thanks in advance.
",4
6962430,08/05/2011 20:45:43,869583,07/29/2011 14:43:46,1,0,PostgreSQL cannot connect to database on localhost windows - why?,"PostgreSQL cannot connect to database on localhost windows - why ?

I just double click on server ant type password. It says ""Connecting to database... failed."".",sql,postgresql,py-postgresql,,,08/05/2011 21:36:44,off topic,1,25,10,"PostgreSQL cannot connect to database on localhost windows - why? PostgreSQL cannot connect to database on localhost windows - why ?

I just double click on server ant type password. It says ""Connecting to database... failed."".",3
5646730,04/13/2011 08:59:24,1168,08/13/2008 09:23:11,597,30,Updating filtered replicated rows on subscriber fails,"I have a merge replication scenario with 1 distributor/publisher and many subscribers.
There are only a few articles which are unfiltered everything else is filtered by HOST_NAME() and thus creating distinct (nonoverlapping) partitions.
I also tried filtering via SUSER_NAME() to no avail.

Filtering and distribution work perfect but updating on the subscriber fails with this error message:

> Cannot update the column in article '%s'. 
> The article has a value of 2 or 3 (nonoverlapping partitions) 
> for the partition_options property, and the column is involved
> in a row filter and/or a join filter. In this situation, the column cannot be
> updated at a Subscriber or republisher; it must be updated at the top-level Publisher

The article it fails on has a partition_options-setting of ""Nonoverlapping, single subscription"". 
The SQL I tried to execute is a simple parameterized UPDATE of a few nvarchars and bits.

Anybody any Idea what I'm missing? It can't be far...",sql,sql-server,replication,merge-replication,,,open,0,149,7,"Updating filtered replicated rows on subscriber fails I have a merge replication scenario with 1 distributor/publisher and many subscribers.
There are only a few articles which are unfiltered everything else is filtered by HOST_NAME() and thus creating distinct (nonoverlapping) partitions.
I also tried filtering via SUSER_NAME() to no avail.

Filtering and distribution work perfect but updating on the subscriber fails with this error message:

> Cannot update the column in article '%s'. 
> The article has a value of 2 or 3 (nonoverlapping partitions) 
> for the partition_options property, and the column is involved
> in a row filter and/or a join filter. In this situation, the column cannot be
> updated at a Subscriber or republisher; it must be updated at the top-level Publisher

The article it fails on has a partition_options-setting of ""Nonoverlapping, single subscription"". 
The SQL I tried to execute is a simple parameterized UPDATE of a few nvarchars and bits.

Anybody any Idea what I'm missing? It can't be far...",4
6106609,05/24/2011 06:36:38,767215,05/24/2011 06:35:27,1,0,I'm getting a SQL Timeout from a stored procedure on a specific OR condition - why?,"I have a simple query with a few joins. The query has a about 4 or 5 WHERE conditions, but it takes up to 15 seconds to return NO results. However, if I exclude a specific OR condition, it takes only 5 seconds and returns about 20 rows.

Anyway, I thought that maybe I should refactor the OR's somehow, because they don't have any inner selects or anything fancy, just a simple condition on a column.

Any ideas? This doesn't seem to be a table lock problem, and I'm running the query directly through SQL Management Studio (2008 RC2 server).

Thanks a ton",sql,sql-server-2008,timeoutexception,,,05/24/2011 11:11:33,not a real question,1,100,16,"I'm getting a SQL Timeout from a stored procedure on a specific OR condition - why? I have a simple query with a few joins. The query has a about 4 or 5 WHERE conditions, but it takes up to 15 seconds to return NO results. However, if I exclude a specific OR condition, it takes only 5 seconds and returns about 20 rows.

Anyway, I thought that maybe I should refactor the OR's somehow, because they don't have any inner selects or anything fancy, just a simple condition on a column.

Any ideas? This doesn't seem to be a table lock problem, and I'm running the query directly through SQL Management Studio (2008 RC2 server).

Thanks a ton",3
4071811,11/01/2010 18:19:05,89244,04/09/2009 20:45:09,142,2,How to transform vertical data into horizontal data with SQL?,"I have a table ""Item"" with a number of related items, like so:

    ID   Rel_ID  Name
    ---  ------  ----
    1    1       foo
    2    1       bar
    3    1       zam
    4    2       foo2

I'm trying to get a query so items with the same Rel_ID would appear in the same row, like so:

    Rel_ID  Name1  Name2  Name3
    ------  -----  -----  -----
    1       foo    bar    zam
    2       foo2

I've tried selecting the table multiple times:

    SELECT k.Rel_ID, k.name 'Name1', k2.name 'Name2'
    FROM item k, item k2
    WHERE k.Rel_ID = k2.Rel_ID

But this fails. Surely there's a transformation or query that could drastically simplify the process, and I'm just missing it because I haven't used SQL in this way before. What am I missing?",sql,mysql,,,,,open,0,221,10,"How to transform vertical data into horizontal data with SQL? I have a table ""Item"" with a number of related items, like so:

    ID   Rel_ID  Name
    ---  ------  ----
    1    1       foo
    2    1       bar
    3    1       zam
    4    2       foo2

I'm trying to get a query so items with the same Rel_ID would appear in the same row, like so:

    Rel_ID  Name1  Name2  Name3
    ------  -----  -----  -----
    1       foo    bar    zam
    2       foo2

I've tried selecting the table multiple times:

    SELECT k.Rel_ID, k.name 'Name1', k2.name 'Name2'
    FROM item k, item k2
    WHERE k.Rel_ID = k2.Rel_ID

But this fails. Surely there's a transformation or query that could drastically simplify the process, and I'm just missing it because I haven't used SQL in this way before. What am I missing?",2
10170681,04/16/2012 08:14:36,494540,11/02/2010 09:24:56,1830,103,Most efficient way to select record if a value has changed,"What would be the most efficient way to select a record when one of the value has changed? 
Ex: 

I have an account history table like below where records are being created when the account change:

    Id  AcctNb Active Created
    8   123456 1      01/03/2012
    6   123456 0      01/01/2012


I like to find an efficient way to return the record where the active status has changed since the last entry.",sql,query-optimization,,,,,open,0,92,11,"Most efficient way to select record if a value has changed What would be the most efficient way to select a record when one of the value has changed? 
Ex: 

I have an account history table like below where records are being created when the account change:

    Id  AcctNb Active Created
    8   123456 1      01/03/2012
    6   123456 0      01/01/2012


I like to find an efficient way to return the record where the active status has changed since the last entry.",2
11401221,07/09/2012 18:50:51,318663,04/16/2010 15:58:31,131,2,UPDATE sql query from two table values,"I have 2 tables with values stored as below.

**Table1**

    ReferranceID   StatusNumber   ServiceType            T2OpenDt          T1OpenDT
    162987	        399519	      Orthopaedic Surgery		NULL	       2011-08-19 
    162987	        399525	      Acupuncture	            NULL	       2011-08-19 
    162987	        413405	      Anesthesiology	        NULL	       2011-09-28 
    162987	        517174	      Chiropractic	            NULL	       2012-04-26

**Table2**

    ReferranceID StatusNumber   Status     T2OpenDate
    162987	     256033	        Closed	   2010-11-17 
    162987	     488518	        ReOpen	   2012-02-22 

The first table should be updated as below from the 2nd table. (i.e the Result values)

    ReferranceID   StatusNumber   ServiceType               T2OpenDt          T1OpenDT
    162987	        399519	      Orthopaedic Surgery		2010-11-17	       2011-08-19 
    162987	        399525	      Acupuncture	            2010-11-17	       2011-08-19 
    162987	        413405	      Anesthesiology	        2010-11-17	       2011-09-28 
    162987	        517174	      Chiropractic	            2012-02-22	       2012-04-26 

**'2010-11-17'** will be updated in **3 rows** since the T2OpenDate is less than T1Opendate and
there is only one occurance of **2012-02-22** since this date is slightly greater than other 3 top T1OpenDate and less than the 4th T1OpenDate. 


Could anybody suggest me the UPDATE sqlquery for the above.  Thank you so very much for helping me.",sql,sql-server,tsql,sql-server-2005,,,open,0,475,7,"UPDATE sql query from two table values I have 2 tables with values stored as below.

**Table1**

    ReferranceID   StatusNumber   ServiceType            T2OpenDt          T1OpenDT
    162987	        399519	      Orthopaedic Surgery		NULL	       2011-08-19 
    162987	        399525	      Acupuncture	            NULL	       2011-08-19 
    162987	        413405	      Anesthesiology	        NULL	       2011-09-28 
    162987	        517174	      Chiropractic	            NULL	       2012-04-26

**Table2**

    ReferranceID StatusNumber   Status     T2OpenDate
    162987	     256033	        Closed	   2010-11-17 
    162987	     488518	        ReOpen	   2012-02-22 

The first table should be updated as below from the 2nd table. (i.e the Result values)

    ReferranceID   StatusNumber   ServiceType               T2OpenDt          T1OpenDT
    162987	        399519	      Orthopaedic Surgery		2010-11-17	       2011-08-19 
    162987	        399525	      Acupuncture	            2010-11-17	       2011-08-19 
    162987	        413405	      Anesthesiology	        2010-11-17	       2011-09-28 
    162987	        517174	      Chiropractic	            2012-02-22	       2012-04-26 

**'2010-11-17'** will be updated in **3 rows** since the T2OpenDate is less than T1Opendate and
there is only one occurance of **2012-02-22** since this date is slightly greater than other 3 top T1OpenDate and less than the 4th T1OpenDate. 


Could anybody suggest me the UPDATE sqlquery for the above.  Thank you so very much for helping me.",4
6519,08/09/2008 01:45:25,788,08/09/2008 00:17:36,1,1,Learning SQL,"I am a software engineer and I work for a small company, which means I have to do just about everything myself. So what is the best way to learn absolutely everything you need to know about SQL? Everything from the language, to managing databases, to programming to a database with C# 2.0 and what what version to use (free for commercial use is better, but not required).",sql,,,,,11/16/2011 00:12:11,not constructive,1,68,2,"Learning SQL I am a software engineer and I work for a small company, which means I have to do just about everything myself. So what is the best way to learn absolutely everything you need to know about SQL? Everything from the language, to managing databases, to programming to a database with C# 2.0 and what what version to use (free for commercial use is better, but not required).",1
31500,08/28/2008 02:00:09,493,08/06/2008 10:25:05,2416,162,"Do indexes work with ""IN"" clause","If I have a query like:

    Select EmployeeId From Employee Where EmployeeTypeId IN (1,2,3)

and I have an index on the EmployeeTypeId field, does SQL server still use that index?",sql,query,indexing,,,05/03/2012 19:49:26,not a real question,1,32,6,"Do indexes work with ""IN"" clause If I have a query like:

    Select EmployeeId From Employee Where EmployeeTypeId IN (1,2,3)

and I have an index on the EmployeeTypeId field, does SQL server still use that index?",3
10986230,06/11/2012 19:20:35,962891,09/24/2011 18:10:11,1111,2,SQL: differencing between SUMs calculated over a period,"I have a table that looks like this:

    CREATE TABLE foobar (
                         id                     SERIAL PRIMARY KEY,
                         data_entry_date        DATE NOT NULL,
                         user_id                INTEGER NOT NULL,
                         wine_glasses_drunk     INTEGER NOT NULL,
                         whisky_shots_drunk     INTEGER NOT NULL,
                         beer_bottle_drunk      INTEGER NOT NULL
                     );


I want to write a query that shows me the difference in TOTAL wine_glasses_drunk, TOTAL whisky_shots_drunk and TOTAL beer_bottles_drunk over a given period, compared to the TOTALs for the previous period.

It probably sounds more complicated than it is. If we are using a period* of 1 **week** == 7 days, then the query should return the difference in the totals consumed for **this week**, as compared to the totals consumed **last week**.

A slight complication is that the dates in the table are not continuous - i.e. there are some missing dates, so the query needs to find the most relevant date when determining dates for period calculations.

    This is what I have so far:
    
    -- startdate='2010-01-01'
    -- enddate='2010-18-01'
    
    SELECT SUM(f1.wine_glasses_drunk) - SUM(f2.wine_glasses_drunk) as wine_diff, SUM(f1.whisky_shots_drunk) - SUM(f2.whisky_shots_drunk) as whisky_diff, SUM(f1.beer_bottle_drunk) - SUM(f2.beer_bottle_drunk) beer_diff FROM foobar f1 INNER JOIN foobar f2 ON f2.id=f1.id
    WHERE f1.user_id=1
    AND f1.data_entry_date BETWEEN '(SQL1)' AND '(SQL2)'
    AND f2.data_entry_date BETWEEN '(SQL2)' AND '(SQL3)'
    GROUP BY user_id, data_entry_date


Where:

- SQL1 = SQL query to fetch startdate or date nearest to it in the table foobar
- SQL2 = SQL query to fetch date that is **period** days away from startdate (or date - nearest to the calculated date) in the table foobar
- SQL3 = SQL query to fetch date that is **2xperiod** days away from startdate (or date nearest to the calculated date) in the table foobar


The must be a better way to write this query. Can someone help?. I am using postgreSQl, but would prefer if possible, database agnostic (i.e. ANSI) SQL.


***Note:** The period is a parameter that is passed to the query
",sql,postgresql,,,,,open,0,554,8,"SQL: differencing between SUMs calculated over a period I have a table that looks like this:

    CREATE TABLE foobar (
                         id                     SERIAL PRIMARY KEY,
                         data_entry_date        DATE NOT NULL,
                         user_id                INTEGER NOT NULL,
                         wine_glasses_drunk     INTEGER NOT NULL,
                         whisky_shots_drunk     INTEGER NOT NULL,
                         beer_bottle_drunk      INTEGER NOT NULL
                     );


I want to write a query that shows me the difference in TOTAL wine_glasses_drunk, TOTAL whisky_shots_drunk and TOTAL beer_bottles_drunk over a given period, compared to the TOTALs for the previous period.

It probably sounds more complicated than it is. If we are using a period* of 1 **week** == 7 days, then the query should return the difference in the totals consumed for **this week**, as compared to the totals consumed **last week**.

A slight complication is that the dates in the table are not continuous - i.e. there are some missing dates, so the query needs to find the most relevant date when determining dates for period calculations.

    This is what I have so far:
    
    -- startdate='2010-01-01'
    -- enddate='2010-18-01'
    
    SELECT SUM(f1.wine_glasses_drunk) - SUM(f2.wine_glasses_drunk) as wine_diff, SUM(f1.whisky_shots_drunk) - SUM(f2.whisky_shots_drunk) as whisky_diff, SUM(f1.beer_bottle_drunk) - SUM(f2.beer_bottle_drunk) beer_diff FROM foobar f1 INNER JOIN foobar f2 ON f2.id=f1.id
    WHERE f1.user_id=1
    AND f1.data_entry_date BETWEEN '(SQL1)' AND '(SQL2)'
    AND f2.data_entry_date BETWEEN '(SQL2)' AND '(SQL3)'
    GROUP BY user_id, data_entry_date


Where:

- SQL1 = SQL query to fetch startdate or date nearest to it in the table foobar
- SQL2 = SQL query to fetch date that is **period** days away from startdate (or date - nearest to the calculated date) in the table foobar
- SQL3 = SQL query to fetch date that is **2xperiod** days away from startdate (or date nearest to the calculated date) in the table foobar


The must be a better way to write this query. Can someone help?. I am using postgreSQl, but would prefer if possible, database agnostic (i.e. ANSI) SQL.


***Note:** The period is a parameter that is passed to the query
",2
11103821,06/19/2012 15:03:11,1094442,12/12/2011 19:46:49,38,2,Format persisted column as padded integer string in MS SQL Server 2008,"How would I create the formula for adding the two columns below togehter, the first must be padded to 5 characters:

ID (INT)
RefNum (STRING)

I went for format(ID,""00000"") & RefNum, but it doesn't work, any ideas please?",sql,sql-server-2008,formula,persisted-column,,06/19/2012 18:20:41,not a real question,1,35,12,"Format persisted column as padded integer string in MS SQL Server 2008 How would I create the formula for adding the two columns below togehter, the first must be padded to 5 characters:

ID (INT)
RefNum (STRING)

I went for format(ID,""00000"") & RefNum, but it doesn't work, any ideas please?",4
4788908,01/25/2011 00:47:36,69041,02/20/2009 18:09:53,467,5,Check if Database Exists -- Engine Agnostic,"I know, I know...I did not even want to ask the question because I think there is no way to do besides the ""try and miss"" approach (try to make a query to the db and catch the error/exception if does not exists) but I felt like asking the pros.

So, is there a way, non db-engine dependent, to check if a db exists?
",sql,,,,,,open,0,63,7,"Check if Database Exists -- Engine Agnostic I know, I know...I did not even want to ask the question because I think there is no way to do besides the ""try and miss"" approach (try to make a query to the db and catch the error/exception if does not exists) but I felt like asking the pros.

So, is there a way, non db-engine dependent, to check if a db exists?
",1
8472216,12/12/2011 09:28:18,1092216,12/11/2011 12:26:16,1,0,SQL Server 2005 - Update/Insert Performance degrades when invoked along with bigger select statements,"I have a .NET application which has a custom cache - this custom cache is our own code in .NET which stores the data in a Dictionary. This custom cache is refilled from the data in the database once a minute. Once this cache is loaded into the memory, it takes up 300MB of space in memory. The total size of the database is ~5GB. The underlying database is SQL Server 2005 running on Windows Server 2003, 32 bit. Building of the cache involves multiple complex  queries and typically it takes 15 to 20 seconds. This is not the problem area.

When any other operation is performed during this cache refill time (which involves multiple select and insert statements), we see that the performance of that particular operation takes 2x or 3x the usual time. I have not been able to figure out why it takes longer time?

I have monitored the CPU - during the cache refill it takes only 50-60% of CPU time. It has 12GB of RAM. Buffer Cache Hit ratio is consistenly >99% and free pages is well above 100, usually 1000. 

With enough CPU, Memory available, why does the performance degrade if those operations are performed during our custom cache refill? Any advice on this would be greatly helpful. Are there other parameters that I need to monitor?

Thanks,
Prasanna",sql,performance,server,,,12/13/2011 13:20:25,not a real question,1,222,14,"SQL Server 2005 - Update/Insert Performance degrades when invoked along with bigger select statements I have a .NET application which has a custom cache - this custom cache is our own code in .NET which stores the data in a Dictionary. This custom cache is refilled from the data in the database once a minute. Once this cache is loaded into the memory, it takes up 300MB of space in memory. The total size of the database is ~5GB. The underlying database is SQL Server 2005 running on Windows Server 2003, 32 bit. Building of the cache involves multiple complex  queries and typically it takes 15 to 20 seconds. This is not the problem area.

When any other operation is performed during this cache refill time (which involves multiple select and insert statements), we see that the performance of that particular operation takes 2x or 3x the usual time. I have not been able to figure out why it takes longer time?

I have monitored the CPU - during the cache refill it takes only 50-60% of CPU time. It has 12GB of RAM. Buffer Cache Hit ratio is consistenly >99% and free pages is well above 100, usually 1000. 

With enough CPU, Memory available, why does the performance degrade if those operations are performed during our custom cache refill? Any advice on this would be greatly helpful. Are there other parameters that I need to monitor?

Thanks,
Prasanna",3
6639555,07/10/2011 06:12:49,361022,06/08/2010 04:32:25,76,5,Need help for a query of MS SQL,"I am struggle with a piece of query of MS SQL.

That sounds very simple but I just cannot make it.

Assume there is a student, who takes 5 courses. I would like to know the related information of the 5 courses, and how many people take those 5 courses.

So we have 2 tables.

Course Table, includes all the related information of course.

Attendant Table, indicate which student take which course.

Any help please? Thanks!",sql,ms,,,,07/10/2011 07:39:55,not a real question,1,70,8,"Need help for a query of MS SQL I am struggle with a piece of query of MS SQL.

That sounds very simple but I just cannot make it.

Assume there is a student, who takes 5 courses. I would like to know the related information of the 5 courses, and how many people take those 5 courses.

So we have 2 tables.

Course Table, includes all the related information of course.

Attendant Table, indicate which student take which course.

Any help please? Thanks!",2
1985254,12/31/2009 12:42:08,241526,12/31/2009 12:42:08,1,0,MSSQL - Can you add field descriptions in CREATE TABLE?,"I can see plenty of posts about where the field description extended property lives and how I can get it, but nothing about adding these at the CREATE TABLE stage.
I'm dynamically creating tables so dynamically adding field descriptions would be a tidy thing to do but I cannot see a way.
Has anyone managed to do this?",sql,create,table,field,description,,open,0,56,10,"MSSQL - Can you add field descriptions in CREATE TABLE? I can see plenty of posts about where the field description extended property lives and how I can get it, but nothing about adding these at the CREATE TABLE stage.
I'm dynamically creating tables so dynamically adding field descriptions would be a tidy thing to do but I cannot see a way.
Has anyone managed to do this?",5
689912,03/27/2009 14:14:36,16534,09/17/2008 18:05:52,419,26,SQL: retrieve only the records whose value has changed  ,"Sorry for the nondescript title. I'll edit as we go along.

I have a table `RateTable`:

    | Code   |  Date     |   Rate  |

      B001     2009-01-01   1.05
      B001     2009-01-02   1.05
      B001     2009-01-03   1.05
      B001     2009-01-04   1.05
      B001     2009-01-05   1.06
      B001     2009-01-06   1.06
      B001     2009-01-07   1.06
      B001     2009-01-08   1.07

There is an entry for each day, but the Rate rarely changes. Can I write a SQL query that will only return the rows in which a Rate change occurs? I'm using SQLServer
",sql,sql-server,,,,,open,0,179,11,"SQL: retrieve only the records whose value has changed   Sorry for the nondescript title. I'll edit as we go along.

I have a table `RateTable`:

    | Code   |  Date     |   Rate  |

      B001     2009-01-01   1.05
      B001     2009-01-02   1.05
      B001     2009-01-03   1.05
      B001     2009-01-04   1.05
      B001     2009-01-05   1.06
      B001     2009-01-06   1.06
      B001     2009-01-07   1.06
      B001     2009-01-08   1.07

There is an entry for each day, but the Rate rarely changes. Can I write a SQL query that will only return the rows in which a Rate change occurs? I'm using SQLServer
",2
11646124,07/25/2012 08:59:27,907687,08/23/2011 12:13:59,1711,89,How i can create a table having 2 long columns?,"I am using oracle 10 g.

I have a table which needs 2 column of `Long` type.

    CREATE TABLE qrtz_simprop_triggers
     (          
        id1 LONG NULL,
        id2 LONG NULL,
        //
        // other columns.
    );

When i am executing this query, it is giving me this error.


    Error report:
    SQL Error: ORA-01754: a table may contain only one column of type LONG
    01754. 00000 -  ""a table may contain only one column of type LONG""
    *Cause:    An attempt was made to add a LONG column to a table which already
               had a LONG column. Note that even if the LONG column currently
               in the table has already been marked unused, another LONG column
               may not be added until the unused columns are dropped.
    *Action:   Remove the LONG column currently in the table by using the ALTER
               TABLE command.


I searched on google but could not found proper solution.
Why does they dont allow 2 columns of `LONG`? 

How i can achieve this?

Thanks in advance.",sql,oracle,,,,,open,0,282,10,"How i can create a table having 2 long columns? I am using oracle 10 g.

I have a table which needs 2 column of `Long` type.

    CREATE TABLE qrtz_simprop_triggers
     (          
        id1 LONG NULL,
        id2 LONG NULL,
        //
        // other columns.
    );

When i am executing this query, it is giving me this error.


    Error report:
    SQL Error: ORA-01754: a table may contain only one column of type LONG
    01754. 00000 -  ""a table may contain only one column of type LONG""
    *Cause:    An attempt was made to add a LONG column to a table which already
               had a LONG column. Note that even if the LONG column currently
               in the table has already been marked unused, another LONG column
               may not be added until the unused columns are dropped.
    *Action:   Remove the LONG column currently in the table by using the ALTER
               TABLE command.


I searched on google but could not found proper solution.
Why does they dont allow 2 columns of `LONG`? 

How i can achieve this?

Thanks in advance.",2
9082970,01/31/2012 16:18:25,1086159,12/07/2011 17:12:59,13,0,Declaring the scalar variable?,"I am trying to produce a sql query based report that will allow a date range to be inserted in order to get a selection of the data available.

The problem I am having is that wen i try this i get the error - 
  Must declare the scalar variable ""@DateFrom"".

the sql i am using is below:

SELECT
  [Cost Category ID]
FROM 
   SRVS.dbo.PACostCategories
WHERE
    (@DateFrom IS NULL OR alias.myDate>= @DateFrom) AND
    (@DateTo IS NULL OR alias.MyDate < DATEADD(d, 1, @DateTo))

any pointers to get me in the right direction much appreciated.",sql,declare,,,,02/01/2012 13:56:26,not a real question,1,98,4,"Declaring the scalar variable? I am trying to produce a sql query based report that will allow a date range to be inserted in order to get a selection of the data available.

The problem I am having is that wen i try this i get the error - 
  Must declare the scalar variable ""@DateFrom"".

the sql i am using is below:

SELECT
  [Cost Category ID]
FROM 
   SRVS.dbo.PACostCategories
WHERE
    (@DateFrom IS NULL OR alias.myDate>= @DateFrom) AND
    (@DateTo IS NULL OR alias.MyDate < DATEADD(d, 1, @DateTo))

any pointers to get me in the right direction much appreciated.",2
10168354,04/16/2012 03:23:20,942004,09/13/2011 07:19:37,14,1,"Yii framework, Login , SQL injection","Recently I receive a email, claiming that he can change my admin password by sql injection.
Here is my code. It is developed using Yii php framework. Can anyone see the flaws?

    	public function actionLogin()
	{
		
		$model=new LoginForm;

		// if it is ajax validation request
		if(isset($_POST['ajax']) && $_POST['ajax']==='login-form')
		{
			echo CActiveForm::validate($model);
			Yii::app()->end();
		}

		// collect user input data
		if(isset($_POST['LoginForm']))
		{
			$model->attributes=$_POST['LoginForm'];
			// validate user input and redirect to the previous page if valid
			if($model->validate() && $model->login())
				$this->redirect(Yii::app()->user->returnUrl);
		}
		// display the login form
		$this->render('login',array('model'=>$model));
	}
",sql,login,yii,injection,,,open,0,68,6,"Yii framework, Login , SQL injection Recently I receive a email, claiming that he can change my admin password by sql injection.
Here is my code. It is developed using Yii php framework. Can anyone see the flaws?

    	public function actionLogin()
	{
		
		$model=new LoginForm;

		// if it is ajax validation request
		if(isset($_POST['ajax']) && $_POST['ajax']==='login-form')
		{
			echo CActiveForm::validate($model);
			Yii::app()->end();
		}

		// collect user input data
		if(isset($_POST['LoginForm']))
		{
			$model->attributes=$_POST['LoginForm'];
			// validate user input and redirect to the previous page if valid
			if($model->validate() && $model->login())
				$this->redirect(Yii::app()->user->returnUrl);
		}
		// display the login form
		$this->render('login',array('model'=>$model));
	}
",4
3493698,08/16/2010 13:43:46,407309,07/31/2010 05:52:58,24,1,problem in query,"
i have more tables that i want to cross join them and i want to show each tabale with fields like this: tb1.filed1 tb1.filed2 tb2.filed1 ..... should i do? i mean how can i select fields with details like it's tabale's name.thanks....
",sql,,,,,08/17/2010 10:10:06,not a real question,1,42,3,"problem in query 
i have more tables that i want to cross join them and i want to show each tabale with fields like this: tb1.filed1 tb1.filed2 tb2.filed1 ..... should i do? i mean how can i select fields with details like it's tabale's name.thanks....
",1
11014219,06/13/2012 11:49:39,1033848,11/07/2011 13:46:46,49,4,SQl connection and Server connection,"Can anyone tell me what is the difference between a SQL connection class and a Server connection class?

",sql,,,,,06/13/2012 13:26:33,not a real question,1,18,5,"SQl connection and Server connection Can anyone tell me what is the difference between a SQL connection class and a Server connection class?

",1
2511117,03/24/2010 20:24:12,17324,09/18/2008 06:45:00,382,13,Is there an extensible SQL like query language that is safe for exposing via a public API?,"I want to expose some spatial (and a few non-spatial) datasets via a public API.
The backend store will either be PostgreSQL/PostGIS, sqlite/spatialite, or CouchDB/GeoCouch.  

My goal is to find a some, preferably standard, way to allow people to make complex spatial queries against the data.  I would like it to be a simple GET based request.
The idea is to allow *safe* SQL type queries, without allowing unsafe ones.  I would rather modify something that is off the shelf than doing the entire thing myself.
I specifically want to support requesting specific fields from a table; joining results; and spatial functions that are already implemented by the underlying datastore.

Ideas anyone?",sql,geospatial,api,web-services,,,open,0,111,17,"Is there an extensible SQL like query language that is safe for exposing via a public API? I want to expose some spatial (and a few non-spatial) datasets via a public API.
The backend store will either be PostgreSQL/PostGIS, sqlite/spatialite, or CouchDB/GeoCouch.  

My goal is to find a some, preferably standard, way to allow people to make complex spatial queries against the data.  I would like it to be a simple GET based request.
The idea is to allow *safe* SQL type queries, without allowing unsafe ones.  I would rather modify something that is off the shelf than doing the entire thing myself.
I specifically want to support requesting specific fields from a table; joining results; and spatial functions that are already implemented by the underlying datastore.

Ideas anyone?",4
11672987,07/26/2012 15:40:51,1541869,07/20/2012 22:01:57,6,0,Add a number to an existing number in an existing column,How can I add a number (which is the file #) to an existing column in all tables in the database in SQL? I want to multiply the file # ( say 111111) by 100 (11111100) and then add the current value in the existing column (say 24) so the final value in the column will be 11111124. sorry if its too specific to ask,sql,sql-server,database,,,07/28/2012 10:58:43,not a real question,1,65,11,Add a number to an existing number in an existing column How can I add a number (which is the file #) to an existing column in all tables in the database in SQL? I want to multiply the file # ( say 111111) by 100 (11111100) and then add the current value in the existing column (say 24) so the final value in the column will be 11111124. sorry if its too specific to ask,3
9860083,03/25/2012 12:26:10,976936,10/03/2011 15:12:01,8,0,optimized query of 2 tables,"I have 2 tables.

    Restaurant
    ------------------
    id, name, address

    Inspection
    ---------------------------------------------
    id, result, date_of_inspection, restaurant_id 

Now each Restaurant have 1 or more inspections. So what i want to do is list out all the restaurants and show their latest inspection_result.

Is it possible to do this in 1 query and without having the result set contain 1 row for each inspection?

Ideally each returned row would contain something like this:

    Result row
    ------------------------------------
    restaurantid, name, address, result
",sql,sqlite,,,,,open,0,102,5,"optimized query of 2 tables I have 2 tables.

    Restaurant
    ------------------
    id, name, address

    Inspection
    ---------------------------------------------
    id, result, date_of_inspection, restaurant_id 

Now each Restaurant have 1 or more inspections. So what i want to do is list out all the restaurants and show their latest inspection_result.

Is it possible to do this in 1 query and without having the result set contain 1 row for each inspection?

Ideally each returned row would contain something like this:

    Result row
    ------------------------------------
    restaurantid, name, address, result
",2
7865414,10/23/2011 09:48:02,986139,10/09/2011 07:18:02,1,0,How to execute a SELECT on a table with a list of composite keys?,"If I have a table with columns like
> ID1 ID2 VAL1 VAL2

Where ID1,ID2 makes the primary key index.

How do I execute any SQL statements for specific ID1,ID2 values?

Example: I have table with records that has PK (1,1) (1,2) (2,4) (2,1) (3,1) (3,2) (3,5)

I want to only select records with (1,1) (1,2) (3,5) (3,2)

A SELECT query with

> SELECT * FROM tbl1 WHERE ID1 IN (1,3) AND ID2 IN (1,2,5)


will yield undesired result: (3,1). So what's the best way to do this?

I am looking for an overall answer for SQL, but if it is dependent on the DBMS, I would like to know how to do so in PostgreSQL and MySQL.",sql,,,,,,open,0,109,14,"How to execute a SELECT on a table with a list of composite keys? If I have a table with columns like
> ID1 ID2 VAL1 VAL2

Where ID1,ID2 makes the primary key index.

How do I execute any SQL statements for specific ID1,ID2 values?

Example: I have table with records that has PK (1,1) (1,2) (2,4) (2,1) (3,1) (3,2) (3,5)

I want to only select records with (1,1) (1,2) (3,5) (3,2)

A SELECT query with

> SELECT * FROM tbl1 WHERE ID1 IN (1,3) AND ID2 IN (1,2,5)


will yield undesired result: (3,1). So what's the best way to do this?

I am looking for an overall answer for SQL, but if it is dependent on the DBMS, I would like to know how to do so in PostgreSQL and MySQL.",1
11677890,07/26/2012 20:54:34,1555971,07/26/2012 20:30:53,1,0,reduce the waiting time in open very big files .txt,"I have some tables +100M rows that i need to import/export, tranform etc.. and is take some time to open each file (.txt), 5-7 min. 

I ask the team leader if is exist another way to consult the transformed data from this .txt files and he told me that is not exist another better option..!! so this is very strange for me because I can not believe, that the simple notepad make it by Microsoft is the best developed tool from entire world., Spend it hours by looking Ctrl+. it can not be",sql,database,oracle,file,console,07/26/2012 23:01:45,off topic,1,93,10,"reduce the waiting time in open very big files .txt I have some tables +100M rows that i need to import/export, tranform etc.. and is take some time to open each file (.txt), 5-7 min. 

I ask the team leader if is exist another way to consult the transformed data from this .txt files and he told me that is not exist another better option..!! so this is very strange for me because I can not believe, that the simple notepad make it by Microsoft is the best developed tool from entire world., Spend it hours by looking Ctrl+. it can not be",5
2429126,03/11/2010 22:18:21,215120,11/10/2009 05:09:30,135,2,SELECT only a certain set of rows at a time,"I need to select data from one table and insert it into another table. Currently the SQL looks something like this:

       INSERT INTO A (x, y, z)
       SELECT x, y, z
       FROM B b
       WHERE ...

However, the SELECT is huge, resulting in over 2 millions rows and we think it is taking up too much memory. Informix, the db in this case, runs out of virtual memory when the query is run.

How would I go about selecting and inserting a set of rows (say 2000)? Given that I don't think there are any row ids etc.",sql,database,select,informix,,,open,0,120,10,"SELECT only a certain set of rows at a time I need to select data from one table and insert it into another table. Currently the SQL looks something like this:

       INSERT INTO A (x, y, z)
       SELECT x, y, z
       FROM B b
       WHERE ...

However, the SELECT is huge, resulting in over 2 millions rows and we think it is taking up too much memory. Informix, the db in this case, runs out of virtual memory when the query is run.

How would I go about selecting and inserting a set of rows (say 2000)? Given that I don't think there are any row ids etc.",4
10383252,04/30/2012 11:51:43,509555,11/16/2010 13:21:25,302,13,"SQL to get X number of accounts from DB, which could be variable number of rows","I have a SQLServer table AccountAction which is denormalised. It is a flattened version of the Account and Action tables, which I'm hoping should be alot quicker for reporting queries over millions of rows. One Account can have many Actions, so the table looks similar to:

    *Account*   *Action*
    account1    action1
    account1    action2
    account1    action10
    account2    action5

However I'm having some trouble getting the information back for a restricted subset in a simple stored procedure.

    select Account, Action
    from AccountAction
    where ???

What I'm looking for is to get the first X accounts, with all their actions. So this will be a dynamic number of rows. So using the example table above if I passed in 1, I would get 3 rows (i.e. give me all rows for the first account).

(I don't mind that the account name will be in each row - it is pivoted elsewhere)

Do I need to use a ROWNUM or similar to restrict the rows? I'm sure this must be a simpler issue than I've found so far.",sql,sql-server,stored-procedures,,,,open,0,207,16,"SQL to get X number of accounts from DB, which could be variable number of rows I have a SQLServer table AccountAction which is denormalised. It is a flattened version of the Account and Action tables, which I'm hoping should be alot quicker for reporting queries over millions of rows. One Account can have many Actions, so the table looks similar to:

    *Account*   *Action*
    account1    action1
    account1    action2
    account1    action10
    account2    action5

However I'm having some trouble getting the information back for a restricted subset in a simple stored procedure.

    select Account, Action
    from AccountAction
    where ???

What I'm looking for is to get the first X accounts, with all their actions. So this will be a dynamic number of rows. So using the example table above if I passed in 1, I would get 3 rows (i.e. give me all rows for the first account).

(I don't mind that the account name will be in each row - it is pivoted elsewhere)

Do I need to use a ROWNUM or similar to restrict the rows? I'm sure this must be a simpler issue than I've found so far.",3
7734152,10/12/2011 00:49:59,39478,11/20/2008 21:39:57,1609,55,Can you pivot and aggregate on two columns with a Sql PIVOT query,"Can you pivot two columns in a pivot query.

Suppose I have the following data...

    CREATE TABLE JudgeScores (PerformanceID int, JudgeID int, Criteria varchar(10), StrengthScore decimal(9,4), StyleScore decimal(9,4))
    
    --first team performance
    --judge1
    INSERT INTO JudgeScores (1, 1, ""Stunts"",        4.2, 1.1)
    INSERT INTO JudgeScores (1, 1, ""Jumps"",         3.9, 0.8)
    INSERT INTO JudgeScores (1, 1, ""Tumbling"",      4.5, 1.0)
    INSERT INTO JudgeScores (1, 1, ""Choreography"",  4.2, 1.5)
    --judge2
    INSERT INTO JudgeScores (1, 2, ""Stunts"",        4.1, 1.1)
    INSERT INTO JudgeScores (1, 2, ""Jumps"",         4.0, 0.9)
    INSERT INTO JudgeScores (1, 2, ""Tumbling"",      4.4, 1.1)
    INSERT INTO JudgeScores (1, 2, ""Choreography"",  4.2, 1.6)
    
    --judge3
    INSERT INTO JudgeScores (1, 3, ""Stunts"",        3.8, 1.2)
    INSERT INTO JudgeScores (1, 3, ""Jumps"",         4.2, 0.7)
    INSERT INTO JudgeScores (1, 3, ""Tumbling"",      4.3, 1.2)
    INSERT INTO JudgeScores (1, 3, ""Choreography"",  4.1, 1.3)
    
    
    --second team performance
    --judge1
    INSERT INTO JudgeScores (2, 1, ""Stunts"",        4.3, 1.3)
    INSERT INTO JudgeScores (2, 1, ""Jumps"",         4.0, 0.9)
    INSERT INTO JudgeScores (2, 1, ""Tumbling"",      4.6, 1.1)
    INSERT INTO JudgeScores (2, 1, ""Choreography"",  4.0, 1.0)
    --judge2
    INSERT INTO JudgeScores (2, 2, ""Stunts"",        4.1, 1.1)
    INSERT INTO JudgeScores (2, 2, ""Jumps"",         4.0, 0.9)
    INSERT INTO JudgeScores (2, 2, ""Tumbling"",      4.5, 1.2)
    INSERT INTO JudgeScores (2, 2, ""Choreography"",  4.2, 1.6)
    
    --judge3
    INSERT INTO JudgeScores (2, 3, ""Stunts"",        4.1, 1.1)
    INSERT INTO JudgeScores (2, 3, ""Jumps"",         4.5, 0.9)
    INSERT INTO JudgeScores (2, 3, ""Tumbling"",      4.4, 1.2)
    INSERT INTO JudgeScores (2, 3, ""Choreography"",  4.2, 1.6)

I want to select the data so that it will pivot this data as follows

    PerformanceID, JudgeID, StuntsStrength, StuntsStyle, JumpsStrength, JumpsStyle, TumbleStrength, TumbleStyle, ChorStrength, ChorStyle
    1     1     4.2,    1.1,    3.9,    0.8,   4.5,   1.0,    4.2,     1.5
    1     2     4.1,    1.1,    4.0,    0.9,   4.4,   1.1,    4.2,     1.6
    ...
    2     1     4.3,    1.3,    4.0,    0.9,   4.6,   1.1,    4.0,    1.0
    2     2     4.1,    1.1,    4.0,    0.9,   4.5,   1.2,    4.2,    1.6
    2     3     ...

Can this be done with a pivot query.  If not what is the best way to do it?  

Thanks for your help

Seth







",sql,sql-server,tsql,pivot,,,open,0,706,13,"Can you pivot and aggregate on two columns with a Sql PIVOT query Can you pivot two columns in a pivot query.

Suppose I have the following data...

    CREATE TABLE JudgeScores (PerformanceID int, JudgeID int, Criteria varchar(10), StrengthScore decimal(9,4), StyleScore decimal(9,4))
    
    --first team performance
    --judge1
    INSERT INTO JudgeScores (1, 1, ""Stunts"",        4.2, 1.1)
    INSERT INTO JudgeScores (1, 1, ""Jumps"",         3.9, 0.8)
    INSERT INTO JudgeScores (1, 1, ""Tumbling"",      4.5, 1.0)
    INSERT INTO JudgeScores (1, 1, ""Choreography"",  4.2, 1.5)
    --judge2
    INSERT INTO JudgeScores (1, 2, ""Stunts"",        4.1, 1.1)
    INSERT INTO JudgeScores (1, 2, ""Jumps"",         4.0, 0.9)
    INSERT INTO JudgeScores (1, 2, ""Tumbling"",      4.4, 1.1)
    INSERT INTO JudgeScores (1, 2, ""Choreography"",  4.2, 1.6)
    
    --judge3
    INSERT INTO JudgeScores (1, 3, ""Stunts"",        3.8, 1.2)
    INSERT INTO JudgeScores (1, 3, ""Jumps"",         4.2, 0.7)
    INSERT INTO JudgeScores (1, 3, ""Tumbling"",      4.3, 1.2)
    INSERT INTO JudgeScores (1, 3, ""Choreography"",  4.1, 1.3)
    
    
    --second team performance
    --judge1
    INSERT INTO JudgeScores (2, 1, ""Stunts"",        4.3, 1.3)
    INSERT INTO JudgeScores (2, 1, ""Jumps"",         4.0, 0.9)
    INSERT INTO JudgeScores (2, 1, ""Tumbling"",      4.6, 1.1)
    INSERT INTO JudgeScores (2, 1, ""Choreography"",  4.0, 1.0)
    --judge2
    INSERT INTO JudgeScores (2, 2, ""Stunts"",        4.1, 1.1)
    INSERT INTO JudgeScores (2, 2, ""Jumps"",         4.0, 0.9)
    INSERT INTO JudgeScores (2, 2, ""Tumbling"",      4.5, 1.2)
    INSERT INTO JudgeScores (2, 2, ""Choreography"",  4.2, 1.6)
    
    --judge3
    INSERT INTO JudgeScores (2, 3, ""Stunts"",        4.1, 1.1)
    INSERT INTO JudgeScores (2, 3, ""Jumps"",         4.5, 0.9)
    INSERT INTO JudgeScores (2, 3, ""Tumbling"",      4.4, 1.2)
    INSERT INTO JudgeScores (2, 3, ""Choreography"",  4.2, 1.6)

I want to select the data so that it will pivot this data as follows

    PerformanceID, JudgeID, StuntsStrength, StuntsStyle, JumpsStrength, JumpsStyle, TumbleStrength, TumbleStyle, ChorStrength, ChorStyle
    1     1     4.2,    1.1,    3.9,    0.8,   4.5,   1.0,    4.2,     1.5
    1     2     4.1,    1.1,    4.0,    0.9,   4.4,   1.1,    4.2,     1.6
    ...
    2     1     4.3,    1.3,    4.0,    0.9,   4.6,   1.1,    4.0,    1.0
    2     2     4.1,    1.1,    4.0,    0.9,   4.5,   1.2,    4.2,    1.6
    2     3     ...

Can this be done with a pivot query.  If not what is the best way to do it?  

Thanks for your help

Seth







",4
5308356,03/15/2011 06:47:32,660078,03/15/2011 06:47:32,1,0,Stored procedure for selecting Particular Column and particular cell in that column,"I 'll send you code in that I have table Name Registration in that i want to accept only Images Of Bramhan Samaj in grid View 
The DB Code is
public DataTable GetVivahNondaniAllBramhanList()
    {
        DataTable dt = new DataTable();
        try
        {
            DataSet ds = SqlHelper.ExecuteDataset(strConnection, ""Manavgaraja_sp_SelectBramhan"");
            dt = ds.Tables[0];
        }
        catch (Exception ex)
        {
            dt = null;
        }
        return dt;
    }

I call this  GetVivahNondaniAllBramhanList() method in Grid View
 ",sql,,,,,03/18/2011 02:25:59,not a real question,1,164,12,"Stored procedure for selecting Particular Column and particular cell in that column I 'll send you code in that I have table Name Registration in that i want to accept only Images Of Bramhan Samaj in grid View 
The DB Code is
public DataTable GetVivahNondaniAllBramhanList()
    {
        DataTable dt = new DataTable();
        try
        {
            DataSet ds = SqlHelper.ExecuteDataset(strConnection, ""Manavgaraja_sp_SelectBramhan"");
            dt = ds.Tables[0];
        }
        catch (Exception ex)
        {
            dt = null;
        }
        return dt;
    }

I call this  GetVivahNondaniAllBramhanList() method in Grid View
 ",1
11653255,07/25/2012 15:28:55,1552089,07/25/2012 15:20:55,1,0,SQL: Merge Date Ranges,"I've a table, which describes work slices of a business working calendar: (date format is 24 hours format)

<pre>
PK  | STARTDATE          | ENDDATE
__________________________________________
1   | 2012/07/21 02:00   | 2012/07/21 04:00
2   | 2012/07/21 03:00   | 2012/07/21 10:00
3   | 2012/07/21 06:00   | 2012/07/21 17:00
4   | 2012/07/21 18:00   | 2012/07/21 19:00

</pre>

Now, I like to merge the date ranges (within a given start and end date) like this:

<pre>
PK  | STARTDATE          | ENDDATE
__________________________________________
1   | 2012/07/21 02:00   | 2012/07/21 17:00
2   | 2012/07/21 18:00   | 2012/07/21 19:00
</pre>

Is there a way to do this with SQL97 standard? If so, what is with other operations (e.g. if I want to to an invered merge, the result should be [2012/07/21 00:00 | 2012/07/21 02:00] and [2012/07/21 19:00 | 2012/07/22 00:00]).

Best regards!



",sql,date,intervals,ranges,,,open,0,163,4,"SQL: Merge Date Ranges I've a table, which describes work slices of a business working calendar: (date format is 24 hours format)

<pre>
PK  | STARTDATE          | ENDDATE
__________________________________________
1   | 2012/07/21 02:00   | 2012/07/21 04:00
2   | 2012/07/21 03:00   | 2012/07/21 10:00
3   | 2012/07/21 06:00   | 2012/07/21 17:00
4   | 2012/07/21 18:00   | 2012/07/21 19:00

</pre>

Now, I like to merge the date ranges (within a given start and end date) like this:

<pre>
PK  | STARTDATE          | ENDDATE
__________________________________________
1   | 2012/07/21 02:00   | 2012/07/21 17:00
2   | 2012/07/21 18:00   | 2012/07/21 19:00
</pre>

Is there a way to do this with SQL97 standard? If so, what is with other operations (e.g. if I want to to an invered merge, the result should be [2012/07/21 00:00 | 2012/07/21 02:00] and [2012/07/21 19:00 | 2012/07/22 00:00]).

Best regards!



",4
3877705,10/06/2010 23:46:24,51792,01/05/2009 20:30:55,136,2,"How to refer to a variable create in the course of executing a query in T-SQL, in the WHERE clause?","What the title says, really.

If I SELECT [statement] AS whatever, why can't I refer to the whatever column in the body of the WHERE clause? Is there some kind of a workaround? It's driving me crazy.",sql,tsql,,,,,open,0,36,20,"How to refer to a variable create in the course of executing a query in T-SQL, in the WHERE clause? What the title says, really.

If I SELECT [statement] AS whatever, why can't I refer to the whatever column in the body of the WHERE clause? Is there some kind of a workaround? It's driving me crazy.",2
6623021,07/08/2011 10:14:12,835177,07/08/2011 10:14:12,1,0,I have 30 options in selection criteria and user may select any of them,I have 30 options in selection criteria and user may select any of them infact user may select any combination among these 30 options.....I am really not getting a clear picture how can i develop a sql query for this .can some one help me in this ...?,sql,,,,,11/11/2011 16:42:01,not a real question,1,48,14,I have 30 options in selection criteria and user may select any of them I have 30 options in selection criteria and user may select any of them infact user may select any combination among these 30 options.....I am really not getting a clear picture how can i develop a sql query for this .can some one help me in this ...?,1
5041628,02/18/2011 13:07:18,1184558,11/24/2010 12:01:56,1,0,How do I get the MediaCatalogDB OLE DB Provider?,"I have a Windows Server 2003 instance running SQL2005 with a linked server using the MediaCatalogDB OLE DB Provider.

We're migrating (most of) this server to one running Windows server 2003 but with 64bit SQL2008 R2.  However, it doesn't have the MediaCatalogDB OLE DB Provider.

Does anyone know where I can get this provider for 64bit SQL 2008?  Or another work around?

I don't know anything about the system we're linking to (it's a black box provided by a third party).

Thanks!",sql,64bit,ole,provider,,,open,0,80,9,"How do I get the MediaCatalogDB OLE DB Provider? I have a Windows Server 2003 instance running SQL2005 with a linked server using the MediaCatalogDB OLE DB Provider.

We're migrating (most of) this server to one running Windows server 2003 but with 64bit SQL2008 R2.  However, it doesn't have the MediaCatalogDB OLE DB Provider.

Does anyone know where I can get this provider for 64bit SQL 2008?  Or another work around?

I don't know anything about the system we're linking to (it's a black box provided by a third party).

Thanks!",4
14934,08/18/2008 17:11:15,1144,08/12/2008 19:00:54,85,9,Parameter Binding: What happens under the hood?,".NET, Java and other high level database API's in various language often provide techniques known as prepared statements and parameter binding as opposed to sending plain text commands to the Database server. What I would like to know is what happens when you execute a statement like this:

    SqlCommand cmd = new SqlCommand(""GetMemberByID"");
    cmd.CommandType = CommandType.StoredProcedure;
    SqlParameter param = new SqlParameter(""@ID"", memberID);
    para.DbType = DbType.Integer;
    cmd.Parameters.Add(param);

I know this is an best-practise, SQL injection attacks are minimized this way. But what exactly happens under to hood when you execute these statements? Is the end result still a SQL safe string? Or what is the end result? And is this enough to prevent SQL injection attacks?",sql,database,api,,,,open,0,129,7,"Parameter Binding: What happens under the hood? .NET, Java and other high level database API's in various language often provide techniques known as prepared statements and parameter binding as opposed to sending plain text commands to the Database server. What I would like to know is what happens when you execute a statement like this:

    SqlCommand cmd = new SqlCommand(""GetMemberByID"");
    cmd.CommandType = CommandType.StoredProcedure;
    SqlParameter param = new SqlParameter(""@ID"", memberID);
    para.DbType = DbType.Integer;
    cmd.Parameters.Add(param);

I know this is an best-practise, SQL injection attacks are minimized this way. But what exactly happens under to hood when you execute these statements? Is the end result still a SQL safe string? Or what is the end result? And is this enough to prevent SQL injection attacks?",3
5820042,04/28/2011 14:16:27,731121,04/28/2011 14:16:27,1,0,MAX Date for each worker,"Consider two tables. Worker table has fields like W_ID,W_Name. Course table has fields like C_ID,C_Name, C_Date.

Now, since a Worker can take many courses and a course can be taken by many Workers. Therefore, as evident, there is a many to many relationship between the two tables. Break the many to many, and create a new table called Takes which consists of the foreign keys W_ID and C_ID.

Here is the question: I want to find out a list of all workers and their last course taken. For example if W_ID=1 took C_Date 20/01/2010 and C_Date 25/10/2010 and C_Date 20/12/2010.

Then the Result required is:

W_ID     C_Date
1        20/12/2010
2
3
4

",sql,query,date,max,,,open,0,115,5,"MAX Date for each worker Consider two tables. Worker table has fields like W_ID,W_Name. Course table has fields like C_ID,C_Name, C_Date.

Now, since a Worker can take many courses and a course can be taken by many Workers. Therefore, as evident, there is a many to many relationship between the two tables. Break the many to many, and create a new table called Takes which consists of the foreign keys W_ID and C_ID.

Here is the question: I want to find out a list of all workers and their last course taken. For example if W_ID=1 took C_Date 20/01/2010 and C_Date 25/10/2010 and C_Date 20/12/2010.

Then the Result required is:

W_ID     C_Date
1        20/12/2010
2
3
4

",4
10550311,05/11/2012 11:17:39,1355061,04/25/2012 01:47:03,10,0,How to calculate year-end of the work with different years of working in ms sql?,"I would like to know how to write ms sql statement for the following.

    Table1
    T_name        T_start_day      T_start_month      T_start_year    T_work
    John             1                  2               2000           Physic Teacher
    Mary             2                 5                2000           English Teacher
    Rick             1                 7                2001           Physic Teacher
    Henry            1                 5                2002           Science Teacher
    John             10                5                2003           Physic Teacher
    
    
    Table2
    T_name           T_work_years
    John               2.5
    Mary               2
    Rick               2
    Henry              5

Assuming that only one person can work at a time.
So basically, when Rick came into work as Physic Teacher, John is not working. And John's back in 2003 as physic teacher again.
So John first did 16months as Physic teacher from 2000, then did 14months from 2003, so total is 2.5years.




    Table I expected is:
    
    T_name        T_start_year   T_end_year       T_work
    John              2000           2004          Physic Teacher
    Mary              2000           2002          English Teacher
    Rick              2001           2003          Physic Teacher
    Henry             2002           2007              Science Teacher
    John              2003           2004          Physic Teacher
    
but table i am getting is:

    T_name        T_start_year   T_end_year       T_work
    John              2000           2002          Physic Teacher
    Mary              2000           2001          English Teacher
    Rick              2001           2003          Physic Teacher
    Henry             2002           2007          Science Teacher
    John              2003           2005          Physic Teacher

Here is my code:

    SELECT table3.T_name, 
           table1.T_start_year, 
           min(table3.T_start_year)+table1.T_start_year As T_end_year, 
           table1.T_work
          
    From table1
    INNER JOIN (Select table2.T_name, table2.T_work_years, table1.T_start_year, table1.T_work 
    From table1
    INNER JOIN table2
    ON table2.T_name=table1.T_name) As table3
    ON table1.T_name=table3.T_name;



",sql,ms-access-2010,,,,,open,0,1066,15,"How to calculate year-end of the work with different years of working in ms sql? I would like to know how to write ms sql statement for the following.

    Table1
    T_name        T_start_day      T_start_month      T_start_year    T_work
    John             1                  2               2000           Physic Teacher
    Mary             2                 5                2000           English Teacher
    Rick             1                 7                2001           Physic Teacher
    Henry            1                 5                2002           Science Teacher
    John             10                5                2003           Physic Teacher
    
    
    Table2
    T_name           T_work_years
    John               2.5
    Mary               2
    Rick               2
    Henry              5

Assuming that only one person can work at a time.
So basically, when Rick came into work as Physic Teacher, John is not working. And John's back in 2003 as physic teacher again.
So John first did 16months as Physic teacher from 2000, then did 14months from 2003, so total is 2.5years.




    Table I expected is:
    
    T_name        T_start_year   T_end_year       T_work
    John              2000           2004          Physic Teacher
    Mary              2000           2002          English Teacher
    Rick              2001           2003          Physic Teacher
    Henry             2002           2007              Science Teacher
    John              2003           2004          Physic Teacher
    
but table i am getting is:

    T_name        T_start_year   T_end_year       T_work
    John              2000           2002          Physic Teacher
    Mary              2000           2001          English Teacher
    Rick              2001           2003          Physic Teacher
    Henry             2002           2007          Science Teacher
    John              2003           2005          Physic Teacher

Here is my code:

    SELECT table3.T_name, 
           table1.T_start_year, 
           min(table3.T_start_year)+table1.T_start_year As T_end_year, 
           table1.T_work
          
    From table1
    INNER JOIN (Select table2.T_name, table2.T_work_years, table1.T_start_year, table1.T_work 
    From table1
    INNER JOIN table2
    ON table2.T_name=table1.T_name) As table3
    ON table1.T_name=table3.T_name;



",2
11348593,07/05/2012 16:25:37,1283691,03/21/2012 14:49:09,50,2,SQL Server displaying ucase,"Why would SQL Server display a field in Upper case when the field is not.

    select ImageName from Product where id =109332 

On the production server it results LEI772789

And on my development server (Which runs a backup of production) it results Lei772789

I'm using amazon S3 for the images and its case sensitive.
",sql,sql-server,sql-server-2008,amazon-s3,,07/10/2012 18:08:47,too localized,1,55,4,"SQL Server displaying ucase Why would SQL Server display a field in Upper case when the field is not.

    select ImageName from Product where id =109332 

On the production server it results LEI772789

And on my development server (Which runs a backup of production) it results Lei772789

I'm using amazon S3 for the images and its case sensitive.
",4
7499832,09/21/2011 12:36:34,888737,08/10/2011 20:55:30,99,5,Need T-SQL code for the following pseudo code,"    Table A: | BillToName | Current| Total |
              -----------------------------
             | Company29  | N      | 100   |
              -----------------------------
             | Company02  | Y      | 80    |
              -----------------------------

I need T-SQL for the following pseudo code:

SELECT BillToName, SUM(Total *regardless if the status is ""Y"" or ""N"") WHERE Current = 'Y'

Feel free to ask questions. Thanks!",sql,tsql,business-objects,,,09/22/2011 04:06:33,not a real question,1,135,8,"Need T-SQL code for the following pseudo code     Table A: | BillToName | Current| Total |
              -----------------------------
             | Company29  | N      | 100   |
              -----------------------------
             | Company02  | Y      | 80    |
              -----------------------------

I need T-SQL for the following pseudo code:

SELECT BillToName, SUM(Total *regardless if the status is ""Y"" or ""N"") WHERE Current = 'Y'

Feel free to ask questions. Thanks!",3
10536458,05/10/2012 14:42:58,1186256,02/02/2012 22:06:46,39,2,SQLNCLI vs SQLNCLI10,"Can anyone direct me to a link or source that outlines either in general or in detail reasons to change your connection string from SQLNCLI to SQLNCLI10 when upgrading from SQL Server 2005 to 2008?

Outside of datatype issues, I am not seing any differences.  I just want to have as few steps as possible with minimal complication and if there are no performance gains, or missed functionality.   I just don't see the point in doing this step, at least at this moment.",sql,server,upgrade,sqlncli,,,open,0,85,3,"SQLNCLI vs SQLNCLI10 Can anyone direct me to a link or source that outlines either in general or in detail reasons to change your connection string from SQLNCLI to SQLNCLI10 when upgrading from SQL Server 2005 to 2008?

Outside of datatype issues, I am not seing any differences.  I just want to have as few steps as possible with minimal complication and if there are no performance gains, or missed functionality.   I just don't see the point in doing this step, at least at this moment.",4
8746158,01/05/2012 16:39:50,1132474,01/05/2012 15:19:02,13,0,MS SQL UPDATE WHERE query,"I'm using MS SQL 2003.  I need to UPDATE 3 columns (STATE, COUNTY, VALIMIT2012) of a table (lending_limits) WHERE only the results in one column (VALIMIT2012) have changed and insert the updated value. Would my syntax be:

UPDATE lending_limits
(the columns are STATE, COUNTY, VALIMIT2012)
WHERE VALIMIT2012 <> VALIMIT2012

",sql,update,,,,01/05/2012 17:50:30,not a real question,1,47,5,"MS SQL UPDATE WHERE query I'm using MS SQL 2003.  I need to UPDATE 3 columns (STATE, COUNTY, VALIMIT2012) of a table (lending_limits) WHERE only the results in one column (VALIMIT2012) have changed and insert the updated value. Would my syntax be:

UPDATE lending_limits
(the columns are STATE, COUNTY, VALIMIT2012)
WHERE VALIMIT2012 <> VALIMIT2012

",2
1122942,07/14/2009 00:53:09,30639,10/23/2008 04:29:23,55,2,SQL to LINQ - Left Outer Join with multiple join conditions,"I have the following SQL which I am trying to translate to LINQ:

    SELECT f.value
    FROM period as p 
    LEFT OUTER JOIN facts AS f ON p.id = f.periodid AND f.otherid = 17
    WHERE p.companyid = 100

I have seen the typical implementation of the left outer join (ie. `into x from y in x.DefaultIfEmpty()` etc.) but am unsure how to introduce the other join condition ('`AND f.otherid = 17`')


",sql,linq,outer-join,,,,open,0,82,11,"SQL to LINQ - Left Outer Join with multiple join conditions I have the following SQL which I am trying to translate to LINQ:

    SELECT f.value
    FROM period as p 
    LEFT OUTER JOIN facts AS f ON p.id = f.periodid AND f.otherid = 17
    WHERE p.companyid = 100

I have seen the typical implementation of the left outer join (ie. `into x from y in x.DefaultIfEmpty()` etc.) but am unsure how to introduce the other join condition ('`AND f.otherid = 17`')


",3
9180637,02/07/2012 17:11:49,1094969,11/17/2008 17:36:55,1733,16,SQL Server query: how to return set of values based on condition?,"Consider the following scenario (a bit contrived, but less complex than the real scenario I'm struggling with):

A university with an online document management system wants to limit which professors can see which documents.  Some professors can see documents belonging to any department but some can only see documents belonging to specific departments.  

Here's the schema:

    create table Professors (
        ProfessorId int primary key,
        ProfessorName varchar(50)
    );
    
    create table Departments (
        DepartmentId int primary key,
        DepartmentName varchar(50)
    );
    
    create table ProfessorDepartments (
        ProfessorId int,
        DepartmentId int
    );
    
    insert into Professors values (1, 'Professor A'), (2, 'Professor B');
    insert into Departments values (1, 'Chemistry'), (2, 'Computer Science'), (3, 'Math'), (4, 'Physics');
    insert into ProfessorDepartments values (1,2), (1,3);

And here's the tricky part: a professor with unrestricted access will **not have any departments listed in the ProfessorDepartments table**.  (That way, said professor will automatically be given access to any new departments.)

How can I get the list of allowed departments for a specific professor?  The list needs to come from the ProfessorDepartments table if the professor has limited access and from the Departments table if the professor has unrestricted access.


",sql,sql-server,query,sql-server-2008-r2,,,open,0,270,12,"SQL Server query: how to return set of values based on condition? Consider the following scenario (a bit contrived, but less complex than the real scenario I'm struggling with):

A university with an online document management system wants to limit which professors can see which documents.  Some professors can see documents belonging to any department but some can only see documents belonging to specific departments.  

Here's the schema:

    create table Professors (
        ProfessorId int primary key,
        ProfessorName varchar(50)
    );
    
    create table Departments (
        DepartmentId int primary key,
        DepartmentName varchar(50)
    );
    
    create table ProfessorDepartments (
        ProfessorId int,
        DepartmentId int
    );
    
    insert into Professors values (1, 'Professor A'), (2, 'Professor B');
    insert into Departments values (1, 'Chemistry'), (2, 'Computer Science'), (3, 'Math'), (4, 'Physics');
    insert into ProfessorDepartments values (1,2), (1,3);

And here's the tricky part: a professor with unrestricted access will **not have any departments listed in the ProfessorDepartments table**.  (That way, said professor will automatically be given access to any new departments.)

How can I get the list of allowed departments for a specific professor?  The list needs to come from the ProfessorDepartments table if the professor has limited access and from the Departments table if the professor has unrestricted access.


",4
2909597,05/26/2010 01:12:32,350447,05/26/2010 00:47:26,1,0,how to return multiple records from a view in sql server 2008,i have a view which presently returning single record when called....i like it to return three records may be upon  inner joining a different view or temp table...as those records share the same data except single column... im not sure about this plz some one throw light on this please..thank you in advance,sql,,,,,05/27/2010 06:56:33,not a real question,1,54,12,how to return multiple records from a view in sql server 2008 i have a view which presently returning single record when called....i like it to return three records may be upon  inner joining a different view or temp table...as those records share the same data except single column... im not sure about this plz some one throw light on this please..thank you in advance,1
10852158,06/01/2012 14:29:05,108207,05/16/2009 17:51:55,2881,195,"Difference between SQL NOT IN and SQL EXCEPT, UNION and OR, AND and INTERSECT?",It seems that what you can write with SQL `EXCEPT` you can write with SQL `NOT IN` and likewise for `UNION` and `OR` and `AND` and `INTERSECT`. Could you tell me the differences between these keywords? For instance `select * from person where person not in (select * from person where name='foo')` is the same as `select * from person except where name='foo'` and similar for the other constructs. Are they really equivalent?,sql,,,,,06/02/2012 02:09:55,not a real question,1,73,14,"Difference between SQL NOT IN and SQL EXCEPT, UNION and OR, AND and INTERSECT? It seems that what you can write with SQL `EXCEPT` you can write with SQL `NOT IN` and likewise for `UNION` and `OR` and `AND` and `INTERSECT`. Could you tell me the differences between these keywords? For instance `select * from person where person not in (select * from person where name='foo')` is the same as `select * from person except where name='foo'` and similar for the other constructs. Are they really equivalent?",1
6744124,07/19/2011 08:13:20,49993,12/29/2008 22:11:12,801,57,ActiveRecord: How to return counts of distinct votes?,"My data model: Users, Votes, Items

Users can vote many times on an item

I want to return the total number of up and down votes for an item, *only counting the most recent one for a given user*

I was thinking something like selecting a distinct user_id and grouping by the value of the vote, but I'm not sure how I'd make the distinct pick up the most recent one..

I'd prefer to do this through the Rails 3 finder methods..",sql,ruby-on-rails,ruby-on-rails-3,,,,open,0,78,8,"ActiveRecord: How to return counts of distinct votes? My data model: Users, Votes, Items

Users can vote many times on an item

I want to return the total number of up and down votes for an item, *only counting the most recent one for a given user*

I was thinking something like selecting a distinct user_id and grouping by the value of the vote, but I'm not sure how I'd make the distinct pick up the most recent one..

I'd prefer to do this through the Rails 3 finder methods..",3
10870287,06/03/2012 12:24:48,1071194,11/29/2011 11:41:04,36,8,Best Method access to SQL Server Data Base within SharePoint 2010 Application Page,"i have a SharePoint 2010 application page, and i need that domain users connect and CRUD operation to specific SQL Server 2008 Data Base, now i know that best method for it?

many thanks.",sql,sql-server,sql-server-2008,sharepoint,sharepoint2010,,open,0,33,13,"Best Method access to SQL Server Data Base within SharePoint 2010 Application Page i have a SharePoint 2010 application page, and i need that domain users connect and CRUD operation to specific SQL Server 2008 Data Base, now i know that best method for it?

many thanks.",5
11521596,07/17/2012 11:32:18,671809,03/22/2011 18:58:27,124,0,Could not allocate space for object 'dbo.History' in database '[path to mdf]' because the 'PRIMARY' filegroup is full,"I have a local project i am working on, on my own workstation. I use a local SQL server as well.

The project contains alot of data, and as of now, i just need to be able to store all this data in the SQL db. The main PRIMARY file is, as of now, in the size of 9,5 GB. 
I keept getting the error ""Could not allocate space for object 'dbo.History' in database '[path to mdf]' because the 'PRIMARY' filegroup is full"". I then tried fiddling with the autogrowth porperties (default was ""By 10 percent, unrestricted growth"". I have around 60gb free on the disk. I then tried setting it to ""By 50000 mb, unrestricted growth"", and adding 4 more primary files - but i still get the same error?

What can i do - i am not really to concerned about how and why the db is so large, i just want the SQL server to accomodate the size of the files.",sql,,,,,07/17/2012 12:45:25,off topic,1,162,18,"Could not allocate space for object 'dbo.History' in database '[path to mdf]' because the 'PRIMARY' filegroup is full I have a local project i am working on, on my own workstation. I use a local SQL server as well.

The project contains alot of data, and as of now, i just need to be able to store all this data in the SQL db. The main PRIMARY file is, as of now, in the size of 9,5 GB. 
I keept getting the error ""Could not allocate space for object 'dbo.History' in database '[path to mdf]' because the 'PRIMARY' filegroup is full"". I then tried fiddling with the autogrowth porperties (default was ""By 10 percent, unrestricted growth"". I have around 60gb free on the disk. I then tried setting it to ""By 50000 mb, unrestricted growth"", and adding 4 more primary files - but i still get the same error?

What can i do - i am not really to concerned about how and why the db is so large, i just want the SQL server to accomodate the size of the files.",1
18783,08/20/2008 20:45:15,357,08/05/2008 01:29:23,725,47,SQL - What are your favorite performance tricks?,"When you have a query or stored procedure that needs performance tuning, what are some of the first things you try?",sql,sql-server,performance,,,11/28/2011 01:23:55,not constructive,1,21,8,"SQL - What are your favorite performance tricks? When you have a query or stored procedure that needs performance tuning, what are some of the first things you try?",3
5281096,03/12/2011 06:52:16,648290,03/07/2011 14:25:02,42,0,data types in sql,"plz tell me about the data type used for money in mysql  
",sql,,,,,03/12/2011 19:48:39,not a real question,1,14,4,"data types in sql plz tell me about the data type used for money in mysql  
",1
5266874,03/10/2011 22:52:14,357587,06/03/2010 14:28:11,318,3,Java - Trouble Joining Tables,"I am working with a sql database that has 3 tables. Country, City, And CountryLanguage.

The query string I create contains data that is in all 3 of the tables.

I have no problem linking the Country to the City database using a join statement. Ex. `SELECT Country.Name FROM City INNER JOIN Country ON Country.Code = City.CountryCode WHERE City.Name ='Abakan'`. But I am having a huge problem trying to get to the Language database using a join statement. 

To me using this statement: `Select CountryLanguage.Language FROM City INNER JOIN CountryLanguage ON City.CountryCode = CountryLanguage.CountryCode WHERE City.Name ='"" + theCity + ""'"");` should work.

All the databases have CountryCode (or in come cases 'Code') In common. Yet I still cant acces CountryLanguage. When I actually hardcode in a query string to connect to COuntryLanguage It works great. But I need the query string to be dynamic.

Thanks!",sql,database,,,,,open,0,142,5,"Java - Trouble Joining Tables I am working with a sql database that has 3 tables. Country, City, And CountryLanguage.

The query string I create contains data that is in all 3 of the tables.

I have no problem linking the Country to the City database using a join statement. Ex. `SELECT Country.Name FROM City INNER JOIN Country ON Country.Code = City.CountryCode WHERE City.Name ='Abakan'`. But I am having a huge problem trying to get to the Language database using a join statement. 

To me using this statement: `Select CountryLanguage.Language FROM City INNER JOIN CountryLanguage ON City.CountryCode = CountryLanguage.CountryCode WHERE City.Name ='"" + theCity + ""'"");` should work.

All the databases have CountryCode (or in come cases 'Code') In common. Yet I still cant acces CountryLanguage. When I actually hardcode in a query string to connect to COuntryLanguage It works great. But I need the query string to be dynamic.

Thanks!",2
10606211,05/15/2012 17:54:40,1301158,03/29/2012 15:09:46,1,0,using c# to write sql query in Visual studio,I have a database in sql server. I am looking to create a WPF app with visual studio in order to run the sql code there.  How do I do this? I am just needing to run a simple select statement based off of three joined tables,sql,wpf,visual-studio-2010,sql-server-2008,,05/16/2012 00:58:38,not constructive,1,48,9,using c# to write sql query in Visual studio I have a database in sql server. I am looking to create a WPF app with visual studio in order to run the sql code there.  How do I do this? I am just needing to run a simple select statement based off of three joined tables,4
9067686,01/30/2012 17:03:11,1178562,01/30/2012 16:59:01,1,0,SQL Server connection aliases keep disappearing,"In SQL Server Configuration Manager, I set up a server alias called '(local)', which points to my '(local)\sqlexpress' instance.  Every once in a while, this alias mysteriously disappears.  The frequency seems random; sometimes it will stick around for a month, but this morning it disappeared after about an hour.  I have not been able to link its disappearance with any specific action that I'm taking.  What can cause these to be deleted?",sql,server,connection,alias,deleted,01/30/2012 20:55:45,off topic,1,76,6,"SQL Server connection aliases keep disappearing In SQL Server Configuration Manager, I set up a server alias called '(local)', which points to my '(local)\sqlexpress' instance.  Every once in a while, this alias mysteriously disappears.  The frequency seems random; sometimes it will stick around for a month, but this morning it disappeared after about an hour.  I have not been able to link its disappearance with any specific action that I'm taking.  What can cause these to be deleted?",5
5316534,03/15/2011 18:51:52,614473,02/12/2011 19:21:48,3,0,How to query SQL rows HAVING NOT (array values) in a field with comma separated values ?,"Hey guys, i'm a SQL beginner, and can't find the solution to my problem.

I have a SQL table, which looks like this:

**id_question (int)** | **tags (varchar)**  
where ""tags"" field is  
- either empty : NULL  
- or is filled with one value (Ex: 1) (not numeric)  
- or is filled with several comma separated values (ex: 273,2308,24) (not numeric)

**id_question (int)** | **tags (varchar)**  
1 | 1,373  
2 | 283,4555,308,12  
3 | 283,25,3  

ANd i have a blacklisted_tags array.
I would like to retrieve id_questions of all questions whose tags field do not have a blacklisted  $tags_blacklist value.

**For example:**  
$tags_blacklist = array (1,3)  
=> I should get 2  
and not 1 because it has 1 in its tags field  
and not 3 because it has 3 in its tags field.

What should my SQL query look like ?

Thanks for your hints :)",sql,arrays,exclude,,,,open,0,152,17,"How to query SQL rows HAVING NOT (array values) in a field with comma separated values ? Hey guys, i'm a SQL beginner, and can't find the solution to my problem.

I have a SQL table, which looks like this:

**id_question (int)** | **tags (varchar)**  
where ""tags"" field is  
- either empty : NULL  
- or is filled with one value (Ex: 1) (not numeric)  
- or is filled with several comma separated values (ex: 273,2308,24) (not numeric)

**id_question (int)** | **tags (varchar)**  
1 | 1,373  
2 | 283,4555,308,12  
3 | 283,25,3  

ANd i have a blacklisted_tags array.
I would like to retrieve id_questions of all questions whose tags field do not have a blacklisted  $tags_blacklist value.

**For example:**  
$tags_blacklist = array (1,3)  
=> I should get 2  
and not 1 because it has 1 in its tags field  
and not 3 because it has 3 in its tags field.

What should my SQL query look like ?

Thanks for your hints :)",3
8683707,12/30/2011 20:24:03,281671,02/25/2010 23:03:51,2952,7,Grouping by alias defined in query?,"Why can't I group by ""cnt"" and have to group by count(*).  This just seems redundant and I wish there was a better way.

    SELECT count(*) as cnt
    from table
    group by count(*)",sql,sql-server-2008-r2,,,,01/03/2012 00:05:20,not constructive,1,43,6,"Grouping by alias defined in query? Why can't I group by ""cnt"" and have to group by count(*).  This just seems redundant and I wish there was a better way.

    SELECT count(*) as cnt
    from table
    group by count(*)",2
7454319,09/17/2011 11:14:12,585795,01/22/2011 17:52:19,660,11,Resetting the id in table without dropping it,"There are ten entries in the table and primary key id is set to autoincrement. If I delete all entries and insert one more its id will be 11, is it possible to reset ids to 1 again?",sql,primary-key,,,,,open,0,38,8,"Resetting the id in table without dropping it There are ten entries in the table and primary key id is set to autoincrement. If I delete all entries and insert one more its id will be 11, is it possible to reset ids to 1 again?",2
10860844,06/02/2012 08:17:17,1425709,05/30/2012 09:49:06,11,0,How to join 3 select queries?,"How to join these 3 query -

    select gameid , type ,Player1,Player2,Player3,Player4,Player5 from tbl_game where Player1="" + userid + "" OR Player2="" + userid + "" OR Player3="" + userid + "" OR Player4="" + userid + "" OR Player5="" + userid + "" AND Complete = 'No' 
    
    select Player1, Player2, Streaks from tbl_streaks where gameid=[gameid from first query]
    
    select userid, userid,Facebookid,points from tbl_userinfo where userid=[players from first query]

`userid` is passed as parameter.

I dont have any idea ..

Please help me.

",sql,database,query,,,06/04/2012 14:07:40,not a real question,1,98,6,"How to join 3 select queries? How to join these 3 query -

    select gameid , type ,Player1,Player2,Player3,Player4,Player5 from tbl_game where Player1="" + userid + "" OR Player2="" + userid + "" OR Player3="" + userid + "" OR Player4="" + userid + "" OR Player5="" + userid + "" AND Complete = 'No' 
    
    select Player1, Player2, Streaks from tbl_streaks where gameid=[gameid from first query]
    
    select userid, userid,Facebookid,points from tbl_userinfo where userid=[players from first query]

`userid` is passed as parameter.

I dont have any idea ..

Please help me.

",3
9717330,03/15/2012 09:51:36,1254392,11/04/2011 08:50:03,9,1,Query Is not Running,"MUTANT TABLE DOES NOT EXIST.MY QUERY IS WORKING FINE BUT WHEN I AM TRYING TO PUT THE RESULT IN A NEW TABLE WHICH DOESN'T EXIST,IT IS SHOWING SOME ERROR.
select 'Ordinary' , pincode , year ( Date_val ), MONTH ( Date_val ), (100 - cast ( Arr_8 as int )/ cast ( Arr_5 as int )* 100 )
into mutant

from ( select * from arrow_29june_2010 union all

select * from arrow_dtp_upg_2009 ) A

where cast ( arr_5 as int )<> 0",sql,sql-server,sql-server-2008,query,,03/16/2012 00:25:47,not a real question,1,77,4,"Query Is not Running MUTANT TABLE DOES NOT EXIST.MY QUERY IS WORKING FINE BUT WHEN I AM TRYING TO PUT THE RESULT IN A NEW TABLE WHICH DOESN'T EXIST,IT IS SHOWING SOME ERROR.
select 'Ordinary' , pincode , year ( Date_val ), MONTH ( Date_val ), (100 - cast ( Arr_8 as int )/ cast ( Arr_5 as int )* 100 )
into mutant

from ( select * from arrow_29june_2010 union all

select * from arrow_dtp_upg_2009 ) A

where cast ( arr_5 as int )<> 0",4
4719830,01/18/2011 02:00:07,579307,01/18/2011 02:00:07,1,0,Enable auto-code completion in SQL Developer for a Sybase connection,"I am connecting to a Sybase 12.5 database using Oracle SQL Developer tool. This is acheived by using a third party jar (jtds-1.2.5.jar).
I am able to connect and execute queries on DB successfully but Code completeion (Ctrl-Space) is not available for Table names and Columns.
I have checked the preferences and it is enabled but it is not working.
In the past i have seen this working fine for an Oracle database but it is not working for Sybase database
Can anyone please help me in this
Thanks",sql,sybase,completion,,,,open,0,84,10,"Enable auto-code completion in SQL Developer for a Sybase connection I am connecting to a Sybase 12.5 database using Oracle SQL Developer tool. This is acheived by using a third party jar (jtds-1.2.5.jar).
I am able to connect and execute queries on DB successfully but Code completeion (Ctrl-Space) is not available for Table names and Columns.
I have checked the preferences and it is enabled but it is not working.
In the past i have seen this working fine for an Oracle database but it is not working for Sybase database
Can anyone please help me in this
Thanks",3
2557376,04/01/2010 00:17:36,84206,03/29/2009 08:18:55,2510,210,Complex SQL Query similar to a z order problem,"I have a complex SQL problem in MS SQL Server, and in drawing on a piece of paper I realized that I could think of it as a single bar filled with rectangles, each rectangle having segments with different Z orders.  In reality it has nothing to do with z order or graphics at all, but more to do with some complex business rules that would be difficult to explain.  Howoever, if anyone has ideas on how to solve the below that will give me my solution.

I have the following data:

    ObjectID, PercentOfBar, ZOrder (where smaller is closer)
    A, 100, 6
    B, 50, 5
    B, 50, 4
    C, 30, 3
    C, 70, 6

The result of my query that I want is this, in any order:

    PercentOfBar, ZOrder
    50, 5
    20, 4
    30, 3

Think of it like this, if I drew rectangle A, it would fill 100% of the bar and have a z order of 6.

    66666666666
    AAAAAAAAAAA

If I then layed out rectangle B, consisting of two segments, both segments would cover up rectangle A resulting in the following rendering:

    4444455555
    BBBBBBBBBB

**As a rule of thumb, for a given rectangle, it's segments should be layed out such that the highest z order is to the right of the lower Z orders.**

Finally rectangle C would cover up only portions of Rectangle B with it's 30% segment that is z order 3, which would be on the left.  You can hopefully see how the is represented in the output dataset I listed above:

    3334455555
    CCCBBBBBBB

Now to make things more complicated I actually have a 4th column such that this grouping occurs for each key:

Input:

    SomeKey, ObjectID, PercentOfBar, ZOrder (where smaller is closer)
    X, A, 100, 6
    X, B, 50, 5
    X, B, 50, 4
    X, C, 30, 3
    X, C, 70, 6
    Y, A, 100, 6
    Z, B, 50, 2
    Z, B, 50, 6
    Z, C, 100, 5

Output:

    SomeKey, PercentOfBar, ZOrder
    X, 50, 5
    X, 20, 4
    X, 30, 3
    Y, 100, 6
    Z, 50, 2
    Z, 50, 5

Notice in the output, the PercentOfBar for each SomeKey would add up to 100%.

This is one I know I'm going to be thinking about when I go to bed tonight.

Just to be explicit and have a question:

**What would be a query that would produce the results described above?**",sql,sql-server,,,,,open,0,486,9,"Complex SQL Query similar to a z order problem I have a complex SQL problem in MS SQL Server, and in drawing on a piece of paper I realized that I could think of it as a single bar filled with rectangles, each rectangle having segments with different Z orders.  In reality it has nothing to do with z order or graphics at all, but more to do with some complex business rules that would be difficult to explain.  Howoever, if anyone has ideas on how to solve the below that will give me my solution.

I have the following data:

    ObjectID, PercentOfBar, ZOrder (where smaller is closer)
    A, 100, 6
    B, 50, 5
    B, 50, 4
    C, 30, 3
    C, 70, 6

The result of my query that I want is this, in any order:

    PercentOfBar, ZOrder
    50, 5
    20, 4
    30, 3

Think of it like this, if I drew rectangle A, it would fill 100% of the bar and have a z order of 6.

    66666666666
    AAAAAAAAAAA

If I then layed out rectangle B, consisting of two segments, both segments would cover up rectangle A resulting in the following rendering:

    4444455555
    BBBBBBBBBB

**As a rule of thumb, for a given rectangle, it's segments should be layed out such that the highest z order is to the right of the lower Z orders.**

Finally rectangle C would cover up only portions of Rectangle B with it's 30% segment that is z order 3, which would be on the left.  You can hopefully see how the is represented in the output dataset I listed above:

    3334455555
    CCCBBBBBBB

Now to make things more complicated I actually have a 4th column such that this grouping occurs for each key:

Input:

    SomeKey, ObjectID, PercentOfBar, ZOrder (where smaller is closer)
    X, A, 100, 6
    X, B, 50, 5
    X, B, 50, 4
    X, C, 30, 3
    X, C, 70, 6
    Y, A, 100, 6
    Z, B, 50, 2
    Z, B, 50, 6
    Z, C, 100, 5

Output:

    SomeKey, PercentOfBar, ZOrder
    X, 50, 5
    X, 20, 4
    X, 30, 3
    Y, 100, 6
    Z, 50, 2
    Z, 50, 5

Notice in the output, the PercentOfBar for each SomeKey would add up to 100%.

This is one I know I'm going to be thinking about when I go to bed tonight.

Just to be explicit and have a question:

**What would be a query that would produce the results described above?**",2
4427099,12/13/2010 08:47:58,515659,11/22/2010 05:24:10,105,3,multi-table mysql query,"I have 4 tables

    Table: Category
        CategoryID (int)
        Name (varchar)
    Table: Products
        ProductID (int)
        CategoryID (int)
        Name (varchar)
        Description (text)
    Table: Sales
        SalesID (int)
        ProductID (int)
    Table: Links
        LinkID (int)
        ProductID (int)

Now I need to display data as:

    CategoryName     Total Products     Total Sales     Total Links
        ABC                5                 12            50
        XYZ               12                 26            10

How can I achieve this, may be in single query

Help appreciated

Thanks
",sql,mysql,,,,,open,0,257,3,"multi-table mysql query I have 4 tables

    Table: Category
        CategoryID (int)
        Name (varchar)
    Table: Products
        ProductID (int)
        CategoryID (int)
        Name (varchar)
        Description (text)
    Table: Sales
        SalesID (int)
        ProductID (int)
    Table: Links
        LinkID (int)
        ProductID (int)

Now I need to display data as:

    CategoryName     Total Products     Total Sales     Total Links
        ABC                5                 12            50
        XYZ               12                 26            10

How can I achieve this, may be in single query

Help appreciated

Thanks
",2
8638576,12/26/2011 19:31:18,113678,05/28/2009 11:00:34,335,19,UPPER() doesn't work with cyrillic symbols in PostgreSQL 8.2 database,"So, i have PostgreSQL 8.2 running on Ubuntu server, database encoding is UTF8. Everything is fine, except one thing: i cannot use upper() function in sql queries for cyrillic symbols. Well, I can use it, but the result of the function will be still in lowercase.

How could this be fixed?",sql,postgresql,encoding,cyrillic,,,open,0,50,10,"UPPER() doesn't work with cyrillic symbols in PostgreSQL 8.2 database So, i have PostgreSQL 8.2 running on Ubuntu server, database encoding is UTF8. Everything is fine, except one thing: i cannot use upper() function in sql queries for cyrillic symbols. Well, I can use it, but the result of the function will be still in lowercase.

How could this be fixed?",4
2018,08/05/2008 08:25:33,33,08/01/2008 12:32:10,109,8,Best Book for a new Database Developer,"We have just had a graduate join the team with the end aim of assisting out our DBA. 

He has only a basic SQL knowledge from his degree so we are looking for a really good getting started book preferably based on MS SQL server.",sql,books,mssql,training,,09/15/2011 07:17:42,off topic,1,45,7,"Best Book for a new Database Developer We have just had a graduate join the team with the end aim of assisting out our DBA. 

He has only a basic SQL knowledge from his degree so we are looking for a really good getting started book preferably based on MS SQL server.",4
4269863,11/24/2010 17:46:18,519189,11/24/2010 17:46:18,1,0,sql query-IMPLEMENTING SET OPERATORS,The hr department needs a list of countries that have no departments located in them.Display the country ID and the name of countries.Use set operators to create this report.,sql,,,,,02/03/2011 04:03:30,not a real question,1,29,4,sql query-IMPLEMENTING SET OPERATORS The hr department needs a list of countries that have no departments located in them.Display the country ID and the name of countries.Use set operators to create this report.,1
10294846,04/24/2012 09:03:00,991389,10/12/2011 12:04:02,120,4,Combine two tables in one - SQL,"I have two tables in SQL Server 2012 and would like to combine them into one new table. They are linked by the column messageID. The first table (*Message*) has

 - messageID
 - sender
 - date

The second table(*recipientInfo*) has

 - messageID
 - recipient

The main problem is that in *Message* the messageID is the primary key and thus unique. In *recipientInfo* the messageID is not unique (because one message can have multiple recipients). I'd like to have a new table with either

 - One row per message, with recipients concatenated in one column
 - Multiple rows per message, when there are multiple recipients (one recipient per row)",sql,table,combine,,,04/25/2012 11:43:49,not a real question,1,106,7,"Combine two tables in one - SQL I have two tables in SQL Server 2012 and would like to combine them into one new table. They are linked by the column messageID. The first table (*Message*) has

 - messageID
 - sender
 - date

The second table(*recipientInfo*) has

 - messageID
 - recipient

The main problem is that in *Message* the messageID is the primary key and thus unique. In *recipientInfo* the messageID is not unique (because one message can have multiple recipients). I'd like to have a new table with either

 - One row per message, with recipients concatenated in one column
 - Multiple rows per message, when there are multiple recipients (one recipient per row)",3
6752749,07/19/2011 19:12:35,725845,04/26/2011 17:31:48,10,1,"how to backup SQL database (tables, mappings, indices, etc.)","I am installing a service pack on our shopping cart. They recommend backing up the SQL database before installing. I know we have backups to tape drives done by our hosting company, but I want one I know the exact time stamp for and can access quickly if I need to reload it because of a goof during the upgrade. (I don't want to have the store down for any longer than needed.)

*How do you recommend backing up a SQL database for easy reloading for someone who is used to just writing queries and stored procedures?* (I'd like to get everything - mappings & indices, etc - because I wouldn't know what all of them are or how to recreate them.)

I access the database via Remote Desktop and can link my hard drive and DVD drives, if that helps. It's MSSQL 2008.

Thank you so much.

Best wishes,
Andrea",sql,database,copy,backup,,,open,0,146,9,"how to backup SQL database (tables, mappings, indices, etc.) I am installing a service pack on our shopping cart. They recommend backing up the SQL database before installing. I know we have backups to tape drives done by our hosting company, but I want one I know the exact time stamp for and can access quickly if I need to reload it because of a goof during the upgrade. (I don't want to have the store down for any longer than needed.)

*How do you recommend backing up a SQL database for easy reloading for someone who is used to just writing queries and stored procedures?* (I'd like to get everything - mappings & indices, etc - because I wouldn't know what all of them are or how to recreate them.)

I access the database via Remote Desktop and can link my hard drive and DVD drives, if that helps. It's MSSQL 2008.

Thank you so much.

Best wishes,
Andrea",4
2009900,01/05/2010 23:18:09,217182,11/23/2009 17:18:50,1,0,update records only when ID matches,"How would I update data in a table in a separate database based on the records in the current database? 

For instance I want to update the field ""status"" in the database called ""database_old"" with the value contained in the database ""database_new"" . My current data exists in the database ""database_new"". I want to only update records in the ""database_old"" db when the record_id field matches.  The fields ""status"" and ""record_id"" exists in the table ""products"" in both databases.  As as I said the field ""status"" should be updated with the value from the ""database_new"" but only update if the record_id matches.

This a MS SQL 2005 database.",sql,sql-server,,,,,open,0,109,6,"update records only when ID matches How would I update data in a table in a separate database based on the records in the current database? 

For instance I want to update the field ""status"" in the database called ""database_old"" with the value contained in the database ""database_new"" . My current data exists in the database ""database_new"". I want to only update records in the ""database_old"" db when the record_id field matches.  The fields ""status"" and ""record_id"" exists in the table ""products"" in both databases.  As as I said the field ""status"" should be updated with the value from the ""database_new"" but only update if the record_id matches.

This a MS SQL 2005 database.",2
8912434,01/18/2012 15:10:35,1080055,12/04/2011 12:53:29,3,0,Select from duplicated rows the biggest one,"I have a table with data like this

    ID | second_col    
    1  |    1
    1  |    2
    1  |    3
    2  |    1
    2  |    4
    3  |    1
    3  |    5
    4  |    1

and i want select records from duplicated rows with the biggest number in second_col

the result should look as follows...

    ID | second_col    
    1  |    3
    2  |    4
    3  |    5
    4  |    1  
",sql,,,,,,open,0,168,7,"Select from duplicated rows the biggest one I have a table with data like this

    ID | second_col    
    1  |    1
    1  |    2
    1  |    3
    2  |    1
    2  |    4
    3  |    1
    3  |    5
    4  |    1

and i want select records from duplicated rows with the biggest number in second_col

the result should look as follows...

    ID | second_col    
    1  |    3
    2  |    4
    3  |    5
    4  |    1  
",1
9560426,03/05/2012 00:56:25,943340,09/13/2011 20:19:04,920,3,What database online games like Farmville use?,"Apart from graphical features, online games should have a simple Relational Database structure. I am curious what database online games like `Farmville` and `MafiaWars` use?

Is it practically reasonable to use RDBMS and SQL-based databases for such heavily writing actions? If not, how to store relational dependence of users in these games?",sql,database,database-design,relational-database,,03/06/2012 00:28:19,not constructive,1,51,7,"What database online games like Farmville use? Apart from graphical features, online games should have a simple Relational Database structure. I am curious what database online games like `Farmville` and `MafiaWars` use?

Is it practically reasonable to use RDBMS and SQL-based databases for such heavily writing actions? If not, how to store relational dependence of users in these games?",4
3689190,09/11/2010 00:10:21,394178,07/16/2010 18:00:24,51,13,Database table names: Plural or Singular,"What is the most common naming convention for SQL Database tables?
Was it historically one way and now it's better to do another way?
What are the most common practices now?",sql,sql-server,database,sql-server-2008,database-design,09/11/2010 01:01:16,not constructive,1,29,6,"Database table names: Plural or Singular What is the most common naming convention for SQL Database tables?
Was it historically one way and now it's better to do another way?
What are the most common practices now?",5
7267233,09/01/2011 07:31:03,899055,08/17/2011 16:30:21,23,0,SQL Server 2008 – Unsigned Integer Data Types,"I am using SQL SERVER 2008, I have a number of INT, SMALLINT fields in my various tables, And I know they all will be 0 or greater than 0 i.e. I can take them Unsigned.

Is there a simple way of creating/using Unsigned data types OR will I have to Create type->Make Rule->Use the Created Type; as specified in the following article?

http://www.julian-kuiters.id.au/article.php/sqlserver2005-unsigned-integer

If this is the only way to use Unsigned in SQL, is there any disadvantage/drawback of using it?",sql,sql-server-2008,sqldatatypes,unsigned-integer,,,open,0,79,8,"SQL Server 2008 – Unsigned Integer Data Types I am using SQL SERVER 2008, I have a number of INT, SMALLINT fields in my various tables, And I know they all will be 0 or greater than 0 i.e. I can take them Unsigned.

Is there a simple way of creating/using Unsigned data types OR will I have to Create type->Make Rule->Use the Created Type; as specified in the following article?

http://www.julian-kuiters.id.au/article.php/sqlserver2005-unsigned-integer

If this is the only way to use Unsigned in SQL, is there any disadvantage/drawback of using it?",4
9437966,02/24/2012 21:01:12,1091061,12/10/2011 09:40:29,77,6,SELECT FROM slow but fast via temp table,"    SELECT * FROM myView WHERE myCol = 'myVal'

Takes 1 minute

    SELECT * INTO #Temp FROM myView
    SELECT * FROM myView WHERE myCol = 'myVal'

Takes 1 second

Can anyone explain this?

Thanks

L",sql,sql-server,performance,,,02/24/2012 22:49:37,not a real question,1,39,8,"SELECT FROM slow but fast via temp table     SELECT * FROM myView WHERE myCol = 'myVal'

Takes 1 minute

    SELECT * INTO #Temp FROM myView
    SELECT * FROM myView WHERE myCol = 'myVal'

Takes 1 second

Can anyone explain this?

Thanks

L",3
4715677,01/17/2011 16:54:23,450339,09/17/2010 07:18:04,499,51,Difference between left join and right join in SQL Server,"I know about joins in SQL Server.

For example. there is two tables Table1, Table2. 

There table structure are following.

    create table Table1 (id int, Name varchar (10))
    
    create table Table2 (id int, Name varchar (10))


Table1 Data as follows:

        Id     Name     
        -------------
        1      A        
        2      B    

Table2 Data as follows:

        Id     Name     
        -------------
        1      A        
        2      B 
        3      C


If i execute both below mentioned SQL statments. both out puts are same


    Select * from Table1 left join Table2 on Table1.id = Table2.id
    
    Select * from Table2 right join Table1 on Table1.id = Table2.id

Please help me for difference between left and right join for above sql statments.

",sql,sql-server-2005,,,,,open,0,251,10,"Difference between left join and right join in SQL Server I know about joins in SQL Server.

For example. there is two tables Table1, Table2. 

There table structure are following.

    create table Table1 (id int, Name varchar (10))
    
    create table Table2 (id int, Name varchar (10))


Table1 Data as follows:

        Id     Name     
        -------------
        1      A        
        2      B    

Table2 Data as follows:

        Id     Name     
        -------------
        1      A        
        2      B 
        3      C


If i execute both below mentioned SQL statments. both out puts are same


    Select * from Table1 left join Table2 on Table1.id = Table2.id
    
    Select * from Table2 right join Table1 on Table1.id = Table2.id

Please help me for difference between left and right join for above sql statments.

",2
7517689,09/22/2011 15:50:09,530661,12/04/2010 18:57:09,1,0,How to call on a object member procedure a nested table attribute?,"Have this objects and table types: 

    CREATE TYPE Person_typ AS OBJECT
    ( 
        name CHAR(20),
        ssn CHAR(12),
        address VARCHAR2(100)
    );

    CREATE TYPE Person_nt IS TABLE OF Person_typ;
    
    CREATE TYPE dept_typ AS OBJECT
    ( 
        mgr Person_typ,
        emps Person_nt,
        MEMBER PROCEDURE getEmp(name IN  CHAR(20)),
    );

    CREATE TABLE dept OF dept_typ;

How i can get the employer with the function getEmp and argument name ? 
 
    CREATE TYPE BODY dept_typ AS 
       MEMBER  PROCEDURE getEmp(name IN CHAR(20)),
       BEGIN
          ????? What i put where ????
       END;
    END;


My problem is that i can't make **self.emps** like I can do with self.mgr ... and i don't know why....

Thanks,
Joao",sql,oracle,plsql,,,,open,0,209,12,"How to call on a object member procedure a nested table attribute? Have this objects and table types: 

    CREATE TYPE Person_typ AS OBJECT
    ( 
        name CHAR(20),
        ssn CHAR(12),
        address VARCHAR2(100)
    );

    CREATE TYPE Person_nt IS TABLE OF Person_typ;
    
    CREATE TYPE dept_typ AS OBJECT
    ( 
        mgr Person_typ,
        emps Person_nt,
        MEMBER PROCEDURE getEmp(name IN  CHAR(20)),
    );

    CREATE TABLE dept OF dept_typ;

How i can get the employer with the function getEmp and argument name ? 
 
    CREATE TYPE BODY dept_typ AS 
       MEMBER  PROCEDURE getEmp(name IN CHAR(20)),
       BEGIN
          ????? What i put where ????
       END;
    END;


My problem is that i can't make **self.emps** like I can do with self.mgr ... and i don't know why....

Thanks,
Joao",3
11479205,07/13/2012 22:31:57,819916,06/28/2011 20:16:08,380,0,Combine two SQL Tables,"**Table1**

    Col1      Col2            Col3                  Col4      Col5            Col6 
    1345653   330760137950    2012-07-09 21:40:29   1345653   331760137950    1341895229
    1345653   110909316904    2012-07-09 21:29:06   1345653   111909316904    1341894546
    1345653   221065796761    2012-07-09 19:31:48   1345653   221065796761    1341887518


**Table2**
    
    Col11        Col22         Col33                   Col44   Col55   Col66
    1345653      330760137950   2012-07-09 21:40:29     NULL    NULL    NULL
    1345653      110909316904   2012-07-09 21:29:06     NULL    NULL    NULL
    1345653      221065796761   2012-07-09 19:31:48     NULL    NULL    NULL
    1345653    **150851771618**   2012-07-09 18:57:33   NULL    NULL    NULL


If you look above two tables data, last line in `Table2` means `Col22-150851771618` is missing in `Table1`. So If I need to display `Table1` full data and last line from `Table2` as Col22 is missing in `Table1`, like this below output.

    1345653   330760137950    2012-07-09 21:40:29   1345653   331760137950    1341895229
    1345653   110909316904    2012-07-09 21:29:06   1345653   111909316904    1341894546
    1345653   221065796761    2012-07-09 19:31:48   1345653   221065796761    1341887518
    1345653 **150851771618**  2012-07-09 18:57:33   NULL       NULL           NULL

How can I do this using `JOIN` by joining on `Col1` and `Col11`? I am having lot of confusion on this. Can anyone help me?

",sql,join,,,,,open,0,439,4,"Combine two SQL Tables **Table1**

    Col1      Col2            Col3                  Col4      Col5            Col6 
    1345653   330760137950    2012-07-09 21:40:29   1345653   331760137950    1341895229
    1345653   110909316904    2012-07-09 21:29:06   1345653   111909316904    1341894546
    1345653   221065796761    2012-07-09 19:31:48   1345653   221065796761    1341887518


**Table2**
    
    Col11        Col22         Col33                   Col44   Col55   Col66
    1345653      330760137950   2012-07-09 21:40:29     NULL    NULL    NULL
    1345653      110909316904   2012-07-09 21:29:06     NULL    NULL    NULL
    1345653      221065796761   2012-07-09 19:31:48     NULL    NULL    NULL
    1345653    **150851771618**   2012-07-09 18:57:33   NULL    NULL    NULL


If you look above two tables data, last line in `Table2` means `Col22-150851771618` is missing in `Table1`. So If I need to display `Table1` full data and last line from `Table2` as Col22 is missing in `Table1`, like this below output.

    1345653   330760137950    2012-07-09 21:40:29   1345653   331760137950    1341895229
    1345653   110909316904    2012-07-09 21:29:06   1345653   111909316904    1341894546
    1345653   221065796761    2012-07-09 19:31:48   1345653   221065796761    1341887518
    1345653 **150851771618**  2012-07-09 18:57:33   NULL       NULL           NULL

How can I do this using `JOIN` by joining on `Col1` and `Col11`? I am having lot of confusion on this. Can anyone help me?

",2
5592315,04/08/2011 08:15:36,596935,01/31/2011 13:54:47,25,0,Speeading up query by removing cursor,"I have query that looks like this

     declare @tmpTable Table(id int)
     insert into @tmpTable(id) values (3)
     insert into @tmpTable(id) values (5)
     insert into @tmpTable(id) values (11)

     declare @tmp int
     declare @finalString varchar(MAX)
 
     DECLARE c1 CURSOR READ_ONLY FOR SELECT ID FROM @tmpTable
     OPEN c1
     FETCH NEXT FROM c1 INTO @tmp
     set @finalString=cast(@tmp as varchar)
     FETCH NEXT FROM c1 INTO @tmp
     WHILE @@FETCH_STATUS = 0
     begin
      set @finalString=@finalString+','+cast(@tmp as varchar)
      FETCH NEXT FROM c1 INTO @tmp
     end	
     close c1
     deallocate c1	
 
     select @finalString
I want to create string formated this way ""3,5,11"" from table column values, this code works, but is there a better way to do this?",sql,sql-server-2005,,,,,open,0,185,6,"Speeading up query by removing cursor I have query that looks like this

     declare @tmpTable Table(id int)
     insert into @tmpTable(id) values (3)
     insert into @tmpTable(id) values (5)
     insert into @tmpTable(id) values (11)

     declare @tmp int
     declare @finalString varchar(MAX)
 
     DECLARE c1 CURSOR READ_ONLY FOR SELECT ID FROM @tmpTable
     OPEN c1
     FETCH NEXT FROM c1 INTO @tmp
     set @finalString=cast(@tmp as varchar)
     FETCH NEXT FROM c1 INTO @tmp
     WHILE @@FETCH_STATUS = 0
     begin
      set @finalString=@finalString+','+cast(@tmp as varchar)
      FETCH NEXT FROM c1 INTO @tmp
     end	
     close c1
     deallocate c1	
 
     select @finalString
I want to create string formated this way ""3,5,11"" from table column values, this code works, but is there a better way to do this?",2
10348069,04/27/2012 09:22:04,1087823,12/08/2011 13:24:35,11,0,SQL Converting a text field to other text,"Absolute beginner at SQL so apologies for (hopefuly) simple question. 

I have a text field in a table that is populated by a trigger. This information is then processed and posted into a program, however the text is not valid for the program and needs to be converted into a valid text value.

Example
The value inputted into the field can either be 'Sterling' or 'EUROS' but this needs to be converted into 'GBP' (if the value is 'Sterling') or 'EUR' (if the value is 'EUROS') before it attempts to post to program.

How do I do this? 

Thanks

John",sql,convert,,,,,open,0,96,8,"SQL Converting a text field to other text Absolute beginner at SQL so apologies for (hopefuly) simple question. 

I have a text field in a table that is populated by a trigger. This information is then processed and posted into a program, however the text is not valid for the program and needs to be converted into a valid text value.

Example
The value inputted into the field can either be 'Sterling' or 'EUROS' but this needs to be converted into 'GBP' (if the value is 'Sterling') or 'EUR' (if the value is 'EUROS') before it attempts to post to program.

How do I do this? 

Thanks

John",2
11248772,06/28/2012 16:15:51,226897,12/08/2009 05:32:39,21882,978,Parameter sniffing work arounds,"I have used two methods to get around parameter sniffing issues in the past:

 1) Use `WITH RECOMPILE`  
 2) Reassign parameter values to local variables and use those instead of the parameters

From what I understand, the end result of both of these is the same -  a new execution plan that is optimized for the current query/params is created and used.  

If this is true, are there any differences between these two methods or are they essentially the same?  Is one preferable over the other?",sql,sql-server,query-optimization,parameter-sniffing,,06/28/2012 19:01:50,off topic,1,90,4,"Parameter sniffing work arounds I have used two methods to get around parameter sniffing issues in the past:

 1) Use `WITH RECOMPILE`  
 2) Reassign parameter values to local variables and use those instead of the parameters

From what I understand, the end result of both of these is the same -  a new execution plan that is optimized for the current query/params is created and used.  

If this is true, are there any differences between these two methods or are they essentially the same?  Is one preferable over the other?",4
1430986,09/16/2009 04:45:24,166372,09/01/2009 04:28:24,67,3,How Microsoft certification 70432 helps in career building in MS SQL Server and who should go for it?,How Microsoft certification 70432 helps in career building in MS SQL Server and who should go for it?,sql,sql-server,,,,01/27/2012 18:47:44,not constructive,1,18,18,How Microsoft certification 70432 helps in career building in MS SQL Server and who should go for it? How Microsoft certification 70432 helps in career building in MS SQL Server and who should go for it?,2
3858804,10/04/2010 20:19:29,466198,10/04/2010 20:14:56,1,0,"Opinions: SQL Statements, do you use aliases? ","One of the guys I work with has the following to say about using SQL aliases, and he just posted the following on reddit.  What do you guys think, to alias or not to alias?

....

So I've always been the odd man out of my with my dev team about how SQL should be written.
I learned in school to use aliases, but I hate them personally. I find it can make the statement unreadable if long. I want to know what tables are joining to what other tables. I don't want to have to search through a 5-10 table join to figure out what ""p"" means, is that the products table, people, etc...?
Personally I don't find it hard to use a little double click, ctrl+c, ctrl+v. Use the full table name (of course sometimes you have to join to the same table twice which you'll be forced to use aliases in some more bizarre queries.)
Ex. My style
SELECT *
FROM
    People 
JOIN
    Orders ON People.PersonID = Orders.PersonID
JOIN
    OrderDetails ON Orders.OrderID = OrderDetails.OrderID
JOIN
    Products ON Products.ProductID = OrderDetails.ProductID
JOIN
    Country ON People.CountryID = Country.CountryID
VS
SELECT *
FROM
    People p
JOIN
    Orders o ON p.PersonID = o.PersonID
JOIN
    OrderDetails od ON o.OrderID = od.OrderID
JOIN
    Products pr ON pr.ProductID = od.ProductID
JOIN
    Country c ON p.CountryID = c.CountryID
Personal preferences yourself? I mean just consider if this query was a larger join and you had a large select statement.
I assume most people use alias as a time saver, do you think it's also more readable? Can you go to your old sql and instantly understand how your joins work?
",sql,,,,,10/05/2010 01:25:40,not constructive,1,287,8,"Opinions: SQL Statements, do you use aliases?  One of the guys I work with has the following to say about using SQL aliases, and he just posted the following on reddit.  What do you guys think, to alias or not to alias?

....

So I've always been the odd man out of my with my dev team about how SQL should be written.
I learned in school to use aliases, but I hate them personally. I find it can make the statement unreadable if long. I want to know what tables are joining to what other tables. I don't want to have to search through a 5-10 table join to figure out what ""p"" means, is that the products table, people, etc...?
Personally I don't find it hard to use a little double click, ctrl+c, ctrl+v. Use the full table name (of course sometimes you have to join to the same table twice which you'll be forced to use aliases in some more bizarre queries.)
Ex. My style
SELECT *
FROM
    People 
JOIN
    Orders ON People.PersonID = Orders.PersonID
JOIN
    OrderDetails ON Orders.OrderID = OrderDetails.OrderID
JOIN
    Products ON Products.ProductID = OrderDetails.ProductID
JOIN
    Country ON People.CountryID = Country.CountryID
VS
SELECT *
FROM
    People p
JOIN
    Orders o ON p.PersonID = o.PersonID
JOIN
    OrderDetails od ON o.OrderID = od.OrderID
JOIN
    Products pr ON pr.ProductID = od.ProductID
JOIN
    Country c ON p.CountryID = c.CountryID
Personal preferences yourself? I mean just consider if this query was a larger join and you had a large select statement.
I assume most people use alias as a time saver, do you think it's also more readable? Can you go to your old sql and instantly understand how your joins work?
",1
5178446,03/03/2011 08:48:52,305732,03/31/2010 06:35:03,135,6,Access 2000 Query Execution Time,"I have two tables like Parent-Child. In Parent table, there are 7211 records. In Child, there are 169498 records. Between these two tables, there is no relationship (means haven't set Foreign Key, but using parentID). In Child table, there are extra records and missing records. 

As A sample,

    Parent Table - tblParent
    PID     PName
    A001    John
    B002    Mary
    ...     ...

    Child Table  - tblChild
    PID   TID   Desc
    A001  056   Book
    Y004  087   Pen
    ...   ...   ...

When I make a query like below,

    SELECT PID
    FROM tblParent
    WHERE PID NOT IN
    (
    SELECT PID
    FROM tblChild
    )

MS Access is halt suddenly. If i test with 10 records, it works properly. What is the main cause? No of records?",sql,ms-access,,,,,open,0,197,5,"Access 2000 Query Execution Time I have two tables like Parent-Child. In Parent table, there are 7211 records. In Child, there are 169498 records. Between these two tables, there is no relationship (means haven't set Foreign Key, but using parentID). In Child table, there are extra records and missing records. 

As A sample,

    Parent Table - tblParent
    PID     PName
    A001    John
    B002    Mary
    ...     ...

    Child Table  - tblChild
    PID   TID   Desc
    A001  056   Book
    Y004  087   Pen
    ...   ...   ...

When I make a query like below,

    SELECT PID
    FROM tblParent
    WHERE PID NOT IN
    (
    SELECT PID
    FROM tblChild
    )

MS Access is halt suddenly. If i test with 10 records, it works properly. What is the main cause? No of records?",2
9752361,03/17/2012 17:53:37,967078,09/27/2011 12:55:41,3,0,SQL ROW_NUMBER with INNER JOIN,"I need to use ROW_NUMBER() in the following Query to return rows 5 to 10 of the result. Can anyone please show me what I need to do? I've been trying to no avail. If anyone can help I'd really appreciate it.


Thanks,


J


SELECT * FROM villa_data INNER JOIN villa_prices ON villa_prices.starRating=villa_data.starRating 

WHERE villa_data.capacity >= 3 AND villa_data.bedrooms >= 1 AND villa_prices.period = 'lowSeason' 

ORDER BY villa_prices.price,villa_data.bedrooms,villa_data.capacity",sql,sql-server,row-number,,,,open,0,65,5,"SQL ROW_NUMBER with INNER JOIN I need to use ROW_NUMBER() in the following Query to return rows 5 to 10 of the result. Can anyone please show me what I need to do? I've been trying to no avail. If anyone can help I'd really appreciate it.


Thanks,


J


SELECT * FROM villa_data INNER JOIN villa_prices ON villa_prices.starRating=villa_data.starRating 

WHERE villa_data.capacity >= 3 AND villa_data.bedrooms >= 1 AND villa_prices.period = 'lowSeason' 

ORDER BY villa_prices.price,villa_data.bedrooms,villa_data.capacity",3
8520193,12/15/2011 12:34:42,1099310,12/15/2011 07:08:52,1,0,When i am executing stored procedure. Only column name is showing. No data displaying in Table,"Alter proc pr_membersDirectorys(
@comcode int = 0,
@SubComCode int = 0
)
as
begin
set nocount on
Create table #member(TurnOver numeric,Memcode nvarchar(100),MemName nvarchar(200))
If @comcode=0 
begin
insert into #member(TurnOver,Memcode,MemName)
select 
(select sum(amount)    
	from tbcoudet 
	where memcode=tbm.memcode and expyear=(select max(expyear) from tbexpyear) 
    and exists(select itemcode 
			from tbitem 
			where comcode=@comcode and 
				  SubComCode=@SubComCode and
				  itemcode=tbcoudet.itemcode
			)
	group by memcode,expyear
)'TurnOver'
, memcode,memname from tbmember tbm where can_flag='N'
End
Else If @subcomcode=0
begin
insert into #member(TurnOver,Memcode,MemName)
select 
(select sum(amount)    
	from tbcoudet 
	where memcode=tbm.memcode and expyear=(select max(expyear) from tbexpyear) 
    and exists(select itemcode 
			from tbitem 
			where comcode=@comcode and 
				  itemcode=tbcoudet.itemcode
			)
	group by memcode,expyear
)'TurnOver'
, memcode,memname from tbmember tbm where can_flag='N'
End

select top 10 * from #member where TurnOver is not null order by TurnOver desc

End

This is my Code.When i am executing stored procedure. Only column name is showing. No data displaying in Table.Can you please tell me what is the problem in my code. please",sql,query,stored-procedures,,,12/15/2011 19:36:34,too localized,1,145,16,"When i am executing stored procedure. Only column name is showing. No data displaying in Table Alter proc pr_membersDirectorys(
@comcode int = 0,
@SubComCode int = 0
)
as
begin
set nocount on
Create table #member(TurnOver numeric,Memcode nvarchar(100),MemName nvarchar(200))
If @comcode=0 
begin
insert into #member(TurnOver,Memcode,MemName)
select 
(select sum(amount)    
	from tbcoudet 
	where memcode=tbm.memcode and expyear=(select max(expyear) from tbexpyear) 
    and exists(select itemcode 
			from tbitem 
			where comcode=@comcode and 
				  SubComCode=@SubComCode and
				  itemcode=tbcoudet.itemcode
			)
	group by memcode,expyear
)'TurnOver'
, memcode,memname from tbmember tbm where can_flag='N'
End
Else If @subcomcode=0
begin
insert into #member(TurnOver,Memcode,MemName)
select 
(select sum(amount)    
	from tbcoudet 
	where memcode=tbm.memcode and expyear=(select max(expyear) from tbexpyear) 
    and exists(select itemcode 
			from tbitem 
			where comcode=@comcode and 
				  itemcode=tbcoudet.itemcode
			)
	group by memcode,expyear
)'TurnOver'
, memcode,memname from tbmember tbm where can_flag='N'
End

select top 10 * from #member where TurnOver is not null order by TurnOver desc

End

This is my Code.When i am executing stored procedure. Only column name is showing. No data displaying in Table.Can you please tell me what is the problem in my code. please",3
1108950,07/10/2009 11:04:28,136161,07/10/2009 09:44:40,18,0,NVL statement,"can nvl() function be cascaded,...it was asked me in IBM interview .....and why????",sql,function,,,,,open,0,13,2,"NVL statement can nvl() function be cascaded,...it was asked me in IBM interview .....and why????",2
10458621,05/05/2012 03:36:18,1019215,10/28/2011 22:52:21,2170,147,Why is there STILL no sql shortcut to include/not include null values in a where condition?,"     select 1 where somevalue = '' or somevalue is null from sometable

I completely understand the reasoning behind *why* I have to have two separate conditions.  What baffles my mind is why after so many years there still isn't a standard shortcut notation for this.

I can see why various dbms implementations don't offer a shortcut since it isn't necessary and doing so would make your sql that much less portable, but considering the usefulness of such a shortcut across all dbms's I can't comprehend why the powers that be haven't added a shortcut to do this into the sql specifications.

My question:  Is there actually a legitimate reason and if so what is it?",sql,sql-standards,,,,05/06/2012 02:07:24,not constructive,1,119,16,"Why is there STILL no sql shortcut to include/not include null values in a where condition?      select 1 where somevalue = '' or somevalue is null from sometable

I completely understand the reasoning behind *why* I have to have two separate conditions.  What baffles my mind is why after so many years there still isn't a standard shortcut notation for this.

I can see why various dbms implementations don't offer a shortcut since it isn't necessary and doing so would make your sql that much less portable, but considering the usefulness of such a shortcut across all dbms's I can't comprehend why the powers that be haven't added a shortcut to do this into the sql specifications.

My question:  Is there actually a legitimate reason and if so what is it?",2
10899661,06/05/2012 14:56:25,982383,10/06/2011 14:35:52,1,1,SQL - Substring only if string length > 2,"I was wondering if it was possible to only substring if the string length is > 2?

Here is my sample statement: 

`Select SUBSTRING(ABRESC, 1, 2) + '-' + SUBSTRING(ABRESC, 3, 5) AS ABRESC From TABLE`

However, some fields are only 2 chars long so i was wondering if its possible to only substring when its longer than 2 chars?",sql,substring,length,,,,open,0,58,9,"SQL - Substring only if string length > 2 I was wondering if it was possible to only substring if the string length is > 2?

Here is my sample statement: 

`Select SUBSTRING(ABRESC, 1, 2) + '-' + SUBSTRING(ABRESC, 3, 5) AS ABRESC From TABLE`

However, some fields are only 2 chars long so i was wondering if its possible to only substring when its longer than 2 chars?",3
11244562,06/28/2012 12:22:22,967797,09/27/2011 19:49:49,67,0,Nest a select statement within an update statement,"This is my update statement which works perfectly. If table 1 and table 2 contain an equal serial number then table 1 is updated with a yes and if it doesnt then it is updated with a no.
 
    UPDATE dbo.table1
    SET [Match] = CASE WHEN dbo.table2.[Serial Number] IS NOT NULL
    THEN 'yes' ELSE 'no' END
    FROM dbo.table1 LEFT OUTER JOIN dbo.table2
        ON dbo.table2.[Serial Number] = dbo.table1.[Serial Number]
    AND dbo.table1.[Date] = 'JAN11' AND 
          dbo.table1.[Install] = 'new' AND
          dbo.table2.[Date] = 'JAN11' AND 
          dbo.table2.[Install] = 'new'


The problem is currently everything in table 1 that isnt being called is also updated with a no so what i want to do is first call a select statement... something like this

    select * from table1 where [Date] = 'JAN11' AND [Install] = 'new'

and nest it within the update so that the relevant columns only are updated with no or yes...

",sql,sql-server,query,,,,open,0,199,8,"Nest a select statement within an update statement This is my update statement which works perfectly. If table 1 and table 2 contain an equal serial number then table 1 is updated with a yes and if it doesnt then it is updated with a no.
 
    UPDATE dbo.table1
    SET [Match] = CASE WHEN dbo.table2.[Serial Number] IS NOT NULL
    THEN 'yes' ELSE 'no' END
    FROM dbo.table1 LEFT OUTER JOIN dbo.table2
        ON dbo.table2.[Serial Number] = dbo.table1.[Serial Number]
    AND dbo.table1.[Date] = 'JAN11' AND 
          dbo.table1.[Install] = 'new' AND
          dbo.table2.[Date] = 'JAN11' AND 
          dbo.table2.[Install] = 'new'


The problem is currently everything in table 1 that isnt being called is also updated with a no so what i want to do is first call a select statement... something like this

    select * from table1 where [Date] = 'JAN11' AND [Install] = 'new'

and nest it within the update so that the relevant columns only are updated with no or yes...

",3
3121151,06/25/2010 20:15:42,244178,01/05/2010 19:03:17,22,0,DB2 SELECT using alpha wildcard and the length of 4 characters,"I need to do a SELECT for a product_id where the length the product_id is 4 characters long and the last character can be any letter.  I know the wildcard for selecting any letters but I don't know how to denote that it has to be the last character and that the product_ids I'm looking for must be 4 characters long.

Does that make sense?",sql,select,db2,,,,open,0,65,11,"DB2 SELECT using alpha wildcard and the length of 4 characters I need to do a SELECT for a product_id where the length the product_id is 4 characters long and the last character can be any letter.  I know the wildcard for selecting any letters but I don't know how to denote that it has to be the last character and that the product_ids I'm looking for must be 4 characters long.

Does that make sense?",3
8326750,11/30/2011 13:32:29,1072850,11/30/2011 07:37:47,18,0,Is there any quicker way of inserting 10 million records in a table from a select query in SQL,"I wish to insert 10 million records into a table using a select query. This process is taking a very long time.. Are there any alternatives?
",sql,database,oracle,query,pl,11/30/2011 16:11:37,not a real question,1,26,19,"Is there any quicker way of inserting 10 million records in a table from a select query in SQL I wish to insert 10 million records into a table using a select query. This process is taking a very long time.. Are there any alternatives?
",5
6688555,07/14/2011 04:39:33,364,08/05/2008 05:33:41,10874,391,Is there a safe way to cast SQL datetimes?,"Pretty simple question that I can't quite find the answer for:

Is there a simple and safe† way to cast a `varchar` to `datetime` in SQL Server?

 † i.e. gracefully handle non-datetime strings with a default datetime value",sql,sql-server,,,,,open,0,37,9,"Is there a safe way to cast SQL datetimes? Pretty simple question that I can't quite find the answer for:

Is there a simple and safe† way to cast a `varchar` to `datetime` in SQL Server?

 † i.e. gracefully handle non-datetime strings with a default datetime value",2
10613846,05/16/2012 07:25:40,1192399,02/06/2012 13:40:44,1,0,create table with sequence.nextval in oracle,"i created a sequence using the following query,

    create sequence qname_id_seq start with 1 increment by 1 nocache;

Now when i try to create a table which uses the above sequence, it is throwing the following error,

    Error report:
    SQL Error: ORA-00907: missing right parenthesis
    00907. 00000 -  ""missing right parenthesis""

I used the following query to create a table with sequence.nextval,

    CREATE TABLE qname
    (
        qname_id integer NOT NULL default qname_id_seq.nextval PRIMARY KEY,
        qname    VARCHAR2(4000) NOT NULL -- CONSTRAINT qname_uk UNIQUE
    );",sql,database,oracle,query,plsql,,open,0,120,6,"create table with sequence.nextval in oracle i created a sequence using the following query,

    create sequence qname_id_seq start with 1 increment by 1 nocache;

Now when i try to create a table which uses the above sequence, it is throwing the following error,

    Error report:
    SQL Error: ORA-00907: missing right parenthesis
    00907. 00000 -  ""missing right parenthesis""

I used the following query to create a table with sequence.nextval,

    CREATE TABLE qname
    (
        qname_id integer NOT NULL default qname_id_seq.nextval PRIMARY KEY,
        qname    VARCHAR2(4000) NOT NULL -- CONSTRAINT qname_uk UNIQUE
    );",5
11605687,07/23/2012 02:16:08,1544731,07/23/2012 01:39:55,1,0,"minimum impact ""like"" request on Sybase ASE 12.5 DB","I would like to minimize the performace impact of the following query on a Sybase ASE 12.5 database

SELECT description_field FROM table WHERE description_field LIKE 'HEADER%'
GO

I suspect I cannot do better than a full table scan without modifying the database but does someone have an idea?
Perhaps an improvement relative to locking would be done thanks to a special syntax?
",sql,query,optimization,locking,sybase,,open,0,58,9,"minimum impact ""like"" request on Sybase ASE 12.5 DB I would like to minimize the performace impact of the following query on a Sybase ASE 12.5 database

SELECT description_field FROM table WHERE description_field LIKE 'HEADER%'
GO

I suspect I cannot do better than a full table scan without modifying the database but does someone have an idea?
Perhaps an improvement relative to locking would be done thanks to a special syntax?
",5
7638306,10/03/2011 17:10:25,797830,06/14/2011 14:24:53,3,0,Now my query returns the plant if there is no data but,"It's summing everything for all rows. [http://imgur.com/ZwwqN] and here is the query:
{http://imgur.com/GEl6L]

Sorry for the links but I don't have upload privileges yet. 

I'm wondering if the problem lies in my WHERE clause? I'm still very new to this and with a WHERE clause this big it can get screwy quick. 

Thanks in advance!

Aaron",sql,reporting-services,,,,10/04/2011 03:24:58,not a real question,1,53,12,"Now my query returns the plant if there is no data but It's summing everything for all rows. [http://imgur.com/ZwwqN] and here is the query:
{http://imgur.com/GEl6L]

Sorry for the links but I don't have upload privileges yet. 

I'm wondering if the problem lies in my WHERE clause? I'm still very new to this and with a WHERE clause this big it can get screwy quick. 

Thanks in advance!

Aaron",2
296972,11/17/2008 21:19:37,36269,11/10/2008 18:08:14,6,0,SQL to LINQ Tool,"Is there a tool out there which can convert SQL syntax to LINQ syntax?  I just want to rewrite basic queries with join, etc, to LINQ.  It would save me a lot of time.

Cheers!",sql,linq,,,,12/13/2011 14:29:49,not constructive,1,36,4,"SQL to LINQ Tool Is there a tool out there which can convert SQL syntax to LINQ syntax?  I just want to rewrite basic queries with join, etc, to LINQ.  It would save me a lot of time.

Cheers!",2
8658610,12/28/2011 16:35:23,1119662,12/28/2011 16:25:57,1,0,how to evaluate the table using PL/SQL program,"I have a table  ""emp"" the attribute are empno,empname,salary .I want to write a plsql program for evaluate the Salary<20000,Salary<30000 AND Salary>20000  from emp table by accepting empno.if condition Salary>20000 will true then display ""Salary is less than 20000"" ,if the condition ""Salary<30000 AND Salary>20000 "" the display ""Salary is less than 30000 but greater than 20000"" . please help me any one for creating a pl/sql program ",sql,oracle,plsql,,,12/29/2011 16:39:54,too localized,1,71,8,"how to evaluate the table using PL/SQL program I have a table  ""emp"" the attribute are empno,empname,salary .I want to write a plsql program for evaluate the Salary<20000,Salary<30000 AND Salary>20000  from emp table by accepting empno.if condition Salary>20000 will true then display ""Salary is less than 20000"" ,if the condition ""Salary<30000 AND Salary>20000 "" the display ""Salary is less than 30000 but greater than 20000"" . please help me any one for creating a pl/sql program ",3
5100628,02/24/2011 05:13:11,629979,02/23/2011 10:29:56,1,0,How to start writing from simple sql queries to complex queries.,I want to begin with  writing simple SQL queries and after that complex queries.So please send me material if any one has or where can I get material so that I can understand and learn to write from  basic quereies  to complex queries.,sql,query,,,,02/24/2011 07:50:07,not a real question,1,46,11,How to start writing from simple sql queries to complex queries. I want to begin with  writing simple SQL queries and after that complex queries.So please send me material if any one has or where can I get material so that I can understand and learn to write from  basic quereies  to complex queries.,2
5522816,04/02/2011 11:20:17,688654,04/02/2011 05:44:00,1,0,i want to search all the person in city by giving the city name,"my code is
  if(searchby.equals(""City""))
        {
             try
            {

            Class.forName(""sun.jdbc.odbc.JdbcOdbcDriver"");
            System.out.println(""\n Driver loaded"");
            Connection con=DriverManager.getConnection(""jdbc:odbc:wanisamajDB"");
            Statement stmt=con.createStatement();
            ResultSet rs = stmt.executeQuery(""SELECT Name FROM FAMILYcensus WHERE Name.City LIKE='"" + tfsearch.getText() + ""'"");
            System.out.println(""Hi"");

            rs.next();
            String city = rs.getString(""NAME"");
            System.out.println(""NAME: "" + city );

            JOptionPane.showMessageDialog(null, ""RECORD FOUND"");

//            initComponents();
//            setDefaultCloseOperation(javax.swing.WindowConstants.HIDE_ON_CLOSE);
//            this.setLocation(300, 200);
            //tfprodid.setText(id1);

             tasearch.setText(city);
            }

           catch (Exception e)
           {
            System.out.println(""EXCEPTION "" + e);

           }
       }",sql,query,,,,04/06/2011 09:09:22,not a real question,1,315,14,"i want to search all the person in city by giving the city name my code is
  if(searchby.equals(""City""))
        {
             try
            {

            Class.forName(""sun.jdbc.odbc.JdbcOdbcDriver"");
            System.out.println(""\n Driver loaded"");
            Connection con=DriverManager.getConnection(""jdbc:odbc:wanisamajDB"");
            Statement stmt=con.createStatement();
            ResultSet rs = stmt.executeQuery(""SELECT Name FROM FAMILYcensus WHERE Name.City LIKE='"" + tfsearch.getText() + ""'"");
            System.out.println(""Hi"");

            rs.next();
            String city = rs.getString(""NAME"");
            System.out.println(""NAME: "" + city );

            JOptionPane.showMessageDialog(null, ""RECORD FOUND"");

//            initComponents();
//            setDefaultCloseOperation(javax.swing.WindowConstants.HIDE_ON_CLOSE);
//            this.setLocation(300, 200);
            //tfprodid.setText(id1);

             tasearch.setText(city);
            }

           catch (Exception e)
           {
            System.out.println(""EXCEPTION "" + e);

           }
       }",2
11239469,06/28/2012 06:55:56,1487679,06/28/2012 06:36:17,1,0,Select Query to duplicate records,"I need a query to select records as per below order:

I've table records:

**A | B | Status |**
1 | 30|  71 
2 | 10|  71
3 | 10|  71
3 | 10|  71
3 | 15|  70
4 | 11|  71
5 | 10|  71
5 | 12|  70
5 | 13|  71
5 | 13|  71
5 | 13|  71
6 | 13|  71

I want to select exactly the below result, I'm looking for query to display output as per below table 

**A | B  | status |** 
1 | 30 |  71    |
2 | 10 |  71    |
3 | 10 |  71    |
4 | 11 |  71    |
5 | 10 |  71    |
5 | 13 |  71    |
5 | 30 |  71    |
6 | 13 |  71    |",sql,,,,,06/30/2012 16:26:32,not a real question,1,165,5,"Select Query to duplicate records I need a query to select records as per below order:

I've table records:

**A | B | Status |**
1 | 30|  71 
2 | 10|  71
3 | 10|  71
3 | 10|  71
3 | 15|  70
4 | 11|  71
5 | 10|  71
5 | 12|  70
5 | 13|  71
5 | 13|  71
5 | 13|  71
6 | 13|  71

I want to select exactly the below result, I'm looking for query to display output as per below table 

**A | B  | status |** 
1 | 30 |  71    |
2 | 10 |  71    |
3 | 10 |  71    |
4 | 11 |  71    |
5 | 10 |  71    |
5 | 13 |  71    |
5 | 30 |  71    |
6 | 13 |  71    |",1
6233248,06/03/2011 22:25:10,343299,05/17/2010 17:28:58,52,2,How can I ORDER BY according to some boolean logic?,"Say I have columns 'a' and 'b'.  A record is deemed 'ready' if `!a || b`.  How can I sort by this ready condition?  I'm really rusty with SQL and I can't recall what would have been the best way to do this.  My guess is that I would be able to add a column with the boolean result and then sort by that column, but I've tried searching and can't seem to find what I'm looking for.",sql,query,sorting,columns,boolean,,open,0,82,10,"How can I ORDER BY according to some boolean logic? Say I have columns 'a' and 'b'.  A record is deemed 'ready' if `!a || b`.  How can I sort by this ready condition?  I'm really rusty with SQL and I can't recall what would have been the best way to do this.  My guess is that I would be able to add a column with the boolean result and then sort by that column, but I've tried searching and can't seem to find what I'm looking for.",5
11285530,07/01/2012 20:48:42,1494752,07/01/2012 20:43:03,1,0,create procedure couldnot be executed,"CREATE PROCEDURE CHECK_EMAILID(@EMAIL_ID NVARCHAR(50))
AS
BEGIN
SELECT EMAIL_ID FROM LOGIN WHERE EMAIL_ID=@EMAIL_ID
END

the above procedure is giving Error Code: 1064
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '@EMAIL_ID NVARCHAR(50))
AS
BEGIN
SELECT EMAIL_ID FROM LOGIN WHERE EMAIL_ID=@EMAI' at line 1

plz help... give the correct statement for creating procedure",sql,stored-procedures,,,,07/03/2012 12:43:02,not a real question,1,58,5,"create procedure couldnot be executed CREATE PROCEDURE CHECK_EMAILID(@EMAIL_ID NVARCHAR(50))
AS
BEGIN
SELECT EMAIL_ID FROM LOGIN WHERE EMAIL_ID=@EMAIL_ID
END

the above procedure is giving Error Code: 1064
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '@EMAIL_ID NVARCHAR(50))
AS
BEGIN
SELECT EMAIL_ID FROM LOGIN WHERE EMAIL_ID=@EMAI' at line 1

plz help... give the correct statement for creating procedure",2
4013607,10/25/2010 10:18:56,300301,03/23/2010 20:50:45,8,0,SQL 2000: only select records where xp_fileexist = true?,"imagine i have a table called tbl_pictures: picture_id and picture_name and there are about 500 records in that table. The pictures are stored in c:\mypics\

The problem: not all photos exists anymore, but they ARE still in the table.
How can i list only those pictures that DO exist?

I do know how to check if a single file exists with ""EXEC Master.dbo.xp_fileexist @filename"", but i don't know how to do it in a loop.

It should look something like below:
SELECT picture_name FROM tbl_pictures WHERE (xp_fileexist '@picture_name' = true)

Anyone? :)",sql,file-exists,,,,,open,0,86,9,"SQL 2000: only select records where xp_fileexist = true? imagine i have a table called tbl_pictures: picture_id and picture_name and there are about 500 records in that table. The pictures are stored in c:\mypics\

The problem: not all photos exists anymore, but they ARE still in the table.
How can i list only those pictures that DO exist?

I do know how to check if a single file exists with ""EXEC Master.dbo.xp_fileexist @filename"", but i don't know how to do it in a loop.

It should look something like below:
SELECT picture_name FROM tbl_pictures WHERE (xp_fileexist '@picture_name' = true)

Anyone? :)",2
3178743,07/05/2010 10:25:58,293069,03/13/2010 18:04:24,112,6,Update statement using current value of the table,"I want to update a row in a table by incrementing by one the integer value of one of the field..

The current doesn't work, why?

    Update htmIndex SET numObs = numObs+1 where ...",sql,oracle,,,,,open,0,36,8,"Update statement using current value of the table I want to update a row in a table by incrementing by one the integer value of one of the field..

The current doesn't work, why?

    Update htmIndex SET numObs = numObs+1 where ...",2
7930533,10/28/2011 14:24:34,700074,04/09/2011 15:28:29,177,2,active record - grouping with joins,"I want to be able to output something like the following:

    Name     Car Type 1     Car Type 2     Car Type 3
    Dave     1                    3          6
    Mike     5                    2          8

Any advice on achieving this with active record?


Models:

    class Person
    #name
     has_many :sales
    end
    
    class Sales
    	belongs_to :person
    	belongs_to :car
    end
      
    class Cars
     #type, id, name
    	has_many :sales
    end


",sql,ruby-on-rails,activerecord,,,,open,0,190,6,"active record - grouping with joins I want to be able to output something like the following:

    Name     Car Type 1     Car Type 2     Car Type 3
    Dave     1                    3          6
    Mike     5                    2          8

Any advice on achieving this with active record?


Models:

    class Person
    #name
     has_many :sales
    end
    
    class Sales
    	belongs_to :person
    	belongs_to :car
    end
      
    class Cars
     #type, id, name
    	has_many :sales
    end


",3
3974422,10/20/2010 02:54:54,481202,10/20/2010 02:54:54,1,0,please any one provide sql server 2005 BIDS software to install in my pc,please any one provide sql server 2005 BIDS software to install in my pc. is there any free download for this software . really its urgent for me please any one help me,sql,sql-server-2005,server,,,10/20/2010 03:56:11,off topic,1,33,14,please any one provide sql server 2005 BIDS software to install in my pc please any one provide sql server 2005 BIDS software to install in my pc. is there any free download for this software . really its urgent for me please any one help me,3
7001886,08/09/2011 19:34:37,886646,08/09/2011 19:34:37,1,0,A selection with the lowest id,"This is my thaught...

Im making an selection from a database and one column contains an id, this one is called prodplan_id. 
In my selection i get alot of post but i only want those rows containing the lowest id..

This is my sql question if it helps:

    SELECT oe.id AS oeID, oh.ordernumber, oe.order_line, oe.prod_week, oe.prodplan_id, oe.door_type, oe.amount AS amountOfDoors, oe.inner_color, 
    oe.outer_color, oe.prod_week, a.name, a.description, i.amount AS iAmount, md.status AS mdStatus, i.width, i.length, c.color_name AS innerColor, 
    c2.color_name AS outerColor, pp.status, oe.pos, d.name, md.id AS mdid FROM pd_mounting_details AS md 
    LEFT OUTER JOIN pd_order_eco AS oe ON md.order_data = oe.id 
    LEFT OUTER JOIN pd_article AS a ON md.article = a.id 
    LEFT OUTER JOIN pd_inventory AS i ON md.id = i.pp_id 
    LEFT OUTER JOIN pd_order_head AS oh ON oe.order_head = oh.id 
    LEFT OUTER JOIN pd_colors AS c ON oe.inner_color = c.id 
    LEFT OUTER JOIN pd_colors AS c2 ON oe.outer_color = c2.id 
    LEFT OUTER JOIN pd_doors as d ON oe.door=d.id 
    LEFT OUTER JOIN pd_production_plan AS pp ON oe.prodplan_id = pp.id 
    WHERE (a.production_group = 4) AND (NOT (oe.amount = 0)) AND (pp.status = 4) and md.status =4 and (startTime ='' OR startTime is null) 
    AND (stopTime ='' or stopTime is null) ORDER BY oe.pos

Best regards",sql,,,,,08/09/2011 19:46:41,not a real question,1,250,6,"A selection with the lowest id This is my thaught...

Im making an selection from a database and one column contains an id, this one is called prodplan_id. 
In my selection i get alot of post but i only want those rows containing the lowest id..

This is my sql question if it helps:

    SELECT oe.id AS oeID, oh.ordernumber, oe.order_line, oe.prod_week, oe.prodplan_id, oe.door_type, oe.amount AS amountOfDoors, oe.inner_color, 
    oe.outer_color, oe.prod_week, a.name, a.description, i.amount AS iAmount, md.status AS mdStatus, i.width, i.length, c.color_name AS innerColor, 
    c2.color_name AS outerColor, pp.status, oe.pos, d.name, md.id AS mdid FROM pd_mounting_details AS md 
    LEFT OUTER JOIN pd_order_eco AS oe ON md.order_data = oe.id 
    LEFT OUTER JOIN pd_article AS a ON md.article = a.id 
    LEFT OUTER JOIN pd_inventory AS i ON md.id = i.pp_id 
    LEFT OUTER JOIN pd_order_head AS oh ON oe.order_head = oh.id 
    LEFT OUTER JOIN pd_colors AS c ON oe.inner_color = c.id 
    LEFT OUTER JOIN pd_colors AS c2 ON oe.outer_color = c2.id 
    LEFT OUTER JOIN pd_doors as d ON oe.door=d.id 
    LEFT OUTER JOIN pd_production_plan AS pp ON oe.prodplan_id = pp.id 
    WHERE (a.production_group = 4) AND (NOT (oe.amount = 0)) AND (pp.status = 4) and md.status =4 and (startTime ='' OR startTime is null) 
    AND (stopTime ='' or stopTime is null) ORDER BY oe.pos

Best regards",1
3564081,08/25/2010 08:31:25,130965,06/30/2009 09:54:21,56,1,sql server 2000 instance specific setting to cause varchar to int error,"I am having an inconsistent issue being produced on one of my servers whereby I have the following

    Select * 
    from SomeVarcharTable v
    join SomeIntTable i on i.MyInt=v.MyVarchar
    Where v.Id = SomeID

The ""MyVarChar"" column is surprisingly of type varchar, and ""MyInt"" is of type int.

Whats curious is that when I run this on my development instance of Sql 2000, I receive no error.

When I run this on my Live instance of Sql 2000 I receive the following error:

    Syntax error converting the varchar value '1.4' to a column of data type int.

Does anyone know of any server settings which might cause this. I have gone so far as to do a restore of my production database to my development system and the error doesn't occur.

I wondered whether it was something to do with the sql query engine, but this was working without an issue a few days ago.

Also, I am aware that this is not best practice, and that I could fix the above query by this:

    Select * 
    from SomeVarcharTable v
    join SomeIntTable i on cast(i.MyInt as varchar)=v.MyVarchar
    Where v.Id = SomeID

I am more interested at this stage in wondering why the issue has been caused, so I can educate others in my company

Thanks in advance

Mark.",sql,query,server,,,,open,0,236,12,"sql server 2000 instance specific setting to cause varchar to int error I am having an inconsistent issue being produced on one of my servers whereby I have the following

    Select * 
    from SomeVarcharTable v
    join SomeIntTable i on i.MyInt=v.MyVarchar
    Where v.Id = SomeID

The ""MyVarChar"" column is surprisingly of type varchar, and ""MyInt"" is of type int.

Whats curious is that when I run this on my development instance of Sql 2000, I receive no error.

When I run this on my Live instance of Sql 2000 I receive the following error:

    Syntax error converting the varchar value '1.4' to a column of data type int.

Does anyone know of any server settings which might cause this. I have gone so far as to do a restore of my production database to my development system and the error doesn't occur.

I wondered whether it was something to do with the sql query engine, but this was working without an issue a few days ago.

Also, I am aware that this is not best practice, and that I could fix the above query by this:

    Select * 
    from SomeVarcharTable v
    join SomeIntTable i on cast(i.MyInt as varchar)=v.MyVarchar
    Where v.Id = SomeID

I am more interested at this stage in wondering why the issue has been caused, so I can educate others in my company

Thanks in advance

Mark.",3
7975270,11/02/2011 02:45:23,893129,08/13/2011 14:08:57,1,0,server-side sql vs client-side sql,"I have been looking to find answers to this question from past two hours. I haven't found even one single relevant post/book/answer. Could somebody explain the difference between server-side scripting and client-side scripting to me. I know that triggers are part of server-side scripting but really, whats the difference between the two. Could you please provide me with couple examples. 

Thanks!",sql,,,,,11/02/2011 08:38:45,not a real question,1,61,5,"server-side sql vs client-side sql I have been looking to find answers to this question from past two hours. I haven't found even one single relevant post/book/answer. Could somebody explain the difference between server-side scripting and client-side scripting to me. I know that triggers are part of server-side scripting but really, whats the difference between the two. Could you please provide me with couple examples. 

Thanks!",1
10880998,06/04/2012 12:06:09,1425709,05/30/2012 09:49:06,15,0,How to perform this?,"I have 4 tables as follows,  ;

    tbl_UserInfo		DUMMY VALUES		DATATYPE	
    UserID			       1		     	Integer	(PRIMARY KEY)	
    UserName		       A			    Text		
    FacebookID		    10021556		    Text		
    EmailID			    ABC@gmail.com		Text		
    Facebook_EmailID	asdf@asfd.com		Text		
    Password		    welcome123		    Text		
    Chips		        	100	    		Integer		
    DeviceType		       iphone			Text	

  

     tbl_Game		    DUMMY VALUES		DATA TYPE	
     GameID			        1		    	Integer		
     Type			      H or M			Text		
     Complete		        No			    Text	

	
    		
    tbl_GamePlayer		DUMMY VALUES		DATA TYPE
    ID		             	1			Integer (PRIMARY KEY)
    GameID			        1			Integer (FOREIGN KEY FOR GameID in tbl_Game)
    Player1			        1			Integer	(FOREIGN KEY FOR UserID in tbl_UserInfo)	
    Player2			        2			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player3			        3			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player4			        4			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player5			        5			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    
    
    tbl_Streaks		     DUMMY VALUES		DATA TYPE
    ID			           1			Integer
    GameID			       1			Integer (FOREIGN KEY FOR GameID in tbl_Game)
    Player1			       1			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player2			       2			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Streaks			       2			Integer

i want reslut as


    {
    Player1 = ""A""
    Player2 = 'B""
    Streaks = 10 (between Player1  and Player2)
    Chips = 100 (for player1)
    Chips = 200 (for player2)
    Fbid= 124578 (for player1)
    Fbid = 784512 (for player2)
    }
    
    {
    Player1 = ""A""
    Player2 = 'C""
    Streaks = 15 (between Player1  and Player3)
    Chips = 100 (for player1)
    Chips = 450 (for player3)
    Fbid= 5654578 (for player1)
    Fbid = 7845512 (for player3)
    }
    
    {
    Player1 = ""A""
    Player2 = 'D""
    Streaks = 5(between Player1  and Player4)
    Chips = 100 (for player1)
    Chips = 208 (for player4)
    Fbid= 12898978 (for player1)
    Fbid = 78488512 (for player4)
    }

I want to display all the existing games of logged in user (with his other players's fbids, usernames, chips, streaks) with complete = 'No'

Note - userid is passed as parameter and all players are connected by their userid

",sql,database,query,,,06/04/2012 14:06:44,not a real question,1,633,4,"How to perform this? I have 4 tables as follows,  ;

    tbl_UserInfo		DUMMY VALUES		DATATYPE	
    UserID			       1		     	Integer	(PRIMARY KEY)	
    UserName		       A			    Text		
    FacebookID		    10021556		    Text		
    EmailID			    ABC@gmail.com		Text		
    Facebook_EmailID	asdf@asfd.com		Text		
    Password		    welcome123		    Text		
    Chips		        	100	    		Integer		
    DeviceType		       iphone			Text	

  

     tbl_Game		    DUMMY VALUES		DATA TYPE	
     GameID			        1		    	Integer		
     Type			      H or M			Text		
     Complete		        No			    Text	

	
    		
    tbl_GamePlayer		DUMMY VALUES		DATA TYPE
    ID		             	1			Integer (PRIMARY KEY)
    GameID			        1			Integer (FOREIGN KEY FOR GameID in tbl_Game)
    Player1			        1			Integer	(FOREIGN KEY FOR UserID in tbl_UserInfo)	
    Player2			        2			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player3			        3			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player4			        4			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player5			        5			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    
    
    tbl_Streaks		     DUMMY VALUES		DATA TYPE
    ID			           1			Integer
    GameID			       1			Integer (FOREIGN KEY FOR GameID in tbl_Game)
    Player1			       1			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Player2			       2			Integer (FOREIGN KEY FOR UserID in tbl_UserInfo)
    Streaks			       2			Integer

i want reslut as


    {
    Player1 = ""A""
    Player2 = 'B""
    Streaks = 10 (between Player1  and Player2)
    Chips = 100 (for player1)
    Chips = 200 (for player2)
    Fbid= 124578 (for player1)
    Fbid = 784512 (for player2)
    }
    
    {
    Player1 = ""A""
    Player2 = 'C""
    Streaks = 15 (between Player1  and Player3)
    Chips = 100 (for player1)
    Chips = 450 (for player3)
    Fbid= 5654578 (for player1)
    Fbid = 7845512 (for player3)
    }
    
    {
    Player1 = ""A""
    Player2 = 'D""
    Streaks = 5(between Player1  and Player4)
    Chips = 100 (for player1)
    Chips = 208 (for player4)
    Fbid= 12898978 (for player1)
    Fbid = 78488512 (for player4)
    }

I want to display all the existing games of logged in user (with his other players's fbids, usernames, chips, streaks) with complete = 'No'

Note - userid is passed as parameter and all players are connected by their userid

",3
5920547,05/07/2011 10:44:14,742893,05/07/2011 09:56:14,1,0,Sql Server 2005,"What Is Pivot Statement ?
and How it is used?",sql,sql-server-2005,server,,,05/07/2011 13:08:41,not a real question,1,9,3,"Sql Server 2005 What Is Pivot Statement ?
and How it is used?",3
3172728,07/03/2010 20:05:31,256662,01/22/2010 11:24:04,718,24,"What are ""common"" (needed/useful to know) SQL Database-operations ?","I am looking for a good list (cheat-sheet?) of SQL tasks/commands for Database operations (although probably all of them are for that).

Stuff like:

 - JOIN - merge two tables
 - WHERE - subset tables 
 - And so on

But also a bit more elaborate tasks.

My motivation is that I want to know SQL a bit better, and I thought it would be fun to take a bunch of these tasks and see how to do them with SQL vs how to do them in a language I know (R).

And then maybe put these in a place like this: 

http://rosettacode.org/wiki/Category:Database_operations


(I wasn't able to find this when searching - but if this is a duplicate I'd be happy to close this thread)",sql,list,tutorials,cheat-sheet,,07/03/2010 20:58:45,not a real question,1,120,9,"What are ""common"" (needed/useful to know) SQL Database-operations ? I am looking for a good list (cheat-sheet?) of SQL tasks/commands for Database operations (although probably all of them are for that).

Stuff like:

 - JOIN - merge two tables
 - WHERE - subset tables 
 - And so on

But also a bit more elaborate tasks.

My motivation is that I want to know SQL a bit better, and I thought it would be fun to take a bunch of these tasks and see how to do them with SQL vs how to do them in a language I know (R).

And then maybe put these in a place like this: 

http://rosettacode.org/wiki/Category:Database_operations


(I wasn't able to find this when searching - but if this is a duplicate I'd be happy to close this thread)",4
9086238,01/31/2012 20:12:33,993963,10/13/2011 16:57:58,3,0,SQL2008R2 - AdventureWorksR2 - Fatal Error,"I get an error whilst installing Adventureworks.
Got SQL Server 2008 R2 and same AdventureWorks version.

I start the installation, it starts extract all scripts and so on. When I accept the License Terms and press next, I get an error.

Fatal error: Details
ISupportInitialize.EndInit. An exception occured in SMO while trying to manage a service. Row 78, position 3.

Have read about this problem quite a while, seem to be to retarded to understand...

Sorry to dirty the forum down with such a question. But I really need help :P",sql,fatal-error,adventureworks,,,01/31/2012 21:21:55,off topic,1,85,6,"SQL2008R2 - AdventureWorksR2 - Fatal Error I get an error whilst installing Adventureworks.
Got SQL Server 2008 R2 and same AdventureWorks version.

I start the installation, it starts extract all scripts and so on. When I accept the License Terms and press next, I get an error.

Fatal error: Details
ISupportInitialize.EndInit. An exception occured in SMO while trying to manage a service. Row 78, position 3.

Have read about this problem quite a while, seem to be to retarded to understand...

Sorry to dirty the forum down with such a question. But I really need help :P",3
1820650,11/30/2009 15:54:25,80111,03/19/2009 16:26:14,691,29,SQL script to create insert script,"A bit of a vague title, I will explain.

I am writing an SQL script to create an insert statement for each row of a table in my database, purely to be able to apply that data back to another database.

Here is what I have at the moment:

    SELECT 'INSERT INTO products (id,name,description) VALUES ('||ID||','''||name||''','''||description||''');' FROM products

And it works great, outputting this:

    INSERT INTO products (id,name,description) VALUES (1,'Lorem','Ipsum');
    INSERT INTO products (id,name,description) VALUES (2,'Lorem','Ipsum');
    INSERT INTO products (id,name,description) VALUES (3,'Lorem','Ipsum');
    INSERT INTO products (id,name,description) VALUES (4,'Lorem','Ipsum');

The problem is if one of the fields is empty that row will fail to produce an update script, in the output file the line is just blank. Obviously as there are 20+ fields, some optional this means that hardly any of my scripts are generated.

Is there a way to solve this issue?",sql,postgresql,,,,,open,0,152,6,"SQL script to create insert script A bit of a vague title, I will explain.

I am writing an SQL script to create an insert statement for each row of a table in my database, purely to be able to apply that data back to another database.

Here is what I have at the moment:

    SELECT 'INSERT INTO products (id,name,description) VALUES ('||ID||','''||name||''','''||description||''');' FROM products

And it works great, outputting this:

    INSERT INTO products (id,name,description) VALUES (1,'Lorem','Ipsum');
    INSERT INTO products (id,name,description) VALUES (2,'Lorem','Ipsum');
    INSERT INTO products (id,name,description) VALUES (3,'Lorem','Ipsum');
    INSERT INTO products (id,name,description) VALUES (4,'Lorem','Ipsum');

The problem is if one of the fields is empty that row will fail to produce an update script, in the output file the line is just blank. Obviously as there are 20+ fields, some optional this means that hardly any of my scripts are generated.

Is there a way to solve this issue?",2
7652351,10/04/2011 18:24:01,758045,05/17/2011 19:26:25,23,2,stored procedure times out while subsequent runs take 1/6 the time,"So I have this stored procedure which is running very slow (and timing out) in one particular production environment. This stored procedure produces an xml of profile data. In all other environments, the sp runs very fast. After tracing the procedure in the particular environment, I found that the final ""SELECT"" statement was taking up 96% of the total time (should be under 30%). This statement involves multiple SELECTS, UNIONS, and JOINS. I will refer to this as the ""Last Select"" statement.

On subsequent runs, the ""Last Select"" statement, and subsequently the whole batch, took much less time. What is especially curious is that subsequent runs used many more profiles (15,000 new in the second run, 25,000 new in the third run).

Comparing the query plans, I found some interesting differences between 10000.trc and 25000.trc. Both of the following were seen in steps before the ""Last Select""

 1. The faster run (25K) utilizes many operations involving parallelism. I do not see any operations involving parallelism in the slow run.
 2. The faster run uses “hash matches” and “merge joins” for inner and outer Joins (instead of nested loops). With a few exceptions, the slow run seems to always use nested loops.

The slow run uses many clustered index scans and clustered index seeks during the final select that the fast run does not. The slow run also uses a ""concatenation"" step (not found in the fast run) which appends multiple tables to make an output table.

Here is a summary of the times; ![sp times](http://i.imgur.com/y3dvm.png)

Any help is appreciated. Thank you!
",sql,query,query-optimization,,,06/23/2012 15:44:00,not a real question,1,256,11,"stored procedure times out while subsequent runs take 1/6 the time So I have this stored procedure which is running very slow (and timing out) in one particular production environment. This stored procedure produces an xml of profile data. In all other environments, the sp runs very fast. After tracing the procedure in the particular environment, I found that the final ""SELECT"" statement was taking up 96% of the total time (should be under 30%). This statement involves multiple SELECTS, UNIONS, and JOINS. I will refer to this as the ""Last Select"" statement.

On subsequent runs, the ""Last Select"" statement, and subsequently the whole batch, took much less time. What is especially curious is that subsequent runs used many more profiles (15,000 new in the second run, 25,000 new in the third run).

Comparing the query plans, I found some interesting differences between 10000.trc and 25000.trc. Both of the following were seen in steps before the ""Last Select""

 1. The faster run (25K) utilizes many operations involving parallelism. I do not see any operations involving parallelism in the slow run.
 2. The faster run uses “hash matches” and “merge joins” for inner and outer Joins (instead of nested loops). With a few exceptions, the slow run seems to always use nested loops.

The slow run uses many clustered index scans and clustered index seeks during the final select that the fast run does not. The slow run also uses a ""concatenation"" step (not found in the fast run) which appends multiple tables to make an output table.

Here is a summary of the times; ![sp times](http://i.imgur.com/y3dvm.png)

Any help is appreciated. Thank you!
",3
7423189,09/14/2011 21:26:58,876816,08/03/2011 14:34:41,20,0,SQL Server 2005 Monitoring - Open Source Tools,"Does anyone knows which good open source tools are available for monitoring SQL Server 2005

Regards",sql,sql-server,,,,09/15/2011 01:06:34,not constructive,1,15,8,"SQL Server 2005 Monitoring - Open Source Tools Does anyone knows which good open source tools are available for monitoring SQL Server 2005

Regards",2
4605823,01/05/2011 15:29:30,2191,08/20/2008 20:39:36,1588,32,Why does my sql date comparison return 0 results,"I apologize in advance if this question is too long but I wanted to make sure I included all the steps I followed to get to this point.

I have the follwing table in my MSSQL 2008 database:

    CREATE TABLE [VSPRRecalc](
        [VSPRDate] [datetimeoffset](7) NOT NULL,
 [CalcType] [int] NOT NULL,
    CONSTRAINT [PK_VSPRRecalc] PRIMARY KEY CLUSTERED 
    (
 [VSPRDate] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    ) ON [PRIMARY]

It has some rows in it that look like this:

    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-15 10:17:49.5780000 -05:00','3')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-16 07:44:03.3750000 -05:00','1')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-17 07:40:40.1090000 -05:00','1')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-18 16:29:02.2203744 -05:00','2')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-20 09:58:50.1250000 -05:00','1')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-29 19:21:26.8120000 -05:00','1')

I'm using linq to check and see if a given date already exists in this table:

    var recalc = (from re in VSPRRecalcs
                  where re.VSPRDate.Date == oDate.Value.Date
                  select re).SingleOrDefault();

Currently `recalc` returns null whenever the date is within 5 hours of midnight (like the 12-29 case in the insert statements above). I checked and the following sql is being executed:

    exec sp_executesql N'SELECT [t0].[VSPRDate], [t0].[CalcType]
                         FROM [dbo].[VSPRRecalc] AS [t0]
                         WHERE 
                         [VSPRDate] =''2010-12-29 19:21:26.8120000 -05:00'' and 
                         CONVERT(DATE, [t0].[VSPRDate]) = @p0',N'@p0 datetime',@p0='2010-12-29'

Which returns 0 records. I modified the query to make the test easier to play with and came up with the following:

    declare @t as date
    set @t =  '2010-12-29'

    select *, 
    case  when  CONVERT(DATE, [VSPRDate]) = @t then 'true' else 'false' end  
    from VSPRRecalc where 
    CONVERT(DATE, [VSPRDate]) = @t 

That query works for any other date in the table but not for any date that is within 5 hours of midnight (again see 12-29 above). If I run the above query without the where clause the 12-29 row does have 'true' displayed so clearly the boolean is evaluating the way I expect in the `select` statement but not in the `where` clause. Why does that happen?",sql,linq-to-sql,sql-server-2008,,,,open,0,518,9,"Why does my sql date comparison return 0 results I apologize in advance if this question is too long but I wanted to make sure I included all the steps I followed to get to this point.

I have the follwing table in my MSSQL 2008 database:

    CREATE TABLE [VSPRRecalc](
        [VSPRDate] [datetimeoffset](7) NOT NULL,
 [CalcType] [int] NOT NULL,
    CONSTRAINT [PK_VSPRRecalc] PRIMARY KEY CLUSTERED 
    (
 [VSPRDate] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    ) ON [PRIMARY]

It has some rows in it that look like this:

    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-15 10:17:49.5780000 -05:00','3')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-16 07:44:03.3750000 -05:00','1')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-17 07:40:40.1090000 -05:00','1')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-18 16:29:02.2203744 -05:00','2')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-20 09:58:50.1250000 -05:00','1')
    INSERT [vsprrecalc](VSPRDate,CalcType) VALUES('2010-12-29 19:21:26.8120000 -05:00','1')

I'm using linq to check and see if a given date already exists in this table:

    var recalc = (from re in VSPRRecalcs
                  where re.VSPRDate.Date == oDate.Value.Date
                  select re).SingleOrDefault();

Currently `recalc` returns null whenever the date is within 5 hours of midnight (like the 12-29 case in the insert statements above). I checked and the following sql is being executed:

    exec sp_executesql N'SELECT [t0].[VSPRDate], [t0].[CalcType]
                         FROM [dbo].[VSPRRecalc] AS [t0]
                         WHERE 
                         [VSPRDate] =''2010-12-29 19:21:26.8120000 -05:00'' and 
                         CONVERT(DATE, [t0].[VSPRDate]) = @p0',N'@p0 datetime',@p0='2010-12-29'

Which returns 0 records. I modified the query to make the test easier to play with and came up with the following:

    declare @t as date
    set @t =  '2010-12-29'

    select *, 
    case  when  CONVERT(DATE, [VSPRDate]) = @t then 'true' else 'false' end  
    from VSPRRecalc where 
    CONVERT(DATE, [VSPRDate]) = @t 

That query works for any other date in the table but not for any date that is within 5 hours of midnight (again see 12-29 above). If I run the above query without the where clause the 12-29 row does have 'true' displayed so clearly the boolean is evaluating the way I expect in the `select` statement but not in the `where` clause. Why does that happen?",3
9449130,02/25/2012 23:39:28,1062992,11/24/2011 00:23:50,1011,75,"Sql Server ""order by"" optimization - massive performance decrease","Using Sql Server 2000. I have a table that receives a dump from a legacy system once a day, I am trying to write a query that will process this table with a few reference table joins and an order by clause. The sql I have is as follows:

    select  acct_no,
            associate_id,
            first_name,
            last_name,
            acct_bal,
            plr.long_name p_lvl,
            tlr.long_name t_lvl,
            category,
            status,
            tm.site_name,
            addr1 + ' ' + isnull(addr2,'') address,
            city,
            state,
            country,
            post_code,
            CASE WHEN home_phone_ok = 1 THEN home_phone END home_phone,
            CASE WHEN work_phone_ok = 1 THEN work_phone END work_phone,
            CASE WHEN alt_phone_ok = 1 THEN alt_phone END alt_phone,
            CASE WHEN email_ok = 1 THEN email END email,
            last_credit last_paid,
            service,
            quantity,
            amount,
            ar.area_desc area
    from    item_dump
            left outer join territory_map tm on tm.short_postcode = left(post_code,3) and country in ('United States','Canada')
            left outer join p_level_ref plr on plr.p_level_id = p_lvl_id
            left outer join t_level_ref tlr on tlr.t_level_id = t_lvl_id
            left outer join (select distinct master_item_id, site_item_id from invoice_detail) as map on map.item_id = item_no
            left outer join item_ref i on i.item_id = map.master_item_id
            left outer join area_ref ar on ar.area_id = i.area_id
    where   (cat_id > 80 or cat_id < 70)
            and standing < 4
            and status not like 'DECEASED'
            and paid = 1
    order by associate_id

Most of these columns are straight from the legacy system dump table `item_dump`. All the joins are only reference tables with few rows. The legacy table itself has about 17000 records but with the where statements the query comes out to 3000. 

I have a non-clustered index on the `associate_id` column. 

When I run this query without the `order by associate_id` clause it takes about 2 seconds. With the `order by` clause it takes a full minute!

I've tried adding the `where` clause columns to the index along with `associate_id` but that didn't change the performance at all.

The end of the execution plan without the `order by` looks like this:

![enter image description here][1]

Using `order by`, parallelism kicks in on the order by argument and it looks like this:

![enter image description here][2]

I thought maybe it was [weird Sql Server 2000 parallelism handling][3], but adding the `(maxdop 1)` hint made the query take 3 minutes instead!

It isn't really sensible for me to put sorting in the application code because this query caches for about 6 hours before it gets run again and I would have to sort it in the application code many times a minute.

I must be missing something very basic but after straining at the query for an hour i.e. running it 10 times, I can't see what it is anymore.


  [1]: http://i.stack.imgur.com/uYtLj.png
  [2]: http://i.stack.imgur.com/NZjhp.png
  [3]: http://stackoverflow.com/questions/2477818/sql-server-2000-stored-procedure-prevent-parallelism-or-something",sql,sql-server,sql-server-2000,order-by,,,open,0,805,9,"Sql Server ""order by"" optimization - massive performance decrease Using Sql Server 2000. I have a table that receives a dump from a legacy system once a day, I am trying to write a query that will process this table with a few reference table joins and an order by clause. The sql I have is as follows:

    select  acct_no,
            associate_id,
            first_name,
            last_name,
            acct_bal,
            plr.long_name p_lvl,
            tlr.long_name t_lvl,
            category,
            status,
            tm.site_name,
            addr1 + ' ' + isnull(addr2,'') address,
            city,
            state,
            country,
            post_code,
            CASE WHEN home_phone_ok = 1 THEN home_phone END home_phone,
            CASE WHEN work_phone_ok = 1 THEN work_phone END work_phone,
            CASE WHEN alt_phone_ok = 1 THEN alt_phone END alt_phone,
            CASE WHEN email_ok = 1 THEN email END email,
            last_credit last_paid,
            service,
            quantity,
            amount,
            ar.area_desc area
    from    item_dump
            left outer join territory_map tm on tm.short_postcode = left(post_code,3) and country in ('United States','Canada')
            left outer join p_level_ref plr on plr.p_level_id = p_lvl_id
            left outer join t_level_ref tlr on tlr.t_level_id = t_lvl_id
            left outer join (select distinct master_item_id, site_item_id from invoice_detail) as map on map.item_id = item_no
            left outer join item_ref i on i.item_id = map.master_item_id
            left outer join area_ref ar on ar.area_id = i.area_id
    where   (cat_id > 80 or cat_id < 70)
            and standing < 4
            and status not like 'DECEASED'
            and paid = 1
    order by associate_id

Most of these columns are straight from the legacy system dump table `item_dump`. All the joins are only reference tables with few rows. The legacy table itself has about 17000 records but with the where statements the query comes out to 3000. 

I have a non-clustered index on the `associate_id` column. 

When I run this query without the `order by associate_id` clause it takes about 2 seconds. With the `order by` clause it takes a full minute!

I've tried adding the `where` clause columns to the index along with `associate_id` but that didn't change the performance at all.

The end of the execution plan without the `order by` looks like this:

![enter image description here][1]

Using `order by`, parallelism kicks in on the order by argument and it looks like this:

![enter image description here][2]

I thought maybe it was [weird Sql Server 2000 parallelism handling][3], but adding the `(maxdop 1)` hint made the query take 3 minutes instead!

It isn't really sensible for me to put sorting in the application code because this query caches for about 6 hours before it gets run again and I would have to sort it in the application code many times a minute.

I must be missing something very basic but after straining at the query for an hour i.e. running it 10 times, I can't see what it is anymore.


  [1]: http://i.stack.imgur.com/uYtLj.png
  [2]: http://i.stack.imgur.com/NZjhp.png
  [3]: http://stackoverflow.com/questions/2477818/sql-server-2000-stored-procedure-prevent-parallelism-or-something",4
1231331,08/05/2009 05:23:12,93091,04/20/2009 10:52:46,11,1,Tricky SQL SELECT Statement,"I have a performance issue when selecting data in my project.

There is a table with 3 columns: ""id"",""time"" and ""group""

* The ids are just unique ids as usual.
* The time is the creation date of the entry.
* The group is there to cummulate certain entries together.

So the table data may look like this:

ID | TIME      | GROUP

1  | 20090805  | A

2  | 20090804  | A

3  | 20090804  | B

4  | 20090805  | B

5  | 20090803  | A

6  | 20090802  | B

and so on.

**The task is now to select the ""current"" entries (their ids) in each group for a given date. That is, for each group find the most recent entry for a given date.**

Following preconditions apply:

* I do not know the different groups in advance - there may be many different ones changing over time
* The selection date may lie ""in between"" the dates of the entries in the table. Then I have to find the closest one in each group. That is, TIME is less than the selection date but the maximum of those to which this rule applies in a group.

What I currently do is a multi-step process which I would like to change into single SELECT statement:

1. `SELECT DISTINCT group FROM table` to find the available groups
2. For each group found in 1), `SELECT * FROM table WHERE time<selectionDate AND group=loop ORDER BY time DESC`
3. Take the first row of each result found in 2)

Obviously this is not optimal.

So I would be very happy if some more experienced SQL expert could help me to find a solution to put these steps in a single statement.

Thank you!",sql,performance,select,,,,open,0,286,4,"Tricky SQL SELECT Statement I have a performance issue when selecting data in my project.

There is a table with 3 columns: ""id"",""time"" and ""group""

* The ids are just unique ids as usual.
* The time is the creation date of the entry.
* The group is there to cummulate certain entries together.

So the table data may look like this:

ID | TIME      | GROUP

1  | 20090805  | A

2  | 20090804  | A

3  | 20090804  | B

4  | 20090805  | B

5  | 20090803  | A

6  | 20090802  | B

and so on.

**The task is now to select the ""current"" entries (their ids) in each group for a given date. That is, for each group find the most recent entry for a given date.**

Following preconditions apply:

* I do not know the different groups in advance - there may be many different ones changing over time
* The selection date may lie ""in between"" the dates of the entries in the table. Then I have to find the closest one in each group. That is, TIME is less than the selection date but the maximum of those to which this rule applies in a group.

What I currently do is a multi-step process which I would like to change into single SELECT statement:

1. `SELECT DISTINCT group FROM table` to find the available groups
2. For each group found in 1), `SELECT * FROM table WHERE time<selectionDate AND group=loop ORDER BY time DESC`
3. Take the first row of each result found in 2)

Obviously this is not optimal.

So I would be very happy if some more experienced SQL expert could help me to find a solution to put these steps in a single statement.

Thank you!",3
5267785,03/11/2011 00:48:06,654552,03/11/2011 00:48:06,1,0,AdventureWorks & AdventureWorks2005,"I have downloaded and installed Microsoft SQL server Management Studio Express SQLServer 2005. I could not find AdventureWorks databases in it. Do i suppose to download and install it as well? If so, could someone point me to the site where i can download AdventureWorks and its instruction? Once again, I am using Microsoft SQL server Management Studio Express 2005.

Many thanks,
Tom",sql,,,,,,open,0,61,3,"AdventureWorks & AdventureWorks2005 I have downloaded and installed Microsoft SQL server Management Studio Express SQLServer 2005. I could not find AdventureWorks databases in it. Do i suppose to download and install it as well? If so, could someone point me to the site where i can download AdventureWorks and its instruction? Once again, I am using Microsoft SQL server Management Studio Express 2005.

Many thanks,
Tom",1
4682821,01/13/2011 16:59:08,192801,10/20/2009 02:54:27,9084,480,"Oracle: Get a query to always return exactly one row, even when there's no data to be found","I have a query like this:

       select data_name
       into v_name
       from data_table
       where data_table.type = v_t_id

Normally, this query should return exactly one row. When there's no match on `v_t_id`, the program fails with a ""No data found"" exception.

I know I *could* handle this in PL/SQL, but I was wondering if there's a way to do this only in a query. As a test, I've tried:

    select case
               when subq.data_name is null then
                'UNKNOWN'
               else
                subq.data_name
           end
    from (select data_name
           from data_table
           where data_table.type = '53' /*53 does not exist, will result in 0 rows. Need fix this...*/
           ) subq;

...but this will obviously not work (because `subq` being empty is not the same as `subq.data_name is null`). Is this even possible or should I just check in my PL/SQL solution?

(oracle 10g)",sql,oracle,,,,,open,0,258,18,"Oracle: Get a query to always return exactly one row, even when there's no data to be found I have a query like this:

       select data_name
       into v_name
       from data_table
       where data_table.type = v_t_id

Normally, this query should return exactly one row. When there's no match on `v_t_id`, the program fails with a ""No data found"" exception.

I know I *could* handle this in PL/SQL, but I was wondering if there's a way to do this only in a query. As a test, I've tried:

    select case
               when subq.data_name is null then
                'UNKNOWN'
               else
                subq.data_name
           end
    from (select data_name
           from data_table
           where data_table.type = '53' /*53 does not exist, will result in 0 rows. Need fix this...*/
           ) subq;

...but this will obviously not work (because `subq` being empty is not the same as `subq.data_name is null`). Is this even possible or should I just check in my PL/SQL solution?

(oracle 10g)",2
4953968,02/10/2011 06:17:15,575353,01/14/2011 07:26:23,6,1,How to concatenate string in single quotation in SQL server 2005?,"

syntax error at BCHF_VOU_NUM +' '+ BCHF_VOU_DTE 

set @m_sql =  'Select distinct BCHF_VOU_NUM, BCHF_VOU_DTE, BCHF_E_AMT, NACD_DES, (BCHF_VOU_NUM +' '+ BCHF_VOU_DTE +' '+BCHF_E_AMT +' '+NACD_DES) as name, dbo.E_DOC_NUM_2_CHEQUE_NO(BCHF_E_DOC_NUM) FROM ' + @ParaCoCode + '..BCH' + @ParaBatchNo + ' abc inner join v_AnalysisCode on BCHF_E_ANA_CDE1 = ANACode inner join Project_TR_TP_COM_Test.dbo.FlexAccount zz ON zz.CurrentAccountID = (Select CurrentAccountID from Batch where'",sql,server,,,,,open,0,58,11,"How to concatenate string in single quotation in SQL server 2005? 

syntax error at BCHF_VOU_NUM +' '+ BCHF_VOU_DTE 

set @m_sql =  'Select distinct BCHF_VOU_NUM, BCHF_VOU_DTE, BCHF_E_AMT, NACD_DES, (BCHF_VOU_NUM +' '+ BCHF_VOU_DTE +' '+BCHF_E_AMT +' '+NACD_DES) as name, dbo.E_DOC_NUM_2_CHEQUE_NO(BCHF_E_DOC_NUM) FROM ' + @ParaCoCode + '..BCH' + @ParaBatchNo + ' abc inner join v_AnalysisCode on BCHF_E_ANA_CDE1 = ANACode inner join Project_TR_TP_COM_Test.dbo.FlexAccount zz ON zz.CurrentAccountID = (Select CurrentAccountID from Batch where'",2
11139705,06/21/2012 13:51:56,1472300,06/21/2012 13:47:16,1,0,SQL Convert function returns error 241,"I am having a column in my DB with varchar type having values in following format Day Mon dd hh:mm:ss EDT YYYY. I need to convert it to date time.

On running query select CONVERT(datetime, colname, 100) system returns Error code 241.

Help Please",sql,sql-server,,,,,open,0,42,6,"SQL Convert function returns error 241 I am having a column in my DB with varchar type having values in following format Day Mon dd hh:mm:ss EDT YYYY. I need to convert it to date time.

On running query select CONVERT(datetime, colname, 100) system returns Error code 241.

Help Please",2
9837220,03/23/2012 10:01:41,1211465,02/15/2012 13:46:07,41,0,DATEADD and BETWEEN not working,"I have the following code:

    DECLARE @testDate date
    --SET @testDate=dateadd(wk, 5830, 0)
    SET @testDate='2011-09-26 00:00:00.000'
    
    SELECT *
    FROM dbo.timesheets
    WHERE @testDate BETWEEN convert(datetime, start_dtm, 120) and convert(datetime, end_dtm, 120)
    
    PRINT @testDate

It should convert the value 5830 back to the date format and then check between `start_dtm` and `end_dtm`

I have tested this by hard coding the value from the database in the above code and i still dont see any records.  The printed `@testdate` shows up like this: `2011-09-26`

I am creating a `week_ref` which i am passing via querystring. The timesheets report will then convert the `week_ref` eg, '5830' to the date and check if its between the `start_dtm` and `end_dtm`. In theory it should display results as its checking if values are between start and end.

Any ideas? or help on debugging?",sql,sql-server,sql-server-2008,tsql,sql-server-2005,,open,0,161,5,"DATEADD and BETWEEN not working I have the following code:

    DECLARE @testDate date
    --SET @testDate=dateadd(wk, 5830, 0)
    SET @testDate='2011-09-26 00:00:00.000'
    
    SELECT *
    FROM dbo.timesheets
    WHERE @testDate BETWEEN convert(datetime, start_dtm, 120) and convert(datetime, end_dtm, 120)
    
    PRINT @testDate

It should convert the value 5830 back to the date format and then check between `start_dtm` and `end_dtm`

I have tested this by hard coding the value from the database in the above code and i still dont see any records.  The printed `@testdate` shows up like this: `2011-09-26`

I am creating a `week_ref` which i am passing via querystring. The timesheets report will then convert the `week_ref` eg, '5830' to the date and check if its between the `start_dtm` and `end_dtm`. In theory it should display results as its checking if values are between start and end.

Any ideas? or help on debugging?",5
11015753,06/13/2012 13:20:39,1394455,05/14/2012 18:47:10,223,14,Adding a Constant Row Result to SQL Query - MS Access,"Say I have a table ""tblItems"":
    
    *ID*    |     *Name*
    1       |   First Item
    2       |  Second Item

and I want this to be populated in a drop-down in a form. How would I add a row:

    ALL     |    SHOW ALL

to become

    *ID*    |     *Name*
    1       |   First Item
    2       |  Second Item
    ALL     |    SHOW ALL

with one query to place in the `Row Source` for the combo box? I haven't been able to find Access syntax to do this..",sql,ms-access,dummy-data,,,,open,0,164,11,"Adding a Constant Row Result to SQL Query - MS Access Say I have a table ""tblItems"":
    
    *ID*    |     *Name*
    1       |   First Item
    2       |  Second Item

and I want this to be populated in a drop-down in a form. How would I add a row:

    ALL     |    SHOW ALL

to become

    *ID*    |     *Name*
    1       |   First Item
    2       |  Second Item
    ALL     |    SHOW ALL

with one query to place in the `Row Source` for the combo box? I haven't been able to find Access syntax to do this..",3
3933898,10/14/2010 13:54:55,475841,10/14/2010 13:54:55,1,0,Help in getting a database management system running.,"http://projectabstracts.com/406/java-based-online-shopping.html

This project is about ""Online Shopping"". It uses Java as front-end implementing applets, servlets and JDBC as the connecting link to the back-end which is implemented using SQL. The problem is that I'm a newbie in all this stuff and I don't understand how to get this project running. Could someone please guide me as to how I can do it and what is required for it.
Thanks in advance.",sql,servlets,jdbc,dbms,,10/16/2010 03:41:12,not a real question,1,69,8,"Help in getting a database management system running. http://projectabstracts.com/406/java-based-online-shopping.html

This project is about ""Online Shopping"". It uses Java as front-end implementing applets, servlets and JDBC as the connecting link to the back-end which is implemented using SQL. The problem is that I'm a newbie in all this stuff and I don't understand how to get this project running. Could someone please guide me as to how I can do it and what is required for it.
Thanks in advance.",4
6157047,05/27/2011 19:52:08,773669,05/27/2011 19:52:08,1,0,oracle sql count multiple columns,"Problem: I want to count the number of columns that have a certain value in sql.
Example: 
       A   B  C D  E
       1   2  1  2 2

How can I count that there are 3 columns have the value 2. 

thanks!

",sql,oracle,,,,,open,0,60,5,"oracle sql count multiple columns Problem: I want to count the number of columns that have a certain value in sql.
Example: 
       A   B  C D  E
       1   2  1  2 2

How can I count that there are 3 columns have the value 2. 

thanks!

",2
6063638,05/19/2011 19:03:53,264425,02/02/2010 14:49:22,340,1,Cast Varchar at smallmoney,"I have about 100 columns in my table, 50 of which need to be changed to (smallmoney, null) format. Currently they are all (varchar(3), null).

How do I do that with the columns I want? Is there a quick way? Let's pretend I have 5 columns:

    col1 (varchar(3), null)
    col2 (varchar(3), null)
    col3 (varchar(3), null)
    col4 (varchar(3), null)
    col5 (varchar(3), null)

how do I make them look like this:

    col1 (smallmoney, null)
    col2 (smallmoney, null)
    col3 (smallmoney, null)
    col4 (varchar(3), null)
    col5 (varchar(3), null)",sql,casting,types,,,,open,0,112,4,"Cast Varchar at smallmoney I have about 100 columns in my table, 50 of which need to be changed to (smallmoney, null) format. Currently they are all (varchar(3), null).

How do I do that with the columns I want? Is there a quick way? Let's pretend I have 5 columns:

    col1 (varchar(3), null)
    col2 (varchar(3), null)
    col3 (varchar(3), null)
    col4 (varchar(3), null)
    col5 (varchar(3), null)

how do I make them look like this:

    col1 (smallmoney, null)
    col2 (smallmoney, null)
    col3 (smallmoney, null)
    col4 (varchar(3), null)
    col5 (varchar(3), null)",3
482473,01/27/2009 06:26:49,38877,11/19/2008 10:00:31,33,2,SQL latest record per foreign_key,"I've got the following 2 tables:

 * ingredients (id, name)
 * ingredient\_prices (id, ingredient\_id, price, created_at)

such that one ingredient can have many prices.
What will be the best way to get the latest entered price per ingredient? I know it can be done easily with sub-selects, but I want to know if there is a more efficient way for doing it.",sql,foreign-keys,performance,,,,open,0,60,5,"SQL latest record per foreign_key I've got the following 2 tables:

 * ingredients (id, name)
 * ingredient\_prices (id, ingredient\_id, price, created_at)

such that one ingredient can have many prices.
What will be the best way to get the latest entered price per ingredient? I know it can be done easily with sub-selects, but I want to know if there is a more efficient way for doing it.",3
5229831,03/08/2011 07:59:18,95107,04/23/2009 18:27:20,1883,106,Updating a table (with audit trigger using Service Broker) in a Transaction,"We have implemented Auditing capability using service broker and have implemented triggers on the tables that need to be audited. The issue we are facing is when we try to update an auditable table from within a transaction, it throws up an error - 

> The current transaction cannot be
> committed and cannot support
> operations that write to the log file.
> Roll back the transaction.

However, if we remove the trigger from the auditable table, it all works absolutely fine. is it not possible to have a table (with trigger) be updated within a transaction or are we missing something at our end ?",sql,sql-server-2008,transactions,triggers,audit-tables,,open,0,103,12,"Updating a table (with audit trigger using Service Broker) in a Transaction We have implemented Auditing capability using service broker and have implemented triggers on the tables that need to be audited. The issue we are facing is when we try to update an auditable table from within a transaction, it throws up an error - 

> The current transaction cannot be
> committed and cannot support
> operations that write to the log file.
> Roll back the transaction.

However, if we remove the trigger from the auditable table, it all works absolutely fine. is it not possible to have a table (with trigger) be updated within a transaction or are we missing something at our end ?",5
7930838,10/28/2011 14:47:05,1018518,10/28/2011 14:27:37,1,0,"Sql Server database filled the hard drive and freeing up space isn't possible, need help","I have a database in SQL Server 2008 on a 1Tb hard drive and it filled the drive, there is only 4Kb free.  The MDF file is 323Gb and the LDF is 653Gb.  The hard disk this DB is on has no other files on it other than the MDF and LDF so it's impossible to free up any space on the drive.  The main hard disk is smaller so nothing can be moved to it.  This server is overseas at a customer site and it's not possible at the moment to add more disk space to the server.  It's also not possible to delete any records because the DB is in a failed mode and it doesn't respond to most commands.  The Db is currently in full recovery mode which is why the LDF file is so large.  This DB really doesn't need to be in full recovery so going forward we plan on switching it to simple mode which will save us a lot of space.  I also don't care about losing the LDF file, but I need all of the data.  I've spent a lot of time looking for a way out of this problem but everything I've found first involves either freeing up disk space or adding more disk space, neither of which is an option at this time.  I'm stuck and any help would be greatly appreciated.

I get the following log when trying to switch the DB to online mode.

Msg 2, Level 20, State 0, Line 0
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)

Thanks.",sql,server,offline,space,disk,10/28/2011 15:55:11,off topic,1,315,15,"Sql Server database filled the hard drive and freeing up space isn't possible, need help I have a database in SQL Server 2008 on a 1Tb hard drive and it filled the drive, there is only 4Kb free.  The MDF file is 323Gb and the LDF is 653Gb.  The hard disk this DB is on has no other files on it other than the MDF and LDF so it's impossible to free up any space on the drive.  The main hard disk is smaller so nothing can be moved to it.  This server is overseas at a customer site and it's not possible at the moment to add more disk space to the server.  It's also not possible to delete any records because the DB is in a failed mode and it doesn't respond to most commands.  The Db is currently in full recovery mode which is why the LDF file is so large.  This DB really doesn't need to be in full recovery so going forward we plan on switching it to simple mode which will save us a lot of space.  I also don't care about losing the LDF file, but I need all of the data.  I've spent a lot of time looking for a way out of this problem but everything I've found first involves either freeing up disk space or adding more disk space, neither of which is an option at this time.  I'm stuck and any help would be greatly appreciated.

I get the following log when trying to switch the DB to online mode.

Msg 2, Level 20, State 0, Line 0
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server)

Thanks.",5
6896834,08/01/2011 10:01:40,872574,08/01/2011 10:01:40,1,0,"Is possible to restrict the DB2 database operators must using ""WHERE"" clause in ""DELETE"" statements?","There is a Database in my project. More than 20 guys have the access to operate the data in some of the tables. However, some of them always forget to use ""WHERE"" clause after ""DELETE"" or ""UPDATE"". Is possible to restrict the DB2 database operators must using ""WHERE"" clause in ""DELETE"" and ""UPDATE"" statements? Otherwise is there any program for us to check the SQL files?",sql,db2,,,,10/19/2011 19:12:35,not a real question,1,66,15,"Is possible to restrict the DB2 database operators must using ""WHERE"" clause in ""DELETE"" statements? There is a Database in my project. More than 20 guys have the access to operate the data in some of the tables. However, some of them always forget to use ""WHERE"" clause after ""DELETE"" or ""UPDATE"". Is possible to restrict the DB2 database operators must using ""WHERE"" clause in ""DELETE"" and ""UPDATE"" statements? Otherwise is there any program for us to check the SQL files?",2
7290005,09/02/2011 22:59:39,289246,03/08/2010 23:30:38,1626,59,naming question - non programic question,"I really don't know what tags I should give to this question.. This is not programic question - but I need some suggestions from english speakers.

I have two tables in my db: Customers and Subcontractors.   
Now it appears that some customers can be also subcontractors.   
What I decided to do is to create a base table (super type) that holds the common data and then complete the relevant info for each type (customer, subcontractor) in other table. It will be somwthing like this:

    NEW_TABLE<------Customers
             <------Subcontractors

The problem is that I don't really know how to call this table.. does the name ""Partner"" is the best option?   

I really appriciate if someone will help me tag this question properly.",sql,,,,,09/03/2011 11:50:44,not constructive,1,138,6,"naming question - non programic question I really don't know what tags I should give to this question.. This is not programic question - but I need some suggestions from english speakers.

I have two tables in my db: Customers and Subcontractors.   
Now it appears that some customers can be also subcontractors.   
What I decided to do is to create a base table (super type) that holds the common data and then complete the relevant info for each type (customer, subcontractor) in other table. It will be somwthing like this:

    NEW_TABLE<------Customers
             <------Subcontractors

The problem is that I don't really know how to call this table.. does the name ""Partner"" is the best option?   

I really appriciate if someone will help me tag this question properly.",1
11313252,07/03/2012 14:35:57,1498588,07/03/2012 11:14:43,1,0,Access front-end and oracle back-end,"This is my first question here. It is a long question, I will try to be brief. I tried find on internet,but didn't got anything. I even asked question in telecom form, but I didn't a single reply. I hope I will get help here.

REQUEST:

I am working for a telecommunication company. I am newbie. Presently I have to write an application in access 2007, which has Oracle 11g as a back-end. This function of this application is to generate an excel file as an output. when I enter a site name in text box in the access form and click search button, it should generate a excel file (text file or csv is also okay) which should have specific fields in a specific order for that particular site. These fields(columns) are present in different tables in Oracle database like transmitter, sites, neighbors etc. And some fields have fixed values depending on selection of option in combo\list box in the forms. Combo box includes City, Rural, Indoors etc options. 

Can you please tell me, how to do it in Access or VBA


WHAT I HAVE DONE:

I connected Access to Oracle using ODBC and linked specific tables, which include the columns I need. Then using query design view in Access. I defined the relation of linked tables(which I knew from the database schema) and selected specific fields and in one field named Site_name, on criteria option, I typed ""[site name]"". Actually here, I need a filter expression which will filter the sites on the input of text box in the form. I don't know what expression to write, So I wrote site name here. so  that latter it will ask for parameter of site name, and save it as query1 

Then I created a macro and I typed in action column: outputto function, in arguments object type: query, object name as query1(name of the query) and output file: excel and saved as macro1. Then I created a button on the form and in design view, in property sheet> event tab> on click option: I selected macro1.

Now when I click this button on form (in form view). It asks for parameters of site name. I give it site name, And it generates a excel file which site name and other fields but without fixed values, because I didn't included them.(whole thing I will explain below in second issue)

ISSUES

First issue, I need to create a text box in form. and I should type site_name there and then click on button, it will prompt me saving a file only (not asking again for parameter). I don't what know,what filter expression to use and how to connect button, text box, query. Please help how I will get output file based on input in text box. 

Second issue, I haven't talked about fixed value in some fields in output file which is based on options of list box\combo box in the form. I made a table named Terrain having field name as topography and its columns as city, rural, indoors etc. then I filled the other field names with specific field name as in output excel file and gave their columns respective values as in options. My idea was to add specific fields of Terrain table along with other three linked tables from Oracle database in query design view. So that output file also includes fixed fields with respective values triggered by options in list box based on filter expression in criteria option of topography field. For it I have to define relation of other three related tables with Terrain table. I don't know how to do, because all the fields are different in Terrain table from other tables. When I don't give any relation, and to check, I change to datasheet view. It gives the error message ""SQL query cannot be executed because it contains ambiguous outer joins. To force one of the joins to be performed first, create a separate query that performs the first join and then include that query in the SQL statement."" It gives some information, but I don't know how to use it practically. Please explain how can I include those fields in output file. Or do I need to do it in VBA, (I am learning VBA)

Third issue: In Oracle table, there is a field ""frequency channels"" It contains max 32 separate values delimited by space. But in output file(text, csv or excel),these need to be in separate fields as c0, c1,c3, ... c31. 

If the channel field of a specific site has lesser channels. it e.g. 20. then the output file should have 20 cells or fields only.

If there are two sectors in a site. Then site_name will return two records as Site name A, site name B. If site name A has lesser channels than Site name B, then other blank cells of Site name A should return NULL.Please explain me how to do it. I think it is a split function in VBA. But how to use it practically, I don't know



CONCLUSION:

Can you please help me how to write this application in Access or VBA. And if it is possible in Access or do I need to use VBA and recordsets. which I am currently learning.


If you like I can send you the required output excel file and the design schema of Oracle database. I know, writing this software is not very difficult, but I have to learn the VBA and write it an application of it simultaneously. Also I have to complete the project in a time limit and there are tasks to complete.





",sql,database,vba,,,07/03/2012 14:47:37,too localized,1,928,5,"Access front-end and oracle back-end This is my first question here. It is a long question, I will try to be brief. I tried find on internet,but didn't got anything. I even asked question in telecom form, but I didn't a single reply. I hope I will get help here.

REQUEST:

I am working for a telecommunication company. I am newbie. Presently I have to write an application in access 2007, which has Oracle 11g as a back-end. This function of this application is to generate an excel file as an output. when I enter a site name in text box in the access form and click search button, it should generate a excel file (text file or csv is also okay) which should have specific fields in a specific order for that particular site. These fields(columns) are present in different tables in Oracle database like transmitter, sites, neighbors etc. And some fields have fixed values depending on selection of option in combo\list box in the forms. Combo box includes City, Rural, Indoors etc options. 

Can you please tell me, how to do it in Access or VBA


WHAT I HAVE DONE:

I connected Access to Oracle using ODBC and linked specific tables, which include the columns I need. Then using query design view in Access. I defined the relation of linked tables(which I knew from the database schema) and selected specific fields and in one field named Site_name, on criteria option, I typed ""[site name]"". Actually here, I need a filter expression which will filter the sites on the input of text box in the form. I don't know what expression to write, So I wrote site name here. so  that latter it will ask for parameter of site name, and save it as query1 

Then I created a macro and I typed in action column: outputto function, in arguments object type: query, object name as query1(name of the query) and output file: excel and saved as macro1. Then I created a button on the form and in design view, in property sheet> event tab> on click option: I selected macro1.

Now when I click this button on form (in form view). It asks for parameters of site name. I give it site name, And it generates a excel file which site name and other fields but without fixed values, because I didn't included them.(whole thing I will explain below in second issue)

ISSUES

First issue, I need to create a text box in form. and I should type site_name there and then click on button, it will prompt me saving a file only (not asking again for parameter). I don't what know,what filter expression to use and how to connect button, text box, query. Please help how I will get output file based on input in text box. 

Second issue, I haven't talked about fixed value in some fields in output file which is based on options of list box\combo box in the form. I made a table named Terrain having field name as topography and its columns as city, rural, indoors etc. then I filled the other field names with specific field name as in output excel file and gave their columns respective values as in options. My idea was to add specific fields of Terrain table along with other three linked tables from Oracle database in query design view. So that output file also includes fixed fields with respective values triggered by options in list box based on filter expression in criteria option of topography field. For it I have to define relation of other three related tables with Terrain table. I don't know how to do, because all the fields are different in Terrain table from other tables. When I don't give any relation, and to check, I change to datasheet view. It gives the error message ""SQL query cannot be executed because it contains ambiguous outer joins. To force one of the joins to be performed first, create a separate query that performs the first join and then include that query in the SQL statement."" It gives some information, but I don't know how to use it practically. Please explain how can I include those fields in output file. Or do I need to do it in VBA, (I am learning VBA)

Third issue: In Oracle table, there is a field ""frequency channels"" It contains max 32 separate values delimited by space. But in output file(text, csv or excel),these need to be in separate fields as c0, c1,c3, ... c31. 

If the channel field of a specific site has lesser channels. it e.g. 20. then the output file should have 20 cells or fields only.

If there are two sectors in a site. Then site_name will return two records as Site name A, site name B. If site name A has lesser channels than Site name B, then other blank cells of Site name A should return NULL.Please explain me how to do it. I think it is a split function in VBA. But how to use it practically, I don't know



CONCLUSION:

Can you please help me how to write this application in Access or VBA. And if it is possible in Access or do I need to use VBA and recordsets. which I am currently learning.


If you like I can send you the required output excel file and the design schema of Oracle database. I know, writing this software is not very difficult, but I have to learn the VBA and write it an application of it simultaneously. Also I have to complete the project in a time limit and there are tasks to complete.





",3
4929240,02/08/2011 03:18:56,481885,10/20/2010 15:02:23,5,1,How to I setup a database that tracks prices for 100k+ products over time?,"I would like to setup a server that stores prices data for potentially 100,000+ products over time. Updates will be provided once or twice per month.

I would also have many components of such prices. Such that I run out of the 255 fields that Access allows me, and would burst the 2 Gig limit sooner or later. (New fields might just pop up at any moment for some products)

The scale of this project is somehow too small to get database experts to do a full scale database at the moment. Is there any quick fix I can do with the free Microsoft SQL Server ?

Or I am going to run into hardware limitations also? 
",sql,database,pricing,products,ticker,02/08/2011 05:34:21,not a real question,1,115,14,"How to I setup a database that tracks prices for 100k+ products over time? I would like to setup a server that stores prices data for potentially 100,000+ products over time. Updates will be provided once or twice per month.

I would also have many components of such prices. Such that I run out of the 255 fields that Access allows me, and would burst the 2 Gig limit sooner or later. (New fields might just pop up at any moment for some products)

The scale of this project is somehow too small to get database experts to do a full scale database at the moment. Is there any quick fix I can do with the free Microsoft SQL Server ?

Or I am going to run into hardware limitations also? 
",5
3926851,10/13/2010 18:36:18,442477,09/08/2010 13:34:49,40,2,Ms sql keys and foreign keys,"If I have a primary key in table A and in table B of the same database(table B has its own primary key) I create  a relationship with the primary key in table A so that a column in table B is the foreign key, does it mean that the primary key  data created in the primary key column of table A will also be added to table B by virtue of it being a foreign key column or do I have to code that relationship, and if so how do I go about that? ",sql,foreign-keys,primary-key,ms,,,open,0,98,6,"Ms sql keys and foreign keys If I have a primary key in table A and in table B of the same database(table B has its own primary key) I create  a relationship with the primary key in table A so that a column in table B is the foreign key, does it mean that the primary key  data created in the primary key column of table A will also be added to table B by virtue of it being a foreign key column or do I have to code that relationship, and if so how do I go about that? ",4
11347689,07/05/2012 15:32:07,1139208,01/09/2012 17:18:34,26,0,hiding unnecessary fields in Access Report,"At my workplace there is a ""Daily Feedback"" database where details are entered of any errors made by Customer Service Officers (CSOs), such as who made the mistake, when, and what service it was for. this is so we can gather data which would show areas where CSO's are repeatedly making mistakes so we can feed this back to them and train them in those areas if need be.  
i currently have a report where an CSOs name is entered along with a date range and it produces the report showing the number of errors made for each service for that date range.  
the code used is -  
       =Sum(IIf([Service]=""Housing"",1,0))  
    =Sum(IIf([Service]=""Environmental Health"",1,0))    
  etc etc for each Service.  
The problem i have is that not every CSO does EVERY service and so there are usually a few results showing as ""0"". and i cannot be sure if thats because they dont do the service or if they are just very good at that service.  
Being absolutely useless at SQL (or any other possible way of fixing this) i cannot figure out how to HIDE the entries that produce the zero value.  
any help here would be greatly appreciated!
 ",sql,ms-access,report,ms-query,,,open,0,220,6,"hiding unnecessary fields in Access Report At my workplace there is a ""Daily Feedback"" database where details are entered of any errors made by Customer Service Officers (CSOs), such as who made the mistake, when, and what service it was for. this is so we can gather data which would show areas where CSO's are repeatedly making mistakes so we can feed this back to them and train them in those areas if need be.  
i currently have a report where an CSOs name is entered along with a date range and it produces the report showing the number of errors made for each service for that date range.  
the code used is -  
       =Sum(IIf([Service]=""Housing"",1,0))  
    =Sum(IIf([Service]=""Environmental Health"",1,0))    
  etc etc for each Service.  
The problem i have is that not every CSO does EVERY service and so there are usually a few results showing as ""0"". and i cannot be sure if thats because they dont do the service or if they are just very good at that service.  
Being absolutely useless at SQL (or any other possible way of fixing this) i cannot figure out how to HIDE the entries that produce the zero value.  
any help here would be greatly appreciated!
 ",4
9021508,01/26/2012 16:29:42,1069118,11/28/2011 10:15:10,46,0,Grabbing long text from SQL Database with coldfusion,"I have an sql database with a ntext field which holds page content.

I am using Cold Fusion to query the information and deliver it to a form.

The form utilises ckeditor for this particular field, the field at present contains around 4000 characters. When looking in the ckeditor window it appears some of the text is missing. 

However when i look at the database data the text is not missing and is their.

I thought this might be a character limitation with ckeditor, so I turned it off and viewed the data through a textarea box but the text is still missing.

The query is a simple select query held within a component, nothing special. See below;

Why this isn't pulling all the data down I just do not know?

    <cfquery name=""getDrilledContent"" datasource=""#application.dsn#"">
    		SELECT co.uid_content, co.txt_contentgroup, co.txt_contentRefID, co.uid_contentuser, co.txt_contentvalue, co.dte_contentdate, co.txt_contentpagename,
            co.txt_metatitle, co.txt_metadescrip, co.txt_metakeywords, co.txt_metaurl, co.bit_primary, co.txt_h1, co.txt_contenturl, co.txt_contentlink,
            us.txt_du_firstname, us.txt_du_surname, txt_du_email, dte_edited, uid_changedby
            FROM tbl_content co 
            INNER JOIN tbl_datausers us ON co.uid_contentuser=us.uid_datauser
            WHERE uid_contentwebid = <cfqueryparam cfsqltype=""cf_sql_integer"" value=""#session.webid#"">
            <cfif Isdefined('arguments.uid_content') AND arguments.uid_content NEQ """">
            AND co.uid_content=<cfqueryparam cfsqltype=""cf_sql_integer"" value=""#arguments.uid_content#""></cfif>
    </cfquery>",sql,coldfusion,,,,,open,0,263,8,"Grabbing long text from SQL Database with coldfusion I have an sql database with a ntext field which holds page content.

I am using Cold Fusion to query the information and deliver it to a form.

The form utilises ckeditor for this particular field, the field at present contains around 4000 characters. When looking in the ckeditor window it appears some of the text is missing. 

However when i look at the database data the text is not missing and is their.

I thought this might be a character limitation with ckeditor, so I turned it off and viewed the data through a textarea box but the text is still missing.

The query is a simple select query held within a component, nothing special. See below;

Why this isn't pulling all the data down I just do not know?

    <cfquery name=""getDrilledContent"" datasource=""#application.dsn#"">
    		SELECT co.uid_content, co.txt_contentgroup, co.txt_contentRefID, co.uid_contentuser, co.txt_contentvalue, co.dte_contentdate, co.txt_contentpagename,
            co.txt_metatitle, co.txt_metadescrip, co.txt_metakeywords, co.txt_metaurl, co.bit_primary, co.txt_h1, co.txt_contenturl, co.txt_contentlink,
            us.txt_du_firstname, us.txt_du_surname, txt_du_email, dte_edited, uid_changedby
            FROM tbl_content co 
            INNER JOIN tbl_datausers us ON co.uid_contentuser=us.uid_datauser
            WHERE uid_contentwebid = <cfqueryparam cfsqltype=""cf_sql_integer"" value=""#session.webid#"">
            <cfif Isdefined('arguments.uid_content') AND arguments.uid_content NEQ """">
            AND co.uid_content=<cfqueryparam cfsqltype=""cf_sql_integer"" value=""#arguments.uid_content#""></cfif>
    </cfquery>",2
4614771,01/06/2011 12:12:58,155758,08/13/2009 12:16:30,262,2,"MS SQL 2008, how much space does this occupy?","I am trying to calculate how much space (mb) this would occupy. In the database table there is 7 bit columns, 2 tiny int and 1 guid.

Trying to calculate the amount that 16 000 rows would occupies.
My line of thought was that 7 bit columns consume 1 byte, 2 tiny ints consumes 2 bytes and a guid consumes 16 bytes. Total of 19byte for one row in the table? That would mean 304000 bytes for 16 000 rows or ~0.3mbs us that correct? Is there a meta data byte as well?",sql,database,sql-server-2008,table,ms,,open,0,91,9,"MS SQL 2008, how much space does this occupy? I am trying to calculate how much space (mb) this would occupy. In the database table there is 7 bit columns, 2 tiny int and 1 guid.

Trying to calculate the amount that 16 000 rows would occupies.
My line of thought was that 7 bit columns consume 1 byte, 2 tiny ints consumes 2 bytes and a guid consumes 16 bytes. Total of 19byte for one row in the table? That would mean 304000 bytes for 16 000 rows or ~0.3mbs us that correct? Is there a meta data byte as well?",5
11479800,07/14/2012 00:00:12,1253667,03/07/2012 02:26:45,33,1,Double-Entry Accural Accounting Concept,"I have an accounting question regarding property management.

Step 1:
Residential Owner: Peter

I charge Peter $200 for month management fee. So:

    Type      Name     Debit Account        Credit Account      Amount
    ------    -----    ------------------   --------------      ------    
    Charge    Peter    Management Income    Acc Receivable      200.00      

Step 2: 

I charge Peter $50 for Gas Utilities. So:


    Type      Name     Debit Account        Credit Account      Amount
    ------    -----    ------------------   --------------      ------   
    Charge    Peter    Utilities Income     Acc Receivable      50.00      


Here my balance for Acc Receivable = 250 and Management Income = 200 And Utilities Income = 50.

Now, Peter is going to pay me $200 for the management fee... so

Step 3:


    Type      Name     Debit Account        Credit Account      Amount 
    ------    -----    ------------------   --------------      ------ 
    Payment   Peter    Acc Receivable       Management Income   200    

Here my balance for Acc Receivable = 50, Management Income = 0 and Utilities Income = 50

I have seen that the payment automaticaly generates another record in the Undeposited Funds because is money I received but that has not been deposited in the bank yet.

My question is what is the Debit Account and Credit Account for that transaction or how can I handle it.

    Type      Name     Debit Account        Credit Account      Debit     
    ------    -----    ------------------   --------------      ------    
    Payment   Peter    Undeposited Funds        **???**         200.00      

Because when I deposit that amount I know that the next record should look like this:

    Type      Name     Debit Account        Credit Account      Debit     
    ------    -----    ------------------   --------------      ------    
    Deposit   ME       Bank Account         Undeposited Funds   200.00   


Any clue on how to deal with this??  When the Undeposited Funds record is created what is the credit account??

Thanks",sql,accounting,,,,07/15/2012 16:19:39,off topic,1,597,4,"Double-Entry Accural Accounting Concept I have an accounting question regarding property management.

Step 1:
Residential Owner: Peter

I charge Peter $200 for month management fee. So:

    Type      Name     Debit Account        Credit Account      Amount
    ------    -----    ------------------   --------------      ------    
    Charge    Peter    Management Income    Acc Receivable      200.00      

Step 2: 

I charge Peter $50 for Gas Utilities. So:


    Type      Name     Debit Account        Credit Account      Amount
    ------    -----    ------------------   --------------      ------   
    Charge    Peter    Utilities Income     Acc Receivable      50.00      


Here my balance for Acc Receivable = 250 and Management Income = 200 And Utilities Income = 50.

Now, Peter is going to pay me $200 for the management fee... so

Step 3:


    Type      Name     Debit Account        Credit Account      Amount 
    ------    -----    ------------------   --------------      ------ 
    Payment   Peter    Acc Receivable       Management Income   200    

Here my balance for Acc Receivable = 50, Management Income = 0 and Utilities Income = 50

I have seen that the payment automaticaly generates another record in the Undeposited Funds because is money I received but that has not been deposited in the bank yet.

My question is what is the Debit Account and Credit Account for that transaction or how can I handle it.

    Type      Name     Debit Account        Credit Account      Debit     
    ------    -----    ------------------   --------------      ------    
    Payment   Peter    Undeposited Funds        **???**         200.00      

Because when I deposit that amount I know that the next record should look like this:

    Type      Name     Debit Account        Credit Account      Debit     
    ------    -----    ------------------   --------------      ------    
    Deposit   ME       Bank Account         Undeposited Funds   200.00   


Any clue on how to deal with this??  When the Undeposited Funds record is created what is the credit account??

Thanks",2
6195044,06/01/2011 00:33:17,774880,05/29/2011 05:24:39,13,0,Triggers in MS SQL 2008,"I Have create  trigger's for Insert and Update seperatly. The trigger is going to insert row in Schema2 when an insert is made in Schema one.


TEMP1 table in one Schema

TEMP2 table in another Schema


The trigger creation is successfulll..
 
But when i am inserting data in Temp1 , it is giving me error for TEMP2 duplicate key.

TEMP2 is having constrains for other two table.

Please suggest me...
",sql,triggers,ms,,,,open,0,66,5,"Triggers in MS SQL 2008 I Have create  trigger's for Insert and Update seperatly. The trigger is going to insert row in Schema2 when an insert is made in Schema one.


TEMP1 table in one Schema

TEMP2 table in another Schema


The trigger creation is successfulll..
 
But when i am inserting data in Temp1 , it is giving me error for TEMP2 duplicate key.

TEMP2 is having constrains for other two table.

Please suggest me...
",3
6660367,07/12/2011 06:37:26,244330,01/05/2010 22:57:28,267,5,writing SQL queries to get neighbour rows,"I have come across some problems writing queries for getting neighbour rows and have no idea what to do about it.

This is the scenario:

There is an entity A which has 1000 entity B, each entity B has 1000 entity C, each entity C has 1000 entity D. At first we have a query to get all entity Ds inside entity A. Then we implement some logic so that we can navigate from a particular D to the next D or previous D, but this logic is not written as SQL queries.

If I want to implement the navigation logic as SQL queries, how can I go to the next D in my select query? Suppose the original query is as simple as 

    select * from D 
      inner join C where C.ID = D.FK
      inner join B where B.ID = C.FK

",sql,,,,,,open,0,154,7,"writing SQL queries to get neighbour rows I have come across some problems writing queries for getting neighbour rows and have no idea what to do about it.

This is the scenario:

There is an entity A which has 1000 entity B, each entity B has 1000 entity C, each entity C has 1000 entity D. At first we have a query to get all entity Ds inside entity A. Then we implement some logic so that we can navigate from a particular D to the next D or previous D, but this logic is not written as SQL queries.

If I want to implement the navigation logic as SQL queries, how can I go to the next D in my select query? Suppose the original query is as simple as 

    select * from D 
      inner join C where C.ID = D.FK
      inner join B where B.ID = C.FK

",1
6590891,07/06/2011 02:17:45,156611,08/14/2009 16:32:33,233,5,SQL: Computed column based on nullable columns,"I want to create a computed column that is the concatenation of several other columns.  In the below example, fulladdress is null in the result set when any of the 'real' columns is null.  How can I adjust the computed column function to take into account the nullable columns?

    CREATE TABLE Locations
    (
        [id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY,
        [fulladdress]  AS (((([address]+[address2])+[city])+[state])+[zip]),
        [address] [varchar](50) NULL,
        [address2] [varchar](50) NULL,
        [city] [varchar](50) NULL,
        [state] [varchar](50) NULL,
        [zip] [varchar](50) NULL
    )

Thanks in advance",sql,computed-columns,,,,,open,0,142,7,"SQL: Computed column based on nullable columns I want to create a computed column that is the concatenation of several other columns.  In the below example, fulladdress is null in the result set when any of the 'real' columns is null.  How can I adjust the computed column function to take into account the nullable columns?

    CREATE TABLE Locations
    (
        [id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY,
        [fulladdress]  AS (((([address]+[address2])+[city])+[state])+[zip]),
        [address] [varchar](50) NULL,
        [address2] [varchar](50) NULL,
        [city] [varchar](50) NULL,
        [state] [varchar](50) NULL,
        [zip] [varchar](50) NULL
    )

Thanks in advance",2
7557694,09/26/2011 15:46:14,965351,09/26/2011 15:40:06,1,0,How do I connect to a sql database through sql developer?,"So, I have a .sql file that I have downloaded and was wondering how I connect to it via sql developer which I have also downloaded. Do I need to create a connection with hostname and port etc? can I just connect to a file manually/directly or something?

Also, can anyone recommend a good database to practice/learn on for a beginner? Should I just download oracle 11g and play around with that?

Thanks.",sql,plsql,sql-developer,plsqldeveloper,,09/26/2011 22:45:13,not a real question,1,71,11,"How do I connect to a sql database through sql developer? So, I have a .sql file that I have downloaded and was wondering how I connect to it via sql developer which I have also downloaded. Do I need to create a connection with hostname and port etc? can I just connect to a file manually/directly or something?

Also, can anyone recommend a good database to practice/learn on for a beginner? Should I just download oracle 11g and play around with that?

Thanks.",4
2148091,01/27/2010 15:26:06,172029,09/11/2009 11:56:33,1766,51,Syntax for INSERTing into a table with no values?,"I have a table created with the following schema:

    CREATE TABLE [dbo].[Visualizations]
    (
    	VisualizationID		int identity(1,1)		NOT NULL
    )

Since the table has no settable fields, I'm not sure how to insert a record. I tried:

    INSERT INTO [Visualizations];
    INSERT INTO [Visualizations] () VALUES ();

Neither work. What is the proper syntax to do this?
",sql,tsql,sql-server,insert,,,open,0,69,9,"Syntax for INSERTing into a table with no values? I have a table created with the following schema:

    CREATE TABLE [dbo].[Visualizations]
    (
    	VisualizationID		int identity(1,1)		NOT NULL
    )

Since the table has no settable fields, I'm not sure how to insert a record. I tried:

    INSERT INTO [Visualizations];
    INSERT INTO [Visualizations] () VALUES ();

Neither work. What is the proper syntax to do this?
",4
7722838,10/11/2011 07:45:18,1150619,06/29/2011 07:43:03,499,64,phpBB manualy create forum posts with SQL query,"I create a WordPress plugin and I like to post posts from WordPress in phpBB forums. As I know there is no any bridge that can do that in the WordPress phpBB latest versions. Now my question is:

How can I create posts into phpBB database manualy by building the SQL queries and execute them. Is there any good tutorial ? Do you have to sugest anything ?

Thanks a lot :)",sql,query,phpbb,,,,open,0,70,8,"phpBB manualy create forum posts with SQL query I create a WordPress plugin and I like to post posts from WordPress in phpBB forums. As I know there is no any bridge that can do that in the WordPress phpBB latest versions. Now my question is:

How can I create posts into phpBB database manualy by building the SQL queries and execute them. Is there any good tutorial ? Do you have to sugest anything ?

Thanks a lot :)",3
2071595,01/15/2010 13:03:54,1458933,10/24/2008 13:34:24,235,7,Generate a row in an aggregation query for a date with no results against it.,"I'm sorry if the title question isn't very clear but i don't think i can expalain my problem in a single sentance.

I have a table with a number of different types of events in it all recorded against a date.

I'm querying the table and grouping based on a subset of the date (month and year).

    SELECT DATENAME(MONTH, event_date_time) + ' ' + DATENAME(YEAR, event_date_time), COUNT(reason)
	FROM blacklist_history
	WHERE (event_date_time BETWEEN DATEADD(mm,-6, '20/12/2009 23:59:59') AND '20/12/2009 23:59:59')
	GROUP BY (DATENAME(MONTH, event_date_time) + ' ' + DATENAME(YEAR, event_date_time))
	ORDER BY CONVERT(DATETIME, DATENAME(MONTH, event_date_time) + ' ' + DATENAME(YEAR, event_date_time)) ASC

(I normally have a variable for the date field)

This query returns the following against my data:

    August    2009	  15358
    September 2009	  48722
    October   2009	  19143
    November  2009	  4205
    December  2009	  3286

Now what i want to do is have the query also return for July 2009 but return a count of 0. I know that SQL Server can't just magic this out of thin air, but i can't quite see in my head how i would create the data i want to join against my result to fill the empty space for July.

Any suggestions would be helpful.(using SQL Server 2005)

Thanks",sql,sql-server,,,,,open,0,222,15,"Generate a row in an aggregation query for a date with no results against it. I'm sorry if the title question isn't very clear but i don't think i can expalain my problem in a single sentance.

I have a table with a number of different types of events in it all recorded against a date.

I'm querying the table and grouping based on a subset of the date (month and year).

    SELECT DATENAME(MONTH, event_date_time) + ' ' + DATENAME(YEAR, event_date_time), COUNT(reason)
	FROM blacklist_history
	WHERE (event_date_time BETWEEN DATEADD(mm,-6, '20/12/2009 23:59:59') AND '20/12/2009 23:59:59')
	GROUP BY (DATENAME(MONTH, event_date_time) + ' ' + DATENAME(YEAR, event_date_time))
	ORDER BY CONVERT(DATETIME, DATENAME(MONTH, event_date_time) + ' ' + DATENAME(YEAR, event_date_time)) ASC

(I normally have a variable for the date field)

This query returns the following against my data:

    August    2009	  15358
    September 2009	  48722
    October   2009	  19143
    November  2009	  4205
    December  2009	  3286

Now what i want to do is have the query also return for July 2009 but return a count of 0. I know that SQL Server can't just magic this out of thin air, but i can't quite see in my head how i would create the data i want to join against my result to fill the empty space for July.

Any suggestions would be helpful.(using SQL Server 2005)

Thanks",2
9094073,02/01/2012 10:13:11,1099310,12/15/2011 07:08:52,11,0,how to get value from table,"i have a table sample...there is six column name like ObjID, ATrKey,userName,CA,Qualitytype,CT.
ObjID is same for all column and Qualitytype like R and D , ATrKey is same for R and D...

if Qualitytype is R and D then i want only R else want D.


How to get this value can help me please  

username_s	creation_time	correctiveaction_s	qualitytype_s	mqmsconfigattrkey_s	objectid_s
w201fai	30-NOV-2011 09:14:27 AM	null	D	11626018	Aa11
w201fai	30-NOV-2011 09:14:27 AM	Repaired	R	11626018	Aa11
w201cairh	30-NOV-2011 09:14:27 AM	Repaired	R	13460719	Aa11
w201fai	30-NOV-2011 09:14:27 AM	null	D	13460719	Aa11
w201fai	30-NOV-2011 09:14:27 AM	null	D	13464430	Aa11

",sql,oracle,,,,02/01/2012 20:47:38,not a real question,1,64,6,"how to get value from table i have a table sample...there is six column name like ObjID, ATrKey,userName,CA,Qualitytype,CT.
ObjID is same for all column and Qualitytype like R and D , ATrKey is same for R and D...

if Qualitytype is R and D then i want only R else want D.


How to get this value can help me please  

username_s	creation_time	correctiveaction_s	qualitytype_s	mqmsconfigattrkey_s	objectid_s
w201fai	30-NOV-2011 09:14:27 AM	null	D	11626018	Aa11
w201fai	30-NOV-2011 09:14:27 AM	Repaired	R	11626018	Aa11
w201cairh	30-NOV-2011 09:14:27 AM	Repaired	R	13460719	Aa11
w201fai	30-NOV-2011 09:14:27 AM	null	D	13460719	Aa11
w201fai	30-NOV-2011 09:14:27 AM	null	D	13464430	Aa11

",2
3383558,08/01/2010 20:07:33,321340,04/20/2010 13:35:38,238,15,Whether to Split Data in to Separate PostgreSQL Table,"I am creating an app with a WPF frontend and a PostgreSQL database. The data includes patient addresses and supplier addresses. There is an average of about 3 contacts per mailing address listed. I'm estimating 10,000 - 15,000 contact records per database.

When designing the database structure, it occurred to me that rather than storing mailing addresses in a single ""contacts"" table, I could have one table storing names and other individual data, with a second table holding addresses. I could then create a relationship between the tables, to match addresses with contacts. 

I have a pretty good idea how I can neatly organise situations such as changing the address of a single contact, where the other contacts are staying at the same address.

The question is: is it worth it? Can I expect to save much in the way of storage size? Will this impact the speed of queries adversley? How about if I was using something other than PostgreSQL?",sql,database-design,optimization,postgresql,,,open,0,159,9,"Whether to Split Data in to Separate PostgreSQL Table I am creating an app with a WPF frontend and a PostgreSQL database. The data includes patient addresses and supplier addresses. There is an average of about 3 contacts per mailing address listed. I'm estimating 10,000 - 15,000 contact records per database.

When designing the database structure, it occurred to me that rather than storing mailing addresses in a single ""contacts"" table, I could have one table storing names and other individual data, with a second table holding addresses. I could then create a relationship between the tables, to match addresses with contacts. 

I have a pretty good idea how I can neatly organise situations such as changing the address of a single contact, where the other contacts are staying at the same address.

The question is: is it worth it? Can I expect to save much in the way of storage size? Will this impact the speed of queries adversley? How about if I was using something other than PostgreSQL?",4
4625456,01/07/2011 12:29:41,566676,01/07/2011 09:37:21,1,0,Oracle sql developer color coding,"Is there a way to color code the database connections within Oracle SQL Developer?  I know that TOAD can do this.  I want to make prod have a RED background and DEV with a green backgorund, to make it easy to know which system I'm working on at any moment

Cheers",sql,oracle,,,,,open,0,52,5,"Oracle sql developer color coding Is there a way to color code the database connections within Oracle SQL Developer?  I know that TOAD can do this.  I want to make prod have a RED background and DEV with a green backgorund, to make it easy to know which system I'm working on at any moment

Cheers",2
10618501,05/16/2012 12:27:27,1186009,02/02/2012 19:46:14,198,0,Updating multiple fields at once,"I'm trying to find all instances of the word true throughout the table and change them to a '1'.  To save time in the future, I'd like to be able to change every column at once and only run one query.  

`update myTable
set field1, field2, field3=1
where field1, field2, field3='true'`

that's kinda what i'm looking at doing. ",sql,,,,,05/17/2012 02:24:25,not a real question,1,58,5,"Updating multiple fields at once I'm trying to find all instances of the word true throughout the table and change them to a '1'.  To save time in the future, I'd like to be able to change every column at once and only run one query.  

`update myTable
set field1, field2, field3=1
where field1, field2, field3='true'`

that's kinda what i'm looking at doing. ",1
4428885,12/13/2010 12:37:11,26817,10/10/2008 13:29:07,179,3,[VBA] How to call stored procedure in SQL Server from Excel (Windows Authentication)?,"What is the syntax to call stored procedure in SQL Server from Excel (VBA) using windows authentication?

",sql,sql-server,windows,excel-vba,,,open,0,17,13,"[VBA] How to call stored procedure in SQL Server from Excel (Windows Authentication)? What is the syntax to call stored procedure in SQL Server from Excel (VBA) using windows authentication?

",4
8510246,12/14/2011 19:09:10,59401,01/27/2009 16:09:54,140,17,TSQL invalid where clause in sub query,"I have a situation where I need select the current and previous order amount using a select statement.

Order Table:

    OrderId
    OrderDate
    OrderAmount

Current Select Statement:

    SELECT o.OrderId, o.OrderDate, o.OrderAmount, po.OrderAmount
    FROM Order o
    LEFT JOIN (
       SELECT TOP(1) so.OrderAmount
       FROM Order so
       WHERE so.OrderId <> o.OrderId
       ORDER BY so.OrderDate DESC
       ) po

The problem is that the ""where"" clause in the sub query is not allowed. Is there another method for getting this information
",sql,sql-server,tsql,,,,open,0,120,7,"TSQL invalid where clause in sub query I have a situation where I need select the current and previous order amount using a select statement.

Order Table:

    OrderId
    OrderDate
    OrderAmount

Current Select Statement:

    SELECT o.OrderId, o.OrderDate, o.OrderAmount, po.OrderAmount
    FROM Order o
    LEFT JOIN (
       SELECT TOP(1) so.OrderAmount
       FROM Order so
       WHERE so.OrderId <> o.OrderId
       ORDER BY so.OrderDate DESC
       ) po

The problem is that the ""where"" clause in the sub query is not allowed. Is there another method for getting this information
",3
6549441,07/01/2011 14:41:18,655293,03/11/2011 11:59:08,17,1,share datas between 4 websites,"I'm planing a webproject, containing 4 websites build in MVC3. As a databaseserver I'm going to use the ms sql server.

Each of this websites will have something arround 40 tables. But some of the tables are shared between the websites:
Contact, Cities, Postalcodes, Countries...

How to handle this? should I put all the tables of each database into a common database (so that the database of website 1,2,3 and website 4 are in one databse together). Or should I create one database containing shared datase?

But then I think I'm getting problems with the data consitency, because I think there is no way to point from one database to an other (linking for example the citytable in database one to the buldingtable in databse 2).

Any ideas?
Thanks a lot!",sql,database,sql-server-2008,database-design,,,open,0,125,5,"share datas between 4 websites I'm planing a webproject, containing 4 websites build in MVC3. As a databaseserver I'm going to use the ms sql server.

Each of this websites will have something arround 40 tables. But some of the tables are shared between the websites:
Contact, Cities, Postalcodes, Countries...

How to handle this? should I put all the tables of each database into a common database (so that the database of website 1,2,3 and website 4 are in one databse together). Or should I create one database containing shared datase?

But then I think I'm getting problems with the data consitency, because I think there is no way to point from one database to an other (linking for example the citytable in database one to the buldingtable in databse 2).

Any ideas?
Thanks a lot!",4
9641502,03/09/2012 21:53:50,1260220,03/09/2012 21:22:03,1,0,Update column that satisfy certain rules using MySQL,"I am trying to update the banner fields for rows that satisfy specific rules (this is from a web log) in SQL

Find all rows whose page_description is not homepage, and whose banner is null.
Then update banner column of these row with the value from the homepage row whose session_id is the same as the row being updated.


**session_id     &nbsp;&nbsp; banner    &nbsp;&nbsp;&nbsp;&nbsp; page_description** <br>
a1 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             &nbsp;&nbsp;&nbsp;yahoo      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;homepage<br>
a1     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         null      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; page2<br>
a2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              null     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  homepage<br>
a3        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      google  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   homepage<br>
a4       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       msn   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     homepage <br>
a4         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     null     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  page2<br>
a4            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  null     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  page3",sql,mysqli,,,,03/10/2012 14:46:30,too localized,1,216,8,"Update column that satisfy certain rules using MySQL I am trying to update the banner fields for rows that satisfy specific rules (this is from a web log) in SQL

Find all rows whose page_description is not homepage, and whose banner is null.
Then update banner column of these row with the value from the homepage row whose session_id is the same as the row being updated.


**session_id     &nbsp;&nbsp; banner    &nbsp;&nbsp;&nbsp;&nbsp; page_description** <br>
a1 &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             &nbsp;&nbsp;&nbsp;yahoo      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;homepage<br>
a1     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;         null      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; page2<br>
a2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;              null     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  homepage<br>
a3        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      google  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   homepage<br>
a4       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       msn   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     homepage <br>
a4         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     null     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  page2<br>
a4            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  null     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  page3",2
2838311,05/14/2010 23:48:35,341687,05/14/2010 23:48:35,1,0,What's the most efficient query?,"I have a table named Projects that has the following relationships:

has many Contributions
has many Payments

In my result set, I need the following aggregate values:

- Number of unique contributors (DonorID on the Contribution table)
- Total contributed (SUM of Amount on Contribution table)
- Total paid (SUM of PaymentAmount on Payment table)

Because there are so many aggregate functions and multiple joins, it gets messy do use standard aggregate functions the the GROUP BY clause. I also need the ability to sort and filter these fields. So I've come up with two options:

Using subqueries:

    SELECT Project.ID AS PROJECT_ID,
    (SELECT SUM(PaymentAmount) FROM Payment WHERE ProjectID = PROJECT_ID) AS TotalPaidBack,
    (SELECT COUNT(DISTINCT DonorID) FROM Contribution WHERE RecipientID = PROJECT_ID) AS ContributorCount,
    (SELECT SUM(Amount) FROM Contribution WHERE RecipientID = PROJECT_ID) AS TotalReceived
    FROM Project;

Using a temporary table:

    DROP TABLE IF EXISTS Project_Temp;
    CREATE TEMPORARY TABLE Project_Temp (project_id INT NOT NULL, total_payments INT, total_donors INT, total_received INT, PRIMARY KEY(project_id)) ENGINE=MEMORY;
    INSERT INTO Project_Temp (project_id,total_payments)
     SELECT `Project`.ID, IFNULL(SUM(PaymentAmount),0) FROM `Project` LEFT JOIN `Payment` ON ProjectID = `Project`.ID GROUP BY 1;
    INSERT INTO Project_Temp (project_id,total_donors,total_received)
     SELECT `Project`.ID, IFNULL(COUNT(DISTINCT DonorID),0), IFNULL(SUM(Amount),0) FROM `Project` LEFT JOIN `Contribution` ON RecipientID = `Project`.ID  GROUP BY 1
     ON DUPLICATE KEY UPDATE total_donors = VALUES(total_donors), total_received = VALUES(total_received);
    
    SELECT * FROM Project_Temp;

Tests for both are pretty comparable, in the 0.7 - 0.8 seconds range with 1,000 rows. But I'm really concerned about scalability, and I don't want to have to re-engineer everything as my tables grow. What's the best approach?
",sql,performance,subquery,aggregate,function,,open,0,291,5,"What's the most efficient query? I have a table named Projects that has the following relationships:

has many Contributions
has many Payments

In my result set, I need the following aggregate values:

- Number of unique contributors (DonorID on the Contribution table)
- Total contributed (SUM of Amount on Contribution table)
- Total paid (SUM of PaymentAmount on Payment table)

Because there are so many aggregate functions and multiple joins, it gets messy do use standard aggregate functions the the GROUP BY clause. I also need the ability to sort and filter these fields. So I've come up with two options:

Using subqueries:

    SELECT Project.ID AS PROJECT_ID,
    (SELECT SUM(PaymentAmount) FROM Payment WHERE ProjectID = PROJECT_ID) AS TotalPaidBack,
    (SELECT COUNT(DISTINCT DonorID) FROM Contribution WHERE RecipientID = PROJECT_ID) AS ContributorCount,
    (SELECT SUM(Amount) FROM Contribution WHERE RecipientID = PROJECT_ID) AS TotalReceived
    FROM Project;

Using a temporary table:

    DROP TABLE IF EXISTS Project_Temp;
    CREATE TEMPORARY TABLE Project_Temp (project_id INT NOT NULL, total_payments INT, total_donors INT, total_received INT, PRIMARY KEY(project_id)) ENGINE=MEMORY;
    INSERT INTO Project_Temp (project_id,total_payments)
     SELECT `Project`.ID, IFNULL(SUM(PaymentAmount),0) FROM `Project` LEFT JOIN `Payment` ON ProjectID = `Project`.ID GROUP BY 1;
    INSERT INTO Project_Temp (project_id,total_donors,total_received)
     SELECT `Project`.ID, IFNULL(COUNT(DISTINCT DonorID),0), IFNULL(SUM(Amount),0) FROM `Project` LEFT JOIN `Contribution` ON RecipientID = `Project`.ID  GROUP BY 1
     ON DUPLICATE KEY UPDATE total_donors = VALUES(total_donors), total_received = VALUES(total_received);
    
    SELECT * FROM Project_Temp;

Tests for both are pretty comparable, in the 0.7 - 0.8 seconds range with 1,000 rows. But I'm really concerned about scalability, and I don't want to have to re-engineer everything as my tables grow. What's the best approach?
",5
5353363,03/18/2011 14:25:17,357656,06/03/2010 15:41:29,700,24,Slow JOIN query with OR in WHERE statement,"Here is an simple example for my problem:

    CREATE TABLE test1 (id SERIAL, key TEXT UNIQUE, value TEXT);
    CREATE TABLE test2 (id SERIAL, key TEXT UNIQUE, value TEXT);

    INSERT INTO test1 (key, value) 
    SELECT i::TEXT, 'ABC' || i::TEXT 
    FROM generate_series(0, 1000000) AS i;

    INSERT INTO test2 (key, value) 
    SELECT i::TEXT, 'ABC' || (i+1000)::TEXT 
    FROM generate_series(0,  600000) AS i;

    INSERT INTO test2 (key, value) 
    SELECT i::TEXT, 'ABC' || (i+1000)::TEXT 
    FROM generate_series(1000000, 1200000) AS i;

    CREATE INDEX test1_key ON test1 (key);
    CREATE INDEX test1_value ON test1 (value);
    CREATE INDEX test2_key ON test2 (key);
    CREATE INDEX test2_value ON test2 (value);

    VACUUM FULL VERBOSE ANALYZE test1;
    VACUUM FULL VERBOSE ANALYZE test2;

That is the query i'm currently using, but which takes more than 6 seconds.

    EXPLAIN ANALYZE 
    SELECT test1.key AS key1, test1.value AS value1, 
           test2.key AS key2, test2.value AS value2
    FROM test1 
    LEFT OUTER JOIN test2 ON (test1.key = test2.key)
    WHERE test1.value = 'ABC1234' OR test2.value = 'ABC1234';

     key1 | value1  | key2 | value2
    ------+---------+------+---------
     234  | ABC234  | 234  | ABC1234
     1234 | ABC1234 | 1234 | ABC2234
    (2 rows)

                                                             QUERY PLAN
    ----------------------------------------------------------------------------------------------------------------------------
     Hash Left Join  (cost=27344.05..79728.10 rows=2 width=32) (actual time=5428.635..6097.098 rows=2 loops=1)
       Hash Cond: (test1.key = test2.key)
       Filter: ((test1.value = 'ABC1234'::text) OR (test2.value = 'ABC1234'::text))
       ->  Seq Scan on test1  (cost=0.00..16321.01 rows=1000001 width=15) (actual time=0.009..1057.315 rows=1000001 loops=1)
       ->  Hash  (cost=13047.02..13047.02 rows=800002 width=17) (actual time=2231.964..2231.964 rows=800002 loops=1)
             Buckets: 65536  Batches: 2  Memory Usage: 14551kB
             ->  Seq Scan on test2  (cost=0.00..13047.02 rows=800002 width=17) (actual time=0.010..980.232 rows=800002 loops=1)
     Total runtime: 6109.042 ms
    (8 rows)

In both tables only very few datasets will meet the requirements, but it seems that fact isn't observed. I can instead use a query like that:

    EXPLAIN ANALYZE 
    SELECT coalesce(test1.key, test3.key1) AS key1, coalesce(test1.value, test3.value1) AS value1,
           coalesce(test2.key, test3.key2) AS key2, coalesce(test2.value, test3.value2) AS value2
    FROM (SELECT test1.key AS key1, test1.value AS value1, 
                 test2.key AS key2, test2.value AS value2
          FROM (SELECT key, value FROM test1 WHERE value = 'ABC1234') AS test1
          FULL JOIN (SELECT key, value FROM test2 WHERE value = 'ABC1234') AS test2
          ON (test1.key = test2.key)) AS test3
    LEFT OUTER JOIN test1 ON (test1.key = test3.key2)
    LEFT OUTER JOIN test2 ON (test2.key = test3.key1)
    WHERE test1.key IS NOT NULL;

     key1 | value1  | key2 | value2
    ------+---------+------+---------
     1234 | ABC1234 | 1234 | ABC2234
     234  | ABC234  | 234  | ABC1234
    (2 rows)

                                                                    QUERY PLAN
    ------------------------------------------------------------------------------------------------------------------------------------------
     Nested Loop Left Join  (cost=0.00..33.56 rows=1 width=64) (actual time=0.075..0.083 rows=1 loops=1)
       ->  Nested Loop  (cost=0.00..25.19 rows=1 width=47) (actual time=0.066..0.072 rows=1 loops=1)
             ->  Nested Loop Left Join  (cost=0.00..16.80 rows=1 width=32) (actual time=0.051..0.054 rows=1 loops=1)
                   ->  Index Scan using test2_value_key on test2  (cost=0.00..8.41 rows=1 width=17) (actual time=0.026..0.027 rows=1 loops=1)
                         Index Cond: (value = 'ABC1234'::text)
                   ->  Index Scan using test1_key on test1  (cost=0.00..8.38 rows=1 width=15) (actual time=0.020..0.020 rows=0 loops=1)
                         Index Cond: (public.test1.key = public.test2.key)
                         Filter: (public.test1.value = 'ABC1234'::text)
             ->  Index Scan using test1_key on test1  (cost=0.00..8.38 rows=1 width=15) (actual time=0.011..0.013 rows=1 loops=1)
                   Index Cond: ((public.test1.key IS NOT NULL) AND (public.test1.key = public.test2.key))
       ->  Index Scan using test2_key on test2  (cost=0.00..8.36 rows=1 width=17) (actual time=0.001..0.001 rows=0 loops=1)
             Index Cond: (public.test2.key = public.test1.key)
     Total runtime: 0.139 ms

The following query is simpler, but still too slow:

    EXPLAIN ANALYZE
    SELECT test1.key AS key1, test1.value AS value1, 
           test2.key AS key2, test2.value AS value2
    FROM test1 
    LEFT OUTER JOIN test2 ON (test1.key = test2.key)
    WHERE test1.value = 'ABC1234'
       OR EXISTS (SELECT 1 FROM test2 t WHERE t.key = test1.key AND t.value = 'ABC1234');

     key1 | value1  | key2 | value2
    ------+---------+------+---------
     1234 | ABC1234 | 1234 | ABC2234
     234  | ABC234  | 234  | ABC1234
    (2 rows)

                                                                   QUERY PLAN
    ----------------------------------------------------------------------------------------------------------------------------------------
     Merge Left Join  (cost=0.00..8446826.32 rows=500001 width=32) (actual time=615.706..1651.370 rows=2 loops=1)
       Merge Cond: (test1.key = test2.key)
       ->  Index Scan using test1_key on test1  (cost=0.00..8398983.25 rows=500001 width=15) (actual time=28.449..734.567 rows=2 loops=1)
             Filter: ((value = 'ABC1234'::text) OR (alternatives: SubPlan 1 or hashed SubPlan 2))
             SubPlan 1
               ->  Index Scan using test2_key on test2 t  (cost=0.00..8.36 rows=1 width=0) (never executed)
                     Index Cond: (key = $0)
                     Filter: (value = 'ABC1234'::text)
             SubPlan 2
               ->  Index Scan using test2_value on test2 t  (cost=0.00..8.37 rows=1 width=7) (actual time=0.376..0.380 rows=1 loops=1)
                     Index Cond: (value = 'ABC1234'::text)
       ->  Index Scan using test2_key on test2  (cost=0.00..39593.05 rows=800002 width=17) (actual time=0.019..498.456 rows=348894 loops=1)
     Total runtime: 1651.453 ms
    (13 rows)

<br>

So my question is: Is there a simple query which will lead to a similar fast execution plan like the second query or maybe an index or some kind of hint for the planner.

(I know for that example it would reasonable to only have one table with both values in it. But in reality the tables are more complicated and the table scheme can't be changed that easily.)

<br>

    PostgreSQL Version: 9.0.3
    shared_buffers = 64MB
    effective_cache_size = 32MB
    work_mem = 16MB
    maintenance_work_mem = 32MB
    temp_buffers = 8MB
    wal_buffers= 1MB
",sql,database,performance,postgresql,join,,open,0,1687,8,"Slow JOIN query with OR in WHERE statement Here is an simple example for my problem:

    CREATE TABLE test1 (id SERIAL, key TEXT UNIQUE, value TEXT);
    CREATE TABLE test2 (id SERIAL, key TEXT UNIQUE, value TEXT);

    INSERT INTO test1 (key, value) 
    SELECT i::TEXT, 'ABC' || i::TEXT 
    FROM generate_series(0, 1000000) AS i;

    INSERT INTO test2 (key, value) 
    SELECT i::TEXT, 'ABC' || (i+1000)::TEXT 
    FROM generate_series(0,  600000) AS i;

    INSERT INTO test2 (key, value) 
    SELECT i::TEXT, 'ABC' || (i+1000)::TEXT 
    FROM generate_series(1000000, 1200000) AS i;

    CREATE INDEX test1_key ON test1 (key);
    CREATE INDEX test1_value ON test1 (value);
    CREATE INDEX test2_key ON test2 (key);
    CREATE INDEX test2_value ON test2 (value);

    VACUUM FULL VERBOSE ANALYZE test1;
    VACUUM FULL VERBOSE ANALYZE test2;

That is the query i'm currently using, but which takes more than 6 seconds.

    EXPLAIN ANALYZE 
    SELECT test1.key AS key1, test1.value AS value1, 
           test2.key AS key2, test2.value AS value2
    FROM test1 
    LEFT OUTER JOIN test2 ON (test1.key = test2.key)
    WHERE test1.value = 'ABC1234' OR test2.value = 'ABC1234';

     key1 | value1  | key2 | value2
    ------+---------+------+---------
     234  | ABC234  | 234  | ABC1234
     1234 | ABC1234 | 1234 | ABC2234
    (2 rows)

                                                             QUERY PLAN
    ----------------------------------------------------------------------------------------------------------------------------
     Hash Left Join  (cost=27344.05..79728.10 rows=2 width=32) (actual time=5428.635..6097.098 rows=2 loops=1)
       Hash Cond: (test1.key = test2.key)
       Filter: ((test1.value = 'ABC1234'::text) OR (test2.value = 'ABC1234'::text))
       ->  Seq Scan on test1  (cost=0.00..16321.01 rows=1000001 width=15) (actual time=0.009..1057.315 rows=1000001 loops=1)
       ->  Hash  (cost=13047.02..13047.02 rows=800002 width=17) (actual time=2231.964..2231.964 rows=800002 loops=1)
             Buckets: 65536  Batches: 2  Memory Usage: 14551kB
             ->  Seq Scan on test2  (cost=0.00..13047.02 rows=800002 width=17) (actual time=0.010..980.232 rows=800002 loops=1)
     Total runtime: 6109.042 ms
    (8 rows)

In both tables only very few datasets will meet the requirements, but it seems that fact isn't observed. I can instead use a query like that:

    EXPLAIN ANALYZE 
    SELECT coalesce(test1.key, test3.key1) AS key1, coalesce(test1.value, test3.value1) AS value1,
           coalesce(test2.key, test3.key2) AS key2, coalesce(test2.value, test3.value2) AS value2
    FROM (SELECT test1.key AS key1, test1.value AS value1, 
                 test2.key AS key2, test2.value AS value2
          FROM (SELECT key, value FROM test1 WHERE value = 'ABC1234') AS test1
          FULL JOIN (SELECT key, value FROM test2 WHERE value = 'ABC1234') AS test2
          ON (test1.key = test2.key)) AS test3
    LEFT OUTER JOIN test1 ON (test1.key = test3.key2)
    LEFT OUTER JOIN test2 ON (test2.key = test3.key1)
    WHERE test1.key IS NOT NULL;

     key1 | value1  | key2 | value2
    ------+---------+------+---------
     1234 | ABC1234 | 1234 | ABC2234
     234  | ABC234  | 234  | ABC1234
    (2 rows)

                                                                    QUERY PLAN
    ------------------------------------------------------------------------------------------------------------------------------------------
     Nested Loop Left Join  (cost=0.00..33.56 rows=1 width=64) (actual time=0.075..0.083 rows=1 loops=1)
       ->  Nested Loop  (cost=0.00..25.19 rows=1 width=47) (actual time=0.066..0.072 rows=1 loops=1)
             ->  Nested Loop Left Join  (cost=0.00..16.80 rows=1 width=32) (actual time=0.051..0.054 rows=1 loops=1)
                   ->  Index Scan using test2_value_key on test2  (cost=0.00..8.41 rows=1 width=17) (actual time=0.026..0.027 rows=1 loops=1)
                         Index Cond: (value = 'ABC1234'::text)
                   ->  Index Scan using test1_key on test1  (cost=0.00..8.38 rows=1 width=15) (actual time=0.020..0.020 rows=0 loops=1)
                         Index Cond: (public.test1.key = public.test2.key)
                         Filter: (public.test1.value = 'ABC1234'::text)
             ->  Index Scan using test1_key on test1  (cost=0.00..8.38 rows=1 width=15) (actual time=0.011..0.013 rows=1 loops=1)
                   Index Cond: ((public.test1.key IS NOT NULL) AND (public.test1.key = public.test2.key))
       ->  Index Scan using test2_key on test2  (cost=0.00..8.36 rows=1 width=17) (actual time=0.001..0.001 rows=0 loops=1)
             Index Cond: (public.test2.key = public.test1.key)
     Total runtime: 0.139 ms

The following query is simpler, but still too slow:

    EXPLAIN ANALYZE
    SELECT test1.key AS key1, test1.value AS value1, 
           test2.key AS key2, test2.value AS value2
    FROM test1 
    LEFT OUTER JOIN test2 ON (test1.key = test2.key)
    WHERE test1.value = 'ABC1234'
       OR EXISTS (SELECT 1 FROM test2 t WHERE t.key = test1.key AND t.value = 'ABC1234');

     key1 | value1  | key2 | value2
    ------+---------+------+---------
     1234 | ABC1234 | 1234 | ABC2234
     234  | ABC234  | 234  | ABC1234
    (2 rows)

                                                                   QUERY PLAN
    ----------------------------------------------------------------------------------------------------------------------------------------
     Merge Left Join  (cost=0.00..8446826.32 rows=500001 width=32) (actual time=615.706..1651.370 rows=2 loops=1)
       Merge Cond: (test1.key = test2.key)
       ->  Index Scan using test1_key on test1  (cost=0.00..8398983.25 rows=500001 width=15) (actual time=28.449..734.567 rows=2 loops=1)
             Filter: ((value = 'ABC1234'::text) OR (alternatives: SubPlan 1 or hashed SubPlan 2))
             SubPlan 1
               ->  Index Scan using test2_key on test2 t  (cost=0.00..8.36 rows=1 width=0) (never executed)
                     Index Cond: (key = $0)
                     Filter: (value = 'ABC1234'::text)
             SubPlan 2
               ->  Index Scan using test2_value on test2 t  (cost=0.00..8.37 rows=1 width=7) (actual time=0.376..0.380 rows=1 loops=1)
                     Index Cond: (value = 'ABC1234'::text)
       ->  Index Scan using test2_key on test2  (cost=0.00..39593.05 rows=800002 width=17) (actual time=0.019..498.456 rows=348894 loops=1)
     Total runtime: 1651.453 ms
    (13 rows)

<br>

So my question is: Is there a simple query which will lead to a similar fast execution plan like the second query or maybe an index or some kind of hint for the planner.

(I know for that example it would reasonable to only have one table with both values in it. But in reality the tables are more complicated and the table scheme can't be changed that easily.)

<br>

    PostgreSQL Version: 9.0.3
    shared_buffers = 64MB
    effective_cache_size = 32MB
    work_mem = 16MB
    maintenance_work_mem = 32MB
    temp_buffers = 8MB
    wal_buffers= 1MB
",5
4025692,10/26/2010 16:23:01,392514,07/15/2010 09:25:17,69,3,"mysql ""group by"" very slow query.","i have this query in a table with about 100k records, it runs quite slow (3-4s), when I take out the group it's much faster (less than 0.5s). I'm quite at loss what to do to fix this :

    select msg.id, msg.thread_id, msg.senderid,msg.recipientid, 
    from_user.username as from_name, to_user.username as to_name
    from msgtable as msg
    left join usertable as from_user on msg.senderid = from_user.id
    left join usertabe as to_user on msg.recipientid = to_user.id
    GROUP BY msg.thread_id ORDER BY msg.id desc

msgtable has indexes on thread_id and id

Any ideas how to speed this up while returning the same result (there are multiple messages per thread, i want to return only one message per thread in this query).

thanks in advance.",sql,mysql,sql-optimization,,,,open,0,134,6,"mysql ""group by"" very slow query. i have this query in a table with about 100k records, it runs quite slow (3-4s), when I take out the group it's much faster (less than 0.5s). I'm quite at loss what to do to fix this :

    select msg.id, msg.thread_id, msg.senderid,msg.recipientid, 
    from_user.username as from_name, to_user.username as to_name
    from msgtable as msg
    left join usertable as from_user on msg.senderid = from_user.id
    left join usertabe as to_user on msg.recipientid = to_user.id
    GROUP BY msg.thread_id ORDER BY msg.id desc

msgtable has indexes on thread_id and id

Any ideas how to speed this up while returning the same result (there are multiple messages per thread, i want to return only one message per thread in this query).

thanks in advance.",3
5354593,03/18/2011 15:58:19,663567,03/17/2011 02:21:03,32,0,MVC model and SQL table name are the same,My model is called Application_Model_Poll. Zend is forcing me name my database table the same as the model. Is there anyway I can just call the table Poll?,sql,mvc,model,zend,,,open,0,28,9,MVC model and SQL table name are the same My model is called Application_Model_Poll. Zend is forcing me name my database table the same as the model. Is there anyway I can just call the table Poll?,4
9059431,01/30/2012 04:43:20,2136,08/20/2008 14:06:48,439,16,Using different ports with multiple instances on SQL Server,"In our development environment, we have numerous named instances of SQL Server 2008 running. I have recently added a new one it doesn't work as expected. Here is our set up:

 - DEFAULT on 10.2.2.48:1433
 - SQL1 on 10.2.2.40:1434
 - SQL2 on 10.2.2.41:1435
 - SQL3 on 10.2.2.42:1436

When the TCP/IP Properties of SQL3 are set to ""Listen All: Yes"", it stars correctly but can't be accessed using it's alias name of ""car-sql3"". When I set it to ""Listen All: No"", the service fails to start giving the following error in the System Event Log:

> The SQL Server (SQL3) service terminated with service-specific error. You were not connected because a duplicate name exists on the network. If joining a domain, go to System in Control Panel to change the computer name and try again. If joining a workgroup, choose another workgroup name.

When setting the values under ""IP Addresses"" (in the Configuration Manager), does the ""IP1, IP2, IPnn"" designation mean anything? Can I set IP1 for one instance to one particular IP:Port and IP1 on another instance to a different one, or do I need to be doing something different here.


",sql,sql-server,sql-server-2008,,,01/30/2012 06:50:42,off topic,1,188,9,"Using different ports with multiple instances on SQL Server In our development environment, we have numerous named instances of SQL Server 2008 running. I have recently added a new one it doesn't work as expected. Here is our set up:

 - DEFAULT on 10.2.2.48:1433
 - SQL1 on 10.2.2.40:1434
 - SQL2 on 10.2.2.41:1435
 - SQL3 on 10.2.2.42:1436

When the TCP/IP Properties of SQL3 are set to ""Listen All: Yes"", it stars correctly but can't be accessed using it's alias name of ""car-sql3"". When I set it to ""Listen All: No"", the service fails to start giving the following error in the System Event Log:

> The SQL Server (SQL3) service terminated with service-specific error. You were not connected because a duplicate name exists on the network. If joining a domain, go to System in Control Panel to change the computer name and try again. If joining a workgroup, choose another workgroup name.

When setting the values under ""IP Addresses"" (in the Configuration Manager), does the ""IP1, IP2, IPnn"" designation mean anything? Can I set IP1 for one instance to one particular IP:Port and IP1 on another instance to a different one, or do I need to be doing something different here.


",3
8308841,11/29/2011 09:59:05,1057735,11/21/2011 11:45:30,9,0,Recover data in sql server,"I wanted to ask can the database be restored to an earlier stage.
Somebody logged into my system and run a delete command.
Can this be restored?

",sql,sql-server,,,,11/29/2011 12:12:20,off topic,1,25,5,"Recover data in sql server I wanted to ask can the database be restored to an earlier stage.
Somebody logged into my system and run a delete command.
Can this be restored?

",2
8609562,12/22/2011 20:49:09,1112447,12/22/2011 20:39:16,1,0,SQL date range intersection tables,"I have two table 

TAB A
IdTicket,Date_Start,Date_End
1, 1/1/2011 08:00:00 , 1/1/2011 10:00:00
1, 1/1/2011 10:00:00 , 1/1/2011 11:00:00
1, 1/1/2011 13:00:00 , 1/1/2011 15:00:00
2, 1/2/2011 08:00:00 , 1/2/2011 10:00:00
2, 1/2/2011 12:00:00 , 1/3/2011 11:00:00

TAB B
IdTicket,Date_Start,Date_End
1, 1/1/2011 09:00:00 , 1/1/2011 10:30:00
1, 1/1/2011 12:00:00 , 1/1/2011 15:00:00
2, 1/2/2011 10:00:00 , 1/2/2011 11:00:00
2, 1/2/2011 10:00:00 , 1/3/2011 08:00:00

In SQL for every ticket I want date range intersection
Results:

1, 1/1/2011 09:00:00 , 1/1/2011 10:30:00
1, 1/1/2011 13:00:00 , 1/1/2011 15:00:00
2, 1/2/2011 12:00:00 , 1/3/2011 08:00:00



",sql,table,date,range,intersection,12/22/2011 23:30:14,not a real question,1,76,5,"SQL date range intersection tables I have two table 

TAB A
IdTicket,Date_Start,Date_End
1, 1/1/2011 08:00:00 , 1/1/2011 10:00:00
1, 1/1/2011 10:00:00 , 1/1/2011 11:00:00
1, 1/1/2011 13:00:00 , 1/1/2011 15:00:00
2, 1/2/2011 08:00:00 , 1/2/2011 10:00:00
2, 1/2/2011 12:00:00 , 1/3/2011 11:00:00

TAB B
IdTicket,Date_Start,Date_End
1, 1/1/2011 09:00:00 , 1/1/2011 10:30:00
1, 1/1/2011 12:00:00 , 1/1/2011 15:00:00
2, 1/2/2011 10:00:00 , 1/2/2011 11:00:00
2, 1/2/2011 10:00:00 , 1/3/2011 08:00:00

In SQL for every ticket I want date range intersection
Results:

1, 1/1/2011 09:00:00 , 1/1/2011 10:30:00
1, 1/1/2011 13:00:00 , 1/1/2011 15:00:00
2, 1/2/2011 12:00:00 , 1/3/2011 08:00:00



",5
2214728,02/06/2010 21:05:45,183276,10/02/2009 18:07:57,48,2,sql to calculate daily totals minues the previous day's totals,"I have a table that has a date, item, and quantity.

I need a sql query to return the totals per day, but the total is the quantity minus the previous day totals.  The quantity accumulates as the month goes on. So the 1st could have 5 the 2nd have 12 and the 3rd has 20.

So the 1st adds 5
2nd adds 7 to make 12
3rd adds 8 to make 20.

I've done something like this in the past, but can not find it or remember. I know i'll need a correlated sub-query.

TIA",sql,recursive-query,,,,,open,0,91,10,"sql to calculate daily totals minues the previous day's totals I have a table that has a date, item, and quantity.

I need a sql query to return the totals per day, but the total is the quantity minus the previous day totals.  The quantity accumulates as the month goes on. So the 1st could have 5 the 2nd have 12 and the 3rd has 20.

So the 1st adds 5
2nd adds 7 to make 12
3rd adds 8 to make 20.

I've done something like this in the past, but can not find it or remember. I know i'll need a correlated sub-query.

TIA",2
8449227,12/09/2011 17:17:37,392044,07/14/2010 20:36:19,3818,160,Is there a way in Oracle to make a column not case sensitive?,"I want to select rows from a table called `Users` where the column `Logon` is equal to `""foo""` - However, I also want to return `""Foo""` or `""FOO""`.

I could do something like:

    SELECT Id, Name FROM Users WHERE UPPER(Logon) = 'FOO';

And then convert my parameter to uppercase.  However, in our code we have literally hundreds of spots where we'd have to update this.

Is there a way to make the table schema itself case-insensitive so these queries will just work without modification?  Thanks!",sql,oracle,oracle11g,case-insensitive,,,open,0,87,13,"Is there a way in Oracle to make a column not case sensitive? I want to select rows from a table called `Users` where the column `Logon` is equal to `""foo""` - However, I also want to return `""Foo""` or `""FOO""`.

I could do something like:

    SELECT Id, Name FROM Users WHERE UPPER(Logon) = 'FOO';

And then convert my parameter to uppercase.  However, in our code we have literally hundreds of spots where we'd have to update this.

Is there a way to make the table schema itself case-insensitive so these queries will just work without modification?  Thanks!",4
2532072,03/28/2010 06:08:11,300978,03/24/2010 16:11:33,1,1,Running a simple VBA script to test a connection,"I'm trying to test the connection of a Go Daddy SQL Server database.  I'm getting an 'invalid connection string attribute.'

What's wrong with this script?



    Dim cnn As ADODB.Connection
Dim canConnect As Boolean


Public Sub TestConnection()

Set cnn = New ADODB.Connection

cnn.Open ""Provider=sqloledb;Data Source=GoDaddyServer.com;Initial Catalog=dBase1;UserID=userID; Password='password';""

If cnn.State = adStateOpen Then
    canConnect = True
    cnn.Close
End If

MsgBox canConnect

End Sub

",sql,server,vba,excel,,,open,0,62,9,"Running a simple VBA script to test a connection I'm trying to test the connection of a Go Daddy SQL Server database.  I'm getting an 'invalid connection string attribute.'

What's wrong with this script?



    Dim cnn As ADODB.Connection
Dim canConnect As Boolean


Public Sub TestConnection()

Set cnn = New ADODB.Connection

cnn.Open ""Provider=sqloledb;Data Source=GoDaddyServer.com;Initial Catalog=dBase1;UserID=userID; Password='password';""

If cnn.State = adStateOpen Then
    canConnect = True
    cnn.Close
End If

MsgBox canConnect

End Sub

",4
10064153,04/08/2012 15:55:05,779781,06/01/2011 16:16:30,38,0,Basic SQL : Check Constraint Returning Error Upon Creation of Tables,"really simple error when I'm creating some tables and it's probably just me being stupid but I'd rather post it here and have it sorted.

I'm using Postgresql.

(This table is just one of many but it's the one that's giving me a problem)

    CREATE TABLE Ticket
    (
    	ID		INTEGER NOT NULL PRIMARY KEY,
    	Problem	VARCHAR(1000),
    	Status	VARCHAR(20) NOT NULL DEFAULT 'open', 
    	Priority	INTEGER NOT NULL,
    	LoggedTime	TIMESTAMP NOT NULL,
    	CustomerID	INTEGER NOT NULL,
    	ProductID	INTEGER NOT NULL,
    	FOREIGN KEY (ProductID) REFERENCES Product(ID),
    	FOREIGN KEY (CustomerID) REFERENCES Customer(ID),
    	CHECK (status='open' OR 'closed' AND priority =  1 OR 2 OR 3)
    );


The error: ERROR:  invalid input syntax for type boolean: ""closed""

Also if anybody can give me a better method of doing the CHECK:

    CHECK (status='open' OR 'closed' AND priority =  1 OR 2 OR 3)

Then that would be really appreciated!",sql,postgresql,table,,,,open,0,176,11,"Basic SQL : Check Constraint Returning Error Upon Creation of Tables really simple error when I'm creating some tables and it's probably just me being stupid but I'd rather post it here and have it sorted.

I'm using Postgresql.

(This table is just one of many but it's the one that's giving me a problem)

    CREATE TABLE Ticket
    (
    	ID		INTEGER NOT NULL PRIMARY KEY,
    	Problem	VARCHAR(1000),
    	Status	VARCHAR(20) NOT NULL DEFAULT 'open', 
    	Priority	INTEGER NOT NULL,
    	LoggedTime	TIMESTAMP NOT NULL,
    	CustomerID	INTEGER NOT NULL,
    	ProductID	INTEGER NOT NULL,
    	FOREIGN KEY (ProductID) REFERENCES Product(ID),
    	FOREIGN KEY (CustomerID) REFERENCES Customer(ID),
    	CHECK (status='open' OR 'closed' AND priority =  1 OR 2 OR 3)
    );


The error: ERROR:  invalid input syntax for type boolean: ""closed""

Also if anybody can give me a better method of doing the CHECK:

    CHECK (status='open' OR 'closed' AND priority =  1 OR 2 OR 3)

Then that would be really appreciated!",3
9779915,03/20/2012 00:30:55,939713,09/12/2011 00:33:30,714,39,"SQL Server, How to removed updates elements from User-Defined Table Type?","I have a User-Defined Table Type, lets say `@TT dbo.IntType readonly,`
IntType is batch of `int`, as Primary-Key

    CREATE TYPE [dbo].[IntType] AS TABLE(
    	[T] [int] NOT NULL,
    	PRIMARY KEY CLUSTERED 

I like to do `UPDATE` based on all key(`int`) in `IntType`, and `INSERT` new rows for the key(`int`) not exist in the database (an upsert)

I wonder if theres a easy way to remove the ""UPDATED"" key(`int`)? Then I can insert the rest.
*(or if you have a super one-line upsert for SQL Server 2010!!!)*",sql,sql-server,upsert,,,,open,0,91,11,"SQL Server, How to removed updates elements from User-Defined Table Type? I have a User-Defined Table Type, lets say `@TT dbo.IntType readonly,`
IntType is batch of `int`, as Primary-Key

    CREATE TYPE [dbo].[IntType] AS TABLE(
    	[T] [int] NOT NULL,
    	PRIMARY KEY CLUSTERED 

I like to do `UPDATE` based on all key(`int`) in `IntType`, and `INSERT` new rows for the key(`int`) not exist in the database (an upsert)

I wonder if theres a easy way to remove the ""UPDATED"" key(`int`)? Then I can insert the rest.
*(or if you have a super one-line upsert for SQL Server 2010!!!)*",3
1830363,12/02/2009 02:47:45,205021,11/06/2009 16:24:48,31,2,"sql query problem, manipulate data.","I have stored proc That will tell us if there is any new checks to be printed.  Now I have to manipulate the data in database table in order to get atleast one check to be printed. I didnt wrote this query. I tried but i didn't get atleast one check to be printed. Can anyone help me .  HERE IS THE STORED PROC

`CREATE PROCEDURE [proc_1250_SELCashiersChecksForPrint] AS

SELECT t_DATA_CashiersChecksIssued.ControlNbr, 
    t_DATA_CashiersChecksIssued.Audit_DateAdded, 
    t_DATA_CashiersChecksIssued.BatchNbr, 
    t_DATA_CashiersChecksIssued.SerialNbr, 
    t_DATA_CashiersChecksIssued.CheckRTN, 
    t_DATA_CashiersChecksIssued.CheckAccountNbr, 
    t_DATA_CashiersChecksIssued.Amount, 
    t_DATA_CashiersChecksIssued.DateIssued, 
    t_DATA_CashiersChecksIssued.Payee, 
    t_DATA_CashiersChecksIssued.Address, 
    t_DATA_CashiersChecksIssued.City, 
    t_DATA_CashiersChecksIssued.State, 
    t_DATA_CashiersChecksIssued.Zip, 
    t_DATA_Reclamation.ClaimId, t_DATA_Reclamation.NoticeDate, 
    t_DATA_Reclamation.FirstName, 
    t_DATA_Reclamation.MiddleName, 
    t_DATA_Reclamation.LastName, 
    t_DATA_Reclamation.ClaimTotal, 
    t_PCD_Claimant.Name AS Agency, 
    t_DATA_CashiersChecksIssued.IDENTITYCOL
FROM t_DATA_CashiersChecksIssued INNER JOIN
    t_DATA_Reclamation ON 
    t_DATA_CashiersChecksIssued.ControlNbr = t_DATA_Reclamation.ControlNbr
     INNER JOIN
    t_PCD_Claimant ON 
    t_DATA_Reclamation.ClaimantCode = t_PCD_Claimant.ClaimantCode
WHERE (t_DATA_CashiersChecksIssued.SerialNbr IS NULL) AND 
    (t_DATA_CashiersChecksIssued.DateIssued IS NULL)
ORDER BY t_DATA_CashiersChecksIssued.Audit_DateAdded ASC, 
 t_DATA_CashiersChecksIssued.ControlNbr ASC
GO
`",sql,sql-server-2005,,,,,open,0,218,5,"sql query problem, manipulate data. I have stored proc That will tell us if there is any new checks to be printed.  Now I have to manipulate the data in database table in order to get atleast one check to be printed. I didnt wrote this query. I tried but i didn't get atleast one check to be printed. Can anyone help me .  HERE IS THE STORED PROC

`CREATE PROCEDURE [proc_1250_SELCashiersChecksForPrint] AS

SELECT t_DATA_CashiersChecksIssued.ControlNbr, 
    t_DATA_CashiersChecksIssued.Audit_DateAdded, 
    t_DATA_CashiersChecksIssued.BatchNbr, 
    t_DATA_CashiersChecksIssued.SerialNbr, 
    t_DATA_CashiersChecksIssued.CheckRTN, 
    t_DATA_CashiersChecksIssued.CheckAccountNbr, 
    t_DATA_CashiersChecksIssued.Amount, 
    t_DATA_CashiersChecksIssued.DateIssued, 
    t_DATA_CashiersChecksIssued.Payee, 
    t_DATA_CashiersChecksIssued.Address, 
    t_DATA_CashiersChecksIssued.City, 
    t_DATA_CashiersChecksIssued.State, 
    t_DATA_CashiersChecksIssued.Zip, 
    t_DATA_Reclamation.ClaimId, t_DATA_Reclamation.NoticeDate, 
    t_DATA_Reclamation.FirstName, 
    t_DATA_Reclamation.MiddleName, 
    t_DATA_Reclamation.LastName, 
    t_DATA_Reclamation.ClaimTotal, 
    t_PCD_Claimant.Name AS Agency, 
    t_DATA_CashiersChecksIssued.IDENTITYCOL
FROM t_DATA_CashiersChecksIssued INNER JOIN
    t_DATA_Reclamation ON 
    t_DATA_CashiersChecksIssued.ControlNbr = t_DATA_Reclamation.ControlNbr
     INNER JOIN
    t_PCD_Claimant ON 
    t_DATA_Reclamation.ClaimantCode = t_PCD_Claimant.ClaimantCode
WHERE (t_DATA_CashiersChecksIssued.SerialNbr IS NULL) AND 
    (t_DATA_CashiersChecksIssued.DateIssued IS NULL)
ORDER BY t_DATA_CashiersChecksIssued.Audit_DateAdded ASC, 
 t_DATA_CashiersChecksIssued.ControlNbr ASC
GO
`",2
4782998,01/24/2011 14:17:51,112451,05/26/2009 08:50:15,5181,253,"Optimise query to remove ""Using where; Using temporary; Using filesort""","I have a simple SQL query that i'm trying to optimise to remove ""Using where; Using temporary; Using filesort"". 

This is the table:

    CREATE TABLE `special_offers` (
      `so_id` int(11) NOT NULL auto_increment,
      `so_lid` int(11) NOT NULL,
      `so_product_id` int(11) NOT NULL,
      `so_bonus_product` int(11) NOT NULL,
      `so_reverse_relate` tinyint(1) NOT NULL default '0',
      `so_discount_amount` varchar(6) NOT NULL,
      `so_start` date NOT NULL default '0000-00-00',
      `so_expiry` date NOT NULL default '0000-00-00',
      `so_active` tinyint(1) NOT NULL,
      `so_archived` tinyint(4) NOT NULL default '0',
      `so_added` datetime NOT NULL,
      PRIMARY KEY  (`so_id`),
      KEY `so_archived` (`so_archived`),
      KEY `so_active` (`so_active`),
      KEY `so_start` (`so_start`),
      KEY `so_expiry` (`so_expiry`),
      KEY `so_product_id` (`so_product_id`),
      KEY `so_bonus_product` (`so_bonus_product`),
      KEY `so_lid` (`so_lid`)
    ) ENGINE=MyISAM AUTO_INCREMENT=65610 DEFAULT CHARSET=latin1

This is the query:

    SELECT `so_id` , `so_lid` , `so_bonus_product` , `so_product_id`
    FROM `special_offers`
    WHERE `so_archived` = '0'
    AND `so_active` = '1'
    AND (
    `so_start` <= CURDATE( )
    OR `so_start` = '0000-00-00'
    )
    AND (
    `so_expiry` >= CURDATE( )
    OR `so_expiry` = '0000-00-00'
    )
    GROUP BY `so_lid`

An EXPLAIN:

    mysql> EXPLAIN SELECT `so_id` , `so_lid` , `so_bonus_product` , `so_product_id` FROM `special_offers` WHERE `so_archived` = '0' AND `so_active` = '1' AND ( `so_start` <= CURDATE( ) OR `so_start` = '0000-00-00' ) AND ( `so_expiry` >= CURDATE( ) OR `so_expiry` = '0000-00-00' ) GROUP BY `so_lid`;
    +----+-------------+-------------------+------+------------------------------------------+-------------+---------+-------+------+----------------------------------------------+
    | id | select_type | table             | type | possible_keys                            | key         | key_len | ref   | rows | Extra                                        |
    +----+-------------+-------------------+------+------------------------------------------+-------------+---------+-------+------+----------------------------------------------+
    |  1 | SIMPLE      | special_offers    | ref  | so_archived,so_active,so_start,so_expiry | so_archived | 1       | const | 7684 | Using where; Using temporary; Using filesort |
    +----+-------------+-------------------+------+------------------------------------------+-------------+---------+-------+------+----------------------------------------------+

",sql,mysql,query,optimization,,,open,0,514,10,"Optimise query to remove ""Using where; Using temporary; Using filesort"" I have a simple SQL query that i'm trying to optimise to remove ""Using where; Using temporary; Using filesort"". 

This is the table:

    CREATE TABLE `special_offers` (
      `so_id` int(11) NOT NULL auto_increment,
      `so_lid` int(11) NOT NULL,
      `so_product_id` int(11) NOT NULL,
      `so_bonus_product` int(11) NOT NULL,
      `so_reverse_relate` tinyint(1) NOT NULL default '0',
      `so_discount_amount` varchar(6) NOT NULL,
      `so_start` date NOT NULL default '0000-00-00',
      `so_expiry` date NOT NULL default '0000-00-00',
      `so_active` tinyint(1) NOT NULL,
      `so_archived` tinyint(4) NOT NULL default '0',
      `so_added` datetime NOT NULL,
      PRIMARY KEY  (`so_id`),
      KEY `so_archived` (`so_archived`),
      KEY `so_active` (`so_active`),
      KEY `so_start` (`so_start`),
      KEY `so_expiry` (`so_expiry`),
      KEY `so_product_id` (`so_product_id`),
      KEY `so_bonus_product` (`so_bonus_product`),
      KEY `so_lid` (`so_lid`)
    ) ENGINE=MyISAM AUTO_INCREMENT=65610 DEFAULT CHARSET=latin1

This is the query:

    SELECT `so_id` , `so_lid` , `so_bonus_product` , `so_product_id`
    FROM `special_offers`
    WHERE `so_archived` = '0'
    AND `so_active` = '1'
    AND (
    `so_start` <= CURDATE( )
    OR `so_start` = '0000-00-00'
    )
    AND (
    `so_expiry` >= CURDATE( )
    OR `so_expiry` = '0000-00-00'
    )
    GROUP BY `so_lid`

An EXPLAIN:

    mysql> EXPLAIN SELECT `so_id` , `so_lid` , `so_bonus_product` , `so_product_id` FROM `special_offers` WHERE `so_archived` = '0' AND `so_active` = '1' AND ( `so_start` <= CURDATE( ) OR `so_start` = '0000-00-00' ) AND ( `so_expiry` >= CURDATE( ) OR `so_expiry` = '0000-00-00' ) GROUP BY `so_lid`;
    +----+-------------+-------------------+------+------------------------------------------+-------------+---------+-------+------+----------------------------------------------+
    | id | select_type | table             | type | possible_keys                            | key         | key_len | ref   | rows | Extra                                        |
    +----+-------------+-------------------+------+------------------------------------------+-------------+---------+-------+------+----------------------------------------------+
    |  1 | SIMPLE      | special_offers    | ref  | so_archived,so_active,so_start,so_expiry | so_archived | 1       | const | 7684 | Using where; Using temporary; Using filesort |
    +----+-------------+-------------------+------+------------------------------------------+-------------+---------+-------+------+----------------------------------------------+

",4
4306590,11/29/2010 18:01:29,62449,02/04/2009 14:39:02,441,8,mySQL: is it possible to make this query any faster?,"I have a table ""test"" containing millions of entries. Each row contains a floating point ""feature"" and a ""count"" how often this feature is present in item ""id"". The primary key for this table is the combination of ""id"" and ""feature"", i.e. every item may have multiple features. There are usually a couple of hundred to a couple of thausand feature entries per item id.

    create table test 
    (
        id      int not null,
        feature double not null,
        count   int not null
    );

The task is to find the 500 most similar items to a given reference item. Similarity is measured in number of identical feature values in both items. The query I have come up with is quoted below, but despite properly using indices its execution plan still contains ""using temporary"" and ""using filesort"", giving unacceptable performance for my use case.

    select 
        t1.id,
        t2.id,
        sum( least( t1.count, t2.count )) as priority 
    from test as t1
    inner join test as t2 
         on t2.feature = t1.feature
    where t1.id = {some user supplied id value} 
    group by t1.id, t2.id 
    order by priority desc
    limit 500;

Any ideas on how to improve on this? The schema can be modified and indices added as needed.",sql,mysql,query,optimization,query-optimization,,open,0,291,10,"mySQL: is it possible to make this query any faster? I have a table ""test"" containing millions of entries. Each row contains a floating point ""feature"" and a ""count"" how often this feature is present in item ""id"". The primary key for this table is the combination of ""id"" and ""feature"", i.e. every item may have multiple features. There are usually a couple of hundred to a couple of thausand feature entries per item id.

    create table test 
    (
        id      int not null,
        feature double not null,
        count   int not null
    );

The task is to find the 500 most similar items to a given reference item. Similarity is measured in number of identical feature values in both items. The query I have come up with is quoted below, but despite properly using indices its execution plan still contains ""using temporary"" and ""using filesort"", giving unacceptable performance for my use case.

    select 
        t1.id,
        t2.id,
        sum( least( t1.count, t2.count )) as priority 
    from test as t1
    inner join test as t2 
         on t2.feature = t1.feature
    where t1.id = {some user supplied id value} 
    group by t1.id, t2.id 
    order by priority desc
    limit 500;

Any ideas on how to improve on this? The schema can be modified and indices added as needed.",5
7294808,09/03/2011 17:48:55,920374,08/30/2011 19:22:16,3,0,How to build your own SQL parser?,"I would like to write an SQL Parser. I was considering a high level language (probably Python). 

Is there a good starting point for some theoretical concepts, a tutorial or something more generic on writing parsers ? ",sql,parsing,,,,09/03/2011 22:27:14,not a real question,1,38,7,"How to build your own SQL parser? I would like to write an SQL Parser. I was considering a high level language (probably Python). 

Is there a good starting point for some theoretical concepts, a tutorial or something more generic on writing parsers ? ",2
6550115,07/01/2011 15:40:44,134035,07/07/2009 04:14:30,59,2,SQL Server XML add attribute if non-existent,"I am trying to add an attribute if it does not exist. It should be simple, but I am new to XML XPath/XQuery/etc so Xcuse my ignorance.

I want to be able to pass XML data and modify it...

    ALTER FUNCTION [dbo].[ConvertXmlData](@xmlData XML)
    RETURNS XML
    AS
    BEGIN
      RETURN @xmlData.<something here>
    END

<p/>

If I pass data like:<p><b>
    &lt;something&gt;
          <br/>&nbsp;&nbsp;&nbsp;this is sample data &lt;xxx id=""1""/&gt; and &lt;xxx id=""2"" runat=""server"" /&gt;. More &lt;yyy id=""3"" /&gt;<br>
    &lt;/something&gt;
</b><p>
I would like <br/><b>

&lt;something&gt;<br>
  this is sample data &lt;xxx id=""1"" runat=""server"" /&gt; and &lt;xxx id=""2"" runat=""server"" /&gt;. More &lt;yyy id=""3"" /&gt;<p>
&lt;/something&gt;
</b>

and not <p><b>
&lt;something&gt;<br/>
  this is sample data &lt;xxx id=""1"" runat=""server"" /&gt; and &lt;xxx id=""2"" <em><font color=""navy"">runat=""server"" runat=""server""</font></em>/&gt;. More &lt;yyy id=""3"" /&gt;<br/>
&lt;/something&gt;
</b>",sql,xml,xpath,xquery,xquery-sql,,open,0,148,7,"SQL Server XML add attribute if non-existent I am trying to add an attribute if it does not exist. It should be simple, but I am new to XML XPath/XQuery/etc so Xcuse my ignorance.

I want to be able to pass XML data and modify it...

    ALTER FUNCTION [dbo].[ConvertXmlData](@xmlData XML)
    RETURNS XML
    AS
    BEGIN
      RETURN @xmlData.<something here>
    END

<p/>

If I pass data like:<p><b>
    &lt;something&gt;
          <br/>&nbsp;&nbsp;&nbsp;this is sample data &lt;xxx id=""1""/&gt; and &lt;xxx id=""2"" runat=""server"" /&gt;. More &lt;yyy id=""3"" /&gt;<br>
    &lt;/something&gt;
</b><p>
I would like <br/><b>

&lt;something&gt;<br>
  this is sample data &lt;xxx id=""1"" runat=""server"" /&gt; and &lt;xxx id=""2"" runat=""server"" /&gt;. More &lt;yyy id=""3"" /&gt;<p>
&lt;/something&gt;
</b>

and not <p><b>
&lt;something&gt;<br/>
  this is sample data &lt;xxx id=""1"" runat=""server"" /&gt; and &lt;xxx id=""2"" <em><font color=""navy"">runat=""server"" runat=""server""</font></em>/&gt;. More &lt;yyy id=""3"" /&gt;<br/>
&lt;/something&gt;
</b>",5
3338154,07/26/2010 19:14:28,308565,04/04/2010 04:02:25,125,0,DateTime.ParseExact format error ,"I have used a textbox to store a date in DD-MM-YYYY format and since i use SQL server i used to get the value from the textbox and then place it in a variable of type DateTime dt

    DateTime dt = DateTime.ParseExact(TextBox10.Text,""MM-DD-YYYY"",CultureInfo.InvariantCulture);

I am getting format specification error, I went through many documentation but still couldn't get where i am going wrong

This i am using C# and ADO.net 
Please can anyone correct me?",sql,ado.net,,,,,open,0,75,4,"DateTime.ParseExact format error  I have used a textbox to store a date in DD-MM-YYYY format and since i use SQL server i used to get the value from the textbox and then place it in a variable of type DateTime dt

    DateTime dt = DateTime.ParseExact(TextBox10.Text,""MM-DD-YYYY"",CultureInfo.InvariantCulture);

I am getting format specification error, I went through many documentation but still couldn't get where i am going wrong

This i am using C# and ADO.net 
Please can anyone correct me?",2
7695073,10/08/2011 05:54:13,571507,01/11/2011 16:14:04,817,48,What are steps to Profile a SQL Stored Procedure for execution counts and running time,"### Somewhat Related

http://stackoverflow.com/questions/303417/what-are-the-best-practices-in-writing-a-sql-stored-procedure

### Question
I have written a sql-xml stored procedure in Microsoft SQL server express 2005, now how does one find how many executions it can do in a second, time it takes for the same and how to do load testing on the same. Are there any open source tool for the same? Is there any pattern i can follow for improving the execution count? What performance bottlenecks do stored procedure generally face?",sql,sql-server,sql-server-2005,testing,stored-procedures,10/10/2011 11:14:23,not a real question,1,74,15,"What are steps to Profile a SQL Stored Procedure for execution counts and running time ### Somewhat Related

http://stackoverflow.com/questions/303417/what-are-the-best-practices-in-writing-a-sql-stored-procedure

### Question
I have written a sql-xml stored procedure in Microsoft SQL server express 2005, now how does one find how many executions it can do in a second, time it takes for the same and how to do load testing on the same. Are there any open source tool for the same? Is there any pattern i can follow for improving the execution count? What performance bottlenecks do stored procedure generally face?",5
8041243,11/07/2011 19:04:56,493125,11/01/2010 01:34:03,35,2,SQL for nvarchar 0 = '' & = 0?,"I was searching for integers in a nvarchar column. I noticed that if the row contains '' or 0 it is picked up if I search using just 0. 

I'm assuming there is some implicit conversion happening which is saying that 0 is equal to ''. Why does it assign two values?

Here is a test:


    --0 Test
    create table #0Test (Test nvarchar(20))

    GO
    insert INTO #0Test (Test)
	    SELECT ''
    UNION ALL
	    SELECT 0
    UNION ALL
	    SELECT ''

    Select *
    from #0Test

    Select *
    from #0Test
    Where test = 0

    SELECT *
    from #0Test
    Where test = '0'

    SELECT *
    from #0Test
    Where test = ''

    drop table #0Test ",sql,sql-server-2005,,,,,open,0,172,9,"SQL for nvarchar 0 = '' & = 0? I was searching for integers in a nvarchar column. I noticed that if the row contains '' or 0 it is picked up if I search using just 0. 

I'm assuming there is some implicit conversion happening which is saying that 0 is equal to ''. Why does it assign two values?

Here is a test:


    --0 Test
    create table #0Test (Test nvarchar(20))

    GO
    insert INTO #0Test (Test)
	    SELECT ''
    UNION ALL
	    SELECT 0
    UNION ALL
	    SELECT ''

    Select *
    from #0Test

    Select *
    from #0Test
    Where test = 0

    SELECT *
    from #0Test
    Where test = '0'

    SELECT *
    from #0Test
    Where test = ''

    drop table #0Test ",2
6822460,07/25/2011 21:15:22,825372,07/01/2011 18:45:45,13,0,Getting an ID inside a PostgreSQL transaction block,"I'm trying to wrap all my transactions that should be all-or-nothing into `BEGIN` and `COMMIT`, but I'm not sure how to do this in cases like the following.

I have 3 tables, one for images, one for `albums`, and one for the relations between them, namely `album_images`. The way the system works is that a user can create an album and fill it with his images in one operation. The SQL is as follows:

    BEGIN;
      INSERT INTO albums [...];  -- Create a new album row
      SELECT id AS album_id FROM albums WHERE [...];  -- Get that rows ID
      -- Now use album_id in the next statement
      INSERT INTO album_images (album_id, image_id) [...];
    COMMIT;

This is probably a common problem, I'm just not sure what to search for and I can't seem to find a solution in the documentation either.",sql,postgresql,transactions,,,,open,0,165,8,"Getting an ID inside a PostgreSQL transaction block I'm trying to wrap all my transactions that should be all-or-nothing into `BEGIN` and `COMMIT`, but I'm not sure how to do this in cases like the following.

I have 3 tables, one for images, one for `albums`, and one for the relations between them, namely `album_images`. The way the system works is that a user can create an album and fill it with his images in one operation. The SQL is as follows:

    BEGIN;
      INSERT INTO albums [...];  -- Create a new album row
      SELECT id AS album_id FROM albums WHERE [...];  -- Get that rows ID
      -- Now use album_id in the next statement
      INSERT INTO album_images (album_id, image_id) [...];
    COMMIT;

This is probably a common problem, I'm just not sure what to search for and I can't seem to find a solution in the documentation either.",3
9004566,01/25/2012 14:44:43,1157911,01/19/2012 07:25:09,1,0,Select column with values greater 0,"I have an item database with 8 tables. There I wanted to write a stored procedure to select all values greater 0 for a specified item ID.
My problem now is the statement to return only the columns where the value of the specified item is greater 0.

Basically i write a simple select which returns the following data:
http://www.got1.eu/upload/upimg/1327501679.jpg

When the Column ""Cold"" contains now a 0 value it returns the same structure like above but Cold is 0 instead of 120.

But if the value for Cold is 0 I don't want to get this column and discard it that I only get the remaining values:
http://www.got1.eu/upload/upimg/1327502046.jpg

I'm using MSSQL Management Studio 2008 and the Database is 2008 R2.

Thanks in advance and sorry for my poor english..",sql,sql-server,sql-server-2008,microsoft,sql-select,,open,0,122,6,"Select column with values greater 0 I have an item database with 8 tables. There I wanted to write a stored procedure to select all values greater 0 for a specified item ID.
My problem now is the statement to return only the columns where the value of the specified item is greater 0.

Basically i write a simple select which returns the following data:
http://www.got1.eu/upload/upimg/1327501679.jpg

When the Column ""Cold"" contains now a 0 value it returns the same structure like above but Cold is 0 instead of 120.

But if the value for Cold is 0 I don't want to get this column and discard it that I only get the remaining values:
http://www.got1.eu/upload/upimg/1327502046.jpg

I'm using MSSQL Management Studio 2008 and the Database is 2008 R2.

Thanks in advance and sorry for my poor english..",5
2552154,03/31/2010 10:42:47,255564,01/21/2010 07:29:43,70,0,SQL Server: How to trim all columns in a table,I have over 30 columns in my table (sql server 2008). Columns type are varchar(x). I know that in every column there is two extra spaces at the end of column value. How to use rtrim function for all columns and save this modification into this existing table?,sql,sql-server,sql-server-2008,string,,,open,0,48,10,SQL Server: How to trim all columns in a table I have over 30 columns in my table (sql server 2008). Columns type are varchar(x). I know that in every column there is two extra spaces at the end of column value. How to use rtrim function for all columns and save this modification into this existing table?,4
10085984,04/10/2012 09:13:42,824910,07/01/2011 13:04:53,22,0,Performance difference between Views and Temporary tables,"Is there any major difference in the performance of the Views and Temporary tables.  I have situation like to migrate data from one database to the other. I have to extract the source data from views to the tables in the destination db.

As there are no unique field in it I tried extracting the data from views into Temporary table and the process it to push the data into destination table. I don't find any major performance changes with respect to time.",sql,sql-server-2008,view,temporary-tables,,04/10/2012 15:57:16,not a real question,1,83,7,"Performance difference between Views and Temporary tables Is there any major difference in the performance of the Views and Temporary tables.  I have situation like to migrate data from one database to the other. I have to extract the source data from views to the tables in the destination db.

As there are no unique field in it I tried extracting the data from views into Temporary table and the process it to push the data into destination table. I don't find any major performance changes with respect to time.",4
8018030,11/05/2011 03:40:20,1008100,10/22/2011 03:05:49,14,0,If you accidentally drop your dept table where does the table structure go to?,If you accidentally drop your table where does the table structure go to? So if I accidentally deleted a table where does the structure go?,sql,oracle,,,,,open,0,25,14,If you accidentally drop your dept table where does the table structure go to? If you accidentally drop your table where does the table structure go to? So if I accidentally deleted a table where does the structure go?,2
9986951,04/03/2012 04:05:29,1235074,02/27/2012 07:51:07,71,3,What kind of database schema for heath record is the best?,"I'm going to build a application `Electronic Health Record` with very large database. But I not know which to choose the database schema for best. I have googled and found `hData` [project][1]. I want to consult your about this. Is it good for my system? Can you introduce to me another database schema is better than for Electronic Heath Record? 
Thank you so much!


  [1]: http://www.projecthdata.org",sql,database-schema,emr,,,04/03/2012 20:20:42,not constructive,1,67,11,"What kind of database schema for heath record is the best? I'm going to build a application `Electronic Health Record` with very large database. But I not know which to choose the database schema for best. I have googled and found `hData` [project][1]. I want to consult your about this. Is it good for my system? Can you introduce to me another database schema is better than for Electronic Heath Record? 
Thank you so much!


  [1]: http://www.projecthdata.org",3
7640992,10/03/2011 21:40:54,201113,11/02/2009 18:00:17,89,1,Where to put business logic?,"As the title suggests, I'm pondering whereabouts in my app to put some business logic and would be interested in some opinions. It is a simple app which downloads pages from the web and stores them in a sqlite database.

Business logic dictates that the app can only store one entry for a particular URL. I have set up the database so URLs have to be unique and currently rely on this to enforce the logic. I.e. if an attempt is made to insert a web page which is already stored, an error code is returned from the database and the user is informed.

However, I can't help feeling that the 'app layer' (java code) should know about this rule too - it doesn't feel right to rely on an sql error code for this.

I think I have three options:

1 have the database enforce the logic

2 have the app layer enforce the logic and remove the unique constraint on the database

3 have the logic in both places

No 2 is the least desirable to me as the database would not be in control of its own integrity. No 3 would require some duplication, but would mean the same database could be used in other apps and its integrity would be intact.

Would love to hear some views on this.

Thanks in advance,
Barry",sql,database,logic,,,10/03/2011 21:49:27,not constructive,1,217,5,"Where to put business logic? As the title suggests, I'm pondering whereabouts in my app to put some business logic and would be interested in some opinions. It is a simple app which downloads pages from the web and stores them in a sqlite database.

Business logic dictates that the app can only store one entry for a particular URL. I have set up the database so URLs have to be unique and currently rely on this to enforce the logic. I.e. if an attempt is made to insert a web page which is already stored, an error code is returned from the database and the user is informed.

However, I can't help feeling that the 'app layer' (java code) should know about this rule too - it doesn't feel right to rely on an sql error code for this.

I think I have three options:

1 have the database enforce the logic

2 have the app layer enforce the logic and remove the unique constraint on the database

3 have the logic in both places

No 2 is the least desirable to me as the database would not be in control of its own integrity. No 3 would require some duplication, but would mean the same database could be used in other apps and its integrity would be intact.

Would love to hear some views on this.

Thanks in advance,
Barry",3
5434809,03/25/2011 15:47:47,172396,06/24/2009 10:46:36,69,3,Sql Server - OUTER APPLY versus Sub-qeries,"Please consider the following 2 statements in Sql Server:

This one is using Nested sub-queries:

    	WITH cte AS
	(
		SELECT TOP 100 PERCENT *
		FROM Segments
		ORDER BY InvoiceDetailID, SegmentID
	)
	SELECT *, ReturnDate =
					(SELECT TOP 1 cte.DepartureInfo
						FROM cte
						WHERE seg.InvoiceDetailID = cte.InvoiceDetailID
							AND cte.SegmentID > seg.SegmentID), 
				DepartureCityCode =
					(SELECT TOP 1 cte.DepartureCityCode
						FROM cte
						WHERE seg.InvoiceDetailID = cte.InvoiceDetailID
							AND cte.SegmentID > seg.SegmentID)
	FROM Segments seg

And this uses an OUTER APPLY operator:

    	WITH cte AS
	(
		SELECT TOP 100 PERCENT *
		FROM Segments
		ORDER BY InvoiceDetailID, SegmentID
	)
	SELECT seg.*, t.DepartureInfo AS ReturnDate, t.DepartureCityCode
	FROM Segments seg OUTER APPLY (
					SELECT TOP 1 cte.DepartureInfo, cte.DepartureCityCode
					FROM cte
					WHERE seg.InvoiceDetailID = cte.InvoiceDetailID
							AND cte.SegmentID > seg.SegmentID
				) t
Which of these 2 would potentially perform better considering that both Segments table can potentially have millions of rows?

My intuition is OUTER APPLY would perform better.

A couple of more questions:

 1. Almost I am quite sure about this, but still wanted to confirm that in the first solution, the CTE would effectively be executed twice (because its referenced twice and CTE is expanded inline like a Macro).
 2. Would CTE be executed once for each row when used in the OUTER APPLY operator? Also would it be executed for each row when used in nested query in first statement??",sql,sql-server,common-table-expression,,,05/08/2012 20:19:57,not constructive,1,195,7,"Sql Server - OUTER APPLY versus Sub-qeries Please consider the following 2 statements in Sql Server:

This one is using Nested sub-queries:

    	WITH cte AS
	(
		SELECT TOP 100 PERCENT *
		FROM Segments
		ORDER BY InvoiceDetailID, SegmentID
	)
	SELECT *, ReturnDate =
					(SELECT TOP 1 cte.DepartureInfo
						FROM cte
						WHERE seg.InvoiceDetailID = cte.InvoiceDetailID
							AND cte.SegmentID > seg.SegmentID), 
				DepartureCityCode =
					(SELECT TOP 1 cte.DepartureCityCode
						FROM cte
						WHERE seg.InvoiceDetailID = cte.InvoiceDetailID
							AND cte.SegmentID > seg.SegmentID)
	FROM Segments seg

And this uses an OUTER APPLY operator:

    	WITH cte AS
	(
		SELECT TOP 100 PERCENT *
		FROM Segments
		ORDER BY InvoiceDetailID, SegmentID
	)
	SELECT seg.*, t.DepartureInfo AS ReturnDate, t.DepartureCityCode
	FROM Segments seg OUTER APPLY (
					SELECT TOP 1 cte.DepartureInfo, cte.DepartureCityCode
					FROM cte
					WHERE seg.InvoiceDetailID = cte.InvoiceDetailID
							AND cte.SegmentID > seg.SegmentID
				) t
Which of these 2 would potentially perform better considering that both Segments table can potentially have millions of rows?

My intuition is OUTER APPLY would perform better.

A couple of more questions:

 1. Almost I am quite sure about this, but still wanted to confirm that in the first solution, the CTE would effectively be executed twice (because its referenced twice and CTE is expanded inline like a Macro).
 2. Would CTE be executed once for each row when used in the OUTER APPLY operator? Also would it be executed for each row when used in nested query in first statement??",3
8241317,11/23/2011 11:21:51,1061754,11/23/2011 11:10:50,1,0,Sql Not IN is not retreving proper list i want,"I want to get the list of user's from a table, by comparing two column in same table.

The flow is like this 

1.While creating a user a random id will be generated, that id will be referred as supervisor id for some user's

2.I want to extract the list of user's who's id not in supervisor id column 

Can anyone get back to me ASAP

Thanks in Advance",sql,sql-server-2008,,,,11/23/2011 11:37:33,not a real question,1,66,10,"Sql Not IN is not retreving proper list i want I want to get the list of user's from a table, by comparing two column in same table.

The flow is like this 

1.While creating a user a random id will be generated, that id will be referred as supervisor id for some user's

2.I want to extract the list of user's who's id not in supervisor id column 

Can anyone get back to me ASAP

Thanks in Advance",2
3046847,06/15/2010 15:57:37,360642,06/07/2010 17:08:53,35,2,Counting the instances of customers,"Say that I have a table with one column named CustomerId.
The example of the instance of this table is :
    
    CustomerId
    14
    12
    11
    204
    14
    204

I want to write a query that counts the number of occurences of customer IDs.
At the end, I would like to have a result like this :

    CustomerId      NumberOfOccurences
    14              2
    12              1
    11              1
    204             2
    14              1

I cannot think of a way to do this. 
",sql,group-by,,,,,open,0,186,5,"Counting the instances of customers Say that I have a table with one column named CustomerId.
The example of the instance of this table is :
    
    CustomerId
    14
    12
    11
    204
    14
    204

I want to write a query that counts the number of occurences of customer IDs.
At the end, I would like to have a result like this :

    CustomerId      NumberOfOccurences
    14              2
    12              1
    11              1
    204             2
    14              1

I cannot think of a way to do this. 
",2
9100434,02/01/2012 17:33:19,1038812,11/10/2011 01:00:15,1183,64,Is it lazy or bad form to use select table_name.*,"I've heard that this is the wrong way to write queries in general but I wonder something people say to new users of SQL.

Is it really bad form or just plain lazy?

So, not to solicit opinion on this, what are some good reasons for it's use in queries besides not having to type out every field name. Also, do these reasons outweigh the harm in it's use?
",sql,,,,,02/01/2012 18:09:25,not constructive,1,67,10,"Is it lazy or bad form to use select table_name.* I've heard that this is the wrong way to write queries in general but I wonder something people say to new users of SQL.

Is it really bad form or just plain lazy?

So, not to solicit opinion on this, what are some good reasons for it's use in queries besides not having to type out every field name. Also, do these reasons outweigh the harm in it's use?
",1
9065507,01/30/2012 14:37:09,400440,02/10/2010 22:28:12,836,17,How to format Time Stored in DB2 as hhmmss,"I have time Stored in Db2 Field as hhmmss(41634) . I want to format this in SQL to HH:MM:SS. I have tried many thing like substr 
for ex: 
   
       select substr(fieldTME,1,1) as HOUR, substr(fieldTME,2,2) as Minute,
    substr(fieldTME,4,2) as Second from tbl1 where filed2 ='80404454'

with the above sql iam able to get 4 as hour 16 as minute  34 as seconds . But if the time is value is stored as (102333).The above sql does not work. Can i format the hour,minute and second in SQL as hh:mms:ss
",sql,db2,,,,02/20/2012 21:46:52,too localized,1,100,9,"How to format Time Stored in DB2 as hhmmss I have time Stored in Db2 Field as hhmmss(41634) . I want to format this in SQL to HH:MM:SS. I have tried many thing like substr 
for ex: 
   
       select substr(fieldTME,1,1) as HOUR, substr(fieldTME,2,2) as Minute,
    substr(fieldTME,4,2) as Second from tbl1 where filed2 ='80404454'

with the above sql iam able to get 4 as hour 16 as minute  34 as seconds . But if the time is value is stored as (102333).The above sql does not work. Can i format the hour,minute and second in SQL as hh:mms:ss
",2
11465393,07/13/2012 06:41:54,1434193,06/04/2012 00:33:44,34,0,add an amount into getdate,"i want to add 2 hours onto `getdate()`, in SQL SERVER for adding on one day it is 

    select getdate() + 1

but how is this done when wanting to add on hours onto `getdate()`?",sql,sql-server-2008,,,,07/13/2012 16:39:55,not a real question,1,38,5,"add an amount into getdate i want to add 2 hours onto `getdate()`, in SQL SERVER for adding on one day it is 

    select getdate() + 1

but how is this done when wanting to add on hours onto `getdate()`?",2
11031942,06/14/2012 11:17:11,1456051,06/14/2012 11:14:12,1,0,Analysis Services - Unary Operator in 2 dimensions?,"In my SQL Database I have created some Views for each of my wanted Dimensions. The views (different Values!) look like:

Parent | CHILD | UnaryOperator

xxxx       yyyy        +

yyyy    |  dddd |     -

............................

When I now create one dimension(set attribute for unaryOperatorColumn,...) in my Analysis Services everytthing works fine. The Measure is calculated correctly by the unary operators.

But if I create another dimension (based on another View!) and create the Cube the measure for both dimensions are wrong.

Is it my fault or isn`t it possible?

",sql,sql-server,sql-server-2005,ssas,analysis,,open,0,103,8,"Analysis Services - Unary Operator in 2 dimensions? In my SQL Database I have created some Views for each of my wanted Dimensions. The views (different Values!) look like:

Parent | CHILD | UnaryOperator

xxxx       yyyy        +

yyyy    |  dddd |     -

............................

When I now create one dimension(set attribute for unaryOperatorColumn,...) in my Analysis Services everytthing works fine. The Measure is calculated correctly by the unary operators.

But if I create another dimension (based on another View!) and create the Cube the measure for both dimensions are wrong.

Is it my fault or isn`t it possible?

",5
7867122,10/23/2011 15:36:28,872501,08/01/2011 09:11:04,24,0,Oracle query performance issue,"I have a table discussion of which structure is following:

Table name: discussion,

    Id      name       parent_id   root_id  ...other columns
     1   discussion1      0            0
     2   discussion2      1            1
     3   discussion3      2            1
     4   discussion4      3            1
     5   discussion5      4            1

id was defined as PK, parent_id and root_id has been indexed.

these rows of table was built as a hierarchical relationship(sort of parent->child), please note I have a column root_id which is used to describe which rows are in the same tree. 


I written two sql to get the tree:


**SQL 1** 
      
      SELECT * 
        from reply 
       start with (parent_Id=0 AND id=?) 
     connect by prior Id=parent_Id
**SQL 2** 

     SELECT * FROM (
               SELECT * FROM discussion WHERE root_id = ? or id = ?
              )START WITH (parent_Id=0 AND id=?) connect by prior Id=parent_Id


After my test, if the rows are around 4000, SQL 1 did a little bit better than SQL2.
But if table discussion has very large data, SQL 2 did much better than SQL1.

when we have 300 thousands rows, query plan reported the cost of SQL 1 is 22126, The cost of SQL 2 is 6.

Is anybody have more good idea than above, or can help me to explain it why?

Here is query plan for **SQL 1** when we have 300 thousands rows.
 

    GENERAL INFORMATION SECTION
    -------------------------------------------------------------------------------
    Tuning Task Name   : staName52149
    Tuning Task Owner  : CISCO
    Tuning Task ID     : 54
    Workload Type      : Single SQL Statement
    Execution Count    : 1
    Current Execution  : EXEC_44
    Execution Type     : TUNE SQL
    Scope              : COMPREHENSIVE
    Time Limit(seconds): 1800
    Completion Status  : COMPLETED
    Started at         : 10/23/2011 23:23:31
    Completed at       : 10/23/2011 23:23:59
    
    -------------------------------------------------------------------------------
    Schema Name: CISCO
    SQL ID     : davhv6p4x6bu2
    SQL Text   : SELECT * from discussion start with (parent_Id=0 AND id=6587)
                 connect by prior Id=parent_Id
    
    -------------------------------------------------------------------------------
    FINDINGS SECTION (1 finding)
    -------------------------------------------------------------------------------
    
    1- SQL Profile Finding (see explain plans section below)
    --------------------------------------------------------
      A potentially better execution plan was found for this statement.
    
      Recommendation (estimated benefit: 99.99%)
      ------------------------------------------
      - Consider accepting the recommended SQL profile.
        execute dbms_sqltune.accept_sql_profile(task_name => 'staName52149',
                task_owner => 'CISCO', replace => TRUE);
    
      Validation results
      ------------------
      The SQL profile was tested by executing both its plan and the original plan
      and measuring their respective execution statistics. A plan may have been
      only partially executed if the other could be run to completion in less time.
    
                               Original Plan  With SQL Profile  % Improved
                               -------------  ----------------  ----------
      Completion Status:            COMPLETE          COMPLETE
      Elapsed Time(us):            14251990               121      99.99 %
      CPU Time(us):                 3463222                 0        100 %
      User I/O Time(us):           10821745                 0        100 %
      Buffer Gets:                   678361                 6      99.99 %
      Physical Read Requests:          1013                 0        100 %
      Physical Write Requests:         1081                 0        100 %
      Physical Read Bytes:        234168320                 0        100 %
      Physical Write Bytes:       223756288                 0        100 %
      Rows Processed:                     1                 1 
      Fetches:                            1                 1 
      Executions:                         1                 1 
    
      Notes
      -----
      1. The SQL profile plan was first executed to warm the buffer cache.
      2. Statistics for the SQL profile plan were averaged over next 9 executions.
    
    -------------------------------------------------------------------------------
    EXPLAIN PLANS SECTION
    -------------------------------------------------------------------------------
    
    1- Original
    -----------
    Plan hash value: 2811036397
    
     
    ------------------------------------------------------------------------------------------------------
    | Id  | Operation                               | Name       | Rows  | Bytes | Cost (%CPU)| Time     |
    ------------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT                        |            |   348K|  2770M| 22162  (82)| 00:04:26 |
    |*  1 |  CONNECT BY NO FILTERING WITH START-WITH|            |       |       |            |          |
    |   2 |   TABLE ACCESS FULL                     | DISCUSSION |   348K|    79M|  4108   (1)| 00:00:50 |
    ------------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1
       2 - SEL$2 / DISCUSSION@SEL$2
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
           filter(""PARENT_ID""=0 AND ""ID""=6587)
     
    Column Projection Information (identified by operation id):
    -----------------------------------------------------------
     
       1 - ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ID""[NUMBER,22], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], STRDEF[22], 
           STRDEF[150], STRDEF[7], STRDEF[7], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[22], 
           STRDEF[4000], STRDEF[22], STRDEF[4000], STRDEF[7], STRDEF[22], STRDEF[32], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[7], STRDEF[7], PRIOR NULL[22], LEVEL[4]
       2 - ""ID""[NUMBER,22], ""DISCUSSION"".""CLASS""[NUMBER,22], ""DISCUSSION"".""SUBCLASS""[NUMBER,22], 
           ""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ROOT_ID""[NUMBER,22], 
           ""DISCUSSION"".""MESSAGE""[VARCHAR2,4000], ""DISCUSSION"".""STATUS""[NUMBER,22], 
           ""DISCUSSION"".""PRIORITY""[NUMBER,22], ""DISCUSSION"".""AUTO_NUMBER""[VARCHAR2,150], 
           ""DISCUSSION"".""CREATE_DATE""[DATE,7], ""DISCUSSION"".""CLOSE_DATE""[DATE,7], 
           ""DISCUSSION"".""CLOSE_COMMENTS""[VARCHAR2,4000], ""DISCUSSION"".""ORGANIZATION""[NUMBER,22], 
           ""DISCUSSION"".""TYPE""[NUMBER,22], ""DISCUSSION"".""CREATOR""[NUMBER,22], 
           ""DISCUSSION"".""SUBJECT""[VARCHAR2,4000], ""DISCUSSION"".""REPLIES""[NUMBER,22], 
           ""DISCUSSION"".""NOTIFYLIST""[VARCHAR2,4000], ""DISCUSSION"".""LAST_REPLY_DATE""[DATE,7], 
           ""DISCUSSION"".""DELETE_FLAG""[NUMBER,22], ""DISCUSSION"".""FLAGS""[VARCHAR2,32], 
           ""DISCUSSION"".""PREVIEW_TEXT""[NUMBER,22], ""DISCUSSION"".""FILTER""[NUMBER,22], 
           ""DISCUSSION"".""OBJVERSION""[NUMBER,22], ""DISCUSSION"".""CREATED""[DATE,7], 
           ""DISCUSSION"".""LAST_UPD""[DATE,7]
    
    2- Original With Adjusted Cost
    ------------------------------
    Plan hash value: 2811036397
    
     
    ------------------------------------------------------------------------------------------------------
    | Id  | Operation                               | Name       | Rows  | Bytes | Cost (%CPU)| Time     |
    ------------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT                        |            |   348K|  2770M| 22162  (82)| 00:04:26 |
    |*  1 |  CONNECT BY NO FILTERING WITH START-WITH|            |       |       |            |          |
    |   2 |   TABLE ACCESS FULL                     | DISCUSSION |   348K|    79M|  4108   (1)| 00:00:50 |
    ------------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1
       2 - SEL$2 / DISCUSSION@SEL$2
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
           filter(""PARENT_ID""=0 AND ""ID""=6587)
     
    Column Projection Information (identified by operation id):
    -----------------------------------------------------------
     
       1 - ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ID""[NUMBER,22], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], STRDEF[22], 
           STRDEF[150], STRDEF[7], STRDEF[7], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[22], 
           STRDEF[4000], STRDEF[22], STRDEF[4000], STRDEF[7], STRDEF[22], STRDEF[32], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[7], STRDEF[7], PRIOR NULL[22], LEVEL[4]
       2 - ""ID""[NUMBER,22], ""DISCUSSION"".""CLASS""[NUMBER,22], ""DISCUSSION"".""SUBCLASS""[NUMBER,22], 
           ""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ROOT_ID""[NUMBER,22], 
           ""DISCUSSION"".""MESSAGE""[VARCHAR2,4000], ""DISCUSSION"".""STATUS""[NUMBER,22], 
           ""DISCUSSION"".""PRIORITY""[NUMBER,22], ""DISCUSSION"".""AUTO_NUMBER""[VARCHAR2,150], 
           ""DISCUSSION"".""CREATE_DATE""[DATE,7], ""DISCUSSION"".""CLOSE_DATE""[DATE,7], 
           ""DISCUSSION"".""CLOSE_COMMENTS""[VARCHAR2,4000], ""DISCUSSION"".""ORGANIZATION""[NUMBER,22], 
           ""DISCUSSION"".""TYPE""[NUMBER,22], ""DISCUSSION"".""CREATOR""[NUMBER,22], 
           ""DISCUSSION"".""SUBJECT""[VARCHAR2,4000], ""DISCUSSION"".""REPLIES""[NUMBER,22], 
           ""DISCUSSION"".""NOTIFYLIST""[VARCHAR2,4000], ""DISCUSSION"".""LAST_REPLY_DATE""[DATE,7], 
           ""DISCUSSION"".""DELETE_FLAG""[NUMBER,22], ""DISCUSSION"".""FLAGS""[VARCHAR2,32], 
           ""DISCUSSION"".""PREVIEW_TEXT""[NUMBER,22], ""DISCUSSION"".""FILTER""[NUMBER,22], 
           ""DISCUSSION"".""OBJVERSION""[NUMBER,22], ""DISCUSSION"".""CREATED""[DATE,7], 
           ""DISCUSSION"".""LAST_UPD""[DATE,7]
    
    3- Using SQL Profile
    --------------------
    Plan hash value: 3458076016
    
     
    ---------------------------------------------------------------------------------------------------
    | Id  | Operation                     | Name              | Rows  | Bytes | Cost (%CPU)| Time     |
    ---------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT              |                   |     2 | 16686 |    11  (28)| 00:00:01 |
    |*  1 |  CONNECT BY WITH FILTERING    |                   |       |       |            |          |
    |*  2 |   TABLE ACCESS BY INDEX ROWID | DISCUSSION        |     1 |   240 |     3   (0)| 00:00:01 |
    |*  3 |    INDEX UNIQUE SCAN          | DISCUSSION_PK     |     1 |       |     2   (0)| 00:00:01 |
    |   4 |   NESTED LOOPS                |                   |     1 |   253 |     5   (0)| 00:00:01 |
    |   5 |    CONNECT BY PUMP            |                   |       |       |            |          |
    |   6 |    TABLE ACCESS BY INDEX ROWID| DISCUSSION        |     1 |   240 |     3   (0)| 00:00:01 |
    |*  7 |     INDEX RANGE SCAN          | DISC_IDX_PARENTID |     1 |       |     2   (0)| 00:00:01 |
    ---------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1
       2 - SEL$4 / DISCUSSION@SEL$4
       3 - SEL$4 / DISCUSSION@SEL$4
       4 - SEL$3
       6 - SEL$3 / DISCUSSION@SEL$3
       7 - SEL$3 / DISCUSSION@SEL$3
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
       2 - filter(""PARENT_ID""=0)
       3 - access(""ID""=6587)
       7 - access(""connect$_by$_pump$_002"".""prior Id""=""PARENT_ID"")


Here is query plan for **SQL 2** when we have 300 thousands rows.


    GENERAL INFORMATION SECTION
    -------------------------------------------------------------------------------
    Tuning Task Name   : staName64031
    Tuning Task Owner  : CISCO
    Tuning Task ID     : 55
    Workload Type      : Single SQL Statement
    Execution Count    : 1
    Current Execution  : EXEC_45
    Execution Type     : TUNE SQL
    Scope              : COMPREHENSIVE
    Time Limit(seconds): 1800
    Completion Status  : COMPLETED
    Started at         : 10/23/2011 23:30:22
    Completed at       : 10/23/2011 23:30:26
    
    -------------------------------------------------------------------------------
    Schema Name: CISCO
    SQL ID     : c741jfryv5m98
    SQL Text   : SELECT * FROM (
                                SELECT * FROM discussion WHERE root_id = 6587 or
                 id = 6587
                               )Start With (Parent_Id=0 And Id=6587) Connect By
                 Prior Id=Parent_Id
    
    -------------------------------------------------------------------------------
    There are no recommendations to improve the statement.
    
    -------------------------------------------------------------------------------
    EXPLAIN PLANS SECTION
    -------------------------------------------------------------------------------
    
    1- Original
    -----------
    Plan hash value: 1202872009
    
     
    -----------------------------------------------------------------------------------------------------------
    | Id  | Operation                               | Name            | Rows  | Bytes | Cost (%CPU)| Time     |
    -----------------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT                        |                 |     2 | 16686 |     6  (17)| 00:00:01 |
    |*  1 |  CONNECT BY NO FILTERING WITH START-WITH|                 |       |       |            |          |
    |   2 |   TABLE ACCESS BY INDEX ROWID           | DISCUSSION      |     2 |   480 |     5   (0)| 00:00:01 |
    |   3 |    BITMAP CONVERSION TO ROWIDS          |                 |       |       |            |          |
    |   4 |     BITMAP OR                           |                 |       |       |            |          |
    |   5 |      BITMAP CONVERSION FROM ROWIDS      |                 |       |       |            |          |
    |*  6 |       INDEX RANGE SCAN                  | DISCUSSION_PK   |       |       |     2   (0)| 00:00:01 |
    |   7 |      BITMAP CONVERSION FROM ROWIDS      |                 |       |       |            |          |
    |*  8 |       INDEX RANGE SCAN                  | DISC_IDX_ROOTID |       |       |     3   (0)| 00:00:01 |
    -----------------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1       
       2 - SEL$E029B2FF / DISCUSSION@SEL$5
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
           filter(""DISCUSSION"".""PARENT_ID""=0 AND ""DISCUSSION"".""ID""=6587)
       6 - access(""ID""=6587)
       8 - access(""ROOT_ID""=6587)
     
    Column Projection Information (identified by operation id):
    -----------------------------------------------------------
     
       1 - ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ID""[NUMBER,22], STRDEF[22], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[150], STRDEF[7], 
           STRDEF[7], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], 
           STRDEF[4000], STRDEF[7], STRDEF[22], STRDEF[32], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[7], 
           STRDEF[7], PRIOR NULL[22], LEVEL[4]
       2 - ""DISCUSSION"".ROWID[ROWID,10], ""ID""[NUMBER,22], ""DISCUSSION"".""CLASS""[NUMBER,22], 
           ""DISCUSSION"".""SUBCLASS""[NUMBER,22], ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""ROOT_ID""[NUMBER,22], 
           ""DISCUSSION"".""MESSAGE""[VARCHAR2,4000], ""DISCUSSION"".""STATUS""[NUMBER,22], 
           ""DISCUSSION"".""PRIORITY""[NUMBER,22], ""DISCUSSION"".""AUTO_NUMBER""[VARCHAR2,150], 
           ""DISCUSSION"".""CREATE_DATE""[DATE,7], ""DISCUSSION"".""CLOSE_DATE""[DATE,7], 
           ""DISCUSSION"".""CLOSE_COMMENTS""[VARCHAR2,4000], ""DISCUSSION"".""ORGANIZATION""[NUMBER,22], 
           ""DISCUSSION"".""TYPE""[NUMBER,22], ""DISCUSSION"".""CREATOR""[NUMBER,22], 
           ""DISCUSSION"".""SUBJECT""[VARCHAR2,4000], ""DISCUSSION"".""REPLIES""[NUMBER,22], 
           ""DISCUSSION"".""NOTIFYLIST""[VARCHAR2,4000], ""DISCUSSION"".""LAST_REPLY_DATE""[DATE,7], 
           ""DISCUSSION"".""DELETE_FLAG""[NUMBER,22], ""DISCUSSION"".""FLAGS""[VARCHAR2,32], 
           ""DISCUSSION"".""PREVIEW_TEXT""[NUMBER,22], ""DISCUSSION"".""FILTER""[NUMBER,22], 
           ""DISCUSSION"".""OBJVERSION""[NUMBER,22], ""DISCUSSION"".""CREATED""[DATE,7], 
           ""DISCUSSION"".""LAST_UPD""[DATE,7]
       3 - ""DISCUSSION"".ROWID[ROWID,10]
       4 - STRDEF[BM VAR, 10], STRDEF[BM VAR, 10], STRDEF[BM VAR, 16116]
       5 - STRDEF[BM VAR, 10], STRDEF[BM VAR, 10], STRDEF[BM VAR, 16116]
       6 - ""DISCUSSION"".ROWID[ROWID,10]
       7 - STRDEF[BM VAR, 10], STRDEF[BM VAR, 10], STRDEF[BM VAR, 16116]
       8 - ""DISCUSSION"".ROWID[ROWID,10]
    
    -------------------------------------------------------------------------------
    
         ",sql,oracle,oracle10g,oracle11g,,,open,0,5046,4,"Oracle query performance issue I have a table discussion of which structure is following:

Table name: discussion,

    Id      name       parent_id   root_id  ...other columns
     1   discussion1      0            0
     2   discussion2      1            1
     3   discussion3      2            1
     4   discussion4      3            1
     5   discussion5      4            1

id was defined as PK, parent_id and root_id has been indexed.

these rows of table was built as a hierarchical relationship(sort of parent->child), please note I have a column root_id which is used to describe which rows are in the same tree. 


I written two sql to get the tree:


**SQL 1** 
      
      SELECT * 
        from reply 
       start with (parent_Id=0 AND id=?) 
     connect by prior Id=parent_Id
**SQL 2** 

     SELECT * FROM (
               SELECT * FROM discussion WHERE root_id = ? or id = ?
              )START WITH (parent_Id=0 AND id=?) connect by prior Id=parent_Id


After my test, if the rows are around 4000, SQL 1 did a little bit better than SQL2.
But if table discussion has very large data, SQL 2 did much better than SQL1.

when we have 300 thousands rows, query plan reported the cost of SQL 1 is 22126, The cost of SQL 2 is 6.

Is anybody have more good idea than above, or can help me to explain it why?

Here is query plan for **SQL 1** when we have 300 thousands rows.
 

    GENERAL INFORMATION SECTION
    -------------------------------------------------------------------------------
    Tuning Task Name   : staName52149
    Tuning Task Owner  : CISCO
    Tuning Task ID     : 54
    Workload Type      : Single SQL Statement
    Execution Count    : 1
    Current Execution  : EXEC_44
    Execution Type     : TUNE SQL
    Scope              : COMPREHENSIVE
    Time Limit(seconds): 1800
    Completion Status  : COMPLETED
    Started at         : 10/23/2011 23:23:31
    Completed at       : 10/23/2011 23:23:59
    
    -------------------------------------------------------------------------------
    Schema Name: CISCO
    SQL ID     : davhv6p4x6bu2
    SQL Text   : SELECT * from discussion start with (parent_Id=0 AND id=6587)
                 connect by prior Id=parent_Id
    
    -------------------------------------------------------------------------------
    FINDINGS SECTION (1 finding)
    -------------------------------------------------------------------------------
    
    1- SQL Profile Finding (see explain plans section below)
    --------------------------------------------------------
      A potentially better execution plan was found for this statement.
    
      Recommendation (estimated benefit: 99.99%)
      ------------------------------------------
      - Consider accepting the recommended SQL profile.
        execute dbms_sqltune.accept_sql_profile(task_name => 'staName52149',
                task_owner => 'CISCO', replace => TRUE);
    
      Validation results
      ------------------
      The SQL profile was tested by executing both its plan and the original plan
      and measuring their respective execution statistics. A plan may have been
      only partially executed if the other could be run to completion in less time.
    
                               Original Plan  With SQL Profile  % Improved
                               -------------  ----------------  ----------
      Completion Status:            COMPLETE          COMPLETE
      Elapsed Time(us):            14251990               121      99.99 %
      CPU Time(us):                 3463222                 0        100 %
      User I/O Time(us):           10821745                 0        100 %
      Buffer Gets:                   678361                 6      99.99 %
      Physical Read Requests:          1013                 0        100 %
      Physical Write Requests:         1081                 0        100 %
      Physical Read Bytes:        234168320                 0        100 %
      Physical Write Bytes:       223756288                 0        100 %
      Rows Processed:                     1                 1 
      Fetches:                            1                 1 
      Executions:                         1                 1 
    
      Notes
      -----
      1. The SQL profile plan was first executed to warm the buffer cache.
      2. Statistics for the SQL profile plan were averaged over next 9 executions.
    
    -------------------------------------------------------------------------------
    EXPLAIN PLANS SECTION
    -------------------------------------------------------------------------------
    
    1- Original
    -----------
    Plan hash value: 2811036397
    
     
    ------------------------------------------------------------------------------------------------------
    | Id  | Operation                               | Name       | Rows  | Bytes | Cost (%CPU)| Time     |
    ------------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT                        |            |   348K|  2770M| 22162  (82)| 00:04:26 |
    |*  1 |  CONNECT BY NO FILTERING WITH START-WITH|            |       |       |            |          |
    |   2 |   TABLE ACCESS FULL                     | DISCUSSION |   348K|    79M|  4108   (1)| 00:00:50 |
    ------------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1
       2 - SEL$2 / DISCUSSION@SEL$2
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
           filter(""PARENT_ID""=0 AND ""ID""=6587)
     
    Column Projection Information (identified by operation id):
    -----------------------------------------------------------
     
       1 - ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ID""[NUMBER,22], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], STRDEF[22], 
           STRDEF[150], STRDEF[7], STRDEF[7], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[22], 
           STRDEF[4000], STRDEF[22], STRDEF[4000], STRDEF[7], STRDEF[22], STRDEF[32], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[7], STRDEF[7], PRIOR NULL[22], LEVEL[4]
       2 - ""ID""[NUMBER,22], ""DISCUSSION"".""CLASS""[NUMBER,22], ""DISCUSSION"".""SUBCLASS""[NUMBER,22], 
           ""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ROOT_ID""[NUMBER,22], 
           ""DISCUSSION"".""MESSAGE""[VARCHAR2,4000], ""DISCUSSION"".""STATUS""[NUMBER,22], 
           ""DISCUSSION"".""PRIORITY""[NUMBER,22], ""DISCUSSION"".""AUTO_NUMBER""[VARCHAR2,150], 
           ""DISCUSSION"".""CREATE_DATE""[DATE,7], ""DISCUSSION"".""CLOSE_DATE""[DATE,7], 
           ""DISCUSSION"".""CLOSE_COMMENTS""[VARCHAR2,4000], ""DISCUSSION"".""ORGANIZATION""[NUMBER,22], 
           ""DISCUSSION"".""TYPE""[NUMBER,22], ""DISCUSSION"".""CREATOR""[NUMBER,22], 
           ""DISCUSSION"".""SUBJECT""[VARCHAR2,4000], ""DISCUSSION"".""REPLIES""[NUMBER,22], 
           ""DISCUSSION"".""NOTIFYLIST""[VARCHAR2,4000], ""DISCUSSION"".""LAST_REPLY_DATE""[DATE,7], 
           ""DISCUSSION"".""DELETE_FLAG""[NUMBER,22], ""DISCUSSION"".""FLAGS""[VARCHAR2,32], 
           ""DISCUSSION"".""PREVIEW_TEXT""[NUMBER,22], ""DISCUSSION"".""FILTER""[NUMBER,22], 
           ""DISCUSSION"".""OBJVERSION""[NUMBER,22], ""DISCUSSION"".""CREATED""[DATE,7], 
           ""DISCUSSION"".""LAST_UPD""[DATE,7]
    
    2- Original With Adjusted Cost
    ------------------------------
    Plan hash value: 2811036397
    
     
    ------------------------------------------------------------------------------------------------------
    | Id  | Operation                               | Name       | Rows  | Bytes | Cost (%CPU)| Time     |
    ------------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT                        |            |   348K|  2770M| 22162  (82)| 00:04:26 |
    |*  1 |  CONNECT BY NO FILTERING WITH START-WITH|            |       |       |            |          |
    |   2 |   TABLE ACCESS FULL                     | DISCUSSION |   348K|    79M|  4108   (1)| 00:00:50 |
    ------------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1
       2 - SEL$2 / DISCUSSION@SEL$2
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
           filter(""PARENT_ID""=0 AND ""ID""=6587)
     
    Column Projection Information (identified by operation id):
    -----------------------------------------------------------
     
       1 - ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ID""[NUMBER,22], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], STRDEF[22], 
           STRDEF[150], STRDEF[7], STRDEF[7], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[22], 
           STRDEF[4000], STRDEF[22], STRDEF[4000], STRDEF[7], STRDEF[22], STRDEF[32], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[7], STRDEF[7], PRIOR NULL[22], LEVEL[4]
       2 - ""ID""[NUMBER,22], ""DISCUSSION"".""CLASS""[NUMBER,22], ""DISCUSSION"".""SUBCLASS""[NUMBER,22], 
           ""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ROOT_ID""[NUMBER,22], 
           ""DISCUSSION"".""MESSAGE""[VARCHAR2,4000], ""DISCUSSION"".""STATUS""[NUMBER,22], 
           ""DISCUSSION"".""PRIORITY""[NUMBER,22], ""DISCUSSION"".""AUTO_NUMBER""[VARCHAR2,150], 
           ""DISCUSSION"".""CREATE_DATE""[DATE,7], ""DISCUSSION"".""CLOSE_DATE""[DATE,7], 
           ""DISCUSSION"".""CLOSE_COMMENTS""[VARCHAR2,4000], ""DISCUSSION"".""ORGANIZATION""[NUMBER,22], 
           ""DISCUSSION"".""TYPE""[NUMBER,22], ""DISCUSSION"".""CREATOR""[NUMBER,22], 
           ""DISCUSSION"".""SUBJECT""[VARCHAR2,4000], ""DISCUSSION"".""REPLIES""[NUMBER,22], 
           ""DISCUSSION"".""NOTIFYLIST""[VARCHAR2,4000], ""DISCUSSION"".""LAST_REPLY_DATE""[DATE,7], 
           ""DISCUSSION"".""DELETE_FLAG""[NUMBER,22], ""DISCUSSION"".""FLAGS""[VARCHAR2,32], 
           ""DISCUSSION"".""PREVIEW_TEXT""[NUMBER,22], ""DISCUSSION"".""FILTER""[NUMBER,22], 
           ""DISCUSSION"".""OBJVERSION""[NUMBER,22], ""DISCUSSION"".""CREATED""[DATE,7], 
           ""DISCUSSION"".""LAST_UPD""[DATE,7]
    
    3- Using SQL Profile
    --------------------
    Plan hash value: 3458076016
    
     
    ---------------------------------------------------------------------------------------------------
    | Id  | Operation                     | Name              | Rows  | Bytes | Cost (%CPU)| Time     |
    ---------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT              |                   |     2 | 16686 |    11  (28)| 00:00:01 |
    |*  1 |  CONNECT BY WITH FILTERING    |                   |       |       |            |          |
    |*  2 |   TABLE ACCESS BY INDEX ROWID | DISCUSSION        |     1 |   240 |     3   (0)| 00:00:01 |
    |*  3 |    INDEX UNIQUE SCAN          | DISCUSSION_PK     |     1 |       |     2   (0)| 00:00:01 |
    |   4 |   NESTED LOOPS                |                   |     1 |   253 |     5   (0)| 00:00:01 |
    |   5 |    CONNECT BY PUMP            |                   |       |       |            |          |
    |   6 |    TABLE ACCESS BY INDEX ROWID| DISCUSSION        |     1 |   240 |     3   (0)| 00:00:01 |
    |*  7 |     INDEX RANGE SCAN          | DISC_IDX_PARENTID |     1 |       |     2   (0)| 00:00:01 |
    ---------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1
       2 - SEL$4 / DISCUSSION@SEL$4
       3 - SEL$4 / DISCUSSION@SEL$4
       4 - SEL$3
       6 - SEL$3 / DISCUSSION@SEL$3
       7 - SEL$3 / DISCUSSION@SEL$3
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
       2 - filter(""PARENT_ID""=0)
       3 - access(""ID""=6587)
       7 - access(""connect$_by$_pump$_002"".""prior Id""=""PARENT_ID"")


Here is query plan for **SQL 2** when we have 300 thousands rows.


    GENERAL INFORMATION SECTION
    -------------------------------------------------------------------------------
    Tuning Task Name   : staName64031
    Tuning Task Owner  : CISCO
    Tuning Task ID     : 55
    Workload Type      : Single SQL Statement
    Execution Count    : 1
    Current Execution  : EXEC_45
    Execution Type     : TUNE SQL
    Scope              : COMPREHENSIVE
    Time Limit(seconds): 1800
    Completion Status  : COMPLETED
    Started at         : 10/23/2011 23:30:22
    Completed at       : 10/23/2011 23:30:26
    
    -------------------------------------------------------------------------------
    Schema Name: CISCO
    SQL ID     : c741jfryv5m98
    SQL Text   : SELECT * FROM (
                                SELECT * FROM discussion WHERE root_id = 6587 or
                 id = 6587
                               )Start With (Parent_Id=0 And Id=6587) Connect By
                 Prior Id=Parent_Id
    
    -------------------------------------------------------------------------------
    There are no recommendations to improve the statement.
    
    -------------------------------------------------------------------------------
    EXPLAIN PLANS SECTION
    -------------------------------------------------------------------------------
    
    1- Original
    -----------
    Plan hash value: 1202872009
    
     
    -----------------------------------------------------------------------------------------------------------
    | Id  | Operation                               | Name            | Rows  | Bytes | Cost (%CPU)| Time     |
    -----------------------------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT                        |                 |     2 | 16686 |     6  (17)| 00:00:01 |
    |*  1 |  CONNECT BY NO FILTERING WITH START-WITH|                 |       |       |            |          |
    |   2 |   TABLE ACCESS BY INDEX ROWID           | DISCUSSION      |     2 |   480 |     5   (0)| 00:00:01 |
    |   3 |    BITMAP CONVERSION TO ROWIDS          |                 |       |       |            |          |
    |   4 |     BITMAP OR                           |                 |       |       |            |          |
    |   5 |      BITMAP CONVERSION FROM ROWIDS      |                 |       |       |            |          |
    |*  6 |       INDEX RANGE SCAN                  | DISCUSSION_PK   |       |       |     2   (0)| 00:00:01 |
    |   7 |      BITMAP CONVERSION FROM ROWIDS      |                 |       |       |            |          |
    |*  8 |       INDEX RANGE SCAN                  | DISC_IDX_ROOTID |       |       |     3   (0)| 00:00:01 |
    -----------------------------------------------------------------------------------------------------------
     
    Query Block Name / Object Alias (identified by operation id):
    -------------------------------------------------------------
     
       1 - SEL$1       
       2 - SEL$E029B2FF / DISCUSSION@SEL$5
     
    Predicate Information (identified by operation id):
    ---------------------------------------------------
     
       1 - access(""DISCUSSION"".""PARENT_ID""=PRIOR NULL)
           filter(""DISCUSSION"".""PARENT_ID""=0 AND ""DISCUSSION"".""ID""=6587)
       6 - access(""ID""=6587)
       8 - access(""ROOT_ID""=6587)
     
    Column Projection Information (identified by operation id):
    -----------------------------------------------------------
     
       1 - ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""DISCUSSION"".""ID""[NUMBER,22], STRDEF[22], STRDEF[22], 
           STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[150], STRDEF[7], 
           STRDEF[7], STRDEF[4000], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[4000], STRDEF[22], 
           STRDEF[4000], STRDEF[7], STRDEF[22], STRDEF[32], STRDEF[22], STRDEF[22], STRDEF[22], STRDEF[7], 
           STRDEF[7], PRIOR NULL[22], LEVEL[4]
       2 - ""DISCUSSION"".ROWID[ROWID,10], ""ID""[NUMBER,22], ""DISCUSSION"".""CLASS""[NUMBER,22], 
           ""DISCUSSION"".""SUBCLASS""[NUMBER,22], ""DISCUSSION"".""PARENT_ID""[NUMBER,22], ""ROOT_ID""[NUMBER,22], 
           ""DISCUSSION"".""MESSAGE""[VARCHAR2,4000], ""DISCUSSION"".""STATUS""[NUMBER,22], 
           ""DISCUSSION"".""PRIORITY""[NUMBER,22], ""DISCUSSION"".""AUTO_NUMBER""[VARCHAR2,150], 
           ""DISCUSSION"".""CREATE_DATE""[DATE,7], ""DISCUSSION"".""CLOSE_DATE""[DATE,7], 
           ""DISCUSSION"".""CLOSE_COMMENTS""[VARCHAR2,4000], ""DISCUSSION"".""ORGANIZATION""[NUMBER,22], 
           ""DISCUSSION"".""TYPE""[NUMBER,22], ""DISCUSSION"".""CREATOR""[NUMBER,22], 
           ""DISCUSSION"".""SUBJECT""[VARCHAR2,4000], ""DISCUSSION"".""REPLIES""[NUMBER,22], 
           ""DISCUSSION"".""NOTIFYLIST""[VARCHAR2,4000], ""DISCUSSION"".""LAST_REPLY_DATE""[DATE,7], 
           ""DISCUSSION"".""DELETE_FLAG""[NUMBER,22], ""DISCUSSION"".""FLAGS""[VARCHAR2,32], 
           ""DISCUSSION"".""PREVIEW_TEXT""[NUMBER,22], ""DISCUSSION"".""FILTER""[NUMBER,22], 
           ""DISCUSSION"".""OBJVERSION""[NUMBER,22], ""DISCUSSION"".""CREATED""[DATE,7], 
           ""DISCUSSION"".""LAST_UPD""[DATE,7]
       3 - ""DISCUSSION"".ROWID[ROWID,10]
       4 - STRDEF[BM VAR, 10], STRDEF[BM VAR, 10], STRDEF[BM VAR, 16116]
       5 - STRDEF[BM VAR, 10], STRDEF[BM VAR, 10], STRDEF[BM VAR, 16116]
       6 - ""DISCUSSION"".ROWID[ROWID,10]
       7 - STRDEF[BM VAR, 10], STRDEF[BM VAR, 10], STRDEF[BM VAR, 16116]
       8 - ""DISCUSSION"".ROWID[ROWID,10]
    
    -------------------------------------------------------------------------------
    
         ",4
6238742,06/04/2011 18:55:57,784181,06/04/2011 18:52:09,1,0,Database performance question,"I have a question, is it better performance to have for example 5 tables each with 20 fields than one table which includes all information having 100 fields? does bigger tables make search queries slower?

thank you",sql,database,performance,optimization,,06/04/2011 22:02:43,not a real question,1,36,3,"Database performance question I have a question, is it better performance to have for example 5 tables each with 20 fields than one table which includes all information having 100 fields? does bigger tables make search queries slower?

thank you",4
11658191,07/25/2012 20:36:18,1167893,01/24/2012 20:26:17,15,0,Getting data from three tables in one query,"I am trying to retrieve data from three tables at once. The tables look like:

*categories*

    id
    category
    messageid

*messages*

    id
    title
    message

*comments*

    id
    messageid
    message

What I am trying to get is 1 message (because I have a `WHERE` clause based on id `3`), 3 categories (because there are 3 categories linked to the message) and 2 comments (because there are 2 comments linked to the message).

I'm trying to retrieve the data by usnig the following query:

    SELECT categories.category, messages.id, messages.title, messages.message, comments.count, comments.id as commentid, comments.message as commentmessage
    FROM categories
    RIGHT JOIN 
      (SELECT id, title, message
      FROM messages WHERE messaged.id = 3) messages
    ON messages.id = categories.messageid
    LEFT JOIN
      (SELECT count(id), id, message
      FROM comments
      GROUP BY id) comments
    ON messages.id = comments.messageid
    ORDER BY article.id DESC

However when running this query I get 6 results:

    category      id  title      message      count  commentid  commentmessage
    test          3   the title  the message  1      6          comment 1
    test          3   the title  the message  1      5          comment 2
    installation  3   the title  the message  1      6          comment 1
    installation  3   the title  the message  1      5          comment 2
    question      3   the title  the message  1      6          comment 1
    question      3   the title  the message  1      5          comment 2

Where I expected a result something like:

    category      id  title      message      count  commentid  commentmessage
    test          3   the title  the message  1      6          comment 1
    question      3   the title  the message  1      5          comment 2
    installation  3   the title  the message  1      null       null

With only three rows I should be able to get all the needed data. Is this even possible? Am I doing it completely wrong ™?",sql,query,,,,,open,0,614,8,"Getting data from three tables in one query I am trying to retrieve data from three tables at once. The tables look like:

*categories*

    id
    category
    messageid

*messages*

    id
    title
    message

*comments*

    id
    messageid
    message

What I am trying to get is 1 message (because I have a `WHERE` clause based on id `3`), 3 categories (because there are 3 categories linked to the message) and 2 comments (because there are 2 comments linked to the message).

I'm trying to retrieve the data by usnig the following query:

    SELECT categories.category, messages.id, messages.title, messages.message, comments.count, comments.id as commentid, comments.message as commentmessage
    FROM categories
    RIGHT JOIN 
      (SELECT id, title, message
      FROM messages WHERE messaged.id = 3) messages
    ON messages.id = categories.messageid
    LEFT JOIN
      (SELECT count(id), id, message
      FROM comments
      GROUP BY id) comments
    ON messages.id = comments.messageid
    ORDER BY article.id DESC

However when running this query I get 6 results:

    category      id  title      message      count  commentid  commentmessage
    test          3   the title  the message  1      6          comment 1
    test          3   the title  the message  1      5          comment 2
    installation  3   the title  the message  1      6          comment 1
    installation  3   the title  the message  1      5          comment 2
    question      3   the title  the message  1      6          comment 1
    question      3   the title  the message  1      5          comment 2

Where I expected a result something like:

    category      id  title      message      count  commentid  commentmessage
    test          3   the title  the message  1      6          comment 1
    question      3   the title  the message  1      5          comment 2
    installation  3   the title  the message  1      null       null

With only three rows I should be able to get all the needed data. Is this even possible? Am I doing it completely wrong ™?",2
9932759,03/29/2012 20:11:56,1293936,03/26/2012 20:06:40,18,0,Oracle 10g keeps on Initializing,"I am continuously getting Error Code “The ORA-01033: ORACLE initialization or shutdown in progress” 

This is happening ever since I physically deleted a couple of .dbf files",sql,database,oracle,,,03/30/2012 11:08:12,off topic,1,27,5,"Oracle 10g keeps on Initializing I am continuously getting Error Code “The ORA-01033: ORACLE initialization or shutdown in progress” 

This is happening ever since I physically deleted a couple of .dbf files",3
7540870,09/24/2011 18:05:58,582556,01/20/2011 06:37:42,6,0,Sql server integration services(SSIS),"Can anybody tell me. How can i implement integration service of sql server 2008 R2.?
I want to update my production server from my development server using Integration services.


Thanks & Regards

Salman ansari
Bhopal(INDIA)",sql,server,,,,09/24/2011 23:19:46,not a real question,1,31,4,"Sql server integration services(SSIS) Can anybody tell me. How can i implement integration service of sql server 2008 R2.?
I want to update my production server from my development server using Integration services.


Thanks & Regards

Salman ansari
Bhopal(INDIA)",2
275983,11/09/2008 14:54:26,34623,11/05/2008 09:45:27,32,2,Usename & Password and UserInsances in SQL 2005,Can I use SQL Authentication with User Instances?,sql,authentication,user,instance,,,open,0,8,8,Usename & Password and UserInsances in SQL 2005 Can I use SQL Authentication with User Instances?,4
9135246,02/03/2012 20:45:24,1188406,02/03/2012 20:36:03,1,0,Unexpectedly changed permissions,"While trying to debug my site, I suddenly started getting this error:

    ERROR [HY000] [MySQL][ODBC 3.51 Driver]Access denied for user 'admin'@'XXXXXXXX' (using password: YES)

and it pointed to these lines of code:

    Line 37:         using (OdbcConnection con = new OdbcConnection(ConnStr))
    Line 38:         {
    Line 39:             con.Open();

I finally fixed the problem by changing this code:

    private const string ConnStr = ""Driver={MySQL ODBC 3.51 Driver};""
        + ""Server=xxxx.xxx;Database=xxxx;uid=xxx;pwd=xxXXxx;option=3"";

from uid=admin to uid=root.
I'm sure it's bad coding practice to list root, but it's all I can do to get it to work.

Now the issue.  Suddenly a lot of my pages have this problem.  Last week they were working fine.  Now they won't work unless I change 'admin' to 'root'.  I've looked all around, but I think I've created my own unique brand of stupidity.  Any help is appreciated.  Thanks.",sql,permissions,connection,odbc,driver,,open,0,189,3,"Unexpectedly changed permissions While trying to debug my site, I suddenly started getting this error:

    ERROR [HY000] [MySQL][ODBC 3.51 Driver]Access denied for user 'admin'@'XXXXXXXX' (using password: YES)

and it pointed to these lines of code:

    Line 37:         using (OdbcConnection con = new OdbcConnection(ConnStr))
    Line 38:         {
    Line 39:             con.Open();

I finally fixed the problem by changing this code:

    private const string ConnStr = ""Driver={MySQL ODBC 3.51 Driver};""
        + ""Server=xxxx.xxx;Database=xxxx;uid=xxx;pwd=xxXXxx;option=3"";

from uid=admin to uid=root.
I'm sure it's bad coding practice to list root, but it's all I can do to get it to work.

Now the issue.  Suddenly a lot of my pages have this problem.  Last week they were working fine.  Now they won't work unless I change 'admin' to 'root'.  I've looked all around, but I think I've created my own unique brand of stupidity.  Any help is appreciated.  Thanks.",5
8195325,11/19/2011 16:13:35,1034172,11/07/2011 17:06:30,1,0,"ERROR SQL Developmer in my MAC ""the network adapter could not establish the connection""","hello I download now from Oracle site ""SQL Developer"" now I enter to the software and try to do a new connection, I enter my ""Connection name"" and the ""password"" and I get the ERROR:
""Status : Failure - test faild: IO error the network adapter could not establish the connection""

what I can do!?

thank you
Ran",sql,osx,oracle,,,11/20/2011 18:06:18,off topic,1,54,14,"ERROR SQL Developmer in my MAC ""the network adapter could not establish the connection"" hello I download now from Oracle site ""SQL Developer"" now I enter to the software and try to do a new connection, I enter my ""Connection name"" and the ""password"" and I get the ERROR:
""Status : Failure - test faild: IO error the network adapter could not establish the connection""

what I can do!?

thank you
Ran",3
10711670,05/22/2012 23:52:12,425458,08/19/2010 15:56:13,516,3,What is the fastest serverless database protocol for a VERY large database?,"[This][1] question was asked a little while ago, but I'm looking for something more specific: for a relational database with, say, several billion rows in several tables, what is the fastest serverless database protocol/implementation?

I'm sure that the answer to this question is highly dependent upon use case, so here's mine:  I want to store data from protein simulations that is structured according to the following hierarchy

    proteins
      |__simulation conditions
      |____|__protein amino acids
      |____|____|__amino acid position states
      |____|____|____|__individual atoms

(i.e. the proteins table is linked to every table under it in the hierarchy in a one-to-many relationship, the simulation conditions table is also linked to every table under it in a one-to-many relationship, etc.)

I would like to be able to put the output from 10's of thousands of simulation runs into this database, in which case it could easily end up holding billions of rows worth of data in the individual atoms table. Right now I'm using SQLite (with indexing on all primary and foreign key columns) in Ubuntu to run the database, but I've found that it slows down significantly once the database contains as little as 100,000 rows worth of atom data, so I'm hoping that there's something better.

Ultimately the goal will be to use this database as part of the backend for an analysis and graphing program. This analysis program will be distributed along with the simulation software itself, so I would like to use a serverless database protocol in order to make installation and setup as painless as humanly possible for the end user (this is important).

Since each simulation can take up to a day to run, queries on the database will likely be much more common than insertions, so what's most important is that queries run as fast as possible. However, it would also be nice if insertions didn't take forever, especially when building the database for the first time from a large cache of preexisting simulation data.

I'm currently building the database with the sqlalchemy library in Python, so bonus points if your answer can work with that.


  [1]: http://stackoverflow.com/q/254552/425458",sql,database,query,database-design,sqlalchemy,05/23/2012 23:13:08,not constructive,1,368,12,"What is the fastest serverless database protocol for a VERY large database? [This][1] question was asked a little while ago, but I'm looking for something more specific: for a relational database with, say, several billion rows in several tables, what is the fastest serverless database protocol/implementation?

I'm sure that the answer to this question is highly dependent upon use case, so here's mine:  I want to store data from protein simulations that is structured according to the following hierarchy

    proteins
      |__simulation conditions
      |____|__protein amino acids
      |____|____|__amino acid position states
      |____|____|____|__individual atoms

(i.e. the proteins table is linked to every table under it in the hierarchy in a one-to-many relationship, the simulation conditions table is also linked to every table under it in a one-to-many relationship, etc.)

I would like to be able to put the output from 10's of thousands of simulation runs into this database, in which case it could easily end up holding billions of rows worth of data in the individual atoms table. Right now I'm using SQLite (with indexing on all primary and foreign key columns) in Ubuntu to run the database, but I've found that it slows down significantly once the database contains as little as 100,000 rows worth of atom data, so I'm hoping that there's something better.

Ultimately the goal will be to use this database as part of the backend for an analysis and graphing program. This analysis program will be distributed along with the simulation software itself, so I would like to use a serverless database protocol in order to make installation and setup as painless as humanly possible for the end user (this is important).

Since each simulation can take up to a day to run, queries on the database will likely be much more common than insertions, so what's most important is that queries run as fast as possible. However, it would also be nice if insertions didn't take forever, especially when building the database for the first time from a large cache of preexisting simulation data.

I'm currently building the database with the sqlalchemy library in Python, so bonus points if your answer can work with that.


  [1]: http://stackoverflow.com/q/254552/425458",5
7516669,09/22/2011 14:40:57,959296,09/22/2011 14:12:00,1,0,Alternatives to PL/SQL? Are there any other programming language/IDE combo that offers autocomplete and syntax validation for (Oracle) SQL queries?,"I'm looking for an alternative to PL/SQL. PL/SQL is mediocre at best but I haven't found anything that's even close to matching its productivity when writing Oracle database-centric scripts. 

So, are there any other programming languages that offer _any_ of the following features?

- Natively handle SQL queries (SQL treated as code, not as a string).
- Autocomplete for table & column names.
- SQL is validated against DB at compile time.",sql,oracle,programming-languages,autocomplete,plsql,09/23/2011 03:46:32,not constructive,1,69,20,"Alternatives to PL/SQL? Are there any other programming language/IDE combo that offers autocomplete and syntax validation for (Oracle) SQL queries? I'm looking for an alternative to PL/SQL. PL/SQL is mediocre at best but I haven't found anything that's even close to matching its productivity when writing Oracle database-centric scripts. 

So, are there any other programming languages that offer _any_ of the following features?

- Natively handle SQL queries (SQL treated as code, not as a string).
- Autocomplete for table & column names.
- SQL is validated against DB at compile time.",5
7998535,11/03/2011 16:36:20,1019189,10/28/2011 22:20:23,8,0,Is there graphical SQL querry builder/viewer?,"I am still going deeper to an DWH. As I am looking on some queries, they are really long, couple of monitors on height, and it is quite hard to  modify them. Especially when the queries are multiple nested, it is difficult to see the structure of querry that is for example 4 monitors long.


So is there some tool which is able to graphically show, modify or build queries?
If not, is there any tool that helps me to orientate oneself in long, multiple nested queries?

Thank you for tips. I prefer free/opensource tools",sql,query,,,,06/28/2012 12:28:26,not constructive,1,93,6,"Is there graphical SQL querry builder/viewer? I am still going deeper to an DWH. As I am looking on some queries, they are really long, couple of monitors on height, and it is quite hard to  modify them. Especially when the queries are multiple nested, it is difficult to see the structure of querry that is for example 4 monitors long.


So is there some tool which is able to graphically show, modify or build queries?
If not, is there any tool that helps me to orientate oneself in long, multiple nested queries?

Thank you for tips. I prefer free/opensource tools",2
4806262,01/26/2011 15:22:46,590822,01/26/2011 15:20:41,1,0,TSQL Group-By Over Two Columns,"Hi Thanks in advance for helping. I have the following table:

create table temp_vol (symbol nchar(10), dseqkey int, volume float)

here are some values in the table:
symbol     dseqkey    volume (no commas in the actual values)
C 20672  422,764,512 
F 20672  47,144,600 
F 20671  51,695,000 
C 20671  371,950,496 
F 20670  48,680,600 
C 20670  654,208,512 
C 20669  626,121,600 
F 20669  93,489,504 
C 20668  712,674,304 

The output I am seeking is a 2-day simple moving average ((volume dseqkey + volume dseqkey-1) / 2) for each symbol, for each dseqkey. I can get the moving average working for all symbols across one dseqkey. I can get the moving average working for all dseqkeys across 1 symbol. I cannot seem to get both working together. 
",sql,tsql,sql-server-2008,,,,open,0,134,5,"TSQL Group-By Over Two Columns Hi Thanks in advance for helping. I have the following table:

create table temp_vol (symbol nchar(10), dseqkey int, volume float)

here are some values in the table:
symbol     dseqkey    volume (no commas in the actual values)
C 20672  422,764,512 
F 20672  47,144,600 
F 20671  51,695,000 
C 20671  371,950,496 
F 20670  48,680,600 
C 20670  654,208,512 
C 20669  626,121,600 
F 20669  93,489,504 
C 20668  712,674,304 

The output I am seeking is a 2-day simple moving average ((volume dseqkey + volume dseqkey-1) / 2) for each symbol, for each dseqkey. I can get the moving average working for all symbols across one dseqkey. I can get the moving average working for all dseqkeys across 1 symbol. I cannot seem to get both working together. 
",3
6777818,07/21/2011 14:36:07,249496,01/13/2010 03:50:23,1,2,Sql Server- Concatenate rows into a single text,"You can find the answere here.
http://stackoverflow.com/questions/194852/concatenate-many-rows-into-a-single-text-string

But I wanted to added a bit of information.
If you want to deal with nulls you can do it by adding a where clause or add another COALESCE around the first one.



    DECLARE @Names VARCHAR(8000) 
    SELECT @Names = COALESCE(COALESCE(@Names + ', ', '') + Name, @Names) FROM People


",sql,sql-server,tsql,sql-server-2008,,07/21/2011 14:47:16,not a real question,1,60,8,"Sql Server- Concatenate rows into a single text You can find the answere here.
http://stackoverflow.com/questions/194852/concatenate-many-rows-into-a-single-text-string

But I wanted to added a bit of information.
If you want to deal with nulls you can do it by adding a where clause or add another COALESCE around the first one.



    DECLARE @Names VARCHAR(8000) 
    SELECT @Names = COALESCE(COALESCE(@Names + ', ', '') + Name, @Names) FROM People


",4
880487,05/19/2009 00:47:22,41508,11/28/2008 01:57:30,42,5,SQL Server command line backup statement,"Does any one know if there is a way to script out SQL Server backup in to a batch file, so that it could be executed from a command line?",sql,backup,,,,,open,0,30,6,"SQL Server command line backup statement Does any one know if there is a way to script out SQL Server backup in to a batch file, so that it could be executed from a command line?",2
9922055,03/29/2012 08:53:39,1300271,03/29/2012 08:40:10,1,0,"how to find the <SQL Server Logins> for a domain user who have accessed db? (there are several sql logins by ""windows user group"")","there are several sql logins which are created from ""windows user group"". 

when a client connect to sql server via ""windows authentication"", how to confirm this client belong to a ""windows user group""?

thanks for any help.",sql,windows,authentication,server,,,open,0,36,24,"how to find the <SQL Server Logins> for a domain user who have accessed db? (there are several sql logins by ""windows user group"") there are several sql logins which are created from ""windows user group"". 

when a client connect to sql server via ""windows authentication"", how to confirm this client belong to a ""windows user group""?

thanks for any help.",4
11563504,07/19/2012 14:53:36,1239412,02/29/2012 05:02:04,30,0,Connecting Linked Server,"Hi I want to fetch data from *MS SQL DB* of a Remote server using Linked Servers. I have linked the servers. I am fetching data as follows.

**select * from [IP of server].[Database Name].[dbo].[Table Name]**

But I want to get [IP address] from a variable and use it.

Ex: Declare @ServIP varchar(50) 
    
set @ServIP = 'IP of server'

select * from [@ServIP].[Database Name].[dbo].[Table Name]

I'm getting error If I use variable.

How can I do it?",sql,sql-server,linked-server,,,07/19/2012 15:59:30,off topic,1,75,3,"Connecting Linked Server Hi I want to fetch data from *MS SQL DB* of a Remote server using Linked Servers. I have linked the servers. I am fetching data as follows.

**select * from [IP of server].[Database Name].[dbo].[Table Name]**

But I want to get [IP address] from a variable and use it.

Ex: Declare @ServIP varchar(50) 
    
set @ServIP = 'IP of server'

select * from [@ServIP].[Database Name].[dbo].[Table Name]

I'm getting error If I use variable.

How can I do it?",3
6641935,07/10/2011 15:26:44,259731,01/27/2010 02:23:52,322,13,Execute queries until non-empty result,"I have three queries, looking like these:

    SELECT * FROM Table1 WHERE Column1 = 'a'
    SELECT * FROM Table2 WHERE Column2 = 'b'
    SELECT * FROM Table1 A, Table2 B WHERE A.Column1 <> B.Column1

Now all logic is implemented on the client side as following. Execute the first query, if HasRows, set a flag to 1 and return the rows. Otherwise execute the second query, if HasRows, set the flag to 2 and return the rows. Otherwise execute the third query, set the flag to 3 and return the rows.

How to do this with a single query? Flag stuff, I guess, should be solved adding Flag to the queries:

    SELECT Flag = 1, * FROM Table1 WHERE Column1 = 'a'
    SELECT Flag = 2, * FROM Table2 WHERE Column2 = 'b'
    SELECT Flag = 3, * FROM Table1 A, Table2 B WHERE A.Column1 <> B.Column1

But now what? How to check, if a query returns non-empty result?

Also, I'd like to cache the results, in other words, to avoid executing the same query twice - once for checking and the second time - for returning data.

Regards,",sql,sql-server,,,,,open,0,201,5,"Execute queries until non-empty result I have three queries, looking like these:

    SELECT * FROM Table1 WHERE Column1 = 'a'
    SELECT * FROM Table2 WHERE Column2 = 'b'
    SELECT * FROM Table1 A, Table2 B WHERE A.Column1 <> B.Column1

Now all logic is implemented on the client side as following. Execute the first query, if HasRows, set a flag to 1 and return the rows. Otherwise execute the second query, if HasRows, set the flag to 2 and return the rows. Otherwise execute the third query, set the flag to 3 and return the rows.

How to do this with a single query? Flag stuff, I guess, should be solved adding Flag to the queries:

    SELECT Flag = 1, * FROM Table1 WHERE Column1 = 'a'
    SELECT Flag = 2, * FROM Table2 WHERE Column2 = 'b'
    SELECT Flag = 3, * FROM Table1 A, Table2 B WHERE A.Column1 <> B.Column1

But now what? How to check, if a query returns non-empty result?

Also, I'd like to cache the results, in other words, to avoid executing the same query twice - once for checking and the second time - for returning data.

Regards,",2
8096559,11/11/2011 15:41:35,907714,08/23/2011 12:35:46,9,4,"Newb SQL, How to get all records NOT found from query and how to do a word search from Excel list","Ok, so I'm learning SQL on the fly today and have successfully ran a SQL query.  Now I want to run another query from the table to include all records not included in the first query.  How do I do this?  I tried using WHERE Not table1.field1 = query1.field1 but wound up with like 5million records, when i only have 8000 to start.

Second question is, I have a list of words in Excel.  I want to be able to run a query to include records where a field contains these words.  I am searching an address that spans multiple fields for keywords.",sql,,,,,12/09/2011 15:48:19,not a real question,1,107,21,"Newb SQL, How to get all records NOT found from query and how to do a word search from Excel list Ok, so I'm learning SQL on the fly today and have successfully ran a SQL query.  Now I want to run another query from the table to include all records not included in the first query.  How do I do this?  I tried using WHERE Not table1.field1 = query1.field1 but wound up with like 5million records, when i only have 8000 to start.

Second question is, I have a list of words in Excel.  I want to be able to run a query to include records where a field contains these words.  I am searching an address that spans multiple fields for keywords.",1
11320215,07/03/2012 22:40:43,1500113,07/03/2012 22:33:35,1,0,how to write bill of materials query,"Can't write a query that can give the bill of materials of products structured this way:
each item is defined giving 3 particular values to 3 variables. So the item table can be defined like this:

item=(id_item,shape,material,color)

Example: 

0,square,iron,black

1,triangle,rubbear,pink

etc…

Then raw materials

raw=(id_raw,raw)

Example:

0,particular_piece_of_iron

1,particular_piece_of_wood

2,particular_piece_of_rubber

etc...

I need raw materials to build finished items, and i can write rules telling me in which way any particular raw material is needed for specific items.
For example 2 peaces of particular_peace_of_iron are needed for square, triangle and sphere shapes made of material iron.
So i need to define groups of variables.

var_groups=(id_group,group,variable)

Example;

0,first_group_of_shapes,shape

1,second_group_of_hapes,shape

2,my_fovourite_colours,colour

etc...

rel_var=(id_rel,var,id_group)

Example:

0,square,0

1,sphere,0

2,triangle,0

2,red,2

3,blue,2

etc…

I need to define other tables saying that to biuld an item iron made with shape included in first_group_of_shape i need 2 particular_pieces_of_iron.

aggr=(id_aggr,shape_group,material_group,colour_group)

Example:

0,0,null,null

etc...

rel_raw=(id_rel,id_aggr,shape,material,colour,id_raw,quantity)

Example:

0,0,null,iron,null,0,2

etc...

Obviously other raws are needed grouping values of color and given punctual value of shape etc...

what's the simplest way to write a query selecting (id_item,id_raw,quantity)?

Thank you for any help",sql,query,hsqldb,,,07/05/2012 13:14:35,not a real question,1,138,7,"how to write bill of materials query Can't write a query that can give the bill of materials of products structured this way:
each item is defined giving 3 particular values to 3 variables. So the item table can be defined like this:

item=(id_item,shape,material,color)

Example: 

0,square,iron,black

1,triangle,rubbear,pink

etc…

Then raw materials

raw=(id_raw,raw)

Example:

0,particular_piece_of_iron

1,particular_piece_of_wood

2,particular_piece_of_rubber

etc...

I need raw materials to build finished items, and i can write rules telling me in which way any particular raw material is needed for specific items.
For example 2 peaces of particular_peace_of_iron are needed for square, triangle and sphere shapes made of material iron.
So i need to define groups of variables.

var_groups=(id_group,group,variable)

Example;

0,first_group_of_shapes,shape

1,second_group_of_hapes,shape

2,my_fovourite_colours,colour

etc...

rel_var=(id_rel,var,id_group)

Example:

0,square,0

1,sphere,0

2,triangle,0

2,red,2

3,blue,2

etc…

I need to define other tables saying that to biuld an item iron made with shape included in first_group_of_shape i need 2 particular_pieces_of_iron.

aggr=(id_aggr,shape_group,material_group,colour_group)

Example:

0,0,null,null

etc...

rel_raw=(id_rel,id_aggr,shape,material,colour,id_raw,quantity)

Example:

0,0,null,iron,null,0,2

etc...

Obviously other raws are needed grouping values of color and given punctual value of shape etc...

what's the simplest way to write a query selecting (id_item,id_raw,quantity)?

Thank you for any help",3
7416497,09/14/2011 12:41:35,83119,03/26/2009 13:33:04,2083,101,How do I limit the number of rows per id on an oracle database?,"I want to store the last 20 products a user has looked at. If the user browses to product number 21 the oldest of the records should be deleted from the ORACLE database.

The table contains the recently viewed products of all the users in the system.

So basically I need to check if user X has over Y records in a table and if so delete the oldest records so that user X only ever has Y records in the recently viewed products table.

Any help would be appreciated.

Here is an attempt I have made which does not work correctly.

    DELETE FROM VIEWED_PRODUCT
    WHERE id NOT IN (
      SELECT id
      FROM (
        SELECT * FROM (
          SELECT id
          FROM VIEWED_PRODUCT
          WHERE MY_ID = 1626
          ORDER BY CREATED_AT DESC )
            WHERE ROWNUM <= 20 
      ) z
    );

Thanks.",sql,oracle,,,,,open,0,213,14,"How do I limit the number of rows per id on an oracle database? I want to store the last 20 products a user has looked at. If the user browses to product number 21 the oldest of the records should be deleted from the ORACLE database.

The table contains the recently viewed products of all the users in the system.

So basically I need to check if user X has over Y records in a table and if so delete the oldest records so that user X only ever has Y records in the recently viewed products table.

Any help would be appreciated.

Here is an attempt I have made which does not work correctly.

    DELETE FROM VIEWED_PRODUCT
    WHERE id NOT IN (
      SELECT id
      FROM (
        SELECT * FROM (
          SELECT id
          FROM VIEWED_PRODUCT
          WHERE MY_ID = 1626
          ORDER BY CREATED_AT DESC )
            WHERE ROWNUM <= 20 
      ) z
    );

Thanks.",2
2701394,04/23/2010 19:25:09,325418,05/09/2009 15:50:29,3056,104,What is a SQL statement that can tally up the counts even including the Zeros? (all in 1 statement),"A SQL statement can give a list of the most popular gifts that are sent in a Social application, all the way to the ones that are sent 1, or 2 times, but it won't include the Zeros.

I think the same goes for getting the list of the most popular Classes that students are registering for, when the registration process for all students is 10 days and now it is the 3rd day.  Again, we get the count but the Zeros are not there.

Is there a simple SQL statement that can show the whole list, including the zeros?

",sql,join,group-by,count,,,open,0,99,19,"What is a SQL statement that can tally up the counts even including the Zeros? (all in 1 statement) A SQL statement can give a list of the most popular gifts that are sent in a Social application, all the way to the ones that are sent 1, or 2 times, but it won't include the Zeros.

I think the same goes for getting the list of the most popular Classes that students are registering for, when the registration process for all students is 10 days and now it is the 3rd day.  Again, we get the count but the Zeros are not there.

Is there a simple SQL statement that can show the whole list, including the zeros?

",4
8736763,01/05/2012 02:05:29,1131181,01/05/2012 01:45:30,1,0,Object database solution - or stick with the old relational database with SQL?,"I am looking at a project requiring a unique database solution. The elements involved abstract into countless (and growing) variations of relationships between many objects - meaning that a relational SQL implementation would require a huge amount of joins. From my research so far, it looks like an object database will fit this more appropriately. Although, due to the nature of what is commonly needed in a database, the standard SQL relational database is the standard and has been for many years.

It looks like some Object Database solutions have emerged. Although, I am looking for a solution that will be supported for many years. I am looking at a solution such as db4o and wondering if this solution will last and if it will be worth it. I would rather avoid using 10  joins for a complex object and have the access in a single statement in a odms solution rather  that using a relational database option.

Is the industry really ready for an Object Database solution that lasts for years?
Or is the support pushing all solutions towards the relational model using SQL?

My goal should be clear at this point. If there are misunderstandings in my description of how this could work - please provide in a comment. I appreciate
",sql,database,relational,object-oriented-database,,01/06/2012 02:35:18,not constructive,1,211,13,"Object database solution - or stick with the old relational database with SQL? I am looking at a project requiring a unique database solution. The elements involved abstract into countless (and growing) variations of relationships between many objects - meaning that a relational SQL implementation would require a huge amount of joins. From my research so far, it looks like an object database will fit this more appropriately. Although, due to the nature of what is commonly needed in a database, the standard SQL relational database is the standard and has been for many years.

It looks like some Object Database solutions have emerged. Although, I am looking for a solution that will be supported for many years. I am looking at a solution such as db4o and wondering if this solution will last and if it will be worth it. I would rather avoid using 10  joins for a complex object and have the access in a single statement in a odms solution rather  that using a relational database option.

Is the industry really ready for an Object Database solution that lasts for years?
Or is the support pushing all solutions towards the relational model using SQL?

My goal should be clear at this point. If there are misunderstandings in my description of how this could work - please provide in a comment. I appreciate
",4
10383211,04/30/2012 11:49:27,1266807,03/13/2012 15:02:55,1,0,SQL Server Replication Bandwidth,"A SQL Server 2000 database I support has transactional replication turned on.  There is a subscriber on the same network.  However, this subscriber may be moving into the cloud, probably Amazon's.  I have been asked to give an estimate as to how much bandwidth may be used.

I thought about getting some deltas of actual table sizes and numbers of records in each table, but this is not going to be accurate enough (e.g, all 10 columns in all 1000 records could potentially change, which would get replicated but still be hidden by this measurement).

I want to be able to say something like: ""based on the last two weeks, the average amount of data going over the network to the subcriber is XXX MB"".

I'm pretty sure it's a measurement of the size of the transaction log I'm after, but how to do it? ",sql,server,replication,bandwidth,,05/01/2012 14:00:06,off topic,1,146,4,"SQL Server Replication Bandwidth A SQL Server 2000 database I support has transactional replication turned on.  There is a subscriber on the same network.  However, this subscriber may be moving into the cloud, probably Amazon's.  I have been asked to give an estimate as to how much bandwidth may be used.

I thought about getting some deltas of actual table sizes and numbers of records in each table, but this is not going to be accurate enough (e.g, all 10 columns in all 1000 records could potentially change, which would get replicated but still be hidden by this measurement).

I want to be able to say something like: ""based on the last two weeks, the average amount of data going over the network to the subcriber is XXX MB"".

I'm pretty sure it's a measurement of the size of the transaction log I'm after, but how to do it? ",4
9132026,02/03/2012 16:32:45,777982,05/31/2011 15:53:56,909,126,Update oldID for the records recursively,"I asked a very similar question [here][1] but I need more advance query now. The situation is, we have about 20,000 records of customers. Customers can renew and we just create a new record for it. There is no exact tracing back to which record was actually renewed. Now we have added the `old ID` field and I want to populate it with the exact old record. Now if it is renewed one time, that has been taken care of my old question and I can do it. The problem is if a record was renewed 3 or more time, I have to find the exact logic how the oldest record hopped to the newest one. For this we do not have a set rule but generally I am following `customer start date` (and the ID itself throws some light which record came first) and for now will use `customer start date` to populate all the records. I have included a test case here

    create table #customer (
    id int not null primary key identity,
    cust_no varchar(12),
    meter_no varchar(10),
    startdate smalldatetime,
    enddate smalldatetime,
    oldid int null
    )
    
    insert into #customer values('AA111222','1111','2008-01-01', '2008-03-01',null) 
    insert into #customer values('AA111222','1111','2009-02-01', '2009-05-01',null) 
    insert into #customer values('AA111222','1111','2008-03-01', '2008-12-01',null) 
    insert into #customer values('AA111222','1111','2009-05-01', '2009-07-01',null) 
    insert into #customer values('AA111222','1111','2009-08-01', '2009-11-01',null) 
    insert into #customer values('AA111222','1111','2010-01-01', '2010-04-01',null) 
    insert into #customer values('AA111222','1111','2010-07-01', '2011-07-01',null) 
    insert into #customer values('AA111222','1111','2011-03-01', '2011-07-01',null) 
    insert into #customer values('AA111222','1111','2011-07-01', '2012-07-01',null) 

    -- I want this result in the last column
    
    id   cust_no      meter_no   startdate      enddate        oldid           
    ---- ------------ ---------- -------------- -------------- -------         
    1    AA111222     1111       2008-01-01     2008-03-01     base                      
    2    AA111222     1111       2009-02-01     2009-05-01     3 
    3    AA111222     1111       2008-03-01     2008-12-01     1            
    4    AA111222     1111       2009-05-01     2009-07-01     2            
    5    AA111222     1111       2009-08-01     2009-11-01     4            
    6    AA111222     1111       2010-01-01     2010-04-01     5            
    7    AA111222     1111       2010-07-01     2011-07-01     6            
    8    AA111222     1111       2011-03-01     2011-07-01     7            
    9    AA111222     1111       2011-07-01     2012-07-01     8    

  

Note,different ways of doing it is appreciated so I can learn something as well. So far I have looked at CTE, Join, Cursor but it would take time for me to write it, if I can even do it.

  [1]: http://stackoverflow.com/questions/8994720/update-oldid-field-based-on-fields-in-the-same-table",sql,sql-server-2005,join,cursor,,,open,0,783,6,"Update oldID for the records recursively I asked a very similar question [here][1] but I need more advance query now. The situation is, we have about 20,000 records of customers. Customers can renew and we just create a new record for it. There is no exact tracing back to which record was actually renewed. Now we have added the `old ID` field and I want to populate it with the exact old record. Now if it is renewed one time, that has been taken care of my old question and I can do it. The problem is if a record was renewed 3 or more time, I have to find the exact logic how the oldest record hopped to the newest one. For this we do not have a set rule but generally I am following `customer start date` (and the ID itself throws some light which record came first) and for now will use `customer start date` to populate all the records. I have included a test case here

    create table #customer (
    id int not null primary key identity,
    cust_no varchar(12),
    meter_no varchar(10),
    startdate smalldatetime,
    enddate smalldatetime,
    oldid int null
    )
    
    insert into #customer values('AA111222','1111','2008-01-01', '2008-03-01',null) 
    insert into #customer values('AA111222','1111','2009-02-01', '2009-05-01',null) 
    insert into #customer values('AA111222','1111','2008-03-01', '2008-12-01',null) 
    insert into #customer values('AA111222','1111','2009-05-01', '2009-07-01',null) 
    insert into #customer values('AA111222','1111','2009-08-01', '2009-11-01',null) 
    insert into #customer values('AA111222','1111','2010-01-01', '2010-04-01',null) 
    insert into #customer values('AA111222','1111','2010-07-01', '2011-07-01',null) 
    insert into #customer values('AA111222','1111','2011-03-01', '2011-07-01',null) 
    insert into #customer values('AA111222','1111','2011-07-01', '2012-07-01',null) 

    -- I want this result in the last column
    
    id   cust_no      meter_no   startdate      enddate        oldid           
    ---- ------------ ---------- -------------- -------------- -------         
    1    AA111222     1111       2008-01-01     2008-03-01     base                      
    2    AA111222     1111       2009-02-01     2009-05-01     3 
    3    AA111222     1111       2008-03-01     2008-12-01     1            
    4    AA111222     1111       2009-05-01     2009-07-01     2            
    5    AA111222     1111       2009-08-01     2009-11-01     4            
    6    AA111222     1111       2010-01-01     2010-04-01     5            
    7    AA111222     1111       2010-07-01     2011-07-01     6            
    8    AA111222     1111       2011-03-01     2011-07-01     7            
    9    AA111222     1111       2011-07-01     2012-07-01     8    

  

Note,different ways of doing it is appreciated so I can learn something as well. So far I have looked at CTE, Join, Cursor but it would take time for me to write it, if I can even do it.

  [1]: http://stackoverflow.com/questions/8994720/update-oldid-field-based-on-fields-in-the-same-table",4
2479650,03/19/2010 18:20:59,274832,02/16/2010 23:29:28,36,0,Why is my left join not returning nulls?,"In sql server 2008, I have the following query:

    select		
    	c.title as categorytitle,
    	s.title as subcategorytitle,
    	i.title as itemtitle
    from categories c
    join subcategories s on c.categoryid = s.categoryid
    left join itemcategories ic on s.subcategoryid = ic.subcategoryid 
    	and (ic.isactive = 1 or ic.isactive is null)
    join items i on ic.itemid = i.itemid and i.siteid = 132
    order by c.title, s.title

I am trying to get items in their subcategories, but I still want to return a record if there are no items in the category or subcategory.  Subcategories that have no items are never returned. What am I doing wrong?

Thank you",sql,left-join,,,,,open,0,132,8,"Why is my left join not returning nulls? In sql server 2008, I have the following query:

    select		
    	c.title as categorytitle,
    	s.title as subcategorytitle,
    	i.title as itemtitle
    from categories c
    join subcategories s on c.categoryid = s.categoryid
    left join itemcategories ic on s.subcategoryid = ic.subcategoryid 
    	and (ic.isactive = 1 or ic.isactive is null)
    join items i on ic.itemid = i.itemid and i.siteid = 132
    order by c.title, s.title

I am trying to get items in their subcategories, but I still want to return a record if there are no items in the category or subcategory.  Subcategories that have no items are never returned. What am I doing wrong?

Thank you",2
8784352,01/09/2012 05:40:40,311901,04/08/2010 12:59:53,534,22,Postgres: Simple SELECT * WHERE ... AND ... query fails,"This query:

    client.query({
      text: ""SELECT * FROM users WHERE provider = ? AND remote_id = ?"",
      values: [JSONuser.provider, JSONuser.remote_id]
    }, 
    function(err, result) { 
      ... 
    })

Fails with `syntax error at or near ""AND""`.

I'm unable to figure out why. Been programming all day. I think it's simple and I'm just tired. ",sql,postgresql,,,,,open,0,80,10,"Postgres: Simple SELECT * WHERE ... AND ... query fails This query:

    client.query({
      text: ""SELECT * FROM users WHERE provider = ? AND remote_id = ?"",
      values: [JSONuser.provider, JSONuser.remote_id]
    }, 
    function(err, result) { 
      ... 
    })

Fails with `syntax error at or near ""AND""`.

I'm unable to figure out why. Been programming all day. I think it's simple and I'm just tired. ",2
11451612,07/12/2012 12:14:07,1344935,04/19/2012 19:38:51,14,2,SQL Transaction vs. multiple statements,"I am inserting some data into 2 different tables. I'm currently using 2 different SQL statements but I've read from this site that it's possible to do this in a transaction.

Which method is better, with regards to the size of the data? Currently I'm just inserting 2 seperate rows at the same time into 2 different tables, unordered, so I think 2 statements is better.",sql,database,transactions,,,07/13/2012 15:15:57,not constructive,1,65,5,"SQL Transaction vs. multiple statements I am inserting some data into 2 different tables. I'm currently using 2 different SQL statements but I've read from this site that it's possible to do this in a transaction.

Which method is better, with regards to the size of the data? Currently I'm just inserting 2 seperate rows at the same time into 2 different tables, unordered, so I think 2 statements is better.",3
4661323,01/11/2011 18:39:49,338844,05/11/2010 23:54:31,116,15,MySQL Dynamically Merge/Select Select Rows,"I just need some direction on this.  I have the following tables:

    Table: entity
     - ID (INT)
    
    Table: attributes
     - ID (INT)
     - name (VARCHAR)
     - internalname (VARCHAR)
    
    Table: values
     - ID (INT)
     - entity (ID)
     - attributes (INT)
     - value (Text)


What I want is to make a Select statment that will return something like the following:

     - ID = entity.ID
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - etc...


It would be like combining:

    SELECT entity.id FROM entity;
    
and
    
    SELECT (SELECT values.value FROM values WHERE values.entity = entity.ID AND values.attributes = attributes.ID) FROM attributes;

It is a difficult thing to explain, however if you need me to explain further, please let me know.

Thanks in Advance!",sql,mysql,database,data-structures,mysql-query,,open,0,218,5,"MySQL Dynamically Merge/Select Select Rows I just need some direction on this.  I have the following tables:

    Table: entity
     - ID (INT)
    
    Table: attributes
     - ID (INT)
     - name (VARCHAR)
     - internalname (VARCHAR)
    
    Table: values
     - ID (INT)
     - entity (ID)
     - attributes (INT)
     - value (Text)


What I want is to make a Select statment that will return something like the following:

     - ID = entity.ID
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - {attributes.internalname} = values.{attribe internalname ID}.value
     - etc...


It would be like combining:

    SELECT entity.id FROM entity;
    
and
    
    SELECT (SELECT values.value FROM values WHERE values.entity = entity.ID AND values.attributes = attributes.ID) FROM attributes;

It is a difficult thing to explain, however if you need me to explain further, please let me know.

Thanks in Advance!",5
8657939,12/28/2011 13:51:24,281671,02/25/2010 23:03:51,2952,7,Classification of syntax highlighting in sql server management studio?,"If you can fill in the various types of things each color represents, I would really appreciate it :)

Blue text = commands, variable types

Red text = strings

Green text = comments

Pink text = functions?

Gray text = ???
",sql,sql-server,,,,12/28/2011 16:04:21,not a real question,1,36,9,"Classification of syntax highlighting in sql server management studio? If you can fill in the various types of things each color represents, I would really appreciate it :)

Blue text = commands, variable types

Red text = strings

Green text = comments

Pink text = functions?

Gray text = ???
",2
3229193,07/12/2010 13:54:39,163534,08/26/2009 13:45:27,5801,336,Inline Table-Valued UDF vs. A View - Which to use?,"I recently created a couple inline table-valued UDF's and then referenced them in a couple views using Cross Apply in one case and Outer Apply in another case. After I got it working and tested, I thought it was a pretty cool use of UDFs and Cross/Outer Apply's. But then it occurred to me that I probably could have done the same thing using a view.

So, my question is this. For those of you who have done this sort of thing, how do you decide to use an ITV UDF vs. a View? I realize of course that the UDF can take parameters whereas a view cannot, but those UDF parameter values could be used in a Where clause when querying against the View.

Thanks.

",sql,sql-server-2005,tsql,,,,open,0,124,10,"Inline Table-Valued UDF vs. A View - Which to use? I recently created a couple inline table-valued UDF's and then referenced them in a couple views using Cross Apply in one case and Outer Apply in another case. After I got it working and tested, I thought it was a pretty cool use of UDFs and Cross/Outer Apply's. But then it occurred to me that I probably could have done the same thing using a view.

So, my question is this. For those of you who have done this sort of thing, how do you decide to use an ITV UDF vs. a View? I realize of course that the UDF can take parameters whereas a view cannot, but those UDF parameter values could be used in a Where clause when querying against the View.

Thanks.

",3
522356,02/06/2009 21:56:51,1966,08/19/2008 15:53:28,6,1,What SQL coding standard do you follow?,Is there any widely used SQL coding standard out there? SQL is little bit different from C/C++ type of programming languages. Really don't know how to best format it for readability.,sql,coding-style,,,,,open,0,31,7,What SQL coding standard do you follow? Is there any widely used SQL coding standard out there? SQL is little bit different from C/C++ type of programming languages. Really don't know how to best format it for readability.,2
378608,12/18/2008 17:41:31,3238,08/27/2008 14:17:11,120,2,How can I select all leaf nodes in a SQL hierarchy under a given node? ,"I have a set of data that models a hierarchy of categories. A root category contains a set of top-level categories. Each top-level category contains a set of sub-categories.

Each sub category has a set of organizations. A given organization can appear in multiple sub categories. 

The leaf nodes of this hierarchy are organizations. An organization can potentially appear in multiple sub-categories.

The data is stored in three SQL tables:

    organizations
    organization_id organization_name
    1               Org A
    2               Org B
    3               Org C
    4               Org D
    5               Org E
    6               Org F

    categories
    category_id parent_id category_name
    0           NULL      Top Level Category
    1           0         First Category
    2           0         Second Category
    3           1         Sub Category A
    4           1         Sub Category B
    5           1         Sub Category C
    6           2         Sub Category D

    organizations_categories -- Maps organizations to sub_categories
    organization_id category_id
    1               3
    2               3
    2               6
    3               4
    4               4
    5               4
    6               5
    6               4
    7               6
    8               6

I would like to be able to select a list of all unique organizations under a given category or sub-category. 

The way I'm doing it right now involves first figuring out which sub categories have been requested and then looping through each sub_category in code and performing a select to get all organizations mapped to that category. The results of each select are appended to an array. This array contains duplicates whenever an organization appears in multiple sub categories.

I would love to replace this kludge with a query that can efficiently select a list of distinct organizations given an id of one of the categories in the hierarchy.

I am devloping this solution using PHP and MySQL.

Thanks for your time and suggestions.
",sql,hierarchy,php,,,,open,0,708,16,"How can I select all leaf nodes in a SQL hierarchy under a given node?  I have a set of data that models a hierarchy of categories. A root category contains a set of top-level categories. Each top-level category contains a set of sub-categories.

Each sub category has a set of organizations. A given organization can appear in multiple sub categories. 

The leaf nodes of this hierarchy are organizations. An organization can potentially appear in multiple sub-categories.

The data is stored in three SQL tables:

    organizations
    organization_id organization_name
    1               Org A
    2               Org B
    3               Org C
    4               Org D
    5               Org E
    6               Org F

    categories
    category_id parent_id category_name
    0           NULL      Top Level Category
    1           0         First Category
    2           0         Second Category
    3           1         Sub Category A
    4           1         Sub Category B
    5           1         Sub Category C
    6           2         Sub Category D

    organizations_categories -- Maps organizations to sub_categories
    organization_id category_id
    1               3
    2               3
    2               6
    3               4
    4               4
    5               4
    6               5
    6               4
    7               6
    8               6

I would like to be able to select a list of all unique organizations under a given category or sub-category. 

The way I'm doing it right now involves first figuring out which sub categories have been requested and then looping through each sub_category in code and performing a select to get all organizations mapped to that category. The results of each select are appended to an array. This array contains duplicates whenever an organization appears in multiple sub categories.

I would love to replace this kludge with a query that can efficiently select a list of distinct organizations given an id of one of the categories in the hierarchy.

I am devloping this solution using PHP and MySQL.

Thanks for your time and suggestions.
",3
10867772,06/03/2012 03:57:21,453748,09/21/2010 09:54:41,517,17,"Electricity off while shrinking database, how can I recover my database?","While i execute shrink database, the electricity has been gone down, I can't access my database now, it is (In Recovery), how can i recover it??
Note: it is a very huge database: 25 GB.",sql,sql-server,sql-server-2008,sql-server-2008-r2,recovery,06/03/2012 09:58:28,off topic,1,34,11,"Electricity off while shrinking database, how can I recover my database? While i execute shrink database, the electricity has been gone down, I can't access my database now, it is (In Recovery), how can i recover it??
Note: it is a very huge database: 25 GB.",5
3611164,08/31/2010 16:37:00,411274,08/04/2010 20:56:51,28,0,Import big (My)SQL file,"I got a crappy connection so I can't use apps like BigDump, that would stop if I can't stay in the page. 

What can I do? I'm looking for a way to import without the necessity of keep connected all the time...",sql,mysql,ajax,import,,,open,0,42,4,"Import big (My)SQL file I got a crappy connection so I can't use apps like BigDump, that would stop if I can't stay in the page. 

What can I do? I'm looking for a way to import without the necessity of keep connected all the time...",4
11481492,07/14/2012 06:07:39,1183979,02/01/2012 23:57:27,216,0,difference between having many non clustered index with single columns and with combination of many columns,"Folks

I am a newbie to DB design stuffs. I am wondering what would be the difference and performance difference between having designed

1. many non clustered index with single columns and non clustered index with many columns combined. 

2. Or ideally under what scenario I can combine columns to make a single non clustered index and if so, how many columns should I combine ? 

3. What is the criteria to choose the column for non clustered index ? (I am aware that its applied only to not frequent updation table)....

4. Whats the difference between 2005/2008 and 2012 SQL Server in terms of non clustered index with regard to my question and also is it 249 is the max we can create ?

Thank you in advance.",sql,sql-server,indexing,sql-server-2008-r2,non-clustered-index,07/15/2012 09:48:44,off topic,1,125,16,"difference between having many non clustered index with single columns and with combination of many columns Folks

I am a newbie to DB design stuffs. I am wondering what would be the difference and performance difference between having designed

1. many non clustered index with single columns and non clustered index with many columns combined. 

2. Or ideally under what scenario I can combine columns to make a single non clustered index and if so, how many columns should I combine ? 

3. What is the criteria to choose the column for non clustered index ? (I am aware that its applied only to not frequent updation table)....

4. Whats the difference between 2005/2008 and 2012 SQL Server in terms of non clustered index with regard to my question and also is it 249 is the max we can create ?

Thank you in advance.",5
1908782,12/15/2009 16:50:51,158740,08/18/2009 19:33:10,77,0,When to try and tune the SQL or just summarize data in a table?,"I have an `EMPLOYEE` table in a SQL Server 2008 database which stores information for employees (~80,000+) many times for each year.  For instance, there could by 10 different instances of each employees data for different years.

I'm reporting on this data via a web app, and wanted to report mostly with queries directly against the `EMPLOYEE` table, using functions to get information that needed to be computed or derived for reporting purposes.  

These functions sometimes have to refer to an `EMPLOYEE_DETAIL` table which has 100,000+ rows for each year - so now that I'm starting to write some reporting-type queries, some take around 5-10 seconds to run, which is a bit too slow.

My question is, in a situation like this, should I try and **tune functions and such so I   
can always query the data directly for reporting (real-time)**, or is a better approach to **summarize the data I need in a static table** via a procedure or saved query, and use that for any reporting?

I guess any changes in reporting needs could be reflected in the ""summarizing mechanism"" I use...but I'm torn on what to do here...",sql,sql-server,,,,,open,0,192,14,"When to try and tune the SQL or just summarize data in a table? I have an `EMPLOYEE` table in a SQL Server 2008 database which stores information for employees (~80,000+) many times for each year.  For instance, there could by 10 different instances of each employees data for different years.

I'm reporting on this data via a web app, and wanted to report mostly with queries directly against the `EMPLOYEE` table, using functions to get information that needed to be computed or derived for reporting purposes.  

These functions sometimes have to refer to an `EMPLOYEE_DETAIL` table which has 100,000+ rows for each year - so now that I'm starting to write some reporting-type queries, some take around 5-10 seconds to run, which is a bit too slow.

My question is, in a situation like this, should I try and **tune functions and such so I   
can always query the data directly for reporting (real-time)**, or is a better approach to **summarize the data I need in a static table** via a procedure or saved query, and use that for any reporting?

I guess any changes in reporting needs could be reflected in the ""summarizing mechanism"" I use...but I'm torn on what to do here...",2
11341212,07/05/2012 09:12:06,1398631,05/16/2012 12:41:15,22,1,How to transfer files at remote location using sql server job?,"I have a job configured in which it transfers the file at remote location . My command is running absolutely fine from command prompt but when I configured it in sql server job it gives log on failure unknown user name or bad password. I am not able to find out the exact reason that why this file is not being transferred. If there would be error in my code then it should not be executed from command line. 

Please help me out. 


Thanks 

Nitesh KUmar",sql,sql-server,batch-file,sqlcmd,xp-cmdshell,07/05/2012 15:01:04,off topic,1,86,11,"How to transfer files at remote location using sql server job? I have a job configured in which it transfers the file at remote location . My command is running absolutely fine from command prompt but when I configured it in sql server job it gives log on failure unknown user name or bad password. I am not able to find out the exact reason that why this file is not being transferred. If there would be error in my code then it should not be executed from command line. 

Please help me out. 


Thanks 

Nitesh KUmar",5
1742538,11/16/2009 14:34:38,30394,10/22/2008 14:48:19,194,12,I want to import data from my sql proc to csv file,"I am using sql server 2005,

I want create sql procedure will save data into csv file.

Below is the qurey I am trying but it is not creating any file in my system.

    use PBMS_DocumationWorkflow
    go
    create proc s_bcpMasterSysobjects
    as
       select   '""' + name + '""'
                + ',' + '""' + convert(varchar(8), crdate, 112) + '""'
                + ',' + '""' + convert(varchar(8), crdate, 108) + '""'
       from master..sysobjects
       order by crdate desc
    go
    declare @sql varchar(8000)
    select @sql = 'bcp ""exec PBMS_DocumationWorkflow..s_bcpMasterSysobjects""
                    out c:\bcp\sysobjects.txt -c -t, -T -S'+ @@servername
    exec master..xp_cmdshell @sql

please suggest the cause or give me sample code which works fine.

Thanks.

",sql,sql-server-2005,,,,,open,0,195,12,"I want to import data from my sql proc to csv file I am using sql server 2005,

I want create sql procedure will save data into csv file.

Below is the qurey I am trying but it is not creating any file in my system.

    use PBMS_DocumationWorkflow
    go
    create proc s_bcpMasterSysobjects
    as
       select   '""' + name + '""'
                + ',' + '""' + convert(varchar(8), crdate, 112) + '""'
                + ',' + '""' + convert(varchar(8), crdate, 108) + '""'
       from master..sysobjects
       order by crdate desc
    go
    declare @sql varchar(8000)
    select @sql = 'bcp ""exec PBMS_DocumationWorkflow..s_bcpMasterSysobjects""
                    out c:\bcp\sysobjects.txt -c -t, -T -S'+ @@servername
    exec master..xp_cmdshell @sql

please suggest the cause or give me sample code which works fine.

Thanks.

",2
3767356,09/22/2010 08:04:11,243782,01/05/2010 09:37:40,11415,634,Have week number how to compute last day of the week?,"I have the week number and year as separate fields in MySQL, how do I compute the last day of the week(Sunday) in the given year?",sql,mysql,,,,,open,0,26,11,"Have week number how to compute last day of the week? I have the week number and year as separate fields in MySQL, how do I compute the last day of the week(Sunday) in the given year?",2
8575846,12/20/2011 13:01:15,276095,02/18/2010 13:32:00,226,1,More security in Sql Server,I have a Web Application using a database in SQL Server 2008. I am developer of project and this project has been hosted in elsewhere. I've delivered the project to Administrator. Administrator can connect to Sql Server But I don't want that he able to see database tables and data tables. Is there any way to do this?,sql,sql-server,security,sql-server-2008,encryption,12/21/2011 02:14:34,off topic,1,58,5,More security in Sql Server I have a Web Application using a database in SQL Server 2008. I am developer of project and this project has been hosted in elsewhere. I've delivered the project to Administrator. Administrator can connect to Sql Server But I don't want that he able to see database tables and data tables. Is there any way to do this?,5
11658127,07/25/2012 20:31:28,813040,06/23/2011 20:23:55,772,46,What are the disallowed characters for a VARCHAR2 in Oracle?,"I have a dropdown list, which populates by querying a column called USERS.

I had a problem where the dropdown would not populate when one of the records had a `$` symbol in it. 

But, now I queried the columns, and there are no $symbols. What other characters are disallowed, similar to $? I wasn't able to find a comprehensive list anywhere.",sql,oracle,,,,07/26/2012 11:10:11,not a real question,1,61,10,"What are the disallowed characters for a VARCHAR2 in Oracle? I have a dropdown list, which populates by querying a column called USERS.

I had a problem where the dropdown would not populate when one of the records had a `$` symbol in it. 

But, now I queried the columns, and there are no $symbols. What other characters are disallowed, similar to $? I wasn't able to find a comprehensive list anywhere.",2
6299035,06/09/2011 20:46:00,786217,06/06/2011 16:11:31,8,0,SQL Query Select OR using another Table,"How can I make this work ?

strQuery = ""SELECT UNIT_NO,DRIVER1,DRIVER2,PHONENUMBER,PHONENUMBER_2,PHONE1,PHONENUM2 from UNITS where PHONENUMBER="" & objRS(""PHONE"") & "" OR "" & PHONENUMBER_2="" & objRS(""PHONE"") & "" OR "" & PHONE1="" & objRS(""PHONE"") & "" OR "" & PHONENUM2="" & objRS(""PHONE"")""


Thanks for any help...
",sql,sql-server-2008,,,,06/09/2011 20:50:57,not a real question,1,43,7,"SQL Query Select OR using another Table How can I make this work ?

strQuery = ""SELECT UNIT_NO,DRIVER1,DRIVER2,PHONENUMBER,PHONENUMBER_2,PHONE1,PHONENUM2 from UNITS where PHONENUMBER="" & objRS(""PHONE"") & "" OR "" & PHONENUMBER_2="" & objRS(""PHONE"") & "" OR "" & PHONE1="" & objRS(""PHONE"") & "" OR "" & PHONENUM2="" & objRS(""PHONE"")""


Thanks for any help...
",2
6675839,07/13/2011 08:02:13,842232,07/13/2011 07:56:01,1,0,"Difference between openrowset,Linked server,Opendatasource","Difference between openrowset,Linked server,Opendatasource and openquery in sql server",sql,,,,,07/13/2011 23:44:35,not a real question,1,9,4,"Difference between openrowset,Linked server,Opendatasource Difference between openrowset,Linked server,Opendatasource and openquery in sql server",1
7729238,10/11/2011 16:19:06,101827,05/05/2009 20:31:44,3984,171,"Oracle SQL query fails only in one process: ""ORA-01405: fetched column value is NULL""","I'm trying to call a system stored procedure in a ""plugin"" that I've built. When I test my plugin out in a test application, it works fine. When I run the plugin in the targeted app I'm building it for, I get an exception from Oracle that doesn't make any sense.

I'm using Oracle server 11.2.0.1.0, and ODP.NET 2.112.2.0.

Here's the debug trace from ODP.NET from my test app:

    (ENTRY) OracleConnection::OracleConnection(1)
    (POOL)  New connection pool created for: ""Data Source=orcl;User ID=scott;""
    (ENTRY) OracleConnection::CreateCommand()
    OpsSqlPrepare2():SQL: begin DBMS_AQADM.START_QUEUE(queue_name => 'MyQueue'); end;
    (EXIT)  OpsSqlExecuteNonQuery(): RetCode=0 Line=877
    (EXIT)  OracleCommand::ExecuteNonQuery()
    (ENTRY) OracleConnection::Dispose()
    (ENTRY) OracleConnection::Close()

And here's debug trace from ODP.NET from the same code running in the targeted app:

    (ENTRY) OracleConnection::OracleConnection(1)
    (POOL)  New connection pool created for: ""Data Source=orcl;User ID=scott;""
    (ENTRY) OracleConnection::CreateCommand()
    OpsSqlPrepare2():SQL: begin DBMS_AQADM.START_QUEUE(queue_name => 'MyQueue'); end;
    (EXIT)  OpsSqlExecuteNonQuery(): RetCode=0 Line=877
    (EXIT)  OracleCommand::ExecuteNonQuery()
    (ENTRY) OpsErrGetOpoCtx()
    (ERROR) Oracle error code=1405; ORA-01405: fetched column value is NULL
    (EXIT)  OpsErrGetOpoCtx(): RetCode=0 Line=137
    (ENTRY) OracleConnection::Dispose()
    (ENTRY) OracleConnection::Close()

I'm at a loss as to what could be different between the test/target applications. Both processes are running as members of the local Administrators group. Both are using the same connection string. Both are running the same .NET code, but with a different outcome from the database server. What could be going on here?",sql,oracle,stored-procedures,odp.net,advanced-queuing,,open,0,272,14,"Oracle SQL query fails only in one process: ""ORA-01405: fetched column value is NULL"" I'm trying to call a system stored procedure in a ""plugin"" that I've built. When I test my plugin out in a test application, it works fine. When I run the plugin in the targeted app I'm building it for, I get an exception from Oracle that doesn't make any sense.

I'm using Oracle server 11.2.0.1.0, and ODP.NET 2.112.2.0.

Here's the debug trace from ODP.NET from my test app:

    (ENTRY) OracleConnection::OracleConnection(1)
    (POOL)  New connection pool created for: ""Data Source=orcl;User ID=scott;""
    (ENTRY) OracleConnection::CreateCommand()
    OpsSqlPrepare2():SQL: begin DBMS_AQADM.START_QUEUE(queue_name => 'MyQueue'); end;
    (EXIT)  OpsSqlExecuteNonQuery(): RetCode=0 Line=877
    (EXIT)  OracleCommand::ExecuteNonQuery()
    (ENTRY) OracleConnection::Dispose()
    (ENTRY) OracleConnection::Close()

And here's debug trace from ODP.NET from the same code running in the targeted app:

    (ENTRY) OracleConnection::OracleConnection(1)
    (POOL)  New connection pool created for: ""Data Source=orcl;User ID=scott;""
    (ENTRY) OracleConnection::CreateCommand()
    OpsSqlPrepare2():SQL: begin DBMS_AQADM.START_QUEUE(queue_name => 'MyQueue'); end;
    (EXIT)  OpsSqlExecuteNonQuery(): RetCode=0 Line=877
    (EXIT)  OracleCommand::ExecuteNonQuery()
    (ENTRY) OpsErrGetOpoCtx()
    (ERROR) Oracle error code=1405; ORA-01405: fetched column value is NULL
    (EXIT)  OpsErrGetOpoCtx(): RetCode=0 Line=137
    (ENTRY) OracleConnection::Dispose()
    (ENTRY) OracleConnection::Close()

I'm at a loss as to what could be different between the test/target applications. Both processes are running as members of the local Administrators group. Both are using the same connection string. Both are running the same .NET code, but with a different outcome from the database server. What could be going on here?",5
9431082,02/24/2012 12:51:09,1230765,02/24/2012 12:33:49,1,0,MYSQL Query issue with my query by jinesh,"       SELECT p.INVOICE_PAYMENT_ID,i.INVOICE_ID,i.INVOICE_NUMBER,i.CLINIC_ID,i.INVOICE_DATE,i.PAYMENT_RECEIVED_DATE, i.AMOUNT, i.CURRENT_CHARGE,i.AMOUNT_RECEIVED,i.MONTH,i.YEAR,i.COMPANY_ID,
i.COMPANY_NAME,c.NAME,p.NOTE,i.NOTES
            FROM test1 i 
            LEFT JOIN test2 c ON (i.CLINIC_ID=c.CLINIC_ID)
            LEFT JOIN test3 p ON p.INVOICE_ID=i.INVOICE_ID  
     WHERE i.MONTH=11 AND i.YEAR=2011                     
   AND  p.INVOICE_PAYMENT_ID IN (SELECT MAX(INVOICE_PAYMENT_ID) FROM test3 WHERE INVOICE_ID=i.INVOICE_ID )


i have problem with the above query that, if the inner query has no value then it does not return all the corresponding rows in test3.Please help me to fix this issue
",sql,,,,,,open,0,135,8,"MYSQL Query issue with my query by jinesh        SELECT p.INVOICE_PAYMENT_ID,i.INVOICE_ID,i.INVOICE_NUMBER,i.CLINIC_ID,i.INVOICE_DATE,i.PAYMENT_RECEIVED_DATE, i.AMOUNT, i.CURRENT_CHARGE,i.AMOUNT_RECEIVED,i.MONTH,i.YEAR,i.COMPANY_ID,
i.COMPANY_NAME,c.NAME,p.NOTE,i.NOTES
            FROM test1 i 
            LEFT JOIN test2 c ON (i.CLINIC_ID=c.CLINIC_ID)
            LEFT JOIN test3 p ON p.INVOICE_ID=i.INVOICE_ID  
     WHERE i.MONTH=11 AND i.YEAR=2011                     
   AND  p.INVOICE_PAYMENT_ID IN (SELECT MAX(INVOICE_PAYMENT_ID) FROM test3 WHERE INVOICE_ID=i.INVOICE_ID )


i have problem with the above query that, if the inner query has no value then it does not return all the corresponding rows in test3.Please help me to fix this issue
",1
2163137,01/29/2010 15:57:39,122528,06/13/2009 18:06:38,282,1,Sql Query With GroupBys - Impossible Query,"I have the following: 

Name	Age	When
Paul	21	01-Jan-10
Paul	54	01-Jan-11
Paul	65	01-Jan-12


I want to pull out all names and that age wherer the date is >= 01-Jan-11

I ve tried

SELECT NAME, AGE, MIN(When)
FROM ATABLE
WHERE When >= '01-Jan-11'
GROUP BY NAME, AGE

That did not work ",sql,c#,,,,,open,0,36,7,"Sql Query With GroupBys - Impossible Query I have the following: 

Name	Age	When
Paul	21	01-Jan-10
Paul	54	01-Jan-11
Paul	65	01-Jan-12


I want to pull out all names and that age wherer the date is >= 01-Jan-11

I ve tried

SELECT NAME, AGE, MIN(When)
FROM ATABLE
WHERE When >= '01-Jan-11'
GROUP BY NAME, AGE

That did not work ",2
9560918,03/05/2012 02:26:16,94169,04/22/2009 07:23:56,3049,12,Good reference for SQL to use with SQL Server 2008,I had been working on Oracle long time back and has exposure to SQL. Now I need to brush up my SQL skills for a project on SQL Server 2008. Could you please recommend a good resource (online/book)?,sql,sql-server,sql-server-2008,,,03/06/2012 15:22:41,off topic,1,38,10,Good reference for SQL to use with SQL Server 2008 I had been working on Oracle long time back and has exposure to SQL. Now I need to brush up my SQL skills for a project on SQL Server 2008. Could you please recommend a good resource (online/book)?,3
9610361,03/07/2012 22:51:52,1081326,12/05/2011 10:10:00,42,0,"SQL Greater than, Equal to AND Less Than","I want to create a query like the following, But im unsure of how to code it correctly, 
I want it to return all bookings within 1 hour of a StartTime, Here is what i came up with:

    SELECT BookingId, StartTime
    FROM Booking
    WHERE StartTime <=> 1.00


Is the possible? or Is there a way round it?

Everything ive found on the web hasn't been about using  Greater than,  Equal to and Less Than all in the same query.
",sql,select,,,,,open,0,88,8,"SQL Greater than, Equal to AND Less Than I want to create a query like the following, But im unsure of how to code it correctly, 
I want it to return all bookings within 1 hour of a StartTime, Here is what i came up with:

    SELECT BookingId, StartTime
    FROM Booking
    WHERE StartTime <=> 1.00


Is the possible? or Is there a way round it?

Everything ive found on the web hasn't been about using  Greater than,  Equal to and Less Than all in the same query.
",2
3045664,06/15/2010 13:39:02,88734,04/08/2009 18:19:04,204,12,How to create a MySQL query for time based elements with a 'safe window'?,"
I am no SQL expert, far from it.  I am writing a Rails application, and I am new at that as well.  I come from a desktop programming background.

My application has a table of data, one of the columns is the time at which the data was logged.  I want to create a query with a 'safe window' around EACH row.  By that I mean, it returns the first row, then for X minutes (based on the timelogged column) it won't return any data, once X minutes is up, it will return the next row.

For example:

    ID | TimeLogged
    1  | 3/5/2010 12:01:01
    2  | 3/5/2010 12:01:50
    3  | 3/5/2010 12:02:03
    4  | 3/5/2010 12:10:30
    5  | 3/5/2010 01:30:03
    6  | 3/5/2010 01:31:05

With a 'safe window' of 5 minutes I want to create a query to return:

    1  | 3/5/2010 12:01:01
    4  | 3/5/2010 12:10:30
    5  | 3/5/2010 01:30:03

(It skipped the 12:01:50 and 12:02:03 items because they occurred within 5 minutes of the first item.)

Another example, with a 'safe window' of 15 minutes I want to return:

    1  | 3/5/2010 12:01:01
    5  | 3/5/2010 01:30:03

Perhaps I have to just return all data and parse it myself?",sql,ruby-on-rails,mysql,,,,open,0,247,14,"How to create a MySQL query for time based elements with a 'safe window'? 
I am no SQL expert, far from it.  I am writing a Rails application, and I am new at that as well.  I come from a desktop programming background.

My application has a table of data, one of the columns is the time at which the data was logged.  I want to create a query with a 'safe window' around EACH row.  By that I mean, it returns the first row, then for X minutes (based on the timelogged column) it won't return any data, once X minutes is up, it will return the next row.

For example:

    ID | TimeLogged
    1  | 3/5/2010 12:01:01
    2  | 3/5/2010 12:01:50
    3  | 3/5/2010 12:02:03
    4  | 3/5/2010 12:10:30
    5  | 3/5/2010 01:30:03
    6  | 3/5/2010 01:31:05

With a 'safe window' of 5 minutes I want to create a query to return:

    1  | 3/5/2010 12:01:01
    4  | 3/5/2010 12:10:30
    5  | 3/5/2010 01:30:03

(It skipped the 12:01:50 and 12:02:03 items because they occurred within 5 minutes of the first item.)

Another example, with a 'safe window' of 15 minutes I want to return:

    1  | 3/5/2010 12:01:01
    5  | 3/5/2010 01:30:03

Perhaps I have to just return all data and parse it myself?",3
3601718,08/30/2010 15:15:08,414507,08/08/2010 18:01:12,6,0,How do I add a record in my database when it is coming from a checklist box control from vb.net?,"I'm having trouble on how to code this. First I need to assign a value for every item in the list(1 for the first item, 2 for the 2nd and so on) Does this control have a separate field for the value aside from text?

Second, I need to insert this into my database(MSSQL 2008) in this format:

insert into table values(ID, *selectedvaluegoeshere*)

Can someone guide me on how to achieve this.",sql,database,vb.net,checklist,,,open,0,69,20,"How do I add a record in my database when it is coming from a checklist box control from vb.net? I'm having trouble on how to code this. First I need to assign a value for every item in the list(1 for the first item, 2 for the 2nd and so on) Does this control have a separate field for the value aside from text?

Second, I need to insert this into my database(MSSQL 2008) in this format:

insert into table values(ID, *selectedvaluegoeshere*)

Can someone guide me on how to achieve this.",4
6917429,08/02/2011 19:24:03,304661,03/29/2010 22:59:19,53,2,Referring to a column in the first query from the second query in T-SQL UNION,"I have two SELECT statements that are UNIONed, as in the pseudo code below

    SELECT A.itemCode, A.itemDescription, A.Cost
    FROM someTable A
    UNION
    SELECT B.itemCode, B.itemDescription, ***IwantTheSumOfAllCostsInTheFirstQuery*** as Cost
    FROM yetAnotherTable B

The expected result is

    itemCode         itemDescription                           Cost
    A000001          This is Item01 From SomeTable             15
    A000002          This is Item02 From SomeTable             16
    Total            This is Total From YetAnotherTable        31

In my case, the second query will always return one row and the Cost value should be the sum of all the Cost Values in first query. 

How can one accomplish this? I've tried every approach I'm familiar with, but couldn't make it work. Please help and Thank you SOF community. ",sql,tsql,select,union,aggregate,,open,0,230,15,"Referring to a column in the first query from the second query in T-SQL UNION I have two SELECT statements that are UNIONed, as in the pseudo code below

    SELECT A.itemCode, A.itemDescription, A.Cost
    FROM someTable A
    UNION
    SELECT B.itemCode, B.itemDescription, ***IwantTheSumOfAllCostsInTheFirstQuery*** as Cost
    FROM yetAnotherTable B

The expected result is

    itemCode         itemDescription                           Cost
    A000001          This is Item01 From SomeTable             15
    A000002          This is Item02 From SomeTable             16
    Total            This is Total From YetAnotherTable        31

In my case, the second query will always return one row and the Cost value should be the sum of all the Cost Values in first query. 

How can one accomplish this? I've tried every approach I'm familiar with, but couldn't make it work. Please help and Thank you SOF community. ",5
7456921,09/17/2011 18:26:31,941576,09/13/2011 00:24:10,8,0,RDMS GRANT privileges vs REST services,There are many services with REST interface. However they use REST rather than allow operate with database. Why no love to RDBMS? Is this insecure or something?,sql,database,rest,server,rdbms,,open,0,27,6,RDMS GRANT privileges vs REST services There are many services with REST interface. However they use REST rather than allow operate with database. Why no love to RDBMS? Is this insecure or something?,5
9247118,02/12/2012 07:12:01,1010975,10/24/2011 13:46:44,20,0,large database needed for Solr Index speed test,"I want to make a large MS SQL data base to compare the indexing speed of Full Text search and solar. How can I do it? 
Do  you have any comparison results or other suggestions?

best",sql,solr,index,ms,,02/12/2012 12:43:36,off topic,1,36,8,"large database needed for Solr Index speed test I want to make a large MS SQL data base to compare the indexing speed of Full Text search and solar. How can I do it? 
Do  you have any comparison results or other suggestions?

best",4
8956577,01/21/2012 20:50:30,921739,08/31/2011 13:49:18,3,1,How can I correct the correlation names on this sql join?,"I need a join that yields three fields with the same name from two different tables. When I try to run my sql query, VS gives me the following error.

> The objects ""PoliticalFigures"" and ""PoliticalFigures"" in the FROM clause have the same exposed names. Use correlation names to distinguish them.

I've been trying to use ""AS"" to distinguish these fields, but I haven't found a working solution. This is the sql query I'm running:

    SELECT Countries.Name AS Country, PoliticalFigures.Name AS President, PoliticalFigures.Name AS VicePresident FROM Countries
    LEFT OUTER JOIN PoliticalFigures ON Countries.President_Id = PoliticalFigures.Id
    LEFT OUTER JOIN PoliticalFigures ON Countries.VicePresident_Id = PoliticalFigures.Id

If it's not obvious from the code, these are the tables.

- Countries: Id, Name, President_Id, VicePresident_Id.
- PoliticalFigures: Id, Name.
- Joined table: Country, President, VicePresident

(Note, the tables and fields in my application have different names. I am generalizing them to make this example clearer and *hopefully* more relevant to others.)

(The tools I'm using are Visual Web Developer 2010 Express and SQL Server 2008 Express.)",sql,sql-server,database,,,,open,0,172,11,"How can I correct the correlation names on this sql join? I need a join that yields three fields with the same name from two different tables. When I try to run my sql query, VS gives me the following error.

> The objects ""PoliticalFigures"" and ""PoliticalFigures"" in the FROM clause have the same exposed names. Use correlation names to distinguish them.

I've been trying to use ""AS"" to distinguish these fields, but I haven't found a working solution. This is the sql query I'm running:

    SELECT Countries.Name AS Country, PoliticalFigures.Name AS President, PoliticalFigures.Name AS VicePresident FROM Countries
    LEFT OUTER JOIN PoliticalFigures ON Countries.President_Id = PoliticalFigures.Id
    LEFT OUTER JOIN PoliticalFigures ON Countries.VicePresident_Id = PoliticalFigures.Id

If it's not obvious from the code, these are the tables.

- Countries: Id, Name, President_Id, VicePresident_Id.
- PoliticalFigures: Id, Name.
- Joined table: Country, President, VicePresident

(Note, the tables and fields in my application have different names. I am generalizing them to make this example clearer and *hopefully* more relevant to others.)

(The tools I'm using are Visual Web Developer 2010 Express and SQL Server 2008 Express.)",3
11719234,07/30/2012 10:03:08,683741,03/30/2011 10:28:43,438,16,SQL Server - In Recovery,"Was uploading a few hundred thousand rows in my SQL 2008 R1 database and have come in this morning to an ""In Recovery"" message next to the database name in SQL Management Studio.

I've tried a DBCC CheckDB, which returns  `CHECKDB found 0 allocation errors and 0 consistency errors in database 'DBName'.
DBCC execution completed. If DBCC printed error messages, contact your system administrator.`  When I check the status (state_desc) in sys.databases, it returns `ONLINE`.  In fact, nothing in the sys.databases table looks out of the ordinary. 

I can't get rid of In Recovery though, and I don't want to just restart.  Is there any way of telling how long it will be like this for, or are there any other problems I can check for?
",sql,sql-server,,,,07/31/2012 01:48:34,off topic,1,128,5,"SQL Server - In Recovery Was uploading a few hundred thousand rows in my SQL 2008 R1 database and have come in this morning to an ""In Recovery"" message next to the database name in SQL Management Studio.

I've tried a DBCC CheckDB, which returns  `CHECKDB found 0 allocation errors and 0 consistency errors in database 'DBName'.
DBCC execution completed. If DBCC printed error messages, contact your system administrator.`  When I check the status (state_desc) in sys.databases, it returns `ONLINE`.  In fact, nothing in the sys.databases table looks out of the ordinary. 

I can't get rid of In Recovery though, and I don't want to just restart.  Is there any way of telling how long it will be like this for, or are there any other problems I can check for?
",2
9804962,03/21/2012 12:49:26,541917,08/07/2010 06:02:10,399,33,About Learning and Using SQL Statements,"I want to learn about the rules in which a sql statement can be formed.

Like the columns in the select should be in group by or should be aggregate, what are the functions allowed in the select clause in case of expression columns etc.

Like what fields should be allowed in a filter condition for a selected set of tables etc.

**EDIT** 

how does the grouping of columns work and in which order. How do i infer the groups from the query output and like these doubts.

Can anyone suggest good resources [links or books] where i can learn about all these techniques and rules or tips.",sql,,,,,05/15/2012 06:52:43,not constructive,1,104,6,"About Learning and Using SQL Statements I want to learn about the rules in which a sql statement can be formed.

Like the columns in the select should be in group by or should be aggregate, what are the functions allowed in the select clause in case of expression columns etc.

Like what fields should be allowed in a filter condition for a selected set of tables etc.

**EDIT** 

how does the grouping of columns work and in which order. How do i infer the groups from the query output and like these doubts.

Can anyone suggest good resources [links or books] where i can learn about all these techniques and rules or tips.",1
7523615,09/23/2011 02:20:58,834597,07/08/2011 01:41:57,95,2,sql query to create a new table,"I have a table as follows:
table 1

    temp_id    node_name  variable_1 variable_2 variable_3
    1          ab         a          b           y
    2          sdd        a          a           a
    3          u          a          s           s

and another table as follows:
table 2

    temp_id    node_name  variable_1 variable_2 variable_3
    1          ab         as        sb           y
    2          sdd        a          a           a
    3          u          a          s           s

I want to fetch all the records from table 1 where the combination variable_1, variable_2 and variable_3 of table 1 doesnot match with table 2.
for example in table 1 first record has a,b,y (variable_1, variable_2 and variable_3) and it this does not exists in table2.

How can I do that in TSQL?",sql,tsql,,,,09/24/2011 00:45:51,too localized,1,348,7,"sql query to create a new table I have a table as follows:
table 1

    temp_id    node_name  variable_1 variable_2 variable_3
    1          ab         a          b           y
    2          sdd        a          a           a
    3          u          a          s           s

and another table as follows:
table 2

    temp_id    node_name  variable_1 variable_2 variable_3
    1          ab         as        sb           y
    2          sdd        a          a           a
    3          u          a          s           s

I want to fetch all the records from table 1 where the combination variable_1, variable_2 and variable_3 of table 1 doesnot match with table 2.
for example in table 1 first record has a,b,y (variable_1, variable_2 and variable_3) and it this does not exists in table2.

How can I do that in TSQL?",2
6936345,08/04/2011 04:52:49,877857,08/04/2011 04:41:52,1,0,why Sql value change after updating data?,"I am running a site which is showing Alexa Ranking. The function to get Alexa Rank is working fine but when it insert the alexa rank from 1 to 10 to sql then why the value changes to 10, not 1,2,3,4,5,6,7,8,9.

If the Alexa rank is 11+ then its showing fine, just not showing the Alexa ranking from 1 to 10.. its showing 10 instead. 

What's the solution of it.?

Any help will be highly appreciated.",sql,,,,,08/04/2011 05:47:28,not a real question,1,74,7,"why Sql value change after updating data? I am running a site which is showing Alexa Ranking. The function to get Alexa Rank is working fine but when it insert the alexa rank from 1 to 10 to sql then why the value changes to 10, not 1,2,3,4,5,6,7,8,9.

If the Alexa rank is 11+ then its showing fine, just not showing the Alexa ranking from 1 to 10.. its showing 10 instead. 

What's the solution of it.?

Any help will be highly appreciated.",1
4843735,01/30/2011 15:39:20,508284,11/15/2010 13:22:30,138,1,Books about sql security,"Can anybody advice me some goods books for sql protection from hackers. Where will be Clearly explained how hackers work and how to secure sql
Thanks",sql,security,hacking,,,09/22/2011 00:51:22,not constructive,1,25,4,"Books about sql security Can anybody advice me some goods books for sql protection from hackers. Where will be Clearly explained how hackers work and how to secure sql
Thanks",3
11732866,07/31/2012 03:56:35,1160352,01/20/2012 09:56:16,151,6,How to use variables for paramater in execute a store procedure?,"I've declare and set some variables. then I want to use that variables value for parameter in executing a store procedure. but I always get error `Must declare the scalar variable`.

here is my variables:

    --declare variables for parameter @listweek
    declare @tgl_id varchar(50);
    declare @tgl_sg varchar(50) ;
    declare @tgl_other varchar(50);
        
    --set variables for parameter @listweek
    set @tgl_id = (select top 1 ltrim(rtrim(cast(numweek as char)))+'-('+rangeweek+')' from tbl_weeklyflash_id where year([date]) = year(getdate()) order by numweek desc);
    set @tgl_sg = (select top 1 ltrim(rtrim(cast(numweek as char)))+'-('+rangeweek+')' from tbl_weeklyflashsg where year(del_date) = year(getdate()) order by numweek desc);
    set @tgl_other = (select top 1 ltrim(rtrim(cast(numweek as char)))+'-('+rangeweek+')' from tbl_weeklyflash where year(dates) = year(getdate()) order by numweek desc);
    
    --the variable values should be like this 30-(01-03-2012 - 08-03-2012) 
    --and this value that I want to use as parameter value in executing stored procedure

and this is the executing stored procedure:

    insert into my_table (field1, field2, field3)
    EXEC my_store_procedure @tgl_other
    -- the parameter for my_store_procedure is like '30-(01-03-2012 - 08-03-2012)'

is it my variables not correct? or I've wrong way to use variable for parameter? ",sql,sql-server,,,,,open,0,228,11,"How to use variables for paramater in execute a store procedure? I've declare and set some variables. then I want to use that variables value for parameter in executing a store procedure. but I always get error `Must declare the scalar variable`.

here is my variables:

    --declare variables for parameter @listweek
    declare @tgl_id varchar(50);
    declare @tgl_sg varchar(50) ;
    declare @tgl_other varchar(50);
        
    --set variables for parameter @listweek
    set @tgl_id = (select top 1 ltrim(rtrim(cast(numweek as char)))+'-('+rangeweek+')' from tbl_weeklyflash_id where year([date]) = year(getdate()) order by numweek desc);
    set @tgl_sg = (select top 1 ltrim(rtrim(cast(numweek as char)))+'-('+rangeweek+')' from tbl_weeklyflashsg where year(del_date) = year(getdate()) order by numweek desc);
    set @tgl_other = (select top 1 ltrim(rtrim(cast(numweek as char)))+'-('+rangeweek+')' from tbl_weeklyflash where year(dates) = year(getdate()) order by numweek desc);
    
    --the variable values should be like this 30-(01-03-2012 - 08-03-2012) 
    --and this value that I want to use as parameter value in executing stored procedure

and this is the executing stored procedure:

    insert into my_table (field1, field2, field3)
    EXEC my_store_procedure @tgl_other
    -- the parameter for my_store_procedure is like '30-(01-03-2012 - 08-03-2012)'

is it my variables not correct? or I've wrong way to use variable for parameter? ",2
7600392,09/29/2011 16:25:43,838092,07/11/2011 01:15:39,25,0,SQL -- Can't figure out how to get rows based on column values that aren't identical,"My problem is this:

Say I hypothetically have a table called fastfood which has one field called fastfood_chains that have values of ""Awesome Wendys"" and ""Peanut Chuck""  

Then I have another table called fastfood_info that has a field ""fastfood_chain"" but the values aren't identical to the other table, it's shortened to ""Wendys"" or ""Chucks"" 

How would I display all the rows from fastfood_chain and have the results print the full name using the other table instead of just ""Wendys"" or ""Chucks"" ? 

I assumed it had something to do with the LIKE statement but I'm having difficulties. Any help would be appreciated, thanks!",sql,table,columns,like,,,open,0,103,16,"SQL -- Can't figure out how to get rows based on column values that aren't identical My problem is this:

Say I hypothetically have a table called fastfood which has one field called fastfood_chains that have values of ""Awesome Wendys"" and ""Peanut Chuck""  

Then I have another table called fastfood_info that has a field ""fastfood_chain"" but the values aren't identical to the other table, it's shortened to ""Wendys"" or ""Chucks"" 

How would I display all the rows from fastfood_chain and have the results print the full name using the other table instead of just ""Wendys"" or ""Chucks"" ? 

I assumed it had something to do with the LIKE statement but I'm having difficulties. Any help would be appreciated, thanks!",4
1946279,12/22/2009 13:07:19,82961,03/26/2009 05:55:07,406,49,Does SQL Resource Governor re-allocate resources during execution of a query?,"Say, I have two users (U1, U2) mapped to two resource pools (R1, R2) and with max values as 20% and 80%. U1 executes a time consuming query that runs for say 15 minutes. When it started execution it was the only process and hence SQL server allocates full resources to this query. 5 minutes later U2 executes another query. Will Resource Governor reduce the resources of U1 to 20% and allow U2 to take 80% or will it wait for U1 to complete and then allow U2 80%.

I agree that the first case is what is expected but I saw [this post][1] and got curious. Please explain what will happen in the real scenario.


  [1]: http://blog.namwarrizvi.com/?p=212",sql,sql-server-2008,resource-governor,,,,open,0,118,11,"Does SQL Resource Governor re-allocate resources during execution of a query? Say, I have two users (U1, U2) mapped to two resource pools (R1, R2) and with max values as 20% and 80%. U1 executes a time consuming query that runs for say 15 minutes. When it started execution it was the only process and hence SQL server allocates full resources to this query. 5 minutes later U2 executes another query. Will Resource Governor reduce the resources of U1 to 20% and allow U2 to take 80% or will it wait for U1 to complete and then allow U2 80%.

I agree that the first case is what is expected but I saw [this post][1] and got curious. Please explain what will happen in the real scenario.


  [1]: http://blog.namwarrizvi.com/?p=212",3
10726677,05/23/2012 19:37:19,1413439,05/23/2012 19:17:46,1,0,SQL Select same fields with different dates,"I have a query that I need to run for some data.  Basically I have 3 unique fields, and 3 more that need to be repeated for time ranges.  So that I will have three sub queries within the primary select statement.  I've been only experimenting with just the one sub query get that working and then copy n pasting the other two and changing the date range.

Here is the SQL that I've come up with but it gives me an error.  I'm trying to use sub queries since I don't have perms to create procedures.

    SELECT
    mon.description as ScriptName,
    up0.pageseqnum as PageSeq,
    usd.DisplayName as PageName,
    
    --This subquery is the one week old data for the Response Time, Page Weight, and Number of Objects.
    (SELECT
    ROUND(AVG(CAST(up1.ResponseTime AS FLOAT)* 0.001),3) AS ResponseTime,
    ROUND(AVG(CAST(up1.numbytes AS FLOAT)* 0.001), 3) AS NumberofKilobytes,
    CONVERT(INT,AVG(up1.numobj),0) AS NumberOfObjects
    FROM
    table0 AS up1
    WHERE
    up1.Monitor_Id = up0.Monitor_id
    AND up1.TestTime BETWEEN DATEADD(HOUR,4,'2012-05-14 00:00:00') AND DATEADD(HOUR,4,'2012-05-21 00:00:00')
    AND ISNULL(up1.ContentMatchStatus,'0')= 0
    AND up1.UserScriptStatus = 0
    AND up1.TimeoutStatus = 0
    AND up1.ResponseTime > 0
    ) AS CurrentWeek
    
    FROM
    table0 (nolock) AS up0
    JOIN table1 usd ON up0.Monitor_Id=usd.monitor_id
    and up0.PageSeqNum=usd.PageSeqNum
    JOIN table3 mon on up0.Monitor_Id = mon.Monitor_id
    
    WHERE
    up0.Monitor_Id in (1, 2, 3, 4, 5, 6, 7, 8 ,9 ,10)
    
    GROUP BY up0.Monitor_Id, mon.Description, up0.PageSeqNum, usd.DisplayName
    ORDER BY mon.Description ASC;

I'm hoping the result set should have these columns:
ScriptName | PageSeq | PageName | Current Week (with the three columns from that sub query)

Any help would be appreciated.",sql,,,,,,open,0,348,7,"SQL Select same fields with different dates I have a query that I need to run for some data.  Basically I have 3 unique fields, and 3 more that need to be repeated for time ranges.  So that I will have three sub queries within the primary select statement.  I've been only experimenting with just the one sub query get that working and then copy n pasting the other two and changing the date range.

Here is the SQL that I've come up with but it gives me an error.  I'm trying to use sub queries since I don't have perms to create procedures.

    SELECT
    mon.description as ScriptName,
    up0.pageseqnum as PageSeq,
    usd.DisplayName as PageName,
    
    --This subquery is the one week old data for the Response Time, Page Weight, and Number of Objects.
    (SELECT
    ROUND(AVG(CAST(up1.ResponseTime AS FLOAT)* 0.001),3) AS ResponseTime,
    ROUND(AVG(CAST(up1.numbytes AS FLOAT)* 0.001), 3) AS NumberofKilobytes,
    CONVERT(INT,AVG(up1.numobj),0) AS NumberOfObjects
    FROM
    table0 AS up1
    WHERE
    up1.Monitor_Id = up0.Monitor_id
    AND up1.TestTime BETWEEN DATEADD(HOUR,4,'2012-05-14 00:00:00') AND DATEADD(HOUR,4,'2012-05-21 00:00:00')
    AND ISNULL(up1.ContentMatchStatus,'0')= 0
    AND up1.UserScriptStatus = 0
    AND up1.TimeoutStatus = 0
    AND up1.ResponseTime > 0
    ) AS CurrentWeek
    
    FROM
    table0 (nolock) AS up0
    JOIN table1 usd ON up0.Monitor_Id=usd.monitor_id
    and up0.PageSeqNum=usd.PageSeqNum
    JOIN table3 mon on up0.Monitor_Id = mon.Monitor_id
    
    WHERE
    up0.Monitor_Id in (1, 2, 3, 4, 5, 6, 7, 8 ,9 ,10)
    
    GROUP BY up0.Monitor_Id, mon.Description, up0.PageSeqNum, usd.DisplayName
    ORDER BY mon.Description ASC;

I'm hoping the result set should have these columns:
ScriptName | PageSeq | PageName | Current Week (with the three columns from that sub query)

Any help would be appreciated.",1
11648159,07/25/2012 10:55:28,1493004,06/30/2012 12:50:45,1,0,Taking backup of all the databases in SQL Server,"I have a Microsoft SQL Server 2005 DB server. In the DB server, I have around 250 user databases. I have to take a back up of all these databases. Since, manually taking backup consumes lot of time, I am looking for a Batch script or DB script which will automatically take the backup of all the 250 databases. Can anyone pls help on this?",sql,database,microsoft,backup,,07/26/2012 07:40:38,off topic,1,65,9,"Taking backup of all the databases in SQL Server I have a Microsoft SQL Server 2005 DB server. In the DB server, I have around 250 user databases. I have to take a back up of all these databases. Since, manually taking backup consumes lot of time, I am looking for a Batch script or DB script which will automatically take the backup of all the 250 databases. Can anyone pls help on this?",4
6911043,08/02/2011 11:06:43,618685,02/15/2011 22:31:32,277,19,Which language and ORM to use with existing SQL database? (schema reflection),"I build integrations with *already existing* SQL databases. Ofter raw SQL queries do the trick but some task call for an ORM.

Most ORM in turn require defining the whole schema redundantly in the code.

Which (scripting?) language / ORM is subjectively nicest for working with existing databases without redefining the whole schema?

I know that e.g. [SQLAlchemy can reflect database schema][1], but still seems to require defining table relationships by hand ([another question][2]). Object relationships are already defined in SQL Foreign Keys.

  [1]: http://www.sqlalchemy.org/docs/core/schema.html#metadata-reflection
  [2]: http://stackoverflow.com/questions/6777524/how-to-automatically-reflect-table-relationships-in-sqlalchemy-or-sqlsoup-orm",sql,orm,data,foreign-keys,,08/02/2011 11:10:26,not constructive,1,86,12,"Which language and ORM to use with existing SQL database? (schema reflection) I build integrations with *already existing* SQL databases. Ofter raw SQL queries do the trick but some task call for an ORM.

Most ORM in turn require defining the whole schema redundantly in the code.

Which (scripting?) language / ORM is subjectively nicest for working with existing databases without redefining the whole schema?

I know that e.g. [SQLAlchemy can reflect database schema][1], but still seems to require defining table relationships by hand ([another question][2]). Object relationships are already defined in SQL Foreign Keys.

  [1]: http://www.sqlalchemy.org/docs/core/schema.html#metadata-reflection
  [2]: http://stackoverflow.com/questions/6777524/how-to-automatically-reflect-table-relationships-in-sqlalchemy-or-sqlsoup-orm",4
9263800,02/13/2012 16:10:25,486057,10/25/2010 04:59:48,1968,56,"Is it better to cache some value in a database table, or to recompute it each time?","For example, I have a table of bank users (user id, user name), and a table for transactions (user id, account id, amount).  
Accounts have the same properties across different users, but hold different amounts (like Alex -> Grocery, it is specific to Alex, but all other users also have Grocery account).

The question is, would it be better to create a separate table of accounts (account id, user id, amount left) or to get this value by selecting all transactions with the needed user id and account id and just summing the 'amount' values? It seems that the first approach would be faster, but more prone to error and database corruption - I would need to update accounts every time the transaction happens. The second approach seems to be cleaner, but would it lead to significant speed reduction?

What would you recommend?",sql,database,relational-database,,,,open,0,142,17,"Is it better to cache some value in a database table, or to recompute it each time? For example, I have a table of bank users (user id, user name), and a table for transactions (user id, account id, amount).  
Accounts have the same properties across different users, but hold different amounts (like Alex -> Grocery, it is specific to Alex, but all other users also have Grocery account).

The question is, would it be better to create a separate table of accounts (account id, user id, amount left) or to get this value by selecting all transactions with the needed user id and account id and just summing the 'amount' values? It seems that the first approach would be faster, but more prone to error and database corruption - I would need to update accounts every time the transaction happens. The second approach seems to be cleaner, but would it lead to significant speed reduction?

What would you recommend?",3
9980114,04/02/2012 16:28:05,1018857,10/28/2011 17:42:46,22,0,Check if entry NOT EXISTS in SQL,"I am trying to insert data from one table that was imported from an Excel file into another table with the same exact columns. When I go to insert all the data 

        INSERT INTO [NQL_RawData].[dbo].[WM_MFGPNs]
        ([Manufacturer],[MPNWP],[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy])

        SELECT [Manufacturer],dbo.BuildPNWP([MFGPN],0),[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy]

        FROM [NQL_RawData].[dbo].[wm_BulkImport] WHERE Manufacturer = 'MFG NAME'		



it comes up with this error message 



Msg 2627, Level 14, State 1, Line 1
Violation of PRIMARY KEY constraint 'PK_MFGPNs_1'. Cannot insert duplicate key in object 'dbo.WM_MFGPNs'.
The statement has been terminated.


So I changed the query to include WHERE NOT EXISTS 

        INSERT INTO [NQL_RawData].[dbo].[WM_MFGPNs]
        ([Manufacturer],[MPNWP],[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy])

        SELECT [Manufacturer],dbo.BuildPNWP([MFGPN],0),[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy]

        FROM [NQL_RawData].[dbo].[wm_BulkImport] 

        WHERE NOT EXISTS( 
		SELECT [MFGPN] 
		FROM [NQL_RawData].[dbo].[WM_MFGPNs]
		WHERE Manufacturer = 'MFG NAME'		
        )



But I still receive the same error message. Any ideas?
",sql,query,server,,,,open,0,186,7,"Check if entry NOT EXISTS in SQL I am trying to insert data from one table that was imported from an Excel file into another table with the same exact columns. When I go to insert all the data 

        INSERT INTO [NQL_RawData].[dbo].[WM_MFGPNs]
        ([Manufacturer],[MPNWP],[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy])

        SELECT [Manufacturer],dbo.BuildPNWP([MFGPN],0),[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy]

        FROM [NQL_RawData].[dbo].[wm_BulkImport] WHERE Manufacturer = 'MFG NAME'		



it comes up with this error message 



Msg 2627, Level 14, State 1, Line 1
Violation of PRIMARY KEY constraint 'PK_MFGPNs_1'. Cannot insert duplicate key in object 'dbo.WM_MFGPNs'.
The statement has been terminated.


So I changed the query to include WHERE NOT EXISTS 

        INSERT INTO [NQL_RawData].[dbo].[WM_MFGPNs]
        ([Manufacturer],[MPNWP],[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy])

        SELECT [Manufacturer],dbo.BuildPNWP([MFGPN],0),[MFGPN],[Cage],[Url],[DataSheetUrl],[Description],[Status],[NRND],[RoHS],[PbFree],[LOT],[LeadTime],[AddedOn],[AddedBy]

        FROM [NQL_RawData].[dbo].[wm_BulkImport] 

        WHERE NOT EXISTS( 
		SELECT [MFGPN] 
		FROM [NQL_RawData].[dbo].[WM_MFGPNs]
		WHERE Manufacturer = 'MFG NAME'		
        )



But I still receive the same error message. Any ideas?
",3
7148613,08/22/2011 13:59:41,808372,06/21/2011 11:58:41,1,0,the question about sql left join on?,"the question about sql left join on, What different!
(1)
select * from A  
  LEFT JOIN B  
  ON A.field = B.field
   

(2)
   select * from A  
  LEFT JOIN B  
  ON B.field = A.field





",sql,,,,,08/22/2011 14:05:21,not constructive,1,47,7,"the question about sql left join on? the question about sql left join on, What different!
(1)
select * from A  
  LEFT JOIN B  
  ON A.field = B.field
   

(2)
   select * from A  
  LEFT JOIN B  
  ON B.field = A.field





",1
8779847,01/08/2012 18:00:41,403971,05/19/2010 08:47:24,486,1,Multiple Query with IF-STATEMENT in T-SQL,"the concept i want to execute is to get the last ID in my table if that id is not in used.if in used, the ID will auto increment then return the last ID. 

    IF (SELECT COUNT(*) FROM Table) = 0
        INSERT INTO Table (Field1) VALUES (""123"");
    ELSE
        (SELECT MAX(Field1) FROM Table) AS field1Data;
    END

    IF (SELECT field2 FRom Table WHERE Field1 = field1Data) = 0
        RETURN field1Data;
    ELSE
        INSERT INTO Table (Field1) VALUES (CONVERT(field1Data, INT) + 1);
        RETURN CONVERT(field1Data, INT) + 1;
    END

any help on how to do this.. :)",sql,tsql,,,,02/24/2012 13:34:01,not a real question,1,145,6,"Multiple Query with IF-STATEMENT in T-SQL the concept i want to execute is to get the last ID in my table if that id is not in used.if in used, the ID will auto increment then return the last ID. 

    IF (SELECT COUNT(*) FROM Table) = 0
        INSERT INTO Table (Field1) VALUES (""123"");
    ELSE
        (SELECT MAX(Field1) FROM Table) AS field1Data;
    END

    IF (SELECT field2 FRom Table WHERE Field1 = field1Data) = 0
        RETURN field1Data;
    ELSE
        INSERT INTO Table (Field1) VALUES (CONVERT(field1Data, INT) + 1);
        RETURN CONVERT(field1Data, INT) + 1;
    END

any help on how to do this.. :)",2
11349960,07/05/2012 18:01:50,650148,03/08/2011 16:31:32,66,5,How to check connection string in SSMS2012?,I'm connected to database. I use db by Management Studio 2012 Express. Can I check connection string by click something in Management Studio?,sql,ssms,,,,07/08/2012 01:09:24,off topic,1,23,7,How to check connection string in SSMS2012? I'm connected to database. I use db by Management Studio 2012 Express. Can I check connection string by click something in Management Studio?,2
8155302,11/16/2011 16:40:17,560784,01/03/2011 03:01:49,15,0,Getting the value of dc:creator using SQL XML,"I am unsure how to get the value of dc:creator from an RSS-feed using SQL.
This is my xml/rss-feed:

    <rss xmlns:dc=""http://purl.org/dc/elements/1.1/"" version=""2.0"">
    <channel>
      <title>Foobar RSS</title>
      <link>http://www.foobar.com/</link>
      <description>RSS feed</description>
      <language>en</language>
      <ttl>15</ttl>
        <item>
            <title>This is my title</title>
            <link>http://www.foobar.com/link/blabla</link>
            <description>Bla..bla..bla..</description>
            <dc:creator>John Doe</dc:creator>
            <guid isPermaLink=""false"">00082EA751F1D905DE00E7CFA2417DA9</guid>
            <pubDate>Wed, 26 Oct 2011 00:00:00 +0200</pubDate>
        </item>
    </channel>
    </rss>

In my SQL I use something like this to get the values - e.g for pubDate I use something like this:

    DECLARE @xml XML
    SET @xml = cast('my rss feed here' AS xml) 
   
    SELECT
	convert(datetime,substring(T.nref.value('pubDate[1]','nvarchar(100)'),6,20)) as pubdate,
    FROM @xml.nodes('//item') AS T(nref)

This works fine, but when I am trying to get dc:creator value 'John Doe', the following just gives me an error:

    SELECT
       T.nref.value('dc:creator','nvarchar(100)') as creator
    FROM @xml.nodes('//item') AS T(nref)

       error: 
       XQuery [value()]: The name ""dc"" does not denote a namespace.

I need to be able to select multiple columns from the rss-feed. Can anybody provide a solution or direction to get the value of dc:creator?


",sql,namespaces,rss,xquery,,,open,0,309,8,"Getting the value of dc:creator using SQL XML I am unsure how to get the value of dc:creator from an RSS-feed using SQL.
This is my xml/rss-feed:

    <rss xmlns:dc=""http://purl.org/dc/elements/1.1/"" version=""2.0"">
    <channel>
      <title>Foobar RSS</title>
      <link>http://www.foobar.com/</link>
      <description>RSS feed</description>
      <language>en</language>
      <ttl>15</ttl>
        <item>
            <title>This is my title</title>
            <link>http://www.foobar.com/link/blabla</link>
            <description>Bla..bla..bla..</description>
            <dc:creator>John Doe</dc:creator>
            <guid isPermaLink=""false"">00082EA751F1D905DE00E7CFA2417DA9</guid>
            <pubDate>Wed, 26 Oct 2011 00:00:00 +0200</pubDate>
        </item>
    </channel>
    </rss>

In my SQL I use something like this to get the values - e.g for pubDate I use something like this:

    DECLARE @xml XML
    SET @xml = cast('my rss feed here' AS xml) 
   
    SELECT
	convert(datetime,substring(T.nref.value('pubDate[1]','nvarchar(100)'),6,20)) as pubdate,
    FROM @xml.nodes('//item') AS T(nref)

This works fine, but when I am trying to get dc:creator value 'John Doe', the following just gives me an error:

    SELECT
       T.nref.value('dc:creator','nvarchar(100)') as creator
    FROM @xml.nodes('//item') AS T(nref)

       error: 
       XQuery [value()]: The name ""dc"" does not denote a namespace.

I need to be able to select multiple columns from the rss-feed. Can anybody provide a solution or direction to get the value of dc:creator?


",4
8280238,11/26/2011 17:28:56,571507,01/11/2011 16:14:04,1141,61,Perfect examples of User account details or registration tables,"I am rather looking for database table schema pertaining to user registration/user account details that you people have found 

+ perfectly designed

+  can extend it

+  can work independently and 

+ has some industry best practices.

btw: how do i make this a community wiki question",sql,design,table,user,practice,11/26/2011 18:40:15,not constructive,1,46,9,"Perfect examples of User account details or registration tables I am rather looking for database table schema pertaining to user registration/user account details that you people have found 

+ perfectly designed

+  can extend it

+  can work independently and 

+ has some industry best practices.

btw: how do i make this a community wiki question",5
5786321,04/26/2011 05:29:06,209784,11/12/2009 17:00:11,136,0,db2 sql pl tutorial,does anyone know a good sql pl tutorial for db2?,sql,tutorials,pl,,,04/26/2011 13:11:25,not a real question,1,10,4,db2 sql pl tutorial does anyone know a good sql pl tutorial for db2?,3
3624763,09/02/2010 07:51:25,200066,10/31/2009 07:48:58,49,1,SQL vs noSQL build examples,Could I have a list of type of applications I should build on a sql database and a list of applications i should build on a nosql database?,sql,nosql,,,,,open,0,28,5,SQL vs noSQL build examples Could I have a list of type of applications I should build on a sql database and a list of applications i should build on a nosql database?,2
5222844,03/07/2011 17:20:42,38678,11/18/2008 19:46:55,61,3,How to JOIN a table only if results have specific parameter,"I need to get the user_name from all users that have completed 2 or more classes giving the following table structure...

    table users
    ===============================
    user_id     |   user_name
    ===============================
    1234            completed_two
    1235            completed_cero
    1236            completed_one
    1237            completed_two_no_survey

    table class_registration
    ========================================================================
    reg_id  | class_id    |   class_type      |   user_id     |   attendance
    ========================================================================
    1            1            stress                1234            1
    2            1            stress                1236            1
    3            2            who_cares             1234            1
    4            1            stress                1235            0
    5            5            nutrition             1236            1
    6            9            who_cares_2           1237            1
    7            10           return_of_the_care    1237            1

    table surveys
    ==================================================================
    survey_id   |  user_id   |   class_id    |      survey_type
    ==================================================================
    1               1234            1           'Pre Workshop Survey'
    2               1236            1           'Pre Workshop Survey'
    3               1235            1           'Pre Workshop Survey'
    4               1236            2           'Pre Workshop Survey'
    5               1234            1           'Post Workshop Survey'
    6               1236            2           'Post Workshop Survey'

In this sample, user_id 1234 has a class of type who_cares that attendance is set to 1 so this counts towards 1 of the classes. The class of type stress has additional requirements, mainly there must be a post survey completed in the surveys table. The user with user_id has also attended 2 classes, but for the stress class the survey is missing. The user with user_id of 1235 did registered for the stress class but failed to attend.

The results should contain the user names completed_two and completed_two_no_survey since this 2 users have a total of 2 classes attended even tho, user 1237 has no surveys. Only class_type stress or class_type nutrition has surveys.

I don't even know where to begin to do such a query... I'm sure there is a CASE I can trow in there, but I'm not sure how to make it so that only stress and nutrition are checked against the surveys table. I figured is something like this, with a CASE clause in there somewhere...

    SELECT users.user_name FROM class_registration
    JOIN users ON users.user_id = class_registration.user_id
    WHERE class_registration.attendance = 1
    GROUP BY class_registration.user_id, users.user_name
    HAVING COUNT(class_registration.attendance) >= 2

Again, what I need is to check the surveys table for a post workshop survey if and only if the class_type is stress or nutrition.
",sql,if-statement,,,,,open,0,1053,11,"How to JOIN a table only if results have specific parameter I need to get the user_name from all users that have completed 2 or more classes giving the following table structure...

    table users
    ===============================
    user_id     |   user_name
    ===============================
    1234            completed_two
    1235            completed_cero
    1236            completed_one
    1237            completed_two_no_survey

    table class_registration
    ========================================================================
    reg_id  | class_id    |   class_type      |   user_id     |   attendance
    ========================================================================
    1            1            stress                1234            1
    2            1            stress                1236            1
    3            2            who_cares             1234            1
    4            1            stress                1235            0
    5            5            nutrition             1236            1
    6            9            who_cares_2           1237            1
    7            10           return_of_the_care    1237            1

    table surveys
    ==================================================================
    survey_id   |  user_id   |   class_id    |      survey_type
    ==================================================================
    1               1234            1           'Pre Workshop Survey'
    2               1236            1           'Pre Workshop Survey'
    3               1235            1           'Pre Workshop Survey'
    4               1236            2           'Pre Workshop Survey'
    5               1234            1           'Post Workshop Survey'
    6               1236            2           'Post Workshop Survey'

In this sample, user_id 1234 has a class of type who_cares that attendance is set to 1 so this counts towards 1 of the classes. The class of type stress has additional requirements, mainly there must be a post survey completed in the surveys table. The user with user_id has also attended 2 classes, but for the stress class the survey is missing. The user with user_id of 1235 did registered for the stress class but failed to attend.

The results should contain the user names completed_two and completed_two_no_survey since this 2 users have a total of 2 classes attended even tho, user 1237 has no surveys. Only class_type stress or class_type nutrition has surveys.

I don't even know where to begin to do such a query... I'm sure there is a CASE I can trow in there, but I'm not sure how to make it so that only stress and nutrition are checked against the surveys table. I figured is something like this, with a CASE clause in there somewhere...

    SELECT users.user_name FROM class_registration
    JOIN users ON users.user_id = class_registration.user_id
    WHERE class_registration.attendance = 1
    GROUP BY class_registration.user_id, users.user_name
    HAVING COUNT(class_registration.attendance) >= 2

Again, what I need is to check the surveys table for a post workshop survey if and only if the class_type is stress or nutrition.
",2
3098472,06/23/2010 02:09:47,261512,01/29/2010 02:30:27,75,5,MySQL Rating System - Find Rating,"I'm trying to rate Types of Fruit by the best possible rating given by users.

I have a Fruit table called Ratings just for submitting ratings with the following Information

    Fruit_id int
    From_ID int
    Rating int

now I'm trying to run a SQL command like the following

    select From_ID, AVG(Rating) AS Rating FROM Ratings Group BY `Fruit_ID` ORDER by Rating DESC

This works however, if i get 1 user who rates a fruit an apple a 5, and then 1000 users who rate an orange a 4 the apple is suddenly considered better.

How can i take number of votes into account, to ensure that the most voted along with best is first.

",sql,mysql,rating,,,,open,0,121,6,"MySQL Rating System - Find Rating I'm trying to rate Types of Fruit by the best possible rating given by users.

I have a Fruit table called Ratings just for submitting ratings with the following Information

    Fruit_id int
    From_ID int
    Rating int

now I'm trying to run a SQL command like the following

    select From_ID, AVG(Rating) AS Rating FROM Ratings Group BY `Fruit_ID` ORDER by Rating DESC

This works however, if i get 1 user who rates a fruit an apple a 5, and then 1000 users who rate an orange a 4 the apple is suddenly considered better.

How can i take number of votes into account, to ensure that the most voted along with best is first.

",3
10810957,05/30/2012 06:23:21,1419801,05/27/2012 05:34:26,1,0,Query inside WITH XMLNAMESPACE clause,"is it possible to get some data of the namespaces in the result xml of FOR XML Clause 
from database 

e.g. 

    WITH XMLNAMESPACES ('uri1' as ns1, 
                    'uri2' as ns2,
                    DEFAULT 'uri2')
    SELECT ProductID, 
      Name,
      Color
    FROM Production.Product 
    WHERE ProductID=316 or ProductID=317
    FOR XML RAW ('ns1:Product'), ROOT('ns2:root'), ELEMENTS


RESULTS : 

         <ns2:root xmlns=""uri2"" xmlns:ns2=""uri2"" xmlns:ns1=""uri1"">
       <ns1:Product>
    <ProductID>316</ProductID>
    <Name>Blade</Name>
      </ns1:Product>
      <ns1:Product>
    <ProductID>317</ProductID>
    <Name>LL Crankarm</Name>
    <Color>Black</Color>
     </ns1:Product>
      </ns2:root>

WHAT IF I'D LIKE TO GET THE VALUE OF <ns2> FROM INSIDE DATABASE ? 

something like this : 


    WITH XMLNAMESPACES ('uri1' as ns1, 
               **(SELECT namespace from tableName)** as ns2,
                DEFAULT 'uri2')",sql,xml,query,,,,open,0,243,5,"Query inside WITH XMLNAMESPACE clause is it possible to get some data of the namespaces in the result xml of FOR XML Clause 
from database 

e.g. 

    WITH XMLNAMESPACES ('uri1' as ns1, 
                    'uri2' as ns2,
                    DEFAULT 'uri2')
    SELECT ProductID, 
      Name,
      Color
    FROM Production.Product 
    WHERE ProductID=316 or ProductID=317
    FOR XML RAW ('ns1:Product'), ROOT('ns2:root'), ELEMENTS


RESULTS : 

         <ns2:root xmlns=""uri2"" xmlns:ns2=""uri2"" xmlns:ns1=""uri1"">
       <ns1:Product>
    <ProductID>316</ProductID>
    <Name>Blade</Name>
      </ns1:Product>
      <ns1:Product>
    <ProductID>317</ProductID>
    <Name>LL Crankarm</Name>
    <Color>Black</Color>
     </ns1:Product>
      </ns2:root>

WHAT IF I'D LIKE TO GET THE VALUE OF <ns2> FROM INSIDE DATABASE ? 

something like this : 


    WITH XMLNAMESPACES ('uri1' as ns1, 
               **(SELECT namespace from tableName)** as ns2,
                DEFAULT 'uri2')",3
5860660,05/02/2011 18:03:30,734883,05/02/2011 18:03:30,1,0,From Relational Algerbra To SQL,"PLease Help me in this question.

Treatment ( **StaffNo** , **PatientID** , StartDate , Reason )

Find the staff numbers of all doctors who treat all the patients treated by the doctor whose staff number is 603.

In Relational Algebra 

Divide (Project Treatment Over StaffNo, PatientId) 
 By
Project (Select Treatment Where StaffNumber = ‘603’) Over PatientId

I want it in SQL , Please .",sql,,,,,05/05/2011 00:57:42,not a real question,1,60,5,"From Relational Algerbra To SQL PLease Help me in this question.

Treatment ( **StaffNo** , **PatientID** , StartDate , Reason )

Find the staff numbers of all doctors who treat all the patients treated by the doctor whose staff number is 603.

In Relational Algebra 

Divide (Project Treatment Over StaffNo, PatientId) 
 By
Project (Select Treatment Where StaffNumber = ‘603’) Over PatientId

I want it in SQL , Please .",1
6722200,07/17/2011 06:01:48,848422,07/17/2011 06:01:48,1,0,Hey what is the datatype I am looking for?,"I'm pretty sure it actually exists haha

But in sql it is a field and inside it has data1,data2,data3 and so on. Like an array inside a field. Any idea?",sql,database,,,,07/17/2011 08:19:43,not a real question,1,29,9,"Hey what is the datatype I am looking for? I'm pretty sure it actually exists haha

But in sql it is a field and inside it has data1,data2,data3 and so on. Like an array inside a field. Any idea?",2
10680711,05/21/2012 06:58:06,1407219,05/21/2012 06:44:43,1,0,In SQL How To Display Column Name in Double quote...?,In SQL How to disply column name of a table in double quote.,sql,,,,,05/21/2012 07:12:47,not a real question,1,13,10,In SQL How To Display Column Name in Double quote...? In SQL How to disply column name of a table in double quote.,1
3444602,08/09/2010 22:15:53,310133,04/06/2010 14:54:17,309,1,Advanced SQL books - tutorials,"My situation is i know the basics of SQL and am a little rusty on stuff to do with joins etc.

Id like a book which covers relational databases(info about them etc), understanding normalisation, set theory and then more advanced concepts such as stored procedures, cursors and so on.

Tutorials, books, anything is good! Obviously if there is a certain book out there that covers the majority in a not so complicated fashion all the better.

Thanks.",sql,database,stored-procedures,books,,09/27/2011 14:02:50,not constructive,1,74,5,"Advanced SQL books - tutorials My situation is i know the basics of SQL and am a little rusty on stuff to do with joins etc.

Id like a book which covers relational databases(info about them etc), understanding normalisation, set theory and then more advanced concepts such as stored procedures, cursors and so on.

Tutorials, books, anything is good! Obviously if there is a certain book out there that covers the majority in a not so complicated fashion all the better.

Thanks.",4
377974,12/18/2008 14:21:58,2147,08/20/2008 15:14:13,6785,244,Join in linked server or join in host server?,"Here's the situation:  we have an Oracle database we need to connect to to pull some data.    Since getting access to said Oracle database is a real pain (mainly a bureaucratic obstacle more than anything else), we're just planning on linking it to our SQL Server and  using the link to access data as we need it.

For one of our applications, we're planning on making a view to get the data we need.  Now the data we need is joined from two tables.  If we do this, which would be preferable?

This (in pseudo-SQL if such a thing exists):

     OPENQUERY(Oracle, ""SELECT [cols] FROM table1 INNER JOIN table2"")

or this:

     SELECT [cols] FROM OPENQUERY(Oracle, ""SELECT [cols1] FROM table1"")
     INNER JOIN OPENQUERY(Oracle, ""SELECT [cols2] from table2"")

Is there any reason to prefer one over the other?  One thing to keep in mind:  we are on a limitation on how long the query can run to access the Oracle server.

",sql,oracle,sql-server-2005,linkedserver,join,,open,0,175,9,"Join in linked server or join in host server? Here's the situation:  we have an Oracle database we need to connect to to pull some data.    Since getting access to said Oracle database is a real pain (mainly a bureaucratic obstacle more than anything else), we're just planning on linking it to our SQL Server and  using the link to access data as we need it.

For one of our applications, we're planning on making a view to get the data we need.  Now the data we need is joined from two tables.  If we do this, which would be preferable?

This (in pseudo-SQL if such a thing exists):

     OPENQUERY(Oracle, ""SELECT [cols] FROM table1 INNER JOIN table2"")

or this:

     SELECT [cols] FROM OPENQUERY(Oracle, ""SELECT [cols1] FROM table1"")
     INNER JOIN OPENQUERY(Oracle, ""SELECT [cols2] from table2"")

Is there any reason to prefer one over the other?  One thing to keep in mind:  we are on a limitation on how long the query can run to access the Oracle server.

",5
11231673,06/27/2012 17:15:40,967497,09/27/2011 16:18:44,42,1,Getting around Excel cell length limit,"I am trying to programatically create QueryTable objects in an Excel spreadsheet. As far as I am aware the cell length limit in Excel is 32K characters. If I try to create the QueryTable for an SQL query longer than that, then I get an exception. 

I can't make the query any shorter and I can't replace it with a stored procedure either. 
Is there a way around this problem?",sql,excel,limit,cell,length,06/28/2012 00:18:32,not a real question,1,70,6,"Getting around Excel cell length limit I am trying to programatically create QueryTable objects in an Excel spreadsheet. As far as I am aware the cell length limit in Excel is 32K characters. If I try to create the QueryTable for an SQL query longer than that, then I get an exception. 

I can't make the query any shorter and I can't replace it with a stored procedure either. 
Is there a way around this problem?",5
3271312,07/17/2010 11:36:27,394572,07/17/2010 09:42:12,1,0,mysql selecting data poblem,"im little speak english. i have a mysql query problem.

i have two tables (products, product_tags)

**products table;**

product_id int<br />
model varchar <br />
name varchar <br />
description text <br />
price decimal(12,2)<br />
status enum<br />
sale int<br />
hit int<br />
date_add datatime<br />
date_update datetime<br />

**product_tags table;**

tag_id int<br />
product_id int<br />
tag varchar<br />

my product_tags table type one to many

example

tag_id | product_id | tag<br />

1       1             tag1<br />
2       1             tag2<br />
3       1             tag3<br />

I want to pull data from a single query. (product and product tags).

Please help me.

im sory for my english.


",sql,mysql,,,,,open,0,138,4,"mysql selecting data poblem im little speak english. i have a mysql query problem.

i have two tables (products, product_tags)

**products table;**

product_id int<br />
model varchar <br />
name varchar <br />
description text <br />
price decimal(12,2)<br />
status enum<br />
sale int<br />
hit int<br />
date_add datatime<br />
date_update datetime<br />

**product_tags table;**

tag_id int<br />
product_id int<br />
tag varchar<br />

my product_tags table type one to many

example

tag_id | product_id | tag<br />

1       1             tag1<br />
2       1             tag2<br />
3       1             tag3<br />

I want to pull data from a single query. (product and product tags).

Please help me.

im sory for my english.


",2
11654661,07/25/2012 16:46:31,1319343,04/07/2012 16:41:02,15,0,Un-normalize a table,"I have a normalized table (table a) and a non-normalized table (table b), like this:

![enter image description here][1]



  [1]: http://i.stack.imgur.com/51orV.png

Basically, for each row in table a for the same student ID, I want to read all the parents with the same studentId and put the data into one row in table B.

So if I have 3 rows in table A, then there would be one row in table B with 3 of the 4 parent fields filled in. Any help for an SQl query for this would be appreciated.",sql,sql-server,query,tsql,,07/26/2012 07:39:18,not constructive,1,90,3,"Un-normalize a table I have a normalized table (table a) and a non-normalized table (table b), like this:

![enter image description here][1]



  [1]: http://i.stack.imgur.com/51orV.png

Basically, for each row in table a for the same student ID, I want to read all the parents with the same studentId and put the data into one row in table B.

So if I have 3 rows in table A, then there would be one row in table B with 3 of the 4 parent fields filled in. Any help for an SQl query for this would be appreciated.",4
2314398,02/22/2010 21:37:06,188727,10/12/2009 22:57:57,18,1,Catch/Work with/Handle multiple datasets in a Stored Procedure from another Stored Procedure,"Is it possible to work with the returned datasets from a stored procedure? Basically I have a stored procedure (lets call it SP_1) and it calls another stored procedure (lets call it SP_2). SP_2 has 5 or so select statements. What I want to do is handle each select statement within SP_1. Basically to manipulate the data or whatever, but I do not know how to get it. ",sql,sql-server,stored-procedures,,,,open,0,69,12,"Catch/Work with/Handle multiple datasets in a Stored Procedure from another Stored Procedure Is it possible to work with the returned datasets from a stored procedure? Basically I have a stored procedure (lets call it SP_1) and it calls another stored procedure (lets call it SP_2). SP_2 has 5 or so select statements. What I want to do is handle each select statement within SP_1. Basically to manipulate the data or whatever, but I do not know how to get it. ",3
8072716,11/09/2011 22:34:13,423316,08/17/2010 20:39:23,1790,321,"DB2 rownum() is not working on view , any alternative for rownum()","    select * from       (                                               
    
    select a.*,row_number() over() as rk                                
    
    from table1 tba  
                         ) as foo where rk between 11 and 20  

This works for database table. I am using a  view which is a join of 2 tables. 
When i try to do rownum it is saying **Function not allowed**

    select * from       (                                               
    
    select a.*,row_number() over() as rk                                
    
    from view1 v1  
                         ) as foo where rk between 11 and 20  



Any suggestion or alternative for rownum in DB2",sql,pagination,db2,rownum,,,open,0,339,12,"DB2 rownum() is not working on view , any alternative for rownum()     select * from       (                                               
    
    select a.*,row_number() over() as rk                                
    
    from table1 tba  
                         ) as foo where rk between 11 and 20  

This works for database table. I am using a  view which is a join of 2 tables. 
When i try to do rownum it is saying **Function not allowed**

    select * from       (                                               
    
    select a.*,row_number() over() as rk                                
    
    from view1 v1  
                         ) as foo where rk between 11 and 20  



Any suggestion or alternative for rownum in DB2",4
6754175,07/19/2011 21:08:33,84424,03/30/2009 02:54:02,2831,91,SQL: improving join efficiency,"If I turn this sub-query which selects sales persons and their highest price paid for any item they sell:

    select *,
        (select top 1 highestProductPrice
         from   orders o
         where  o.salespersonid = s.id
         order by highestProductPrice desc ) as highestProductPrice
    from salespersons s

in to this join in order to improve efficiency:

    select *, highestProductPrice
    from   salespersons s join (
           select salespersonid, highestProductPrice, row_number(
               partition by salespersonid 
               order by salespersonid, highestProductPrice) as rank
           from orders ) o on s.id = o.salespersonid

It still touches every order record.  However you cannot do this:

    select *, highestProductPrice
    from   salespersons s join (
           select salespersonid, highestProductPrice, row_number(
               partition by salespersonid 
               order by salespersonid, highestProductPrice) as rank
           from orders 
           where orders.salepersonid = s.id) o on s.id = o.salespersonid

The where clause in the join causes a `multi-part identifier ""s.id"" could not be bound.

**Is there any way to join the top 1 out of each order group with a join but without touching each record in orders?**
    ",sql,sql-server-2005,,,,,open,0,328,4,"SQL: improving join efficiency If I turn this sub-query which selects sales persons and their highest price paid for any item they sell:

    select *,
        (select top 1 highestProductPrice
         from   orders o
         where  o.salespersonid = s.id
         order by highestProductPrice desc ) as highestProductPrice
    from salespersons s

in to this join in order to improve efficiency:

    select *, highestProductPrice
    from   salespersons s join (
           select salespersonid, highestProductPrice, row_number(
               partition by salespersonid 
               order by salespersonid, highestProductPrice) as rank
           from orders ) o on s.id = o.salespersonid

It still touches every order record.  However you cannot do this:

    select *, highestProductPrice
    from   salespersons s join (
           select salespersonid, highestProductPrice, row_number(
               partition by salespersonid 
               order by salespersonid, highestProductPrice) as rank
           from orders 
           where orders.salepersonid = s.id) o on s.id = o.salespersonid

The where clause in the join causes a `multi-part identifier ""s.id"" could not be bound.

**Is there any way to join the top 1 out of each order group with a join but without touching each record in orders?**
    ",2
11746659,07/31/2012 18:28:42,1552588,07/25/2012 18:46:26,6,0,Null and Not null in sql2008,"I am using sequel server management studio 2008 Sp2 and I need to add a column in the database ....can any one please let me know how I can use the columns ""Allow Null"" in the table...My requirement for this scenario is I want to add a column for the table in which user may or may not change the selection of the newly inserted column...",sql,sql-server,,,,07/31/2012 18:36:20,not a real question,1,66,6,"Null and Not null in sql2008 I am using sequel server management studio 2008 Sp2 and I need to add a column in the database ....can any one please let me know how I can use the columns ""Allow Null"" in the table...My requirement for this scenario is I want to add a column for the table in which user may or may not change the selection of the newly inserted column...",2
7358080,09/09/2011 06:49:01,502068,11/08/2010 09:55:52,77,0,Why I cannot get return value from the stored procedure in SQL Server 2008?,"I have a stored procedure like this,

    USE MyTable
    GO
    CREATE PROCEDURE h_sp_find_exist
	@in_name varchar,@in_counterparty varchar,
	@out_recordsNum int OUTPUT
    AS
    BEGIN
	SELECT @out_recordsNum = COUNT(*)
		FROM TMyTable
		WHERE Name=@in_name AND Counterparty=@in_counterparty
	RETURN @out_recordsNum 
    END

I always get 0 from the return value.
What's wrong with it?

The execute code:  
    
    use MyTable
    go
    declare @retRecordNum int
    execute h_sp_find_exist 'myName', '50139', @retRecordNum OUTPUT
    select @retRecordNum as 'RecordNumber'

if I just run the sql code, 
select count (*)
where name='myName' and counterparty='50139', it works, and result is 1",sql,sql-server-2008,,,,,open,0,114,14,"Why I cannot get return value from the stored procedure in SQL Server 2008? I have a stored procedure like this,

    USE MyTable
    GO
    CREATE PROCEDURE h_sp_find_exist
	@in_name varchar,@in_counterparty varchar,
	@out_recordsNum int OUTPUT
    AS
    BEGIN
	SELECT @out_recordsNum = COUNT(*)
		FROM TMyTable
		WHERE Name=@in_name AND Counterparty=@in_counterparty
	RETURN @out_recordsNum 
    END

I always get 0 from the return value.
What's wrong with it?

The execute code:  
    
    use MyTable
    go
    declare @retRecordNum int
    execute h_sp_find_exist 'myName', '50139', @retRecordNum OUTPUT
    select @retRecordNum as 'RecordNumber'

if I just run the sql code, 
select count (*)
where name='myName' and counterparty='50139', it works, and result is 1",2
7443228,09/16/2011 10:16:59,889006,08/11/2011 00:52:48,1,0,i am Looking for More T-SQL Exercise which use Adventureworks2008R2 ...do you have any Link or book?,"i am Learning T-SQL Querying right now and i need More Practice which use AdventureWorks2008R2 .
do you have any Book Link Web site or something about Adventureworks 2008 R2 Exercises ?
Something Like this : [http://health.knowledgeblog.org/2011/06/22/essentials-of-sql-exercises/][1]


  [1]: http://health.knowledgeblog.org/2011/06/22/essentials-of-sql-exercises/

Thanks!",sql,sql-server,sql-server-2008,sql-server-2008-r2,adventureworks,09/16/2011 20:42:06,not constructive,1,38,17,"i am Looking for More T-SQL Exercise which use Adventureworks2008R2 ...do you have any Link or book? i am Learning T-SQL Querying right now and i need More Practice which use AdventureWorks2008R2 .
do you have any Book Link Web site or something about Adventureworks 2008 R2 Exercises ?
Something Like this : [http://health.knowledgeblog.org/2011/06/22/essentials-of-sql-exercises/][1]


  [1]: http://health.knowledgeblog.org/2011/06/22/essentials-of-sql-exercises/

Thanks!",5
8717570,01/03/2012 19:28:52,932919,09/07/2011 14:19:51,24,1,PL/SQL compilation error during update,"Query 

    DECLARE
      v_vendor_id NUMBER;
    BEGIN
      FOR vp_rec IN ( SELECT * FROM vpprocess )
        BEGIN
          SELECT i.vendor_id INTO v_vendor_id FROM item i, lineitems l WHERE l.itemid = i.itemid AND l.id = vp_rec.lineitemid;
            EXCEPTION
                WHEN no_data_found THEN SELECT 0 INTO v_vendor_id FROM dual;
          UPDATE vpprocess SET vendorid = v_vendor_id WHERE vpprocessid = vp_rec.vpprocessid;
        END;
      END LOOP;
    END;


Error Message 

    Error starting at line 1 in command:
    DECLARE
      v_vendor_id NUMBER;
    BEGIN
      FOR vp_rec IN ( SELECT * FROM vpprocess )
        BEGIN
          SELECT i.vendor_id INTO v_vendor_id FROM item i, lineitems l WHERE l.itemid = i.itemid AND l.id = vp_rec.lineitemid;
            EXCEPTION
                WHEN no_data_found THEN SELECT 0 INTO v_vendor_id FROM dual;
          UPDATE vpprocess SET vendorid = v_vendor_id WHERE vpprocessid = vp_rec.vpprocessid;
        END;
      END LOOP;
    END;
    Error report:
    ORA-06550: line 5, column 5:
    PLS-00103: Encountered the symbol ""BEGIN"" when expecting one of the following:
    
       loop
    The symbol ""loop"" was substituted for ""BEGIN"" to continue.
    06550. 00000 -  ""line %s, column %s:\n%s""
    *Cause:    Usually a PL/SQL compilation error.
    *Action:

",sql,plsql,sql-update,cursors,plsqldeveloper,,open,0,365,5,"PL/SQL compilation error during update Query 

    DECLARE
      v_vendor_id NUMBER;
    BEGIN
      FOR vp_rec IN ( SELECT * FROM vpprocess )
        BEGIN
          SELECT i.vendor_id INTO v_vendor_id FROM item i, lineitems l WHERE l.itemid = i.itemid AND l.id = vp_rec.lineitemid;
            EXCEPTION
                WHEN no_data_found THEN SELECT 0 INTO v_vendor_id FROM dual;
          UPDATE vpprocess SET vendorid = v_vendor_id WHERE vpprocessid = vp_rec.vpprocessid;
        END;
      END LOOP;
    END;


Error Message 

    Error starting at line 1 in command:
    DECLARE
      v_vendor_id NUMBER;
    BEGIN
      FOR vp_rec IN ( SELECT * FROM vpprocess )
        BEGIN
          SELECT i.vendor_id INTO v_vendor_id FROM item i, lineitems l WHERE l.itemid = i.itemid AND l.id = vp_rec.lineitemid;
            EXCEPTION
                WHEN no_data_found THEN SELECT 0 INTO v_vendor_id FROM dual;
          UPDATE vpprocess SET vendorid = v_vendor_id WHERE vpprocessid = vp_rec.vpprocessid;
        END;
      END LOOP;
    END;
    Error report:
    ORA-06550: line 5, column 5:
    PLS-00103: Encountered the symbol ""BEGIN"" when expecting one of the following:
    
       loop
    The symbol ""loop"" was substituted for ""BEGIN"" to continue.
    06550. 00000 -  ""line %s, column %s:\n%s""
    *Cause:    Usually a PL/SQL compilation error.
    *Action:

",5
11414297,07/10/2012 13:23:45,1472688,06/21/2012 16:06:48,11,0,Get List of Neatest Cities," I want to find Nearest cities based on the zip code .  Any one can give me idea about this, or any free api that provide this service.

Thanks in Advance 
",sql,asp.net-mvc,api,,,07/10/2012 20:21:15,not a real question,1,33,5,"Get List of Neatest Cities  I want to find Nearest cities based on the zip code .  Any one can give me idea about this, or any free api that provide this service.

Thanks in Advance 
",3
10742463,05/24/2012 17:29:55,1415688,05/24/2012 17:27:27,1,0,Increasing CustomerID Maximum field SQL,"The EPOS system we use runs a SQL database to store Customer Details however we have hit 9,999 records for CustomerID field and now will not allow addition of any further new customers.

Is it possible to increase this?

Thanks
Sham
Shamim000@yahoo.com",sql,,,,,05/24/2012 19:48:21,too localized,1,38,5,"Increasing CustomerID Maximum field SQL The EPOS system we use runs a SQL database to store Customer Details however we have hit 9,999 records for CustomerID field and now will not allow addition of any further new customers.

Is it possible to increase this?

Thanks
Sham
Shamim000@yahoo.com",1
7487228,09/20/2011 14:52:25,944671,09/14/2011 12:59:24,13,0,SQL DB Deployment,"The scenario:

I have written a software application that includes an installer, that is to be used by Mr Layman to install the system on to a single computer.

The system is a simple C# winforms application with an SQL Express database.  The target machine would be a standard installation of Windows XP with SQL Express and .NET 3.5 installed.

I am able to create the installer for the winforms app, that would check the version, create all the directories and copy over all the necessary executable's etc.  I have also an SQL script that will create the database and populate it with the necessary data.  However I do not know how to go about creating a stand alone installer for the database on the target machine.

I have an SQL script that will create the database etc, but how do I make the installer run this script?  I've had a google and I don't really know what I'm looking for, can someone point me in the right direction please. 

Thank you in advance.",sql,winforms,installer,,,,open,0,174,3,"SQL DB Deployment The scenario:

I have written a software application that includes an installer, that is to be used by Mr Layman to install the system on to a single computer.

The system is a simple C# winforms application with an SQL Express database.  The target machine would be a standard installation of Windows XP with SQL Express and .NET 3.5 installed.

I am able to create the installer for the winforms app, that would check the version, create all the directories and copy over all the necessary executable's etc.  I have also an SQL script that will create the database and populate it with the necessary data.  However I do not know how to go about creating a stand alone installer for the database on the target machine.

I have an SQL script that will create the database etc, but how do I make the installer run this script?  I've had a google and I don't really know what I'm looking for, can someone point me in the right direction please. 

Thank you in advance.",3
9391226,02/22/2012 08:15:18,905487,08/22/2011 08:28:12,7,0,Best hierarchical and multilingual database technique,i want to learn best hierarchical and multilingual database technique?Which do you use technique when develop a hierarchical and multilingual database?Can you help me about this?,sql,sql-server,tsql,database-design,hierarchical-data,02/22/2012 12:29:08,not a real question,1,26,6,Best hierarchical and multilingual database technique i want to learn best hierarchical and multilingual database technique?Which do you use technique when develop a hierarchical and multilingual database?Can you help me about this?,5
3048557,06/15/2010 19:56:57,181585,09/30/2009 04:24:14,98,8,mysql faster way of matching an inner string,"I'm trying to match on band names in a DB by excluding 'The'

So a search for 'The Beatles' or 'Beatles' would both succeed.

This is too slow:
    select * from artists where artist_name LIKE '%beatles';

Better ways to do this?
I'd like to avoid having an extra sorting/matching column with 'the' stripped out.

Thanks!",sql,mysql,,,,,open,0,53,8,"mysql faster way of matching an inner string I'm trying to match on band names in a DB by excluding 'The'

So a search for 'The Beatles' or 'Beatles' would both succeed.

This is too slow:
    select * from artists where artist_name LIKE '%beatles';

Better ways to do this?
I'd like to avoid having an extra sorting/matching column with 'the' stripped out.

Thanks!",2
8888506,01/17/2012 01:09:19,83149,03/26/2009 14:38:30,160,7,Is there a drawback when not using aliases in SQL queries?,"Except when it's necessary (self reference, etc.), is there a drawback NOT to use SQL aliases?

I often see queries like :

    SELECT c.name, p.phone, a.number, ct.fbAddress
    FROM customer c 
    INNER JOIN Person p ON p.idCustomer = c.idCuster
    INNER JOIN Address a ON .... etc

It annoys me. It's not easily maintainable. Why not use the full names? Is there a problem with it?

And that's just an example. I've seen queries with 10-15 tables in them with this kind of shortcuts. It's not readable.",sql,,,,,01/18/2012 03:03:12,not constructive,1,95,11,"Is there a drawback when not using aliases in SQL queries? Except when it's necessary (self reference, etc.), is there a drawback NOT to use SQL aliases?

I often see queries like :

    SELECT c.name, p.phone, a.number, ct.fbAddress
    FROM customer c 
    INNER JOIN Person p ON p.idCustomer = c.idCuster
    INNER JOIN Address a ON .... etc

It annoys me. It's not easily maintainable. Why not use the full names? Is there a problem with it?

And that's just an example. I've seen queries with 10-15 tables in them with this kind of shortcuts. It's not readable.",1
4857513,01/31/2011 23:54:37,597680,01/31/2011 23:54:37,1,0,"In SQL, how can I perform a ""subtraction"" operation?","Suppose I have two tables, which both have user ids. I want to perform an operation that would return all user IDS in table 1 that are not in table 2. I know there has to be some easy way to do this - can anyone offer some assistance?

",sql,database,relational-algebra,,,,open,0,49,9,"In SQL, how can I perform a ""subtraction"" operation? Suppose I have two tables, which both have user ids. I want to perform an operation that would return all user IDS in table 1 that are not in table 2. I know there has to be some easy way to do this - can anyone offer some assistance?

",3
5376465,03/21/2011 10:36:54,385338,07/07/2010 09:04:30,38,0,sql server 2 views in one,"I have 2 Different Views

1. select count(*) as Grandtotal from table x where id=1
2. select count(*) as total from table x where id=1 and [bla bla] Group by id
3. select top1(a) from table y 

i need to create view that will contain the flowing column 

GrandTotal, total , a",sql,ssrs-2008,,,,,open,0,49,6,"sql server 2 views in one I have 2 Different Views

1. select count(*) as Grandtotal from table x where id=1
2. select count(*) as total from table x where id=1 and [bla bla] Group by id
3. select top1(a) from table y 

i need to create view that will contain the flowing column 

GrandTotal, total , a",2
6878787,07/29/2011 20:41:57,564083,01/05/2011 14:46:43,880,86,Stored procedure will not display in object explorer?,"    USE [MASTER]
    GO
    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    USE [MASTER]
    GO
    CREATE PROCEDURE [dbo].[TOTALLY_NEW] @FISCAL_YEAR NVARCHAR(4) AS
    BEGIN
    PRINT 'HERE'
    END
    GO
***

`select * from master..sysobjects
where name like 'tot%'` <-- returns one row!!!!!!


I've refreshed this list a dozen times..!!
I've tried disconnecting and reconnecting..
I've created all those other SP's listed in the image before.

![enter image description here][1]


  [1]: http://i.stack.imgur.com/k33rU.png",sql,sql-server-2005,tsql,stored-procedures,,,open,0,101,8,"Stored procedure will not display in object explorer?     USE [MASTER]
    GO
    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    USE [MASTER]
    GO
    CREATE PROCEDURE [dbo].[TOTALLY_NEW] @FISCAL_YEAR NVARCHAR(4) AS
    BEGIN
    PRINT 'HERE'
    END
    GO
***

`select * from master..sysobjects
where name like 'tot%'` <-- returns one row!!!!!!


I've refreshed this list a dozen times..!!
I've tried disconnecting and reconnecting..
I've created all those other SP's listed in the image before.

![enter image description here][1]


  [1]: http://i.stack.imgur.com/k33rU.png",4
3635558,09/03/2010 12:11:40,373435,06/17/2010 09:37:00,44,1, How many coulmns can exist per table, How many coulmns can exist per table,sql,,,,,09/03/2010 17:32:54,not a real question,1,8,8, How many coulmns can exist per table  How many coulmns can exist per table,1
9639366,03/09/2012 18:47:15,1054677,11/18/2011 22:16:37,10,0,SQL: calculate with datetime-format and integers,"I'm working with Python and SQL and for my work I have to calculate with a row departureTime in datetime format and a row *timeFromStart* in int format. The row timeFromStart is an integer that means minutes.

So for example: I have a departureTime like this: `2012-03-09 20:00:00.0000` and I have to add an 106 minutes to that. I just don't know how to do it. I've searched for it and found things like *addTime* and such but it didnt seem to work :(

Tx in advance",sql,datetime,int,add,,,open,0,85,6,"SQL: calculate with datetime-format and integers I'm working with Python and SQL and for my work I have to calculate with a row departureTime in datetime format and a row *timeFromStart* in int format. The row timeFromStart is an integer that means minutes.

So for example: I have a departureTime like this: `2012-03-09 20:00:00.0000` and I have to add an 106 minutes to that. I just don't know how to do it. I've searched for it and found things like *addTime* and such but it didnt seem to work :(

Tx in advance",4
2085508,01/18/2010 11:10:16,8280,09/15/2008 15:36:56,1282,37,Table with identity field: Best SQL query to get Ids of deleted records?,I have a table with an identity field. What the best SQL query to get the Ids of all the deleted records from this table?,sql,tsql,identity-column,,,,open,0,25,13,Table with identity field: Best SQL query to get Ids of deleted records? I have a table with an identity field. What the best SQL query to get the Ids of all the deleted records from this table?,3
5076906,02/22/2011 10:25:31,410636,02/17/2010 10:17:46,7066,479,"Column does not exist in the IN clause, but SQL runs","I have a query that uses the `IN` clause.  Here's a simplified version:

    SELECT *
      FROM table A
      JOIN table B
        ON A.ID = B.ID
     WHERE B.AnotherColumn IN (SELECT Column FROM tableC WHERE ID = 1)

`tableC` doesn't have a `Column` column, but the query executes just fine with no error message.  Can anyone explain why?",sql,sql-server-2008,,,,,open,0,81,11,"Column does not exist in the IN clause, but SQL runs I have a query that uses the `IN` clause.  Here's a simplified version:

    SELECT *
      FROM table A
      JOIN table B
        ON A.ID = B.ID
     WHERE B.AnotherColumn IN (SELECT Column FROM tableC WHERE ID = 1)

`tableC` doesn't have a `Column` column, but the query executes just fine with no error message.  Can anyone explain why?",2
7269457,09/01/2011 11:08:52,155077,08/12/2009 13:22:25,4115,214,Are there any reporting solutions that works on Linux?,"Question:

I need a equivalent of Microsoft Reporting Service, that works on Linux.<br />
Free or for cash. Of course preferably free.


Requirements:

    WYSIWYG Report Editor (for developer, don't care if that part only works on windows)
    Ability to dynamically generate reports from the web
    Usage of one or multiple database types (like MySQL, PostGre, Oracle, ODBC)
    multiple file formats support (including HTML)
    support for graphs/charts
    scalable


What are the possiblilities ?",sql,linux,reporting-services,reporting,,09/01/2011 11:19:49,off topic,1,86,9,"Are there any reporting solutions that works on Linux? Question:

I need a equivalent of Microsoft Reporting Service, that works on Linux.<br />
Free or for cash. Of course preferably free.


Requirements:

    WYSIWYG Report Editor (for developer, don't care if that part only works on windows)
    Ability to dynamically generate reports from the web
    Usage of one or multiple database types (like MySQL, PostGre, Oracle, ODBC)
    multiple file formats support (including HTML)
    support for graphs/charts
    scalable


What are the possiblilities ?",4
3310188,07/22/2010 14:52:24,304357,03/29/2010 15:33:13,160,7,Free SQL formating tool?,"Hey, is there a good free tool out there that can also format complex queries?

Thanks :-)",sql,formatting,,,,10/18/2011 15:35:18,not constructive,1,16,4,"Free SQL formating tool? Hey, is there a good free tool out there that can also format complex queries?

Thanks :-)",2
292039,11/15/2008 02:34:15,37856,11/15/2008 02:11:19,1,0,Resources for Database Sharding and Partitioning,"I'm working with a database schema that is running into scalability issues.  One of the tables in the schema has grown to around 10 million tables, and I am exploring sharding and partitioning options to allow this schema to scale to much larger datasets.  Our application must also be deployable onto several database products, including but not limited to Oracle, MS SQL Server, and MySQL.

This is large problem in general, and I'd like to read up on what options are available.  What resources are out there (books, whitepapers, web sites) for database sharding and partitioning strategies?",sql,database,sharding,cluster-analysis,scalability,,open,0,99,6,"Resources for Database Sharding and Partitioning I'm working with a database schema that is running into scalability issues.  One of the tables in the schema has grown to around 10 million tables, and I am exploring sharding and partitioning options to allow this schema to scale to much larger datasets.  Our application must also be deployable onto several database products, including but not limited to Oracle, MS SQL Server, and MySQL.

This is large problem in general, and I'd like to read up on what options are available.  What resources are out there (books, whitepapers, web sites) for database sharding and partitioning strategies?",5
2652609,04/16/2010 11:46:50,269437,02/09/2010 11:56:52,6,0,Teradata group by time interval,"Can anyonen help with Teradata?

I want to create a query that is a standard 

select count(*) 
from Table 
where Column = Something 

but has a group by time period  done by 5 minute time intervals the time column is in 'Time' format


any idea?
",sql,teradata,,,,,open,0,44,5,"Teradata group by time interval Can anyonen help with Teradata?

I want to create a query that is a standard 

select count(*) 
from Table 
where Column = Something 

but has a group by time period  done by 5 minute time intervals the time column is in 'Time' format


any idea?
",2
4464943,12/16/2010 20:14:51,132138,07/02/2009 07:50:41,62,3,How to? Correct sql syntax for finding the next available identifier,"I think I could use some help here from more experienced users... 
I have an integer field name in a table, let's call it SO_ID in a table SO, and to each new row I need to calculate a new SO_ID based on the following rules<br>
1) SO_ID consists of 6 letters where first 3 are an area code, and the last three is the sequenced number within this area.
<br>309001<br>
309002<br>
309003<br>
2) so the next new row will have a SO_ID of value<br>
309004<br>
3) if someone deletes the row with SO_ID value = 309002, then the next new row must recycle this value, so the next new row has got to have the SO_ID of value<br>
309002

can anyone please provide me with either a SQL function or PL/SQL (perhaps a trigger straightaway?) function that would return the next available SO_ID I need to use ?
I reckon I could get use of keyword rownum in my sql, but the follwoing just doens't work properly


    select max(so_id),max(rownum)   from( 
    select (so_id),rownum,cast(substr(cast(so_id as varchar(6)),4,3) as int) from SO 
    where length(so_id)=6  
    and substr(cast(so_id as varchar(6)),1,3)='309' 
    and cast(substr(cast(so_id as varchar(6)),4,3) as int)=rownum 
    order by so_id 
    );

thank you for all your help!",sql,oracle,sql-syntax,,,,open,0,220,11,"How to? Correct sql syntax for finding the next available identifier I think I could use some help here from more experienced users... 
I have an integer field name in a table, let's call it SO_ID in a table SO, and to each new row I need to calculate a new SO_ID based on the following rules<br>
1) SO_ID consists of 6 letters where first 3 are an area code, and the last three is the sequenced number within this area.
<br>309001<br>
309002<br>
309003<br>
2) so the next new row will have a SO_ID of value<br>
309004<br>
3) if someone deletes the row with SO_ID value = 309002, then the next new row must recycle this value, so the next new row has got to have the SO_ID of value<br>
309002

can anyone please provide me with either a SQL function or PL/SQL (perhaps a trigger straightaway?) function that would return the next available SO_ID I need to use ?
I reckon I could get use of keyword rownum in my sql, but the follwoing just doens't work properly


    select max(so_id),max(rownum)   from( 
    select (so_id),rownum,cast(substr(cast(so_id as varchar(6)),4,3) as int) from SO 
    where length(so_id)=6  
    and substr(cast(so_id as varchar(6)),1,3)='309' 
    and cast(substr(cast(so_id as varchar(6)),4,3) as int)=rownum 
    order by so_id 
    );

thank you for all your help!",3
11010798,06/13/2012 08:18:55,1376731,05/05/2012 11:58:36,3,0,SQL Null values and non-Null values,"I have a table that looks like this:

- ID (pk,int)
- Col1 (nvarchar)
- Col2 (nvarchar)
- Col3 (nvarchar)

In all columns (except ID) some values are NULL.

I want to make a query that will look like this:

SELECT * FROM Table 
WHERE (Col1=<parameter> AND Col1 IS NULL)
 +    (Col2=<parameter> AND Col2 IS NULL)
etc.

I need values that are NULL and that are equal to parameter


Thanks",sql,,,,,,open,0,63,6,"SQL Null values and non-Null values I have a table that looks like this:

- ID (pk,int)
- Col1 (nvarchar)
- Col2 (nvarchar)
- Col3 (nvarchar)

In all columns (except ID) some values are NULL.

I want to make a query that will look like this:

SELECT * FROM Table 
WHERE (Col1=<parameter> AND Col1 IS NULL)
 +    (Col2=<parameter> AND Col2 IS NULL)
etc.

I need values that are NULL and that are equal to parameter


Thanks",1
4017242,10/25/2010 17:33:45,470353,10/08/2010 14:49:45,38,1,What is wrong with the syntax of this OUTPUT statement (SQL Server 2005)?,"I'm trying to use the OUTPUT statement in a stored procedure in order to return the ID of a newly inserted row.  The stored procedure is:
*************
CREATE PROCEDURE PROC_RESTORE_REQUEST_TO_QUEUE

@cs_uri_stem varchar(900),
@cs_uri_query varchar(2500),
@date datetime,
@time datetime,
@queue_state smallint,
@process_id int,
@simulation_start_time bigint,
@num_failures smallint

AS

SET NOCOUNT ON
INSERT INTO [DD#WORK].[dbo].[ebhFifoQueue] ([cs-uri-stem],[cs-uri-query],[date],[time],[queue_state],[process_id],[simulation_start_time],[num_failures]) 
VALUES (@cs_uri_stem,@cs_uri_query,@date,@time,@queue_state,@process_id,@simulation_start_time,@num_failures) 

OUTPUT INSERTED.id
********
When I try to compile this stored procedure, I get an error message: 

Incorrect syntax near 'OUTPUT'.
**********
I've tried several permutations of this code to no avail (same error message), including moving the OUTPUT statement onto the same line as the INSERT statement.  Do you know what the problem is with my syntax?  Thanks in advance for your help,

-Eric",sql,sql-server-2005,tsql,stored-procedures,output,,open,0,105,13,"What is wrong with the syntax of this OUTPUT statement (SQL Server 2005)? I'm trying to use the OUTPUT statement in a stored procedure in order to return the ID of a newly inserted row.  The stored procedure is:
*************
CREATE PROCEDURE PROC_RESTORE_REQUEST_TO_QUEUE

@cs_uri_stem varchar(900),
@cs_uri_query varchar(2500),
@date datetime,
@time datetime,
@queue_state smallint,
@process_id int,
@simulation_start_time bigint,
@num_failures smallint

AS

SET NOCOUNT ON
INSERT INTO [DD#WORK].[dbo].[ebhFifoQueue] ([cs-uri-stem],[cs-uri-query],[date],[time],[queue_state],[process_id],[simulation_start_time],[num_failures]) 
VALUES (@cs_uri_stem,@cs_uri_query,@date,@time,@queue_state,@process_id,@simulation_start_time,@num_failures) 

OUTPUT INSERTED.id
********
When I try to compile this stored procedure, I get an error message: 

Incorrect syntax near 'OUTPUT'.
**********
I've tried several permutations of this code to no avail (same error message), including moving the OUTPUT statement onto the same line as the INSERT statement.  Do you know what the problem is with my syntax?  Thanks in advance for your help,

-Eric",5
4078041,11/02/2010 13:21:05,451922,09/19/2010 12:43:13,1,0,Select a fixed number of rows from two tables in sql.,"I have two tables table1 (p double precesion, t timestamp without zone) and table2 (v double precision, t timestamp without zone) with values for every minute. How do I select 60 rows of the form (t, v, p) for every minute in a specified hour? Some values may not be present, in such case the corresponding returned value should be NULL. There must be exactly 60 rows for every minute. I use PostgreSQL.",sql,,,,,,open,0,73,11,"Select a fixed number of rows from two tables in sql. I have two tables table1 (p double precesion, t timestamp without zone) and table2 (v double precision, t timestamp without zone) with values for every minute. How do I select 60 rows of the form (t, v, p) for every minute in a specified hour? Some values may not be present, in such case the corresponding returned value should be NULL. There must be exactly 60 rows for every minute. I use PostgreSQL.",1
4053235,10/29/2010 15:17:01,357261,06/03/2010 08:59:33,383,0,query optimization in sql server,How can i do sql query optimization in sql server please explain me ,sql,server,,,,10/29/2010 15:20:37,not a real question,1,14,5,query optimization in sql server How can i do sql query optimization in sql server please explain me ,2
6922511,08/03/2011 06:31:43,514329,11/20/2010 08:44:54,54,10,Serarch a string in sql server database at design time,"i was wondering if there is any way to search a string in whole database while designing (something like searching a string in visual studio entire solution) 
thank you",sql,sql-server,,,,01/25/2012 05:50:39,not a real question,1,29,10,"Serarch a string in sql server database at design time i was wondering if there is any way to search a string in whole database while designing (something like searching a string in visual studio entire solution) 
thank you",2
7881789,10/24/2011 20:47:00,978685,10/04/2011 14:42:17,7,0,Retreiving mysql connection strings from app.config?,How can I call the connection string by name from an app.config file in my vb.net program?,sql,vb.net,connection-string,app-config,,,open,0,17,6,Retreiving mysql connection strings from app.config? How can I call the connection string by name from an app.config file in my vb.net program?,4
6692125,07/14/2011 10:59:16,583341,01/20/2011 17:17:58,60,0,Pivot In Values with dates?,"At the end of my sql, I am using the following code. Is there any way of replacing the fixed strings [2011/07/14], [2011/07/16], etc, to GetDate() value?

    PIVOT 
        (
           count([AppointmentsBooked])
           FOR [date] IN ([2011/07/14], [2011/07/16], [2011/07/17],[2011/07/18],[2011/07/21])
        ) as pivottable",sql,pivot-table,,,,,open,0,77,5,"Pivot In Values with dates? At the end of my sql, I am using the following code. Is there any way of replacing the fixed strings [2011/07/14], [2011/07/16], etc, to GetDate() value?

    PIVOT 
        (
           count([AppointmentsBooked])
           FOR [date] IN ([2011/07/14], [2011/07/16], [2011/07/17],[2011/07/18],[2011/07/21])
        ) as pivottable",2
11228047,06/27/2012 14:04:04,1438136,06/05/2012 19:00:55,3,0,tsql : Using value of one cell in a select statement (running with sqlcmd),"I have a bunch of queries that depend on each other and I want to use the value that's returned by the first one in another one. For example I want to use the product ID of the first query,  : 

    SELECT ProductID,
    
    FROM mproducts 
    
    WHERE (ProductCode='$(product)' or ProductCode='$(product)' or BuildSysProductCode='$(product)');

in the second one

    SELECT ProductVersionID, 
    
    FROM cb_mproductversions
    
    WHERE ProductID=***variableName***
    go

I looked into variables, and I've seen a few ways of storing values into variables like doing 

    DECLARE @variableName
    SELECT @variableName AS productID 
    FROM mproducts 
    ...

But it seems that the scope of @variableName is only the next select statement, and when I get to the ones after the one right after DECLARE it says that it's not declared.",sql,sql-server,tsql,plsql,sqlcmd,,open,0,174,14,"tsql : Using value of one cell in a select statement (running with sqlcmd) I have a bunch of queries that depend on each other and I want to use the value that's returned by the first one in another one. For example I want to use the product ID of the first query,  : 

    SELECT ProductID,
    
    FROM mproducts 
    
    WHERE (ProductCode='$(product)' or ProductCode='$(product)' or BuildSysProductCode='$(product)');

in the second one

    SELECT ProductVersionID, 
    
    FROM cb_mproductversions
    
    WHERE ProductID=***variableName***
    go

I looked into variables, and I've seen a few ways of storing values into variables like doing 

    DECLARE @variableName
    SELECT @variableName AS productID 
    FROM mproducts 
    ...

But it seems that the scope of @variableName is only the next select statement, and when I get to the ones after the one right after DECLARE it says that it's not declared.",5
1454143,09/21/2009 11:51:11,64873,02/11/2009 02:30:47,589,18,Complicated SQL query,"I have the following db tables (which is simplified to illustrate the problem)

CampaignTx  

    campaignTx_id | member_id | date_created | shop_id
    1 | 2 | 7/12/2009 | 2
    2 | 4 | 7/13/2009 | 3
    3 | 6 | 7/14/2009 | 4
    4 | 5 | 8/14/2009 | 3
    5 | 10| 8/19/2009 | 1


Reliability  

    Reliability_id | capaignTx_id | status
    1 | 3 | 0
    2 | 2 | 1
    3 | 4 | 2
    4 | 5 | 3
    5 | 7 | 1

Shop

    Shop_id | Shop_name | City_id
    1 | shop 1| 5
    2 | shop 2| 7
    3 | shop 3| 7
    4 | shop 4| 6
     

City

    City_id | City_name
    5 | city 1
    6 | city 2
    7 | city 3


What I want is the following table (each row is grouped by city, year and month):

    City| year | month| num_of_campaignTx_records | num_of_realiability_records | num_of realiability_records with status = 0 |num_of realiability_records with status = 1| num_of realiability_records with status = 2| num_of realiability_records with status = 3

How should I write the SQL query to get this table?

I have the following query now but I don't know how to write the last 4 columns:

    select datepart(year,[Tx].date_created) as year,
    datepart(month,[Tx].date_created) as month,
    [city].nameTc as city,
    count([Tx].date_created) as 'total num of campaign Tx records', 
    count([rel].CreateDate) as 'num of reliability records'

    from campaigntx as [Tx]

    full join [Reliability] as [rel]
    on [rel].[CampaignTx_id] = [Tx].[CampaignTx_id]

    join shop as [shop]
    on [Tx].shop_id = [shop].shop_id

    join City as [city]
    on [city].city_id = [shop].city_id

    group by datepart(year,[Tx].date_created),datepart(month,[Tx].date_created), [city].nameTc


",sql,sql-server-2005,,,,,open,0,369,3,"Complicated SQL query I have the following db tables (which is simplified to illustrate the problem)

CampaignTx  

    campaignTx_id | member_id | date_created | shop_id
    1 | 2 | 7/12/2009 | 2
    2 | 4 | 7/13/2009 | 3
    3 | 6 | 7/14/2009 | 4
    4 | 5 | 8/14/2009 | 3
    5 | 10| 8/19/2009 | 1


Reliability  

    Reliability_id | capaignTx_id | status
    1 | 3 | 0
    2 | 2 | 1
    3 | 4 | 2
    4 | 5 | 3
    5 | 7 | 1

Shop

    Shop_id | Shop_name | City_id
    1 | shop 1| 5
    2 | shop 2| 7
    3 | shop 3| 7
    4 | shop 4| 6
     

City

    City_id | City_name
    5 | city 1
    6 | city 2
    7 | city 3


What I want is the following table (each row is grouped by city, year and month):

    City| year | month| num_of_campaignTx_records | num_of_realiability_records | num_of realiability_records with status = 0 |num_of realiability_records with status = 1| num_of realiability_records with status = 2| num_of realiability_records with status = 3

How should I write the SQL query to get this table?

I have the following query now but I don't know how to write the last 4 columns:

    select datepart(year,[Tx].date_created) as year,
    datepart(month,[Tx].date_created) as month,
    [city].nameTc as city,
    count([Tx].date_created) as 'total num of campaign Tx records', 
    count([rel].CreateDate) as 'num of reliability records'

    from campaigntx as [Tx]

    full join [Reliability] as [rel]
    on [rel].[CampaignTx_id] = [Tx].[CampaignTx_id]

    join shop as [shop]
    on [Tx].shop_id = [shop].shop_id

    join City as [city]
    on [city].city_id = [shop].city_id

    group by datepart(year,[Tx].date_created),datepart(month,[Tx].date_created), [city].nameTc


",2
7825938,10/19/2011 18:06:07,748527,05/11/2011 11:19:02,45,1,nested while loop in procedure,"    declare

    begin

    open cursor1;
    fetch cursor1 into cursor_rec;
    while cursor1%found
    <<outer_loop>>
    loop

    open cursor2;
    fetch cursor2 into cursor2_rec;
    <<inner loop>>
    loop

    if --some condition-- then
    --i have to check whether there is more record in cursor2
    --if there are more record goto the inner loop and fetch another record
    elsif --some condition --then
    --exit this loop and start with next value of cursor1
    end if;
    fetch cursor2 into cursor2_rec;
    end loop;


    fetch cursor1 into cursor_rec;
    end loop;

    end;

##please can anyone write this code with proper syntax ,i mean the condition inside inner loop ,if conition satify then ...what will be the syntax .
I am using oracle as rdbms",sql,stored-procedures,plsql,while-loops,plsqldeveloper,10/26/2011 00:18:28,too localized,1,175,5,"nested while loop in procedure     declare

    begin

    open cursor1;
    fetch cursor1 into cursor_rec;
    while cursor1%found
    <<outer_loop>>
    loop

    open cursor2;
    fetch cursor2 into cursor2_rec;
    <<inner loop>>
    loop

    if --some condition-- then
    --i have to check whether there is more record in cursor2
    --if there are more record goto the inner loop and fetch another record
    elsif --some condition --then
    --exit this loop and start with next value of cursor1
    end if;
    fetch cursor2 into cursor2_rec;
    end loop;


    fetch cursor1 into cursor_rec;
    end loop;

    end;

##please can anyone write this code with proper syntax ,i mean the condition inside inner loop ,if conition satify then ...what will be the syntax .
I am using oracle as rdbms",5
9573402,03/05/2012 20:20:54,1157541,01/19/2012 02:15:36,42,0,Understanding an SQL Query,"I have the following query: 

    Select course_id, semester, year, sec_id, avg(tot_cred) 
    From takes natural join student 
    Where year = 2009 
    Group by course_id, semester,year, sec_id 
    Having count (ID) >= 2; 

Should joining section as well in the From clause change the result?

",sql,homework,,,,03/05/2012 20:35:55,not a real question,1,62,4,"Understanding an SQL Query I have the following query: 

    Select course_id, semester, year, sec_id, avg(tot_cred) 
    From takes natural join student 
    Where year = 2009 
    Group by course_id, semester,year, sec_id 
    Having count (ID) >= 2; 

Should joining section as well in the From clause change the result?

",2
3694615,09/12/2010 11:14:40,165873,08/31/2009 08:04:33,346,2,Alter Colum Datatype from Int to Ntext and vice-versa,"I have a Sql table 

    CREATE TABLE [UserTable]
    (
    	[ID] [int] NULL,
    	[Name] [nvarchar](50) NULL,
    	[City] [nvarchar](50) NULL
    ) ON [PRIMARY]

In this table column ID have the Datatype Int, I want to alter the data type of the ID column to Ntext,
For that I am using the following Sql Query:

    ALTER TABLE UserTable
    ALTER COLUMN ID NTEXT

This query gives the following error message:

> Msg 206, Level 16, State 2, Line 1
> Operand type clash: int is
> incompatible with ntext

While when I alter ID column Datatype from **Int to navarchar** it works fine.

After that I am trying to Alter **ID**(now the data type of the Id column is Nvarchar) Column data type to **Ntext** by **Alter Query** it alter's **ID** column data type successfully.

Why we can not alter column name data type Direct Int to Ntext, While we can do this via INT to Nvarchar  after that Nvarchar to Ntext.

Any suggestion will help me a lot.

Thanks
Vijendra Singh
",sql,int,nvarchar,alter,ntext,,open,0,182,9,"Alter Colum Datatype from Int to Ntext and vice-versa I have a Sql table 

    CREATE TABLE [UserTable]
    (
    	[ID] [int] NULL,
    	[Name] [nvarchar](50) NULL,
    	[City] [nvarchar](50) NULL
    ) ON [PRIMARY]

In this table column ID have the Datatype Int, I want to alter the data type of the ID column to Ntext,
For that I am using the following Sql Query:

    ALTER TABLE UserTable
    ALTER COLUMN ID NTEXT

This query gives the following error message:

> Msg 206, Level 16, State 2, Line 1
> Operand type clash: int is
> incompatible with ntext

While when I alter ID column Datatype from **Int to navarchar** it works fine.

After that I am trying to Alter **ID**(now the data type of the Id column is Nvarchar) Column data type to **Ntext** by **Alter Query** it alter's **ID** column data type successfully.

Why we can not alter column name data type Direct Int to Ntext, While we can do this via INT to Nvarchar  after that Nvarchar to Ntext.

Any suggestion will help me a lot.

Thanks
Vijendra Singh
",5
11536483,07/18/2012 07:38:36,1530434,07/17/2012 01:53:23,23,2,Better to parse name values or combine,"I have two different tables, with the name values being stored in different manners...


For example one field is:



inventorName

John C. Smith


While in the other table the fields are:



Inventorfirst    |    InventorLast

John C.          |    Smith


The question is would it make more sense for me to combine the seperate names rather than spending god knows how long parsing out the individual names.  I understand the drawbacks when it comes to querying :

Find and inventor with the last name Thomas could include first names of thomas within the fields, and on top of that the queries would mostly be using like and *name*  which I am not a fan of cause I want it to be accurate as possible.  


I am fairly new to this and all of the name parsing articles I ahve read make it seem like a nightmare and could just use some honest opinions.",sql,sql-server,sql-server-2008,parsing,sql-parser,,open,0,164,7,"Better to parse name values or combine I have two different tables, with the name values being stored in different manners...


For example one field is:



inventorName

John C. Smith


While in the other table the fields are:



Inventorfirst    |    InventorLast

John C.          |    Smith


The question is would it make more sense for me to combine the seperate names rather than spending god knows how long parsing out the individual names.  I understand the drawbacks when it comes to querying :

Find and inventor with the last name Thomas could include first names of thomas within the fields, and on top of that the queries would mostly be using like and *name*  which I am not a fan of cause I want it to be accurate as possible.  


I am fairly new to this and all of the name parsing articles I ahve read make it seem like a nightmare and could just use some honest opinions.",5
7745956,10/12/2011 20:11:13,194076,10/21/2009 19:48:10,907,35,How does stackoverflow tracks revisions and styling,"Okay. I'm interested in the best practices for storing revised and styled posts in the database. Stackoverflow did a great job doing this. My questions are basic: For storing posts we can have just one table Post with text and revisionnumber columns.
then we query the latest revision for the specific user. It seems a little inefficient. should I only store changes, not the whole post? How to do this? will it require extra work with some VCS API or something?  What about styling: do I store actual html tags inside text column along with text? Or maybe there are some products for sql srver that help you do that?",sql,sql-server,,,,10/14/2011 16:43:03,not a real question,1,110,7,"How does stackoverflow tracks revisions and styling Okay. I'm interested in the best practices for storing revised and styled posts in the database. Stackoverflow did a great job doing this. My questions are basic: For storing posts we can have just one table Post with text and revisionnumber columns.
then we query the latest revision for the specific user. It seems a little inefficient. should I only store changes, not the whole post? How to do this? will it require extra work with some VCS API or something?  What about styling: do I store actual html tags inside text column along with text? Or maybe there are some products for sql srver that help you do that?",2
4591916,01/04/2011 08:54:42,463022,09/30/2010 16:05:17,68,12,MySQL sum at bottom row,"I am trying to get the sum of a column at the bottom row.
I have tried a few examples by using SUM() and COUNT(), but they have all failed with syntax errors.

Here is my current code without any sum or anything:

    :XML ON
    USE MYTABLE
    SELECT sbc.PolicyC.PolicyName as namn,COUNT(*) as cnt
    FROM sbc.AgentC, sbc.PolicyC
    WHERE sbc.AgentC.PolicyGuid = sbc.PolicyC.PolicyGuid
    GROUP BY sbc.AgentC.PolicyGuid, sbc.PolicyC.PolicyName ORDER BY namn ASC
    FOR XML PATH ('celler'), ROOT('root')
    GO

The XML output is reformatted to become a regular HTML table.
",sql,mysql,,,,,open,0,106,5,"MySQL sum at bottom row I am trying to get the sum of a column at the bottom row.
I have tried a few examples by using SUM() and COUNT(), but they have all failed with syntax errors.

Here is my current code without any sum or anything:

    :XML ON
    USE MYTABLE
    SELECT sbc.PolicyC.PolicyName as namn,COUNT(*) as cnt
    FROM sbc.AgentC, sbc.PolicyC
    WHERE sbc.AgentC.PolicyGuid = sbc.PolicyC.PolicyGuid
    GROUP BY sbc.AgentC.PolicyGuid, sbc.PolicyC.PolicyName ORDER BY namn ASC
    FOR XML PATH ('celler'), ROOT('root')
    GO

The XML output is reformatted to become a regular HTML table.
",2
7208872,08/26/2011 18:10:42,67875,02/18/2009 15:10:56,1127,62,Cant substitue SQL UNION query for table name,"I have two tables with identical schema in SQL Server 2008 R2.  If I execute the following query, with parentheses intact, I get results from both tables.

    /*
    select distinct Name, Rank, SerNo, OtherStuff from 
    */
    
    (
    select Name, Rank, SerNo, OtherStuff from OldPlayers
    
    union 
    select Name, Rank, SerNo, OtherStuff from NewPlayers
    )
    
    /*
    OldPlayers
    */
    
    go

If I then uncomment both comments, and comment out the expression in parentheses, I also get results (from one table, of course).

If I now re-comment the table name at the end, and uncomment the parenthetical expression so that it can replace the table name, I get the error ""Incorrect syntax near ')'.""  

Why can't I substitute the union expression for the table name?",sql,union,sql-server-2008-r2,,,,open,0,175,8,"Cant substitue SQL UNION query for table name I have two tables with identical schema in SQL Server 2008 R2.  If I execute the following query, with parentheses intact, I get results from both tables.

    /*
    select distinct Name, Rank, SerNo, OtherStuff from 
    */
    
    (
    select Name, Rank, SerNo, OtherStuff from OldPlayers
    
    union 
    select Name, Rank, SerNo, OtherStuff from NewPlayers
    )
    
    /*
    OldPlayers
    */
    
    go

If I then uncomment both comments, and comment out the expression in parentheses, I also get results (from one table, of course).

If I now re-comment the table name at the end, and uncomment the parenthetical expression so that it can replace the table name, I get the error ""Incorrect syntax near ')'.""  

Why can't I substitute the union expression for the table name?",3
4057540,10/30/2010 06:26:49,227809,12/09/2009 09:14:32,494,33,Is it possible to have nulls in Foreign keys in any ANSI SQL database?,Is it possible to have nulls in Foreign keys in any ANSI SQL database?,sql,,,,,,open,0,14,14,Is it possible to have nulls in Foreign keys in any ANSI SQL database? Is it possible to have nulls in Foreign keys in any ANSI SQL database?,1
10135909,04/13/2012 05:52:43,1330798,04/13/2012 05:46:32,1,0,Select Value From Combobox And Add to Sql Database using VB in VS 2010,"I am new to VB and VS 2010. I have a problem.I have created a database.
Now I have created a windows form in which i have added some combo boxes.
I want to select the value of the combo box and when ADD is clicked on the form it should be added to the database.
In textbox we do Textbox1.text to select the value.
What will we do in Combobox .????

Please help me soon...

Thank You in Advance...!!!",sql,visual-studio-2010,combobox,vb,add,04/19/2012 11:07:35,not a real question,1,74,14,"Select Value From Combobox And Add to Sql Database using VB in VS 2010 I am new to VB and VS 2010. I have a problem.I have created a database.
Now I have created a windows form in which i have added some combo boxes.
I want to select the value of the combo box and when ADD is clicked on the form it should be added to the database.
In textbox we do Textbox1.text to select the value.
What will we do in Combobox .????

Please help me soon...

Thank You in Advance...!!!",5
11451011,07/12/2012 11:38:15,1466013,06/19/2012 09:37:56,1,0,Trigger In sql Server,"I have knowledge of sql server 2005.I have worked in sql server. But I have not use trigger in Sql server,Please somebody help me, what is trigger,types of trigger,How to use that in sql server 2005. 


Thanks In Advance",sql,triggers,server,,,07/12/2012 19:35:26,not a real question,1,39,4,"Trigger In sql Server I have knowledge of sql server 2005.I have worked in sql server. But I have not use trigger in Sql server,Please somebody help me, what is trigger,types of trigger,How to use that in sql server 2005. 


Thanks In Advance",3
9353284,02/19/2012 21:11:23,1165419,01/23/2012 17:01:31,1,0,problems backing/dowloading Mysql database,"I'm having trouble downloading my database, as I want to move to a new host. I did contact my current host, but havn't had a reply in a while.

I tried PHPadmin and that simply does not work, it just keeps timing out... 

My database sql size is around - 100mb or so.

Is there any easy way to do a backup, with some kind of external script or something?",sql,database,backup,,,02/20/2012 06:05:13,off topic,1,68,4,"problems backing/dowloading Mysql database I'm having trouble downloading my database, as I want to move to a new host. I did contact my current host, but havn't had a reply in a while.

I tried PHPadmin and that simply does not work, it just keeps timing out... 

My database sql size is around - 100mb or so.

Is there any easy way to do a backup, with some kind of external script or something?",3
152243,09/30/2008 08:33:02,7742,09/15/2008 14:19:42,36,3,Transaction encapsulation of multi-process writes,"I have a database scenario (i'm using Oracle) in which several processes make inserts into a table and a single process selects from it.  The table is basically used as a intermediate storage, to which multiple processes (in the following called the Writers) write log events, and from which a single processes (in the following referred to as the Reader) reads the events for further processing. The Reader must read all events inserted into the table.

Currenly, this is done by each inserted record being assigned an id from an ascending sequence. The reader periodically selects a block of entries from the table where
the id is larger than the largest id of the proviously read block. E.g. something like:

    SELECT
      *
    FROM
      TRANSACTION_LOG
    WHERE
      id > (
        SELECT
          last_id
        FROM
          READER_STATUS
       );

The problem with this approach is that since writers operate concurrently, rows are not always inserted in order according to their assigned id, even though these are assigned in sequentially ascending order. That is, a row with id=100 is sometimes written after a record with id=110, because the process writing the row with id=110 started after the processes writing the record id=100, but commited first.  This can result in the Reader missing the row with id=100 if it has already read row with id=110.

Forcing the Writers to exclusive lock on the table would solve the problem as this would force them to insert sequentially and also for the Reader to wait for any outstanding commits. This, however, would probably not be very fast.

It is my thinking, that it would suffice for the Reader to wait for any outstanding Writer
commits before reading. That is, Writers may continue to operate concurrently as longs as the Reader does read until all writers have finished.

My question is this: 
How can i instruct my reader process to wait for any outstanding commits of my writer processes? Any alternative suggesting to the above problem is also welcome. 





",sql,transactions,acid,,,,open,0,386,5,"Transaction encapsulation of multi-process writes I have a database scenario (i'm using Oracle) in which several processes make inserts into a table and a single process selects from it.  The table is basically used as a intermediate storage, to which multiple processes (in the following called the Writers) write log events, and from which a single processes (in the following referred to as the Reader) reads the events for further processing. The Reader must read all events inserted into the table.

Currenly, this is done by each inserted record being assigned an id from an ascending sequence. The reader periodically selects a block of entries from the table where
the id is larger than the largest id of the proviously read block. E.g. something like:

    SELECT
      *
    FROM
      TRANSACTION_LOG
    WHERE
      id > (
        SELECT
          last_id
        FROM
          READER_STATUS
       );

The problem with this approach is that since writers operate concurrently, rows are not always inserted in order according to their assigned id, even though these are assigned in sequentially ascending order. That is, a row with id=100 is sometimes written after a record with id=110, because the process writing the row with id=110 started after the processes writing the record id=100, but commited first.  This can result in the Reader missing the row with id=100 if it has already read row with id=110.

Forcing the Writers to exclusive lock on the table would solve the problem as this would force them to insert sequentially and also for the Reader to wait for any outstanding commits. This, however, would probably not be very fast.

It is my thinking, that it would suffice for the Reader to wait for any outstanding Writer
commits before reading. That is, Writers may continue to operate concurrently as longs as the Reader does read until all writers have finished.

My question is this: 
How can i instruct my reader process to wait for any outstanding commits of my writer processes? Any alternative suggesting to the above problem is also welcome. 





",3
11736510,07/31/2012 08:57:17,1526781,07/15/2012 11:07:44,34,0,Database Access Time - Dependant on language?,"If I am going to use a SQLite database to store my data, I was wondering if the language of my program which requests the data will have any outcome on the access time.

For example, if I have my 100mb SQL database and I need to search if for a certain value, would I get faster results if I wrote my program in C as opposed to PHP to query and return the result from SQL? 

I’m guessing the language doesn’t make a lot of difference since it is SQLite that is doing most of the heavy work, but I might be wrong.
",sql,database,sqlite,,,,open,0,103,7,"Database Access Time - Dependant on language? If I am going to use a SQLite database to store my data, I was wondering if the language of my program which requests the data will have any outcome on the access time.

For example, if I have my 100mb SQL database and I need to search if for a certain value, would I get faster results if I wrote my program in C as opposed to PHP to query and return the result from SQL? 

I’m guessing the language doesn’t make a lot of difference since it is SQLite that is doing most of the heavy work, but I might be wrong.
",3
9628627,03/09/2012 03:44:20,317785,04/15/2010 17:30:45,849,20,SQL Formatting a field,"In my DB, I have a column called telephone number

Most of the numbers are ###-###-#### some of them are ###########

How can I run a query to format all numbers to look the same

I'd prefer

    ###-###-#####

Thanks
",sql,sqlite,update,sqlite3,formatting,,open,0,38,4,"SQL Formatting a field In my DB, I have a column called telephone number

Most of the numbers are ###-###-#### some of them are ###########

How can I run a query to format all numbers to look the same

I'd prefer

    ###-###-#####

Thanks
",5
11105641,06/19/2012 16:51:15,117700,06/04/2009 23:04:34,1347,28,how to remove duplicates in an inner join?,"my query:

      select 
      SUM(payments.paid_amt) as paid_amt, 
      SUM(payments.copay_amt) as copay_amt,
      SUM(payments.CO_INSURANCE_AMT) as co_ins_amt,
      SUM(payments.PATIENT_RESP_AMT) as patient_resp_amt,
      accession.ACCESSION_ID
      
      from 
      [F_PAYOR_PAYMENTS_monthly] payments
      
      join F_ACCESSION_daily accession
      on accession.ACCESSION_ID=payments.ACCESSION_ID
      
      where accession.XIFIN_LOAD_DATE between '20111201' and '20111231'
    
      group by   
      DATEPART(MM,accession.XIFIN_LOAD_DATE),
      DATEPART(yyyy,accession.XIFIN_LOAD_DATE),
      accession.ACCESSION_ID

is returning duplicate `payments` for many `accessions`

my question is how do i make sure that payments for a specific accession are summed only once?

the relationship between `payments ---> accession` is `many to 1`

thanks so much for your guidance.
",sql,sql-server,sql-server-2008,,,06/19/2012 17:47:14,too localized,1,175,8,"how to remove duplicates in an inner join? my query:

      select 
      SUM(payments.paid_amt) as paid_amt, 
      SUM(payments.copay_amt) as copay_amt,
      SUM(payments.CO_INSURANCE_AMT) as co_ins_amt,
      SUM(payments.PATIENT_RESP_AMT) as patient_resp_amt,
      accession.ACCESSION_ID
      
      from 
      [F_PAYOR_PAYMENTS_monthly] payments
      
      join F_ACCESSION_daily accession
      on accession.ACCESSION_ID=payments.ACCESSION_ID
      
      where accession.XIFIN_LOAD_DATE between '20111201' and '20111231'
    
      group by   
      DATEPART(MM,accession.XIFIN_LOAD_DATE),
      DATEPART(yyyy,accession.XIFIN_LOAD_DATE),
      accession.ACCESSION_ID

is returning duplicate `payments` for many `accessions`

my question is how do i make sure that payments for a specific accession are summed only once?

the relationship between `payments ---> accession` is `many to 1`

thanks so much for your guidance.
",3
11374670,07/07/2012 11:38:35,1386328,05/10/2012 06:39:37,7,0,compress binary data in sql server,"I am **storing images** in my database(Sql Server 2008) **in binary formate**.
Table's Field datatype is image.

Right now i'm having rows above than millions in that table. Now i want to **compress that binary data.** 

I have searched some solutions but they are on form levels means i have to write code in C# or VB.net and bring that binary data on that page. By compressing them with code i have to update that particular record.
 
but due to i have large number of data it is inconvenient to do this process on form side because it can take plenty of time. 

So all i want some **code for SQL** so i can **create Stored Procedure** in my database, using which i can get each row at a time,**directly compress that binary data and update** that fetched column for that perticular row.

Is there any method available to do this process on **SQL server 2008**.

Thank you in Advance.",sql,sql-server,sql-server-2008,,,07/08/2012 19:56:23,not a real question,1,156,6,"compress binary data in sql server I am **storing images** in my database(Sql Server 2008) **in binary formate**.
Table's Field datatype is image.

Right now i'm having rows above than millions in that table. Now i want to **compress that binary data.** 

I have searched some solutions but they are on form levels means i have to write code in C# or VB.net and bring that binary data on that page. By compressing them with code i have to update that particular record.
 
but due to i have large number of data it is inconvenient to do this process on form side because it can take plenty of time. 

So all i want some **code for SQL** so i can **create Stored Procedure** in my database, using which i can get each row at a time,**directly compress that binary data and update** that fetched column for that perticular row.

Is there any method available to do this process on **SQL server 2008**.

Thank you in Advance.",3
8021545,11/05/2011 16:32:33,1031294,11/05/2011 16:20:01,1,0,"New to SQLJet, how to save data into the database?","this is my first time asking questions in here. If I have done something wrong please tell me.
Well i will get straight to the point.
I am working on a simple project in which i want to use SQLJet. I simply want to save data about food (ie. name, nationality, calorie, and etc) into the database. I have read the tutorial, but what i want to know wasnt in there. What i want to know is how to create a database (one that doesnt disappear once i close my eclipse), insert new data, and how to open it?",sql,query,,,,11/07/2011 15:23:24,not a real question,1,97,10,"New to SQLJet, how to save data into the database? this is my first time asking questions in here. If I have done something wrong please tell me.
Well i will get straight to the point.
I am working on a simple project in which i want to use SQLJet. I simply want to save data about food (ie. name, nationality, calorie, and etc) into the database. I have read the tutorial, but what i want to know wasnt in there. What i want to know is how to create a database (one that doesnt disappear once i close my eclipse), insert new data, and how to open it?",2
8228089,11/22/2011 14:05:50,678030,03/26/2011 13:08:32,80,2,Auto generated linq class is empty?,"This is a continuation of my previous question: http://stackoverflow.com/questions/8215773/could-not-find-an-implementation-of-the-query-pattern

I'm trying to insert a new 'Inschrijving' into my database. I try this with the following code:

    [OperationContract]
    public void insertInschrijving(Inschrijvingen inschrijving)
    {
    
        var context = new DataClassesDataContext();
    
        context.Inschrijvingens.InsertOnSubmit(inschrijving);
        dc.SubmitChanges();
    }

But the context.Inschrijvingens.InsertOnSubmit(inschrijving); gives me the following error: 

> cannot convert from 'OndernemersAward.Web.Service.Inschrijvingen' to 'OndernemersAward.Web.Inschrijvingen'

I call the method in my main page:

     Inschrijvingen1Client client = new Inschrijvingen1Client();
    
                Inschrijvingen i = new Inschrijvingen();
    
                client.insertInschrijvingCompleted += new EventHandler<System.ComponentModel.AsyncCompletedEventArgs>(client_insertInschrijvingCompleted);
                client.insertInschrijvingAsync(i);

But as you can see there appears to be something wrong with my Inschrijvingen class, which is auto generated by LINQ. (Auto generated class can be found here: http://pastebin.com/QKuAAKgV)

I'm not entirely sure what is causing this, but I assume it has something to do with the auto generated class not being correct?

Thank you for your time,
Thomas 

",sql,silverlight,linq,class,,,open,0,229,6,"Auto generated linq class is empty? This is a continuation of my previous question: http://stackoverflow.com/questions/8215773/could-not-find-an-implementation-of-the-query-pattern

I'm trying to insert a new 'Inschrijving' into my database. I try this with the following code:

    [OperationContract]
    public void insertInschrijving(Inschrijvingen inschrijving)
    {
    
        var context = new DataClassesDataContext();
    
        context.Inschrijvingens.InsertOnSubmit(inschrijving);
        dc.SubmitChanges();
    }

But the context.Inschrijvingens.InsertOnSubmit(inschrijving); gives me the following error: 

> cannot convert from 'OndernemersAward.Web.Service.Inschrijvingen' to 'OndernemersAward.Web.Inschrijvingen'

I call the method in my main page:

     Inschrijvingen1Client client = new Inschrijvingen1Client();
    
                Inschrijvingen i = new Inschrijvingen();
    
                client.insertInschrijvingCompleted += new EventHandler<System.ComponentModel.AsyncCompletedEventArgs>(client_insertInschrijvingCompleted);
                client.insertInschrijvingAsync(i);

But as you can see there appears to be something wrong with my Inschrijvingen class, which is auto generated by LINQ. (Auto generated class can be found here: http://pastebin.com/QKuAAKgV)

I'm not entirely sure what is causing this, but I assume it has something to do with the auto generated class not being correct?

Thank you for your time,
Thomas 

",4
8164458,11/17/2011 08:59:44,844154,07/14/2011 08:46:23,6,0,Enabling dot login in SQL server 2008,"i have a local sql server 2008 on my development machine.
when i connect to it, say from the server management studio, for server name field, i have to put machineName\sqlexpress.
however, i have noticed in my colleagues machines they use just a dot (.)
i would like to use that way of connecting.
could someone help me enable the dot login in sql server 2008",sql,server,login,dot,,11/17/2011 16:18:32,off topic,1,62,7,"Enabling dot login in SQL server 2008 i have a local sql server 2008 on my development machine.
when i connect to it, say from the server management studio, for server name field, i have to put machineName\sqlexpress.
however, i have noticed in my colleagues machines they use just a dot (.)
i would like to use that way of connecting.
could someone help me enable the dot login in sql server 2008",4
8046386,11/08/2011 05:37:56,867198,07/28/2011 10:03:17,11,0,sum of time based on flag from multiple rows MS SQL,"I am having tough time executing one of the query. I need to find the ignition time based on the flag from same table. table is like below,

    UnitId      eventtime               ign
    ----------- ----------------------- -----
    356         2011-05-04 10:41:00.000 1
    356         2011-05-04 10:42:00.000 1
    356         2011-05-04 10:43:00.000 1
    356         2011-05-04 10:45:00.000 1
    356         2011-05-04 10:47:00.000 1
    356         2011-05-04 10:48:00.000 0
    356         2011-05-04 11:14:00.000 1
    356         2011-05-04 11:14:00.000 1
    356         2011-05-04 11:15:00.000 1
    356         2011-05-04 11:15:00.000 1
    356         2011-05-04 11:15:00.000 1
    356         2011-05-04 11:16:00.000 0
    356         2011-05-04 11:16:00.000 0
    356         2011-05-04 11:16:00.000 0
    356         2011-05-04 14:49:00.000 1
    356         2011-05-04 14:50:00.000 1
    356         2011-05-04 14:50:00.000 1
    356         2011-05-04 14:51:00.000 1
    356         2011-05-04 14:52:00.000 0
    356         2011-05-04 14:52:00.000 0
    356         2011-05-04 20:52:00.000 0


Here, The Ign flag will determine the ignition_on and iginition_off time.
So above table we can have the ignition pair of

    2011-05-04 10:41:00.000 - 2011-05-04 10:48:00.000
    2011-05-04 11:14:00.000 - 2011-05-04 11:16:00.000
    2011-05-04 14:49:00.000 - 2011-05-04 14:52:00.000

So from looking at the above pair i can say that my unit runs for 7 + 2 + 3 = 12 minutes. I DONT WANT THE ABOVE PAIRS IN MY RESULT, ITS FOR EXAMPLE ONLY. MY AIM HERE IS TO GET THIS RESULT OF 12 MINUTES.

How can i achieve it using single query, right now i am using the CURSOR loop but this thing takes much more time for multiple days and multiple units. Is there anyway by which i can achieve it without the CURSOR?
",sql,sql-server,,,,,open,0,503,11,"sum of time based on flag from multiple rows MS SQL I am having tough time executing one of the query. I need to find the ignition time based on the flag from same table. table is like below,

    UnitId      eventtime               ign
    ----------- ----------------------- -----
    356         2011-05-04 10:41:00.000 1
    356         2011-05-04 10:42:00.000 1
    356         2011-05-04 10:43:00.000 1
    356         2011-05-04 10:45:00.000 1
    356         2011-05-04 10:47:00.000 1
    356         2011-05-04 10:48:00.000 0
    356         2011-05-04 11:14:00.000 1
    356         2011-05-04 11:14:00.000 1
    356         2011-05-04 11:15:00.000 1
    356         2011-05-04 11:15:00.000 1
    356         2011-05-04 11:15:00.000 1
    356         2011-05-04 11:16:00.000 0
    356         2011-05-04 11:16:00.000 0
    356         2011-05-04 11:16:00.000 0
    356         2011-05-04 14:49:00.000 1
    356         2011-05-04 14:50:00.000 1
    356         2011-05-04 14:50:00.000 1
    356         2011-05-04 14:51:00.000 1
    356         2011-05-04 14:52:00.000 0
    356         2011-05-04 14:52:00.000 0
    356         2011-05-04 20:52:00.000 0


Here, The Ign flag will determine the ignition_on and iginition_off time.
So above table we can have the ignition pair of

    2011-05-04 10:41:00.000 - 2011-05-04 10:48:00.000
    2011-05-04 11:14:00.000 - 2011-05-04 11:16:00.000
    2011-05-04 14:49:00.000 - 2011-05-04 14:52:00.000

So from looking at the above pair i can say that my unit runs for 7 + 2 + 3 = 12 minutes. I DONT WANT THE ABOVE PAIRS IN MY RESULT, ITS FOR EXAMPLE ONLY. MY AIM HERE IS TO GET THIS RESULT OF 12 MINUTES.

How can i achieve it using single query, right now i am using the CURSOR loop but this thing takes much more time for multiple days and multiple units. Is there anyway by which i can achieve it without the CURSOR?
",2
11315800,07/03/2012 17:07:58,1371274,05/02/2012 23:44:33,1,0,Grails 2.0.4 and sql profiling using p6spy plug-in‏ configuartion,"I am using grails 2.0.4.  Even though the sql profiler client is connecting; p6spy is not logging anything.

I suspect that the problem lies in the property file, or that there is a conflict with my 
Config.groovy log4j settings.

I have been looking at this all day; any help is highly appreciated.

**•	spy.properties**

    module.log=com.p6spy.engine.logging.P6LogFactory

    realdriver=oracle.jdbc.driver.OracleDriver

    dateformat=HH:mm:ss

    deregisterdrivers=false

    executionthreshold=

    outagedetection=false

    outagedetectioninterval=

    filter=false

    include  =

    exclude  =

    sqlexpression =

    autoflush= true

    includecategories=

    excludecategories=

    stringmatcher=

    stacktrace=false

    stacktraceclass=

    reloadproperties=false

    reloadpropertiesinterval=60

    useprefix=false

    appender=com.p6spy.engine.logging.appender.Log4jLogger

    append=true

    log4j.appender.SQLPROFILER_CLIENT=org.apache.log4j.net.SocketAppender

    log4j.appender.SQLPROFILER_CLIENT.RemoteHost=localhost

    log4j.appender.SQLPROFILER_CLIENT.Port=4445

    log4j.appender.SQLPROFILER_CLIENT.LocationInfo=true

    log4j.logger.p6spy=DEBUG,SQLPROFILER_CLIENT

**•	DataSource.groovy**

    dataSource {

        pooled = true

        logSql = true

        //driverClassName = ""oracle.jdbc.driver.OracleDriver""

        driverClassName = ""com.p6spy.engine.spy.P6SpyDriver"" // use this driver to enable p6spy logging

        dialect = 'org.hibernate.dialect.Oracle10gDialect'

    }

**•	Config.Groovy**

    // log4j configuration

    log4j = {

        appenders {

            console name:'stdout', layout:pattern(conversionPattern: '%d{ISO8601} [%c{1}] %p: %m%n')

        }

        info    'grails.app' // Logging warnings and higher for all of the app

        error   'org.codehaus.groovy.grails.web.servlet',  //  controllers
                'org.codehaus.groovy.grails.web.pages', //  GSP
                'org.codehaus.groovy.grails.web.sitemesh', //  layouts
                'org.codehaus.groovy.grails.web.mapping.filter', // URL mapping
                'org.codehaus.groovy.grails.web.mapping', // URL mapping
                'org.codehaus.groovy.grails.commons', // core / classloading
                'org.codehaus.groovy.grails.plugins', // plugins
                'org.codehaus.groovy.grails.orm.hibernate', // hibernate integration
                'org.springframework',
                'org.hibernate',
                'net.sf.ehcache.hibernate'

        trace    'org.hibernate.type'

    }",sql,grails,profiling,p6spy,,,open,0,513,9,"Grails 2.0.4 and sql profiling using p6spy plug-in‏ configuartion I am using grails 2.0.4.  Even though the sql profiler client is connecting; p6spy is not logging anything.

I suspect that the problem lies in the property file, or that there is a conflict with my 
Config.groovy log4j settings.

I have been looking at this all day; any help is highly appreciated.

**•	spy.properties**

    module.log=com.p6spy.engine.logging.P6LogFactory

    realdriver=oracle.jdbc.driver.OracleDriver

    dateformat=HH:mm:ss

    deregisterdrivers=false

    executionthreshold=

    outagedetection=false

    outagedetectioninterval=

    filter=false

    include  =

    exclude  =

    sqlexpression =

    autoflush= true

    includecategories=

    excludecategories=

    stringmatcher=

    stacktrace=false

    stacktraceclass=

    reloadproperties=false

    reloadpropertiesinterval=60

    useprefix=false

    appender=com.p6spy.engine.logging.appender.Log4jLogger

    append=true

    log4j.appender.SQLPROFILER_CLIENT=org.apache.log4j.net.SocketAppender

    log4j.appender.SQLPROFILER_CLIENT.RemoteHost=localhost

    log4j.appender.SQLPROFILER_CLIENT.Port=4445

    log4j.appender.SQLPROFILER_CLIENT.LocationInfo=true

    log4j.logger.p6spy=DEBUG,SQLPROFILER_CLIENT

**•	DataSource.groovy**

    dataSource {

        pooled = true

        logSql = true

        //driverClassName = ""oracle.jdbc.driver.OracleDriver""

        driverClassName = ""com.p6spy.engine.spy.P6SpyDriver"" // use this driver to enable p6spy logging

        dialect = 'org.hibernate.dialect.Oracle10gDialect'

    }

**•	Config.Groovy**

    // log4j configuration

    log4j = {

        appenders {

            console name:'stdout', layout:pattern(conversionPattern: '%d{ISO8601} [%c{1}] %p: %m%n')

        }

        info    'grails.app' // Logging warnings and higher for all of the app

        error   'org.codehaus.groovy.grails.web.servlet',  //  controllers
                'org.codehaus.groovy.grails.web.pages', //  GSP
                'org.codehaus.groovy.grails.web.sitemesh', //  layouts
                'org.codehaus.groovy.grails.web.mapping.filter', // URL mapping
                'org.codehaus.groovy.grails.web.mapping', // URL mapping
                'org.codehaus.groovy.grails.commons', // core / classloading
                'org.codehaus.groovy.grails.plugins', // plugins
                'org.codehaus.groovy.grails.orm.hibernate', // hibernate integration
                'org.springframework',
                'org.hibernate',
                'net.sf.ehcache.hibernate'

        trace    'org.hibernate.type'

    }",4
4146138,11/10/2010 15:36:45,201665,11/03/2009 12:44:08,410,15,PostgreSQL: how to efficiently alter multiple columns from psql?,"I have PostgreSQL table with several boolean columns, currently containing only true or null. I want to do the following for all of them:

1.  Add a default value of false
2.  Change all null values to false
3.  Add a `not null` constraint

Is there a feature of psql (or standard SQL) that will iterate over a specified list of columns and apply a sequence of operations to each one?",sql,postgresql,,,,,open,0,70,9,"PostgreSQL: how to efficiently alter multiple columns from psql? I have PostgreSQL table with several boolean columns, currently containing only true or null. I want to do the following for all of them:

1.  Add a default value of false
2.  Change all null values to false
3.  Add a `not null` constraint

Is there a feature of psql (or standard SQL) that will iterate over a specified list of columns and apply a sequence of operations to each one?",2
8617876,12/23/2011 15:43:45,778279,05/31/2011 19:55:52,57,2,"Sql Server 2008 tsql select hanging, but not dead locked. Weird issue","This is a pretty strange issue so bear with me.  I have a sproc that does some heavy duty processing.  When it runs well it usually takes a few minutes depending on server load, but occasionally it appears to get stuck.  I have looked at the results of sp_who2 and what I see is that the process is not blocked, it's still listed as 'RUNNABLE', but the value in disk IO stays the same.  Once the process gets in this state it never finishes.  If i kill the process and re-execute the sproc i usually get the same result.  Sometimes re-executing the sproc works, but increasingly I end up having to restart sql server.  Not ideal...  After restart the sproc executes as expected.  Has anyone even hit a problem like this?  Any advice would be greatly appreciated.

Some more context.  The sproc I am executing looks something like this:

    delete
    from table1

    insert into table1
    select columns
    from 
    (
        select columns
        from giant_table_1 WITH (NOLOCK)
        where condition
        group by columns

        UNION

        select columns
        from giant_table_2 WITH (NOLOCK)
        where condition
        group by columns
    )
    where condition

    more crud on table1
    .
    .
    .

if I insert some logging statements into the sproc I can see that when it hangs it hangs on the insert/select.  Wondering if this could be a weird consequence of the NOLOCK statement.  We (and by we I mean my boss :)) added the nolock because giant_table_1 and giant_table_2 are constantly being changed.  Without the nolock our sproc was getting blocked a lot by other long running processes and vice versa.

Thanks in advance!",sql,sql-server-2008,tsql,locking,,12/25/2011 19:38:10,off topic,1,377,12,"Sql Server 2008 tsql select hanging, but not dead locked. Weird issue This is a pretty strange issue so bear with me.  I have a sproc that does some heavy duty processing.  When it runs well it usually takes a few minutes depending on server load, but occasionally it appears to get stuck.  I have looked at the results of sp_who2 and what I see is that the process is not blocked, it's still listed as 'RUNNABLE', but the value in disk IO stays the same.  Once the process gets in this state it never finishes.  If i kill the process and re-execute the sproc i usually get the same result.  Sometimes re-executing the sproc works, but increasingly I end up having to restart sql server.  Not ideal...  After restart the sproc executes as expected.  Has anyone even hit a problem like this?  Any advice would be greatly appreciated.

Some more context.  The sproc I am executing looks something like this:

    delete
    from table1

    insert into table1
    select columns
    from 
    (
        select columns
        from giant_table_1 WITH (NOLOCK)
        where condition
        group by columns

        UNION

        select columns
        from giant_table_2 WITH (NOLOCK)
        where condition
        group by columns
    )
    where condition

    more crud on table1
    .
    .
    .

if I insert some logging statements into the sproc I can see that when it hangs it hangs on the insert/select.  Wondering if this could be a weird consequence of the NOLOCK statement.  We (and by we I mean my boss :)) added the nolock because giant_table_1 and giant_table_2 are constantly being changed.  Without the nolock our sproc was getting blocked a lot by other long running processes and vice versa.

Thanks in advance!",4
8803906,01/10/2012 13:20:35,1096450,12/13/2011 19:01:50,7,0,SQL Query to check if today is Employee's birthday,"Can any one tell me how to get the list of an employee who have their birthdays today ....


Thanks,
Vishal",sql,datetime,datediff,,,01/10/2012 14:15:44,not a real question,1,19,9,"SQL Query to check if today is Employee's birthday Can any one tell me how to get the list of an employee who have their birthdays today ....


Thanks,
Vishal",3
2965489,06/03/2010 11:33:31,340331,05/13/2010 13:54:17,6,0,SQL: Add counters in select,"I have a table which contains names:

    Name
    ----
    John Smith
    John Smith
    Sam Wood
    George Wright
    John Smith
    Sam Wood

I want to create a select statement which shows this:

Name
----
'John Smith 1'

'John Smith 2'

'Sam Wood 1'

'George Wright 1'

'John Smith 3'

'Sam Wood 2'

In other words, I want to add separate counters to each name. Is there a way to do it without using cursors?",sql,counter,,,,,open,0,87,5,"SQL: Add counters in select I have a table which contains names:

    Name
    ----
    John Smith
    John Smith
    Sam Wood
    George Wright
    John Smith
    Sam Wood

I want to create a select statement which shows this:

Name
----
'John Smith 1'

'John Smith 2'

'Sam Wood 1'

'George Wright 1'

'John Smith 3'

'Sam Wood 2'

In other words, I want to add separate counters to each name. Is there a way to do it without using cursors?",2
9343866,02/18/2012 18:20:51,1055487,11/19/2011 16:16:22,29,0,SQL orcl10g trigger insert (deathDate after birthDate),"The trigger needs to stop a death date before the birthdate being entered. 


    CREATE TRIGGER Check_deathDate
    BEFORE INSERT Or UPDATE of deathDate on Actor
    FOR EACH ROW
    DECLARE
    deathDate  			DATE;
    birthDate			DATE;
    deathDate_Error		EXCEPTION;
    IF (deathDate < birthDate) THEN
    RAISE deathDate_Error;
    END IF;
    EXCEPTION 
    WHEN deathDate_Error THEN
    Raise_application_error( 'deathDate' || 'should be before' || 'birthDate');
    END;);



gives error...

*
ERROR at line 3:
ORA-04079: invalid trigger specification


...how else can i specifiy the IF?",sql,triggers,,,,,open,0,112,7,"SQL orcl10g trigger insert (deathDate after birthDate) The trigger needs to stop a death date before the birthdate being entered. 


    CREATE TRIGGER Check_deathDate
    BEFORE INSERT Or UPDATE of deathDate on Actor
    FOR EACH ROW
    DECLARE
    deathDate  			DATE;
    birthDate			DATE;
    deathDate_Error		EXCEPTION;
    IF (deathDate < birthDate) THEN
    RAISE deathDate_Error;
    END IF;
    EXCEPTION 
    WHEN deathDate_Error THEN
    Raise_application_error( 'deathDate' || 'should be before' || 'birthDate');
    END;);



gives error...

*
ERROR at line 3:
ORA-04079: invalid trigger specification


...how else can i specifiy the IF?",2
6831069,07/26/2011 13:52:15,368708,04/19/2010 21:09:28,1141,61,Doing an update_all with joins in Rails,"It's times like this that Rails' abstraction from raw SQL drives me batty. In MySQL I could do this:

    UPDATE FROM tasks AS t 
    LEFT JOIN projects as p 
    ON t.project_id = p.id 
    SET t.invoice_id = 7
    WHERE p.organization_id == 42
    AND t.invoice_id IS NULL

How can I do this in Rails 3.0.1 with eager loading? I've tried all of the following:

    Tasks.joins(:project).where('projects.organization_id' => 42, :invoice_id => nil).update_all( :invoice_id => 7 )

And all of the variations of the above. All either gave errors or didn't find anything.

Then I tried to use `scope`:

    Task.scope :find => {:joins => :project, :conditions => [""projects.organization_id == ? AND invoice_id IS NULL"", 7] } do
      Task.update_all :invoice_id => @invoice.id
    end

This one gave me the error `undefined method 'to_sym' for #<Hash:0x1065c6438>`.

I've spent way too many hours on this, just to replicate a simple SQL query. Please help!

Thank you...

",sql,ruby-on-rails,ruby,update,scope,,open,0,176,7,"Doing an update_all with joins in Rails It's times like this that Rails' abstraction from raw SQL drives me batty. In MySQL I could do this:

    UPDATE FROM tasks AS t 
    LEFT JOIN projects as p 
    ON t.project_id = p.id 
    SET t.invoice_id = 7
    WHERE p.organization_id == 42
    AND t.invoice_id IS NULL

How can I do this in Rails 3.0.1 with eager loading? I've tried all of the following:

    Tasks.joins(:project).where('projects.organization_id' => 42, :invoice_id => nil).update_all( :invoice_id => 7 )

And all of the variations of the above. All either gave errors or didn't find anything.

Then I tried to use `scope`:

    Task.scope :find => {:joins => :project, :conditions => [""projects.organization_id == ? AND invoice_id IS NULL"", 7] } do
      Task.update_all :invoice_id => @invoice.id
    end

This one gave me the error `undefined method 'to_sym' for #<Hash:0x1065c6438>`.

I've spent way too many hours on this, just to replicate a simple SQL query. Please help!

Thank you...

",5
8298486,11/28/2011 15:54:33,1004278,10/20/2011 00:53:10,333,4,"SQL parsing fails, not sure what the issue is?","This parses fine:

    MERGE INTO SECURE_GROUPS USING
        (SELECT :P94_NAME name FROM dual) data
    ON (data.name = PEOPLE.PERSON_NAME)
    WHEN NOT MATCHED THEN
        INSERT (PERSON_NAME) VALUES (data.name);

This fails with:
1 error has occurred
ORA-06550: line 10, column 51: PL/SQL: ORA-00923: FROM keyword not found where expected ORA-06550: line 9, column 1: PL/SQL: SQL Statement ignored
   
     MERGE INTO SECURE_GROUPS USING
            (SELECT :P94_NAME name, :P94_NUMBER num FROM dual) data
        ON (data.name = PEOPLE.PERSON_NAME)
        WHEN NOT MATCHED THEN
            INSERT (PERSON_NAME, PERSON_NUMBER) VALUES (data.name, data.num);",sql,oracle,oracle10g,oracle-apex,,,open,0,143,9,"SQL parsing fails, not sure what the issue is? This parses fine:

    MERGE INTO SECURE_GROUPS USING
        (SELECT :P94_NAME name FROM dual) data
    ON (data.name = PEOPLE.PERSON_NAME)
    WHEN NOT MATCHED THEN
        INSERT (PERSON_NAME) VALUES (data.name);

This fails with:
1 error has occurred
ORA-06550: line 10, column 51: PL/SQL: ORA-00923: FROM keyword not found where expected ORA-06550: line 9, column 1: PL/SQL: SQL Statement ignored
   
     MERGE INTO SECURE_GROUPS USING
            (SELECT :P94_NAME name, :P94_NUMBER num FROM dual) data
        ON (data.name = PEOPLE.PERSON_NAME)
        WHEN NOT MATCHED THEN
            INSERT (PERSON_NAME, PERSON_NUMBER) VALUES (data.name, data.num);",4
3384044,08/01/2010 22:51:02,408169,08/01/2010 22:51:02,1,0,MySQL - How can i update a table with values from annother table?,"i'have the task to repair some invalid data in a mysql-database. In one table there are people with a missing date, which should be filled from a second table, **if** there is a corresponding entry. 

TablePeople: ID, MissingDate, ...  
TableEvent: ID, people_id, replacementDate, ...

    Update TablePeople set missingdate =   
       (select replacementDate from TableEvent where people_id = TablePeople.ID)   
    where   
      missingdate is null  
      and (select count(*) from TableEvent where people_id = TablePeople.ID)>0

certainly doesn't work, is there any other way with SQL? Or how can i process single rows in mysql to get it done? 
",sql,mysql,update,,,,open,0,127,13,"MySQL - How can i update a table with values from annother table? i'have the task to repair some invalid data in a mysql-database. In one table there are people with a missing date, which should be filled from a second table, **if** there is a corresponding entry. 

TablePeople: ID, MissingDate, ...  
TableEvent: ID, people_id, replacementDate, ...

    Update TablePeople set missingdate =   
       (select replacementDate from TableEvent where people_id = TablePeople.ID)   
    where   
      missingdate is null  
      and (select count(*) from TableEvent where people_id = TablePeople.ID)>0

certainly doesn't work, is there any other way with SQL? Or how can i process single rows in mysql to get it done? 
",3
7721496,10/11/2011 04:51:20,102588,05/07/2009 02:12:20,337,6,"Excel KURT function, Whether Sql Server has the same aggregate function?","Excel has KURT function that returns the kurtosis of a data set, is Sql Server has the same aggregate function? if not, can you tell me how can i do ? using SQL CLR?

Thanks!",sql,sql-server,aggregate-functions,,,,open,0,34,11,"Excel KURT function, Whether Sql Server has the same aggregate function? Excel has KURT function that returns the kurtosis of a data set, is Sql Server has the same aggregate function? if not, can you tell me how can i do ? using SQL CLR?

Thanks!",3
9032586,01/27/2012 11:25:05,642573,03/03/2011 07:45:54,321,36,sql- Alter table to add a column which default value is based on other value,"my sql table:

    CREATE TABLE [dbo].[PayrollParameter](
    	[PayrollParameterID] [char](36) NOT NULL,
    	[Description] [nvarchar](50) NOT NULL,
    	[NumberOfDaysInMonth] [int] NOT NULL,
    	[IsFixedDaysInMonth] [bit] NOT NULL,
     CONSTRAINT [PK_PayrollParameter] PRIMARY KEY CLUSTERED 
    (
    	[PayrollParameterID] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    ) ON [PRIMARY]
    
    GO

the database already contain records; I want to **alter the table** to set the default value of `IsFixedDaysInMonth` to Checked if `NumberOfDaysInMonth`!=0

How can i do this?",sql,sql-server-2008,,,,,open,0,120,15,"sql- Alter table to add a column which default value is based on other value my sql table:

    CREATE TABLE [dbo].[PayrollParameter](
    	[PayrollParameterID] [char](36) NOT NULL,
    	[Description] [nvarchar](50) NOT NULL,
    	[NumberOfDaysInMonth] [int] NOT NULL,
    	[IsFixedDaysInMonth] [bit] NOT NULL,
     CONSTRAINT [PK_PayrollParameter] PRIMARY KEY CLUSTERED 
    (
    	[PayrollParameterID] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    ) ON [PRIMARY]
    
    GO

the database already contain records; I want to **alter the table** to set the default value of `IsFixedDaysInMonth` to Checked if `NumberOfDaysInMonth`!=0

How can i do this?",2
133099,09/25/2008 12:45:28,7211,09/15/2008 13:21:29,288,33,Sybase Developer Needs To Learn Oracle,"I am pretty much a Sybase expert, an experienced developer, and very comfortable learning new stuff.  
I need to write a bunch of SQL to run against an Oracle database.  
Can someone recommend a book, training course or other resource to give me what I need to know in the shortest possible time?  

I don't need _Oracle for Dummies_, but something more like _Oracle for people who already know SQL and RDBMS_. 

I know that @Martin asked [a similar question ](http://stackoverflow.com/questions/39438/developer-moving-from-sql-server-to-oracle) regarding SQL Server to Oracle, but SQL Server is (nowadays) different enough that I'd like any sybase-specific help you can give.  

Thanks :)",sql,database,oracle,books,sybase,02/09/2012 13:59:17,not constructive,1,108,6,"Sybase Developer Needs To Learn Oracle I am pretty much a Sybase expert, an experienced developer, and very comfortable learning new stuff.  
I need to write a bunch of SQL to run against an Oracle database.  
Can someone recommend a book, training course or other resource to give me what I need to know in the shortest possible time?  

I don't need _Oracle for Dummies_, but something more like _Oracle for people who already know SQL and RDBMS_. 

I know that @Martin asked [a similar question ](http://stackoverflow.com/questions/39438/developer-moving-from-sql-server-to-oracle) regarding SQL Server to Oracle, but SQL Server is (nowadays) different enough that I'd like any sybase-specific help you can give.  

Thanks :)",5
11545802,07/18/2012 16:13:40,1535319,07/18/2012 15:29:45,1,0,comparing query results from within the same table,"RDBMS SQL Server, T-SQL

Consider a table that links information from two different tables: Articles and Categories. This table contains for each Article one or several entries containing the ID of the Categories the Article belongs to. Therefore, a SELECT * FROM TABLE WHERE ARTICLEID=X returns 1 to n results. 

I am looking to build a query which allows me to compare Articles that have the exact same combination of Categories. I've been trying with INTERSECT, but that does not return any rows. An example:

ARTICLEID  CATEGORYID

    1  1
    1  2
    1  4
    2  1
    2  4
    3  1
    3  2
    3  4
    4  2
    4  4
    5  1
    5  2
    5  4

The query for ARTICLEID=1 should return 3 and 5, for ARTICLEID=3 should return 1 and 5, etcetera.

",sql,tsql,intersect,,,,open,0,180,8,"comparing query results from within the same table RDBMS SQL Server, T-SQL

Consider a table that links information from two different tables: Articles and Categories. This table contains for each Article one or several entries containing the ID of the Categories the Article belongs to. Therefore, a SELECT * FROM TABLE WHERE ARTICLEID=X returns 1 to n results. 

I am looking to build a query which allows me to compare Articles that have the exact same combination of Categories. I've been trying with INTERSECT, but that does not return any rows. An example:

ARTICLEID  CATEGORYID

    1  1
    1  2
    1  4
    2  1
    2  4
    3  1
    3  2
    3  4
    4  2
    4  4
    5  1
    5  2
    5  4

The query for ARTICLEID=1 should return 3 and 5, for ARTICLEID=3 should return 1 and 5, etcetera.

",3
1509732,10/02/2009 14:06:01,95944,04/25/2009 12:57:54,384,10,Select Only Max 3 Rows From The Same User,"Let's say there are two tables:

Table ""photos"" with columns:

    id,
    title,
    path,
    user_id

And table ""users"" with columns:

    id
    username

What I want to do is select let's say 30 photos from the ""photos"" table but with condition that there are at most 3 photos from the same user in the fetched result set. So far I have this query:

    SELECT p.*, u.username FROM photos AS p 
    INNER JOIN users AS u ON u.id = p.user_id 
    ORDER BY p.id DESC LIMIT 30;

How to create a WHERE clause to achieve max. 3 rows from the same users in the fetched result set?",sql,mysql,postgres,,,,open,0,128,9,"Select Only Max 3 Rows From The Same User Let's say there are two tables:

Table ""photos"" with columns:

    id,
    title,
    path,
    user_id

And table ""users"" with columns:

    id
    username

What I want to do is select let's say 30 photos from the ""photos"" table but with condition that there are at most 3 photos from the same user in the fetched result set. So far I have this query:

    SELECT p.*, u.username FROM photos AS p 
    INNER JOIN users AS u ON u.id = p.user_id 
    ORDER BY p.id DESC LIMIT 30;

How to create a WHERE clause to achieve max. 3 rows from the same users in the fetched result set?",3
4065055,10/31/2010 20:53:52,492998,10/31/2010 20:49:12,1,0,SQL create table and query from it,"Morning all, 
I'm running SQL Server and there are a whole lot of tables in there. I have taken one column from one of these tables using SELECT, and it gives me the list of IDs. I need to use these IDs as the lookup point to get the data for that ID from another table. Is it necessary that I do a CREATE TABE manouvre? 

I was hoping I could just use the data returned from the original SELECT statement without having to set up a new table....

Cheers.",sql,sql-server,,,,,open,0,89,7,"SQL create table and query from it Morning all, 
I'm running SQL Server and there are a whole lot of tables in there. I have taken one column from one of these tables using SELECT, and it gives me the list of IDs. I need to use these IDs as the lookup point to get the data for that ID from another table. Is it necessary that I do a CREATE TABE manouvre? 

I was hoping I could just use the data returned from the original SELECT statement without having to set up a new table....

Cheers.",2
5438073,03/25/2011 20:57:24,677437,03/25/2011 20:57:24,1,0,How do you distinguish a SQL table from a temp table?,"1. Any thoughts? 

2. Also can you please give me a simple SELECT statement based on the Northwind database? 

3. And why would you use a temp table?

many thanks",sql,sql-server,sql-server-2005,,,03/27/2011 02:59:27,not a real question,1,29,11,"How do you distinguish a SQL table from a temp table? 1. Any thoughts? 

2. Also can you please give me a simple SELECT statement based on the Northwind database? 

3. And why would you use a temp table?

many thanks",3
444988,01/14/2009 22:43:40,807,08/09/2008 03:37:54,38,5,sync SQL Server 2005 login passwords,"Background:<br/>
We are running a web application where each user has a login to the system.  The application login is mapped to an actual SQL Server 2005 login (which we needed to create).  Our development and disaster recovery sites are simply copies of this setup.  On a nightly basis, the production database is backed up, the dump is archived, and we restore dev and DR using this file.  When this is done, we need to run sp\_change\_users\_login for each user to remap the database user to the SQL login.

Problem:<br/>
When the user changes their password on production, the SQL login password is changed.  This is not getting synced to dev/DR, so if they try to log on to one of those sites, they can't, and need to reset their password.  Is there a [good] way to keep these SQL logins synced across multiple installs?

The next version of this product eliminates the SQL login need, but upgrading is not a current priority.",sql,sql-server,sql-server-2005,,,,open,0,165,6,"sync SQL Server 2005 login passwords Background:<br/>
We are running a web application where each user has a login to the system.  The application login is mapped to an actual SQL Server 2005 login (which we needed to create).  Our development and disaster recovery sites are simply copies of this setup.  On a nightly basis, the production database is backed up, the dump is archived, and we restore dev and DR using this file.  When this is done, we need to run sp\_change\_users\_login for each user to remap the database user to the SQL login.

Problem:<br/>
When the user changes their password on production, the SQL login password is changed.  This is not getting synced to dev/DR, so if they try to log on to one of those sites, they can't, and need to reset their password.  Is there a [good] way to keep these SQL logins synced across multiple installs?

The next version of this product eliminates the SQL login need, but upgrading is not a current priority.",3
5567299,04/06/2011 13:40:20,694917,04/06/2011 13:40:20,1,0,SQL VB.net insert using select AND values,"New to using SQL and I am having trouble accomplishing something that I figured would be simple.

I am trying to create and INSERT that will insert the MAX() value from the first column in one table to the first column in another table while the rest of the columns will be filled with parameters.

I have tried switching my code around to see if I just had the syntax wrong but I've had no luck and I'm not even sure what I'm trying to do is possible (at least in a single INSERT).

Here is what I have at the moment:

    INSERT INTO [Table2] VALUES(SELECT(Number FROM [Table1] WHERE Max(Number)), @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)",sql,vb.net,tsql,,,,open,0,120,7,"SQL VB.net insert using select AND values New to using SQL and I am having trouble accomplishing something that I figured would be simple.

I am trying to create and INSERT that will insert the MAX() value from the first column in one table to the first column in another table while the rest of the columns will be filled with parameters.

I have tried switching my code around to see if I just had the syntax wrong but I've had no luck and I'm not even sure what I'm trying to do is possible (at least in a single INSERT).

Here is what I have at the moment:

    INSERT INTO [Table2] VALUES(SELECT(Number FROM [Table1] WHERE Max(Number)), @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)",3
11076909,06/18/2012 04:23:26,1448837,06/11/2012 11:31:25,6,1,Joining Two Queries,"I have two select queries to use in my project for getting data and displaying it in my web page. I want to join them so that I need to access data only once. But I don't know how to join them as one of the query contains group function. Could you help me? Thanks in Advance. Following are my queries,

First query is,

        SELECT DISTINCT 
                          a.user_id, a.employee_code, a.employee_type, a.employee_email, a.employee_name, a.home_country, a.user_name, a.user_password, 
                          a.isPeoplesoftData, bb.Code AS company, c.location AS location_code, c.desc_loc AS location_desc, c.currency_cd, c.business_title, 
                          c.deptid AS department_code, c.desc_dept AS department_name, (CASE WHEN (c.reports_to = '') THEN c.report_dotted_line_id ELSE c.reports_to END) 
                          AS reports_to, (CASE WHEN (c.reports_to = '') THEN c.report_dotted_line_name ELSE c.reports_to_name END) AS reports_to_name, 
                          c.desc_comp AS company_name, c.grade, CASE WHEN a.weekendType <> 0 THEN a.weekendType ELSE d .weekend_type END AS weekend_type, 
                          e.country AS nationality, f.hire_dt, d.location_id, a.isActive, c.jobcode, c.desc_job, c.country, c.empl_status, dbo.FormatDate(h.birthdate, 'MM/dd/yyy') 
                          AS birthdate, c.monthly_rt, c.annual_rt, i.AccountNo, d.hr
    FROM         dbo.users AS a LEFT OUTER JOIN
                          dbo.employees AS b ON a.employee_code = b.employee_code LEFT OUTER JOIN
                          dbo.employees_jobs AS c ON a.employee_code = c.employee_code AND c.id =
                              (SELECT     TOP (1) id
                                FROM          dbo.employees_jobs
                                WHERE      (employee_code = b.employee_code) AND (effdt <= GETDATE()) AND (isDeleted = 0)
                                ORDER BY effdt DESC, id DESC) LEFT OUTER JOIN
                          dbo.employees_nationality AS e ON e.employee_code = a.employee_code LEFT OUTER JOIN
                          dbo.locations AS d ON c.location = d.location_name LEFT OUTER JOIN
                          dbo.employees_employment AS f ON f.employee_code = a.employee_code INNER JOIN
                          dbo.arabia_employee_entity AS aa ON a.user_id = aa.user_id INNER JOIN
                          dbo.Entity AS bb ON aa.entity_id = bb.EntityID LEFT OUTER JOIN
                          dbo.employees_person AS h ON a.employee_code = h.employee_code INNER JOIN
                          dbo.employee_bank_account AS i ON a.user_id = i.userID
    WHERE     (a.isActive = 1) AND (c.empl_status = 'A' OR
                          c.empl_status = 'L' OR
                          c.empl_status = 'P')

Second query is,

    select currency_cd, SUM(comprate) as salary from employees_compensation where employee_code = @emp_code group by currency_cd

Note: The second query is actually a procedure. On joining I want the employee_code of the second query to be equal to the employee_code of employees table in the first query.",sql,,,,,06/18/2012 15:19:02,too localized,1,955,3,"Joining Two Queries I have two select queries to use in my project for getting data and displaying it in my web page. I want to join them so that I need to access data only once. But I don't know how to join them as one of the query contains group function. Could you help me? Thanks in Advance. Following are my queries,

First query is,

        SELECT DISTINCT 
                          a.user_id, a.employee_code, a.employee_type, a.employee_email, a.employee_name, a.home_country, a.user_name, a.user_password, 
                          a.isPeoplesoftData, bb.Code AS company, c.location AS location_code, c.desc_loc AS location_desc, c.currency_cd, c.business_title, 
                          c.deptid AS department_code, c.desc_dept AS department_name, (CASE WHEN (c.reports_to = '') THEN c.report_dotted_line_id ELSE c.reports_to END) 
                          AS reports_to, (CASE WHEN (c.reports_to = '') THEN c.report_dotted_line_name ELSE c.reports_to_name END) AS reports_to_name, 
                          c.desc_comp AS company_name, c.grade, CASE WHEN a.weekendType <> 0 THEN a.weekendType ELSE d .weekend_type END AS weekend_type, 
                          e.country AS nationality, f.hire_dt, d.location_id, a.isActive, c.jobcode, c.desc_job, c.country, c.empl_status, dbo.FormatDate(h.birthdate, 'MM/dd/yyy') 
                          AS birthdate, c.monthly_rt, c.annual_rt, i.AccountNo, d.hr
    FROM         dbo.users AS a LEFT OUTER JOIN
                          dbo.employees AS b ON a.employee_code = b.employee_code LEFT OUTER JOIN
                          dbo.employees_jobs AS c ON a.employee_code = c.employee_code AND c.id =
                              (SELECT     TOP (1) id
                                FROM          dbo.employees_jobs
                                WHERE      (employee_code = b.employee_code) AND (effdt <= GETDATE()) AND (isDeleted = 0)
                                ORDER BY effdt DESC, id DESC) LEFT OUTER JOIN
                          dbo.employees_nationality AS e ON e.employee_code = a.employee_code LEFT OUTER JOIN
                          dbo.locations AS d ON c.location = d.location_name LEFT OUTER JOIN
                          dbo.employees_employment AS f ON f.employee_code = a.employee_code INNER JOIN
                          dbo.arabia_employee_entity AS aa ON a.user_id = aa.user_id INNER JOIN
                          dbo.Entity AS bb ON aa.entity_id = bb.EntityID LEFT OUTER JOIN
                          dbo.employees_person AS h ON a.employee_code = h.employee_code INNER JOIN
                          dbo.employee_bank_account AS i ON a.user_id = i.userID
    WHERE     (a.isActive = 1) AND (c.empl_status = 'A' OR
                          c.empl_status = 'L' OR
                          c.empl_status = 'P')

Second query is,

    select currency_cd, SUM(comprate) as salary from employees_compensation where employee_code = @emp_code group by currency_cd

Note: The second query is actually a procedure. On joining I want the employee_code of the second query to be equal to the employee_code of employees table in the first query.",1
7175361,08/24/2011 12:25:41,619741,02/16/2011 13:43:33,164,0,"Extra row to SELECT statement, crosstab? Access 2007","I'm working with some biostats people and of course than love SAS.  I have a select statement below that works for testing the presence of certain problems a person can have.  It's a binary thing so they either do or they don't.  If a person has heart problem and a respiratory problem, then they're patientID will be listed twice.  How can I add an extra column of a 1 or 0 for every morbidity?  So, if I have three problems and they are ""HEART"", ""LUNG"" and ""UTI, an extra column would be generated that has a  1 or 0 based on the presence of that a person had that problem or not.  

I suppose I can use Excel to make it a crosstab, but eventually it will need to be in that format.  Below is my SELECT statement.  Thanks, folks!

    SELECT DISTINCT Person.PersonID, Person.Age, Person.Sex, Person.Race, tblComorbidity.comorbidityexplanation
    FROM tblKentuckyCounties INNER JOIN ((tblComorbidity INNER JOIN comorbidVisits ON tblComorbidity.ID = comorbidVisits.comorbidFK) INNER JOIN (Person INNER JOIN tblComorbidityPerson ON Person.PersonID = tblComorbidityPerson.personID) ON tblComorbidity.ID = tblComorbidityPerson.comorbidityFK) ON tblKentuckyCounties.ID = Person.County
    WHERE (((tblComorbidity.comorbidityexplanation)=""anxiety and depression"" Or (tblComorbidity.comorbidityexplanation)=""heart"" Or (tblComorbidity.comorbidityexplanation)=""hypertension"" Or (tblComorbidity.comorbidityexplanation)=""pressure sores"" Or (tblComorbidity.comorbidityexplanation)=""tobacco"" Or (tblComorbidity.comorbidityexplanation)=""uti""));

  ",sql,tsql,ms-access,,,,open,0,212,8,"Extra row to SELECT statement, crosstab? Access 2007 I'm working with some biostats people and of course than love SAS.  I have a select statement below that works for testing the presence of certain problems a person can have.  It's a binary thing so they either do or they don't.  If a person has heart problem and a respiratory problem, then they're patientID will be listed twice.  How can I add an extra column of a 1 or 0 for every morbidity?  So, if I have three problems and they are ""HEART"", ""LUNG"" and ""UTI, an extra column would be generated that has a  1 or 0 based on the presence of that a person had that problem or not.  

I suppose I can use Excel to make it a crosstab, but eventually it will need to be in that format.  Below is my SELECT statement.  Thanks, folks!

    SELECT DISTINCT Person.PersonID, Person.Age, Person.Sex, Person.Race, tblComorbidity.comorbidityexplanation
    FROM tblKentuckyCounties INNER JOIN ((tblComorbidity INNER JOIN comorbidVisits ON tblComorbidity.ID = comorbidVisits.comorbidFK) INNER JOIN (Person INNER JOIN tblComorbidityPerson ON Person.PersonID = tblComorbidityPerson.personID) ON tblComorbidity.ID = tblComorbidityPerson.comorbidityFK) ON tblKentuckyCounties.ID = Person.County
    WHERE (((tblComorbidity.comorbidityexplanation)=""anxiety and depression"" Or (tblComorbidity.comorbidityexplanation)=""heart"" Or (tblComorbidity.comorbidityexplanation)=""hypertension"" Or (tblComorbidity.comorbidityexplanation)=""pressure sores"" Or (tblComorbidity.comorbidityexplanation)=""tobacco"" Or (tblComorbidity.comorbidityexplanation)=""uti""));

  ",3
8258688,11/24/2011 14:33:48,195910,10/24/2009 15:57:49,142,6,Percentage value storage in database,"If I have a percenatge value (6%) what is the prefered way to store this in the database
Solution1: 6
Solution2: .06
And why would you choose it?",sql,sql-server,tsql,,,11/24/2011 15:16:28,not constructive,1,25,5,"Percentage value storage in database If I have a percenatge value (6%) what is the prefered way to store this in the database
Solution1: 6
Solution2: .06
And why would you choose it?",3
3684210,09/10/2010 11:24:39,393135,07/15/2010 19:26:34,80,4,sql query count the zeros,"I have this sql query retrieving IDs from a table with 3 columns: ID, Country and Age

SELECT Country, 
    (CASE 
 WHEN AGE BETWEEN 0 AND 9 THEN '0-9'
 WHEN AGE BETWEEN 10 AND 19 THEN '10-19'
 WHEN AGE BETWEEN 20 AND 29 THEN '20-29'
 WHEN AGE BETWEEN 30 AND 39 THEN '30-39'
 WHEN AGE BETWEEN 40 AND 49 THEN '40-49'
 ELSE '50+'
 END) Age_Bins, COUNT (DISTINCT ID)
FROM MYTABLE
GROUP BY Country, Age_Bins;

The results I get are something like:
UK '0-9' 7; UK '20-29' 14; etc... 
But what I'd like to have also is UK '10-19' 0 (where there are no IDs in that age section). How can the sql code be modified accordingly to also give outputs with zero counts. Thanks",sql,oracle,,,,,open,0,123,5,"sql query count the zeros I have this sql query retrieving IDs from a table with 3 columns: ID, Country and Age

SELECT Country, 
    (CASE 
 WHEN AGE BETWEEN 0 AND 9 THEN '0-9'
 WHEN AGE BETWEEN 10 AND 19 THEN '10-19'
 WHEN AGE BETWEEN 20 AND 29 THEN '20-29'
 WHEN AGE BETWEEN 30 AND 39 THEN '30-39'
 WHEN AGE BETWEEN 40 AND 49 THEN '40-49'
 ELSE '50+'
 END) Age_Bins, COUNT (DISTINCT ID)
FROM MYTABLE
GROUP BY Country, Age_Bins;

The results I get are something like:
UK '0-9' 7; UK '20-29' 14; etc... 
But what I'd like to have also is UK '10-19' 0 (where there are no IDs in that age section). How can the sql code be modified accordingly to also give outputs with zero counts. Thanks",2
3377151,07/31/2010 06:49:21,405398,07/29/2010 07:41:10,6,0,How to connect a SQL server to Java program.,"I ve installed SQL(last update). 
I need to code, that ll create & establish a connection with SQL DB
& manage the DB(using SELECT, INSERT, CREATE).


I did everything but, i am not able to create connection..(i ve also installed the MySQL/J connector, i jus extracted the .zip pack in a folder & added the folder path in Variables)

Can any1 tell me wat is mean by URL in the below line.... 

Connection connection = DriverManager.getConnection(url, username, password);

I ve tried this ""String url = ""jdbc:odbc:sqlserver://localhost:3306/myfirstdb""; ""
for ""Connection con = DriverManager.getConnection(url, ""root"", ""1234"");""

But its not working... I cant able to understand the term 'URL'...
Can any1 explain, the meaning of 'url' and wat should be done to connect to a SQL server frm JAVA.

Thanks",sql,jdbc,connection,,,,open,0,119,9,"How to connect a SQL server to Java program. I ve installed SQL(last update). 
I need to code, that ll create & establish a connection with SQL DB
& manage the DB(using SELECT, INSERT, CREATE).


I did everything but, i am not able to create connection..(i ve also installed the MySQL/J connector, i jus extracted the .zip pack in a folder & added the folder path in Variables)

Can any1 tell me wat is mean by URL in the below line.... 

Connection connection = DriverManager.getConnection(url, username, password);

I ve tried this ""String url = ""jdbc:odbc:sqlserver://localhost:3306/myfirstdb""; ""
for ""Connection con = DriverManager.getConnection(url, ""root"", ""1234"");""

But its not working... I cant able to understand the term 'URL'...
Can any1 explain, the meaning of 'url' and wat should be done to connect to a SQL server frm JAVA.

Thanks",3
9133215,02/03/2012 17:57:55,1188125,02/03/2012 17:42:46,1,0,left join on MS SQL 2008 R2,"I try to left join two tables. table A contains unique 100 records with field_a_1, field_a_2, field_a_3 and  field_a_1+field_a_2 is unique. table B is multi-million reocrds with multiple fields. field_b_1 is same as field_a_1 and field_b_2 is same as field_a_2. I join two tables together by

select a.*, b.* from a left join b on field_a_1 = field_b_1 and field_a_2 = field_b_2. instead of getting 100 records, I get multi-million records. Do someone know why?
",sql,sql-server,sql-server-2008,left-join,,,open,0,75,7,"left join on MS SQL 2008 R2 I try to left join two tables. table A contains unique 100 records with field_a_1, field_a_2, field_a_3 and  field_a_1+field_a_2 is unique. table B is multi-million reocrds with multiple fields. field_b_1 is same as field_a_1 and field_b_2 is same as field_a_2. I join two tables together by

select a.*, b.* from a left join b on field_a_1 = field_b_1 and field_a_2 = field_b_2. instead of getting 100 records, I get multi-million records. Do someone know why?
",4
6083025,05/21/2011 16:34:44,747393,05/10/2011 18:35:58,155,2,I need help to optimize functions and stored procedure?,"I'm using two functions and stored procedure below to calculate the distance between zipcodes and return items:

For example to get 528 rows 600k rows table takes 10 sec. I have clustered index in on identity column and nonclustered on firstname, lastname, age and year.

I'm not a DBA so I need help from professional who can suggest the way how to optimize it and make it work faster. Or maybe be to show me different more efficient example.

    ALTER FUNCTION [dbo].[RadiusFunc]
    
    (
    	@ZipCode nvarchar(5),
    	@Miles decimal(18, 9)
    )
    
    RETURNS
    	@MaxLongLats TABLE
    	(
    		Latitude decimal(10,8),
    		Longitude decimal(11,8),
    		MaxLatitude decimal(10,8),
    		MinLatitude decimal(10,8),
    		MaxLongitude decimal(11,8),
    		MinLongitude decimal(11,8)
    	)
    AS
    
    BEGIN
    	--Declare variables
    	DECLARE @Latitude decimal(10,8), @Longitude decimal(11,8)
    	DECLARE @MaxLatitude decimal(10, 8), @MinLatitude decimal(10, 8)
    	DECLARE @MaxLongitude decimal(11, 8), @MinLongitude decimal(11, 8)
    
    	--Get the Lat/Long of the zipcode
    	SELECT @Latitude = Latitude, @Longitude = Longitude
    	FROM dbo.ZipCodes
    	WHERE ZipCode = @ZipCode
    
    	--Zipcode not found?
    	IF @@ROWCOUNT = 0
    		RETURN 
    
    	--Determine the maxes (69.17 is the # of miles/degree)
    	SET @MaxLatitude = @Latitude + @Miles / 69.17
    	SET @MinLatitude = @Latitude - (@MaxLatitude - @Latitude)
    	SET @MaxLongitude = @Longitude + @Miles / (COS(@MinLatitude * PI() / 180) * 69.17)
    	SET @MinLongitude = @Longitude - (@MaxLongitude - @Longitude)
    
    	--Insert data into return table
    	INSERT INTO @MaxLongLats
    		(Latitude, Longitude, MaxLatitude, MinLatitude, MaxLongitude, MinLongitude)
    	SELECT @Latitude, @Longitude, @MaxLatitude, @MinLatitude, @MaxLongitude, @MinLongitude
    	RETURN
    END 

**Function 2**

    ALTER FUNCTION [dbo].[DistanceFunc]
    (
    	@Latitude1 decimal(11,6),
    	@Longitude1 decimal(11,6),
    	@Latitude2 decimal(11,6),
    	@Longitude2 decimal(11,6)
    )
    
    RETURNS decimal(11, 6)	--returns distance in miles
    
    AS
    
    BEGIN
    	--If the 2 locations are the same, return 0 miles
    	IF @Latitude1 = @Latitude2 AND @Longitude1 = @Longitude2
    		RETURN 0
    
    	--Convert the points from degrees to radians
    	SET @Latitude1 = @Latitude1 * PI() / 180
    	SET @Longitude1 = @Longitude1 * PI() / 180
    	SET @Latitude2 = @Latitude2 * PI() / 180
    	SET @Longitude2 = @Longitude2* PI() / 180
    
    	--Temp var
    	DECLARE @Distance decimal(18,13)
    	SET @Distance = 0.0
    
    	--Compute the distance
    	SET @Distance = SIN(@Latitude1) * SIN(@Latitude2) + COS(@Latitude1) *
    			COS(@Latitude2) * COS(@Longitude2 - @Longitude1)
    
    	--Are the latitude and longitude points the same? Return 0

	IF @distance = 1	
		RETURN 0

	--Convert to miles (3963 = earth's radius)
	RETURN 3963 * (-1 * ATAN(@Distance / SQRT(1 - @Distance * @Distance)) + PI() / 2)
END


Stored Procedure


    SELECT ZIP.ZipCode, ZIP.City, 
    	dbo.DistanceFunc(ZIP.Latitude, ZIP.Longitude, RAD.Latitude, RAD.Longitude) As Distance
    	INTO #TempZips
    FROM ZipCodes ZIP, RadiusFunc(@ZipCode, @Miles) RAD
    WHERE (ZIP.Latitude BETWEEN RAD.MinLatitude AND RAD.MaxLatitude) AND
    	(ZIP.Longitude BETWEEN RAD.MinLongitude AND RAD.MaxLongitude) AND
    	(dbo.DistanceFunc(ZIP.Latitude,ZIP.Longitude,RAD.Latitude,RAD.Longitude) <= @Miles)
    
    SELECT H.*, Zips.Distance AS Miles
    FROM Listings H 
    INNER JOIN 	#TempZips Zips ON Zips.ZipCode = H.Zipcode
    WHERE FirstName = @FName AND LastName = @LName AND
    Age BETWEEN @AgetFrom AND @AgeTo AND 
    Year BETWEEN @YearFrom AND @YearTo AND 
    IsActive = 1
    ORDER BY Zips.Distance, H.Price
    
    DROP TABLE #TempZips


",sql,sql-server,tsql,sql-server-2008,server,05/21/2011 16:46:27,not a real question,1,756,9,"I need help to optimize functions and stored procedure? I'm using two functions and stored procedure below to calculate the distance between zipcodes and return items:

For example to get 528 rows 600k rows table takes 10 sec. I have clustered index in on identity column and nonclustered on firstname, lastname, age and year.

I'm not a DBA so I need help from professional who can suggest the way how to optimize it and make it work faster. Or maybe be to show me different more efficient example.

    ALTER FUNCTION [dbo].[RadiusFunc]
    
    (
    	@ZipCode nvarchar(5),
    	@Miles decimal(18, 9)
    )
    
    RETURNS
    	@MaxLongLats TABLE
    	(
    		Latitude decimal(10,8),
    		Longitude decimal(11,8),
    		MaxLatitude decimal(10,8),
    		MinLatitude decimal(10,8),
    		MaxLongitude decimal(11,8),
    		MinLongitude decimal(11,8)
    	)
    AS
    
    BEGIN
    	--Declare variables
    	DECLARE @Latitude decimal(10,8), @Longitude decimal(11,8)
    	DECLARE @MaxLatitude decimal(10, 8), @MinLatitude decimal(10, 8)
    	DECLARE @MaxLongitude decimal(11, 8), @MinLongitude decimal(11, 8)
    
    	--Get the Lat/Long of the zipcode
    	SELECT @Latitude = Latitude, @Longitude = Longitude
    	FROM dbo.ZipCodes
    	WHERE ZipCode = @ZipCode
    
    	--Zipcode not found?
    	IF @@ROWCOUNT = 0
    		RETURN 
    
    	--Determine the maxes (69.17 is the # of miles/degree)
    	SET @MaxLatitude = @Latitude + @Miles / 69.17
    	SET @MinLatitude = @Latitude - (@MaxLatitude - @Latitude)
    	SET @MaxLongitude = @Longitude + @Miles / (COS(@MinLatitude * PI() / 180) * 69.17)
    	SET @MinLongitude = @Longitude - (@MaxLongitude - @Longitude)
    
    	--Insert data into return table
    	INSERT INTO @MaxLongLats
    		(Latitude, Longitude, MaxLatitude, MinLatitude, MaxLongitude, MinLongitude)
    	SELECT @Latitude, @Longitude, @MaxLatitude, @MinLatitude, @MaxLongitude, @MinLongitude
    	RETURN
    END 

**Function 2**

    ALTER FUNCTION [dbo].[DistanceFunc]
    (
    	@Latitude1 decimal(11,6),
    	@Longitude1 decimal(11,6),
    	@Latitude2 decimal(11,6),
    	@Longitude2 decimal(11,6)
    )
    
    RETURNS decimal(11, 6)	--returns distance in miles
    
    AS
    
    BEGIN
    	--If the 2 locations are the same, return 0 miles
    	IF @Latitude1 = @Latitude2 AND @Longitude1 = @Longitude2
    		RETURN 0
    
    	--Convert the points from degrees to radians
    	SET @Latitude1 = @Latitude1 * PI() / 180
    	SET @Longitude1 = @Longitude1 * PI() / 180
    	SET @Latitude2 = @Latitude2 * PI() / 180
    	SET @Longitude2 = @Longitude2* PI() / 180
    
    	--Temp var
    	DECLARE @Distance decimal(18,13)
    	SET @Distance = 0.0
    
    	--Compute the distance
    	SET @Distance = SIN(@Latitude1) * SIN(@Latitude2) + COS(@Latitude1) *
    			COS(@Latitude2) * COS(@Longitude2 - @Longitude1)
    
    	--Are the latitude and longitude points the same? Return 0

	IF @distance = 1	
		RETURN 0

	--Convert to miles (3963 = earth's radius)
	RETURN 3963 * (-1 * ATAN(@Distance / SQRT(1 - @Distance * @Distance)) + PI() / 2)
END


Stored Procedure


    SELECT ZIP.ZipCode, ZIP.City, 
    	dbo.DistanceFunc(ZIP.Latitude, ZIP.Longitude, RAD.Latitude, RAD.Longitude) As Distance
    	INTO #TempZips
    FROM ZipCodes ZIP, RadiusFunc(@ZipCode, @Miles) RAD
    WHERE (ZIP.Latitude BETWEEN RAD.MinLatitude AND RAD.MaxLatitude) AND
    	(ZIP.Longitude BETWEEN RAD.MinLongitude AND RAD.MaxLongitude) AND
    	(dbo.DistanceFunc(ZIP.Latitude,ZIP.Longitude,RAD.Latitude,RAD.Longitude) <= @Miles)
    
    SELECT H.*, Zips.Distance AS Miles
    FROM Listings H 
    INNER JOIN 	#TempZips Zips ON Zips.ZipCode = H.Zipcode
    WHERE FirstName = @FName AND LastName = @LName AND
    Age BETWEEN @AgetFrom AND @AgeTo AND 
    Year BETWEEN @YearFrom AND @YearTo AND 
    IsActive = 1
    ORDER BY Zips.Distance, H.Price
    
    DROP TABLE #TempZips


",5
10570027,05/13/2012 07:30:53,474679,10/13/2010 15:31:57,813,23,Sql pattern for [1-999],I want one Sql pattern expression for match all numbers between **1** and **999**.,sql,pattern-matching,,,,05/13/2012 18:34:07,too localized,1,14,4,Sql pattern for [1-999] I want one Sql pattern expression for match all numbers between **1** and **999**.,2
528590,02/09/2009 15:24:16,20951,09/23/2008 07:48:08,128,2,Dynamic Query in MS SQL,"I have a table with 10 columns as col_1,col_2,.... col_10. I want to write a select statement that will select a value of one of the row and from one of these 10 columns. I have a variable that will decide which column to select from. Can such query be written where the column name is dynamically decided from a variable.",sql,mssql,sql-server-2005,,,,open,0,61,5,"Dynamic Query in MS SQL I have a table with 10 columns as col_1,col_2,.... col_10. I want to write a select statement that will select a value of one of the row and from one of these 10 columns. I have a variable that will decide which column to select from. Can such query be written where the column name is dynamically decided from a variable.",3
7214423,08/27/2011 12:06:47,915441,08/27/2011 12:06:47,1,0,SQL Avoid summing rows multiple times based on LIKE expression,"I have a table with bank transactions with columns id, tDate, description, cashOut, cashIn. I want to see how I spend my money, specifically at Amazon and a shop called Mazo, so I want a result like this:

    Month   Amazon   Mazo   Total
    1	    100      200    300

I attempted this:

    SELECT
        MONTH(tDate) AS Month,
        SUM(IF(description LIKE '%amazon%',cashOut,0)) AS Amazon,
        SUM(IF(description LIKE '%mazo%',cashOut,0)) AS Mazo,
        SUM(cashOut) AS Total
    FROM `transactions` 
    GROUP BY Month

However, I got the following:

    Month   Amazon   Mazo   Total
    1	    100      300    300

The problem with this SQL query is that the sum of ""mazo""-transactions is wrong, because it also adds up the ""amazon"" transactions.

I want the selection of the transactions to sum to be mutually exclusive or something like that, so that each transaction is part of only one of the SUMs above (without resorting to PHP or similar). (My tables contain much more data than this, and I have lots of search criteria, so it doesn't suffice to use '% mazo %' as search word. I need a general solution to the problem.)

Does anybody have a suggestion?

*Details of the table and its data:*

    CREATE TABLE `transactions` (
    `id` bigint(20) NOT NULL AUTO_INCREMENT,
    `tDate` date NOT NULL,
    `description` varchar(200) NOT NULL,
    `cashOut` decimal(10,0) NOT NULL,
    `cashIn` decimal(10,0) NOT NULL,
    PRIMARY KEY (`id`)
    ) ENGINE=InnoDB 

    INSERT INTO `transactions` (`id`, `tDate`, `description`, `cashOut`, `cashIn`) VALUES
    (1, '2010-01-05', 'amazon', '100', '0'),
    (4, '2010-01-15', 'mazo', '200', '0');
",sql,aggregate,mutual-exclusion,,,,open,0,350,10,"SQL Avoid summing rows multiple times based on LIKE expression I have a table with bank transactions with columns id, tDate, description, cashOut, cashIn. I want to see how I spend my money, specifically at Amazon and a shop called Mazo, so I want a result like this:

    Month   Amazon   Mazo   Total
    1	    100      200    300

I attempted this:

    SELECT
        MONTH(tDate) AS Month,
        SUM(IF(description LIKE '%amazon%',cashOut,0)) AS Amazon,
        SUM(IF(description LIKE '%mazo%',cashOut,0)) AS Mazo,
        SUM(cashOut) AS Total
    FROM `transactions` 
    GROUP BY Month

However, I got the following:

    Month   Amazon   Mazo   Total
    1	    100      300    300

The problem with this SQL query is that the sum of ""mazo""-transactions is wrong, because it also adds up the ""amazon"" transactions.

I want the selection of the transactions to sum to be mutually exclusive or something like that, so that each transaction is part of only one of the SUMs above (without resorting to PHP or similar). (My tables contain much more data than this, and I have lots of search criteria, so it doesn't suffice to use '% mazo %' as search word. I need a general solution to the problem.)

Does anybody have a suggestion?

*Details of the table and its data:*

    CREATE TABLE `transactions` (
    `id` bigint(20) NOT NULL AUTO_INCREMENT,
    `tDate` date NOT NULL,
    `description` varchar(200) NOT NULL,
    `cashOut` decimal(10,0) NOT NULL,
    `cashIn` decimal(10,0) NOT NULL,
    PRIMARY KEY (`id`)
    ) ENGINE=InnoDB 

    INSERT INTO `transactions` (`id`, `tDate`, `description`, `cashOut`, `cashIn`) VALUES
    (1, '2010-01-05', 'amazon', '100', '0'),
    (4, '2010-01-15', 'mazo', '200', '0');
",3
4588142,01/03/2011 20:37:02,225727,12/06/2009 10:38:17,2047,156,"more than one binding for one attribute in like sql conditions, trying to DRY it up","    ""height like '%1%' or height like or '%2%' or height '%1%'""

Say there are a done of bindings for just this one attribute. They are not in order, they are random. How can this sql be simplified?

Something like this:
   
    ""height like ('%2%' or '%1%' or '%5%')

Code is just and example. I'm not looking for injection suggestions.",sql,binding,find,like,conditions,,open,0,65,16,"more than one binding for one attribute in like sql conditions, trying to DRY it up     ""height like '%1%' or height like or '%2%' or height '%1%'""

Say there are a done of bindings for just this one attribute. They are not in order, they are random. How can this sql be simplified?

Something like this:
   
    ""height like ('%2%' or '%1%' or '%5%')

Code is just and example. I'm not looking for injection suggestions.",5
7194483,08/25/2011 17:15:35,186643,10/08/2009 18:58:37,577,17,Why can't my As400 select from a newly created member alias?,"I have set up the code as described in this [question][1].

Creating an alias works, as well as dropping it.

For members that I have created myself, this is working correctly, but for existing members I get the following error when selecting from the alias:

    SQL State: 42704
    Vendor Code: -204
    Message: [SQL0204] MyMemberName in MyLib type *FILE not found. Cause . . . . . :   MyMemberName in TPLWHS type *FILE was not found. If the member name is *ALL, the table is not partitioned. If this is an ALTER TABLE statement and the type is *N, a constraint or partition was not found. If this is not an ALTER TABLE statement and the type is *N, a function, procedure, trigger or sequence object was not found. If a function was not found, MyMemberName is the service program that contains the function.  The function will not be found unless the external name and usage name match exactly.  Examine the job log for a message that gives more details on which function name is being searched for and the name that did not match. Recovery  . . . :   Change the name and try the request again.  If the object is a node group, ensure that the DB2 Multisystem product is installed on your system and create a nodegroup with the CRTNODGRP CL command. If an external function was not found, be sure that the case of the EXTERNAL NAME on the CREATE FUNCTION statement exactly matches the case of the name exported by the service program.

Any help you can offer is much appreciated. Thanks!

  [1]: http://stackoverflow.com/questions/346512/sql-query-of-multi-member-file-on-as400",sql,database,db2,alias,ibm-midrange,,open,0,283,11,"Why can't my As400 select from a newly created member alias? I have set up the code as described in this [question][1].

Creating an alias works, as well as dropping it.

For members that I have created myself, this is working correctly, but for existing members I get the following error when selecting from the alias:

    SQL State: 42704
    Vendor Code: -204
    Message: [SQL0204] MyMemberName in MyLib type *FILE not found. Cause . . . . . :   MyMemberName in TPLWHS type *FILE was not found. If the member name is *ALL, the table is not partitioned. If this is an ALTER TABLE statement and the type is *N, a constraint or partition was not found. If this is not an ALTER TABLE statement and the type is *N, a function, procedure, trigger or sequence object was not found. If a function was not found, MyMemberName is the service program that contains the function.  The function will not be found unless the external name and usage name match exactly.  Examine the job log for a message that gives more details on which function name is being searched for and the name that did not match. Recovery  . . . :   Change the name and try the request again.  If the object is a node group, ensure that the DB2 Multisystem product is installed on your system and create a nodegroup with the CRTNODGRP CL command. If an external function was not found, be sure that the case of the EXTERNAL NAME on the CREATE FUNCTION statement exactly matches the case of the name exported by the service program.

Any help you can offer is much appreciated. Thanks!

  [1]: http://stackoverflow.com/questions/346512/sql-query-of-multi-member-file-on-as400",5
11584749,07/20/2012 18:10:23,343834,05/18/2010 09:09:53,275,8,How to create a new database with the hstore extension already installed?,"Recently [I went into trouble][1] trying to use hstore with Django. I installed hstore this way:

<!-- language: lang-sql -->

    $ sudo -u postgres psql
    postgres=# CREATE EXTENSION hstore;
    WARNING:  => is deprecated as an operator name
    DETAIL:  This name may be disallowed altogether in future versions of PostgreSQL.
    CREATE EXTENSION
    postgres=# \dx
                               List of installed extensions
      Name   | Version |   Schema   |                   Description                    
    ---------+---------+------------+--------------------------------------------------
     hstore  | 1.0     | public     | data type for storing sets of (key, value) pairs
     plpgsql | 1.0     | pg_catalog | PL/pgSQL procedural language
    (2 rows)
    
And naively thought that my new databases would include hstore. That ain't the case:

<!-- language: lang-sql -->

    $ createdb dbtest
    $ psql -d dbtest -c '\dx'
                     List of installed extensions
      Name   | Version |   Schema   |         Description          
    ---------+---------+------------+------------------------------
     plpgsql | 1.0     | pg_catalog | PL/pgSQL procedural language
    (1 row)

Is there a way to automatically have hstore in a newly created database ?

  [1]: http://stackoverflow.com/a/11581961/343834",sql,postgresql,postgresql-9.1,hstore,,,open,0,353,12,"How to create a new database with the hstore extension already installed? Recently [I went into trouble][1] trying to use hstore with Django. I installed hstore this way:

<!-- language: lang-sql -->

    $ sudo -u postgres psql
    postgres=# CREATE EXTENSION hstore;
    WARNING:  => is deprecated as an operator name
    DETAIL:  This name may be disallowed altogether in future versions of PostgreSQL.
    CREATE EXTENSION
    postgres=# \dx
                               List of installed extensions
      Name   | Version |   Schema   |                   Description                    
    ---------+---------+------------+--------------------------------------------------
     hstore  | 1.0     | public     | data type for storing sets of (key, value) pairs
     plpgsql | 1.0     | pg_catalog | PL/pgSQL procedural language
    (2 rows)
    
And naively thought that my new databases would include hstore. That ain't the case:

<!-- language: lang-sql -->

    $ createdb dbtest
    $ psql -d dbtest -c '\dx'
                     List of installed extensions
      Name   | Version |   Schema   |         Description          
    ---------+---------+------------+------------------------------
     plpgsql | 1.0     | pg_catalog | PL/pgSQL procedural language
    (1 row)

Is there a way to automatically have hstore in a newly created database ?

  [1]: http://stackoverflow.com/a/11581961/343834",4
11637803,07/24/2012 19:17:32,571856,01/11/2011 20:41:54,39,0,Is there a tool to enumerate all possible query statements for some database?,"Given a database's schema information, is there a tool can generate all possible SQL query statements. For example, for a db has only 2 tables Ta(cl1,cl2,cl3), Tb(cl4,cl5,cl6), cl3 refers to cl4, the possible select statements may include:

    select * from Ta;
    select * from Tb;
    select * from Ta, Tb;
    select * from Ta, Tb where Ta.cl3=tb.cl4;

...",sql,enumeration,statement,,,07/25/2012 03:01:20,not constructive,1,69,13,"Is there a tool to enumerate all possible query statements for some database? Given a database's schema information, is there a tool can generate all possible SQL query statements. For example, for a db has only 2 tables Ta(cl1,cl2,cl3), Tb(cl4,cl5,cl6), cl3 refers to cl4, the possible select statements may include:

    select * from Ta;
    select * from Tb;
    select * from Ta, Tb;
    select * from Ta, Tb where Ta.cl3=tb.cl4;

...",3
11452580,07/12/2012 13:10:38,1520858,07/12/2012 13:07:21,1,0,SQL select query into delete statement,"I have the following query:

    select acc.Username from accounts acc
    left join accountevents ace on acc.accountid=ace.accountid
    left join leads lds on lds.leadid=acc.leadid
    where lds.DateEntered>'2011-01-01' and lds.DateEntered<'2011-02-01'
    Group by acc.Username
    Having count(ace.accounteventid)=0

I wanted to make it a delete statement:

    delete username from accounts 
    left join accountevents ace on accounts.accountid=ace.accountid 
    left join leads lds on lds.leadid=accounts.leadid
    where Leads.DateEntered>'2011-01-01' and lds.DateEntered<'2011-02-01' 
    Having count(accountevents.accounteventid)=0

And i get the following error:
Incorrect syntax near the keyword 'Having'.

Any suggestions?",sql,,,,,07/13/2012 15:15:52,too localized,1,107,6,"SQL select query into delete statement I have the following query:

    select acc.Username from accounts acc
    left join accountevents ace on acc.accountid=ace.accountid
    left join leads lds on lds.leadid=acc.leadid
    where lds.DateEntered>'2011-01-01' and lds.DateEntered<'2011-02-01'
    Group by acc.Username
    Having count(ace.accounteventid)=0

I wanted to make it a delete statement:

    delete username from accounts 
    left join accountevents ace on accounts.accountid=ace.accountid 
    left join leads lds on lds.leadid=accounts.leadid
    where Leads.DateEntered>'2011-01-01' and lds.DateEntered<'2011-02-01' 
    Having count(accountevents.accounteventid)=0

And i get the following error:
Incorrect syntax near the keyword 'Having'.

Any suggestions?",1
2691408,04/22/2010 13:56:31,137939,07/14/2009 08:49:47,209,8,SQL Query Count on Column Information,"Using MySQL 5 with table ""abrechnung""


    id   datum	   title   betrag  wal jon  al  ben
    7	2010-02-08	Essen	1362	 0	 0	 1	 0
    8	2010-02-15	Essen	324      0	 0	 1   2
    9	2010-02-15	Essen	5732     0   0   1   2
    10  2010-02-15  Essen   3245     0   2   1   2 

What I want in the end is: Each rows ""betrag"" is divided through a number and then added to the final result. The number that is divided through is *4 - the amount of 2 in the current row*.

My current approach is as follows:

    SELECT SUM(betrag) AS ""W->A"" FROM abrechnung WHERE (wal = ""0"" and al = ""1"");

This basically selects the entrys that I want to have added to the final result. Result in this case: 10663.

Actually the final result shall be:

      1362 / 4 (no number 2 in that row for wal, jon, al or ben)
    +  324 / 3 (there is one 2 in that row for ben)
    + 5732 / 3 (same)
    + 3245 / 2 (there are 2 2's in that row)
    -----------
      3 981.66

I hope this is clear to understand.

Thank you.",sql,query,count,,,,open,0,254,6,"SQL Query Count on Column Information Using MySQL 5 with table ""abrechnung""


    id   datum	   title   betrag  wal jon  al  ben
    7	2010-02-08	Essen	1362	 0	 0	 1	 0
    8	2010-02-15	Essen	324      0	 0	 1   2
    9	2010-02-15	Essen	5732     0   0   1   2
    10  2010-02-15  Essen   3245     0   2   1   2 

What I want in the end is: Each rows ""betrag"" is divided through a number and then added to the final result. The number that is divided through is *4 - the amount of 2 in the current row*.

My current approach is as follows:

    SELECT SUM(betrag) AS ""W->A"" FROM abrechnung WHERE (wal = ""0"" and al = ""1"");

This basically selects the entrys that I want to have added to the final result. Result in this case: 10663.

Actually the final result shall be:

      1362 / 4 (no number 2 in that row for wal, jon, al or ben)
    +  324 / 3 (there is one 2 in that row for ben)
    + 5732 / 3 (same)
    + 3245 / 2 (there are 2 2's in that row)
    -----------
      3 981.66

I hope this is clear to understand.

Thank you.",3
8905612,01/18/2012 05:28:27,1044581,11/13/2011 20:42:38,45,0,How do I add or use the MAX Function to a Date field containing DateSerial function to query most recent date?,"I am using the DateSerial Function to convert the date on a column like this:

    (DateSerial(CInt(Left([EXAMPLE_TBL.APP_DATE],4)),CInt(Mid([EXAMPLE_TBL.APP_DATE],5,2)),
    CInt(Right([EXAMPLE_TBL.APP_DATE],2)))) AS Application_Date


The date comes from an Oracle linked table which is in a text datatype in Access. All is working, however, I need to add the MAX Function or find a way to get the most recent APP_DATE.

How do I add the MAX Function or what Function can I use so that if there are two APP_DATES, I get the most recent?

Thanks everyone!",sql,ms-access-2007,,,,,open,0,86,21,"How do I add or use the MAX Function to a Date field containing DateSerial function to query most recent date? I am using the DateSerial Function to convert the date on a column like this:

    (DateSerial(CInt(Left([EXAMPLE_TBL.APP_DATE],4)),CInt(Mid([EXAMPLE_TBL.APP_DATE],5,2)),
    CInt(Right([EXAMPLE_TBL.APP_DATE],2)))) AS Application_Date


The date comes from an Oracle linked table which is in a text datatype in Access. All is working, however, I need to add the MAX Function or find a way to get the most recent APP_DATE.

How do I add the MAX Function or what Function can I use so that if there are two APP_DATES, I get the most recent?

Thanks everyone!",2
4563810,12/30/2010 15:24:56,71406,02/26/2009 14:57:18,143,3,SQL Server Cursor To Include the Value in Select,"I have a SELECT statement returning a set of rows.

From each row, I need to get a value of one column and pass it to a Stored Procedure to get a value that I would need to supply for the set of rows itself.

For example:

    DECLARE @col1 int
    DECLARE @col2 int
    DECLARE @col3 varchar(20)
    
    DECLARE myCursor CURSOR FOR
    SELECT col1, col2, col3
    FROM table1
    WHERE....
    
    OPEN myCursor
    FETCH NEXT FROM myCursor
    INTO @col1, @col2
    
    WHILE @@FETH_STATUS = 0
    BEGIN
      SET @col3 = EXEC proc_GetCol3_Value @col1, @col2
    
      FETCH NEXT FROM myCursor
      INTO @col1, @col2
    END
    
    CLOSE myCursor
    DEALLOCATE myCursor

Now, based from that, I want to return the rows as retrieved by the original cursor, plus the value retrieved from the Stored procedure executed to be column 3's value.  

Say, the rows returned by the SQL cursor is:

    col1  col2  col3
      1   5000
      2   5000
      3   2500
      4   2000

And what I need is that all columns have been supplied after running the cursor and the Stored Proc and the result set should be:

    col1  col2  col3
      1   5000  APPROVED
      2   5000  REJECTED
      3   2500  CANCELLED
      4   2000  APPROVED

Any ideas welcome. Thanks.

P.S. I know that a lot would advice to simply using a JOIN statement but since the stored procedure to be executed is quite complex, making a join with the cursor SQL statement would be too complicated.


",sql,cursors,,,,,open,0,376,9,"SQL Server Cursor To Include the Value in Select I have a SELECT statement returning a set of rows.

From each row, I need to get a value of one column and pass it to a Stored Procedure to get a value that I would need to supply for the set of rows itself.

For example:

    DECLARE @col1 int
    DECLARE @col2 int
    DECLARE @col3 varchar(20)
    
    DECLARE myCursor CURSOR FOR
    SELECT col1, col2, col3
    FROM table1
    WHERE....
    
    OPEN myCursor
    FETCH NEXT FROM myCursor
    INTO @col1, @col2
    
    WHILE @@FETH_STATUS = 0
    BEGIN
      SET @col3 = EXEC proc_GetCol3_Value @col1, @col2
    
      FETCH NEXT FROM myCursor
      INTO @col1, @col2
    END
    
    CLOSE myCursor
    DEALLOCATE myCursor

Now, based from that, I want to return the rows as retrieved by the original cursor, plus the value retrieved from the Stored procedure executed to be column 3's value.  

Say, the rows returned by the SQL cursor is:

    col1  col2  col3
      1   5000
      2   5000
      3   2500
      4   2000

And what I need is that all columns have been supplied after running the cursor and the Stored Proc and the result set should be:

    col1  col2  col3
      1   5000  APPROVED
      2   5000  REJECTED
      3   2500  CANCELLED
      4   2000  APPROVED

Any ideas welcome. Thanks.

P.S. I know that a lot would advice to simply using a JOIN statement but since the stored procedure to be executed is quite complex, making a join with the cursor SQL statement would be too complicated.


",2
2681408,04/21/2010 08:43:43,291357,03/11/2010 09:51:36,6,0,How would I order a table by the number of matching params in the where clause of an sql statement? ,"I'm writing sql to search a database by a number of parameters. How would I go about ordering the result set by the items that match the most parameters in the where clause. For example:

SELECT * FROM users WHERE username = 'eitan' OR email = 'eitan@eitan.com' OR company = 'eitan'


Username  |  email         |   company

1) eitan        |     blah@blah.com     |     blah
  
2) eitan      |     eitan@eitan.com   |    eitan

3) eitan   |    eitan@eitan.com   |     blah


should be ordered like:

2, 3, 1.

Thanks. (ps the query isn't that easy, has a lot of joins and a lot of OR's in the WHERE)

Eitan

",sql,order,parameters,matching,,,open,0,151,21,"How would I order a table by the number of matching params in the where clause of an sql statement?  I'm writing sql to search a database by a number of parameters. How would I go about ordering the result set by the items that match the most parameters in the where clause. For example:

SELECT * FROM users WHERE username = 'eitan' OR email = 'eitan@eitan.com' OR company = 'eitan'


Username  |  email         |   company

1) eitan        |     blah@blah.com     |     blah
  
2) eitan      |     eitan@eitan.com   |    eitan

3) eitan   |    eitan@eitan.com   |     blah


should be ordered like:

2, 3, 1.

Thanks. (ps the query isn't that easy, has a lot of joins and a lot of OR's in the WHERE)

Eitan

",4
4240366,11/21/2010 21:08:37,407502,06/25/2010 16:20:39,223,19,Where can I geek out on SQL?,"I've been wondering if there is a SQL Cafe somewhere, where I can geek out on SQL with others.  Stackoverflow is a good medium for answers, and sometimes can fulfill this purpose, but there's not a lot of scope for ""what if I do this, then?"" kind of interactions.

Thank you if you know of this heavenly place!",sql,oracle,,,,11/21/2010 22:21:23,off topic,1,58,7,"Where can I geek out on SQL? I've been wondering if there is a SQL Cafe somewhere, where I can geek out on SQL with others.  Stackoverflow is a good medium for answers, and sometimes can fulfill this purpose, but there's not a lot of scope for ""what if I do this, then?"" kind of interactions.

Thank you if you know of this heavenly place!",2
7800342,10/17/2011 22:27:33,1000054,10/17/2011 22:07:41,1,0,WHERE clause fails with certain string literals,"I have a database table that stores error messages, and I want to run various queries on them. First, I get an overall count by grouping them like this:

    select MessageText, COUNT(*) from MessageLog group by MessageText

And the result is:

    1  Input string was not in a correct format      4
    2  Value cannot be null. Parameter name: Int     8 
    3  Value cannot be null. Parameter name: String  1

Now, if I try to select messages by the text string, some of them return no results even though the messages exist. For example,

    select * from MessageLog where MessageText = 'Value cannot be null. Parameter name: Int'

does not return any results, even though the previous query shows there are 8 of them. What is it about this string that fails to match?
",sql,where-clause,,,,,open,0,159,7,"WHERE clause fails with certain string literals I have a database table that stores error messages, and I want to run various queries on them. First, I get an overall count by grouping them like this:

    select MessageText, COUNT(*) from MessageLog group by MessageText

And the result is:

    1  Input string was not in a correct format      4
    2  Value cannot be null. Parameter name: Int     8 
    3  Value cannot be null. Parameter name: String  1

Now, if I try to select messages by the text string, some of them return no results even though the messages exist. For example,

    select * from MessageLog where MessageText = 'Value cannot be null. Parameter name: Int'

does not return any results, even though the previous query shows there are 8 of them. What is it about this string that fails to match?
",2
6967699,08/06/2011 15:10:28,548807,12/20/2010 15:20:34,119,2,Suggest TEST case Window for a code to any guest visitor,"Is there any website,which allows any guest user to share their TEST CASE for a particular code.
Actually,I write SQL and PLSQL code,and test on myself,but I need some way to share Some kind of Link ,where I publish My CODE and Demand Test cases suggestion from any user,who deosn't require to register on the Site,where I placed CODE.
So,that I can share that CODE link on any social site with like minded friends.

Hence,I require kind of crowd sourcing like TEST case suggestions for my code.",sql,testing,social-networking,crowdsourcing,,08/09/2011 07:34:18,off topic,1,84,11,"Suggest TEST case Window for a code to any guest visitor Is there any website,which allows any guest user to share their TEST CASE for a particular code.
Actually,I write SQL and PLSQL code,and test on myself,but I need some way to share Some kind of Link ,where I publish My CODE and Demand Test cases suggestion from any user,who deosn't require to register on the Site,where I placed CODE.
So,that I can share that CODE link on any social site with like minded friends.

Hence,I require kind of crowd sourcing like TEST case suggestions for my code.",4
4131754,11/09/2010 08:36:27,427824,08/22/2010 19:38:41,48,2,Key-Store Database / Doubles Conditions,"I'm trying to retrieve all the users ids who have their preferences (IN (1,7) AND (2)). Even without the group on user_id. It doesn't work. Any idea would be very helpful.

    HasPreference.find(:all, :conditions  => [""preference_id IN (1,7) AND preference_id = 2""], :group  => :user_id)

TABLE is 'has_preferences'

ID -- PREFERENCE_ID -- USER_ID
 
1  --       2       --    1

1  --       7       --    1

1  --       1       --    1

1  --       2       --    2

I'd like to get [1] as a result.

Thanks",sql,ruby-on-rails,,,,,open,0,143,5,"Key-Store Database / Doubles Conditions I'm trying to retrieve all the users ids who have their preferences (IN (1,7) AND (2)). Even without the group on user_id. It doesn't work. Any idea would be very helpful.

    HasPreference.find(:all, :conditions  => [""preference_id IN (1,7) AND preference_id = 2""], :group  => :user_id)

TABLE is 'has_preferences'

ID -- PREFERENCE_ID -- USER_ID
 
1  --       2       --    1

1  --       7       --    1

1  --       1       --    1

1  --       2       --    2

I'd like to get [1] as a result.

Thanks",2
6451884,06/23/2011 09:22:38,806250,06/20/2011 08:01:19,6,1,How can i find the number of times string1 present in string2,"str2 ='welcome to sql server. Sql server is a product of Microsoft sql' 
str1 = 'sql'

How can i find the number of times str1 present in str2. Please help me finding it.
",sql,sql-server-2008,,,,,open,0,32,12,"How can i find the number of times string1 present in string2 str2 ='welcome to sql server. Sql server is a product of Microsoft sql' 
str1 = 'sql'

How can i find the number of times str1 present in str2. Please help me finding it.
",2
11276515,06/30/2012 18:18:54,1004685,10/20/2011 07:40:11,33,10,sql 2008 collation conflict,"i am facing this error on my proc
Cannot resolve the collation conflict between ""Latin1_General_CI_AI"" and ""SQL_Latin1_General_CP1_CI_AS"" in the equal to operation. Severity 16 State 9 
every table on this procedure is having the same collation,
why is this happening ,can any one help
",sql,sql-server-2008,collation,,,07/02/2012 09:23:34,not a real question,1,42,4,"sql 2008 collation conflict i am facing this error on my proc
Cannot resolve the collation conflict between ""Latin1_General_CI_AI"" and ""SQL_Latin1_General_CP1_CI_AS"" in the equal to operation. Severity 16 State 9 
every table on this procedure is having the same collation,
why is this happening ,can any one help
",3
8745030,01/05/2012 15:27:42,1132474,01/05/2012 15:19:02,1,0,MS SQL SELECT or INSERT INTO query,"I'm working with MS SQL 2003.  I need to take the results from One column (VALIMIT) and insert them into another column (VALIMIT2012) in the same table (lending_limits).  My Question is do I need to do a SELECT query first, or do I just start with an INSERT INTO query and what the proper syntax would be fot the INSERT INTO query.",sql,ms,,,,,open,0,64,7,"MS SQL SELECT or INSERT INTO query I'm working with MS SQL 2003.  I need to take the results from One column (VALIMIT) and insert them into another column (VALIMIT2012) in the same table (lending_limits).  My Question is do I need to do a SELECT query first, or do I just start with an INSERT INTO query and what the proper syntax would be fot the INSERT INTO query.",2
7720041,10/11/2011 00:05:26,733876,05/02/2011 03:05:38,10,1,How do I do this rediculous SQL multiple join statement?,"I cannot get this to work for the life of me.  All works fine without the new 2 join inclusions and column selections.

    SELECT article.articleId,article.articleName, article.articleStoryTypeId, artIndustry.industryName, user2.userPrefix, user2.userMiddleName, article.articleStatus, article.articleCreateDate, article.articleModifyDate,
    FROM industry
    LEFT JOIN users ON industry.industryId = users.userIndustryId
    LEFT JOIN clickTrack ON users.userId = clickTrack.clickUserId
    LEFT JOIN article ON clickTrack.clickDocumentId = article.articleId
    LEFT JOIN users users2 ON user2.userId = article.articleAuthorId
    LEFT JOIN industry artIndustry ON artIndustry.industryId = article.articleIndustryId
    WHERE ((clickTrack.clickDocumentTable = 'breaking') OR (clickTrack.clickDocumentTable = 'article')) AND article.articleCreateDate > '1/1/2008 0:00:00 AM' AND industry.industryId = 1
    GROUP BY article.articleId,article.articleName, article.articleStatus, article.articleCreateDate, article.articleModifyDate
    Order By article.articleId",sql,join,left-join,multiple-tables,,11/08/2011 08:09:53,too localized,1,129,10,"How do I do this rediculous SQL multiple join statement? I cannot get this to work for the life of me.  All works fine without the new 2 join inclusions and column selections.

    SELECT article.articleId,article.articleName, article.articleStoryTypeId, artIndustry.industryName, user2.userPrefix, user2.userMiddleName, article.articleStatus, article.articleCreateDate, article.articleModifyDate,
    FROM industry
    LEFT JOIN users ON industry.industryId = users.userIndustryId
    LEFT JOIN clickTrack ON users.userId = clickTrack.clickUserId
    LEFT JOIN article ON clickTrack.clickDocumentId = article.articleId
    LEFT JOIN users users2 ON user2.userId = article.articleAuthorId
    LEFT JOIN industry artIndustry ON artIndustry.industryId = article.articleIndustryId
    WHERE ((clickTrack.clickDocumentTable = 'breaking') OR (clickTrack.clickDocumentTable = 'article')) AND article.articleCreateDate > '1/1/2008 0:00:00 AM' AND industry.industryId = 1
    GROUP BY article.articleId,article.articleName, article.articleStatus, article.articleCreateDate, article.articleModifyDate
    Order By article.articleId",4
3120288,06/25/2010 18:01:51,311,08/04/2008 14:57:09,1146,54,Are input sanitization and parameterized queries mutually exclusive?,"I'm working updating some legacy code that does not properly handle user input. The code does do a minimal amount of sanitization, but does not cover all known threats.

Our newer code uses parameterized queries. As I understand it, the queries are precompiled, and the input is treated simply as data which cannot be executed. In that case, sanitization is not necessary. Is that right?

To put it another way, if I parameterize the queries in this legacy code, is it OK to eliminate the sanitization that it currently does? Or am I missing some additional benefit of sanitization on top of parameterization?
",sql,database,language-agnostic,sanitization,parameterized,,open,0,101,8,"Are input sanitization and parameterized queries mutually exclusive? I'm working updating some legacy code that does not properly handle user input. The code does do a minimal amount of sanitization, but does not cover all known threats.

Our newer code uses parameterized queries. As I understand it, the queries are precompiled, and the input is treated simply as data which cannot be executed. In that case, sanitization is not necessary. Is that right?

To put it another way, if I parameterize the queries in this legacy code, is it OK to eliminate the sanitization that it currently does? Or am I missing some additional benefit of sanitization on top of parameterization?
",5
6681541,07/13/2011 15:37:04,185749,10/07/2009 16:10:41,472,35,How to select MAX in a sub query in Linq to Sql,"Given the following data, how does one select only the latest version for each item using LINQ?

    ItemId, Version
    ===================
    A, 1
    A, 2
    A, 3
    B, 8
    B, 9,
    C, 10
    C, 11

The desired results are:

    A, 3
    B, 9
    C, 11

In TSQL, I would do something like so:

    SELECT * FROM MyTable AS Tbl1

    WHERE Tbl1.Version = 

	(SELECT MAX(Version) 
	FROM MyTable 
	WHERE MyTable.ItemId = Tbl1.ItemId)",sql,linq,linq-to-sql,,,,open,0,109,12,"How to select MAX in a sub query in Linq to Sql Given the following data, how does one select only the latest version for each item using LINQ?

    ItemId, Version
    ===================
    A, 1
    A, 2
    A, 3
    B, 8
    B, 9,
    C, 10
    C, 11

The desired results are:

    A, 3
    B, 9
    C, 11

In TSQL, I would do something like so:

    SELECT * FROM MyTable AS Tbl1

    WHERE Tbl1.Version = 

	(SELECT MAX(Version) 
	FROM MyTable 
	WHERE MyTable.ItemId = Tbl1.ItemId)",3
9253632,02/12/2012 23:15:35,1196080,02/08/2012 01:16:40,1,0,sqlplus oracle... time spent list in ascending.. i dont think my answer is right?,"Calculate the total number of days spent on resolving tickets for the month of
January 2012 for each tech personnel. List them in an ascending order.


TECH PERSONNEL (pplSoft, fname, lname, pittID, expertise, office phone) where fname is first name, and lname is last name.

USERS (pplSoft, fname, lname, pittID, office phone)

CATEGORIES (category id, category, description) where this table lists all possible categories of submitted tickets.

INVENTORY(machine name, IP, network port, MACADDR, location id)

LOCATIONS(location id, location, building, notes)

TICKETS (ticket number, owner pplSoft, date submitted, date closed, days worked on, category id, machine name, location, description)

ASSIGNMENT (ticket number, tech pplSoft, date assigned, status) where status held is an enumeration, could be: assigned, in progress, delegated, closed successful, or closed unsuccessful.



now putting this into sql.... heres my attempt 

select tech_personnel, count(days_worked_on) as daysWorked from tickets, tech_personnel where date_submitted >= '01-JAN-2012' and date_submitted <= '31-JAN-2012' Order by daysWorkedASC;
",sql,database,oracle,database-design,sqlplus,02/13/2012 20:34:28,too localized,1,141,14,"sqlplus oracle... time spent list in ascending.. i dont think my answer is right? Calculate the total number of days spent on resolving tickets for the month of
January 2012 for each tech personnel. List them in an ascending order.


TECH PERSONNEL (pplSoft, fname, lname, pittID, expertise, office phone) where fname is first name, and lname is last name.

USERS (pplSoft, fname, lname, pittID, office phone)

CATEGORIES (category id, category, description) where this table lists all possible categories of submitted tickets.

INVENTORY(machine name, IP, network port, MACADDR, location id)

LOCATIONS(location id, location, building, notes)

TICKETS (ticket number, owner pplSoft, date submitted, date closed, days worked on, category id, machine name, location, description)

ASSIGNMENT (ticket number, tech pplSoft, date assigned, status) where status held is an enumeration, could be: assigned, in progress, delegated, closed successful, or closed unsuccessful.



now putting this into sql.... heres my attempt 

select tech_personnel, count(days_worked_on) as daysWorked from tickets, tech_personnel where date_submitted >= '01-JAN-2012' and date_submitted <= '31-JAN-2012' Order by daysWorkedASC;
",5
643930,03/13/2009 18:14:21,77835,03/13/2009 18:06:13,1,0,"Using ""like"" in a cursor/query with a parameter in python (django)","I know this may be something stupid bad I decided to ask any way.

I've been trying to query something like:

     cursor.execute(""select col1, col2   \
                        from my_tablem \
                        where afield like '%%s%'
                        and secondfield = %s
                        order by 1 desc "" % (var1, var2) )

Bad I get an error in the like sentence. It doesn't like the extra % which I need to get all the results that contains the first %s value.

Ideas?

TIA! ",sql,python,django,cursor,like,,open,0,171,11,"Using ""like"" in a cursor/query with a parameter in python (django) I know this may be something stupid bad I decided to ask any way.

I've been trying to query something like:

     cursor.execute(""select col1, col2   \
                        from my_tablem \
                        where afield like '%%s%'
                        and secondfield = %s
                        order by 1 desc "" % (var1, var2) )

Bad I get an error in the like sentence. It doesn't like the extra % which I need to get all the results that contains the first %s value.

Ideas?

TIA! ",5
8619341,12/23/2011 18:16:31,1110713,12/21/2011 21:56:01,6,0,sql research issue,"I want do a reserach in the sql table using drop down menu. for exmple, the user can chose color and then it will show all the item with that color, here is my code.  i tried to use sql command with color red(rouge in french) it works; then I tried to use $couleur, it does not work.  can someone check my sql command please. thank you so much.
    
    <!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">
    <html xmlns=""http://www.w3.org/1999/xhtml"">
    <head>
    <meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8"" />
    <title>Untitled Document</title>
    </head>
    
    <body>
    <form name="""" method=""post"" action=""enquete.php"">
    <select name=""couleur"">
       <option ></option>
      <option value=""rouge"">rouge</option>
      <option value=""pink"">pink</option>
      
    
    
    </select>
    
      
    
    
    </select>
    <input type=""submit"" value=""submit"" name=""submit2"" /> <br/>
    </form>
    
    
    </body>
    </html>
    
    <?php 
       
      	 //traitement pour decoulant couleur
    	if (isset($_POST[""couleur""]) && $_POST[""couleur""]!=""0""&& isset($_POST[""submit""]) ){
    		//connexion avec le serveur
    		include_once(""mesparametres.inc.php"");
    		//récupération données formulaire
    		$couleur = $_POST[""couleur""];
    		$query = ""SELECT * FROM `poisson` WHERE `couleur` LIKE 'rouge'"";
    		$query = ""SELECT * FROM `poisson` WHERE `couleur` LIKE '\""$couleur\""'"";
    	   $result = mysql_query($query) or die('Query failed: ' . mysql_error());
    	
    	
    	    // Printing results in HTML
    	
    	    echo ""<table border='1' width='300'>\n"";
    	
    	     $count = 0;
    			while ($line = mysql_fetch_array($result, MYSQL_ASSOC)) {
    			   echo ""\t<tr>\n"";
    			   foreach ($line as $col_value) {
    				   echo ""\t\t<td>$col_value</td>\n"";
    			   }
    			   $count++;
    			   echo ""\t</tr>\n"";
    			}
    			
    			echo ""</table>\n"";
    		
    		
    		//fermeture connexion avec la BD
    		mysql_close($idConnectDB); 
    	}
    	
     ?>
     ",sql,research,,,,,open,0,482,3,"sql research issue I want do a reserach in the sql table using drop down menu. for exmple, the user can chose color and then it will show all the item with that color, here is my code.  i tried to use sql command with color red(rouge in french) it works; then I tried to use $couleur, it does not work.  can someone check my sql command please. thank you so much.
    
    <!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">
    <html xmlns=""http://www.w3.org/1999/xhtml"">
    <head>
    <meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8"" />
    <title>Untitled Document</title>
    </head>
    
    <body>
    <form name="""" method=""post"" action=""enquete.php"">
    <select name=""couleur"">
       <option ></option>
      <option value=""rouge"">rouge</option>
      <option value=""pink"">pink</option>
      
    
    
    </select>
    
      
    
    
    </select>
    <input type=""submit"" value=""submit"" name=""submit2"" /> <br/>
    </form>
    
    
    </body>
    </html>
    
    <?php 
       
      	 //traitement pour decoulant couleur
    	if (isset($_POST[""couleur""]) && $_POST[""couleur""]!=""0""&& isset($_POST[""submit""]) ){
    		//connexion avec le serveur
    		include_once(""mesparametres.inc.php"");
    		//récupération données formulaire
    		$couleur = $_POST[""couleur""];
    		$query = ""SELECT * FROM `poisson` WHERE `couleur` LIKE 'rouge'"";
    		$query = ""SELECT * FROM `poisson` WHERE `couleur` LIKE '\""$couleur\""'"";
    	   $result = mysql_query($query) or die('Query failed: ' . mysql_error());
    	
    	
    	    // Printing results in HTML
    	
    	    echo ""<table border='1' width='300'>\n"";
    	
    	     $count = 0;
    			while ($line = mysql_fetch_array($result, MYSQL_ASSOC)) {
    			   echo ""\t<tr>\n"";
    			   foreach ($line as $col_value) {
    				   echo ""\t\t<td>$col_value</td>\n"";
    			   }
    			   $count++;
    			   echo ""\t</tr>\n"";
    			}
    			
    			echo ""</table>\n"";
    		
    		
    		//fermeture connexion avec la BD
    		mysql_close($idConnectDB); 
    	}
    	
     ?>
     ",2
11518183,07/17/2012 07:51:56,516160,11/22/2010 13:39:23,793,1,Cannot connect to sql server,"It's my first time to install Microsoft SQL R2 but then there are errors occured. I've tried several time uninstalling and installing the SQL but same errors occur.

This is the print screen of the error message:
![enter image description here][1]


And this is the error message when I tried to connect to server:
![enter image description here][2]


  [1]: http://i.stack.imgur.com/9MpIl.png
  [2]: http://i.stack.imgur.com/dqsTO.png

What might be the possible reason why this errors occurs every time I install the SQL R2? Please help. Thanks.",sql,sql-server,sql-server-2008,sql-server-2008-r2,,07/18/2012 00:05:03,off topic,1,79,5,"Cannot connect to sql server It's my first time to install Microsoft SQL R2 but then there are errors occured. I've tried several time uninstalling and installing the SQL but same errors occur.

This is the print screen of the error message:
![enter image description here][1]


And this is the error message when I tried to connect to server:
![enter image description here][2]


  [1]: http://i.stack.imgur.com/9MpIl.png
  [2]: http://i.stack.imgur.com/dqsTO.png

What might be the possible reason why this errors occurs every time I install the SQL R2? Please help. Thanks.",4
11490402,07/15/2012 08:03:22,1180196,01/31/2012 11:29:54,74,3,Joomla site goes wild with sql,"I have an error on my website that has joomla 2.5 installed. All was alright, but now when I go to administrator it shows this message:

    Got error 28 from storage engine SQL=SELECT a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, CASE WHEN a.modified = 0 THEN a.created ELSE a.modified END as modified, a.modified_by, uam.name as modified_by_name,CASE WHEN a.publish_up = 0 THEN a.created ELSE a.publish_up END as publish_up,a.publish_down, a.images, a.urls, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, LENGTH(a.fulltext) AS readmore,CASE WHEN badcats.id is not null THEN 0 ELSE a.state END AS state,c.title AS category_title, c.path AS category_route, c.access AS category_access, c.alias AS category_alias,CASE WHEN a.created_by_alias > ' ' THEN a.created_by_alias ELSE ua.name END AS author,ua.email AS author_email,contact.id as contactid,parent.title as parent_title, parent.id as parent_id, parent.path as parent_route, parent.alias as parent_alias,ROUND(v.rating_sum / v.rating_count, 0) AS rating, v.rating_count as rating_count,c.published, CASE WHEN badcats.id is null THEN c.published ELSE 0 END AS parents_published FROM jos_content AS a LEFT JOIN jos_categories AS c ON c.id = a.catid LEFT JOIN jos_users AS ua ON ua.id = a.created_by LEFT JOIN jos_users AS uam ON uam.id = a.modified_by LEFT JOIN ( SELECT contact.user_id, MAX(contact.id) AS id, contact.language FROM jos_contact_details AS contact WHERE contact.published = 1 GROUP BY contact.user_id, contact.language) AS contact ON contact.user_id = a.created_by LEFT JOIN jos_categories as parent ON parent.id = c.parent_id LEFT JOIN jos_content_rating AS v ON a.id = v.content_id LEFT OUTER JOIN (SELECT cat.id as id FROM jos_categories AS cat JOIN jos_categories AS parent ON cat.lft BETWEEN parent.lft AND parent.rgt WHERE parent.extension = 'com_content' AND parent.published != 1 GROUP BY cat.id ) AS badcats ON badcats.id = c.id INNER JOIN jos_content_frontpage AS fp ON fp.content_id = a.id WHERE a.access IN (1,1) AND c.access IN (1,1) AND CASE WHEN badcats.id is null THEN a.state ELSE 0 END = 1 AND (a.publish_up = '0000-00-00 00:00:00' OR a.publish_up <= '2012-07-15 08:00:01') AND (a.publish_down = '0000-00-00 00:00:00' OR a.publish_down >= '2012-07-15 08:00:01') GROUP BY a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, a.created, a.modified, a.modified_by, uam.name, a.publish_up, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, a.fulltext, a.state, a.publish_down, badcats.id, c.title, c.path, c.access, c.alias, uam.id, ua.name, ua.email, contact.id, parent.title, parent.id, parent.path, parent.alias, v.rating_sum, v.rating_count, c.published, c.lft, a.ordering, parent.lft, fp.ordering, c.id, a.images, a.urls ORDER BY c.lft, fp.ordering, a.created DESC LIMIT 0, 8 Got error 28 from storage engine SQL=SELECT a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, CASE WHEN a.modified = 0 THEN a.created ELSE a.modified END as modified, a.modified_by, uam.name as modified_by_name,CASE WHEN a.publish_up = 0 THEN a.created ELSE a.publish_up END as publish_up,a.publish_down, a.images, a.urls, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, LENGTH(a.fulltext) AS readmore,CASE WHEN badcats.id is not null THEN 0 ELSE a.state END AS state,c.title AS category_title, c.path AS category_route, c.access AS category_access, c.alias AS category_alias,CASE WHEN a.created_by_alias > ' ' THEN a.created_by_alias ELSE ua.name END AS author,ua.email AS author_email,contact.id as contactid,parent.title as parent_title, parent.id as parent_id, parent.path as parent_route, parent.alias as parent_alias,ROUND(v.rating_sum / v.rating_count, 0) AS rating, v.rating_count as rating_count,c.published, CASE WHEN badcats.id is null THEN c.published ELSE 0 END AS parents_published FROM jos_content AS a LEFT JOIN jos_categories AS c ON c.id = a.catid LEFT JOIN jos_users AS ua ON ua.id = a.created_by LEFT JOIN jos_users AS uam ON uam.id = a.modified_by LEFT JOIN ( SELECT contact.user_id, MAX(contact.id) AS id, contact.language FROM jos_contact_details AS contact WHERE contact.published = 1 GROUP BY contact.user_id, contact.language) AS contact ON contact.user_id = a.created_by LEFT JOIN jos_categories as parent ON parent.id = c.parent_id LEFT JOIN jos_content_rating AS v ON a.id = v.content_id LEFT OUTER JOIN (SELECT cat.id as id FROM jos_categories AS cat JOIN jos_categories AS parent ON cat.lft BETWEEN parent.lft AND parent.rgt WHERE parent.extension = 'com_content' AND parent.published != 1 GROUP BY cat.id ) AS badcats ON badcats.id = c.id INNER JOIN jos_content_frontpage AS fp ON fp.content_id = a.id WHERE a.access IN (1,1) AND c.access IN (1,1) AND CASE WHEN badcats.id is null THEN a.state ELSE 0 END = 1 AND (a.publish_up = '0000-00-00 00:00:00' OR a.publish_up <= '2012-07-15 08:00:01') AND (a.publish_down = '0000-00-00 00:00:00' OR a.publish_down >= '2012-07-15 08:00:01') GROUP BY a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, a.created, a.modified, a.modified_by, uam.name, a.publish_up, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, a.fulltext, a.state, a.publish_down, badcats.id, c.title, c.path, c.access, c.alias, uam.id, ua.name, ua.email, contact.id, parent.title, parent.id, parent.path, parent.alias, v.rating_sum, v.rating_count, c.published, c.lft, a.ordering, parent.lft, fp.ordering, c.id, a.images, a.urls ORDER BY c.lft, fp.ordering, a.created DESC

And on the frontpage this error message:

    Warning: Invalid argument supplied for foreach() in /home/zasvadba/public_html/components/com_content/models/articles.php on line 486
    
    Warning: mysql_num_rows() expects parameter 1 to be resource, boolean given in /home/zasvadba/public_html/libraries/joomla/database/database/mysql.php on line 293

What can be the problem, or what can be the solution. I've didn't installed anything, I've didn't modified anything",sql,error-message,joomla2.5,,,07/16/2012 10:25:59,not a real question,1,794,6,"Joomla site goes wild with sql I have an error on my website that has joomla 2.5 installed. All was alright, but now when I go to administrator it shows this message:

    Got error 28 from storage engine SQL=SELECT a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, CASE WHEN a.modified = 0 THEN a.created ELSE a.modified END as modified, a.modified_by, uam.name as modified_by_name,CASE WHEN a.publish_up = 0 THEN a.created ELSE a.publish_up END as publish_up,a.publish_down, a.images, a.urls, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, LENGTH(a.fulltext) AS readmore,CASE WHEN badcats.id is not null THEN 0 ELSE a.state END AS state,c.title AS category_title, c.path AS category_route, c.access AS category_access, c.alias AS category_alias,CASE WHEN a.created_by_alias > ' ' THEN a.created_by_alias ELSE ua.name END AS author,ua.email AS author_email,contact.id as contactid,parent.title as parent_title, parent.id as parent_id, parent.path as parent_route, parent.alias as parent_alias,ROUND(v.rating_sum / v.rating_count, 0) AS rating, v.rating_count as rating_count,c.published, CASE WHEN badcats.id is null THEN c.published ELSE 0 END AS parents_published FROM jos_content AS a LEFT JOIN jos_categories AS c ON c.id = a.catid LEFT JOIN jos_users AS ua ON ua.id = a.created_by LEFT JOIN jos_users AS uam ON uam.id = a.modified_by LEFT JOIN ( SELECT contact.user_id, MAX(contact.id) AS id, contact.language FROM jos_contact_details AS contact WHERE contact.published = 1 GROUP BY contact.user_id, contact.language) AS contact ON contact.user_id = a.created_by LEFT JOIN jos_categories as parent ON parent.id = c.parent_id LEFT JOIN jos_content_rating AS v ON a.id = v.content_id LEFT OUTER JOIN (SELECT cat.id as id FROM jos_categories AS cat JOIN jos_categories AS parent ON cat.lft BETWEEN parent.lft AND parent.rgt WHERE parent.extension = 'com_content' AND parent.published != 1 GROUP BY cat.id ) AS badcats ON badcats.id = c.id INNER JOIN jos_content_frontpage AS fp ON fp.content_id = a.id WHERE a.access IN (1,1) AND c.access IN (1,1) AND CASE WHEN badcats.id is null THEN a.state ELSE 0 END = 1 AND (a.publish_up = '0000-00-00 00:00:00' OR a.publish_up <= '2012-07-15 08:00:01') AND (a.publish_down = '0000-00-00 00:00:00' OR a.publish_down >= '2012-07-15 08:00:01') GROUP BY a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, a.created, a.modified, a.modified_by, uam.name, a.publish_up, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, a.fulltext, a.state, a.publish_down, badcats.id, c.title, c.path, c.access, c.alias, uam.id, ua.name, ua.email, contact.id, parent.title, parent.id, parent.path, parent.alias, v.rating_sum, v.rating_count, c.published, c.lft, a.ordering, parent.lft, fp.ordering, c.id, a.images, a.urls ORDER BY c.lft, fp.ordering, a.created DESC LIMIT 0, 8 Got error 28 from storage engine SQL=SELECT a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, CASE WHEN a.modified = 0 THEN a.created ELSE a.modified END as modified, a.modified_by, uam.name as modified_by_name,CASE WHEN a.publish_up = 0 THEN a.created ELSE a.publish_up END as publish_up,a.publish_down, a.images, a.urls, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, LENGTH(a.fulltext) AS readmore,CASE WHEN badcats.id is not null THEN 0 ELSE a.state END AS state,c.title AS category_title, c.path AS category_route, c.access AS category_access, c.alias AS category_alias,CASE WHEN a.created_by_alias > ' ' THEN a.created_by_alias ELSE ua.name END AS author,ua.email AS author_email,contact.id as contactid,parent.title as parent_title, parent.id as parent_id, parent.path as parent_route, parent.alias as parent_alias,ROUND(v.rating_sum / v.rating_count, 0) AS rating, v.rating_count as rating_count,c.published, CASE WHEN badcats.id is null THEN c.published ELSE 0 END AS parents_published FROM jos_content AS a LEFT JOIN jos_categories AS c ON c.id = a.catid LEFT JOIN jos_users AS ua ON ua.id = a.created_by LEFT JOIN jos_users AS uam ON uam.id = a.modified_by LEFT JOIN ( SELECT contact.user_id, MAX(contact.id) AS id, contact.language FROM jos_contact_details AS contact WHERE contact.published = 1 GROUP BY contact.user_id, contact.language) AS contact ON contact.user_id = a.created_by LEFT JOIN jos_categories as parent ON parent.id = c.parent_id LEFT JOIN jos_content_rating AS v ON a.id = v.content_id LEFT OUTER JOIN (SELECT cat.id as id FROM jos_categories AS cat JOIN jos_categories AS parent ON cat.lft BETWEEN parent.lft AND parent.rgt WHERE parent.extension = 'com_content' AND parent.published != 1 GROUP BY cat.id ) AS badcats ON badcats.id = c.id INNER JOIN jos_content_frontpage AS fp ON fp.content_id = a.id WHERE a.access IN (1,1) AND c.access IN (1,1) AND CASE WHEN badcats.id is null THEN a.state ELSE 0 END = 1 AND (a.publish_up = '0000-00-00 00:00:00' OR a.publish_up <= '2012-07-15 08:00:01') AND (a.publish_down = '0000-00-00 00:00:00' OR a.publish_down >= '2012-07-15 08:00:01') GROUP BY a.id, a.title, a.alias, a.title_alias, a.introtext, a.checked_out, a.checked_out_time, a.catid, a.created, a.created_by, a.created_by_alias, a.created, a.modified, a.modified_by, uam.name, a.publish_up, a.attribs, a.metadata, a.metakey, a.metadesc, a.access, a.hits, a.xreference, a.featured, a.fulltext, a.state, a.publish_down, badcats.id, c.title, c.path, c.access, c.alias, uam.id, ua.name, ua.email, contact.id, parent.title, parent.id, parent.path, parent.alias, v.rating_sum, v.rating_count, c.published, c.lft, a.ordering, parent.lft, fp.ordering, c.id, a.images, a.urls ORDER BY c.lft, fp.ordering, a.created DESC

And on the frontpage this error message:

    Warning: Invalid argument supplied for foreach() in /home/zasvadba/public_html/components/com_content/models/articles.php on line 486
    
    Warning: mysql_num_rows() expects parameter 1 to be resource, boolean given in /home/zasvadba/public_html/libraries/joomla/database/database/mysql.php on line 293

What can be the problem, or what can be the solution. I've didn't installed anything, I've didn't modified anything",3
11066699,06/16/2012 20:13:18,1367719,05/01/2012 12:27:16,1,0,Select query as Stored Procudure ....?,"I have this Query that I want to use as a stored procedure:

      SELECT ISNULL(P.firstname, s.firstname) AS Expr1,ISNULL(P.lastname,
      s.lastname) AS Expr2 FROM comment AS C LEFT OUTER JOIN professor AS P ON P.ID =   

      C.PID LEFT OUTER JOIN student AS s ON s.ID = C.SID

      WHERE (C.VID = @VID)

it should return values of Expr1 and Expr2

I've tried to declare inputs and outputs but with no luck

please help",sql,sql-server,sql-server-2008,tsql,stored-procedures,06/18/2012 12:07:39,not a real question,1,90,6,"Select query as Stored Procudure ....? I have this Query that I want to use as a stored procedure:

      SELECT ISNULL(P.firstname, s.firstname) AS Expr1,ISNULL(P.lastname,
      s.lastname) AS Expr2 FROM comment AS C LEFT OUTER JOIN professor AS P ON P.ID =   

      C.PID LEFT OUTER JOIN student AS s ON s.ID = C.SID

      WHERE (C.VID = @VID)

it should return values of Expr1 and Expr2

I've tried to declare inputs and outputs but with no luck

please help",5
5002455,02/15/2011 10:25:27,617589,02/15/2011 10:25:27,1,0,Synchronizing SQL server wih local sqldb server,**Synchronizing SQL server wih local sqldb server**,sql,,,,,02/15/2011 13:36:55,not a real question,1,7,7,Synchronizing SQL server wih local sqldb server **Synchronizing SQL server wih local sqldb server**,1
10199594,04/17/2012 21:39:51,440109,09/05/2010 17:01:02,719,49,SQL to end users: pros and cons,"Once upon a time, far far away in a distant galaxy I was a witness to a discussion between a couple of developers. The subject was if it's a good idea to give end users access to a production SQL server (MS SQL 2008) in order to give them ability to make their own reports against their own data.

It was a request from business people -- ""Our clients want to make custom reports"".

A guy who proposed this, claimed that:

 1. He was able to give users ""read-only access"" through set of
    permissions and make the system absolutely safe.
 2. SQL initially
    was an ""end-user"" language and may be so now. 
 3. Having permissions
    to run SQL queries, users would be able to do what they want not
    disturbing developers and support.

Other guys who were against this claimed:

 1. It's pretty easy to crash MS SQL having even max. restricted access. 
 2. Exposing SQL and database structure to end users is not a good idea anyway; it's a bad design.
 3. SQL is too complicated to non-programmers, and, therefore, it won't make their life easier.


What do you think about giving end users access to SQL?

Thank you in advance!",sql,sql-server,security,design,reporting,04/19/2012 14:52:24,not constructive,1,211,7,"SQL to end users: pros and cons Once upon a time, far far away in a distant galaxy I was a witness to a discussion between a couple of developers. The subject was if it's a good idea to give end users access to a production SQL server (MS SQL 2008) in order to give them ability to make their own reports against their own data.

It was a request from business people -- ""Our clients want to make custom reports"".

A guy who proposed this, claimed that:

 1. He was able to give users ""read-only access"" through set of
    permissions and make the system absolutely safe.
 2. SQL initially
    was an ""end-user"" language and may be so now. 
 3. Having permissions
    to run SQL queries, users would be able to do what they want not
    disturbing developers and support.

Other guys who were against this claimed:

 1. It's pretty easy to crash MS SQL having even max. restricted access. 
 2. Exposing SQL and database structure to end users is not a good idea anyway; it's a bad design.
 3. SQL is too complicated to non-programmers, and, therefore, it won't make their life easier.


What do you think about giving end users access to SQL?

Thank you in advance!",5
638332,03/12/2009 12:06:34,71976,02/27/2009 17:43:14,62,1,"How do I join two tables ON a column, that has the same name in both tables?",see above...,sql,,,,,,open,0,2,17,"How do I join two tables ON a column, that has the same name in both tables? see above...",1
4058068,10/30/2010 09:37:01,89752,04/11/2009 12:32:07,1089,20,Need to select from multiple tables based upon records in one table,"heres the situation. I have a table called as maps coordinates the schema is like below:

    map_coordinates:
    item | item_id | latitude | longitude

The idea is that this table contains a list of coordinates of different items, they could be a note, a classifieds post, an event etc. I want to be able to set it up so I have a result set as below:

    item | name of item | latitude | longitude

Consider that all events, classifieds and notes are in separate tables. How could I be able to set this up as I need to show all the coordinates on a google maps along with the name of the element i.e if its a classifieds - the title of the ad, an event the title of it etc without having to make alot of sql queries.

I have the code to show it on the map - I just need to grab the details as such. Or do I have to redo my database design here?
",sql,mysql,normalization,,,,open,0,176,12,"Need to select from multiple tables based upon records in one table heres the situation. I have a table called as maps coordinates the schema is like below:

    map_coordinates:
    item | item_id | latitude | longitude

The idea is that this table contains a list of coordinates of different items, they could be a note, a classifieds post, an event etc. I want to be able to set it up so I have a result set as below:

    item | name of item | latitude | longitude

Consider that all events, classifieds and notes are in separate tables. How could I be able to set this up as I need to show all the coordinates on a google maps along with the name of the element i.e if its a classifieds - the title of the ad, an event the title of it etc without having to make alot of sql queries.

I have the code to show it on the map - I just need to grab the details as such. Or do I have to redo my database design here?
",3
689963,03/27/2009 14:24:24,65223,02/11/2009 18:48:38,99,15,Does anyone use Right Outer Joins?,"I use INNER JOIN and LEFT OUTER JOINs all the time.  However, I never seem to need RIGHT OUTER JOINs, ever.  
  
I've seen plenty of nasty auto-generated SQL that uses right joins, but to me, that code is impossible to get my head around.  I always need to rewrite it using inner and left joins to make heads or tails of it.  
  
Does anyone actually write queries using Right joins?",sql,query,,,,,open,0,78,6,"Does anyone use Right Outer Joins? I use INNER JOIN and LEFT OUTER JOINs all the time.  However, I never seem to need RIGHT OUTER JOINs, ever.  
  
I've seen plenty of nasty auto-generated SQL that uses right joins, but to me, that code is impossible to get my head around.  I always need to rewrite it using inner and left joins to make heads or tails of it.  
  
Does anyone actually write queries using Right joins?",2
11720518,07/30/2012 11:23:30,859621,07/23/2011 19:09:38,12,2,sql server management studio backup error,"![enter image description here][1]![enter image description here][2]hello, i want a back up for my database in sql server management studio. i am using ms sql. but when i try to back up , i take the following error:

    ===================================
    
    Backup failed for Server 'ERDI-PC\SQLEXPRESS'.  (Microsoft.SqlServer.SmoExtended)
    
    ------------------------------
    For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=10.50.1617.0+((KJ_RTM_GDR).110422-1901+)&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Backup+Server&LinkId=20476
    
    ------------------------------
    Program Location:
    
       at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)
       at Microsoft.SqlServer.Management.SqlManagerUI.BackupPropOptions.OnRunNow(Object sender)
    
    ===================================
    
    To accomplish this action, set property Devices. (Microsoft.SqlServer.SmoExtended)
    
    ------------------------------
    For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=10.50.1617.0+((KJ_RTM_GDR).110422-1901+)&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.PropertyNotSetExceptionText&LinkId=20476
    
    ------------------------------
    Program Location:
    
       at Microsoft.SqlServer.Management.Smo.Backup.Script(Server targetServer)
       at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)

and its image:


Its destination comes as tape not disk. i have controlled whether there is a back up folder or not. but i have realized that i have a back up folder: 

    C:\Program Files\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\Backup

i couldn't solve this problem..please help..


  [1]: http://i.stack.imgur.com/KQ4ue.png
  [2]: http://i.stack.imgur.com/BAl8C.png",sql,sql-server-2008,database-backups,sql-management-studio,,07/31/2012 14:56:26,off topic,1,229,6,"sql server management studio backup error ![enter image description here][1]![enter image description here][2]hello, i want a back up for my database in sql server management studio. i am using ms sql. but when i try to back up , i take the following error:

    ===================================
    
    Backup failed for Server 'ERDI-PC\SQLEXPRESS'.  (Microsoft.SqlServer.SmoExtended)
    
    ------------------------------
    For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=10.50.1617.0+((KJ_RTM_GDR).110422-1901+)&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Backup+Server&LinkId=20476
    
    ------------------------------
    Program Location:
    
       at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)
       at Microsoft.SqlServer.Management.SqlManagerUI.BackupPropOptions.OnRunNow(Object sender)
    
    ===================================
    
    To accomplish this action, set property Devices. (Microsoft.SqlServer.SmoExtended)
    
    ------------------------------
    For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=10.50.1617.0+((KJ_RTM_GDR).110422-1901+)&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.PropertyNotSetExceptionText&LinkId=20476
    
    ------------------------------
    Program Location:
    
       at Microsoft.SqlServer.Management.Smo.Backup.Script(Server targetServer)
       at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)

and its image:


Its destination comes as tape not disk. i have controlled whether there is a back up folder or not. but i have realized that i have a back up folder: 

    C:\Program Files\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\Backup

i couldn't solve this problem..please help..


  [1]: http://i.stack.imgur.com/KQ4ue.png
  [2]: http://i.stack.imgur.com/BAl8C.png",4
7023166,08/11/2011 08:48:31,539598,12/12/2010 14:31:54,6,1,Does anyone use ASPMaker?,Would you recommend using asp maker to create a website from a SQL database or is Visual Studio a better option?,sql,asp,,,,08/11/2011 12:25:41,not constructive,1,21,4,Does anyone use ASPMaker? Would you recommend using asp maker to create a website from a SQL database or is Visual Studio a better option?,2
4682194,01/13/2011 16:05:48,166258,08/31/2009 21:47:58,5154,179,Where can I obtain a list of US ZIP Codes with Latitute and Longitude Geocodes?,"We have a table in our database that has latitude and longitude geocode coordinates paired with US zip codes.  A sample of the data looks like this:

    Zip   State  Latitude    Longitude
    30000	GA	33.906553	-84.206311
    30001	GA	33.810659	-84.607964
    30002	GA	33.77429	-84.260712
    30003	GA	33.906553	-84.206311
    30004	GA	34.113832	-84.294578
    30005	GA	34.079927	-84.221166
    30006	GA	33.906553	-84.206311
    30007	GA	33.968777	-84.43282
    30008	GA	33.902022	-84.580318
    30009	GA	33.906553	-84.206311

The problem is that our data hasn't been updated for a few years.  Where can I obtain (for free or for purchase) updated data for this table?",sql,sql-server,database,data,geolocation,01/13/2011 16:12:24,off topic,1,108,15,"Where can I obtain a list of US ZIP Codes with Latitute and Longitude Geocodes? We have a table in our database that has latitude and longitude geocode coordinates paired with US zip codes.  A sample of the data looks like this:

    Zip   State  Latitude    Longitude
    30000	GA	33.906553	-84.206311
    30001	GA	33.810659	-84.607964
    30002	GA	33.77429	-84.260712
    30003	GA	33.906553	-84.206311
    30004	GA	34.113832	-84.294578
    30005	GA	34.079927	-84.221166
    30006	GA	33.906553	-84.206311
    30007	GA	33.968777	-84.43282
    30008	GA	33.902022	-84.580318
    30009	GA	33.906553	-84.206311

The problem is that our data hasn't been updated for a few years.  Where can I obtain (for free or for purchase) updated data for this table?",5
5010043,02/15/2011 22:01:26,610151,02/09/2011 17:30:56,3,2,Export .dat to Xml or readable file with help of .fmt,"I downloaded a database from http://opendb.lightspeedsystems.com/contentupdate/database.htm it was a zip archive. Anyway my question is, there are two files: `virussignatures.dat` and `virussignatures.fmt`. I've heard that I should extract the database as SQL by using BCP. The contents of `virussignatures.fmt` is:
`
8.0

11

1    SQLCHAR       2    64      ""~~~~~""            1     VirusName  SQL_Latin1_General_CP1_CI_AS

2    SQLCHAR       2    32      ""~~~~~""            2     VirusType           SQL_Latin1_General_CP1_CI_AS

3    SQLCHAR       2    32      ""~~~~~""            3     AppSig              SQL_Latin1_General_CP1_CI_AS

4    SQLINT        0    4       ""~~~~~""            4     SigStart            """"

5    SQLINT        0    4       ""~~~~~""            5     SigEnd              """"

6    SQLCHAR       2    1024    ""~~~~~""            6     Signature           SQL_Latin1_General_CP1_CI_AS

7    SQLBIT        1    1       ""~~~~~""            7     Test                """"

8    SQLINT        0    4       ""~~~~~""            8     CategoryNumber      """"

9    SQLINT        0    4       ""~~~~~""            9     SourceNumber        """"

10   SQLDATETIME   0    8       ""~~~~~""            10    TransactionTime     """"

11   SQLCHAR       2    50      """"                 11    KBID                SQL_Latin1_General_CP1_CI_AS
`

I want to turn the virussignatures.dat to an XML or an understandable TXT.

Could this be done using Vb.Net? If so how? Anyway, if not how should this be done?

I'm uploading the two files so you can download 34 MBs instead of 900 MBs... 
",sql,database,vb.net,bcp,virus,,open,0,622,11,"Export .dat to Xml or readable file with help of .fmt I downloaded a database from http://opendb.lightspeedsystems.com/contentupdate/database.htm it was a zip archive. Anyway my question is, there are two files: `virussignatures.dat` and `virussignatures.fmt`. I've heard that I should extract the database as SQL by using BCP. The contents of `virussignatures.fmt` is:
`
8.0

11

1    SQLCHAR       2    64      ""~~~~~""            1     VirusName  SQL_Latin1_General_CP1_CI_AS

2    SQLCHAR       2    32      ""~~~~~""            2     VirusType           SQL_Latin1_General_CP1_CI_AS

3    SQLCHAR       2    32      ""~~~~~""            3     AppSig              SQL_Latin1_General_CP1_CI_AS

4    SQLINT        0    4       ""~~~~~""            4     SigStart            """"

5    SQLINT        0    4       ""~~~~~""            5     SigEnd              """"

6    SQLCHAR       2    1024    ""~~~~~""            6     Signature           SQL_Latin1_General_CP1_CI_AS

7    SQLBIT        1    1       ""~~~~~""            7     Test                """"

8    SQLINT        0    4       ""~~~~~""            8     CategoryNumber      """"

9    SQLINT        0    4       ""~~~~~""            9     SourceNumber        """"

10   SQLDATETIME   0    8       ""~~~~~""            10    TransactionTime     """"

11   SQLCHAR       2    50      """"                 11    KBID                SQL_Latin1_General_CP1_CI_AS
`

I want to turn the virussignatures.dat to an XML or an understandable TXT.

Could this be done using Vb.Net? If so how? Anyway, if not how should this be done?

I'm uploading the two files so you can download 34 MBs instead of 900 MBs... 
",5
1284463,08/16/2009 14:46:15,156728,08/14/2009 21:01:56,25,0,C# SQL parent child table select query help,"Not really sure what this question should be called, but I have two tables that I want to fetch data from.

Lets call them ""Parent"" and ""Children"". The ""Parent"" table has many records in the ""Children"" table. (One to Many)

My problem is I want to find an efficient method for displaying the data the two tables contain to my ASP.NET MVC application.

So I need help designing a query for SQL Server 05 that can get the data out for C#, I was planning of creating type classes and the ""Parent"" class would have a ""List<Children_Type>"" that in my View I can loop through outputting the values.

    public class Parent_Type
    {
        public string Name { get; set; }
        public List<Children_Type> Children { get; set; }
    }

    
    public class Children_Type
    {
        public string Name { get; set; }
    }

The data needs to be displayed like: (The name of the ""Parent"" record then a list of ""Children"" records"")

""Parent 123""

 - ""Child 1"" 
 - ""Child 2""
 - ""Child 3""

""Parent 124""

 - ""Child 1"" 
 - ""Child 2""
 - ""Child 3""",sql,sql-server,c#,asp.net-mvc,,,open,0,219,8,"C# SQL parent child table select query help Not really sure what this question should be called, but I have two tables that I want to fetch data from.

Lets call them ""Parent"" and ""Children"". The ""Parent"" table has many records in the ""Children"" table. (One to Many)

My problem is I want to find an efficient method for displaying the data the two tables contain to my ASP.NET MVC application.

So I need help designing a query for SQL Server 05 that can get the data out for C#, I was planning of creating type classes and the ""Parent"" class would have a ""List<Children_Type>"" that in my View I can loop through outputting the values.

    public class Parent_Type
    {
        public string Name { get; set; }
        public List<Children_Type> Children { get; set; }
    }

    
    public class Children_Type
    {
        public string Name { get; set; }
    }

The data needs to be displayed like: (The name of the ""Parent"" record then a list of ""Children"" records"")

""Parent 123""

 - ""Child 1"" 
 - ""Child 2""
 - ""Child 3""

""Parent 124""

 - ""Child 1"" 
 - ""Child 2""
 - ""Child 3""",4
3201657,07/08/2010 08:02:49,269758,02/09/2010 19:11:11,502,9,SQL interview question,"I got following question on an interview:  
Which SQL mechanisms allow user to browse tables sequentially?",sql,interview-questions,,,,11/29/2011 02:52:48,not constructive,1,17,3,"SQL interview question I got following question on an interview:  
Which SQL mechanisms allow user to browse tables sequentially?",2
8264177,11/25/2011 02:05:34,734984,05/02/2011 19:19:06,1432,30,Copy the result of a query to a table in PostgreSQL inside function,"If I execute the following command alone in PostgreSQL, it will insert the result of the query in a table called `token_relation`, but if I put this inside a PL/PGSQL function, it will try to put inside a RECORD variable.

	SELECT * 
	INTO token_relation
	FROM textblockhastoken	
	ORDER BY textblockid, sentence, position 
	LIMIT  500;

I want to insert in another table like when the command is execute alone. How I do this inside the function?",sql,postgresql,plpgsql,,,,open,0,71,13,"Copy the result of a query to a table in PostgreSQL inside function If I execute the following command alone in PostgreSQL, it will insert the result of the query in a table called `token_relation`, but if I put this inside a PL/PGSQL function, it will try to put inside a RECORD variable.

	SELECT * 
	INTO token_relation
	FROM textblockhastoken	
	ORDER BY textblockid, sentence, position 
	LIMIT  500;

I want to insert in another table like when the command is execute alone. How I do this inside the function?",3
1293390,08/18/2009 11:54:37,87967,04/07/2009 07:15:31,65,5,Sql to output line number in results of a query,"I would like to generate a line number for each line in the results of a sql query. How is it possible to do that ?


Example : in the request 

    select distinct client_name from deliveries

I would like to add a column showing the line number",sql,,,,,,open,0,49,10,"Sql to output line number in results of a query I would like to generate a line number for each line in the results of a sql query. How is it possible to do that ?


Example : in the request 

    select distinct client_name from deliveries

I would like to add a column showing the line number",1
7505808,09/21/2011 19:51:57,815600,06/25/2011 19:07:18,58,3,Parameters in Sql Commands,"I am very new to database. Now I can write Select,update,delete,insert commands. But i have seen many forums where we prefer to write...

    SELECT empSalary from employee where salary = @salary

instead of

    SELECT empSalary from employee where salary = txtSalary.Text

Why do we always prefer to use parameters and actually how to use them?

I wanted to know whats the use and benefits of the first method. I have even heard of Sql Injection but never able to get it right. No idea if Sql injection is related to my question but still mentioned. Please help me to get my basics strong.",sql,database,,,,,open,0,106,4,"Parameters in Sql Commands I am very new to database. Now I can write Select,update,delete,insert commands. But i have seen many forums where we prefer to write...

    SELECT empSalary from employee where salary = @salary

instead of

    SELECT empSalary from employee where salary = txtSalary.Text

Why do we always prefer to use parameters and actually how to use them?

I wanted to know whats the use and benefits of the first method. I have even heard of Sql Injection but never able to get it right. No idea if Sql injection is related to my question but still mentioned. Please help me to get my basics strong.",2
9249271,02/12/2012 13:49:42,500447,11/08/2010 08:07:35,116,6,Computed Column Specification Based on Primary Key,"I have a field that I want to compute based on a string and the ID generated when a record is inserted. Basically when a record is save with ID = 1, I need the computed field to read 'string_1' and so on. I am trying this is my formula `(('PV'+'_')+ID)` where PV is the string  and ID is the primary key field in the same row as the data inserted but I'm getting a formula error. If I add quotes around ID then I just get PV_ID which is wrong. Any idea how I can reference the ID field in my formula and fetch the value? 
here is my table row structure(ID,Computedfield,data1,data2). i need computedfield to have the value of the ID field concatenated with a string. any help appreciated",sql,concatenation,,,,,open,0,132,7,"Computed Column Specification Based on Primary Key I have a field that I want to compute based on a string and the ID generated when a record is inserted. Basically when a record is save with ID = 1, I need the computed field to read 'string_1' and so on. I am trying this is my formula `(('PV'+'_')+ID)` where PV is the string  and ID is the primary key field in the same row as the data inserted but I'm getting a formula error. If I add quotes around ID then I just get PV_ID which is wrong. Any idea how I can reference the ID field in my formula and fetch the value? 
here is my table row structure(ID,Computedfield,data1,data2). i need computedfield to have the value of the ID field concatenated with a string. any help appreciated",2
8151592,11/16/2011 12:20:41,1049546,11/16/2011 11:35:29,1,0,Combining data from 2 tables in to 1 dynamic query,"I have two tables:

    table 1
    id    item     itemType 
    -----------------------
    1     book1    1
    2     book2    1
    3     laptop1  2

    table 2
    id    itemId    name    value
    ------------------------------------------
    1     1         author  enid blyton
    2     1         title   five 1
    3     2         author  enid blyton
    4     2         title   five 2
    5     3         cpu     i7-940
    6     3         ram     4 GB
    7     3         vcard   nvidia quadro

When I query with filter itemType = 1, the result should be:

    query 1
    id    item    author          title
    --------------------------------------------------------
    1     book1   enid blyton     five 1
    2     book2   enid blyton     five 2

and with filter itemType = 2

    query 2
    id    item       cpu       ram        vcard
    ----------------------------------------------
    1     laptop1    i7-940    4 GB       nvidia quadro

and without filter

    query 3
    id    item    author          title      cpu       ram         vcard
    ---------------------------------------------------------------------------
    1     book1   enid blyton     five 1
    2     book2   enid blyton     five 2
    1     laptop1                            i7-940    4 GB        nvidia quadro

The reason I use table 2 is because the parameter of each itemType is created during the fly, so it is not possible to have a table like in query 3.

At this moment I can solve this in C# by rebuilding the table programmatically (using a lot of linq call). With a small size of table 1 (1K rows) and 2 (10K rows), the performance is good, but now the size of table 1 is already more than 100K rows and table 2 is more than 1M rows, and the performance is very low.

Is there any function using SQL query that can solve this problem?",sql,sql-server-2005,dynamicquery,,,,open,0,642,10,"Combining data from 2 tables in to 1 dynamic query I have two tables:

    table 1
    id    item     itemType 
    -----------------------
    1     book1    1
    2     book2    1
    3     laptop1  2

    table 2
    id    itemId    name    value
    ------------------------------------------
    1     1         author  enid blyton
    2     1         title   five 1
    3     2         author  enid blyton
    4     2         title   five 2
    5     3         cpu     i7-940
    6     3         ram     4 GB
    7     3         vcard   nvidia quadro

When I query with filter itemType = 1, the result should be:

    query 1
    id    item    author          title
    --------------------------------------------------------
    1     book1   enid blyton     five 1
    2     book2   enid blyton     five 2

and with filter itemType = 2

    query 2
    id    item       cpu       ram        vcard
    ----------------------------------------------
    1     laptop1    i7-940    4 GB       nvidia quadro

and without filter

    query 3
    id    item    author          title      cpu       ram         vcard
    ---------------------------------------------------------------------------
    1     book1   enid blyton     five 1
    2     book2   enid blyton     five 2
    1     laptop1                            i7-940    4 GB        nvidia quadro

The reason I use table 2 is because the parameter of each itemType is created during the fly, so it is not possible to have a table like in query 3.

At this moment I can solve this in C# by rebuilding the table programmatically (using a lot of linq call). With a small size of table 1 (1K rows) and 2 (10K rows), the performance is good, but now the size of table 1 is already more than 100K rows and table 2 is more than 1M rows, and the performance is very low.

Is there any function using SQL query that can solve this problem?",3
8568776,12/19/2011 23:08:35,1080056,12/04/2011 12:54:20,17,4,Try to install SQL Server Management Studio for SQL Server 2008 Express. FAILED! Why?,"I started a dozen attempts to install the SQL Server Management Studio for the 2008 Express Version of SQL Server. 

What i use:
Windows Vista 2007 SP 2

What i did:
a) I downloaded the install file SQLManagementStudio_x86_DEU.exe from [Microsofts Download Center](http://www.microsoft.com/downloads/de-de/details.aspx?FamilyID=08e52ac2-1d62-45f6-9a4a-4b76a8564a2b)

b) I started the setup, choosed ""Installation""/""Adding Feature""

c) The feature selection appears, but i can chose only from SQL Client Connectivity SDK (see attachment)
![enter image description here][1]

d) This is wrong i guess; but even if i click next i get an error message like ""Please chose a feature first""

What can i do?

Thanks for any advice!!!


  [1]: http://i.stack.imgur.com/NPf93.jpg",sql,sql-server-2008,sql-management-studio,,,12/20/2011 17:55:38,off topic,1,96,14,"Try to install SQL Server Management Studio for SQL Server 2008 Express. FAILED! Why? I started a dozen attempts to install the SQL Server Management Studio for the 2008 Express Version of SQL Server. 

What i use:
Windows Vista 2007 SP 2

What i did:
a) I downloaded the install file SQLManagementStudio_x86_DEU.exe from [Microsofts Download Center](http://www.microsoft.com/downloads/de-de/details.aspx?FamilyID=08e52ac2-1d62-45f6-9a4a-4b76a8564a2b)

b) I started the setup, choosed ""Installation""/""Adding Feature""

c) The feature selection appears, but i can chose only from SQL Client Connectivity SDK (see attachment)
![enter image description here][1]

d) This is wrong i guess; but even if i click next i get an error message like ""Please chose a feature first""

What can i do?

Thanks for any advice!!!


  [1]: http://i.stack.imgur.com/NPf93.jpg",3
1065652,06/30/2009 19:51:39,62539,02/04/2009 18:12:58,648,25,"Looking for exercises to learn SQL, using the Northwind database","I am trying to become more familiar with SQL by writing queries against the Northwind database.  

I am looking for some exercises that would help me to learn SQL and features of SQL Server.  It is important that the exercises have solutions, and in complicated cases, it would be great if there was an explanation for the query. 

Is there any place that I can find a list of these exercises?",sql,sql-server,tsql,sql-server-2005,,12/10/2011 06:00:39,not constructive,1,73,10,"Looking for exercises to learn SQL, using the Northwind database I am trying to become more familiar with SQL by writing queries against the Northwind database.  

I am looking for some exercises that would help me to learn SQL and features of SQL Server.  It is important that the exercises have solutions, and in complicated cases, it would be great if there was an explanation for the query. 

Is there any place that I can find a list of these exercises?",4
9582544,03/06/2012 11:15:49,1087661,12/08/2011 11:50:01,10,0,MS Access SQL Query to Select Items with One to Many Associations,"I have a table with data as below.

Name   Product
Ram    Acer
Indu   Sony
Indu   Acer
Rahul  Sony
Divya  Acer
Divya  Dell

Now I want the query which selects the name that has both Acer and Sony product. The result should be just Indu.

Could you help me with the query design.

Regards,
Navs",sql,ms-access-2007,inner-join,,,03/07/2012 14:54:13,too localized,1,55,12,"MS Access SQL Query to Select Items with One to Many Associations I have a table with data as below.

Name   Product
Ram    Acer
Indu   Sony
Indu   Acer
Rahul  Sony
Divya  Acer
Divya  Dell

Now I want the query which selects the name that has both Acer and Sony product. The result should be just Indu.

Could you help me with the query design.

Regards,
Navs",3
6063287,05/19/2011 18:35:40,478636,10/17/2010 16:41:03,304,2,Stored Procedures in SQL,"I am well aware of SQL statements such as select, insert, update and delete. However I am new to stored procedures.

I am using SQL Management Studio Express.

Any example? Like Registration?
",sql,stored-procedures,,,,05/19/2011 18:49:53,not a real question,1,30,4,"Stored Procedures in SQL I am well aware of SQL statements such as select, insert, update and delete. However I am new to stored procedures.

I am using SQL Management Studio Express.

Any example? Like Registration?
",2
430564,01/10/2009 04:44:05,46011,12/13/2008 19:05:05,6,0,What the best book for MySQL?,What is the best book for SQL particularly MySQL? ,sql,book,,,,09/25/2011 10:56:23,not constructive,1,10,6,What the best book for MySQL? What is the best book for SQL particularly MySQL? ,2
4590199,01/04/2011 02:33:50,488853,10/27/2010 13:01:58,1,0,Is Flash can be integrated with SQL?,is flash can be used and sync with SQL?i have this flash like a form and i need to connect to SQL.if there is any example on the net about this topic.i cant find any,sql,flash,,,,,open,0,35,7,Is Flash can be integrated with SQL? is flash can be used and sync with SQL?i have this flash like a form and i need to connect to SQL.if there is any example on the net about this topic.i cant find any,2
9875412,03/26/2012 15:53:38,228038,12/09/2009 14:56:34,493,13,Query tables and columns based on table data,"
Without knowing the name of a table and columns
I want to query the database retrieve the table and columns 
names and then query the given tables.

I have an Oracle database schema that is like the following:

    Item Table
    =================
    Item_id, Item_type, 
    1	box
    2	book
    3	box

    Book Table
    ===============
    Item_id, title, 	author
    2	'C# Programer', 'Joe'

    Box Table
    =====================
    Item_id, Size
    1,	'Large' 
    3,	'X Large'

    Column_mapping Table
    =======================
    Item_type, column_name, display_order
    box,	   Size,	1
    book,	   title,	1
    book,      author	2

    Table_mapping Table
    ========================
    Item_type,	Table_name
    box,		Box
    book,		Book

I would like a SQL stament that would give 
something like the following results.

    Item_id, Item_type	column1	 column2
    ====================================
    1,	box,		'Large',       <null>
    2,	book,		'C# Programer', 'Joe'
    3, 	box,		'X Large',     <null>


When I tried the simpilfied querry

    Select * from (select Table_name
    		from Table_mapping
    		where Item_type = 'box')
    where Item_id = 1; 

I get an error that Item_id is invalid identifier 

and if I try

    Select * from (select Table_name
    		from Table_mapping
    		where Item_type = 'box');

I just get 

    Table_name
    ===========
    Box

I am not sure how to proceed. 














",sql,,,,,,open,0,306,8,"Query tables and columns based on table data 
Without knowing the name of a table and columns
I want to query the database retrieve the table and columns 
names and then query the given tables.

I have an Oracle database schema that is like the following:

    Item Table
    =================
    Item_id, Item_type, 
    1	box
    2	book
    3	box

    Book Table
    ===============
    Item_id, title, 	author
    2	'C# Programer', 'Joe'

    Box Table
    =====================
    Item_id, Size
    1,	'Large' 
    3,	'X Large'

    Column_mapping Table
    =======================
    Item_type, column_name, display_order
    box,	   Size,	1
    book,	   title,	1
    book,      author	2

    Table_mapping Table
    ========================
    Item_type,	Table_name
    box,		Box
    book,		Book

I would like a SQL stament that would give 
something like the following results.

    Item_id, Item_type	column1	 column2
    ====================================
    1,	box,		'Large',       <null>
    2,	book,		'C# Programer', 'Joe'
    3, 	box,		'X Large',     <null>


When I tried the simpilfied querry

    Select * from (select Table_name
    		from Table_mapping
    		where Item_type = 'box')
    where Item_id = 1; 

I get an error that Item_id is invalid identifier 

and if I try

    Select * from (select Table_name
    		from Table_mapping
    		where Item_type = 'box');

I just get 

    Table_name
    ===========
    Box

I am not sure how to proceed. 














",1
4452733,12/15/2010 17:06:52,543666,12/15/2010 17:04:28,1,0,How can I insert into one table and update another table with the same sql statement?,"The requirement to do it in one statement is because of how the program handles sql statements.  The sql statement is stored in a column of another table, and executed through an open on a recordset.  The open responds with an error of invalid character if a semi-colon is in the statement.

The scenario: Under certain conditions, I want to update a particular field in one record in database A, and record the fact of that change in a log table by an insert.

Here's an example using two statements:

    update data_table a set field1='new value' where identifier=10;

    insert into log_table (action_taken) 
    values('record ' || a.identifier || ' had field1 changed to ' || a.field1);

Is there any way to do this?
",sql,,,,,,open,0,131,16,"How can I insert into one table and update another table with the same sql statement? The requirement to do it in one statement is because of how the program handles sql statements.  The sql statement is stored in a column of another table, and executed through an open on a recordset.  The open responds with an error of invalid character if a semi-colon is in the statement.

The scenario: Under certain conditions, I want to update a particular field in one record in database A, and record the fact of that change in a log table by an insert.

Here's an example using two statements:

    update data_table a set field1='new value' where identifier=10;

    insert into log_table (action_taken) 
    values('record ' || a.identifier || ' had field1 changed to ' || a.field1);

Is there any way to do this?
",1
4505261,12/22/2010 00:39:15,184773,10/06/2009 06:16:54,2309,37,How to query a column with an awkward date format,"Here is how the date is formatted:

     XXXXXX001221

This date is for Dec 21

If I want to get yesterdays entries using the CURDATE() function how would I do this?",sql,pervasive-sql,,,,,open,0,32,10,"How to query a column with an awkward date format Here is how the date is formatted:

     XXXXXX001221

This date is for Dec 21

If I want to get yesterdays entries using the CURDATE() function how would I do this?",2
7363582,09/09/2011 14:56:51,739979,05/05/2011 12:56:41,1,1,SQL Server flat file export is empty when run from SQL Job but correct when run from BIDS,"I have an SSIS package that simply exports a database field into a text file. When I run it in debug from BIDS it outputs perfectly however when I run it from an SQL Job it only creates an empty file.

Any suggestions would be very helpful!",sql,sql-server-2008,bids,,,,open,0,46,18,"SQL Server flat file export is empty when run from SQL Job but correct when run from BIDS I have an SSIS package that simply exports a database field into a text file. When I run it in debug from BIDS it outputs perfectly however when I run it from an SQL Job it only creates an empty file.

Any suggestions would be very helpful!",3
7009345,08/10/2011 10:28:59,281136,02/25/2010 10:30:32,67,5,Connectiong SQL Server From Windows Mobile Application,"I want to connect sql server from mobile application. How can I do?
I am trying such as follow:


      string connStr;
            System.Data.SqlClient.SqlConnection myConn;

            try{
            
                connStr = @""Server='XXX';Database=XX; User Id=XX; Password=XX"";
                myConn = new System.Data.SqlClient.SqlConnection(connStr);
                myConn.Open();
            }
            catch (System.Data.SqlClient.SqlException se)
            {
                MessageBox.Show(""Error has occured"");
            }",sql,server,mobile,connection,,,open,0,186,7,"Connectiong SQL Server From Windows Mobile Application I want to connect sql server from mobile application. How can I do?
I am trying such as follow:


      string connStr;
            System.Data.SqlClient.SqlConnection myConn;

            try{
            
                connStr = @""Server='XXX';Database=XX; User Id=XX; Password=XX"";
                myConn = new System.Data.SqlClient.SqlConnection(connStr);
                myConn.Open();
            }
            catch (System.Data.SqlClient.SqlException se)
            {
                MessageBox.Show(""Error has occured"");
            }",4
11577476,07/20/2012 10:24:53,1540467,07/20/2012 10:20:52,1,0,I'm getting this error when trying to connect to,"[google translate]
I'm getting this error when trying to connect to

http://e1207.hizliresim.com/z/n/9wdps.png",sql,user,connection,,,07/20/2012 14:17:10,not a real question,1,10,9,"I'm getting this error when trying to connect to [google translate]
I'm getting this error when trying to connect to

http://e1207.hizliresim.com/z/n/9wdps.png",3
5981192,05/12/2011 16:23:05,638007,02/28/2011 16:17:19,153,4,Query for altering the columns default value.,"I have googled a lot with no success , just need to know the query for altering the column default value.
",sql,database,query,alter,,,open,0,21,7,"Query for altering the columns default value. I have googled a lot with no success , just need to know the query for altering the column default value.
",4
10748747,05/25/2012 05:09:48,555825,12/28/2010 09:21:10,335,3,Replacing month in TimeStamp from Date,"I am new to Oracle DB and have a situation in hand.

I have two tables. Table1 and Table2. 

Table1 [ ID, MY_DATE ]
Table2 [ ID, MY_TIMESTAMP]

I need to pick the month alone from Table1.MY_DATE and replace the corresponding month at Table2.MY_TIMESTAMP. Both Table1 and Table2 are joined by ID.

How do I pick the month alone from a Date column and replace month alone in a TimeStamp field.

Can anyone please help?",sql,oracle,query,date,,,open,0,70,6,"Replacing month in TimeStamp from Date I am new to Oracle DB and have a situation in hand.

I have two tables. Table1 and Table2. 

Table1 [ ID, MY_DATE ]
Table2 [ ID, MY_TIMESTAMP]

I need to pick the month alone from Table1.MY_DATE and replace the corresponding month at Table2.MY_TIMESTAMP. Both Table1 and Table2 are joined by ID.

How do I pick the month alone from a Date column and replace month alone in a TimeStamp field.

Can anyone please help?",4
2649179,04/15/2010 21:42:22,33604,11/03/2008 10:28:08,2565,133,SQL - Multiple Joins to one table - Two values from two keys,"I'm ashamed to say that my SQL experience is used so infrequently, it falls down when I have to construct a slightly complex query so I'd appreciate an SQL experts advice.

Essentially I have two tables, similar to the following

    games(game_id, game_date, player_a_id, player_a_score, player_b_id, player_b_score)
    players(player_id, player_name)

I wish to construct a query that returns in the same result set, player names and scores ie.

game_id, game_date, player_a_name, player_a_score, player_b_name, player_b_score

Here is my naive approach that I would like to optimize

    select games.game_id, games.game_date, (select player_name from players where player_id = games.player_a_id), games.player_a_score, (select player_name from players where player_id = games.player_b_id), games.player_b_score)

Can anyone advise me the best way to approach this?

Thanks!",sql,,,,,,open,0,118,13,"SQL - Multiple Joins to one table - Two values from two keys I'm ashamed to say that my SQL experience is used so infrequently, it falls down when I have to construct a slightly complex query so I'd appreciate an SQL experts advice.

Essentially I have two tables, similar to the following

    games(game_id, game_date, player_a_id, player_a_score, player_b_id, player_b_score)
    players(player_id, player_name)

I wish to construct a query that returns in the same result set, player names and scores ie.

game_id, game_date, player_a_name, player_a_score, player_b_name, player_b_score

Here is my naive approach that I would like to optimize

    select games.game_id, games.game_date, (select player_name from players where player_id = games.player_a_id), games.player_a_score, (select player_name from players where player_id = games.player_b_id), games.player_b_score)

Can anyone advise me the best way to approach this?

Thanks!",1
6827505,07/26/2011 08:52:04,387516,07/09/2010 08:15:23,1,0,SQL Server 2008 - big increase in size of the table,"One year ago table contained 31 million rows, now contains 36 million rows,
a table size is increased from 9 GB to 45 GB. The table contains columns of type varchar (n), the total size of about 1500 bytes. Recovery mode is simple, and the log is of normal size. A year ago the DB was moved to SQL Server 2005 from SQL Server 2008. What could have caused such a  big increase in table size?
Thank you",sql,database,sql-server-2008,,,07/26/2011 09:42:40,off topic,1,77,11,"SQL Server 2008 - big increase in size of the table One year ago table contained 31 million rows, now contains 36 million rows,
a table size is increased from 9 GB to 45 GB. The table contains columns of type varchar (n), the total size of about 1500 bytes. Recovery mode is simple, and the log is of normal size. A year ago the DB was moved to SQL Server 2005 from SQL Server 2008. What could have caused such a  big increase in table size?
Thank you",3
4949357,02/09/2011 19:11:59,286999,03/05/2010 09:53:25,65,0,Insert select continue with error,"i have some sql scripts which make 

    insert into secondtable (field, field1)
    select field, field2 from table;

I use oracle 9.x and sqldevelopper.

When i launch them, on some insert select i have foreign key error. And so the they didn't insert the set who work.

Is it possible to say to oracle to continue same when the error appear and if possible to display or log the error ?

Thanks you",sql,oracle9i,insert-select,,,,open,0,75,5,"Insert select continue with error i have some sql scripts which make 

    insert into secondtable (field, field1)
    select field, field2 from table;

I use oracle 9.x and sqldevelopper.

When i launch them, on some insert select i have foreign key error. And so the they didn't insert the set who work.

Is it possible to say to oracle to continue same when the error appear and if possible to display or log the error ?

Thanks you",3
8980278,01/23/2012 23:49:28,1101107,12/16/2011 01:59:42,25,2,Preserve leading zeros SQL,"I am saving a number eg. 000001 in a SQL TEXT field which causes the leading zeros to be lost.  

I need the TEXT type field as the data may contain letters and/or numbers.

Any suggestions how I could preserve the leading zeros while still storing the data in a TEXT type field?",sql,database,,,,01/24/2012 09:25:14,too localized,1,53,4,"Preserve leading zeros SQL I am saving a number eg. 000001 in a SQL TEXT field which causes the leading zeros to be lost.  

I need the TEXT type field as the data may contain letters and/or numbers.

Any suggestions how I could preserve the leading zeros while still storing the data in a TEXT type field?",2
1539628,10/08/2009 18:27:29,16320,09/17/2008 16:11:29,42,3,Using OPENROWSET in an INSERT statement while specifying the values of another column?,"I'm using OPENROWSET(BULK ...) to insert the contents of a file into my table.  The problem is that I also need to specify the value of another column in the same INSERT statement.

I have something like this:

    INSERT INTO MyTable
    SELECT *
    FROM OPENROWSET(BULK 'c:\foo.bin', SINGLE_BLOB)

I'm sure there's a way to also specify the value of a different column here, but I don't know how.",sql,openrowset,insert,,,,open,0,75,13,"Using OPENROWSET in an INSERT statement while specifying the values of another column? I'm using OPENROWSET(BULK ...) to insert the contents of a file into my table.  The problem is that I also need to specify the value of another column in the same INSERT statement.

I have something like this:

    INSERT INTO MyTable
    SELECT *
    FROM OPENROWSET(BULK 'c:\foo.bin', SINGLE_BLOB)

I'm sure there's a way to also specify the value of a different column here, but I don't know how.",3
9836826,03/23/2012 09:35:34,863304,07/26/2011 11:05:23,31,13,"Why is auto_increment ""spelled"" with an underscore?","I was wondering why `auto_increment` is ""spelled"" with an underscore, since `primary key` `not null` and such is not?

Is it because `auto_increment` is some old syntactical leftover or such? ",sql,,,,,03/23/2012 13:28:56,off topic,1,30,7,"Why is auto_increment ""spelled"" with an underscore? I was wondering why `auto_increment` is ""spelled"" with an underscore, since `primary key` `not null` and such is not?

Is it because `auto_increment` is some old syntactical leftover or such? ",1
9328753,02/17/2012 13:05:35,1029477,11/04/2011 10:17:26,58,2,select subset of rows sql using Row_Number(),"    Select id, name, ROW_NUMBER() OVER (ORDER BY id asc) as 'RowNo'
    from customers
    where RowNo between 50 AND 60

I am trying to select a subset of rows between 50 and 60 . The problem is 'RowNo' is an invalid column name.

Thank you

Using SQL SERVER 2008 R2",sql,database,rownumber,,,,open,0,56,7,"select subset of rows sql using Row_Number()     Select id, name, ROW_NUMBER() OVER (ORDER BY id asc) as 'RowNo'
    from customers
    where RowNo between 50 AND 60

I am trying to select a subset of rows between 50 and 60 . The problem is 'RowNo' is an invalid column name.

Thank you

Using SQL SERVER 2008 R2",3
2519147,03/25/2010 20:32:11,100930,05/04/2009 15:00:25,6419,244,"Odd SQL behavior, I'm wondering why this works the way it does.","Consider the following Transact sql.

    DECLARE @table TABLE(val VARCHAR(255) NULL)
    
    INSERT INTO @table (val) VALUES('a')
    INSERT INTO @table (val) VALUES('b')
    INSERT INTO @table (val) VALUES('c')
    INSERT INTO @table (val) VALUES('d')
    INSERT INTO @table (val) VALUES(NULL)
    
    select val 
    from @table
    where val not in ('a') 

I would expect this to return 

    b, c, d, NULL

but instead it returns 

    b, c, d

Why is this the case?  Is NULL not evaluated? Is NULL somehow in the set 'a'?",sql,tsql,sql-server-2005,,,,open,0,120,12,"Odd SQL behavior, I'm wondering why this works the way it does. Consider the following Transact sql.

    DECLARE @table TABLE(val VARCHAR(255) NULL)
    
    INSERT INTO @table (val) VALUES('a')
    INSERT INTO @table (val) VALUES('b')
    INSERT INTO @table (val) VALUES('c')
    INSERT INTO @table (val) VALUES('d')
    INSERT INTO @table (val) VALUES(NULL)
    
    select val 
    from @table
    where val not in ('a') 

I would expect this to return 

    b, c, d, NULL

but instead it returns 

    b, c, d

Why is this the case?  Is NULL not evaluated? Is NULL somehow in the set 'a'?",3
10751923,05/25/2012 09:32:59,1057735,11/21/2011 11:45:30,109,1,Subtract date from current date and return only Years,"I need to subtract a date(stored in db) from current date and return only the year part from it.
Currently for test purposes i am doing some thing like this but the return result is wrong

    print DATEDIFF (year ,1993-04-24,getdate())
The return value is 107.
The system date is perfectly right.

Is there something wrong.
",sql,sql-server,,,,,open,0,54,9,"Subtract date from current date and return only Years I need to subtract a date(stored in db) from current date and return only the year part from it.
Currently for test purposes i am doing some thing like this but the return result is wrong

    print DATEDIFF (year ,1993-04-24,getdate())
The return value is 107.
The system date is perfectly right.

Is there something wrong.
",2
5337984,03/17/2011 10:48:36,59503,01/27/2009 20:27:26,234,5,Refactor SQL query to return results into rows instead of columns,"I have a SQL query that need to be refactored. Basically the query gets all the producttypes  ordered by a specified customer. The problem is that the results are returned in columns instead of rows. This needs to be changed the other way around to make the query more generic. 

**So this is what the query returns:**

    Name   ProductType1   ProductType2   ProductType3
    --------------------------------------------------
    Marc   PT09           P15            PT33

**And this is what it should be:**

    Name ProductType
    ----------------
    Marc PT09
    Marc P15
    Marc PT33


**This is the query which I have simplified a bit:**

    SELECT 
          CustomerData.Name as Name
          Product1.productType as ProductType1,
          Product2.productType as ProductType2,
          Product3.productType as ProductType3
    FROM
        (SELECT ProductID, Name
                FROM 
                    Customer 
                    Orders
          WHERE Customer.ID = 111
        ) as CustomerData
    
    LEFT JOIN (SELECT DISTINCT CP.ProductID as ProductID,
                               PC.Type as ProductType
               FROM 
                    CustomerProduct CP,
                    ProductCategory PC
               WHERE
                    PC.Category = 'A'
                    AND CP.ProductCategoryID = PC.ID
               )  as Product1
               on CustomerData.ProductID = Product1.ProductID
               
    LEFT JOIN (SELECT DISTINCT CP.ProductID as ProductID,
                               PC.Type as ProductType
               FROM 
                    CustomerProduct CP,
                    ProductCategory PC
               WHERE
                    PC.Category = 'B'
                    AND CP.ProductCategoryID = PC.ID
               )  as Product2
               on CustomerData.ProductID = Product1.ProductID
     
    LEFT JOIN (SELECT DISTINCT CP.ProductID as ProductID,
                               PC.Type as ProductType
               FROM 
                    CustomerProduct CP,
                    ProductCategory PC
               WHERE
                    PC.Category = 'C'
                    AND CP.ProductCategoryID = PC.ID
               )  as Product3
               on CustomerData.ProductID = Product1.ProductID

So I have been thinking about splitting the joins into a separate stored proc and then call this as I need more productTypes but I can't seem to get this working. Anyone an idea on how to get this working ?
",sql,query,refactoring,,,,open,0,947,11,"Refactor SQL query to return results into rows instead of columns I have a SQL query that need to be refactored. Basically the query gets all the producttypes  ordered by a specified customer. The problem is that the results are returned in columns instead of rows. This needs to be changed the other way around to make the query more generic. 

**So this is what the query returns:**

    Name   ProductType1   ProductType2   ProductType3
    --------------------------------------------------
    Marc   PT09           P15            PT33

**And this is what it should be:**

    Name ProductType
    ----------------
    Marc PT09
    Marc P15
    Marc PT33


**This is the query which I have simplified a bit:**

    SELECT 
          CustomerData.Name as Name
          Product1.productType as ProductType1,
          Product2.productType as ProductType2,
          Product3.productType as ProductType3
    FROM
        (SELECT ProductID, Name
                FROM 
                    Customer 
                    Orders
          WHERE Customer.ID = 111
        ) as CustomerData
    
    LEFT JOIN (SELECT DISTINCT CP.ProductID as ProductID,
                               PC.Type as ProductType
               FROM 
                    CustomerProduct CP,
                    ProductCategory PC
               WHERE
                    PC.Category = 'A'
                    AND CP.ProductCategoryID = PC.ID
               )  as Product1
               on CustomerData.ProductID = Product1.ProductID
               
    LEFT JOIN (SELECT DISTINCT CP.ProductID as ProductID,
                               PC.Type as ProductType
               FROM 
                    CustomerProduct CP,
                    ProductCategory PC
               WHERE
                    PC.Category = 'B'
                    AND CP.ProductCategoryID = PC.ID
               )  as Product2
               on CustomerData.ProductID = Product1.ProductID
     
    LEFT JOIN (SELECT DISTINCT CP.ProductID as ProductID,
                               PC.Type as ProductType
               FROM 
                    CustomerProduct CP,
                    ProductCategory PC
               WHERE
                    PC.Category = 'C'
                    AND CP.ProductCategoryID = PC.ID
               )  as Product3
               on CustomerData.ProductID = Product1.ProductID

So I have been thinking about splitting the joins into a separate stored proc and then call this as I need more productTypes but I can't seem to get this working. Anyone an idea on how to get this working ?
",3
10229590,04/19/2012 13:53:58,1344133,04/19/2012 13:33:12,1,0,SQL datetime and calendar.selectedDate in asp format issue,"I am building an appointment booking system web application in asp.net in VB,

Im simply trying to check whether an appointment has been made on a date selected from the calendar control.  I am using Linq for the bindings but the format from the calendar is mmddyyyy  when i need ddmmyyyy, my appointments entered int sql table as are 20/09/2012 10:00:00

trying to use a linq from p in db.apps
where p.date=mycontrol.selecteddate

does not yield results",sql,linq,asp-classic,vb,,,open,0,74,8,"SQL datetime and calendar.selectedDate in asp format issue I am building an appointment booking system web application in asp.net in VB,

Im simply trying to check whether an appointment has been made on a date selected from the calendar control.  I am using Linq for the bindings but the format from the calendar is mmddyyyy  when i need ddmmyyyy, my appointments entered int sql table as are 20/09/2012 10:00:00

trying to use a linq from p in db.apps
where p.date=mycontrol.selecteddate

does not yield results",4
6499451,06/27/2011 22:02:27,818192,06/27/2011 22:02:27,1,0,Best report writers for Microsoft SQL or MySQL servers?,What are the best report writers for Microsoft or MySQL servers?,sql,report,writer,,,06/30/2011 01:11:38,not constructive,1,11,9,Best report writers for Microsoft SQL or MySQL servers? What are the best report writers for Microsoft or MySQL servers?,3
8750797,01/05/2012 22:28:42,756623,05/17/2011 02:04:43,42,4,SQL Server 2008 R2: Import table from text file when column names have a / in them,"How do you import a table into a database from a text file when that table has /'s in the column names?

I have a SQL Server 2008 R2 table with columns that have /'s in their name.  (SAP Database)
For example:  /BIC/FIC_SD001 has a column named /BIC/O_CST_00

I have done an export (using the Import/Export Wizard) of this table to a text file and the slashes are there.

When I import the table into a different database (using the wizard) all the /'s from the column are removed and replaced with spaces.
The above column now looks like this:  BIC 0_CST_00

Thank you in advance for your help!",sql,sql-server,sql-server-2008-r2,sap,,,open,0,106,17,"SQL Server 2008 R2: Import table from text file when column names have a / in them How do you import a table into a database from a text file when that table has /'s in the column names?

I have a SQL Server 2008 R2 table with columns that have /'s in their name.  (SAP Database)
For example:  /BIC/FIC_SD001 has a column named /BIC/O_CST_00

I have done an export (using the Import/Export Wizard) of this table to a text file and the slashes are there.

When I import the table into a different database (using the wizard) all the /'s from the column are removed and replaced with spaces.
The above column now looks like this:  BIC 0_CST_00

Thank you in advance for your help!",4
11523449,07/17/2012 13:22:41,1452946,06/13/2012 06:35:34,151,3,Prefilter a SQL-Table with a Trigger,"i have the following Trigger:

       ALTER TRIGGER [dbo].[DIENSTLEISTUNG_Update]
       ON [dbo].[DIENSTLEISTUNG]
       INSTEAD OF UPDATE
    AS
    BEGIN
    	SET  NOCOUNT ON;
    
        INSERT INTO [DIENSTLEISTUNG] (BEZEICHNUNG, MENGENEINHEIT, 
            PREIS, BESCHREIBUNG, VORLAUFZEIT,
            AZ_MO, AZ_DI,AZ_MI,AZ_DO,AZ_FR,
            AZ_SA,AZ_SO,DIENSTLEISTUNGSART_ID,
            UPDATE_USER, UPDATE_DATE, RUESTZEIT,
            PERMISSIONS, KONTRAKTPOSITION,ARTIKELNUMMER,
            ANZAHL, BUCHUNGSHINWEIS, SONDERWUNSCH,FLAG)
      
        SELECT  BEZEICHNUNG, MENGENEINHEIT, 
            PREIS, BESCHREIBUNG, VORLAUFZEIT,
            AZ_MO, AZ_DI,AZ_MI,AZ_DO,AZ_FR,
            AZ_SA,AZ_SO,DIENSTLEISTUNGSART_ID,
            UPDATE_USER,GETDATE(),RUESTZEIT,
            PERMISSIONS, KONTRAKTPOSITION,ARTIKELNUMMER,
            ANZAHL, BUCHUNGSHINWEIS, SONDERWUNSCH,
            0 
        FROM INSERTED
     
        UPDATE  DIENSTLEISTUNG
        SET     DIENSTLEISTUNG.FLAG = 1 
        FROM    DIENSTLEISTUNG 
                INNER JOIN INSERTED
                ON INSERTED.ID = DIENSTLEISTUNG.ID            
    SET NOCOUNT OFF;	
    END


That Trigger copy an entire row with a new ID if a change in the original row happens, also he set a FLAG in the new and old row. The old row gets FLAG = 1 and the new row FLAG = 0.


Is it possible to filter these rows in the Trigger? So that he only returns the new rows with FLAG = 0?


If yes, how can i do that?


Thanks in advance!

",sql,sql-server-2008,triggers,,,,open,0,435,6,"Prefilter a SQL-Table with a Trigger i have the following Trigger:

       ALTER TRIGGER [dbo].[DIENSTLEISTUNG_Update]
       ON [dbo].[DIENSTLEISTUNG]
       INSTEAD OF UPDATE
    AS
    BEGIN
    	SET  NOCOUNT ON;
    
        INSERT INTO [DIENSTLEISTUNG] (BEZEICHNUNG, MENGENEINHEIT, 
            PREIS, BESCHREIBUNG, VORLAUFZEIT,
            AZ_MO, AZ_DI,AZ_MI,AZ_DO,AZ_FR,
            AZ_SA,AZ_SO,DIENSTLEISTUNGSART_ID,
            UPDATE_USER, UPDATE_DATE, RUESTZEIT,
            PERMISSIONS, KONTRAKTPOSITION,ARTIKELNUMMER,
            ANZAHL, BUCHUNGSHINWEIS, SONDERWUNSCH,FLAG)
      
        SELECT  BEZEICHNUNG, MENGENEINHEIT, 
            PREIS, BESCHREIBUNG, VORLAUFZEIT,
            AZ_MO, AZ_DI,AZ_MI,AZ_DO,AZ_FR,
            AZ_SA,AZ_SO,DIENSTLEISTUNGSART_ID,
            UPDATE_USER,GETDATE(),RUESTZEIT,
            PERMISSIONS, KONTRAKTPOSITION,ARTIKELNUMMER,
            ANZAHL, BUCHUNGSHINWEIS, SONDERWUNSCH,
            0 
        FROM INSERTED
     
        UPDATE  DIENSTLEISTUNG
        SET     DIENSTLEISTUNG.FLAG = 1 
        FROM    DIENSTLEISTUNG 
                INNER JOIN INSERTED
                ON INSERTED.ID = DIENSTLEISTUNG.ID            
    SET NOCOUNT OFF;	
    END


That Trigger copy an entire row with a new ID if a change in the original row happens, also he set a FLAG in the new and old row. The old row gets FLAG = 1 and the new row FLAG = 0.


Is it possible to filter these rows in the Trigger? So that he only returns the new rows with FLAG = 0?


If yes, how can i do that?


Thanks in advance!

",3
11244380,06/28/2012 12:12:56,1358331,04/26/2012 09:44:25,310,31,Insert multiple values in table using single sql Query,How can i insert multiple values in a sql table using single statement,sql,,,,,06/28/2012 19:37:02,not a real question,1,13,9,Insert multiple values in table using single sql Query How can i insert multiple values in a sql table using single statement,1
7813261,10/18/2011 20:26:39,1001919,10/18/2011 20:04:38,1,0,Oracle VS Sql server - for small enterprise,"I read somes post about what to choose oracle and slq. but I want opinion of real dba.

my situation

technicly, I'm in a big company

I work on a little office (max 100 user).
they want a new database on local server for intern apps.

they ask me to look for oracle or sql server. 
they will have max 5 user who can admin database (but like I said before, maybe 100 user could connect at the same time for getting data)

I know that the main/central office, they have SAP, so oracle db. (I dont know if that can change something?)

my office doesn't have a dba (only intern for developping, its the central office who send somebody for the most of informatic things)

for the moment, they use access database but their new/futur programs needs more.

What are your suggestion(oracle vs sql server, enterprise vs standard vs standard one ) and why (like speed, pricing, friendly user, easy to change actual apps., etc.)

tank you


",sql,oracle,server,enterprise,small,10/18/2011 20:42:13,not a real question,1,158,8,"Oracle VS Sql server - for small enterprise I read somes post about what to choose oracle and slq. but I want opinion of real dba.

my situation

technicly, I'm in a big company

I work on a little office (max 100 user).
they want a new database on local server for intern apps.

they ask me to look for oracle or sql server. 
they will have max 5 user who can admin database (but like I said before, maybe 100 user could connect at the same time for getting data)

I know that the main/central office, they have SAP, so oracle db. (I dont know if that can change something?)

my office doesn't have a dba (only intern for developping, its the central office who send somebody for the most of informatic things)

for the moment, they use access database but their new/futur programs needs more.

What are your suggestion(oracle vs sql server, enterprise vs standard vs standard one ) and why (like speed, pricing, friendly user, easy to change actual apps., etc.)

tank you


",5
3725267,09/16/2010 09:16:51,360480,06/07/2010 13:44:53,151,4,How to reference a map name for a subquery in an HQL order by clause,"I've got an HQL statement like this:

    select new map (f1 as field1, (select ...) as field2)
    from ...
    where ...
    order by field2;

It fails saying ""Unknown column 'field2'"". I experienced this in general that when using the ""new map"" statement, I can't reference the map names in the order by field.

As HQL subqueries are only allowed in the select or the where clause, I can't just copy over the subquery to the order by clause either (which wouldn't be so nice anyway).

Am I missing something or do I have to refrain from using a map?",sql,hibernate,reference,hql,subquery,,open,0,108,15,"How to reference a map name for a subquery in an HQL order by clause I've got an HQL statement like this:

    select new map (f1 as field1, (select ...) as field2)
    from ...
    where ...
    order by field2;

It fails saying ""Unknown column 'field2'"". I experienced this in general that when using the ""new map"" statement, I can't reference the map names in the order by field.

As HQL subqueries are only allowed in the select or the where clause, I can't just copy over the subquery to the order by clause either (which wouldn't be so nice anyway).

Am I missing something or do I have to refrain from using a map?",5
5452029,03/27/2011 20:07:12,487397,10/26/2010 09:10:22,9,3,"rails 3 - SQL pass variable to ""order""","Im trying to pass variable to the order...

    [code].order(['SUM((prices.price * ?) + profiles.shippingCost)', params[:prod_id]]).all

But it doesn't convert the variable to sql instead it gives me.(the variable in this case was ""1""). 

    GROUP BY price ORDER BY SUM((prices.price * ?) + profiles.shippingCost), 1):

Is this even possible to do?",sql,ruby-on-rails-3,order,,,,open,0,54,8,"rails 3 - SQL pass variable to ""order"" Im trying to pass variable to the order...

    [code].order(['SUM((prices.price * ?) + profiles.shippingCost)', params[:prod_id]]).all

But it doesn't convert the variable to sql instead it gives me.(the variable in this case was ""1""). 

    GROUP BY price ORDER BY SUM((prices.price * ?) + profiles.shippingCost), 1):

Is this even possible to do?",3
11624995,07/24/2012 06:02:07,1455049,06/14/2012 00:27:45,5,0,SQL: Is it possible to join two tables and use the same table(result of the join) to generate two aggregated tables using a stored procedure?,I have a scenario where I have to join two tables to generate two aggregated tables based on a certain level of aggregation. I need to use these two tables in c# asp.net code. So my question is if it is possible to join these two tables give an alias for it and generate two aggregated tables with the help of the alias ? Rather than doing two joins two generate datatables individually ?,sql,join,,,,07/25/2012 16:39:33,not a real question,1,74,25,SQL: Is it possible to join two tables and use the same table(result of the join) to generate two aggregated tables using a stored procedure? I have a scenario where I have to join two tables to generate two aggregated tables based on a certain level of aggregation. I need to use these two tables in c# asp.net code. So my question is if it is possible to join these two tables give an alias for it and generate two aggregated tables with the help of the alias ? Rather than doing two joins two generate datatables individually ?,2
9648625,03/10/2012 17:35:18,237974,12/24/2009 00:12:19,1558,63,Checking Unenforced Conditions before Insert,"I've seen a few questions where developers were asking about checking if a record already exists before insert to avoid a primary key constraint violation... this is not a big problem IMHO.  But, what if the condition I want to check is not to avoid a DB error, because no DB error will be raised if the condition exists during insert.

For example, a large de-normalized table that has several state values, but I only want to allow updating of a single state value at a time.

The columns could be something like:

    id
    animal_id
    health_problem_id
    treatment_plan
    treatment_approved
    treatment_scheduled
    treatment_in_progress
    treatment_complete
    who_updated
    when_updated

When a user updates a state field in their application view the state of the previous information will be used as part of the insert **if** it matches what they currently see, otherwise they will be notified.

Now let's pretend this table is going to be used heavily and concurrently (my example may not the best for this...).  For those with astounding imagination let's also assume that there is a reasonable likelihood people will be working on the same animal at the same time. Let's also assume data integrity is important.

Obviously, if it's going to be used concurrently and heavily locking the whole table is NOT a good solution, but certainly would insure data integrity.

 1. Is there a performant solution to this problem?
 2. Is bad database design the culprit here (ie. de-normalization of the data.)?  If that is the case what design would solve this problem?
 3. Is this design ok if it's not going to be used heavily, and there is a low likelihood of people working on the same animal? (Note: data integrity is still extremely important.)
 4. Same question as 3, but with the requirement of data integrity being less important.

**Note: My example, is an example this is not something I'm doing with data on animals :)**

Opinions and/or details on how to solve solve this generically with existing relational databases is certainly preferred.
",sql,database,validation,database-design,relational-database,,open,0,360,5,"Checking Unenforced Conditions before Insert I've seen a few questions where developers were asking about checking if a record already exists before insert to avoid a primary key constraint violation... this is not a big problem IMHO.  But, what if the condition I want to check is not to avoid a DB error, because no DB error will be raised if the condition exists during insert.

For example, a large de-normalized table that has several state values, but I only want to allow updating of a single state value at a time.

The columns could be something like:

    id
    animal_id
    health_problem_id
    treatment_plan
    treatment_approved
    treatment_scheduled
    treatment_in_progress
    treatment_complete
    who_updated
    when_updated

When a user updates a state field in their application view the state of the previous information will be used as part of the insert **if** it matches what they currently see, otherwise they will be notified.

Now let's pretend this table is going to be used heavily and concurrently (my example may not the best for this...).  For those with astounding imagination let's also assume that there is a reasonable likelihood people will be working on the same animal at the same time. Let's also assume data integrity is important.

Obviously, if it's going to be used concurrently and heavily locking the whole table is NOT a good solution, but certainly would insure data integrity.

 1. Is there a performant solution to this problem?
 2. Is bad database design the culprit here (ie. de-normalization of the data.)?  If that is the case what design would solve this problem?
 3. Is this design ok if it's not going to be used heavily, and there is a low likelihood of people working on the same animal? (Note: data integrity is still extremely important.)
 4. Same question as 3, but with the requirement of data integrity being less important.

**Note: My example, is an example this is not something I'm doing with data on animals :)**

Opinions and/or details on how to solve solve this generically with existing relational databases is certainly preferred.
",5
6427630,06/21/2011 15:12:26,719825,04/21/2011 23:30:37,86,5,sql - generate script to create VIEW based on relational tables?,"Is there a way in MS SQL EXPRESS 2005 to generate a script that would create a VIEW based on tables primary/foreign key relationships? 

I have multiple databases with thousands of tables, and its very time consuming to look at the ""table dependencies"" and try to JOIN data in the query window.

Thanks",sql,view,foreign-keys,primary-key,relational-database,,open,0,52,11,"sql - generate script to create VIEW based on relational tables? Is there a way in MS SQL EXPRESS 2005 to generate a script that would create a VIEW based on tables primary/foreign key relationships? 

I have multiple databases with thousands of tables, and its very time consuming to look at the ""table dependencies"" and try to JOIN data in the query window.

Thanks",5
6080512,05/21/2011 08:18:58,713099,04/18/2011 09:10:35,1,0,Alter database by admin user,"I have a main database that is created programmatically.In my program Admin user can copy and rename this database.then admin must alter this new database and grant all of the permissions to guest user with running a sql query, but recieve this error : ""The server principal 'UserName' is not able to access to database 'MyDBName' under the current security context"".
please help me",sql,network-programming,,,,,open,0,63,5,"Alter database by admin user I have a main database that is created programmatically.In my program Admin user can copy and rename this database.then admin must alter this new database and grant all of the permissions to guest user with running a sql query, but recieve this error : ""The server principal 'UserName' is not able to access to database 'MyDBName' under the current security context"".
please help me",2
4015278,10/25/2010 14:00:25,380432,06/30/2010 19:19:50,306,1,SQL Select all days in a year with 9 blank INT fields,"I am trying to get all dates in a year in a SELECT statement with 9 INT fields that have a value of 0 in them.

So basically I need the following:
1/1/2007 0 0 0 0 0 0 0 0 0
1/2/2007 0 0 0 0 0 0 0 0 0
1/3/2007 0 0 0 0 0 0 0 0 0 

and so on and so on for a whole year.

The year is always the 1/1 - 12/31

This is part of a biggger query but I dont think that part is neccassary as this is the part I need....

Thanks!",sql,sql-server,,,,,open,0,96,12,"SQL Select all days in a year with 9 blank INT fields I am trying to get all dates in a year in a SELECT statement with 9 INT fields that have a value of 0 in them.

So basically I need the following:
1/1/2007 0 0 0 0 0 0 0 0 0
1/2/2007 0 0 0 0 0 0 0 0 0
1/3/2007 0 0 0 0 0 0 0 0 0 

and so on and so on for a whole year.

The year is always the 1/1 - 12/31

This is part of a biggger query but I dont think that part is neccassary as this is the part I need....

Thanks!",2
4443451,12/14/2010 19:43:10,518201,11/24/2010 00:35:47,57,1,sql - non-bolean express error,"        select * from qvalues where rowid ,name,compound in (
        select rowid,name,compound from qvalues where rowid in (select rowid from batchinfo where instrument='tf1')
        group by rowid,name,compound
        having COUNT(*)>1 
        )
    having min=min(rid)

i am getting this error on this statement:


> Msg 4145, Level 15, State 1, Line 3
An expression of non-boolean type specified in a context where a condition is expected, near ','.
Msg 156, Level 15, State 1, Line 8
Incorrect syntax near the keyword 'having'.


does anyone know what i am doing wrong? what i need to do is find all the occurrences of those three fields in the table having min(rid)

thank you so much for your help

",sql,sql-server,tsql,sql-server-2008,,,open,0,144,5,"sql - non-bolean express error         select * from qvalues where rowid ,name,compound in (
        select rowid,name,compound from qvalues where rowid in (select rowid from batchinfo where instrument='tf1')
        group by rowid,name,compound
        having COUNT(*)>1 
        )
    having min=min(rid)

i am getting this error on this statement:


> Msg 4145, Level 15, State 1, Line 3
An expression of non-boolean type specified in a context where a condition is expected, near ','.
Msg 156, Level 15, State 1, Line 8
Incorrect syntax near the keyword 'having'.


does anyone know what i am doing wrong? what i need to do is find all the occurrences of those three fields in the table having min(rid)

thank you so much for your help

",4
10603724,05/15/2012 15:12:00,1114426,12/24/2011 09:08:27,38,9,Best article rating system structure,"**Hello my friends**
<br>
I need to develop a good rating system structure for creating a article rating in my Asp.net MVC3 application using SQL Server Database.

Ordinary table structure is:

    id
    content_id
    rating_sum
    rating_count
    lastip


or this:

    id
    content_id
    rating
    date
    ip (e.g. to prevent double rating)

But, i like to use something like CodeProject Rating System <br>
Ex: [http://www.codeproject.com/Articles/6888/ASP-Parser][1] 

[1]:http://www.codeproject.com/Articles/6888/ASP-Parser

Now, would you mind telling me the best way of developing such systems? Thank you very much indeed.",sql,sql-server,asp.net-mvc-3,rating-system,,05/17/2012 14:59:15,not constructive,1,103,5,"Best article rating system structure **Hello my friends**
<br>
I need to develop a good rating system structure for creating a article rating in my Asp.net MVC3 application using SQL Server Database.

Ordinary table structure is:

    id
    content_id
    rating_sum
    rating_count
    lastip


or this:

    id
    content_id
    rating
    date
    ip (e.g. to prevent double rating)

But, i like to use something like CodeProject Rating System <br>
Ex: [http://www.codeproject.com/Articles/6888/ASP-Parser][1] 

[1]:http://www.codeproject.com/Articles/6888/ASP-Parser

Now, would you mind telling me the best way of developing such systems? Thank you very much indeed.",4
7496632,09/21/2011 08:19:18,730651,04/29/2011 07:37:07,89,8,SQL Group By Problem,"I have a table that has 3 cols namely points, project_id and creation_date. every time points are assigned a new record has been made, for example.

points = 20 project_id = 441 creation_date = 04/02/2011 -> Is one record <br>
points = 10 project_id = 600 creation_date = 04/02/2011 -> Is another record <br>
points = 5 project_id = 441 creation_dae = 06/02/2011 -> Is final record

(creation_date is the date on which record is entered and it is achieved by setting the default value to GETDATE())

now the problem is I want to get MAX points grouped by project_id but I also want creation_date to appear with it so I can use it for another purpose, if creation date is repeating its ok and I cannot group by creation_date because if I do so it will skip the points of project with id 600 and its wrong because id 600 is a different project and its only max points are 10 so it should be listed and its only possible if I do the grouping using project_id but then how should I also list creation_date

So far I am using this query to get MAX points of each project

SELECT     MAX(points) AS points, project_id
FROM         LogiCpsLogs AS LCL
WHERE     (writer_id = @writer_id) AND (DATENAME(mm, GETDATE()) = DATENAME(mm, creation_date)) AND (points <> 0)
GROUP BY project_id

This query brings the result of current month only but I would like to list creation_date as well. Please help.",sql,database,sql-server-2008,group-by,aggregate-functions,,open,0,251,4,"SQL Group By Problem I have a table that has 3 cols namely points, project_id and creation_date. every time points are assigned a new record has been made, for example.

points = 20 project_id = 441 creation_date = 04/02/2011 -> Is one record <br>
points = 10 project_id = 600 creation_date = 04/02/2011 -> Is another record <br>
points = 5 project_id = 441 creation_dae = 06/02/2011 -> Is final record

(creation_date is the date on which record is entered and it is achieved by setting the default value to GETDATE())

now the problem is I want to get MAX points grouped by project_id but I also want creation_date to appear with it so I can use it for another purpose, if creation date is repeating its ok and I cannot group by creation_date because if I do so it will skip the points of project with id 600 and its wrong because id 600 is a different project and its only max points are 10 so it should be listed and its only possible if I do the grouping using project_id but then how should I also list creation_date

So far I am using this query to get MAX points of each project

SELECT     MAX(points) AS points, project_id
FROM         LogiCpsLogs AS LCL
WHERE     (writer_id = @writer_id) AND (DATENAME(mm, GETDATE()) = DATENAME(mm, creation_date)) AND (points <> 0)
GROUP BY project_id

This query brings the result of current month only but I would like to list creation_date as well. Please help.",5
6709806,07/15/2011 15:54:23,226906,12/08/2009 06:05:22,460,11,Specify the column names in the select clause using a query,"I have an sql query where in I want to specify the names of the columns dynamically.

So let us say I have a table called TABLE_A and it has a column by name ID

I was wondering if I could do something like

     select (select 'ID' from dual) from TABLE_A

obviously this is not possible..

Is there a better way to this
",sql,oracle,oracle11g,,,,open,0,63,11,"Specify the column names in the select clause using a query I have an sql query where in I want to specify the names of the columns dynamically.

So let us say I have a table called TABLE_A and it has a column by name ID

I was wondering if I could do something like

     select (select 'ID' from dual) from TABLE_A

obviously this is not possible..

Is there a better way to this
",3
10775885,05/27/2012 17:25:04,1088172,12/08/2011 16:43:42,62,18,SELECT ORACLE WITH PARAMETERS,"I've been looking for the right answer how to select with parameters and execute it in VB.NET. Any codes will be so much appreciate , thank you very much ",sql,vb.net,oracle,,,05/28/2012 17:58:50,not a real question,1,30,4,"SELECT ORACLE WITH PARAMETERS I've been looking for the right answer how to select with parameters and execute it in VB.NET. Any codes will be so much appreciate , thank you very much ",3
8133562,11/15/2011 08:42:34,1047050,11/15/2011 07:28:36,1,0,How to execute .sql script in SQL Server 2005 Management Studio?,I have generated a .sql script by right clicking my database then Task then Generate Script. After generating the script I delete all the tables from my database & then open the .sql script & execute it. I don't get any errors by executing the script but the problem is that I don't see any tables in my database & its blank. What is the problem?,sql,,,,,11/15/2011 09:46:15,not constructive,1,66,11,How to execute .sql script in SQL Server 2005 Management Studio? I have generated a .sql script by right clicking my database then Task then Generate Script. After generating the script I delete all the tables from my database & then open the .sql script & execute it. I don't get any errors by executing the script but the problem is that I don't see any tables in my database & its blank. What is the problem?,1
11552502,07/19/2012 00:50:40,857083,07/22/2011 01:05:52,11,1,Extract size (numeric) from string,"I have column in a table with values stored as
HX CAP SCR GD5 1/2-13 X 3
HX CAP SCR GD8 1/2-13 X 4
HX CAP SCR Grade 5 1/2-13 X 5
HX CAP SCR Grade 8 1/2-13 X 6


Now, I need to store these values to another table like
CATEGORY               SIZE
HX CAP SCR GD5         1/2-13 X 3
HX CAP SCR GD8         1/2-13 X 4
HX CAP SCR Grade 5     1/2-13 X 5
HX CAP SCR Grade 8     1/2-13 X 6

Plz let me the Query how to do this....


",sql,sql-server,string,tsql,string-parsing,,open,0,119,5,"Extract size (numeric) from string I have column in a table with values stored as
HX CAP SCR GD5 1/2-13 X 3
HX CAP SCR GD8 1/2-13 X 4
HX CAP SCR Grade 5 1/2-13 X 5
HX CAP SCR Grade 8 1/2-13 X 6


Now, I need to store these values to another table like
CATEGORY               SIZE
HX CAP SCR GD5         1/2-13 X 3
HX CAP SCR GD8         1/2-13 X 4
HX CAP SCR Grade 5     1/2-13 X 5
HX CAP SCR Grade 8     1/2-13 X 6

Plz let me the Query how to do this....


",5
9372819,02/21/2012 05:49:33,1222629,02/21/2012 05:33:27,1,0,Who to Insert data into ODD/EVEN rows only in SQL,"I have one table with gender as one of the columns.
In gender column only M or F are allowed.
Now i want to sort the table so that while displaying the table in gender field M and F will come alternetivly.

I have Tried....
I have tried to create one(new) table with the same structure as my existing table.
Now using high leval insert i want to insert M to odd rows and F to even rows.
After that i want to join those two statements using union operator.
I am able to insert to  ( new ) the table only male or female but not to the even or odd rows...
Can any body help me regarding this....

Thanks in Advance....
 ",sql,,,,,,open,0,116,10,"Who to Insert data into ODD/EVEN rows only in SQL I have one table with gender as one of the columns.
In gender column only M or F are allowed.
Now i want to sort the table so that while displaying the table in gender field M and F will come alternetivly.

I have Tried....
I have tried to create one(new) table with the same structure as my existing table.
Now using high leval insert i want to insert M to odd rows and F to even rows.
After that i want to join those two statements using union operator.
I am able to insert to  ( new ) the table only male or female but not to the even or odd rows...
Can any body help me regarding this....

Thanks in Advance....
 ",1
6854609,07/28/2011 05:52:19,558261,12/30/2010 12:19:30,51,5,What is the diffrence between CLOB and NCLOB?,   Can you state any diffrence between the CLOB and NCLOB?,sql,oracle,lob,,,,open,0,13,8,What is the diffrence between CLOB and NCLOB?    Can you state any diffrence between the CLOB and NCLOB?,3
8098748,11/11/2011 19:10:48,1004164,10/19/2011 22:53:08,78,5,why some times create index on table takes long time?,"Hi i am using MSSQLSERVER 2008 
i am creating an NON ClUSTERED Index on it.
what i see while creating Index on it the query is taking a lot of time in my case now 8-9 mins is done but still create index query is running.
can somebody help me to get why it is so ?
",sql,sql-server-2005,sql-server-2008,,,11/13/2011 01:16:07,not a real question,1,55,10,"why some times create index on table takes long time? Hi i am using MSSQLSERVER 2008 
i am creating an NON ClUSTERED Index on it.
what i see while creating Index on it the query is taking a lot of time in my case now 8-9 mins is done but still create index query is running.
can somebody help me to get why it is so ?
",3
7890488,10/25/2011 14:03:18,774437,05/28/2011 15:20:55,36,0,How to perform a LEFT JOIN in MSSQL between two SELECT statement?,"I have two SELECT statements in MSSQL like these:

(SELECT [UserID] FROM [User])
(SELECT [TailUser], [Weight] FROM [Edge] WHERE [HeadUser] = 5043)

I want to perform a LEFT JOIN between these two SELECT statements on [UserID] attribute and [TailUser] attribute. I want to join existent records in second query with the corresponding records in first query and NULL value for absent records. How can I do this?",sql,sql-server-2008,relational-database,,,12/19/2011 14:38:55,too localized,1,64,12,"How to perform a LEFT JOIN in MSSQL between two SELECT statement? I have two SELECT statements in MSSQL like these:

(SELECT [UserID] FROM [User])
(SELECT [TailUser], [Weight] FROM [Edge] WHERE [HeadUser] = 5043)

I want to perform a LEFT JOIN between these two SELECT statements on [UserID] attribute and [TailUser] attribute. I want to join existent records in second query with the corresponding records in first query and NULL value for absent records. How can I do this?",3
3732980,09/17/2010 06:05:19,434203,08/29/2010 12:09:25,53,3,"SQL Server Agent stop, start, pause, restart buttons are all disabled","Can anyone know why all the buttons are disabled ?

I am trying to create a Job on SQL Server 2008 R2 Express.

Thanks.",sql,server,,,,,open,0,22,11,"SQL Server Agent stop, start, pause, restart buttons are all disabled Can anyone know why all the buttons are disabled ?

I am trying to create a Job on SQL Server 2008 R2 Express.

Thanks.",2
3354666,07/28/2010 15:44:54,404709,07/28/2010 15:35:44,1,0,MySQL: hourly average value,"I have a table with a 'timestamp' column and a 'value' column where the values are roughly 3 seconds apart.

I'm trying to return a table that has daily average values.

So, something like this is what i'm looking for.

| timestamp  | average |

| 2010-06-02 |  456.6  |

| 2010-06-03 |  589.4  |

| 2010-06-04 |  268.5  |

etc...

Any help on this would be greatly appreciated.",sql,mysql,database,,,,open,0,68,4,"MySQL: hourly average value I have a table with a 'timestamp' column and a 'value' column where the values are roughly 3 seconds apart.

I'm trying to return a table that has daily average values.

So, something like this is what i'm looking for.

| timestamp  | average |

| 2010-06-02 |  456.6  |

| 2010-06-03 |  589.4  |

| 2010-06-04 |  268.5  |

etc...

Any help on this would be greatly appreciated.",3
5255159,03/10/2011 03:34:55,631733,02/24/2011 05:51:44,83,1,Locking the database,"Hi I'm trying to see what's locking the database and found 2 types of locking. Optimistic and Pessimistic Locking. I found some articles on Wiki but I would like to know more ! Can someone explain me about those locking ? We should only use locking when we need exclusive access to something? Locking only happens when we use transaction? 
Thanks in advance.


Kevin",sql,database,performance,relational-database,,,open,0,63,3,"Locking the database Hi I'm trying to see what's locking the database and found 2 types of locking. Optimistic and Pessimistic Locking. I found some articles on Wiki but I would like to know more ! Can someone explain me about those locking ? We should only use locking when we need exclusive access to something? Locking only happens when we use transaction? 
Thanks in advance.


Kevin",4
7527426,09/23/2011 10:13:30,861019,07/25/2011 06:40:47,13,8,Listing data from 3 different but associated table into one dropdown (using linq-to-sql and mvc3),"i ve 3 tables in my database : `item`,`group`,`groupdetail`;

in table `item` there are 2 fields : `id`,`item_name` (bigint""long"",string)

in table `group` there are 2 fields : `id`,`group_name` (bigint,string)

in table `group_details` there are 3 fields : `id`,`group_id`,`item_id` (bigint,bigint,bigint)

`group_id` is nullable cause some items have no groups.

what i want to do is listing the names of groups where the items that has a group ""`group_name`"" ordered by `item_id` and also in the same list i wanna show the item names which has no group and both of them should be ordered by `item_id`

i can also fill dropdowns with jquery if required for this action but i'm brain freezed with listing part.

controller

     var data = from guru in dataContext.group_details select guru;
    
     var itemsWithoutGroup = data.Where(c => c.group_id == null).OrderBy(c => c.item_id).Where(c => c.item_id == c.item.id).Select( c=>c.item.item_name);
    
     var groups = data.Where(c => c.group_id != null).OrderBy(c => c.item_id).Where(c => c.group_id  == c.group.id).Select( c=>c.group.group_name);

     var grandlist = // i wanna do smt here to list both in one dropdown ordered by item_id
    

view

    @Html.DropDownList(""GroupDetails"", new SelectList((System.Collections.IEnumerable)ViewData[""GroupDetailedList""], ""id"", ""item_id""))


",sql,asp.net-mvc-3,linq-to-sql,drop-down-menu,,,open,0,202,15,"Listing data from 3 different but associated table into one dropdown (using linq-to-sql and mvc3) i ve 3 tables in my database : `item`,`group`,`groupdetail`;

in table `item` there are 2 fields : `id`,`item_name` (bigint""long"",string)

in table `group` there are 2 fields : `id`,`group_name` (bigint,string)

in table `group_details` there are 3 fields : `id`,`group_id`,`item_id` (bigint,bigint,bigint)

`group_id` is nullable cause some items have no groups.

what i want to do is listing the names of groups where the items that has a group ""`group_name`"" ordered by `item_id` and also in the same list i wanna show the item names which has no group and both of them should be ordered by `item_id`

i can also fill dropdowns with jquery if required for this action but i'm brain freezed with listing part.

controller

     var data = from guru in dataContext.group_details select guru;
    
     var itemsWithoutGroup = data.Where(c => c.group_id == null).OrderBy(c => c.item_id).Where(c => c.item_id == c.item.id).Select( c=>c.item.item_name);
    
     var groups = data.Where(c => c.group_id != null).OrderBy(c => c.item_id).Where(c => c.group_id  == c.group.id).Select( c=>c.group.group_name);

     var grandlist = // i wanna do smt here to list both in one dropdown ordered by item_id
    

view

    @Html.DropDownList(""GroupDetails"", new SelectList((System.Collections.IEnumerable)ViewData[""GroupDetailedList""], ""id"", ""item_id""))


",4
11657685,07/25/2012 20:01:05,1459148,06/15/2012 15:43:19,30,0,Indexing column used for order,"Lets say I have following query:

SELECT * FROM table WHERE id = 1 ORDER BY name.

Is it better to add multi-column index (id and name) or separate index for name?",sql,index,order-by,,,,open,0,30,5,"Indexing column used for order Lets say I have following query:

SELECT * FROM table WHERE id = 1 ORDER BY name.

Is it better to add multi-column index (id and name) or separate index for name?",3
3741401,09/18/2010 10:54:59,344960,05/19/2010 10:31:54,13,0,Please help me create sql statement for my tables?,"I have 2 tables(1.Employee 2.Family).
I want write a sql statement that produce the following output.

Pictures
 
    Url : http://www.enterupload.com/8ryuew2anq0q/QUESTION1.jpg.html

    Mirror 1 : http://www.freeimagehosting.net/image.php?c9bea5b6b6.png

    Mirror 2 : http://0k.010.img98.com/out.php/i342669_QUESTION1.png",sql,,,,,09/19/2010 00:21:13,not a real question,1,36,9,"Please help me create sql statement for my tables? I have 2 tables(1.Employee 2.Family).
I want write a sql statement that produce the following output.

Pictures
 
    Url : http://www.enterupload.com/8ryuew2anq0q/QUESTION1.jpg.html

    Mirror 1 : http://www.freeimagehosting.net/image.php?c9bea5b6b6.png

    Mirror 2 : http://0k.010.img98.com/out.php/i342669_QUESTION1.png",1
9030558,01/27/2012 08:16:04,1172912,01/27/2012 06:13:02,1,0,Insert query help needed,"I have two database say A and B ,A have a1 table having column names userid,pin_no and B database have b1 table having column names id,badge_no.I want to insert data from a1 to b1 
and b1 should be updates as a1 updates plz tell me query regarding this



  ",sql,,,,,01/27/2012 11:24:06,not a real question,1,50,4,"Insert query help needed I have two database say A and B ,A have a1 table having column names userid,pin_no and B database have b1 table having column names id,badge_no.I want to insert data from a1 to b1 
and b1 should be updates as a1 updates plz tell me query regarding this



  ",1
8669753,12/29/2011 15:30:53,1121444,12/29/2011 15:20:51,1,0,Scrape SQL database,"I'm working on a 600+ page website and need to transfer all the content to a Linux CMS. Currently the site is in ASP and uses a SQL database.
What is the best way to transfer all the content and images from one CMS to another. Keep in mind that I do not have any access to the current site (database, FTP, CMS) and probably will not get it from the other company.
Any suggestions are much appreciated ",sql,linux,content-management-system,transfer,scrape,12/29/2011 23:40:15,not a real question,1,77,3,"Scrape SQL database I'm working on a 600+ page website and need to transfer all the content to a Linux CMS. Currently the site is in ASP and uses a SQL database.
What is the best way to transfer all the content and images from one CMS to another. Keep in mind that I do not have any access to the current site (database, FTP, CMS) and probably will not get it from the other company.
Any suggestions are much appreciated ",5
3444197,08/09/2010 21:05:16,137639,07/13/2009 19:20:14,120,1,Multiple Havings not working,"I have a database with the following schema:

<pre>
ID   PositionId    LeagueId
1        4            5
3        4            5
3        8            5
4        1            6
</pre>
 
I have this sql query in Access:

     SELECT [lp.PositionId]
     FROM Leagues l 
     INNER JOIN Lineups lp ON (l.LeagueID = lp.LeagueId) 
     GROUP BY PositionId
     HAVING sum(iif(lp.PositionId = 4,1,0)) > 1 AND sum(iif(lp.PositionId = 8,1,0)) > 0

If I only use the left side of the Having, ie:

     HAVING sum(iif(lp.PositionId = 4,1,0)) > 1

I will get 1 results (LeagueId 5).  If I use the right-side of the Having, ie:

     HAVING sum(iif(lp.PositionId = 8,1,0)) > 0

I will also get one result (LeagueId 5), but both together (like above) yields no results.

",sql,ms-access,sum,having,iif-function,,open,0,213,4,"Multiple Havings not working I have a database with the following schema:

<pre>
ID   PositionId    LeagueId
1        4            5
3        4            5
3        8            5
4        1            6
</pre>
 
I have this sql query in Access:

     SELECT [lp.PositionId]
     FROM Leagues l 
     INNER JOIN Lineups lp ON (l.LeagueID = lp.LeagueId) 
     GROUP BY PositionId
     HAVING sum(iif(lp.PositionId = 4,1,0)) > 1 AND sum(iif(lp.PositionId = 8,1,0)) > 0

If I only use the left side of the Having, ie:

     HAVING sum(iif(lp.PositionId = 4,1,0)) > 1

I will get 1 results (LeagueId 5).  If I use the right-side of the Having, ie:

     HAVING sum(iif(lp.PositionId = 8,1,0)) > 0

I will also get one result (LeagueId 5), but both together (like above) yields no results.

",5
7485484,09/20/2011 12:54:29,923281,09/01/2011 10:26:50,1,0,& IN WHERE CLAUSE of oracle,"I HAD SQL QUERY RUNNING ON SQL DEVELOPER IDE:

SELECT IC.ID FROM INSTITUTE_COURSE IC WHERE IC.NAME = 'CIVIL & ARCHITECTURE CAD';

Due to & in where clause, ide returns an error ""Enter Substitution Variable"".

If I remove & in String, query runs fine.

 ",sql,oracle,,,,09/21/2011 01:39:20,not a real question,1,41,6,"& IN WHERE CLAUSE of oracle I HAD SQL QUERY RUNNING ON SQL DEVELOPER IDE:

SELECT IC.ID FROM INSTITUTE_COURSE IC WHERE IC.NAME = 'CIVIL & ARCHITECTURE CAD';

Due to & in where clause, ide returns an error ""Enter Substitution Variable"".

If I remove & in String, query runs fine.

 ",2
7894646,10/25/2011 19:21:16,994834,10/14/2011 06:04:55,1073,67,Why does a subquery cause a scan when a static list does not?,"I've got a query containing a subquery which always causes a SCAN of a very large table resulting in poor query times.

This is the query I'm using:

    SELECT PersonId FROM person WHERE PersonId IN (SELECT PersonId FROM relationship WHERE RelatedToPersonId=12270351721);

The query plan is reported as:

    SCAN TABLE person (~100000 rows)
    EXECUTE LIST SUBQUERY 1
    SEARCH TABLE relationship USING INDEX relationship_RelatedToPersonId_IDX (RelatedToPersonId=?) (~10 rows)

The same query with a static list (equivalent to the results of the subquery):

    SELECT PersonId FROM person WHERE PersonId IN (12270351727,12270351730,12270367969,12387741400);

And the query plan for that:

    SEARCH TABLE person USING COVERING INDEX sqlite_autoindex_person_1 (PersonId=?) (~5 rows)
    EXECUTE LIST SUBQUERY 1

Why would the first query prompt a scan if the second does not?",sql,sqlite,,,,,open,0,136,13,"Why does a subquery cause a scan when a static list does not? I've got a query containing a subquery which always causes a SCAN of a very large table resulting in poor query times.

This is the query I'm using:

    SELECT PersonId FROM person WHERE PersonId IN (SELECT PersonId FROM relationship WHERE RelatedToPersonId=12270351721);

The query plan is reported as:

    SCAN TABLE person (~100000 rows)
    EXECUTE LIST SUBQUERY 1
    SEARCH TABLE relationship USING INDEX relationship_RelatedToPersonId_IDX (RelatedToPersonId=?) (~10 rows)

The same query with a static list (equivalent to the results of the subquery):

    SELECT PersonId FROM person WHERE PersonId IN (12270351727,12270351730,12270367969,12387741400);

And the query plan for that:

    SEARCH TABLE person USING COVERING INDEX sqlite_autoindex_person_1 (PersonId=?) (~5 rows)
    EXECUTE LIST SUBQUERY 1

Why would the first query prompt a scan if the second does not?",2
3201432,07/08/2010 07:24:01,228755,12/10/2009 11:56:45,397,3,How to get time part from Sql Server 2005 datetime in HH:mm tt format ,"How to get time part from Sql Server 2005 datetime in HH:mm tt format 

**e.g. 11:25 AM**

**14:36 PM**",sql,sql-server-2005,t-sql,,,,open,0,18,15,"How to get time part from Sql Server 2005 datetime in HH:mm tt format  How to get time part from Sql Server 2005 datetime in HH:mm tt format 

**e.g. 11:25 AM**

**14:36 PM**",3
9203686,02/09/2012 00:17:02,1034912,11/08/2011 03:47:43,50,1,What's the disadvantage of using Microsoft SQL Server Jobs for Backup?,"I happen to find a lot of Automated SQL Backup Solutions on the net. two in particular are
- SQL Backup and FTP (http://sqlbackupandftp.com/)
- SQL Maintenance Solutions (http://ola.hallengren.com/)


My question, why do people use these solutions when SQL already has SQL Server Jobs Agent which can do this for them?
",sql,jobs,agent,,,02/09/2012 07:18:58,off topic,1,48,11,"What's the disadvantage of using Microsoft SQL Server Jobs for Backup? I happen to find a lot of Automated SQL Backup Solutions on the net. two in particular are
- SQL Backup and FTP (http://sqlbackupandftp.com/)
- SQL Maintenance Solutions (http://ola.hallengren.com/)


My question, why do people use these solutions when SQL already has SQL Server Jobs Agent which can do this for them?
",3
10176957,04/16/2012 15:21:28,1255188,03/07/2012 16:25:37,59,0,access Oracle sql server remotely,"Ok, so I started working on my machine locally but I still need to access the database on the remote server. I was using this...

> DriverManager.registerDriver(new OracleDriver());
> 
conn =  DriverManager.getConnection(""jdbc:oracle:thin:@dukeorrac01:1521:ORDB1"",""nrsc"",""nrsc"");

But that doesn't seem to be accessing a remote server. I assume I need some sort of IP address in there somewhere. I realize I should use a datasource but I didn't set all this up and I don't have time to learn how to implement that (will do that after this project).

How do I access that remotely?

P.S. I'm using jboss as my locally running server.

",sql,database,oracle,jboss,,,open,0,96,5,"access Oracle sql server remotely Ok, so I started working on my machine locally but I still need to access the database on the remote server. I was using this...

> DriverManager.registerDriver(new OracleDriver());
> 
conn =  DriverManager.getConnection(""jdbc:oracle:thin:@dukeorrac01:1521:ORDB1"",""nrsc"",""nrsc"");

But that doesn't seem to be accessing a remote server. I assume I need some sort of IP address in there somewhere. I realize I should use a datasource but I didn't set all this up and I don't have time to learn how to implement that (will do that after this project).

How do I access that remotely?

P.S. I'm using jboss as my locally running server.

",4
8434101,12/08/2011 16:19:03,956868,09/21/2011 11:50:39,76,0,Multiple conditions in sql?,"I want to select all rows from my database where the id is equal to either 1,6 or 7.

How can I specify multiple conditions in the query statement?",sql,,,,,12/08/2011 18:47:49,not a real question,1,28,4,"Multiple conditions in sql? I want to select all rows from my database where the id is equal to either 1,6 or 7.

How can I specify multiple conditions in the query statement?",1
353424,12/09/2008 16:42:05,23447,09/29/2008 13:43:02,50,1,List of source members in a file with SQL,"Is it possible to generate a list of all source members within an iSeries source file using SQL?

Might be similar to getting table definitions from SYSTABLES and SYSCOLUMNS, but I'm unable to find anything so far.",sql,ibm-midrange,,,,,open,0,36,9,"List of source members in a file with SQL Is it possible to generate a list of all source members within an iSeries source file using SQL?

Might be similar to getting table definitions from SYSTABLES and SYSCOLUMNS, but I'm unable to find anything so far.",2
3141861,06/29/2010 14:50:55,247184,01/09/2010 18:42:25,1580,156,SQL: CASE and selecting multiple COLUMS,"How can I do this: Based on the select Case below I want to show TWO separate columns within one WHEN?

The two lines below which are commented is what something I would like to have and I am sure it is something very simple I am missing....however i get syntax error

    select 
        person.FirstName,
        person.LastName,
        CASE 
            --WHEN substatus is not null then 'HasSubstatus', null
            --else null, 'DoesNotHaveSubstatus'
            WHEN substatus is not null then 'HasSubstatus'
            else null
        end
    from Person person",sql,mysql,query,sybase,,,open,0,159,6,"SQL: CASE and selecting multiple COLUMS How can I do this: Based on the select Case below I want to show TWO separate columns within one WHEN?

The two lines below which are commented is what something I would like to have and I am sure it is something very simple I am missing....however i get syntax error

    select 
        person.FirstName,
        person.LastName,
        CASE 
            --WHEN substatus is not null then 'HasSubstatus', null
            --else null, 'DoesNotHaveSubstatus'
            WHEN substatus is not null then 'HasSubstatus'
            else null
        end
    from Person person",4
5506807,03/31/2011 21:55:23,671435,03/22/2011 15:03:41,6,1,"JPA Hibernate : Help with classic Batching Insert values (...),(...),(...)","


I've read the forum/searched high and low but this will just not batch as I would expect.
In short I want Insert into timeseries values (...), (...), (...)  to batch up the insert into one statement.

Postgres 9.
Hibernate 3.4.0.
JPA 1.99

The entity has no relationships to other entities / collections, it is all by itself it is versioned, and uses GenerationType.SEQUENCE

Here is what the internet says should activate this feature.
            <property name=""hibernate.jdbc.batch_size"" value=""50""/>
            <property name=""hibernate.cache.use_query_cache"" value=""false""/>
            <property name=""hibernate.cache.use_second_level_cache"" value=""false""/>
            <property name=""hibernate.cache.use_structured_entries"" value=""true""/>
            <property name=""hibernate.jdbc.use_streams_for_binary"" value=""false""/>
            <property name=""hibernate.jdbc.batch_versioned_data"" value=""true""/>
            <property name=""hibernate.order_inserts"" value=""true""/>
            <property name=""hibernate.order_updates"" value=""true""/>

In Java, Inside my @Transactional, I call .merge on that type of entity and only that type. I've also tried calling persist, and disabling versioning… no luck… 
I note this in the logs: AbstractBatcher: - no batched statements to execute

Any help?

-------------

Here is some relevant debug trace… reduced for simplicity...


2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] AbstractSaveEventListener: - transient instance of: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] DefaultPersistEventListener: - saving transient instance
2011-03-31 14:20:37,414 DEBUG [pool-2-thread-3] AbstractSaveEventListener: - generated identifier: 188032722, using strategy: org.hibernate.id.SequenceHiLoGenerator
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] AbstractSaveEventListener: - saving [com.xxx.TimeSeriesEntity#188032722]
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] Versioning: - using initial version: 0
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - flushing session
2011-03-31 14:20:37,414 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - processing flush-time cascades
//snip

2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] Cascade: - processing cascade ACTION_PERSIST_ON_FLUSH for: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] Cascade: - done processing cascade ACTION_PERSIST_ON_FLUSH for: com.xxx.TimeSeriesEntity
//snip

2011-03-31 14:20:37,415 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - dirty checking collections
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - Flushing entities and processing referenced collections
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractEntityPersister: - com.xxx.TimeSeriesEntity.highestValidDataStartTime is dirty
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractEntityPersister: - com.xxx.TimeSeriesEntity.seriesEndTime is dirty
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractEntityPersister: - com.xxx.TimeSeriesEntity.seriesStartTime is dirty
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] DefaultFlushEntityEventListener: - Updating entity: [com.xxx.TimeSeriesEntity#188032673]
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] Versioning: - Incrementing: 0 to 1
//snip

2011-03-31 14:20:37,418 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - Processing unreferenced collections
2011-03-31 14:20:37,418 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - Scheduling collection removes/(re)creates/updates
2011-03-31 14:20:37,418 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - Flushed: 50 insertions, 50 updates, 0 deletions to 50 objects
2011-03-31 14:20:37,418 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - Flushed: 0 (re)creations, 0 updates, 0 removals to 0 collections
//snip

2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - executing flush
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] ConnectionManager: - registering flush begin
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Inserting entity: [com.xxx.TimeSeriesEntity#188032673]
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Version: 0
2011-03-31 14:20:37,419 DEBUG [pool-2-thread-3] AbstractBatcher: - about to open PreparedStatement (open PreparedStatements: 0, globally: 1)
2011-03-31 14:20:37,419 DEBUG [pool-2-thread-3] SQL: - insert into timeseries (calc_type, channel_id, counts, data_value, granularity, highest_valid_data_time, max_value, min_value, series_end_time, series_start_time, version, series_id) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractBatcher: - preparing statement
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Dehydrating entity: [com.xxx.TimeSeriesEntity#188032673]
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] LongType: - binding '52283' to parameter: 2
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] IntegerType: - binding '0' to parameter: 11
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] LongType: - binding '188032673' to parameter: 12
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Inserting entity: [com.xxx.TimeSeriesEntity#188032674]
2011-03-31 14:20:37,420 TRACE [pool-2-thread-3] AbstractEntityPersister: - Version: 0
2011-03-31 14:20:37,420 DEBUG [pool-2-thread-3] AbstractBatcher: - reusing prepared statement
2011-03-31 14:20:37,420 DEBUG [pool-2-thread-3] SQL: - insert into timeseries (calc_type, channel_id, counts, data_value, granularity, highest_valid_data_time, max_value, min_value, series_end_time, series_start_time, version, series_id) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
//snip

2011-03-31 14:20:37,478 DEBUG [pool-2-thread-3] AbstractBatcher: - Executing batch size: 50
2011-03-31 14:20:37,506 DEBUG [pool-2-thread-3] AbstractBatcher: - no batched statements to execute
2011-03-31 14:20:37,506 DEBUG [pool-2-thread-3] AbstractBatcher: - about to close PreparedStatement (open PreparedStatements: 1, globally: 2)
2011-03-31 14:20:37,506 TRACE [pool-2-thread-3] AbstractBatcher: - closing statement
2011-03-31 14:20:37,506 TRACE [pool-2-thread-3] ConnectionManager: - registering flush end
2011-03-31 14:20:37,506 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - post flush
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] VersionValue: - version unsaved-value strategy UNDEFINED
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] IdentifierValue: - id unsaved-value: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - transient instance of: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] DefaultPersistEventListener: - saving transient instance
2011-03-31 14:20:37,507 DEBUG [pool-2-thread-3] AbstractSaveEventListener: - generated identifier: 188032723, using strategy: org.hibernate.id.SequenceHiLoGenerator
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - saving [com.xxx.TimeSeriesEntity#188032723]
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] Versioning: - using initial version: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] VersionValue: - version unsaved-value strategy UNDEFINED
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] IdentifierValue: - id unsaved-value: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - transient instance of: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] DefaultPersistEventListener: - saving transient instance
2011-03-31 14:20:37,507 DEBUG [pool-2-thread-3] AbstractSaveEventListener: - generated identifier: 188032724, using strategy: org.hibernate.id.SequenceHiLoGenerator
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - saving [com.xxx.TimeSeriesEntity#188032724]
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] Versioning: - using initial version: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] VersionValue: - version unsaved-value strategy UNDEFINED
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] IdentifierValue: - id unsaved-value: 0





Here is the session factory init:

2011-03-31 14:16:17,521  INFO [SpringOsgiExtenderThread-46] InjectedDataSourceConnectionProvider: - Using provided datasource
2011-03-31 14:16:17,535  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - RDBMS: PostgreSQL, version: 9.0.2
2011-03-31 14:16:17,535  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC driver: PostgreSQL Native Driver, version: PostgreSQL 9.0 JDBC4 (build 801)
2011-03-31 14:16:17,560  INFO [SpringOsgiExtenderThread-46] Dialect: - Using dialect: org.hibernate.dialect.PostgreSQLDialect
2011-03-31 14:16:17,564  INFO [SpringOsgiExtenderThread-46] TransactionFactoryFactory: - Transaction strategy: org.hibernate.transaction.JDBCTransactionFactory
2011-03-31 14:16:17,564  INFO [SpringOsgiExtenderThread-46] TransactionManagerLookupFactory: - No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional second-level cache is not recommended)
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Automatic flush during beforeCompletion(): disabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Automatic session close at end of transaction: disabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC batch size: 50
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC batch updates for versioned data: enabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Scrollable result sets: enabled
2011-03-31 14:16:17,565 DEBUG [SpringOsgiExtenderThread-46] SettingsFactory: - Wrap result sets: disabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC3 getGeneratedKeys(): enabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Connection release mode: auto
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Default batch fetch size: 1
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Generate SQL with comments: disabled
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Order SQL updates by primary key: enabled
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Order SQL inserts for batching: enabled
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] ASTQueryTranslatorFactory: - Using ASTQueryTranslatorFactory
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Query language substitutions: {}
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JPA-QL strict compliance: enabled
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Second-level cache: disabled
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Query cache: disabled
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Cache region factory : org.hibernate.cache.impl.NoCachingRegionFactory
2011-03-31 14:16:17,568  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Optimize cache for minimal puts: disabled
2011-03-31 14:16:17,568  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Structured second-level cache entries: enabled
2011-03-31 14:16:17,568 TRACE [SpringOsgiExtenderThread-46] SQLExceptionConverterFactory: - Using dialect defined converter
2011-03-31 14:16:17,570  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Statistics: disabled
2011-03-31 14:16:17,570  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Deleted entity synthetic identifier rollback: disabled
2011-03-31 14:16:17,571  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Default entity-mode: pojo
2011-03-31 14:16:17,571  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Named query checking : enabled
2011-03-31 14:16:17,589  INFO [SpringOsgiExtenderThread-46] SessionFactoryImpl: - building session factory
2011-03-31 14:16:17,590 DEBUG [SpringOsgiExtenderThread-46] SessionFactoryImpl: - Session factory constructed with filter configurations : {}
",sql,hibernate,jpa,batch-processing,,,open,0,1160,10,"JPA Hibernate : Help with classic Batching Insert values (...),(...),(...) 


I've read the forum/searched high and low but this will just not batch as I would expect.
In short I want Insert into timeseries values (...), (...), (...)  to batch up the insert into one statement.

Postgres 9.
Hibernate 3.4.0.
JPA 1.99

The entity has no relationships to other entities / collections, it is all by itself it is versioned, and uses GenerationType.SEQUENCE

Here is what the internet says should activate this feature.
            <property name=""hibernate.jdbc.batch_size"" value=""50""/>
            <property name=""hibernate.cache.use_query_cache"" value=""false""/>
            <property name=""hibernate.cache.use_second_level_cache"" value=""false""/>
            <property name=""hibernate.cache.use_structured_entries"" value=""true""/>
            <property name=""hibernate.jdbc.use_streams_for_binary"" value=""false""/>
            <property name=""hibernate.jdbc.batch_versioned_data"" value=""true""/>
            <property name=""hibernate.order_inserts"" value=""true""/>
            <property name=""hibernate.order_updates"" value=""true""/>

In Java, Inside my @Transactional, I call .merge on that type of entity and only that type. I've also tried calling persist, and disabling versioning… no luck… 
I note this in the logs: AbstractBatcher: - no batched statements to execute

Any help?

-------------

Here is some relevant debug trace… reduced for simplicity...


2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] AbstractSaveEventListener: - transient instance of: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] DefaultPersistEventListener: - saving transient instance
2011-03-31 14:20:37,414 DEBUG [pool-2-thread-3] AbstractSaveEventListener: - generated identifier: 188032722, using strategy: org.hibernate.id.SequenceHiLoGenerator
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] AbstractSaveEventListener: - saving [com.xxx.TimeSeriesEntity#188032722]
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] Versioning: - using initial version: 0
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - flushing session
2011-03-31 14:20:37,414 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - processing flush-time cascades
//snip

2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] Cascade: - processing cascade ACTION_PERSIST_ON_FLUSH for: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,414 TRACE [pool-2-thread-3] Cascade: - done processing cascade ACTION_PERSIST_ON_FLUSH for: com.xxx.TimeSeriesEntity
//snip

2011-03-31 14:20:37,415 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - dirty checking collections
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - Flushing entities and processing referenced collections
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractEntityPersister: - com.xxx.TimeSeriesEntity.highestValidDataStartTime is dirty
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractEntityPersister: - com.xxx.TimeSeriesEntity.seriesEndTime is dirty
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] AbstractEntityPersister: - com.xxx.TimeSeriesEntity.seriesStartTime is dirty
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] DefaultFlushEntityEventListener: - Updating entity: [com.xxx.TimeSeriesEntity#188032673]
2011-03-31 14:20:37,415 TRACE [pool-2-thread-3] Versioning: - Incrementing: 0 to 1
//snip

2011-03-31 14:20:37,418 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - Processing unreferenced collections
2011-03-31 14:20:37,418 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - Scheduling collection removes/(re)creates/updates
2011-03-31 14:20:37,418 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - Flushed: 50 insertions, 50 updates, 0 deletions to 50 objects
2011-03-31 14:20:37,418 DEBUG [pool-2-thread-3] AbstractFlushingEventListener: - Flushed: 0 (re)creations, 0 updates, 0 removals to 0 collections
//snip

2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - executing flush
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] ConnectionManager: - registering flush begin
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Inserting entity: [com.xxx.TimeSeriesEntity#188032673]
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Version: 0
2011-03-31 14:20:37,419 DEBUG [pool-2-thread-3] AbstractBatcher: - about to open PreparedStatement (open PreparedStatements: 0, globally: 1)
2011-03-31 14:20:37,419 DEBUG [pool-2-thread-3] SQL: - insert into timeseries (calc_type, channel_id, counts, data_value, granularity, highest_valid_data_time, max_value, min_value, series_end_time, series_start_time, version, series_id) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractBatcher: - preparing statement
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Dehydrating entity: [com.xxx.TimeSeriesEntity#188032673]
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] LongType: - binding '52283' to parameter: 2
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] IntegerType: - binding '0' to parameter: 11
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] LongType: - binding '188032673' to parameter: 12
2011-03-31 14:20:37,419 TRACE [pool-2-thread-3] AbstractEntityPersister: - Inserting entity: [com.xxx.TimeSeriesEntity#188032674]
2011-03-31 14:20:37,420 TRACE [pool-2-thread-3] AbstractEntityPersister: - Version: 0
2011-03-31 14:20:37,420 DEBUG [pool-2-thread-3] AbstractBatcher: - reusing prepared statement
2011-03-31 14:20:37,420 DEBUG [pool-2-thread-3] SQL: - insert into timeseries (calc_type, channel_id, counts, data_value, granularity, highest_valid_data_time, max_value, min_value, series_end_time, series_start_time, version, series_id) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
//snip

2011-03-31 14:20:37,478 DEBUG [pool-2-thread-3] AbstractBatcher: - Executing batch size: 50
2011-03-31 14:20:37,506 DEBUG [pool-2-thread-3] AbstractBatcher: - no batched statements to execute
2011-03-31 14:20:37,506 DEBUG [pool-2-thread-3] AbstractBatcher: - about to close PreparedStatement (open PreparedStatements: 1, globally: 2)
2011-03-31 14:20:37,506 TRACE [pool-2-thread-3] AbstractBatcher: - closing statement
2011-03-31 14:20:37,506 TRACE [pool-2-thread-3] ConnectionManager: - registering flush end
2011-03-31 14:20:37,506 TRACE [pool-2-thread-3] AbstractFlushingEventListener: - post flush
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] VersionValue: - version unsaved-value strategy UNDEFINED
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] IdentifierValue: - id unsaved-value: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - transient instance of: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] DefaultPersistEventListener: - saving transient instance
2011-03-31 14:20:37,507 DEBUG [pool-2-thread-3] AbstractSaveEventListener: - generated identifier: 188032723, using strategy: org.hibernate.id.SequenceHiLoGenerator
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - saving [com.xxx.TimeSeriesEntity#188032723]
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] Versioning: - using initial version: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] VersionValue: - version unsaved-value strategy UNDEFINED
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] IdentifierValue: - id unsaved-value: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - transient instance of: com.xxx.TimeSeriesEntity
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] DefaultPersistEventListener: - saving transient instance
2011-03-31 14:20:37,507 DEBUG [pool-2-thread-3] AbstractSaveEventListener: - generated identifier: 188032724, using strategy: org.hibernate.id.SequenceHiLoGenerator
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] AbstractSaveEventListener: - saving [com.xxx.TimeSeriesEntity#188032724]
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] Versioning: - using initial version: 0
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] VersionValue: - version unsaved-value strategy UNDEFINED
2011-03-31 14:20:37,507 TRACE [pool-2-thread-3] IdentifierValue: - id unsaved-value: 0





Here is the session factory init:

2011-03-31 14:16:17,521  INFO [SpringOsgiExtenderThread-46] InjectedDataSourceConnectionProvider: - Using provided datasource
2011-03-31 14:16:17,535  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - RDBMS: PostgreSQL, version: 9.0.2
2011-03-31 14:16:17,535  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC driver: PostgreSQL Native Driver, version: PostgreSQL 9.0 JDBC4 (build 801)
2011-03-31 14:16:17,560  INFO [SpringOsgiExtenderThread-46] Dialect: - Using dialect: org.hibernate.dialect.PostgreSQLDialect
2011-03-31 14:16:17,564  INFO [SpringOsgiExtenderThread-46] TransactionFactoryFactory: - Transaction strategy: org.hibernate.transaction.JDBCTransactionFactory
2011-03-31 14:16:17,564  INFO [SpringOsgiExtenderThread-46] TransactionManagerLookupFactory: - No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional second-level cache is not recommended)
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Automatic flush during beforeCompletion(): disabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Automatic session close at end of transaction: disabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC batch size: 50
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC batch updates for versioned data: enabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Scrollable result sets: enabled
2011-03-31 14:16:17,565 DEBUG [SpringOsgiExtenderThread-46] SettingsFactory: - Wrap result sets: disabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JDBC3 getGeneratedKeys(): enabled
2011-03-31 14:16:17,565  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Connection release mode: auto
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Default batch fetch size: 1
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Generate SQL with comments: disabled
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Order SQL updates by primary key: enabled
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Order SQL inserts for batching: enabled
2011-03-31 14:16:17,566  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] ASTQueryTranslatorFactory: - Using ASTQueryTranslatorFactory
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Query language substitutions: {}
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - JPA-QL strict compliance: enabled
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Second-level cache: disabled
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Query cache: disabled
2011-03-31 14:16:17,567  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Cache region factory : org.hibernate.cache.impl.NoCachingRegionFactory
2011-03-31 14:16:17,568  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Optimize cache for minimal puts: disabled
2011-03-31 14:16:17,568  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Structured second-level cache entries: enabled
2011-03-31 14:16:17,568 TRACE [SpringOsgiExtenderThread-46] SQLExceptionConverterFactory: - Using dialect defined converter
2011-03-31 14:16:17,570  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Statistics: disabled
2011-03-31 14:16:17,570  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Deleted entity synthetic identifier rollback: disabled
2011-03-31 14:16:17,571  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Default entity-mode: pojo
2011-03-31 14:16:17,571  INFO [SpringOsgiExtenderThread-46] SettingsFactory: - Named query checking : enabled
2011-03-31 14:16:17,589  INFO [SpringOsgiExtenderThread-46] SessionFactoryImpl: - building session factory
2011-03-31 14:16:17,590 DEBUG [SpringOsgiExtenderThread-46] SessionFactoryImpl: - Session factory constructed with filter configurations : {}
",4
2405044,03/08/2010 21:50:39,12386,09/16/2008 14:11:53,527,28,Can I use SQL to update multiple rows with multiple values from another table?,"I've got a one to many table with ids and traits for those users.
I want to copy one user's settings to another.

    userid    trait    onoff
    ------    -----    -----
    1          1         on
    1          2         on
    1          3         on
    1          4         on
    2          1         off
    2          2         off
    2          3         off
    2          4         off

So I want to copy the onoff values from user 1 to 2, so that user2 has everything on when I'm done.

update table set onoff = (select onoff from table where userid=1) where userid=2

that's the basic idea, but obviously doesn't work. I imagine I want the server to think in terms of a correlated subquery, but the outer part isn't a query, it's an update.

Is this even possible in one step?
",sql,tips-and-tricks,,,,,open,0,300,14,"Can I use SQL to update multiple rows with multiple values from another table? I've got a one to many table with ids and traits for those users.
I want to copy one user's settings to another.

    userid    trait    onoff
    ------    -----    -----
    1          1         on
    1          2         on
    1          3         on
    1          4         on
    2          1         off
    2          2         off
    2          3         off
    2          4         off

So I want to copy the onoff values from user 1 to 2, so that user2 has everything on when I'm done.

update table set onoff = (select onoff from table where userid=1) where userid=2

that's the basic idea, but obviously doesn't work. I imagine I want the server to think in terms of a correlated subquery, but the outer part isn't a query, it's an update.

Is this even possible in one step?
",2
10098209,04/11/2012 00:11:26,1325349,04/10/2012 23:59:00,1,0,Need Advice on What I should learn for Summer Programming job,"So a friend of mine who did his undergrad in Comp Sci. got me a summer job for the university I attend as a computer science student (just finished my second year in undergrad). 

He told me that the job is basically working with databases using Microsoft access to ""clean them up/format them"" while they are doing something with them (sorry I'm still a little bit murky about what the job exactly is to be honest).

He said that it shouldn't be too challenging for me and that I will be working with access/sql/vba. I've never worked with any of these, so I want to go in with at least some idea of what I am doing. 

I start the job in about 3 weeks and I was wondering if somebody had any advice on books I should buy or what I should start to learn first (access,sql,vba)? 

Thank you.",sql,vba,access,,,04/11/2012 00:13:52,off topic,1,149,11,"Need Advice on What I should learn for Summer Programming job So a friend of mine who did his undergrad in Comp Sci. got me a summer job for the university I attend as a computer science student (just finished my second year in undergrad). 

He told me that the job is basically working with databases using Microsoft access to ""clean them up/format them"" while they are doing something with them (sorry I'm still a little bit murky about what the job exactly is to be honest).

He said that it shouldn't be too challenging for me and that I will be working with access/sql/vba. I've never worked with any of these, so I want to go in with at least some idea of what I am doing. 

I start the job in about 3 weeks and I was wondering if somebody had any advice on books I should buy or what I should start to learn first (access,sql,vba)? 

Thank you.",3
6841305,07/27/2011 08:13:50,191928,10/18/2009 06:35:19,1273,40,SQL cursor memory overhead,"I have an  stored procedure that works on an table that contains xml field, and use a cursor to loop over them and run some other sp's. The rows can be many and the documents quite large. There has been some signs of the stored choking under the load. 

I'm wondering if it's possible because how cursors work, perhaps using a cursor means it keep that whole result set in memory. I mentally somehow always imagine cursors like looping over a table while perhaps it's more like selecting data from a table, storing it in memory and then looping over it.  How does cursors work?


PS. Personally I hate cursors from both a performance and ideological standpoint (SQL should be set based) and avoid them like plague. This was a case of legacy code that I now have converted to use a temp table instead, but I'm still curious DS.",sql,cursor,,,,,open,0,151,4,"SQL cursor memory overhead I have an  stored procedure that works on an table that contains xml field, and use a cursor to loop over them and run some other sp's. The rows can be many and the documents quite large. There has been some signs of the stored choking under the load. 

I'm wondering if it's possible because how cursors work, perhaps using a cursor means it keep that whole result set in memory. I mentally somehow always imagine cursors like looping over a table while perhaps it's more like selecting data from a table, storing it in memory and then looping over it.  How does cursors work?


PS. Personally I hate cursors from both a performance and ideological standpoint (SQL should be set based) and avoid them like plague. This was a case of legacy code that I now have converted to use a temp table instead, but I'm still curious DS.",2
7827767,10/19/2011 20:34:23,267304,02/05/2010 18:02:25,703,3,Writing this SQL in Kohana query builder,"    SELECT users.*
    FROM users INNER JOIN roles_users ON users.id = roles_users.user_id 
    WHERE roles_users.role_id IN (1, 2)
    GROUP BY users.id
    HAVING COUNT(*) = 2


I came this far:


    DB::select()->from('users')->join('roles_users')
    ->on('users.id', '=', 'roles_users.user_id')
    ->where('roles_users.role_id', 'IN', array(1, 2))

How can i do GROUP BY and HAVING COUNT(*) in Kohana query builder?
",sql,query,kohana,,,,open,0,72,7,"Writing this SQL in Kohana query builder     SELECT users.*
    FROM users INNER JOIN roles_users ON users.id = roles_users.user_id 
    WHERE roles_users.role_id IN (1, 2)
    GROUP BY users.id
    HAVING COUNT(*) = 2


I came this far:


    DB::select()->from('users')->join('roles_users')
    ->on('users.id', '=', 'roles_users.user_id')
    ->where('roles_users.role_id', 'IN', array(1, 2))

How can i do GROUP BY and HAVING COUNT(*) in Kohana query builder?
",3
11105716,06/19/2012 16:56:29,1464357,06/18/2012 17:19:47,1,0,I want a report that shows percentage of employees that accepted bcoe per manager,"I want a report that shows percentage of employees that accepted business code of ethics,leave complience,end user device,electronic communicatio policy per manager.I want to create tables but still not sure which tables to create and sql code to run that report on oracle apex ",sql,,,,,06/19/2012 19:45:56,not a real question,1,45,14,"I want a report that shows percentage of employees that accepted bcoe per manager I want a report that shows percentage of employees that accepted business code of ethics,leave complience,end user device,electronic communicatio policy per manager.I want to create tables but still not sure which tables to create and sql code to run that report on oracle apex ",1
3967785,10/19/2010 11:21:59,306719,04/01/2010 08:57:51,93,1,build a sql words ,"<pre>
+----+--------------+------+--------+---------+---------------------+-----------
| Id | ip           | uri  | status | browser | time                |refer   ..........
+----+--------------+------+--------+---------+---------------------+-----------
int    varchar       varchar int     varchar   timeStampe            varchar  ..........
-------------------------------------------------------------------------------
</pre>

This is the structure of my table used to save the tomcat logs(pattern is combine) here.

Now I want to do some types of statistics,however I am not good at sql words,so I ask it here.

statistics type is:

1) query which pages are requested most at a same monment. Then I want to show them in a table.
2)query which files are requested most at a same monment. Then I want to show them in a table.
3)query from where (the refer )visitor jump to the site,sort the refers.",sql,analytics,,,,,open,0,160,5,"build a sql words  <pre>
+----+--------------+------+--------+---------+---------------------+-----------
| Id | ip           | uri  | status | browser | time                |refer   ..........
+----+--------------+------+--------+---------+---------------------+-----------
int    varchar       varchar int     varchar   timeStampe            varchar  ..........
-------------------------------------------------------------------------------
</pre>

This is the structure of my table used to save the tomcat logs(pattern is combine) here.

Now I want to do some types of statistics,however I am not good at sql words,so I ask it here.

statistics type is:

1) query which pages are requested most at a same monment. Then I want to show them in a table.
2)query which files are requested most at a same monment. Then I want to show them in a table.
3)query from where (the refer )visitor jump to the site,sort the refers.",2
8336591,12/01/2011 04:38:18,691138,04/04/2011 13:10:09,12,0,How to fix and convert sql union all to linq,"
I have two table:

    create table A			
    (
    	Id				uniqueidentifier primary key not null,
    	Success			int,
    	Failed			int,
    	CreatedOn		datetime default getdate() not null	
    )
    go
    
    create table B
    (
    	Id				uniqueidentifier primary key not null,
    	Email			varchar(150),	 
    	Mark			float,						 
    	CreatedOn		datetime default getdate() not null
    )
    go
    
    
    insert into A values(NEWID(), 3, 9, '2011-11-10 07:56:14.933')
    insert into A values(NEWID(), 8, 3, '2011-11-30 10:56:14.933')
    insert into A values(NEWID(), 2, 13, '2011-08-11 17:56:14.933')
    insert into A values(NEWID(), 22, 4, '2010-12-15 21:56:14.933')
    
    insert into B values(NEWID(),'Email 1', 9, '2011-10-10 07:56:14.933')
    insert into B values(NEWID(),'Email 2', 9, '2010-10-10 07:56:14.933')
    insert into B values(NEWID(),'Email 3', 9, '2009-10-10 07:56:14.933')
    insert into B values(NEWID(),'Email 4', 9, '2008-10-10 07:56:14.933')

Single statements:

    SELECT SUM(Success) as TotalSuccess, SUM(Failed) as TotalFailed
    FROM  Socker
    --WHERE CreatedOn = ? (1)
    GROUP BY MONTH(CreatedOn) -- (3)
    
    SELECT COUNT(*) as TotalEmail
    FROM Subscriber
    --WHERE CreatedOn = ? (2)
    GROUP BY MONTH(CreatedOn) -- (3)  

If you run two single commands successfully.
I have the following Transact SQL query using a UNION ALL to included two statements but error.

    SELECT  SUM(Success), SUM(Failed), TotalEmail, CreatedOn 
    FROM (SELECT  Success, Failed, 0 as TotalEmail, CreatedOn
              FROM A
             --WHERE CreatedOn = (1) 
             UNION ALL
            SELECT  0 as Success, 0 as Failed, COUNT(*) as TotalEmail, CreatedOn
              FROM B
             --WHERE CreatedOn = (2) 
             ) a
    GROUP BY MONTH(CreatedOn) -- (3)


(1), (2): if user select all years then not WHERE/ may be the year - month/all months - day/all day

(3): if user select all years then not GROUP BY/ if user selected year -> group by month, if user selected month -> group by day


How to fix and this would look in LINQ i.e some examples wouldbe nice or if anyone can recommend a good tutorial on UNION ALL in linq.

Thank you!",sql,asp.net-mvc,linq,union,group,,open,0,499,10,"How to fix and convert sql union all to linq 
I have two table:

    create table A			
    (
    	Id				uniqueidentifier primary key not null,
    	Success			int,
    	Failed			int,
    	CreatedOn		datetime default getdate() not null	
    )
    go
    
    create table B
    (
    	Id				uniqueidentifier primary key not null,
    	Email			varchar(150),	 
    	Mark			float,						 
    	CreatedOn		datetime default getdate() not null
    )
    go
    
    
    insert into A values(NEWID(), 3, 9, '2011-11-10 07:56:14.933')
    insert into A values(NEWID(), 8, 3, '2011-11-30 10:56:14.933')
    insert into A values(NEWID(), 2, 13, '2011-08-11 17:56:14.933')
    insert into A values(NEWID(), 22, 4, '2010-12-15 21:56:14.933')
    
    insert into B values(NEWID(),'Email 1', 9, '2011-10-10 07:56:14.933')
    insert into B values(NEWID(),'Email 2', 9, '2010-10-10 07:56:14.933')
    insert into B values(NEWID(),'Email 3', 9, '2009-10-10 07:56:14.933')
    insert into B values(NEWID(),'Email 4', 9, '2008-10-10 07:56:14.933')

Single statements:

    SELECT SUM(Success) as TotalSuccess, SUM(Failed) as TotalFailed
    FROM  Socker
    --WHERE CreatedOn = ? (1)
    GROUP BY MONTH(CreatedOn) -- (3)
    
    SELECT COUNT(*) as TotalEmail
    FROM Subscriber
    --WHERE CreatedOn = ? (2)
    GROUP BY MONTH(CreatedOn) -- (3)  

If you run two single commands successfully.
I have the following Transact SQL query using a UNION ALL to included two statements but error.

    SELECT  SUM(Success), SUM(Failed), TotalEmail, CreatedOn 
    FROM (SELECT  Success, Failed, 0 as TotalEmail, CreatedOn
              FROM A
             --WHERE CreatedOn = (1) 
             UNION ALL
            SELECT  0 as Success, 0 as Failed, COUNT(*) as TotalEmail, CreatedOn
              FROM B
             --WHERE CreatedOn = (2) 
             ) a
    GROUP BY MONTH(CreatedOn) -- (3)


(1), (2): if user select all years then not WHERE/ may be the year - month/all months - day/all day

(3): if user select all years then not GROUP BY/ if user selected year -> group by month, if user selected month -> group by day


How to fix and this would look in LINQ i.e some examples wouldbe nice or if anyone can recommend a good tutorial on UNION ALL in linq.

Thank you!",5
38680,09/02/2008 01:25:18,2515,08/22/2008 15:49:45,21,3,How to provide next page of updated content?,"Feel free to edit the title if you know how to formulate the question better. (Tagging is a problem as well.) The problem may be too difficult in this general form, so let us consider a concrete example.

You get a screenful of stackoverflow questions by requesting `/questions ?sort=newest` page. Next page link leads to `/questions?page=2 &sort=newest`. I suppose that at server side, the request is translated into an SQL query with LIMIT clause. Problem with this approach is, that if new question were added while user browses first page, his second page will start with some questions he already saw. (If he has 10 question per page, and 10 new questions happened to be added, he’ll get exactly the same content second time!)

Is there an elegant way to solve this common problem? I realize that it is not that big a problem, at least not for stackoverflow, but still.

The best idea I have (apart from storing request history per client) is to use `/questions?answer_id=NNN` format. Server returns a page that starts with the requested answer, and puts the id of the first answer on the next page into next page link. There must be a way to write SQL for that, right? 

Is it how it usually done? Or there is a better way?
",sql,stackoverflow,,,,,open,0,214,8,"How to provide next page of updated content? Feel free to edit the title if you know how to formulate the question better. (Tagging is a problem as well.) The problem may be too difficult in this general form, so let us consider a concrete example.

You get a screenful of stackoverflow questions by requesting `/questions ?sort=newest` page. Next page link leads to `/questions?page=2 &sort=newest`. I suppose that at server side, the request is translated into an SQL query with LIMIT clause. Problem with this approach is, that if new question were added while user browses first page, his second page will start with some questions he already saw. (If he has 10 question per page, and 10 new questions happened to be added, he’ll get exactly the same content second time!)

Is there an elegant way to solve this common problem? I realize that it is not that big a problem, at least not for stackoverflow, but still.

The best idea I have (apart from storing request history per client) is to use `/questions?answer_id=NNN` format. Server returns a page that starts with the requested answer, and puts the id of the first answer on the next page into next page link. There must be a way to write SQL for that, right? 

Is it how it usually done? Or there is a better way?
",2
7784049,10/16/2011 11:50:30,576205,01/14/2011 20:56:54,60,0,Changing a long query plan,"I have a 2 terabyte database.  I am trying to run a simple query against it but the amount of time it takes to run errors out.  When I run the query plan analyzer in Microsoft SQL Server 2008 R2 standard, the plan is hurrendous when compared to databases applied that are smaller in size.

What can I do to make the plan more efficient besides updating the database's statistics?",sql,sql-server,sql-server-2008,,,10/17/2011 06:07:44,not a real question,1,71,5,"Changing a long query plan I have a 2 terabyte database.  I am trying to run a simple query against it but the amount of time it takes to run errors out.  When I run the query plan analyzer in Microsoft SQL Server 2008 R2 standard, the plan is hurrendous when compared to databases applied that are smaller in size.

What can I do to make the plan more efficient besides updating the database's statistics?",3
7015179,08/10/2011 17:31:57,798183,06/14/2011 17:34:15,77,1,T-SQL Between statment,"I am writing a simply between statment.

    create table temp(mid int)
    insert into temp
    values
    (1),(2),(3),(4)
    select * from temp
    where mid between 4 and 1
    drop table temp

This outputs 1,2,3,4

However I want to use this statment in reverse (I am using this as a simple example in a harder problem) is there some way I can possibly wirte BETWEEN 4 and 1? If you try to execute this then an emptyt dataset will return",sql,between,,,,,open,0,96,3,"T-SQL Between statment I am writing a simply between statment.

    create table temp(mid int)
    insert into temp
    values
    (1),(2),(3),(4)
    select * from temp
    where mid between 4 and 1
    drop table temp

This outputs 1,2,3,4

However I want to use this statment in reverse (I am using this as a simple example in a harder problem) is there some way I can possibly wirte BETWEEN 4 and 1? If you try to execute this then an emptyt dataset will return",2
7360213,09/09/2011 10:20:39,835292,07/08/2011 11:47:50,117,3,Data synchronization between two database,"Ok this is what I want.

A web service runing on then net. It continuously gathers data from the net and stores it on the database. It also provides the data stored to the client on request. I want to keep a Repository of datas as object for fastest service

On the client side there is a windows service it call the web service and synchronization its local database to there server.

Web service has very small buffer limit. it can only transfer less then 200 records per shot.
this is not even good enough for data collected in a day.

Nope. You cant copy the database files. The database structure are very different and one is in sql and other is access. 



How do i use the repository for recent data update/or full database sync with this limitation. Given the data is being updated on a hourly baisis. And there will be huge data that will be needed to be trunsfer.

Sync by date or other group is not possible with the size limitation. Paging can be done but dont know how as the repository keeps changing, and how do i take chunk of data from the middle of table of sql database...

Sorry for the long histroy...but needed to be told....
Better ideas or Imporovement of this idea will be take as the right answere...

Thanks a  lot in advance...",sql,web-services,data,synchronization,windowservice,,open,0,224,5,"Data synchronization between two database Ok this is what I want.

A web service runing on then net. It continuously gathers data from the net and stores it on the database. It also provides the data stored to the client on request. I want to keep a Repository of datas as object for fastest service

On the client side there is a windows service it call the web service and synchronization its local database to there server.

Web service has very small buffer limit. it can only transfer less then 200 records per shot.
this is not even good enough for data collected in a day.

Nope. You cant copy the database files. The database structure are very different and one is in sql and other is access. 



How do i use the repository for recent data update/or full database sync with this limitation. Given the data is being updated on a hourly baisis. And there will be huge data that will be needed to be trunsfer.

Sync by date or other group is not possible with the size limitation. Paging can be done but dont know how as the repository keeps changing, and how do i take chunk of data from the middle of table of sql database...

Sorry for the long histroy...but needed to be told....
Better ideas or Imporovement of this idea will be take as the right answere...

Thanks a  lot in advance...",5
11026070,06/14/2012 02:58:23,1450017,06/11/2012 22:41:49,36,0,SQL Tough Queries,"Im trying to cram for an exam, and these are some of the toughest examples given

    Movie(title, year, director, budget, earnings)
    Actor(stagename, realname, birthyear)
    ActedIn(stagename, title, year, pay)
    CanWorkWith(stagename, director)

For each actor who acted in a movie in 2006, find their stage name and total pay in all
movies in which they have acted (i.e. including those not in 2006).

For each director who can work with at least 5 actors, find the total number of movies the
director has made in each year they have made a movie.",sql,,,,,06/14/2012 11:57:03,not a real question,1,98,3,"SQL Tough Queries Im trying to cram for an exam, and these are some of the toughest examples given

    Movie(title, year, director, budget, earnings)
    Actor(stagename, realname, birthyear)
    ActedIn(stagename, title, year, pay)
    CanWorkWith(stagename, director)

For each actor who acted in a movie in 2006, find their stage name and total pay in all
movies in which they have acted (i.e. including those not in 2006).

For each director who can work with at least 5 actors, find the total number of movies the
director has made in each year they have made a movie.",1
6460550,06/23/2011 21:00:27,813096,06/23/2011 21:00:27,1,0,selecting the top record in sql table,"I have a a table with date field and recordid field.
The recordid field has records like 10001 10002 11152 etc.. These id's are repeated as per the date field. 
I want to pick up each recordid once with the maximum date for that recordid.
",sql,query,max,,,,open,0,44,7,"selecting the top record in sql table I have a a table with date field and recordid field.
The recordid field has records like 10001 10002 11152 etc.. These id's are repeated as per the date field. 
I want to pick up each recordid once with the maximum date for that recordid.
",3
1207753,07/30/2009 16:31:53,80482,03/20/2009 13:59:12,876,45,Select most frequently occurring records using two or more grouping columns,"I have a table which has no primary key and I can't add one - the relevant columns from it are:

    Department   | Category  | 
    -------------+-----------+
    0001         | A         |
    0002         | D         |
    0003         | A         | 
    0003         | A         |
    0003         | C         |
    0004         | B         |

I want to retrieve a single row for each `Department`, which gives me the department code and the `Category` which appears most frequently in the table, i.e.

    Department   | Category  | 
    -------------+-----------+
    0001         | A         |
    0002         | D         |
    0003         | A         | 
    0004         | B         |

What is the best way to achieve this?  My current attempt involves a `Count(Category)` in a subquery from which the `Max(CountofCategory)` is then taken, but including the `Category` field at this stage means too many rows at returned (since `GROUP BY` is applied at `Category` level as well as `Department`).  In the case of a tie, I'd just select the min/max of the category arbitrarily.  Ideally this should be database-agnostic, but is likely to run on either Oracle or MySQL.",sql,,,,,,open,0,391,11,"Select most frequently occurring records using two or more grouping columns I have a table which has no primary key and I can't add one - the relevant columns from it are:

    Department   | Category  | 
    -------------+-----------+
    0001         | A         |
    0002         | D         |
    0003         | A         | 
    0003         | A         |
    0003         | C         |
    0004         | B         |

I want to retrieve a single row for each `Department`, which gives me the department code and the `Category` which appears most frequently in the table, i.e.

    Department   | Category  | 
    -------------+-----------+
    0001         | A         |
    0002         | D         |
    0003         | A         | 
    0004         | B         |

What is the best way to achieve this?  My current attempt involves a `Count(Category)` in a subquery from which the `Max(CountofCategory)` is then taken, but including the `Category` field at this stage means too many rows at returned (since `GROUP BY` is applied at `Category` level as well as `Department`).  In the case of a tie, I'd just select the min/max of the category arbitrarily.  Ideally this should be database-agnostic, but is likely to run on either Oracle or MySQL.",1
6740542,07/18/2011 23:17:32,541408,12/14/2010 03:17:08,146,5,Filtering Data from sql server,"I have a web page that returns over 36000 items from sql server and I need ideas to filter the data. So far my ideas are paging through letters and a text search box which uses the following sql - 

		select			O_ObjectID, 
					rtrim(O_Name) as O_Name
		from			A_Object
		where			O_Name like @NamePrefix + '%' OR O_Name like '% ' + @NamePrefix + '%'
		order by 		O_Name

So any thoughts in which I can filter data?",sql,vbscript,asp-classic,filtering,,,open,0,67,5,"Filtering Data from sql server I have a web page that returns over 36000 items from sql server and I need ideas to filter the data. So far my ideas are paging through letters and a text search box which uses the following sql - 

		select			O_ObjectID, 
					rtrim(O_Name) as O_Name
		from			A_Object
		where			O_Name like @NamePrefix + '%' OR O_Name like '% ' + @NamePrefix + '%'
		order by 		O_Name

So any thoughts in which I can filter data?",4
8271045,11/25/2011 15:15:13,1065878,11/25/2011 15:13:24,1,0,ORDER BY in VIEW returns diffrent results SQL,"This is my VIEW:

    USE [STD_DATABASE]
    
    
    IF (EXISTS (SELECT [name] FROM [sysobjects]
    	    WHERE (([name] = 'view_TransInvoice') AND ([type] = 'V'))))
    	DROP VIEW [STD_USER].[view_TransInvoice]
    GO
    
    
    CREATE VIEW [STD_USER].[view_TransInvoice]
    	
    AS
    
    SELECT TOP 999999 Customernr, Referensnr,'2' as a, InvoiceRowData, FileHead
    	FROM [STD_USER].[Transexport]
    	WHERE InvoiceRowData IS NOT NULL
    	UNION 
    SELECT TOP 999999 Customernr, Referensnr,'1' AS a , InvoiceHead , FileHead
    	FROM [STD_USER].[Transexport]
    	WHERE InvoiceHead IS NOT NULL
    	UNION 
    SELECT TOP 999999 Customernr, Referensnr,'3' AS a , InvoiceFoot , FileHead 
    	from [STD_USER].[Transexport]
    	WHERE InvoiceFoot IS NOT NULL
    	ORDER BY Customernr, Referensnr, 3
	
When I run it on the server (Microsoft SQL Server Standard Edition v. 8.00.2055) x64 I get the result that I want in the right order.
But when I run it on (Microsoft SQL Server Standard Edition v.10.50.1702.0) x86  I do not get the same result. It’s likes it ignores the ORDER BY statement when I run the VIEW. If I just run the SELECT statements I do on the other hand get the RIGHT result with the right order.
The databases are exactly the same and the scripts as well on both the servers.
Please help me!
",sql,view,order-by,,,,open,0,270,8,"ORDER BY in VIEW returns diffrent results SQL This is my VIEW:

    USE [STD_DATABASE]
    
    
    IF (EXISTS (SELECT [name] FROM [sysobjects]
    	    WHERE (([name] = 'view_TransInvoice') AND ([type] = 'V'))))
    	DROP VIEW [STD_USER].[view_TransInvoice]
    GO
    
    
    CREATE VIEW [STD_USER].[view_TransInvoice]
    	
    AS
    
    SELECT TOP 999999 Customernr, Referensnr,'2' as a, InvoiceRowData, FileHead
    	FROM [STD_USER].[Transexport]
    	WHERE InvoiceRowData IS NOT NULL
    	UNION 
    SELECT TOP 999999 Customernr, Referensnr,'1' AS a , InvoiceHead , FileHead
    	FROM [STD_USER].[Transexport]
    	WHERE InvoiceHead IS NOT NULL
    	UNION 
    SELECT TOP 999999 Customernr, Referensnr,'3' AS a , InvoiceFoot , FileHead 
    	from [STD_USER].[Transexport]
    	WHERE InvoiceFoot IS NOT NULL
    	ORDER BY Customernr, Referensnr, 3
	
When I run it on the server (Microsoft SQL Server Standard Edition v. 8.00.2055) x64 I get the result that I want in the right order.
But when I run it on (Microsoft SQL Server Standard Edition v.10.50.1702.0) x86  I do not get the same result. It’s likes it ignores the ORDER BY statement when I run the VIEW. If I just run the SELECT statements I do on the other hand get the RIGHT result with the right order.
The databases are exactly the same and the scripts as well on both the servers.
Please help me!
",3
11279782,07/01/2012 05:21:13,1409978,05/22/2012 10:46:25,39,2,Insert on two tables MS ACCESS,"Using javascript how can I insert data to the following tables:

    Table 1
    ID     Name     Civil Status



    Table 2
    ParentID    Civil Status


ID is an auto-number and when I insert data to table 1 I want the ID of table 1 to be the Parent ID of Table 2. ",sql,ms-access,,,,07/01/2012 14:22:21,not a real question,1,72,6,"Insert on two tables MS ACCESS Using javascript how can I insert data to the following tables:

    Table 1
    ID     Name     Civil Status



    Table 2
    ParentID    Civil Status


ID is an auto-number and when I insert data to table 1 I want the ID of table 1 to be the Parent ID of Table 2. ",2
7224862,08/28/2011 23:59:39,176338,11/27/2008 17:59:31,122,12,sql clr and complex business logic,"So I thought I had a perfect use-case for a CLR SQL Procedure.  I've search the Net for perhaps a simliar example where data is retrieved, lookups issued, and records added and changed.  I have not looked at a SQL CLR procedure for awhile, but since it was released in 2005 (some 6 years ago!) I would have hoped there were plenty of examples!

I'm considering it because I have to look at some data, react to it, and then get it back to the client.  My thinking here is to get as close to the DB as possible, and use that hardware to make it happen quickly.

Thoughts?",sql,clr,sqlclr,sql-clr,,08/29/2011 16:39:17,off topic,1,110,6,"sql clr and complex business logic So I thought I had a perfect use-case for a CLR SQL Procedure.  I've search the Net for perhaps a simliar example where data is retrieved, lookups issued, and records added and changed.  I have not looked at a SQL CLR procedure for awhile, but since it was released in 2005 (some 6 years ago!) I would have hoped there were plenty of examples!

I'm considering it because I have to look at some data, react to it, and then get it back to the client.  My thinking here is to get as close to the DB as possible, and use that hardware to make it happen quickly.

Thoughts?",4
3005973,06/09/2010 13:01:57,357849,06/03/2010 19:29:39,13,0,What is the purpose of ROWLOCK on Delete and when should I use it?,"Ex)

When should I use this statement:

DELETE TOP (@count)
FROM ProductInfo WITH (ROWLOCK)
WHERE ProductId = @productId_for_del;

And when should be just doing:

DELETE TOP (@count)
FROM ProductInfo
WHERE ProductId = @productId_for_del;",sql,,,,,,open,0,25,14,"What is the purpose of ROWLOCK on Delete and when should I use it? Ex)

When should I use this statement:

DELETE TOP (@count)
FROM ProductInfo WITH (ROWLOCK)
WHERE ProductId = @productId_for_del;

And when should be just doing:

DELETE TOP (@count)
FROM ProductInfo
WHERE ProductId = @productId_for_del;",1
10687136,05/21/2012 14:25:44,285109,12/31/2009 19:13:01,674,0,an issue on different Microsoft SQL-related softwares,"I am planning to learn Microsoft SQL server, and try to download the SQL software. However, I found a list of SQL-related softwares under the download banner.

> Microsoft SQL Server 2012 Business Intelligence 32/64-bit (English) – DreamSpark

> Microsoft SQL Server 2012 Developer 32/64-bit (English) - DreamSpark 

>  Microsoft SQL Server 2012 Enterprise 32/64-bit (English) - DreamSpark 

>  Microsoft SQL Server 2012 Enterprise Core Edition 32/64-bit (English) - DreamSpark 

>  Microsoft SQL Server 2012 Express 32/64-bit WoW (English) - DreamSpark 

>  Microsoft SQL Server 2012 Express 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Express Management Studio 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Express with Advanced Services 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Express with Tools 64-bit (English) – DreamSpark

> Microsoft SQL Server 2012 SQLLocalDB 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Standard 32/64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Web 32/64-bit (English) - DreamSpark

I am totally lost about the difference among these different packages, and which one/ones should I download? Thanks.",sql,sql-server,sql-server-2008,microsoft,,05/21/2012 14:38:53,off topic,1,176,7,"an issue on different Microsoft SQL-related softwares I am planning to learn Microsoft SQL server, and try to download the SQL software. However, I found a list of SQL-related softwares under the download banner.

> Microsoft SQL Server 2012 Business Intelligence 32/64-bit (English) – DreamSpark

> Microsoft SQL Server 2012 Developer 32/64-bit (English) - DreamSpark 

>  Microsoft SQL Server 2012 Enterprise 32/64-bit (English) - DreamSpark 

>  Microsoft SQL Server 2012 Enterprise Core Edition 32/64-bit (English) - DreamSpark 

>  Microsoft SQL Server 2012 Express 32/64-bit WoW (English) - DreamSpark 

>  Microsoft SQL Server 2012 Express 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Express Management Studio 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Express with Advanced Services 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Express with Tools 64-bit (English) – DreamSpark

> Microsoft SQL Server 2012 SQLLocalDB 64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Standard 32/64-bit (English) - DreamSpark 

> Microsoft SQL Server 2012 Web 32/64-bit (English) - DreamSpark

I am totally lost about the difference among these different packages, and which one/ones should I download? Thanks.",4
6856048,07/28/2011 08:27:25,431620,08/26/2010 08:36:28,642,31,"Beginning Oracle, PL/SQL Programming?","I have spent a few years doing more functional programming (and concurrent programming) than Object oriented. I  have so been glued to <code><b><a href=""http://en.wikipedia.org/wiki/Mnesia"">Mnesia DBMS</a></b></code> which comes bundled in the <b><a href=""http://erlang.org/"">Erlang/OTP System from Ericsson</a></b>.<br><br> Also, we have used <b><a href=""http://www.mysql.com/cluster/"">MySQL Cluster Storage</a></b> for handling Large Data sets behind Mnesia Nodes which handle temporary, live information. The architectures we have in place are so far stable. However, in a recent project, suggestions of kicking in Oracle were common place because of its stability and massive support. Oracles product, Times Ten In-Memory Database is being used too, in building Telecom systems. Erlang/OTP works very well with MySQL and MySQL Cluster Products because it provides ODBC libraries and numerous sql drivers.<br>
Mnesia does create In Memory Databases that are efficient. Recently, i downloaded and installed <code>Oracle Times Ten In-Memory Database</code>. Now basing on that simple introduction, here the main body comes...<br><br>In the recent project we have worked on, we used mnesia for holding distributed session data in Main Memory. Mnesia's performance is good so far, but our users are increasing in number. In the future, we may need to have several options for in-Memory Storage. We may also need to compare the performance of our existing solution with the one that Oracle Times Ten may give to us. I would like to see and experiment with the performance of Oracle Times Ten, so that in a future project i can make informed decisions based on an experience of the two DBMS. <br><br>I have it running and i would like to get started with <code>PL/SQL</code>, its Query Language. Where would an Oracle newbie start from, especially concerning the selection of database (11g, 10g, 9i, e.t.c.) and PL/SQL in particular? Any sites, pdfs, tutorials for a PL/SQL beginner will be very helpful. Also, provide some highlights on the several options of accessing data (writing, reading, updating and deleting) with Oracle databases from different application memory space (Database Connections, Pipes e.t.c), in general (basing on my Mnesia and MySQL background)<br><br> thanks in advance",sql,web-development,oracle,server,plsql,07/28/2011 13:54:20,not constructive,1,338,4,"Beginning Oracle, PL/SQL Programming? I have spent a few years doing more functional programming (and concurrent programming) than Object oriented. I  have so been glued to <code><b><a href=""http://en.wikipedia.org/wiki/Mnesia"">Mnesia DBMS</a></b></code> which comes bundled in the <b><a href=""http://erlang.org/"">Erlang/OTP System from Ericsson</a></b>.<br><br> Also, we have used <b><a href=""http://www.mysql.com/cluster/"">MySQL Cluster Storage</a></b> for handling Large Data sets behind Mnesia Nodes which handle temporary, live information. The architectures we have in place are so far stable. However, in a recent project, suggestions of kicking in Oracle were common place because of its stability and massive support. Oracles product, Times Ten In-Memory Database is being used too, in building Telecom systems. Erlang/OTP works very well with MySQL and MySQL Cluster Products because it provides ODBC libraries and numerous sql drivers.<br>
Mnesia does create In Memory Databases that are efficient. Recently, i downloaded and installed <code>Oracle Times Ten In-Memory Database</code>. Now basing on that simple introduction, here the main body comes...<br><br>In the recent project we have worked on, we used mnesia for holding distributed session data in Main Memory. Mnesia's performance is good so far, but our users are increasing in number. In the future, we may need to have several options for in-Memory Storage. We may also need to compare the performance of our existing solution with the one that Oracle Times Ten may give to us. I would like to see and experiment with the performance of Oracle Times Ten, so that in a future project i can make informed decisions based on an experience of the two DBMS. <br><br>I have it running and i would like to get started with <code>PL/SQL</code>, its Query Language. Where would an Oracle newbie start from, especially concerning the selection of database (11g, 10g, 9i, e.t.c.) and PL/SQL in particular? Any sites, pdfs, tutorials for a PL/SQL beginner will be very helpful. Also, provide some highlights on the several options of accessing data (writing, reading, updating and deleting) with Oracle databases from different application memory space (Database Connections, Pipes e.t.c), in general (basing on my Mnesia and MySQL background)<br><br> thanks in advance",5
11483215,07/14/2012 11:01:22,958429,09/22/2011 06:35:10,180,1,SQL Query must return rows from Product Master and 2 other tables,"I've got 3 tables:

1)ProductMaster

2)SalesTY (Sales This Year)

3)SalesLY (Sales Last Year)

I'm trying to create a query which will return all the rows from the ProductMaster and then the sales from this year and then the sales from last year.  The problem is some products from this year is new and some products from last year is not available anymore, but I've got to list all the prodcuts, so it must look like this:

**Product  -  TY   -      LY**

aaaa   -    1000    -   0

bbbb   -    0   -       1000

    select 
    i.Product
    ,b1.TrnMonth
    ,b1.TrnYear
    ,b1.TY
    ,b2.LY
    from Productmaster i
    left join #ty b1
    on i.Product= b1.Product
    left join #ly b2
    on i.Product= b2.Product
    Group by i.Product
    ,b1.TrnMonth
    ,b1.TrnYear

",sql,,,,,,open,0,188,12,"SQL Query must return rows from Product Master and 2 other tables I've got 3 tables:

1)ProductMaster

2)SalesTY (Sales This Year)

3)SalesLY (Sales Last Year)

I'm trying to create a query which will return all the rows from the ProductMaster and then the sales from this year and then the sales from last year.  The problem is some products from this year is new and some products from last year is not available anymore, but I've got to list all the prodcuts, so it must look like this:

**Product  -  TY   -      LY**

aaaa   -    1000    -   0

bbbb   -    0   -       1000

    select 
    i.Product
    ,b1.TrnMonth
    ,b1.TrnYear
    ,b1.TY
    ,b2.LY
    from Productmaster i
    left join #ty b1
    on i.Product= b1.Product
    left join #ly b2
    on i.Product= b2.Product
    Group by i.Product
    ,b1.TrnMonth
    ,b1.TrnYear

",1
6046554,05/18/2011 14:41:06,157949,08/17/2009 18:57:17,180,3,How does SQL choose which row to show when grouping multiple rows together?,"Consider the following table:

    CREATE TABLE t
    (
     a INTEGER NOT NULL,
     b INTEGER NOT NULL,
     c INTEGER,
     PRIMARY KEY (a, b)
    )

Now if I do this:

    SELECT a,b,c FROM t GROUP BY a;

I expect to have get each distinct value of a only once. But since I'm asking for b and c as well, it's going to give me a row for every value of a. Therefor, if, for a single value of a, there are many rows to choose from, how can I predict which row SQL will choose? My tests show that it chooses to return the row for which b is the greatest. But what is the logic in that? How would this apply to strings of blobs or dates or anything else?

My question: How does SQL choose which row to show when grouping multiple rows together?

btw: My particular problem concerns SQLITE3, but I'm guessing this is an SQL issue not dependent of the DBMS...",sql,group-by,,,,,open,0,187,13,"How does SQL choose which row to show when grouping multiple rows together? Consider the following table:

    CREATE TABLE t
    (
     a INTEGER NOT NULL,
     b INTEGER NOT NULL,
     c INTEGER,
     PRIMARY KEY (a, b)
    )

Now if I do this:

    SELECT a,b,c FROM t GROUP BY a;

I expect to have get each distinct value of a only once. But since I'm asking for b and c as well, it's going to give me a row for every value of a. Therefor, if, for a single value of a, there are many rows to choose from, how can I predict which row SQL will choose? My tests show that it chooses to return the row for which b is the greatest. But what is the logic in that? How would this apply to strings of blobs or dates or anything else?

My question: How does SQL choose which row to show when grouping multiple rows together?

btw: My particular problem concerns SQLITE3, but I'm guessing this is an SQL issue not dependent of the DBMS...",2
9965180,04/01/2012 14:34:52,1306403,04/01/2012 14:31:44,1,0,SQL statement syntax of What item has the best profit,"how do I write this SQL statement in SQL server 2008? 

""What item has the best profit?""",sql,,,,,04/01/2012 15:58:16,not a real question,1,17,10,"SQL statement syntax of What item has the best profit how do I write this SQL statement in SQL server 2008? 

""What item has the best profit?""",1
8484572,12/13/2011 05:03:47,570715,01/11/2011 03:12:13,33,0,DB Backup/Restore methods,"we have two servers - one production and one backup. Every night we take backup of production DB and restore on back up server. they both are identical in terms of configuration and hardware. when we run simple query on backup server it is faster where as same query is slower on production server.

Any ideas??
",sql,sql-server-2008,,,,12/13/2011 11:48:07,not a real question,1,55,3,"DB Backup/Restore methods we have two servers - one production and one backup. Every night we take backup of production DB and restore on back up server. they both are identical in terms of configuration and hardware. when we run simple query on backup server it is faster where as same query is slower on production server.

Any ideas??
",2
6093055,05/23/2011 05:07:17,126597,06/21/2009 23:19:57,647,24,Working out what application is changing an sql database value,"I'm running into an issue where the legacy database that many applications read/write to keeps getting changed, and I can't work out what is changing it.

My application changes a certain value in a certain row of the table, but something keeps changing it back after a week or so and I'm stumped to work out what it could be.

Is there any way I can attach an event/trigger onto this value and then have it store/email the details of what changed it ? or at least what time it was changed? ",sql,sql-server,triggers,,,,open,0,91,10,"Working out what application is changing an sql database value I'm running into an issue where the legacy database that many applications read/write to keeps getting changed, and I can't work out what is changing it.

My application changes a certain value in a certain row of the table, but something keeps changing it back after a week or so and I'm stumped to work out what it could be.

Is there any way I can attach an event/trigger onto this value and then have it store/email the details of what changed it ? or at least what time it was changed? ",3
10968124,06/10/2012 11:00:06,1447235,06/10/2012 10:53:04,1,0,My Project Is GOnna Due Soon.How to query the XML node stored on database using SQL?,"Im new to SQL n XML. My project is due after 2 days. I need your help.

i wish to perform like below.

    enter code here

<RCA>

<SUB_PROBLEM_TYPE>``
Bla bla bla . . .
</SUB_PROBLEM_TYPE>

<SUB_ROOT_CAUSE>
Bla bla bla . . .
</SUB_ROOT_CAUSE>

<ELABORATION>
Bla bla bla. . . .
</ELABORATION>

<PREVENTION>
Bla bla bla. . . . 
</PREVENTION>

</RCA>



I wish to generate in my html form like..


**PREVENTION: bla bla bla. . . **

Is there any simple way to query out ?

",sql,xml,,,,06/10/2012 17:06:07,not a real question,1,71,16,"My Project Is GOnna Due Soon.How to query the XML node stored on database using SQL? Im new to SQL n XML. My project is due after 2 days. I need your help.

i wish to perform like below.

    enter code here

<RCA>

<SUB_PROBLEM_TYPE>``
Bla bla bla . . .
</SUB_PROBLEM_TYPE>

<SUB_ROOT_CAUSE>
Bla bla bla . . .
</SUB_ROOT_CAUSE>

<ELABORATION>
Bla bla bla. . . .
</ELABORATION>

<PREVENTION>
Bla bla bla. . . . 
</PREVENTION>

</RCA>



I wish to generate in my html form like..


**PREVENTION: bla bla bla. . . **

Is there any simple way to query out ?

",2
436023,01/12/2009 16:38:40,38522,11/18/2008 10:18:37,840,34,"SQL INSERT, Force Truncate Field","I have input data containing some ""rogue"" fields that are longer than the corresponding database field. This causes my import script, which uses SQL INSERT statements to fall over with a warning:

    Msg 8152, Level 16, State 13, Line 2
    String or binary data would be truncated.

How can I force truncation of these fields and enable my script to complete?",sql,sql-server,,,,,open,0,66,5,"SQL INSERT, Force Truncate Field I have input data containing some ""rogue"" fields that are longer than the corresponding database field. This causes my import script, which uses SQL INSERT statements to fall over with a warning:

    Msg 8152, Level 16, State 13, Line 2
    String or binary data would be truncated.

How can I force truncation of these fields and enable my script to complete?",2
10030077,04/05/2012 14:01:05,1039764,11/10/2011 12:44:19,1,0,How I can write the following stored procedure?,"I have four tables in database. person(Perid ,firstname , lastname , gender), Research (Resid , Resname ,stareddate) ,person_research(Resid , Perid , others),Supervisors (Resid , Supervisorid , others)
I want to write stored procedure that returns each Research and Researcher Name and Supervisor Names  for put the results in datagridview
can anyone help me
",sql,stored-procedures,,,,04/06/2012 10:56:40,not a real question,1,52,8,"How I can write the following stored procedure? I have four tables in database. person(Perid ,firstname , lastname , gender), Research (Resid , Resname ,stareddate) ,person_research(Resid , Perid , others),Supervisors (Resid , Supervisorid , others)
I want to write stored procedure that returns each Research and Researcher Name and Supervisor Names  for put the results in datagridview
can anyone help me
",2
1722169,11/12/2009 13:27:26,209578,11/12/2009 13:00:17,1,0,Should you use temporary tables to pass data between stored procedures?,"I have a number of search functions (stored procedures) which need to return results with exactly the same columns.  

This is the approach that was taken:

Each stored procedure had the general structure:

<code>
    CREATE TABLE #searchTmp (CustomerID uniqueIdentifier)

    INSERT INTO #searchTmp
    SELECT	C.CustomerID FROM **** do actual search here, based on stored proc arguments ****

    EXEC spSearchResults

    DROP TABLE #searchTmp
</code>

In the above, spSearchResults use the #searchTmp table in a select.  spSearchResults would always return a table with the same columns, and had quite a few joins.

However, rather than use a temporary table, is the following approach more acceptable:

<code>
    SELECT col1, col2, col3, col4, .... etc, lots of columns ...
    FROM table1 LEFT JOIN table 2 ON ... etc, lots of joins ...
    WHERE ... DO ACTUAL SEARCH HERE ...
</code>


If there are 10 different searches to do (eg. search for a customer based on postcode, one search based on surname etc.), this second approach means there is lots of duplication of columns and joins specified. If the code that uses the search functions changes such that a new column is needed to be returned, there's then 10 stored procedures that need to be updated.

I'm all in favour of the first method, but i just wondered what benefits the second method gives.  Performance? 

Or is there a third method?",sql,performance,temporary-tables,,,,open,0,242,11,"Should you use temporary tables to pass data between stored procedures? I have a number of search functions (stored procedures) which need to return results with exactly the same columns.  

This is the approach that was taken:

Each stored procedure had the general structure:

<code>
    CREATE TABLE #searchTmp (CustomerID uniqueIdentifier)

    INSERT INTO #searchTmp
    SELECT	C.CustomerID FROM **** do actual search here, based on stored proc arguments ****

    EXEC spSearchResults

    DROP TABLE #searchTmp
</code>

In the above, spSearchResults use the #searchTmp table in a select.  spSearchResults would always return a table with the same columns, and had quite a few joins.

However, rather than use a temporary table, is the following approach more acceptable:

<code>
    SELECT col1, col2, col3, col4, .... etc, lots of columns ...
    FROM table1 LEFT JOIN table 2 ON ... etc, lots of joins ...
    WHERE ... DO ACTUAL SEARCH HERE ...
</code>


If there are 10 different searches to do (eg. search for a customer based on postcode, one search based on surname etc.), this second approach means there is lots of duplication of columns and joins specified. If the code that uses the search functions changes such that a new column is needed to be returned, there's then 10 stored procedures that need to be updated.

I'm all in favour of the first method, but i just wondered what benefits the second method gives.  Performance? 

Or is there a third method?",3
3085168,06/21/2010 13:46:40,158689,08/18/2009 18:10:04,173,10,How and why combination of JOIN and subquery affects GROUP BY behavior in MySQL query?,"I have 3 sql tables: Data36 (Data_ID:int, type:int), Data38(Data_ID:int, clientId:int), Data47(Data_ID:int, payerID:int).

I thought the following queries are identical, because I don't use aggregate functions here and GROUP BY should behave the same way as DISTINCT. But they return very different result sets and I don't understand why. Please help me to understand defference between these queries.

Query 1 (returns 153 rows):

 SELECT payer.Data_ID, payer.type
 FROM Data36 AS payer
 JOIN Data38 AS serv ON payer.Data_ID = serv.clientId
 WHERE ((SELECT count(*) FROM Data47 AS regsites WHERE regsites.payerID = payer.Data_ID) = 0)
 GROUP BY payer.Data_ID

Query 2 (returns 4744 rows):

 SELECT DISTINCT payer.Data_ID, payer.type
 FROM Data36 AS payer
 JOIN Data38 AS serv ON payer.Data_ID = serv.clientId
 WHERE ((SELECT count(*) FROM Data47 AS regsites WHERE regsites.payerID = payer.Data_ID) = 0)

*SQL Server version is 5.0.40.*

Let me know if you need more specific information.",sql,mysql,mysql-query,join,group-by,,open,0,136,15,"How and why combination of JOIN and subquery affects GROUP BY behavior in MySQL query? I have 3 sql tables: Data36 (Data_ID:int, type:int), Data38(Data_ID:int, clientId:int), Data47(Data_ID:int, payerID:int).

I thought the following queries are identical, because I don't use aggregate functions here and GROUP BY should behave the same way as DISTINCT. But they return very different result sets and I don't understand why. Please help me to understand defference between these queries.

Query 1 (returns 153 rows):

 SELECT payer.Data_ID, payer.type
 FROM Data36 AS payer
 JOIN Data38 AS serv ON payer.Data_ID = serv.clientId
 WHERE ((SELECT count(*) FROM Data47 AS regsites WHERE regsites.payerID = payer.Data_ID) = 0)
 GROUP BY payer.Data_ID

Query 2 (returns 4744 rows):

 SELECT DISTINCT payer.Data_ID, payer.type
 FROM Data36 AS payer
 JOIN Data38 AS serv ON payer.Data_ID = serv.clientId
 WHERE ((SELECT count(*) FROM Data47 AS regsites WHERE regsites.payerID = payer.Data_ID) = 0)

*SQL Server version is 5.0.40.*

Let me know if you need more specific information.",5
6231282,06/03/2011 18:42:30,583123,01/20/2011 14:49:55,66,0,The object name 'FacetsXrefStaging.Facets.Facets.FacetsXrefImport' contains more than the maximum number of prefixes. The maximum is 2.,"Hi i have created a proc which truncates and reseeds the no of records from the tables. but i am getting the error : The object name 'FacetsXrefStaging.Facets.Facets.FacetsXrefImport' contains more than the maximum number of prefixes. The maximum is 2.

Create proc TruncateAndReseedFacetsXrefStagingTables
'
'
Declare variables
'
'
            SET @iSeed = ( SELECT   CASE WHEN MAX(FacetsXrefId) IS NULL
                                         THEN -2147483648
                                         ELSE MAX(FacetsXrefId) + 1
                                    END
                           FROM     FacetsXref.Facets.Facets.FacetsXrefCertified
                         )
            TRUNCATE TABLE FacetsXrefStaging.Facets.Facets.FacetsXrefImport
            DBCC CHECKIDENT ('FacetsXrefStaging.Facets.FacetsXrefImport', RESEED,@iSeed )
            
            TRUNCATE TABLE FacetsXrefStaging.Facets.FacetsXrefImport

Can anybody help me with that.
I AM USING SQL SERVER 2005. ",sql,,,,,,open,0,312,16,"The object name 'FacetsXrefStaging.Facets.Facets.FacetsXrefImport' contains more than the maximum number of prefixes. The maximum is 2. Hi i have created a proc which truncates and reseeds the no of records from the tables. but i am getting the error : The object name 'FacetsXrefStaging.Facets.Facets.FacetsXrefImport' contains more than the maximum number of prefixes. The maximum is 2.

Create proc TruncateAndReseedFacetsXrefStagingTables
'
'
Declare variables
'
'
            SET @iSeed = ( SELECT   CASE WHEN MAX(FacetsXrefId) IS NULL
                                         THEN -2147483648
                                         ELSE MAX(FacetsXrefId) + 1
                                    END
                           FROM     FacetsXref.Facets.Facets.FacetsXrefCertified
                         )
            TRUNCATE TABLE FacetsXrefStaging.Facets.Facets.FacetsXrefImport
            DBCC CHECKIDENT ('FacetsXrefStaging.Facets.FacetsXrefImport', RESEED,@iSeed )
            
            TRUNCATE TABLE FacetsXrefStaging.Facets.FacetsXrefImport

Can anybody help me with that.
I AM USING SQL SERVER 2005. ",1
9931158,03/29/2012 18:21:11,651942,03/09/2011 16:26:30,1,0,SQL Create Index on View with SUM() in Select,"using sql2005, need to create a view to display the select statement as follows:

    select c1.personid, Max(c1.call_Date) Call_Date, Sum(s1.quantity) Num_Boxes,
    from dbo.kits_dropped s1
    inner join dbo.calls c1 on(c1.callsid = s1.callsid)
    Where s1.product_name = 'Product X'
    GRoup by c1.personid

How can I create an index on the personid in the above view?

Thanks!",sql,view,index,,,,open,0,65,9,"SQL Create Index on View with SUM() in Select using sql2005, need to create a view to display the select statement as follows:

    select c1.personid, Max(c1.call_Date) Call_Date, Sum(s1.quantity) Num_Boxes,
    from dbo.kits_dropped s1
    inner join dbo.calls c1 on(c1.callsid = s1.callsid)
    Where s1.product_name = 'Product X'
    GRoup by c1.personid

How can I create an index on the personid in the above view?

Thanks!",3
10994989,06/12/2012 10:40:05,1157070,01/18/2012 20:06:46,181,0,oracle :length of columns different : inner join,"suppose i have two tables, emp(empId number(3),empName varchar2(100)) and manager(manId number(3),managerName varchar2(50)).

and i fire a query - 

    select * from emp e,manager m where e.empNmae = m.managerName;

will there be any prob in this sql as length of empName and managerName is diff?",sql,oracle,,,,06/12/2012 14:25:26,not a real question,1,46,8,"oracle :length of columns different : inner join suppose i have two tables, emp(empId number(3),empName varchar2(100)) and manager(manId number(3),managerName varchar2(50)).

and i fire a query - 

    select * from emp e,manager m where e.empNmae = m.managerName;

will there be any prob in this sql as length of empName and managerName is diff?",2
9006666,01/25/2012 16:57:10,617057,12/03/2010 00:53:19,69,10,SQL Conditional UPDATE Based on SELECT,"I have a set of data containing costs for East and West. I'm adding a new field for a customer for Canada which needs to be 1.5 times the East or West cost (which ever is greater). So I'm trying to come up with some sql I can execute. I've tried the following but have not had success:


     UPDATE ShippingCost

     SET

        IF EastCost>WestCost

           Canada= EastCost*1.8

        ELSE

           Canada= WestCost*1.8
        ENDIF

I'm sure there's an easy way to do this? Any ideas?",sql,select,update,conditional,,,open,0,128,6,"SQL Conditional UPDATE Based on SELECT I have a set of data containing costs for East and West. I'm adding a new field for a customer for Canada which needs to be 1.5 times the East or West cost (which ever is greater). So I'm trying to come up with some sql I can execute. I've tried the following but have not had success:


     UPDATE ShippingCost

     SET

        IF EastCost>WestCost

           Canada= EastCost*1.8

        ELSE

           Canada= WestCost*1.8
        ENDIF

I'm sure there's an easy way to do this? Any ideas?",4
5847995,05/01/2011 11:09:15,633810,02/25/2011 09:01:48,6,0,Which Sql server 2008 is better i am confused,"now my company want to buy the sql server program but i don't know which model i should suggest , we are using data base with Windows form application and Web application (Visual studio .net 2010)

so which one of the following we should buy:
http://www.microsoft.com/sqlserver/2008/en/us/how-to-buy.aspx
please i need help ??",sql,,,,,05/01/2011 13:11:10,not a real question,1,48,9,"Which Sql server 2008 is better i am confused now my company want to buy the sql server program but i don't know which model i should suggest , we are using data base with Windows form application and Web application (Visual studio .net 2010)

so which one of the following we should buy:
http://www.microsoft.com/sqlserver/2008/en/us/how-to-buy.aspx
please i need help ??",1
5914451,05/06/2011 16:42:38,742119,05/06/2011 16:14:42,1,0,"How do I write a sql statement to calculate totals, based on groups from another table?","
I need to calculate a percentage from a cumulative value. The percent rate to be applied to each value in each row is dependent on rates taken from another table. The percent rate calculation needs to happen in a tiered fashion, as tax might be calculated on earnings. 

eg:
Wages = 1000  
600 * 10% [First $600 calculated at lower tax rate]  
400 * 30% [Remaining amount calculated at higher tax rate]

So, I've been trying to get this to work, but can't sort it out. The DBA is away so it's been handed over to me. Most SQL I'm ok with, but I am not sure how to approach this issue, or what I should be searching for in google either, so apologies is this is a simple search away, please just direct me to the URL and I'll try and work it out myself!

Anyway, below is an example of the format of the data table (#v) and an example of the ranges table (#tiers), and how I have got on so far. I need a new column which has the calculation of 'cval' at the correct percent rate tiers as I've explained above.

Hope someone can help or point me in the right direction!
Thanks, J.


    
    create table #v(
    id nvarchar(50),
    val money,
    tid int
    )
    
    insert into #v values ('a',30,1)
    insert into #v values ('b',50,1)
    insert into #v values ('c',10,1)
    insert into #v values ('d',30,1)
    insert into #v values ('e',-80,1)
    
    
    create table #tiers (
    tid int,
    threshold money,
    amount money
    )
    
    insert into #tiers values (1,0,30)
    insert into #tiers values (1,40,40)
    insert into #tiers values (1,100,50)
    
    
    select * from
    (
    select v1.id, v1.tid, v1.val,sum(v2.val) cval
    from #v v1
    inner join #v v2 on v1.id >= v2.id
    group by v1.id, v1.val, v1.tid
    ) a
    left join
    (
           select a.tid, a.id, a.threshold [lower], b.threshold [upper] from
           (
                   select rank() over (order by threshold) as id, tid, threshold, amount from #tiers
           ) a
           left join
           (
                   select rank() over (order by threshold) as id, tid, threshold, amount from #tiers
           ) b on a.id = b.id-1
    ) b on (a.cval >= lower and a.cval < upper) or (a.cval >= lower and upper is null)


",sql,sql-server,tsql,,,,open,0,569,16,"How do I write a sql statement to calculate totals, based on groups from another table? 
I need to calculate a percentage from a cumulative value. The percent rate to be applied to each value in each row is dependent on rates taken from another table. The percent rate calculation needs to happen in a tiered fashion, as tax might be calculated on earnings. 

eg:
Wages = 1000  
600 * 10% [First $600 calculated at lower tax rate]  
400 * 30% [Remaining amount calculated at higher tax rate]

So, I've been trying to get this to work, but can't sort it out. The DBA is away so it's been handed over to me. Most SQL I'm ok with, but I am not sure how to approach this issue, or what I should be searching for in google either, so apologies is this is a simple search away, please just direct me to the URL and I'll try and work it out myself!

Anyway, below is an example of the format of the data table (#v) and an example of the ranges table (#tiers), and how I have got on so far. I need a new column which has the calculation of 'cval' at the correct percent rate tiers as I've explained above.

Hope someone can help or point me in the right direction!
Thanks, J.


    
    create table #v(
    id nvarchar(50),
    val money,
    tid int
    )
    
    insert into #v values ('a',30,1)
    insert into #v values ('b',50,1)
    insert into #v values ('c',10,1)
    insert into #v values ('d',30,1)
    insert into #v values ('e',-80,1)
    
    
    create table #tiers (
    tid int,
    threshold money,
    amount money
    )
    
    insert into #tiers values (1,0,30)
    insert into #tiers values (1,40,40)
    insert into #tiers values (1,100,50)
    
    
    select * from
    (
    select v1.id, v1.tid, v1.val,sum(v2.val) cval
    from #v v1
    inner join #v v2 on v1.id >= v2.id
    group by v1.id, v1.val, v1.tid
    ) a
    left join
    (
           select a.tid, a.id, a.threshold [lower], b.threshold [upper] from
           (
                   select rank() over (order by threshold) as id, tid, threshold, amount from #tiers
           ) a
           left join
           (
                   select rank() over (order by threshold) as id, tid, threshold, amount from #tiers
           ) b on a.id = b.id-1
    ) b on (a.cval >= lower and a.cval < upper) or (a.cval >= lower and upper is null)


",3
11278848,07/01/2012 01:03:02,803387,06/17/2011 14:22:01,20,2,select query even if exists display all records,"i have a table(acc_branch) structure like this

    ID  BRANCH_NAME     BRANCH_CODE   IFSC_CODE   INST_CODE    CREATED_ON     CRATED_BY
    --  ------------    ------------  ----------  -----------  ------------   ------------
    49	pradeep1	    368	          ACCSYS368 	99	       28-06-12       setupadmin		
    48	pradeep	        125	          ACCSYS125 	99	       28-06-12       superuser		
    2	Ramurthinagar	99102	      ACSY0099102	99	       28-06-12       setupadmin		
    13	Kasturinagar	98104	      ACSY0098104	98	       28-06-12       setupadmin		
    23	Manam Branch	999	          ACSY0098104	99	       28-06-12       superuser	

and i am selecting a query like this

    select acc_branch.branch_name from acc_branch where acc_branch.created_by='setupadmin'

and the result is 

    BRANCH_NAME                                                                                                                                                                                                                                                     
    -------------
    pradeep1                                                                                                                                                                                                                                                        
    Ramurthinagar                                                                                                                                                                                                                                                   
    Kasturinagar

  **but i want a query even if setupadmin i want get all list in my table**, what i have to write a query, can i use **sub queries** or **when matched then queries** or **self joins** or what else i have to do to get all results even if ***created_by='setupadmin'***

any suggestions

Thanks 
pradeep",sql,oracle,query,,,07/01/2012 13:09:16,not a real question,1,1028,8,"select query even if exists display all records i have a table(acc_branch) structure like this

    ID  BRANCH_NAME     BRANCH_CODE   IFSC_CODE   INST_CODE    CREATED_ON     CRATED_BY
    --  ------------    ------------  ----------  -----------  ------------   ------------
    49	pradeep1	    368	          ACCSYS368 	99	       28-06-12       setupadmin		
    48	pradeep	        125	          ACCSYS125 	99	       28-06-12       superuser		
    2	Ramurthinagar	99102	      ACSY0099102	99	       28-06-12       setupadmin		
    13	Kasturinagar	98104	      ACSY0098104	98	       28-06-12       setupadmin		
    23	Manam Branch	999	          ACSY0098104	99	       28-06-12       superuser	

and i am selecting a query like this

    select acc_branch.branch_name from acc_branch where acc_branch.created_by='setupadmin'

and the result is 

    BRANCH_NAME                                                                                                                                                                                                                                                     
    -------------
    pradeep1                                                                                                                                                                                                                                                        
    Ramurthinagar                                                                                                                                                                                                                                                   
    Kasturinagar

  **but i want a query even if setupadmin i want get all list in my table**, what i have to write a query, can i use **sub queries** or **when matched then queries** or **self joins** or what else i have to do to get all results even if ***created_by='setupadmin'***

any suggestions

Thanks 
pradeep",3
11127864,06/20/2012 20:42:33,1415850,05/24/2012 18:56:34,29,1,need specific output in SQL,"I need to make a query output


Using table, I want the following report, in the format given:


-----------     -------
ids < 90000	100,000
ids > 90000	100,000

any thoughts?",sql,oracle,,,,06/20/2012 22:14:13,not a real question,1,27,5,"need specific output in SQL I need to make a query output


Using table, I want the following report, in the format given:


-----------     -------
ids < 90000	100,000
ids > 90000	100,000

any thoughts?",2
5993252,05/13/2011 14:16:40,595985,01/30/2011 18:17:32,8,0,Subquery using Excel's Microsoft Query,"I am trying to write a simple sub query that counts the number of unique alarm ID in a resultset after joining 2 tables. i.e

SELECT COUNT(DISTINCT ALARMTABLE.ID) FROM
 (SELECT ALARMTABLE.ID FROM ALARMTABLE) AS AA
JOIN
 (SELECT ALARMDESCRIPTIONTABLE.DESCRIPTION FROM ALARMDESCRIPTIONTABLE) AS BB
ON AA.ID=BB.ID

Both these tables have an id column that relates the id in one table with the description in the other. The idea being i can get a count and description for each alarm. e.g.

AlarmDescription     Alarm COUNT
-----------------------------------
Fire Alm                 1000
Flood Alm                12
Tornado Alm              75

When i run this using Microsoft query all i get is the error can't add table '('. What am i doing wrong?",sql,excel,query,ms,,,open,0,151,5,"Subquery using Excel's Microsoft Query I am trying to write a simple sub query that counts the number of unique alarm ID in a resultset after joining 2 tables. i.e

SELECT COUNT(DISTINCT ALARMTABLE.ID) FROM
 (SELECT ALARMTABLE.ID FROM ALARMTABLE) AS AA
JOIN
 (SELECT ALARMDESCRIPTIONTABLE.DESCRIPTION FROM ALARMDESCRIPTIONTABLE) AS BB
ON AA.ID=BB.ID

Both these tables have an id column that relates the id in one table with the description in the other. The idea being i can get a count and description for each alarm. e.g.

AlarmDescription     Alarm COUNT
-----------------------------------
Fire Alm                 1000
Flood Alm                12
Tornado Alm              75

When i run this using Microsoft query all i get is the error can't add table '('. What am i doing wrong?",4
7767028,10/14/2011 11:36:08,468968,10/07/2010 10:45:37,388,10,How to Run(Execute) .sql file in SQL Server 2005?,"I have one `Orders_SPs.sql` file.

Its purpose is to **add new** `stored procedure` inside my existing `Northwind Database` which is 
hosting on **MS SQL 2005** and I also have **SQL Server Management Studio.**

But I don’t know **how to execute** `.sql` file so it can add list of `stored procedure` in my **existing** `northwind database` from **Orders_SPs.sql** file.


Thanks….
",sql,sql-server,sql-server-2005,ssms,,10/15/2011 07:17:48,not constructive,1,56,9,"How to Run(Execute) .sql file in SQL Server 2005? I have one `Orders_SPs.sql` file.

Its purpose is to **add new** `stored procedure` inside my existing `Northwind Database` which is 
hosting on **MS SQL 2005** and I also have **SQL Server Management Studio.**

But I don’t know **how to execute** `.sql` file so it can add list of `stored procedure` in my **existing** `northwind database` from **Orders_SPs.sql** file.


Thanks….
",4
7444230,09/16/2011 11:49:21,948740,09/16/2011 11:49:21,1,0,I want to convert this Metical query to SQL 2005 Query,"'delete from rpt62_attribution_value where elo_id not in(select elo_id from (
               select 
				elo_id, elo_value, attr_value, ilo_flag,
				ROW_NUMBER( ) OVER (PARTITION BY
				elo_value, attr_value ORDER BY elo_id) Rank
 				from rpt62_attribution_value ) tmp
				where rank = 1 order by 1);'


",sql,,,,,09/16/2011 20:43:25,not a real question,1,48,11,"I want to convert this Metical query to SQL 2005 Query 'delete from rpt62_attribution_value where elo_id not in(select elo_id from (
               select 
				elo_id, elo_value, attr_value, ilo_flag,
				ROW_NUMBER( ) OVER (PARTITION BY
				elo_value, attr_value ORDER BY elo_id) Rank
 				from rpt62_attribution_value ) tmp
				where rank = 1 order by 1);'


",1
4686726,01/14/2011 00:02:21,283445,03/01/2010 07:45:02,40,2,"SQL Server, using a table as a queue","I'm using an SQL Server 2008 R2 as a queuing mechanism. I add items to the table, and an external service reads and processes these items. This works great, but is missing one thing - I need mechanism whereby I can attempt to select a single row from the table and, if there isn't one, block until there is (preferably for a specific period of time). 

Can anyone advise on how I might achieve this? ",sql,queue,,,,,open,0,76,8,"SQL Server, using a table as a queue I'm using an SQL Server 2008 R2 as a queuing mechanism. I add items to the table, and an external service reads and processes these items. This works great, but is missing one thing - I need mechanism whereby I can attempt to select a single row from the table and, if there isn't one, block until there is (preferably for a specific period of time). 

Can anyone advise on how I might achieve this? ",2
4503925,12/21/2010 21:08:31,550500,12/21/2010 21:00:28,1,0,I'm looking for the sql term to remove duplicate rows from a report. ,"The adhoc report tool is a Shazam product and I have a sql filter that has these value options: 

Is Equal To
Is Between
Is Greater Than
Is Greater or Equal 
Is Less Than 
Is Less or Equal To 
Is Like
Is Not Equal To 
Is Not Between 
Is Not Like 

The report runs, but I have a couple duplicates of the same Incident Number.  How can I tell it to remove any duplicates? 

Thanks for your help 

Patty ",sql,,,,,,open,0,77,14,"I'm looking for the sql term to remove duplicate rows from a report.  The adhoc report tool is a Shazam product and I have a sql filter that has these value options: 

Is Equal To
Is Between
Is Greater Than
Is Greater or Equal 
Is Less Than 
Is Less or Equal To 
Is Like
Is Not Equal To 
Is Not Between 
Is Not Like 

The report runs, but I have a couple duplicates of the same Incident Number.  How can I tell it to remove any duplicates? 

Thanks for your help 

Patty ",1
3102249,06/23/2010 13:55:40,106528,05/13/2009 18:13:53,438,5, Title: CTE error,"I am getting these errors while executing the following SQL please help me 





    ;WITH myCTE AS
    (Select mcisi.* from
    coke_packaged_item AS spi
    JOIN coke_item AS si
      ON si.coke_id = spi.coke_id
      AND si.coke_item_id = spi.coke_item_id
      AND si.shipper_flag = 'n'
    JOIN merch_cat_import_coke_item AS mcisi
      ON mcisi.coke_id = si.coke_id
      AND mcisi.resolved_coke_item_id = si.coke_item_id
      AND mcisi.cat_import_event_id = @cat_import_event_id
      AND mcisi.accept_flag = 'y')
    
    
    UPDATE coke_packaged_item
    SET packaged_in_uom_id = (select resolved_packaged_unit_of_measure_id from myCTE where myCTE.coke_id = coke_id) 
      priced_in_uom_id = COALESCE((select resolved_weight_unit_of_measure_idfrom myCTE.coke_id = coke_id), @each_uom_id), 
      name = (select packaged_item_name from myCTE where myCTE.coke_id = coke_id), 
      package_weight = (select package_weight from myCTE where myCTE.coke_id = coke_id) ,
      status_code = (select status_code from myCTE where myCTE.coke_id = coke_id) ,
      last_modified_user_id = (select CASE WHEN last_modified_user_id = 42 THEN @posting_user_id ELSE last_modified_user_id END from myCTE where myCTE.coke_id = coke_id),
      last_modified_timestamp = CURRENT_TIMESTAMP
    and exists (select coke_id from coke_item AS si
      where si.coke_id = spi.coke_id
      AND si.coke_item_id = spi.coke_item_id
      AND si.shipper_flag = 'n')
    and exists (select coke_id from merch_cat_import_coke_item AS mcisi)
      where mcisi.coke_id = si.coke_id
      AND mcisi.resolved_coke_item_id = si.coke_item_id
      AND mcisi.cat_import_event_id = @cat_import_event_id
      AND mcisi.accept_flag = 'y'





      Msg 102, Level 15, State 1, Procedure Sp_Name, Line 44
    Incorrect syntax near 'priced_in_uom_id'.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 44
    Incorrect syntax near '.'.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 45
    Incorrect syntax near ','.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 46
    Incorrect syntax near ','.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 47
    Incorrect syntax near ','.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 48
    Incorrect syntax near ','.
    Msg 156, Level 15, State 1, Procedure Sp_Name, Line 54
    Incorrect syntax near the keyword 'and'.
    Msg 156, Level 15, State 1, Procedure Sp_Name, Line 55
    Incorrect syntax near the keyword 'where'.

",sql,sql-server,sql-server-2005,tsql,,,open,0,482,4," Title: CTE error I am getting these errors while executing the following SQL please help me 





    ;WITH myCTE AS
    (Select mcisi.* from
    coke_packaged_item AS spi
    JOIN coke_item AS si
      ON si.coke_id = spi.coke_id
      AND si.coke_item_id = spi.coke_item_id
      AND si.shipper_flag = 'n'
    JOIN merch_cat_import_coke_item AS mcisi
      ON mcisi.coke_id = si.coke_id
      AND mcisi.resolved_coke_item_id = si.coke_item_id
      AND mcisi.cat_import_event_id = @cat_import_event_id
      AND mcisi.accept_flag = 'y')
    
    
    UPDATE coke_packaged_item
    SET packaged_in_uom_id = (select resolved_packaged_unit_of_measure_id from myCTE where myCTE.coke_id = coke_id) 
      priced_in_uom_id = COALESCE((select resolved_weight_unit_of_measure_idfrom myCTE.coke_id = coke_id), @each_uom_id), 
      name = (select packaged_item_name from myCTE where myCTE.coke_id = coke_id), 
      package_weight = (select package_weight from myCTE where myCTE.coke_id = coke_id) ,
      status_code = (select status_code from myCTE where myCTE.coke_id = coke_id) ,
      last_modified_user_id = (select CASE WHEN last_modified_user_id = 42 THEN @posting_user_id ELSE last_modified_user_id END from myCTE where myCTE.coke_id = coke_id),
      last_modified_timestamp = CURRENT_TIMESTAMP
    and exists (select coke_id from coke_item AS si
      where si.coke_id = spi.coke_id
      AND si.coke_item_id = spi.coke_item_id
      AND si.shipper_flag = 'n')
    and exists (select coke_id from merch_cat_import_coke_item AS mcisi)
      where mcisi.coke_id = si.coke_id
      AND mcisi.resolved_coke_item_id = si.coke_item_id
      AND mcisi.cat_import_event_id = @cat_import_event_id
      AND mcisi.accept_flag = 'y'





      Msg 102, Level 15, State 1, Procedure Sp_Name, Line 44
    Incorrect syntax near 'priced_in_uom_id'.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 44
    Incorrect syntax near '.'.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 45
    Incorrect syntax near ','.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 46
    Incorrect syntax near ','.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 47
    Incorrect syntax near ','.
    Msg 102, Level 15, State 1, Procedure Sp_Name, Line 48
    Incorrect syntax near ','.
    Msg 156, Level 15, State 1, Procedure Sp_Name, Line 54
    Incorrect syntax near the keyword 'and'.
    Msg 156, Level 15, State 1, Procedure Sp_Name, Line 55
    Incorrect syntax near the keyword 'where'.

",4
3299015,07/21/2010 12:12:40,379968,06/30/2010 11:03:13,6,0,Perform single SQL query over internet Android,"I am trying to find a way to goto a database located on the web perform 1 query and close the connection. I have not had any luck with finding an answer, and I really don't know how to solve this. 

Internet connection is not an issue, nor is any security issues. Also this cannot be solved with an internal database and this must go across the web.

If you have any hints or ideas please let me know!

Thanks",sql,android,,,,,open,0,78,7,"Perform single SQL query over internet Android I am trying to find a way to goto a database located on the web perform 1 query and close the connection. I have not had any luck with finding an answer, and I really don't know how to solve this. 

Internet connection is not an issue, nor is any security issues. Also this cannot be solved with an internal database and this must go across the web.

If you have any hints or ideas please let me know!

Thanks",2
5004560,02/15/2011 13:59:07,160820,08/21/2009 14:09:57,546,15,Converting SQL Date to String,"I am working in Coldfusion and MS-SQL.
my Query delivers a list of possible Dates in a Query Struct.
now I want to convert these date to corresponding String representation.

Muss i have to loop over the query and convert each Sql/Coldfusion date to String representation?

Thanks for the help

",sql,coldfusion,,,,,open,0,46,5,"Converting SQL Date to String I am working in Coldfusion and MS-SQL.
my Query delivers a list of possible Dates in a Query Struct.
now I want to convert these date to corresponding String representation.

Muss i have to loop over the query and convert each Sql/Coldfusion date to String representation?

Thanks for the help

",2
6948572,08/04/2011 21:11:40,645244,03/04/2011 18:30:28,124,2,SQL exact match within a pattern?,"I am using qodbc (a quickbooks database connector) It uses an ODBC-like sql language. 

I would like to find all the records where a field matches a pattern but I have a slight delema. 

The information in my field looks like this:

     321-......02/25/10
     321-1.....02/26/10
     321-2.....03/25/10
     321-3.....03/26/10
     322-......04/25/10
     322-1.....04/26/10
     322-2.....05/25/10
     322-3.....05/26/10

I would like my query to return only the rows where the pattern matches the first number. So if the user searches for '321' it will only show records that look like 321 but not those that have 321-1 or 321-3. Similarly if the user searched for 321-1 you would not see 321. (that's the easy part)

Right now I have

     LIKE '321%'

This finds all of them regardless of if they are followed by dots or not. Is there a way I can limit the query to only specifics despite that field having more information that it should. 

(P.S. I did not set up this system, it makes me wince to see two data points in one field
I'm sorry if my title isn't right, suggest a new title if you can. ) 
",sql,quickbooks,,,,,open,0,217,6,"SQL exact match within a pattern? I am using qodbc (a quickbooks database connector) It uses an ODBC-like sql language. 

I would like to find all the records where a field matches a pattern but I have a slight delema. 

The information in my field looks like this:

     321-......02/25/10
     321-1.....02/26/10
     321-2.....03/25/10
     321-3.....03/26/10
     322-......04/25/10
     322-1.....04/26/10
     322-2.....05/25/10
     322-3.....05/26/10

I would like my query to return only the rows where the pattern matches the first number. So if the user searches for '321' it will only show records that look like 321 but not those that have 321-1 or 321-3. Similarly if the user searched for 321-1 you would not see 321. (that's the easy part)

Right now I have

     LIKE '321%'

This finds all of them regardless of if they are followed by dots or not. Is there a way I can limit the query to only specifics despite that field having more information that it should. 

(P.S. I did not set up this system, it makes me wince to see two data points in one field
I'm sorry if my title isn't right, suggest a new title if you can. ) 
",2
11701373,07/28/2012 13:20:23,1189361,02/04/2012 13:11:19,139,8,Fastest sql database server,"Whis is the fastest sql database server available for free?
It should be able read and write at a high rate",sql,database,,,,07/28/2012 13:44:35,not a real question,1,20,4,"Fastest sql database server Whis is the fastest sql database server available for free?
It should be able read and write at a high rate",2
11181778,06/24/2012 22:43:39,714319,04/18/2011 23:49:11,507,4,temporary tables using RMySQL,"Is there a way to create a temporary table using the `RMySQL` package?  If so what is the correct way to do it?

NOTE: I found some stuff on the net that suggests creating a temporary table manually using `dbSendQuery(con, ""create temporary table x (x int)"")` and then simply overriding it with `dbWriteTable()`.  This does not work.",sql,r,table,temporary-tables,rmysql,,open,0,58,4,"temporary tables using RMySQL Is there a way to create a temporary table using the `RMySQL` package?  If so what is the correct way to do it?

NOTE: I found some stuff on the net that suggests creating a temporary table manually using `dbSendQuery(con, ""create temporary table x (x int)"")` and then simply overriding it with `dbWriteTable()`.  This does not work.",5
11498199,07/16/2012 04:41:42,1527818,07/16/2012 03:12:45,1,0,How to do WHERE-CLAUSE in hierarchical query in Oracle,"In Oracle hierarchical query, the WHERE-CLAUSE should be evaluated after the Connect-By operator in oracle document says. 

But there are complex situations: if the WHERE-CLAUSE contains JOIN-style qualification, as oracle says, the Join-Style qualification should be evaluated before Connect-By operator and the other none-Join-Style that refers to only one relation will be evaluated after the Connect-By operator. 

**So the question is: how to split the qualifications in WHERE-CLAUSE into two part, one is evaluated before the Connect-By operator and the other is evaluated after the Connect-By operator.**

    example:
    SQL> desc bar
    Name                                      Null?    Type
    ----------------------------------------- -------- -----------------
    B1                                                 NUMBER(38)
    B2                                                 NUMBER(38)

    SQL> desc foo;
    Name                                      Null?    Type
    ----------------------------------------- -------- -----------------
    F1                                                 NUMBER(38)
    F2                                                 NUMBER(38)
    SQL> set pagesize 3000
    SQL> set linesize 3000
    SQL> explain plan for select * from foo, bar where
     2  **f1=b1 and (b2 = 1 or f1=b2 and b1=1 or f2=b1+1) and f1 is not null**
     3  connect by level < 10;

    Explained.

    SQL> select * from table(dbms_xplan.display);

    PLAN_TABLE_OUTPUT
    --------------------------------------------------------------------------------------
    Plan hash value: 2657287368

    --------------------------------------------------------------------------------------
    | Id  | Operation                     | Name | Rows  | Bytes | Cost (%CPU)| Time     |
    --------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT              |      |     1 |    52 |     5  (20)| 00:00:01 |
    |*  1 |  FILTER                       |      |       |       |            |          |
    |*  2 |   CONNECT BY WITHOUT FILTERING|      |       |       |            |          |
    |*  3 |    HASH JOIN                  |      |     1 |    52 |     5  (20)| 00:00:01 |
    |   4 |     TABLE ACCESS FULL         | FOO  |     1 |    26 |     2   (0)| 00:00:01 |
    |   5 |     TABLE ACCESS FULL         | BAR  |     1 |    26 |     2   (0)| 00:00:01 |
    --------------------------------------------------------------------------------------
    
    Predicate Information (identified by operation id):
    ---------------------------------------------------
    
       1 - **filter((""B2""=1 OR ""B1""=1) AND ""F1"" IS NOT NULL)**
       2 - filter(LEVEL<10)
       3 - **access(""F1""=""B1"")**
           **filter(""F1""=""B2"" OR ""F2""=""B1""+1)**

    Note
    -----
       - dynamic sampling used for this statement

    24 rows selected.

So, as we can see, the qualification in WHERE, **f1=b1 and (b2 = 1 or f1=b2 and b1=1 or f2=b1+1)** and f1 is not null, has been splited the two parts:
one: **filter((""B2""=1 OR ""B1""=1) AND ""F1"" IS NOT NULL)**
the other: **filter(""F1""=""B2"" OR ""F2""=""B1""+1)  and  access(""F1""=""B1"")**

**So what is the split algorithm or methods?**


thanks.

",sql,oracle,hierarchical-data,hierarchical-query,,,open,0,1041,9,"How to do WHERE-CLAUSE in hierarchical query in Oracle In Oracle hierarchical query, the WHERE-CLAUSE should be evaluated after the Connect-By operator in oracle document says. 

But there are complex situations: if the WHERE-CLAUSE contains JOIN-style qualification, as oracle says, the Join-Style qualification should be evaluated before Connect-By operator and the other none-Join-Style that refers to only one relation will be evaluated after the Connect-By operator. 

**So the question is: how to split the qualifications in WHERE-CLAUSE into two part, one is evaluated before the Connect-By operator and the other is evaluated after the Connect-By operator.**

    example:
    SQL> desc bar
    Name                                      Null?    Type
    ----------------------------------------- -------- -----------------
    B1                                                 NUMBER(38)
    B2                                                 NUMBER(38)

    SQL> desc foo;
    Name                                      Null?    Type
    ----------------------------------------- -------- -----------------
    F1                                                 NUMBER(38)
    F2                                                 NUMBER(38)
    SQL> set pagesize 3000
    SQL> set linesize 3000
    SQL> explain plan for select * from foo, bar where
     2  **f1=b1 and (b2 = 1 or f1=b2 and b1=1 or f2=b1+1) and f1 is not null**
     3  connect by level < 10;

    Explained.

    SQL> select * from table(dbms_xplan.display);

    PLAN_TABLE_OUTPUT
    --------------------------------------------------------------------------------------
    Plan hash value: 2657287368

    --------------------------------------------------------------------------------------
    | Id  | Operation                     | Name | Rows  | Bytes | Cost (%CPU)| Time     |
    --------------------------------------------------------------------------------------
    |   0 | SELECT STATEMENT              |      |     1 |    52 |     5  (20)| 00:00:01 |
    |*  1 |  FILTER                       |      |       |       |            |          |
    |*  2 |   CONNECT BY WITHOUT FILTERING|      |       |       |            |          |
    |*  3 |    HASH JOIN                  |      |     1 |    52 |     5  (20)| 00:00:01 |
    |   4 |     TABLE ACCESS FULL         | FOO  |     1 |    26 |     2   (0)| 00:00:01 |
    |   5 |     TABLE ACCESS FULL         | BAR  |     1 |    26 |     2   (0)| 00:00:01 |
    --------------------------------------------------------------------------------------
    
    Predicate Information (identified by operation id):
    ---------------------------------------------------
    
       1 - **filter((""B2""=1 OR ""B1""=1) AND ""F1"" IS NOT NULL)**
       2 - filter(LEVEL<10)
       3 - **access(""F1""=""B1"")**
           **filter(""F1""=""B2"" OR ""F2""=""B1""+1)**

    Note
    -----
       - dynamic sampling used for this statement

    24 rows selected.

So, as we can see, the qualification in WHERE, **f1=b1 and (b2 = 1 or f1=b2 and b1=1 or f2=b1+1)** and f1 is not null, has been splited the two parts:
one: **filter((""B2""=1 OR ""B1""=1) AND ""F1"" IS NOT NULL)**
the other: **filter(""F1""=""B2"" OR ""F2""=""B1""+1)  and  access(""F1""=""B1"")**

**So what is the split algorithm or methods?**


thanks.

",4
6782216,07/21/2011 20:18:45,490383,06/14/2010 17:23:21,149,20,Sql Query runs so slowly in two diffrent servers,"I run the same SQL query in SQL Server 2005 databases. 
But databases are located in different servers (both Windows server 2008 Service pack 2).
What are the main factors that cause one query runs faster than the other one?

",sql,sql-server,sql-server-2005,,,07/21/2011 20:28:43,not a real question,1,39,9,"Sql Query runs so slowly in two diffrent servers I run the same SQL query in SQL Server 2005 databases. 
But databases are located in different servers (both Windows server 2008 Service pack 2).
What are the main factors that cause one query runs faster than the other one?

",3
10826079,05/31/2012 00:39:34,896361,02/08/2011 17:55:46,131,2,SQL Server 2008 Restore a MDF and LDF file,"Background: I had a working database called WBPM which I renamed using the right-click feature in SSMS to WBPM_v20120530 as I wanted to roll out a new version of the Database. I believe the right click rename feature of SSMS does not change the physical .MDF or .LDF file so when I wanted to publish the new version using SSDT, I had an error notifying me the WBPM LDF and MDF files existed.

I renamed the physical files using Windows Explorer. This is the procedure I follwed:

    -- 1. The Database had been renamed using SSMS right click FROM WBPM to WBPM_v20120530.

    ALTER DATABASE WBPM_v20120530 SET OFFLINE
    
    -- 2. I have inserted the new string ""_v20120530"" to the .mdf file using Windows Explorer and then run this command.

    ALTER DATABASE WBPM_v20120530
    MODIFY FILE (NAME = WBPM, 
    FILENAME = 
    'C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBMD_v20120530_Primary.mdf')
    GO
    
    -- 3. I have inserted the new string ""_v20120530"" to the .ldf file and run this command.

    ALTER DATABASE WBPM_v20120530 
    MODIFY FILE (NAME = WBPM_log, 
    FILENAME ='C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBPM_v20120530_Primary.ldf')
    GO
    
    -- 4. I can not bring the database Online?

    ALTER DATABASE WBPM_v20120530 SET ONLINE
    GO

This is the Error message I get from SSMS:

    **Msg 5120, Level 16, State 101, Line 1
    Unable to open the physical file ""C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBMD_v20120530_Primary.mdf"". Operating system error 2: ""2(failed to retrieve text for this error. Reason: 15105)"".
    Msg 945, Level 14, State 2, Line 1
    Database 'WBPM_v20120530' cannot be opened due to inaccessible files or insufficient memory or disk space.  See the SQL Server errorlog for details.
    Msg 5069, Level 16, State 1, Line 1**
    ALTER DATABASE statement failed.

Any help would be greatly appreciated as I would like to recover the database?
Many thanks and kind regards,
Bertie.",sql,sql-server-2008,,,,06/02/2012 04:03:41,off topic,1,369,9,"SQL Server 2008 Restore a MDF and LDF file Background: I had a working database called WBPM which I renamed using the right-click feature in SSMS to WBPM_v20120530 as I wanted to roll out a new version of the Database. I believe the right click rename feature of SSMS does not change the physical .MDF or .LDF file so when I wanted to publish the new version using SSDT, I had an error notifying me the WBPM LDF and MDF files existed.

I renamed the physical files using Windows Explorer. This is the procedure I follwed:

    -- 1. The Database had been renamed using SSMS right click FROM WBPM to WBPM_v20120530.

    ALTER DATABASE WBPM_v20120530 SET OFFLINE
    
    -- 2. I have inserted the new string ""_v20120530"" to the .mdf file using Windows Explorer and then run this command.

    ALTER DATABASE WBPM_v20120530
    MODIFY FILE (NAME = WBPM, 
    FILENAME = 
    'C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBMD_v20120530_Primary.mdf')
    GO
    
    -- 3. I have inserted the new string ""_v20120530"" to the .ldf file and run this command.

    ALTER DATABASE WBPM_v20120530 
    MODIFY FILE (NAME = WBPM_log, 
    FILENAME ='C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBPM_v20120530_Primary.ldf')
    GO
    
    -- 4. I can not bring the database Online?

    ALTER DATABASE WBPM_v20120530 SET ONLINE
    GO

This is the Error message I get from SSMS:

    **Msg 5120, Level 16, State 101, Line 1
    Unable to open the physical file ""C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBMD_v20120530_Primary.mdf"". Operating system error 2: ""2(failed to retrieve text for this error. Reason: 15105)"".
    Msg 945, Level 14, State 2, Line 1
    Database 'WBPM_v20120530' cannot be opened due to inaccessible files or insufficient memory or disk space.  See the SQL Server errorlog for details.
    Msg 5069, Level 16, State 1, Line 1**
    ALTER DATABASE statement failed.

Any help would be greatly appreciated as I would like to recover the database?
Many thanks and kind regards,
Bertie.",2
2497046,03/23/2010 01:51:34,299533,02/10/2010 23:57:59,10,1,SQL Query Not Functioning - No Error Message," // Write the data to the database
  $query = ""INSERT INTO staff (name, lastname, username, password, position, department, birthmonth, birthday, birthyear, location, phone, email, street, city, state, country, zip, tags, photo) VALUES ('$name', '$lastname', '$username', '$password', '$position', '$department', '$birthmonth', '$birthday', '$birthyear', '$location', '$phone', '$email', '$street', '$city', '$state', '$country', '$zip', '$tags', '$photo')"";
       mysql_query($query);
        var_dump($query);
        echo '<p>' . $name . ' has been added to the Employee Directory.</p>';       
        
        if (!$query) {
         die('Invalid query: ' . mysql_error());
        }

Can someone tell me why the above code produced:

    string(332) ""INSERT INTO staff (name, lastname, username, password, position, department, birthmonth, birthday, birthyear, location, phone, email, street, city, state, country, zip, tags, photo) VALUES ('Craig', 'Hooghiem', 'sdf', 'sdf', 'sdf', 'sdf', '01', '01', 'sdf', 'sdf', '', 'sdf', 'sdf', 'sd', 'sdf', 'sdf', 'sd', 'sdg', 'leftround.gif')""
    
    Craig has been added to the Employee Directory.

But does not actually add anything into the database table ""staff"" ?

I must be missing something obvious here.",sql,php,query,,,,open,0,220,8,"SQL Query Not Functioning - No Error Message  // Write the data to the database
  $query = ""INSERT INTO staff (name, lastname, username, password, position, department, birthmonth, birthday, birthyear, location, phone, email, street, city, state, country, zip, tags, photo) VALUES ('$name', '$lastname', '$username', '$password', '$position', '$department', '$birthmonth', '$birthday', '$birthyear', '$location', '$phone', '$email', '$street', '$city', '$state', '$country', '$zip', '$tags', '$photo')"";
       mysql_query($query);
        var_dump($query);
        echo '<p>' . $name . ' has been added to the Employee Directory.</p>';       
        
        if (!$query) {
         die('Invalid query: ' . mysql_error());
        }

Can someone tell me why the above code produced:

    string(332) ""INSERT INTO staff (name, lastname, username, password, position, department, birthmonth, birthday, birthyear, location, phone, email, street, city, state, country, zip, tags, photo) VALUES ('Craig', 'Hooghiem', 'sdf', 'sdf', 'sdf', 'sdf', '01', '01', 'sdf', 'sdf', '', 'sdf', 'sdf', 'sd', 'sdf', 'sdf', 'sd', 'sdg', 'leftround.gif')""
    
    Craig has been added to the Employee Directory.

But does not actually add anything into the database table ""staff"" ?

I must be missing something obvious here.",3
3154329,07/01/2010 00:12:59,55266,01/15/2009 01:51:30,23,0,(Common Table Expressions) CTE as part of WHERE clause... possible?,"Is it possible to use CTE in a WHERE clause e.g.

SELECT * FROM Table1 WHERE

Table1.PK IN

(

     WITH Cte AS

     (
    -- root selection (dynamic, generated in code)
    SELECT Bla FROM Table2
    -- recursive part
    UNION ALL
    SELECT …..

      )
      SELECT Bla FROM Cte
)

The reason I’m asking is that I need to use a recursive query and the only way of doing it at the moment without updating our framework is to place it in the where clause.

Cheers",sql,sql-server,tsql,,,,open,0,110,10,"(Common Table Expressions) CTE as part of WHERE clause... possible? Is it possible to use CTE in a WHERE clause e.g.

SELECT * FROM Table1 WHERE

Table1.PK IN

(

     WITH Cte AS

     (
    -- root selection (dynamic, generated in code)
    SELECT Bla FROM Table2
    -- recursive part
    UNION ALL
    SELECT …..

      )
      SELECT Bla FROM Cte
)

The reason I’m asking is that I need to use a recursive query and the only way of doing it at the moment without updating our framework is to place it in the where clause.

Cheers",3
5034799,02/17/2011 21:19:04,356519,06/02/2010 14:13:08,114,6,sql first of every month,"supposing that I wanted to write table valued function in sql that returns a table with the first day of every month between the argument dates, what is the simplest way to do this?  

For example fnFirstOfMonths('10/31/10', '2/17/11') would return a 1-column table with 11/1/10, 12/1/10, 1/1/11, and 2/1/11 as the elements.  

My first instinct is just to use a while loop and repeatedly insert first days of months until I get to before the start date.  It seems like there should be a more elegant way to do this though.  

Thanks for any help you can provide.",sql,sql-server,,,,,open,0,102,5,"sql first of every month supposing that I wanted to write table valued function in sql that returns a table with the first day of every month between the argument dates, what is the simplest way to do this?  

For example fnFirstOfMonths('10/31/10', '2/17/11') would return a 1-column table with 11/1/10, 12/1/10, 1/1/11, and 2/1/11 as the elements.  

My first instinct is just to use a while loop and repeatedly insert first days of months until I get to before the start date.  It seems like there should be a more elegant way to do this though.  

Thanks for any help you can provide.",2
8111888,11/13/2011 13:33:08,1088313,01/19/2011 04:08:55,158,0,Working with user-defined Function,"I am working on something I am trying to create a user defined function named Employee_Name. Pass an Employee Id as a parameter.

This is what I have so far :

    Create function Employee_name (
    @EmployeeID int 
     )
     Return Table
     as 
     Return(
    		 Select * From Employees
    	Where Employee_name = @EmplyeeId)
     go
     SELECT * FROM Employee_name

But I am not  thinking I am doing this right because where the return table is mark with red. Which means an error. I am still learning this, its kinda confusing for me. I am woundering if the return table should be only a return.",sql,,,,,,open,0,138,4,"Working with user-defined Function I am working on something I am trying to create a user defined function named Employee_Name. Pass an Employee Id as a parameter.

This is what I have so far :

    Create function Employee_name (
    @EmployeeID int 
     )
     Return Table
     as 
     Return(
    		 Select * From Employees
    	Where Employee_name = @EmplyeeId)
     go
     SELECT * FROM Employee_name

But I am not  thinking I am doing this right because where the return table is mark with red. Which means an error. I am still learning this, its kinda confusing for me. I am woundering if the return table should be only a return.",1
9486766,02/28/2012 17:27:16,428705,08/23/2010 18:23:20,3032,168,Which query will be faster and why?,"Sorry just clearing my doubts. 
Extending this question http://stackoverflow.com/questions/9486488/optimizing-sqlite-query/9486539#comment12007886_9486539

I have table as 

    CREATE TABLE IF NOT EXISTS [app_status](
    [id] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL ,
    [status] TEXT DEFAULT NULL,
    [type] INTEGER
    )  

I have two index 
one on status 
second on type `order by asc`

Which query will be running faster. and why ?

SELECT COALESCE(min(type), 0)
  FROM app_status
 WHERE status IS NOT NULL
   AND type IN (1,2) limit 1

OR 

    SELECT type FROM
    app_status WHERE
    status IS NOT NULL
    ORDER BY type limit 1




",sql,sqlite,,,,,open,0,116,7,"Which query will be faster and why? Sorry just clearing my doubts. 
Extending this question http://stackoverflow.com/questions/9486488/optimizing-sqlite-query/9486539#comment12007886_9486539

I have table as 

    CREATE TABLE IF NOT EXISTS [app_status](
    [id] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL ,
    [status] TEXT DEFAULT NULL,
    [type] INTEGER
    )  

I have two index 
one on status 
second on type `order by asc`

Which query will be running faster. and why ?

SELECT COALESCE(min(type), 0)
  FROM app_status
 WHERE status IS NOT NULL
   AND type IN (1,2) limit 1

OR 

    SELECT type FROM
    app_status WHERE
    status IS NOT NULL
    ORDER BY type limit 1




",2
10018078,04/04/2012 19:38:16,317785,04/15/2010 17:30:45,892,21,How to create a train schedule in SQLite3?,"I have a class project. I have to make a database with tables that shows the time tables of a train.

The minimum requirements is

There is a Train going South and another going North.
There are 10 stops for both trains. No 2 trains are at any stop at the same time.
North bound and south bound trains are never at the same stop at the same time.

Each stop is 30 minutes from each other.

Train A is the south bound train
Train B is the north bound train

1. Design a table(s) for the trains
2. Create an SQL Query to show what time Train A will arrive at the  final stop if it leaves at 7:10AM from the origination.

The database is SQLite3.",sql,database,sqlite,database-design,sqlite3,05/04/2012 13:28:34,not a real question,1,118,8,"How to create a train schedule in SQLite3? I have a class project. I have to make a database with tables that shows the time tables of a train.

The minimum requirements is

There is a Train going South and another going North.
There are 10 stops for both trains. No 2 trains are at any stop at the same time.
North bound and south bound trains are never at the same stop at the same time.

Each stop is 30 minutes from each other.

Train A is the south bound train
Train B is the north bound train

1. Design a table(s) for the trains
2. Create an SQL Query to show what time Train A will arrive at the  final stop if it leaves at 7:10AM from the origination.

The database is SQLite3.",5
11436721,07/11/2012 16:01:38,1051849,11/17/2011 13:08:10,129,1,postgres index query speed inconsistency,"We have 2 identical columns on the same table with 2 identical indices running 2 identical queries. yet one runs nearly 10* quicker than the other. what's causing this?



    1) SELECT MIN(""reports"".""longitude"") AS min_id FROM ""reports"" WHERE (area2 = 18)

    2) SELECT MIN(""reports"".""latitude"") AS min_id FROM ""reports"" WHERE (area2 = 18)

1 runs in 28ms and 2 runs in >300ms

Here are the 'explains'

    1) ""Result  (cost=6.07..6.08 rows=1 width=0)""
""  InitPlan 1 (returns $0)""
""    ->  Limit  (cost=0.00..6.07 rows=1 width=8)""
""          ->  Index Scan using longitude on reports  (cost=0.00..139617.49 rows=22983 width=8)""
""                Index Cond: (longitude IS NOT NULL)""
""                Filter: (area2 = 18)""


    2) ""Result  (cost=5.95..5.96 rows=1 width=0)""
""  InitPlan 1 (returns $0)""
""    ->  Limit  (cost=0.00..5.95 rows=1 width=8)""
""          ->  Index Scan using latitude on reports  (cost=0.00..136754.07 rows=22983 width=8)""
""                Index Cond: (latitude IS NOT NULL)""
""                Filter: (area2 = 18)""

What is going on?? how can i get the second query to behave properly and run quickly? both the setups are identical as far as i can tell.

any insights would be much appreciated!

",sql,postgresql,,,,,open,0,270,5,"postgres index query speed inconsistency We have 2 identical columns on the same table with 2 identical indices running 2 identical queries. yet one runs nearly 10* quicker than the other. what's causing this?



    1) SELECT MIN(""reports"".""longitude"") AS min_id FROM ""reports"" WHERE (area2 = 18)

    2) SELECT MIN(""reports"".""latitude"") AS min_id FROM ""reports"" WHERE (area2 = 18)

1 runs in 28ms and 2 runs in >300ms

Here are the 'explains'

    1) ""Result  (cost=6.07..6.08 rows=1 width=0)""
""  InitPlan 1 (returns $0)""
""    ->  Limit  (cost=0.00..6.07 rows=1 width=8)""
""          ->  Index Scan using longitude on reports  (cost=0.00..139617.49 rows=22983 width=8)""
""                Index Cond: (longitude IS NOT NULL)""
""                Filter: (area2 = 18)""


    2) ""Result  (cost=5.95..5.96 rows=1 width=0)""
""  InitPlan 1 (returns $0)""
""    ->  Limit  (cost=0.00..5.95 rows=1 width=8)""
""          ->  Index Scan using latitude on reports  (cost=0.00..136754.07 rows=22983 width=8)""
""                Index Cond: (latitude IS NOT NULL)""
""                Filter: (area2 = 18)""

What is going on?? how can i get the second query to behave properly and run quickly? both the setups are identical as far as i can tell.

any insights would be much appreciated!

",2
3034475,06/14/2010 00:31:38,117700,06/04/2009 23:04:34,2329,12,interview question on stored procedures,what kind of things would you not store in stored procedures?,sql,,,,,11/30/2011 02:48:13,not constructive,1,11,5,interview question on stored procedures what kind of things would you not store in stored procedures?,1
9060804,01/30/2012 07:48:08,857420,07/22/2011 06:52:10,1,0,Column Level Locking in SQL SERVER 2008,"In SQL server i have a Table having 10 columns, i want to update a perticular column value,
& i want to put lock before updating by which others can not update same time.",sql,sql-server-2008,,,,01/30/2012 10:31:27,not a real question,1,33,7,"Column Level Locking in SQL SERVER 2008 In SQL server i have a Table having 10 columns, i want to update a perticular column value,
& i want to put lock before updating by which others can not update same time.",2
10494210,05/08/2012 07:12:13,1379264,05/07/2012 08:26:55,6,0,SQL JOIN clause,"Ok, professionals.  I am running into this problem:

SELECT CHILD_NAME, EMP_NAME
FROM CUSTOMER LEFT JOIN EMPLOYEE
ON CUSTOMER.CHILD_NAME = EMPLOYEE.EMP_NAME
ORDER BY CHILD_NAME ASC;

I am coming up with a column (child_name) of child names but the second column (emp_name) is empty!  What am I missing?  I am using Access 2010.",sql,,,,,05/08/2012 08:46:06,not a real question,1,49,3,"SQL JOIN clause Ok, professionals.  I am running into this problem:

SELECT CHILD_NAME, EMP_NAME
FROM CUSTOMER LEFT JOIN EMPLOYEE
ON CUSTOMER.CHILD_NAME = EMPLOYEE.EMP_NAME
ORDER BY CHILD_NAME ASC;

I am coming up with a column (child_name) of child names but the second column (emp_name) is empty!  What am I missing?  I am using Access 2010.",1
5223653,03/07/2011 18:35:01,273657,02/15/2010 16:39:46,536,13,Comparing values of type DATE - Oracle,"Is there any way of comparing to date values to check if one is before the other? 
For example how do i know which came first on the following rows
    
    SEQ   CREATION_DTM
    --------------------
    234   2011-03-26 22:59:03
    235   2011-03-26 22:59:03

The column for the above data is declarad as datatype DATE. Having read around it appears that the DATE datatype does not store milliseconds. Does this mean 
i cant compare the above two dates to find out which one is before the other?

EDIT
-----

I am using Oracle 10G on Solaris. 
",sql,oracle,plsql,oracle10g,,,open,0,110,7,"Comparing values of type DATE - Oracle Is there any way of comparing to date values to check if one is before the other? 
For example how do i know which came first on the following rows
    
    SEQ   CREATION_DTM
    --------------------
    234   2011-03-26 22:59:03
    235   2011-03-26 22:59:03

The column for the above data is declarad as datatype DATE. Having read around it appears that the DATE datatype does not store milliseconds. Does this mean 
i cant compare the above two dates to find out which one is before the other?

EDIT
-----

I am using Oracle 10G on Solaris. 
",4
2161264,01/29/2010 10:29:15,238779,12/26/2009 08:54:17,100,3,Tips for improving performance of DB that is above size 40 GB (Sql Server 2005),The current DB or our project has crossed over 40 GB this month and on an average it is growing monthly by around 3 GB. Now all the tables are best normalized and proper indexing has been used. But still as the size is growing it is taking more time to fire even basic queries like 'select count(1) from table'. So can u share some more points that will help in this front. Database is Sql Server 2005. Thanks in advance.,sql,server,performance,,,,open,0,81,15,Tips for improving performance of DB that is above size 40 GB (Sql Server 2005) The current DB or our project has crossed over 40 GB this month and on an average it is growing monthly by around 3 GB. Now all the tables are best normalized and proper indexing has been used. But still as the size is growing it is taking more time to fire even basic queries like 'select count(1) from table'. So can u share some more points that will help in this front. Database is Sql Server 2005. Thanks in advance.,3
2156273,01/28/2010 16:53:56,72150,02/28/2009 06:26:02,21,1,MS Jdbc driver sqljdbc 2.0 driver fails to connect to MSSQL 2008,"We have a well-defined problem that points to a problem with Microsoft's JDBC 2.0 driver for JDK 1.6 (""sqljdbc4.jar""). 

I may be wrong. I've been wrong before.  I wanted to see if I'm missing anything. any insights? Anyone seen this before? 

Usecase:

 - use ant ""sql"" task to run a simple sql query. All queries fail 
 - jdbc driver throws an exception when connecting: ""The server version is not supported. The target server must be SQL Server 2000 or later."" (stack trace excerpt below)
 - This works fine on sql server versions 2000 and 2005

Data:

 - The only 'players' here are a) ant and b) the jdbc drivers. No custom code.
 - we are using the 2.0 driver, i.e. from this file sqljdbc_2.0.1803.100_enu.tar.gz
 - we are using the 'sqljdbc4.jar' version, i.e. the version required for JDK6. Md5sum is: 249734b9b7dafaccd92de99eee95d7d6
 - Sql server's properties are as follows: product version:10.0.2531.0	
 - Productlevel: SP1	
 - Edition: Enterprise Edition
 - We're using a jdbc url that looks like this: ""jdbc:sqlserver://prodsql2;"" (i.e. no extra properties passed at the end)

 
Stack Trace:

    com.microsoft.sqlserver.jdbc.SQLServerException: The server version is not supported. The target server must be SQL Server 2000 or later.
    at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(Unknown Source)
    at com.microsoft.sqlserver.jdbc.DBComms.Prelogin(Unknown Source)
    at com.microsoft.sqlserver.jdbc.DBComms.<init>(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connectHelper(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.loginWithoutFailover(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(Unknown Source)
    at org.apache.tools.ant.taskdefs.JDBCTask.getConnection(JDBCTask.java:31
    
thanks in advance,

bill",sql,server,jdbc,mssql,,,open,0,251,12,"MS Jdbc driver sqljdbc 2.0 driver fails to connect to MSSQL 2008 We have a well-defined problem that points to a problem with Microsoft's JDBC 2.0 driver for JDK 1.6 (""sqljdbc4.jar""). 

I may be wrong. I've been wrong before.  I wanted to see if I'm missing anything. any insights? Anyone seen this before? 

Usecase:

 - use ant ""sql"" task to run a simple sql query. All queries fail 
 - jdbc driver throws an exception when connecting: ""The server version is not supported. The target server must be SQL Server 2000 or later."" (stack trace excerpt below)
 - This works fine on sql server versions 2000 and 2005

Data:

 - The only 'players' here are a) ant and b) the jdbc drivers. No custom code.
 - we are using the 2.0 driver, i.e. from this file sqljdbc_2.0.1803.100_enu.tar.gz
 - we are using the 'sqljdbc4.jar' version, i.e. the version required for JDK6. Md5sum is: 249734b9b7dafaccd92de99eee95d7d6
 - Sql server's properties are as follows: product version:10.0.2531.0	
 - Productlevel: SP1	
 - Edition: Enterprise Edition
 - We're using a jdbc url that looks like this: ""jdbc:sqlserver://prodsql2;"" (i.e. no extra properties passed at the end)

 
Stack Trace:

    com.microsoft.sqlserver.jdbc.SQLServerException: The server version is not supported. The target server must be SQL Server 2000 or later.
    at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(Unknown Source)
    at com.microsoft.sqlserver.jdbc.DBComms.Prelogin(Unknown Source)
    at com.microsoft.sqlserver.jdbc.DBComms.<init>(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connectHelper(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.loginWithoutFailover(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(Unknown Source)
    at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(Unknown Source)
    at org.apache.tools.ant.taskdefs.JDBCTask.getConnection(JDBCTask.java:31
    
thanks in advance,

bill",4
2921535,05/27/2010 13:33:07,38,08/01/2008 12:44:28,331,9,Querying tables based on other column values,"Is there a way to query different databases based on the value of a column in the query?

Say for example you have the following columns:
<ul>
<li>id</li>
<li>part_id</li>
<li>attr_id</li>
<li>attr_value_ext</li>
<li>attr_value_int</li>
</ul>
You then run a query and if the attr_id is '1' is returns the attr_value_int column but if attr_id is greater than '1' it joins data from another table based on the attr_value_ext.",sql,,,,,,open,0,57,7,"Querying tables based on other column values Is there a way to query different databases based on the value of a column in the query?

Say for example you have the following columns:
<ul>
<li>id</li>
<li>part_id</li>
<li>attr_id</li>
<li>attr_value_ext</li>
<li>attr_value_int</li>
</ul>
You then run a query and if the attr_id is '1' is returns the attr_value_int column but if attr_id is greater than '1' it joins data from another table based on the attr_value_ext.",1
8086906,11/10/2011 21:56:06,1040642,11/10/2011 21:46:01,1,0,Keeping clear of SQL injections,"If I make sure only alpha-numerical characters are used in queries I should be free of any SQL injections, right?",sql,injection,,,,11/10/2011 22:42:52,not a real question,1,20,5,"Keeping clear of SQL injections If I make sure only alpha-numerical characters are used in queries I should be free of any SQL injections, right?",2
2993412,06/07/2010 21:46:55,165215,08/29/2009 02:54:36,347,18,How to convert row data into columns in SQL,"I have looked into pivot but I think it requires an aggregate function which I do not need (I think).

The result of my query is this

        Name          Property Name        PropertyValue
       ----------      ----------            ----------
         lorem          Work Phone         000.111.2020
         ipsum          Email              test@email.com

To

    Name          Work Phone                Email
    ----------    ----------            ----------
    lorem        000.111.2020        test2@email.com
    ipsum        001.101.2010        test3@email.com

I don't think I should use pivot here because I don't need to aggregate anything, I just want the row data to become a column.",sql,sql-server-2005,,,,,open,0,255,9,"How to convert row data into columns in SQL I have looked into pivot but I think it requires an aggregate function which I do not need (I think).

The result of my query is this

        Name          Property Name        PropertyValue
       ----------      ----------            ----------
         lorem          Work Phone         000.111.2020
         ipsum          Email              test@email.com

To

    Name          Work Phone                Email
    ----------    ----------            ----------
    lorem        000.111.2020        test2@email.com
    ipsum        001.101.2010        test3@email.com

I don't think I should use pivot here because I don't need to aggregate anything, I just want the row data to become a column.",2
2967136,06/03/2010 14:59:12,355002,06/01/2010 01:49:32,1,0,I need an answer book of Michael Mannino,"I want to do another problems of database development application and design book of Michael Mannino but really I don't know the correct answer of them .I have searched a lot for downloading this book but I couldn't find it ,please help me that how can I find it or is there any other book with this subject that has answer for its problem.(I need a link)

thanks",sql,,,,,06/03/2010 15:12:06,not a real question,1,67,8,"I need an answer book of Michael Mannino I want to do another problems of database development application and design book of Michael Mannino but really I don't know the correct answer of them .I have searched a lot for downloading this book but I couldn't find it ,please help me that how can I find it or is there any other book with this subject that has answer for its problem.(I need a link)

thanks",1
10791765,05/29/2012 00:27:08,979700,10/05/2011 04:50:00,1,0,Write a LINQ query to get count on a boolean sharepoint2010 field,"I have a single table:

UserName|Completed<br/>
Moran|0<br/>
Moran|1<br/>
Moran|1<br/>
Moran|0<br/>
Russ|1<br/>
Russ|1<br/>
Russ|1<br/>
James|0<br/>
James|0<br/>
James|1<br/>


I need a LINQ query (OR CAML as this is Sharepoint 2010) that will pull back the following results: 

Distinct UserName & Count of 0's from the competed column.  This would show that user Moran has 2 incomplete task, Russ has none and James has 2

Moran|2
Russ|0
James|2

The following query works in SQL

select DISTINCT a.UserName, (select count(*) from AmexTransactions where Completed = 0 AND UserName = a.UserName) from AmexTransactions a

I need this in either LINQ or in Sharepoint 2010 object has the data is stored in a SP2010 list.
",sql,linq,sharepoint,,,,open,0,92,12,"Write a LINQ query to get count on a boolean sharepoint2010 field I have a single table:

UserName|Completed<br/>
Moran|0<br/>
Moran|1<br/>
Moran|1<br/>
Moran|0<br/>
Russ|1<br/>
Russ|1<br/>
Russ|1<br/>
James|0<br/>
James|0<br/>
James|1<br/>


I need a LINQ query (OR CAML as this is Sharepoint 2010) that will pull back the following results: 

Distinct UserName & Count of 0's from the competed column.  This would show that user Moran has 2 incomplete task, Russ has none and James has 2

Moran|2
Russ|0
James|2

The following query works in SQL

select DISTINCT a.UserName, (select count(*) from AmexTransactions where Completed = 0 AND UserName = a.UserName) from AmexTransactions a

I need this in either LINQ or in Sharepoint 2010 object has the data is stored in a SP2010 list.
",3
10712817,05/23/2012 02:49:43,1148011,01/13/2012 15:50:35,1,0,Rails 3.2 ActiveRecord SQL syntax error,"I just wrote controller for ajax call like this:

    def create 
        @like = Like.new(params[:like])
        post = params[:like][:post_id]
        uid = params[:like][:ip_address]
        @extant = Like.find(:last, :conditions => [""post_id ? AND ip_address = ?"", post, uid])
        last_like_time = @extant.created_at unless @extant.blank?
        curr_time = Time.now
        
        if ((@extant && curr_time - last_like_time >= 24.hours) || @extant.blank?)
          respond_to do |format|
            if @like.save
              format.js
              format.html { redirect_to :back }
            else
              format.html { redirect_to posts_path }
              format.json { render :json => @like.errors, :status => @unprocessable_entity }
            end
        end
        
        else
          render :js => ""alert('You already liked this.');""
        end
        
    end

And this is view erb.

    <%= form_for(@like, :remote => true) do |f| %>
    <%= f.hidden_field ""post_id"", :value => @post.id %>
    <%= f.hidden_field ""ip_address"", :value => request.remote_ip %>
    <%= submit_tag ""Like"" %>
    <% end %>


And it executes SQL command like this:

    SELECT  ""likes"".* FROM ""likes""  WHERE (post_id '1' AND ip_address = '127.0.0.1') ORDER BY ""likes"".""id"" DESC LIMIT 1

It causes SQL syntax error. I think my ruby syntax is wrong, so how can I fix?",sql,ruby-on-rails,ruby,ruby-on-rails-3,activerecord,,open,0,386,6,"Rails 3.2 ActiveRecord SQL syntax error I just wrote controller for ajax call like this:

    def create 
        @like = Like.new(params[:like])
        post = params[:like][:post_id]
        uid = params[:like][:ip_address]
        @extant = Like.find(:last, :conditions => [""post_id ? AND ip_address = ?"", post, uid])
        last_like_time = @extant.created_at unless @extant.blank?
        curr_time = Time.now
        
        if ((@extant && curr_time - last_like_time >= 24.hours) || @extant.blank?)
          respond_to do |format|
            if @like.save
              format.js
              format.html { redirect_to :back }
            else
              format.html { redirect_to posts_path }
              format.json { render :json => @like.errors, :status => @unprocessable_entity }
            end
        end
        
        else
          render :js => ""alert('You already liked this.');""
        end
        
    end

And this is view erb.

    <%= form_for(@like, :remote => true) do |f| %>
    <%= f.hidden_field ""post_id"", :value => @post.id %>
    <%= f.hidden_field ""ip_address"", :value => request.remote_ip %>
    <%= submit_tag ""Like"" %>
    <% end %>


And it executes SQL command like this:

    SELECT  ""likes"".* FROM ""likes""  WHERE (post_id '1' AND ip_address = '127.0.0.1') ORDER BY ""likes"".""id"" DESC LIMIT 1

It causes SQL syntax error. I think my ruby syntax is wrong, so how can I fix?",5
11712299,07/29/2012 19:34:01,1494662,07/01/2012 19:04:12,6,0,MSSQL Can insert into child table,"-- Referrals
CREATE TABLE RSSreferral
(
	ReferralID INT PRIMARY KEY IDENTITY(1,1) NOT NULL,
	RefType VARCHAR(25) NOT NULL,
	RefName VARCHAR(25) NOT NULL,
	RefPhysical_Add VARCHAR(25) NOT NULL,
	RefPostal_Add VARCHAR(25),
	RefEmail VARCHAR(25) NOT NULL,
	RefTele VARCHAR(25)NOT NULL,
	RefFax VARCHAR(25)); 


-- I want to take referral name from the referral table then add it the RSSclient_referral 
 --Client Referal Associate
CREATE TABLE RSSclient_referral
(
    	ReferralID INT FOREIGN KEY REFERENCES RSSreferral(ReferralID) NOT NULL,
	
	RefDate DATE NOT NULL,
	RefReason VARCHAR(45) NOT NULL,
	CONSTRAINT [PK_ClientReferral] PRIMARY KEY CLUSTERED (ReferralID)
);

CREATE PROCEDURE Add_ClientsReferred
(
    	
	
	@RefDate DATE,
	@RefReason VARCHAR(45) 
)
AS
INSERT INTO RSSclient_referral (,RefDate,RefReason) 
VALUES (@RefDate,@RefReason)
GO
",sql,sql-server-2008-r2,,,,07/30/2012 06:40:37,not a real question,1,84,6,"MSSQL Can insert into child table -- Referrals
CREATE TABLE RSSreferral
(
	ReferralID INT PRIMARY KEY IDENTITY(1,1) NOT NULL,
	RefType VARCHAR(25) NOT NULL,
	RefName VARCHAR(25) NOT NULL,
	RefPhysical_Add VARCHAR(25) NOT NULL,
	RefPostal_Add VARCHAR(25),
	RefEmail VARCHAR(25) NOT NULL,
	RefTele VARCHAR(25)NOT NULL,
	RefFax VARCHAR(25)); 


-- I want to take referral name from the referral table then add it the RSSclient_referral 
 --Client Referal Associate
CREATE TABLE RSSclient_referral
(
    	ReferralID INT FOREIGN KEY REFERENCES RSSreferral(ReferralID) NOT NULL,
	
	RefDate DATE NOT NULL,
	RefReason VARCHAR(45) NOT NULL,
	CONSTRAINT [PK_ClientReferral] PRIMARY KEY CLUSTERED (ReferralID)
);

CREATE PROCEDURE Add_ClientsReferred
(
    	
	
	@RefDate DATE,
	@RefReason VARCHAR(45) 
)
AS
INSERT INTO RSSclient_referral (,RefDate,RefReason) 
VALUES (@RefDate,@RefReason)
GO
",2
621418,03/07/2009 06:21:35,10333,09/15/2008 22:28:36,504,25,Best cross-platform/SQL GUI?,"I use SQL Server 2005, MySql, and Posgresql regularly.  I'm tired of using Microsoft's SQL tool for SQL Server, phpMyAdmin for MySql, and pgAdmin for Postgres.

Is there a decent cross-platform GUI that I can use for all of these database servers? I don't care about the actual database administration part, I realize that each vendor's tool has specific functionality for administrative purposes.  I just care about running queries on data.  I prefer free, but if a good tool is going to cost me a little bit of money, that's fine.

Thanks!",sql,mysql,sql-server,postgresql,,05/22/2012 10:09:42,not constructive,1,93,3,"Best cross-platform/SQL GUI? I use SQL Server 2005, MySql, and Posgresql regularly.  I'm tired of using Microsoft's SQL tool for SQL Server, phpMyAdmin for MySql, and pgAdmin for Postgres.

Is there a decent cross-platform GUI that I can use for all of these database servers? I don't care about the actual database administration part, I realize that each vendor's tool has specific functionality for administrative purposes.  I just care about running queries on data.  I prefer free, but if a good tool is going to cost me a little bit of money, that's fine.

Thanks!",4
10226544,04/19/2012 10:55:06,1343742,04/19/2012 10:49:56,1,0,Determining average from database using VB6,"I’m trying to work out an average grade from a database file using the ‘Do Loop’ method; I’m completely clueless how to even start it. Does anyone have any tips or is able to help me?
Regards, Jack.  
",sql,database,vb6,,,04/24/2012 02:20:08,not a real question,1,39,6,"Determining average from database using VB6 I’m trying to work out an average grade from a database file using the ‘Do Loop’ method; I’m completely clueless how to even start it. Does anyone have any tips or is able to help me?
Regards, Jack.  
",3
6997805,08/09/2011 14:29:32,335175,05/07/2010 07:02:45,67,4,SQL Server - Reduce number of Reads,"I have one general question about optimization at SQL Server: How I can reduce number of Reads in stored procedure? 

I'm interested in good practices like: 
- creating indexes at physical and temp tables
- using temp tables instead using same table couple times in procedure
- DDL before DML
- SET NOCOUNT ON at the beginning of stored procedure
- ...

We have issue with disk space that is used because of huge number of reads that is caused by couple stored procedures and I need to optimize it.

TnX in advance!

Nemanja",sql,sql-server,tsql,stored-procedures,query-optimization,08/09/2011 15:08:11,not a real question,1,87,7,"SQL Server - Reduce number of Reads I have one general question about optimization at SQL Server: How I can reduce number of Reads in stored procedure? 

I'm interested in good practices like: 
- creating indexes at physical and temp tables
- using temp tables instead using same table couple times in procedure
- DDL before DML
- SET NOCOUNT ON at the beginning of stored procedure
- ...

We have issue with disk space that is used because of huge number of reads that is caused by couple stored procedures and I need to optimize it.

TnX in advance!

Nemanja",5
2847662,05/17/2010 08:44:49,334380,05/06/2010 11:48:18,6,0,what is the difference between union and join ,"i m confused union and join 
     ",sql,,,,,,open,0,12,9,"what is the difference between union and join  i m confused union and join 
     ",1
4607256,01/05/2011 17:36:54,425481,12/28/2009 16:31:50,297,8,sql server table search for term in field,"I need to create a script that will be usable on 10 tables with very much the same structure. I have to reference two columns in each table where the columns are
searchitem
feed
I need to search for each searchitem in its matching feed field and get a confirmation if it the field feed, contains it or not. I thought of using charindex but not sure if this would be appropriate and how to do it for each record.

    SELECT CHARINDEX(searchitem, feed)
    FROM Production
    WHERE not searchitem is null.",sql,sql-server-2005,,,,,open,0,96,8,"sql server table search for term in field I need to create a script that will be usable on 10 tables with very much the same structure. I have to reference two columns in each table where the columns are
searchitem
feed
I need to search for each searchitem in its matching feed field and get a confirmation if it the field feed, contains it or not. I thought of using charindex but not sure if this would be appropriate and how to do it for each record.

    SELECT CHARINDEX(searchitem, feed)
    FROM Production
    WHERE not searchitem is null.",2
7684537,10/07/2011 08:01:41,593627,01/28/2011 10:20:04,5622,236,How to update field from SQL database,"I have a lotus notes application that has a document with a `Number`, and a `description` field.

Users reserve a series of numbers at which point documents are created. They then fill in the description and a few other things.


Once this is done they go into another, application (Qpulse; not a notes application) that stores its data in an SQL database.
They will create documents in that system with matching numbers.

Once the documents are created in that system (Qpulse) i'd like update the description field in notes.

How i've done it in the past is to have a notes agent running that does a query, looping through the results finding and updating notes documents.

Is there a better way of doing this? It would be nice to have it automatically updating.",sql,fields,lotus-notes,updating,,,open,0,127,7,"How to update field from SQL database I have a lotus notes application that has a document with a `Number`, and a `description` field.

Users reserve a series of numbers at which point documents are created. They then fill in the description and a few other things.


Once this is done they go into another, application (Qpulse; not a notes application) that stores its data in an SQL database.
They will create documents in that system with matching numbers.

Once the documents are created in that system (Qpulse) i'd like update the description field in notes.

How i've done it in the past is to have a notes agent running that does a query, looping through the results finding and updating notes documents.

Is there a better way of doing this? It would be nice to have it automatically updating.",4
2571915,04/03/2010 16:48:23,287282,03/05/2010 16:25:36,95,9,Return number of rows affected by SQL UPDATE statement in Java,"I'm using a MySQL database and accessing it through Java.  

    PreparedStatement prep1 = this.connection.prepareStatement(""UPDATE user_table SET Level = 'Super' WHERE Username = ?"");
    prep1.setString(1,username);

The update statement above works fine however I'd like to get the number of rows affected with this statement. Is this possible please?

Thanks and regards,
Krt_Malta",sql,update,,,,,open,0,56,11,"Return number of rows affected by SQL UPDATE statement in Java I'm using a MySQL database and accessing it through Java.  

    PreparedStatement prep1 = this.connection.prepareStatement(""UPDATE user_table SET Level = 'Super' WHERE Username = ?"");
    prep1.setString(1,username);

The update statement above works fine however I'd like to get the number of rows affected with this statement. Is this possible please?

Thanks and regards,
Krt_Malta",2
3236106,07/13/2010 10:12:26,8768,09/15/2008 16:50:17,991,52,Generic Stored Procedures,"I am writing a stored procedure to handle the populating of a database from csv files. There about 150 tables and there will be 1 CSV file per table.

There is some added complication in that data needs to be validated against a validation table on import.

I am currently writing a single Store Procedure, that will take the csv file name, table name and validation table name as parameters and then handle the import from any csv file to any table. Obviously this saves having 150 store procedures, one for each table. 

But my question is, is this the right way to do this? Having this generic procedure involves using quite a bit of dynamic SQL and from what I have been reading writing stored procedures where you don't know what tables you will be using, the schema of the tables etc until run time, is a bad thing. But then so is writing 150 stored procedures that do a similar thing, and that is only going to confuse the person doing the import when they have to know what stored procedure to call for which table.

This import will be a one time thing, so performance is not so much an issue, and the only persons running it will have full permissions to the DB, so security is not much of an issue. I'd like to hear your thoughts on what the best method is here.

",sql,sql-server,stored-procedures,,,,open,0,235,3,"Generic Stored Procedures I am writing a stored procedure to handle the populating of a database from csv files. There about 150 tables and there will be 1 CSV file per table.

There is some added complication in that data needs to be validated against a validation table on import.

I am currently writing a single Store Procedure, that will take the csv file name, table name and validation table name as parameters and then handle the import from any csv file to any table. Obviously this saves having 150 store procedures, one for each table. 

But my question is, is this the right way to do this? Having this generic procedure involves using quite a bit of dynamic SQL and from what I have been reading writing stored procedures where you don't know what tables you will be using, the schema of the tables etc until run time, is a bad thing. But then so is writing 150 stored procedures that do a similar thing, and that is only going to confuse the person doing the import when they have to know what stored procedure to call for which table.

This import will be a one time thing, so performance is not so much an issue, and the only persons running it will have full permissions to the DB, so security is not much of an issue. I'd like to hear your thoughts on what the best method is here.

",3
5435428,03/25/2011 16:42:07,127543,06/23/2009 12:14:11,1089,68,Using GREP / RegEx to find and replace string,"So, I'm trying to migrate a database from Textpattern CMS to something more generic. There are some textpattern-specific commands inside of articles that pull in images. I want to turn these into generic HTML image links. At the moment, they look like this in the sql file:

    <txp:upm_image image_id=""4"" form=""dose"" />

I want to turn these into something more like this:

    <img src=""4.jpg"" class=""dose"" />

I've had some luck with TextWrangler doing some regex stuff, but I'm stumped. Any ideas on how to find & replace all of these image paths?",sql,regex,grep,textwrangler,textpattern,,open,0,95,9,"Using GREP / RegEx to find and replace string So, I'm trying to migrate a database from Textpattern CMS to something more generic. There are some textpattern-specific commands inside of articles that pull in images. I want to turn these into generic HTML image links. At the moment, they look like this in the sql file:

    <txp:upm_image image_id=""4"" form=""dose"" />

I want to turn these into something more like this:

    <img src=""4.jpg"" class=""dose"" />

I've had some luck with TextWrangler doing some regex stuff, but I'm stumped. Any ideas on how to find & replace all of these image paths?",5
7471202,09/19/2011 12:50:13,952697,09/19/2011 12:50:13,1,0,Where can i get a huge list of english words for objects/things/items (nouns)?,"
I was wondering if anyone could be so kind as to supply me with or tell me where i can get a list of english words refereing to objects/things/items - as many as possible (1000's).

    e.g
    chair
    car
    tree
    fish
    phone
    pirate
    bat
    ball
    desk
    wallet
    spoon
    washing machine
    microwave
    shed
    motherboard

just a big text list (no decriptions etc required) can be specialist items/objects etc.

Id like this for a program/tool I am developing.
",sql,database,text,grammar,english,09/19/2011 13:35:49,off topic,1,121,13,"Where can i get a huge list of english words for objects/things/items (nouns)? 
I was wondering if anyone could be so kind as to supply me with or tell me where i can get a list of english words refereing to objects/things/items - as many as possible (1000's).

    e.g
    chair
    car
    tree
    fish
    phone
    pirate
    bat
    ball
    desk
    wallet
    spoon
    washing machine
    microwave
    shed
    motherboard

just a big text list (no decriptions etc required) can be specialist items/objects etc.

Id like this for a program/tool I am developing.
",5
7254669,08/31/2011 08:53:04,921228,08/31/2011 08:53:04,1,0,how filter values from database in vb.net,I'm developing a hospital management system. I need how get data related to a doctor which enter in text box. In my database there is a table for doctor details.  ,sql,database,vb.net,visual-studio-2008,sql-server-2005,09/10/2011 06:02:08,not a real question,1,32,7,how filter values from database in vb.net I'm developing a hospital management system. I need how get data related to a doctor which enter in text box. In my database there is a table for doctor details.  ,5
6771939,07/21/2011 06:08:20,855281,07/21/2011 06:02:55,1,0,how do i get second highest salary from each deptno from the fallowing table?,"how do i get second highest salary from each deptno from the fallowing table?
ID NAME                        AGE     DEPTNO     SALARY
-- -------------------- ---------- ---------- ----------
 1 shasank                      25         11       2025
 2 raju                         27         12       2027
 3 son                          33         12       2131
 6 bali                         31         10       2031
 4 rambo                        34         11       2345
 5 don                          32         11       2132
 7 dimpu                        31         12       2121
 8 rahul                        28         10       2341
 9 janny                        28         10       2123",sql,,,,,07/22/2011 13:04:33,not a real question,1,435,14,"how do i get second highest salary from each deptno from the fallowing table? how do i get second highest salary from each deptno from the fallowing table?
ID NAME                        AGE     DEPTNO     SALARY
-- -------------------- ---------- ---------- ----------
 1 shasank                      25         11       2025
 2 raju                         27         12       2027
 3 son                          33         12       2131
 6 bali                         31         10       2031
 4 rambo                        34         11       2345
 5 don                          32         11       2132
 7 dimpu                        31         12       2121
 8 rahul                        28         10       2341
 9 janny                        28         10       2123",1
2787847,05/07/2010 10:30:30,34537,11/05/2008 03:00:23,4495,98,How can i test my DB speed? (Learning),"I have design a database. Theres no columns with indexing, nor any code for optimizing. I am positive i should index certain columns since i search them a lot.

My question is HOW do i test if any part of my database will be slow? ATM I am using sqlite and i will be switching to either MS Sql or MySql based on my host provider. Will creating 100,000 records in each table be enough? Or will that always be fast in sqlite and i need to do 1mil? Do i need 10mil before a database will become slow?

Also how do i time it? I am using C# so should i use StopWatch or is there a ADO.NET/Sqlite function i should use?",sql,sqlite,performance,.net,database-schema,,open,0,121,8,"How can i test my DB speed? (Learning) I have design a database. Theres no columns with indexing, nor any code for optimizing. I am positive i should index certain columns since i search them a lot.

My question is HOW do i test if any part of my database will be slow? ATM I am using sqlite and i will be switching to either MS Sql or MySql based on my host provider. Will creating 100,000 records in each table be enough? Or will that always be fast in sqlite and i need to do 1mil? Do i need 10mil before a database will become slow?

Also how do i time it? I am using C# so should i use StopWatch or is there a ADO.NET/Sqlite function i should use?",5
11323905,07/04/2012 06:56:42,1498588,07/03/2012 11:14:43,1,0,data grabbing tool,"I have to write a data grabing tool. Access 2007 as front-end and Oracle 11g as back-end.
When I enter the name in the text box in the Access form. It should generate a file having related  fields for the name. the file should be preferably in excel(csv is also accepatable). In this file, some fields need to be picked up from different related tables in oracle and some fields should have static value based on options selected in list box of access form.

I am new to programming. Kindly just give me the rough idea or outlines how to accomplish this VBA Access programming project.

Thank you in advance.
",sql,vba,,,,,open,0,108,3,"data grabbing tool I have to write a data grabing tool. Access 2007 as front-end and Oracle 11g as back-end.
When I enter the name in the text box in the Access form. It should generate a file having related  fields for the name. the file should be preferably in excel(csv is also accepatable). In this file, some fields need to be picked up from different related tables in oracle and some fields should have static value based on options selected in list box of access form.

I am new to programming. Kindly just give me the rough idea or outlines how to accomplish this VBA Access programming project.

Thank you in advance.
",2
6649136,07/11/2011 11:04:33,838730,07/11/2011 11:01:01,1,1,need to know fieldwise count of records available in a table,"Can u help

I need to know fieldwise count of records available in a table.

Ex: tablename = contactinfo Fields in table: Name, Dsgn, City

Need the result as Name = 1000, Dsgn = 990, City = 850

Like that

Anoop
",sql,query,,,,,open,0,36,11,"need to know fieldwise count of records available in a table Can u help

I need to know fieldwise count of records available in a table.

Ex: tablename = contactinfo Fields in table: Name, Dsgn, City

Need the result as Name = 1000, Dsgn = 990, City = 850

Like that

Anoop
",2
8988369,01/24/2012 14:19:55,1097960,12/14/2011 14:04:23,23,0,Found Important Issue With SQL server 2008 R2. Need Advice,"Recently while installing my copy of SQL server 2008 R2; the power went OFF. So now it does say the some features are installed and some are not but when I run SQL server detection manager it says that there is nothing. I inquired further and there is probably some    problem in the registry counter. I also tried uninstalling SQL server's installed components from Control Panel and I was successful in uninstalling SOME components but some others are now saying that some totally other components are now missing and HENCE it cannot be uninstalled
================================================================================== 
The log error is below: Warning 26003. Microsoft SQl Server 2008 R2 Setup Support Files cannot be uninstalled because the following products are installed: 
*SQL Server 2008 R2 Common Files 
*SQl Server 2008 R2 Database Engine Shared. ======================================================================================
Please can I have some expert or novice (practically anyone) advice    and solution for this issue.",sql,sql-server,vb.net,visual-studio-2010,sql-server-2008,01/24/2012 14:32:15,off topic,1,153,10,"Found Important Issue With SQL server 2008 R2. Need Advice Recently while installing my copy of SQL server 2008 R2; the power went OFF. So now it does say the some features are installed and some are not but when I run SQL server detection manager it says that there is nothing. I inquired further and there is probably some    problem in the registry counter. I also tried uninstalling SQL server's installed components from Control Panel and I was successful in uninstalling SOME components but some others are now saying that some totally other components are now missing and HENCE it cannot be uninstalled
================================================================================== 
The log error is below: Warning 26003. Microsoft SQl Server 2008 R2 Setup Support Files cannot be uninstalled because the following products are installed: 
*SQL Server 2008 R2 Common Files 
*SQl Server 2008 R2 Database Engine Shared. ======================================================================================
Please can I have some expert or novice (practically anyone) advice    and solution for this issue.",5
10794843,05/29/2012 07:33:00,689779,04/03/2011 12:10:12,515,55,SQL Query for select data from multiple tables,"I have multiple tables with same design (column names are same). I want to select latest records from these table, ordered by CreationDate (such column exist in all tables).
![Something like this][1]

  [1]: http://i.stack.imgur.com/0vIED.png",sql,sql-server-2008,,,,,open,0,34,8,"SQL Query for select data from multiple tables I have multiple tables with same design (column names are same). I want to select latest records from these table, ordered by CreationDate (such column exist in all tables).
![Something like this][1]

  [1]: http://i.stack.imgur.com/0vIED.png",2
4605113,01/05/2011 14:24:30,669824,01/05/2011 14:24:30,1,0,Deleting latest Wordpress tags from database,"Hey guys, i need your help regarding Wordpress mySQL query.

**Situation**

I am using WordPress 3.0.1, installed one ""Clever plugin"" that automatically tagged my posts with tags. By mistake i marked that this plugin can tag also ""related posts"". So in the end this plugin not only created good and relevant tags to the posts i need, but also created a lot of trash tags to **un**related posts.

What i have now - lots of tags in the database and panels which really need to be deleted. I can find in database FROM WHAT TAG ID i want to delete (wp_terms table, term_id field) those tags.

**More**

I have access to phpMyAdmin, also i know that i need to delete records using SQL query from tables 

> wp_terms , wp_term_relationships, and wp_term_taxonomy

Also there was quite issue like mine here http://stackoverflow.com/questions/4539954/wordpress-mass-delete-unpopular-tags


**Help!**

Maybe someone who is falimiliar with wordpress can help help me and write query to remove tags and all needed relations from certain term_id and until end?

Thanks in advance",sql,database,wordpress,delete,tags,,open,0,163,6,"Deleting latest Wordpress tags from database Hey guys, i need your help regarding Wordpress mySQL query.

**Situation**

I am using WordPress 3.0.1, installed one ""Clever plugin"" that automatically tagged my posts with tags. By mistake i marked that this plugin can tag also ""related posts"". So in the end this plugin not only created good and relevant tags to the posts i need, but also created a lot of trash tags to **un**related posts.

What i have now - lots of tags in the database and panels which really need to be deleted. I can find in database FROM WHAT TAG ID i want to delete (wp_terms table, term_id field) those tags.

**More**

I have access to phpMyAdmin, also i know that i need to delete records using SQL query from tables 

> wp_terms , wp_term_relationships, and wp_term_taxonomy

Also there was quite issue like mine here http://stackoverflow.com/questions/4539954/wordpress-mass-delete-unpopular-tags


**Help!**

Maybe someone who is falimiliar with wordpress can help help me and write query to remove tags and all needed relations from certain term_id and until end?

Thanks in advance",5
6386768,06/17/2011 13:49:19,791020,06/09/2011 13:41:41,28,0,SQL Data from One of Two Tables,"I have two tables, where only one column is the same. I am trying to write a stored procedure which pulls a value from a passed-in column name, but one which only exists in one of the tables. This is what I have written:

    IF EXISTS(
    SELECT identifier FROM TableA WHERE identifier='12345')
    SELECT ColumnWhichOnlyExistsInA FROM TableA WHERE identifier='12345'
    ELSE
    SELECT ColumnWhichOnlyExistsInA FROM TableB WHERE identifier='12345'

This gives me the 'Invalid column name' error on the last line, even though the IF statement is true and it should only be pulling stuff from TableA. I've noticed that if I replace the bottom two SELECT statements with stored procedures which do the same thing, it works; SQL doesn't try to execute the one where IF is false.

I want to keep everything in one stored procedure. What would be the best way of doing it?",sql,sql-server-2005,,,,,open,0,156,7,"SQL Data from One of Two Tables I have two tables, where only one column is the same. I am trying to write a stored procedure which pulls a value from a passed-in column name, but one which only exists in one of the tables. This is what I have written:

    IF EXISTS(
    SELECT identifier FROM TableA WHERE identifier='12345')
    SELECT ColumnWhichOnlyExistsInA FROM TableA WHERE identifier='12345'
    ELSE
    SELECT ColumnWhichOnlyExistsInA FROM TableB WHERE identifier='12345'

This gives me the 'Invalid column name' error on the last line, even though the IF statement is true and it should only be pulling stuff from TableA. I've noticed that if I replace the bottom two SELECT statements with stored procedures which do the same thing, it works; SQL doesn't try to execute the one where IF is false.

I want to keep everything in one stored procedure. What would be the best way of doing it?",2
4474873,12/17/2010 21:24:59,339843,05/13/2010 00:27:55,21,3,What is the most efficient way to count rows in a table in SQLite?,"I've always just used ""SELECT COUNT(1) FROM X"" but perhaps this is not the most efficient.  Any thoughts?  Other options include SELECT COUNT(*) or perhaps getting the last inserted id if it is auto-incremented (and never deleted).

How about if I just want to know if there is anything in the table at all?  (e.g., count > 0?)",sql,sqlite,,,,,open,0,60,14,"What is the most efficient way to count rows in a table in SQLite? I've always just used ""SELECT COUNT(1) FROM X"" but perhaps this is not the most efficient.  Any thoughts?  Other options include SELECT COUNT(*) or perhaps getting the last inserted id if it is auto-incremented (and never deleted).

How about if I just want to know if there is anything in the table at all?  (e.g., count > 0?)",2
377375,12/18/2008 09:47:05,11236,09/16/2008 06:29:28,894,32,A noob's guide to SQL database design,"Do you know a good source to learn how to design SQL solutions?

Beyond the basic language syntax, I'm looking for something to help me understand:

1. What tables to build and how to link them
2. How to design for different scales (small client APP to a huge distributed website)
3. How to write effective / efficient  / elegant SQL queries
",sql,database-design,design,database,scalability,,open,0,59,7,"A noob's guide to SQL database design Do you know a good source to learn how to design SQL solutions?

Beyond the basic language syntax, I'm looking for something to help me understand:

1. What tables to build and how to link them
2. How to design for different scales (small client APP to a huge distributed website)
3. How to write effective / efficient  / elegant SQL queries
",5
7149402,08/22/2011 14:59:48,906131,08/22/2011 14:59:48,1,0,Export SQL Server Querry to an Excel sheet,"I have a query (ex:- select * from emp). I want to export the result of this query to an excel sheet automaticly and the file name also should be dynamic (Ex:- emp_1,Emp_2,....).

Kindly help me...

Thanks in Advance

Venkat",sql,server,,,,08/22/2011 15:11:11,not a real question,1,37,8,"Export SQL Server Querry to an Excel sheet I have a query (ex:- select * from emp). I want to export the result of this query to an excel sheet automaticly and the file name also should be dynamic (Ex:- emp_1,Emp_2,....).

Kindly help me...

Thanks in Advance

Venkat",2
10916361,06/06/2012 14:32:49,1146096,01/12/2012 17:42:24,1,0,How to properly secure Windows server 2008 R2 that will host sql server 2012?,"I want this server to be inaccesible through DMZ accept for IPSEC connections, and to also have a private network which will be accessible through another windows 2008 server which will host vpn.  

That is how our windows 2003 infrastracture works and I am trying to do the same with 2008 servers, are there any guides or documentations that have this scenario?",sql,security,server,vpn,ipsec,06/06/2012 15:11:39,off topic,1,63,14,"How to properly secure Windows server 2008 R2 that will host sql server 2012? I want this server to be inaccesible through DMZ accept for IPSEC connections, and to also have a private network which will be accessible through another windows 2008 server which will host vpn.  

That is how our windows 2003 infrastracture works and I am trying to do the same with 2008 servers, are there any guides or documentations that have this scenario?",5
7367323,09/09/2011 20:52:22,838359,07/11/2011 06:48:16,42,0,convert strings of type mm/dd/yyyy h to date time,"I have a function which converts all of the strings to datetime. 

     ALTER FUNCTION formatit(
      @fromtime VARCHAR(50) -- varchar
       )
    RETURNS DATETIME
    AS 
    BEGIN 
    DECLARE @from datetime
     IF (CHARINDEX('NOON',@fromtime,0)) = 0 
       SET @from = CONVERT(DATETIME, @fromtime) 
     ELSE
       SET @from =CONVERT(DATETIME, '01/01/2000 12pm') 
    RETURN(@from)
    END

     SELECT dbo.formatit('04/12/2011 12 ')

So when u see the last select stmt it throws an error saying:
        
      The conversion of a char data type to a datetime data type resulted in an out-of-
      range datetime value.

It works fine if i give time 4 pm or 4:00. But it gives an error if i give just 4. Kindly let me know how i can handle this?
",sql,sql-server-2008,,,,,open,0,189,9,"convert strings of type mm/dd/yyyy h to date time I have a function which converts all of the strings to datetime. 

     ALTER FUNCTION formatit(
      @fromtime VARCHAR(50) -- varchar
       )
    RETURNS DATETIME
    AS 
    BEGIN 
    DECLARE @from datetime
     IF (CHARINDEX('NOON',@fromtime,0)) = 0 
       SET @from = CONVERT(DATETIME, @fromtime) 
     ELSE
       SET @from =CONVERT(DATETIME, '01/01/2000 12pm') 
    RETURN(@from)
    END

     SELECT dbo.formatit('04/12/2011 12 ')

So when u see the last select stmt it throws an error saying:
        
      The conversion of a char data type to a datetime data type resulted in an out-of-
      range datetime value.

It works fine if i give time 4 pm or 4:00. But it gives an error if i give just 4. Kindly let me know how i can handle this?
",2
4663698,01/11/2011 23:06:05,55563,01/15/2009 19:04:39,413,25,How can I display a consolidated version of my Sql Server table?,"please, consider this simplified scenario for an SQL Server database. This is not exactly the way my tables are built, but the example is enough for what I need to know.

I have a product table with a primary key, let's say, IdProduct, and some other columns, like the product name and description.

Then I have something like a total sales per month table (SalesPerMonth). This second table holds some fields like

IdMonthlySale (key)
IdProduct (foreign key to the main table)
TotalSales (money)
Monthy (int or smallint)
Year (int or smallint)

The second table will hold the detailed info. We can track the sales of a certain product by doing a SELECT * FROM SalesPerMonth WHERE ProductId = xx

But let's say I want to display this data as if it wasn't normalized. I want a flat Product X Month/Year table that shows the last 8 months. Something more or less like this:


      Prod     *  Jan  *  Feb  *  Mar  *  Apr  *  May  *  Jun  *  Jul  *  Aug  *
    -----------------------------------------------------------------------------
    Prod 1     * 500.00* 480.00* 470.00* 510.00* 555.00* 530.00* 440.00* 490.00*
    -----------------------------------------------------------------------------
    Prod 2     * 650.00* 680.00* 670.00* 710.00* 755.00* 630.00* 740.00* 820.00*


Well. I hope you get the idea. I need to flatten the resulting table and I need to output it that way to my users. How can I accomplish that? Thanks in advance.",sql,sql-server,table,,,,open,0,263,12,"How can I display a consolidated version of my Sql Server table? please, consider this simplified scenario for an SQL Server database. This is not exactly the way my tables are built, but the example is enough for what I need to know.

I have a product table with a primary key, let's say, IdProduct, and some other columns, like the product name and description.

Then I have something like a total sales per month table (SalesPerMonth). This second table holds some fields like

IdMonthlySale (key)
IdProduct (foreign key to the main table)
TotalSales (money)
Monthy (int or smallint)
Year (int or smallint)

The second table will hold the detailed info. We can track the sales of a certain product by doing a SELECT * FROM SalesPerMonth WHERE ProductId = xx

But let's say I want to display this data as if it wasn't normalized. I want a flat Product X Month/Year table that shows the last 8 months. Something more or less like this:


      Prod     *  Jan  *  Feb  *  Mar  *  Apr  *  May  *  Jun  *  Jul  *  Aug  *
    -----------------------------------------------------------------------------
    Prod 1     * 500.00* 480.00* 470.00* 510.00* 555.00* 530.00* 440.00* 490.00*
    -----------------------------------------------------------------------------
    Prod 2     * 650.00* 680.00* 670.00* 710.00* 755.00* 630.00* 740.00* 820.00*


Well. I hope you get the idea. I need to flatten the resulting table and I need to output it that way to my users. How can I accomplish that? Thanks in advance.",3
5195768,03/04/2011 15:30:24,456188,09/23/2010 13:05:06,1284,65,Discovering Stored Procedures (accessing sysobjects from ADO.NET),"I am re-writing/porting what amounts to a database management system.

There are several places in the old code (written in VB6 w/ ADO classic) where `sysobjects` and other similar tables are used to get lists of Tables, Columns, and the like.  Thus far I've been able to retrieve ALL the data I need by a combination of `SqlConnection.GetSchema` and `SqlDataReader.GetSchemaTable` with a `select * from <TABLE_OF_INTEREST>`.  I'm now stuck trying to get the stored procedures.  The original query looks like this:

    select *
    from sysobjects
    where type = 'P' and category = 0
    order by name

I've got a similar query using `GetSchema`:

    conn.GetSchema(""Procedures"").Rows.Cast<DataRow>()
        .Where(r => (r[""ROUTINE_TYPE""] as string) == ""PROCEDURE"")
        .Select(r => r[""SPECIFIC_NAME""] as string)
        .OrderBy(r => r);

Unfortunately these queries return completely different numbers of items, leaving me wondering what the difference is.  There *is* significant overlap, but they're not close enough.

So my questions are: 

 1. What am I doing wrong, or misunderstanding?
 2. What *should* I be doing?

",sql,ado.net,vb6-migration,,,03/04/2011 16:47:20,too localized,1,199,7,"Discovering Stored Procedures (accessing sysobjects from ADO.NET) I am re-writing/porting what amounts to a database management system.

There are several places in the old code (written in VB6 w/ ADO classic) where `sysobjects` and other similar tables are used to get lists of Tables, Columns, and the like.  Thus far I've been able to retrieve ALL the data I need by a combination of `SqlConnection.GetSchema` and `SqlDataReader.GetSchemaTable` with a `select * from <TABLE_OF_INTEREST>`.  I'm now stuck trying to get the stored procedures.  The original query looks like this:

    select *
    from sysobjects
    where type = 'P' and category = 0
    order by name

I've got a similar query using `GetSchema`:

    conn.GetSchema(""Procedures"").Rows.Cast<DataRow>()
        .Where(r => (r[""ROUTINE_TYPE""] as string) == ""PROCEDURE"")
        .Select(r => r[""SPECIFIC_NAME""] as string)
        .OrderBy(r => r);

Unfortunately these queries return completely different numbers of items, leaving me wondering what the difference is.  There *is* significant overlap, but they're not close enough.

So my questions are: 

 1. What am I doing wrong, or misunderstanding?
 2. What *should* I be doing?

",3
5659809,04/14/2011 07:14:13,707455,04/14/2011 07:14:13,1,0,"what do stack overrun, heap overrun, array indexing error have in common","what are examples related to

 1. stack overrun
 2. heap overrun
 3. array indexing error",sql,,,,,04/14/2011 08:06:02,not a real question,1,15,12,"what do stack overrun, heap overrun, array indexing error have in common what are examples related to

 1. stack overrun
 2. heap overrun
 3. array indexing error",1
4491052,12/20/2010 15:27:25,121261,06/11/2009 11:56:45,48,3,Numbering of groups in select (Oracle),"I have a following example - table with name, department and country. I need to create a select statement that lists all records and assigns unique number to each group of department and country (column Group in the example):

    Name   Department   Country   Group
    ====== ============ ========= =====
    James  HR           UK        1
    John   HR           UK        1
    Alice  Finance      UK        2
    Bob    Finance      DE        3
    Frank  Finance      DE        3

I thought of some select with analytic function but I found only `row_number() over (partition by department, country)` which numbers records inside the group and not groups themselves. Do you have any idea how to solve this problem? Thank you!",sql,oracle,,,,,open,0,211,6,"Numbering of groups in select (Oracle) I have a following example - table with name, department and country. I need to create a select statement that lists all records and assigns unique number to each group of department and country (column Group in the example):

    Name   Department   Country   Group
    ====== ============ ========= =====
    James  HR           UK        1
    John   HR           UK        1
    Alice  Finance      UK        2
    Bob    Finance      DE        3
    Frank  Finance      DE        3

I thought of some select with analytic function but I found only `row_number() over (partition by department, country)` which numbers records inside the group and not groups themselves. Do you have any idea how to solve this problem? Thank you!",2
7596425,09/29/2011 11:06:50,970969,09/29/2011 10:59:58,1,0,How to concatonate null strings in DB2?,"I have to concatenate 2 columns (ex. FIRSTANME and LASTNAME). I do it this way: `FIRSTANME || ' ' || LASTNAME`. If one of them is null, bet other one is not null, I get null as concatenation result. And I want following behavior FIRSTANME = null and LASTNAME = ""Smith"" ==> FIRSTANME || ' ' || LASTNAME == ' Smith'. How to solve this in DB2?",sql,database,db2,,,,open,0,67,7,"How to concatonate null strings in DB2? I have to concatenate 2 columns (ex. FIRSTANME and LASTNAME). I do it this way: `FIRSTANME || ' ' || LASTNAME`. If one of them is null, bet other one is not null, I get null as concatenation result. And I want following behavior FIRSTANME = null and LASTNAME = ""Smith"" ==> FIRSTANME || ' ' || LASTNAME == ' Smith'. How to solve this in DB2?",3
3294809,07/20/2010 22:10:01,280043,02/24/2010 04:36:55,21,3,Special case of updating a column with not null and unique constraints in PostgreSQL,"This is a toy example that illustrates a real problem in PostgreSQL.  The below examples are using a PostgreSQL 8.4.3 server, but I suspect other versions have the same problem.

Given the following table:

<pre>
=> create table tmp_foo (foo boolean not null unique, bar boolean not null unique);
=> insert into tmp_foo (foo, bar) values (true, true), (false, false);
=> select * from tmp_foo;
 foo | bar 
-----+-----
 t   | t
 f   | f
</pre>

can the table be modified to look like this:
<pre>
=> select * from tmp_foo;
 foo | bar 
-----+-----
 t   | f
 f   | t
</pre>

without deleting rows or modifying the table schema?  This:
<pre>
=> update tmp_foo set bar = not bar;
ERROR:  duplicate key value violates unique constraint ""tmp_foo_bar_key""
</pre>
does not work.

If deletes are allowed, this:
<pre>
=> create temp table tmp_foo_2 as select * from tmp_foo;
=> update tmp_foo_2 set bar = not bar;
=> delete from tmp_foo;
=> insert into tmp_foo select * from tmp_foo_2;
</pre>
works.  It is not the simplest solution for this example, but it is easily generalizable to more complex examples.",sql,postgresql,constraints,unique-constraint,,,open,0,176,14,"Special case of updating a column with not null and unique constraints in PostgreSQL This is a toy example that illustrates a real problem in PostgreSQL.  The below examples are using a PostgreSQL 8.4.3 server, but I suspect other versions have the same problem.

Given the following table:

<pre>
=> create table tmp_foo (foo boolean not null unique, bar boolean not null unique);
=> insert into tmp_foo (foo, bar) values (true, true), (false, false);
=> select * from tmp_foo;
 foo | bar 
-----+-----
 t   | t
 f   | f
</pre>

can the table be modified to look like this:
<pre>
=> select * from tmp_foo;
 foo | bar 
-----+-----
 t   | f
 f   | t
</pre>

without deleting rows or modifying the table schema?  This:
<pre>
=> update tmp_foo set bar = not bar;
ERROR:  duplicate key value violates unique constraint ""tmp_foo_bar_key""
</pre>
does not work.

If deletes are allowed, this:
<pre>
=> create temp table tmp_foo_2 as select * from tmp_foo;
=> update tmp_foo_2 set bar = not bar;
=> delete from tmp_foo;
=> insert into tmp_foo select * from tmp_foo_2;
</pre>
works.  It is not the simplest solution for this example, but it is easily generalizable to more complex examples.",4
11623052,07/24/2012 01:56:18,1186009,02/02/2012 19:46:14,338,1,Where Exists returning all rows,"My `where exists` clause isn't working.  What trivial thing am I missing?

    select * from patient as p
    where exists
    (
    	select p.patientid, count(*) from tblclaims as c 
    	inner join patient as p on p.patientid=c.patientid
    	and p.admissiondate = c.admissiondate
    	and p.dischargedate = c.dischargedate
    	group by p.patientid
    	having count(*)>500
    )

patient and tblclaims are joined together by the three-field composite key as as you can see in the query.",sql,,,,,,open,0,99,5,"Where Exists returning all rows My `where exists` clause isn't working.  What trivial thing am I missing?

    select * from patient as p
    where exists
    (
    	select p.patientid, count(*) from tblclaims as c 
    	inner join patient as p on p.patientid=c.patientid
    	and p.admissiondate = c.admissiondate
    	and p.dischargedate = c.dischargedate
    	group by p.patientid
    	having count(*)>500
    )

patient and tblclaims are joined together by the three-field composite key as as you can see in the query.",1
4450736,12/15/2010 14:06:06,179727,09/27/2009 10:22:11,82,3,sql server and RAM,"I'm using sql server 2008 enterprise on my online server, the main database has tables that expect more than 2 million records per month, as these tables grow sql server takes a lot from the 4GB memory installed and then closing the server ram.
  I've restricted the sql ram to 2GB but, when it uses these ram it stop working well destroy connections and performs too slowly.
 is it normal? and what can i do to get back the ram from sql server after querying these large tables?",sql,sql-server-2008,,,,,open,0,89,4,"sql server and RAM I'm using sql server 2008 enterprise on my online server, the main database has tables that expect more than 2 million records per month, as these tables grow sql server takes a lot from the 4GB memory installed and then closing the server ram.
  I've restricted the sql ram to 2GB but, when it uses these ram it stop working well destroy connections and performs too slowly.
 is it normal? and what can i do to get back the ram from sql server after querying these large tables?",2
8886632,01/16/2012 21:38:50,1152568,01/16/2012 19:48:09,1,0,SQL GROUP BY clause does not produce distinct rows,"I have two tables:  
t1(date d, name c(20), debit n(7), credit n(7))  
t2(date d, name c(20), type c(25), obal n(7))

Here's the sample data.  
T1:

    DATE		NAME		DEBIT	CREDIT
    01.01.12	dad					5000
    01.01.12	mum					6000
    05.01.12	school		1000	
    01.02.12	dad					5000
    01.02.12	mum					6000
    10.02.12	tuition		300	
    10.02.12	snacks		100	
    01.03.12	dad					5000
    01.03.12	mum					6000
    01.03.12	books		500	
    02.03.12	rice		500	
    02.03.12	vegetables	900	
    03.03.12	snacks		100	
    01.04.12	dad					5000
    01.04.12	mum					6000
    01.04.12	meat		200	
    21.04.12	guest		800	

T2:

    DATE		NAME		TYPE		OBAL
    01.01.12	dr fee		medical		8000
    01.01.12	medicine	medical		-10000
    01.01.12	dad			income		400000
    01.01.12	mum			income		450000
    05.01.12	school		education	0
    10.02.12	tuition		education	0
    10.02.12	snacks		misc		0
    01.03.12	books		education	0
    02.03.12	rice		food		0
    02.03.12	vegetables	food		0
    01.04.12	meat		food		0
    21.04.12	guest		misc		0

Sum of (obal + credit - debit) for each name grouped by type (t2) is expected. Query used and output obtained is:

    SELECT t2.type, obal + SUM(NVL(credit - debit, 0)) as bal FROM t2 LEFT JOIN t1 ;
    ON t2.name = t1.name GROUP BY t2.type, t2.obal

    TYPE		BAL
    education	-1800
    food		-1600
    income		420000
    income		474000
    medical		-10000
    medical		8000
    misc		-1000

My doubt is why should the _type_ `income` and `medical` comes twice in the query output in spite of GROUP BY clause being used? I've tried adding DISTINCT clause before the column _t2.type_ and that too produces the same output! One thing I could observe is that the two records of _type_ `medical` in table **t2** has no records in **t1** matching the same _name_ and two records of _type_ `income` has a non-zero _obal_ in **t2**. Please help me to overcome this problem.

Regards,  
Ganapathy",sql,group,,,,,open,0,320,9,"SQL GROUP BY clause does not produce distinct rows I have two tables:  
t1(date d, name c(20), debit n(7), credit n(7))  
t2(date d, name c(20), type c(25), obal n(7))

Here's the sample data.  
T1:

    DATE		NAME		DEBIT	CREDIT
    01.01.12	dad					5000
    01.01.12	mum					6000
    05.01.12	school		1000	
    01.02.12	dad					5000
    01.02.12	mum					6000
    10.02.12	tuition		300	
    10.02.12	snacks		100	
    01.03.12	dad					5000
    01.03.12	mum					6000
    01.03.12	books		500	
    02.03.12	rice		500	
    02.03.12	vegetables	900	
    03.03.12	snacks		100	
    01.04.12	dad					5000
    01.04.12	mum					6000
    01.04.12	meat		200	
    21.04.12	guest		800	

T2:

    DATE		NAME		TYPE		OBAL
    01.01.12	dr fee		medical		8000
    01.01.12	medicine	medical		-10000
    01.01.12	dad			income		400000
    01.01.12	mum			income		450000
    05.01.12	school		education	0
    10.02.12	tuition		education	0
    10.02.12	snacks		misc		0
    01.03.12	books		education	0
    02.03.12	rice		food		0
    02.03.12	vegetables	food		0
    01.04.12	meat		food		0
    21.04.12	guest		misc		0

Sum of (obal + credit - debit) for each name grouped by type (t2) is expected. Query used and output obtained is:

    SELECT t2.type, obal + SUM(NVL(credit - debit, 0)) as bal FROM t2 LEFT JOIN t1 ;
    ON t2.name = t1.name GROUP BY t2.type, t2.obal

    TYPE		BAL
    education	-1800
    food		-1600
    income		420000
    income		474000
    medical		-10000
    medical		8000
    misc		-1000

My doubt is why should the _type_ `income` and `medical` comes twice in the query output in spite of GROUP BY clause being used? I've tried adding DISTINCT clause before the column _t2.type_ and that too produces the same output! One thing I could observe is that the two records of _type_ `medical` in table **t2** has no records in **t1** matching the same _name_ and two records of _type_ `income` has a non-zero _obal_ in **t2**. Please help me to overcome this problem.

Regards,  
Ganapathy",2
11456820,07/12/2012 16:57:19,1517628,07/11/2012 11:33:24,3,0,How to write in DISTINCT clause for all columns bar 1,"I have a SELECT statement which is part of my sql code:

    SELECT q.QuestionId, q.QuestionContent, o.OptionType, q.NoofAnswers, GROUP_CONCAT(an.Answer ORDER BY an.Answer SEPARATOR ' ') AS Answer, r.ReplyType, 
           q.QuestionMarks 

I want to use the DISTINCT clause on all of my columns except for q.QuestionId column, how can this be written because in my attempts I keep getting errors.

Thanks",sql,,,,,,open,0,71,11,"How to write in DISTINCT clause for all columns bar 1 I have a SELECT statement which is part of my sql code:

    SELECT q.QuestionId, q.QuestionContent, o.OptionType, q.NoofAnswers, GROUP_CONCAT(an.Answer ORDER BY an.Answer SEPARATOR ' ') AS Answer, r.ReplyType, 
           q.QuestionMarks 

I want to use the DISTINCT clause on all of my columns except for q.QuestionId column, how can this be written because in my attempts I keep getting errors.

Thanks",1
10312373,04/25/2012 08:56:03,183610,10/03/2009 13:55:53,16,1,Granting limited permissions to a user on SQL Server 2008,"How can you give sysadmin rights to a user on particular Databases so he can perform every action on those databases including backup and restore. But this user should not be able to access some other Databases on server.
And this user should also have the rights to create new database on server, to create/alter linked server and also create/alter a job in job agent.

What permissions and server roles should I assign to acheive all above?

Any help would be appreciated!

Thanks!

",sql,server,permissions,user,,,open,0,79,10,"Granting limited permissions to a user on SQL Server 2008 How can you give sysadmin rights to a user on particular Databases so he can perform every action on those databases including backup and restore. But this user should not be able to access some other Databases on server.
And this user should also have the rights to create new database on server, to create/alter linked server and also create/alter a job in job agent.

What permissions and server roles should I assign to acheive all above?

Any help would be appreciated!

Thanks!

",4
8149167,11/16/2011 09:14:29,136141,07/10/2009 08:41:48,3967,38,Can you reccomend a book which especially covers those TWO subjects for SQL?,"I am not a total beginner on SQL; I have some basic knowledge on writing queries containing many types of joins etc. to extract some data and also to manipulate the data.

But I am lack of information on how to 

* analyze the performance of my queries
* the execution plan
* how to optimize a query scenerio
* how to investigate the possible REASONS for a slow query etc.

So, **can you reccomend me SQL book that especially covers**:

* Brief explanation on How MS-SQL Server works inside when it comes to select a data
* How to write/re-write more effective queries when it comes to work with many tables performing on massive data 

Thanks!

",sql,sql-server-2008,tsql,books,,11/28/2011 20:46:25,not constructive,1,110,13,"Can you reccomend a book which especially covers those TWO subjects for SQL? I am not a total beginner on SQL; I have some basic knowledge on writing queries containing many types of joins etc. to extract some data and also to manipulate the data.

But I am lack of information on how to 

* analyze the performance of my queries
* the execution plan
* how to optimize a query scenerio
* how to investigate the possible REASONS for a slow query etc.

So, **can you reccomend me SQL book that especially covers**:

* Brief explanation on How MS-SQL Server works inside when it comes to select a data
* How to write/re-write more effective queries when it comes to work with many tables performing on massive data 

Thanks!

",4
3885644,10/07/2010 20:32:24,272072,02/12/2010 19:09:08,46,2,"How can I explore the data in a SQL database, including foreign tables?","I want to know if any tools exist to explore the data in a relational database, and to drill through master-detail relationships.

I already know how to view the data in a single table, and I know how to construct SQL queries that JOIN tables.  However, to get N-levels deep, I have to write a SQL statement, find the ID of the item I'm interested in, and repeat N times.  It is extremely tedious and hard to visualize the results.

However, I want to know if there is a tool that lets me look at the data in a table, and if there are foreign keys, lets me expand the data to show the foreign data.  And hopefully, lets me drill through multiple levels of detail.

Do any such tools exist?

I'm using MS SQL, and using SQL Server Management Studio to execute SQL.",sql,sql-server,ssms,,,,open,0,143,13,"How can I explore the data in a SQL database, including foreign tables? I want to know if any tools exist to explore the data in a relational database, and to drill through master-detail relationships.

I already know how to view the data in a single table, and I know how to construct SQL queries that JOIN tables.  However, to get N-levels deep, I have to write a SQL statement, find the ID of the item I'm interested in, and repeat N times.  It is extremely tedious and hard to visualize the results.

However, I want to know if there is a tool that lets me look at the data in a table, and if there are foreign keys, lets me expand the data to show the foreign data.  And hopefully, lets me drill through multiple levels of detail.

Do any such tools exist?

I'm using MS SQL, and using SQL Server Management Studio to execute SQL.",3
3600313,08/30/2010 12:33:56,407309,07/31/2010 05:52:58,42,0,query for ms access,"my query is `""SELECT column_name, table_name FROM information_schema.columns""`
.but it execute true in sqlserver ,but it dosn't execute true 
in Ms Access.i want to get all colums and tables'name from specific
database.thanks.",sql,query,ms-access,,,,open,0,30,4,"query for ms access my query is `""SELECT column_name, table_name FROM information_schema.columns""`
.but it execute true in sqlserver ,but it dosn't execute true 
in Ms Access.i want to get all colums and tables'name from specific
database.thanks.",3
5322161,03/16/2011 07:23:11,339995,05/13/2010 06:28:06,41,6,SQL query 'not in' clause execution takes too long,"the following query takes too much time, most likely because of a 'not in' use.

Can you suggest any improvement ?



    select vCode, vName,	1014 as	fID from testCodes co 
    where co.vCode not in (SELECT dict.vcode FROM DataDictionary dict WHERE dict.fID= 1014)

one thing about structure is .
vCode,vName is varchar
and testCodes and DataDictionary have same structure.


I searched this problem and found that the left join can possibly resolve this? (WHY does it do better and how can it be done)?

can someone guide if it can be improved ???",sql,query,,,,,open,0,91,9,"SQL query 'not in' clause execution takes too long the following query takes too much time, most likely because of a 'not in' use.

Can you suggest any improvement ?



    select vCode, vName,	1014 as	fID from testCodes co 
    where co.vCode not in (SELECT dict.vcode FROM DataDictionary dict WHERE dict.fID= 1014)

one thing about structure is .
vCode,vName is varchar
and testCodes and DataDictionary have same structure.


I searched this problem and found that the left join can possibly resolve this? (WHY does it do better and how can it be done)?

can someone guide if it can be improved ???",2
7468757,09/19/2011 09:20:58,952343,09/19/2011 09:20:58,1,0,more than 3 entries in the column,"I have a table say XYZ, there are three entries for each entity of the column say 'a' and I want to find out if there are more than 3 entries for those entities in the column.

column: a      b      c
        123
        123
        123
        sol
        sol
        sol
        456
        456
        456
Here I want to know if I have more than 3 entries for 123 or sol or 456 in the tab
",sql,,,,,09/19/2011 11:54:07,not a real question,1,142,7,"more than 3 entries in the column I have a table say XYZ, there are three entries for each entity of the column say 'a' and I want to find out if there are more than 3 entries for those entities in the column.

column: a      b      c
        123
        123
        123
        sol
        sol
        sol
        456
        456
        456
Here I want to know if I have more than 3 entries for 123 or sol or 456 in the tab
",1
6518888,06/29/2011 10:04:02,806250,06/20/2011 08:01:19,66,3,"How to find number of stored procedures, tables ,functions present in a Database","How to find number of stored procedures, tables ,functions  present in a Database?

Please help me finding the above.
",sql,sql-server-2008,,,,,open,0,19,13,"How to find number of stored procedures, tables ,functions present in a Database How to find number of stored procedures, tables ,functions  present in a Database?

Please help me finding the above.
",2
6781932,07/21/2011 19:54:34,856760,07/21/2011 19:54:34,1,0,sql server transactions,"i am new to MS SQL Server, i hava a situation, I am running a web service application that need to handel a lot of data, i have 4 stored procedures that are comibed in one big transaction/procedure(there is no atother way), i'm doing insert in 3 diferent tables, but then the amount of data is to big and the requests that  are at max  0,5 seconds apart i'm geting some problems, even thow in the java code i'm geting that the data was procest(@retValue). I'm using transaction isolation level serializable atherwise the i'm geting deadlooks with AWAINTING QUERY @@TANSCAOUT>0 ROLLBACL TRANS. any sugestions?
 ",sql,server,transactions,deadlock,mybatis,07/22/2011 01:47:36,not a real question,1,107,3,"sql server transactions i am new to MS SQL Server, i hava a situation, I am running a web service application that need to handel a lot of data, i have 4 stored procedures that are comibed in one big transaction/procedure(there is no atother way), i'm doing insert in 3 diferent tables, but then the amount of data is to big and the requests that  are at max  0,5 seconds apart i'm geting some problems, even thow in the java code i'm geting that the data was procest(@retValue). I'm using transaction isolation level serializable atherwise the i'm geting deadlooks with AWAINTING QUERY @@TANSCAOUT>0 ROLLBACL TRANS. any sugestions?
 ",5
11558913,07/19/2012 10:31:13,1537592,07/19/2012 10:24:22,1,0,MS SQL SERVER 2008,"in local am installed  SQL2008 But server in MS SQl 2005 is installed , any body tell is there any type conversion error or something error will occur  ?
",sql,sql-server-2005,sql-server-2008-r2,,,07/19/2012 18:34:38,not a real question,1,31,4,"MS SQL SERVER 2008 in local am installed  SQL2008 But server in MS SQl 2005 is installed , any body tell is there any type conversion error or something error will occur  ?
",3
3189938,07/06/2010 20:24:39,157503,08/17/2009 01:59:18,220,3,Wordpress latest Posts AND comments feed?,"I'm trying to write a custom SQL query that will create a list of the most recent Posts AND comments and I'm having trouble visualizing how i can do this. 

I can pull the latest comments by date DESC and i can pull the latest posts by date DESC but how do I make a feed / query to show them both?

Here is my comment SQL

    SELECT comment_id, comment_content, comment_date
    FROM wp_comments
    WHERE comment_author = 'admin'
    ORDER BY comment_date DESC

",sql,mysql,wordpress,,,,open,0,92,6,"Wordpress latest Posts AND comments feed? I'm trying to write a custom SQL query that will create a list of the most recent Posts AND comments and I'm having trouble visualizing how i can do this. 

I can pull the latest comments by date DESC and i can pull the latest posts by date DESC but how do I make a feed / query to show them both?

Here is my comment SQL

    SELECT comment_id, comment_content, comment_date
    FROM wp_comments
    WHERE comment_author = 'admin'
    ORDER BY comment_date DESC

",3
4728577,01/18/2011 20:16:54,97767,04/29/2009 15:31:45,596,20,mySQL: Get some random and some specific records in a single query?,"So I have a cover-flow style image carousel populated by a query like

    SELECT foo FROM `imageTable` ORDER BY RAND() LIMIT 0, 12;

My client would like to add to this a set of permanent images.  Due to the way the results are used it would be very handy if I could make those records part of my original query.

I tried 

    SELECT foo FROM `imageTable` WHERE `id` = 'x' OR `id` = 'y' 
      OR `id` IS NOT NULL ORDER BY RAND() LIMIT 0, 12;

I was hoping the records with the ids would necessarily be in the result set but nope the RAND() shuffles the whole set.

So my question is whether any single query could provide the x permanent records and then y random records?

TIA

JG",sql,mysql,random,,,,open,0,137,12,"mySQL: Get some random and some specific records in a single query? So I have a cover-flow style image carousel populated by a query like

    SELECT foo FROM `imageTable` ORDER BY RAND() LIMIT 0, 12;

My client would like to add to this a set of permanent images.  Due to the way the results are used it would be very handy if I could make those records part of my original query.

I tried 

    SELECT foo FROM `imageTable` WHERE `id` = 'x' OR `id` = 'y' 
      OR `id` IS NOT NULL ORDER BY RAND() LIMIT 0, 12;

I was hoping the records with the ids would necessarily be in the result set but nope the RAND() shuffles the whole set.

So my question is whether any single query could provide the x permanent records and then y random records?

TIA

JG",3
3212174,07/09/2010 11:32:38,450469,07/08/2010 06:03:23,31,1,Which one is better  in SQL ?,"Which one is better in SQL ?

SELECT A.COL_A1, B.COL_B1 FROM TABLE1 A, TABLE2 B
WHERE A.COL_A1 = B.COL_B1

                 OR

SELECT B.COL_B1, A.COL_A1 FROM TABLE2 B, TABLE1 A
WHERE B.COL_B1 = A.COL_A1

more info..
http://publib.boulder.ibm.com/infocenter/iisclzos/v9r1/index.jsp?topic=/com.ibm.websphere.ii.federation.classic.tuning.doc/tuning/iiyfctqcjoin.html",sql,,,,,07/09/2010 15:31:10,not a real question,1,45,8,"Which one is better  in SQL ? Which one is better in SQL ?

SELECT A.COL_A1, B.COL_B1 FROM TABLE1 A, TABLE2 B
WHERE A.COL_A1 = B.COL_B1

                 OR

SELECT B.COL_B1, A.COL_A1 FROM TABLE2 B, TABLE1 A
WHERE B.COL_B1 = A.COL_A1

more info..
http://publib.boulder.ibm.com/infocenter/iisclzos/v9r1/index.jsp?topic=/com.ibm.websphere.ii.federation.classic.tuning.doc/tuning/iiyfctqcjoin.html",1
16568,08/19/2008 17:13:11,1944,08/19/2008 14:49:14,18,0,How to select the nth row in a SQL database table?,"I'm interested in learning some (ideally) database agnostic ways of selecting the *n*th row from a database table. It would also be interesting to see how this can be achieved using the native functionality of the following databases: 

  - SQL Server
  - MySQL
  - PostgreSQL
  - SQLite
  - Oracle

I am currently doing something like the following in SQL Server 2005, but I'd be interested in seeing other's more agnostic approaches:

<pre>WITH Ordered AS (
SELECT ROW_NUMBER() OVER (ORDER BY OrderID) AS RowNumber, OrderID, OrderDate
FROM Orders)
SELECT *
FROM Ordered
WHERE RowNumber = 1000000</pre>

Credit for the above SQL: [Firoz Ansari's Weblog][1]

  [1]: http://weblogs.asp.net/Firoz/archive/2005/06/12/411949.aspx",sql,database,,,,,open,0,104,11,"How to select the nth row in a SQL database table? I'm interested in learning some (ideally) database agnostic ways of selecting the *n*th row from a database table. It would also be interesting to see how this can be achieved using the native functionality of the following databases: 

  - SQL Server
  - MySQL
  - PostgreSQL
  - SQLite
  - Oracle

I am currently doing something like the following in SQL Server 2005, but I'd be interested in seeing other's more agnostic approaches:

<pre>WITH Ordered AS (
SELECT ROW_NUMBER() OVER (ORDER BY OrderID) AS RowNumber, OrderID, OrderDate
FROM Orders)
SELECT *
FROM Ordered
WHERE RowNumber = 1000000</pre>

Credit for the above SQL: [Firoz Ansari's Weblog][1]

  [1]: http://weblogs.asp.net/Firoz/archive/2005/06/12/411949.aspx",2
5435930,03/25/2011 17:22:09,677176,03/25/2011 17:22:09,1,0,How to get records from the database which got one similar field and different dates,"I really need your urgent help guys. I have one table 'ITEM' with fields: ID, NAME, STATUS, RECEIVED_AT (TIMESTAMP).

I need to get all records with status = 'canceled' and only if there is another record in this table with status = 'available' that has earlier received_at date. Can't do anything to it, maybe because it is Friday evening, or maybe because I am not yet experienced enough.

I am very appreciate for your help!",sql,,,,,,open,0,73,15,"How to get records from the database which got one similar field and different dates I really need your urgent help guys. I have one table 'ITEM' with fields: ID, NAME, STATUS, RECEIVED_AT (TIMESTAMP).

I need to get all records with status = 'canceled' and only if there is another record in this table with status = 'available' that has earlier received_at date. Can't do anything to it, maybe because it is Friday evening, or maybe because I am not yet experienced enough.

I am very appreciate for your help!",1
8778751,01/08/2012 15:30:33,1051849,11/17/2011 13:08:10,34,0,ruby rails - getting a collection of objects from a collection of foreign keys,"Easy one i think/hope... I have a query that returns a list of 20 unique foreign keys:

    @results   = Report.select(""distinct user_id"").where(""datetime_utc >= ? AND datetime_utc <= ?"",@utc_time_slot , @utc_time_slot_end).order(""score DESC, quality DESC"").limit(20)  

this returns an array (ActiveRecord::Relation class):

    [#<Report user_id: 803>, #<Report user_id: 809>, #<Report user_id: 806>, #<Report user_id: 801>, #<Report user_id: 830>, #<Report user_id: 860>, #<Report user_id: 858>, #<Report user_id: 856>, #<Report user_id: 854>, #<Report user_id: 852>, #<Report user_id: 851>, #<Report user_id: 850>, #<Report user_id: 849>, #<Report user_id: 846>, #<Report user_id: 859>, #<Report user_id: 866>, #<Report user_id: 2022>, #<Report user_id: 863>, #<Report user_id: 862>, #<Report user_id: 838>]

What do i need to do with this @results array to extract the collection of users form the users table that the user_id list refers to (in the same order)?

Thanks!

",sql,ruby,activerecord,ruby-on-rails-3.1,,,open,0,136,14,"ruby rails - getting a collection of objects from a collection of foreign keys Easy one i think/hope... I have a query that returns a list of 20 unique foreign keys:

    @results   = Report.select(""distinct user_id"").where(""datetime_utc >= ? AND datetime_utc <= ?"",@utc_time_slot , @utc_time_slot_end).order(""score DESC, quality DESC"").limit(20)  

this returns an array (ActiveRecord::Relation class):

    [#<Report user_id: 803>, #<Report user_id: 809>, #<Report user_id: 806>, #<Report user_id: 801>, #<Report user_id: 830>, #<Report user_id: 860>, #<Report user_id: 858>, #<Report user_id: 856>, #<Report user_id: 854>, #<Report user_id: 852>, #<Report user_id: 851>, #<Report user_id: 850>, #<Report user_id: 849>, #<Report user_id: 846>, #<Report user_id: 859>, #<Report user_id: 866>, #<Report user_id: 2022>, #<Report user_id: 863>, #<Report user_id: 862>, #<Report user_id: 838>]

What do i need to do with this @results array to extract the collection of users form the users table that the user_id list refers to (in the same order)?

Thanks!

",4
9716154,03/15/2012 08:28:58,755255,05/16/2011 07:24:23,201,29,Populating temporary table with result of independent Sql Query,"I want to return a temporary table from `stored procedure` which populates with data retrieved from two independent sql query  

    Select column1,column2 FROM TABLE1 WHERE someCondition
    Select column3,column4 FROM TABLE1 WHERE someOtherCondition
    INSERT INTO Temp_table(column1,column2,column3,column4) values VALUE from those two table

Some of the result from table contains null as well.Also i am using some mathematical function like `sum` on some column as well
Thanks in advance",sql,sql-server-2005,,,,,open,0,76,9,"Populating temporary table with result of independent Sql Query I want to return a temporary table from `stored procedure` which populates with data retrieved from two independent sql query  

    Select column1,column2 FROM TABLE1 WHERE someCondition
    Select column3,column4 FROM TABLE1 WHERE someOtherCondition
    INSERT INTO Temp_table(column1,column2,column3,column4) values VALUE from those two table

Some of the result from table contains null as well.Also i am using some mathematical function like `sum` on some column as well
Thanks in advance",2
6069397,05/20/2011 08:36:21,762394,05/20/2011 08:36:21,1,0,Ways to Replace Null Values with Crystal Reports 2008 (not formula solution),"I'm working with Crystal reports. I have made many reports. And recently I was told, that null values should be printed as text ('no value') and not blank. I understand that I should create formula:

    If isnull({some_field}) then 'no value' else {some_field}

and put this formula on report. But this will take many pointless hours. Are there any shorter way?

My enviroment: Crystal reports 2008 and Oracle db.

Thanks.",sql,database,oracle,query,crystal-reports,,open,0,69,12,"Ways to Replace Null Values with Crystal Reports 2008 (not formula solution) I'm working with Crystal reports. I have made many reports. And recently I was told, that null values should be printed as text ('no value') and not blank. I understand that I should create formula:

    If isnull({some_field}) then 'no value' else {some_field}

and put this formula on report. But this will take many pointless hours. Are there any shorter way?

My enviroment: Crystal reports 2008 and Oracle db.

Thanks.",5
9915125,03/28/2012 20:25:02,75893,03/09/2009 23:23:59,29,1,duplicate rows in ssrs using sql,"I need to use SSRS (SQl Server Reporting Service) and I don't know alot about the program..

I write the query to retreive all the stores with all completed and active inspection date. 

this is the query:

    select 
    s.Id, s.NameEnglish, 

    (select MAX (Inspection.StartDate) from Inspection where EntityId = s.Id and EntityType= 'STORE') 'last Inspection',
    i.StartDate as CompletedInspection, 
    it.StartDate 'New Insp' 
    
    from 
    Store s
    LEFT JOIN Inspection i
    on EntityId = s.Id and EntityType = 'STORE'
    
    
    LEFT JOIN (StoreTransaction st INNER JOIN BusinessTransaction bt
    on st.BusinessTransactionId = bt.Id and bt.Status = 'NEW'
    INNER JOIN InspectionTransaction it
    on it.EntityTransactionId = st.Id)
    on st.FacilityId = s.Id

The retreive info will be link that:
Ex.

    id       Name       LastInspection        CompletedInspection        ActiveInspection
    1        Store1     18/2/2012             15/3/2011                  13/3/2012
    1        Store1     18/2/2012             18/2/2012                  13/3/2012
    2        Store2     17/3/2012             17/3/2012                  
    3        Store3     11/1/2012             11/1/2012                  13/3/2012
    3        Store3     11/1/2012             11/1/2012                  27/3/2012

Notes that:
1. Store 1 will duplicate because we have two different dates in completed inspection
2. Store 2 there is no duplication because we have only one row
3. Store 3 we have duplication in last inspection, completed inspection because we have two different dates in active..


    The report formal: 
    Name: Store 1 
    Last Inspection: 18/2/2012
     
    Completed inspection         Active inspection  
    15/3/2011	                    13/3/2012 
    18/2/2012	                    13/3/2012

 

The problem is:

when i run the query in SSRS and use the table or list to retreive the information
I will have the duplicate dates!


I want the report format become like this:

    Name: Store1 
    Last Inspection: 18/2/2012
    
    Completed inspection         Active inspection  
    15/3/2011	                    13/3/2012 
    18/2/2012


I tried to use table and list and they give me the same results! (the duplication)


Can someone help me, please

",sql,reporting-services,,,,,open,0,688,6,"duplicate rows in ssrs using sql I need to use SSRS (SQl Server Reporting Service) and I don't know alot about the program..

I write the query to retreive all the stores with all completed and active inspection date. 

this is the query:

    select 
    s.Id, s.NameEnglish, 

    (select MAX (Inspection.StartDate) from Inspection where EntityId = s.Id and EntityType= 'STORE') 'last Inspection',
    i.StartDate as CompletedInspection, 
    it.StartDate 'New Insp' 
    
    from 
    Store s
    LEFT JOIN Inspection i
    on EntityId = s.Id and EntityType = 'STORE'
    
    
    LEFT JOIN (StoreTransaction st INNER JOIN BusinessTransaction bt
    on st.BusinessTransactionId = bt.Id and bt.Status = 'NEW'
    INNER JOIN InspectionTransaction it
    on it.EntityTransactionId = st.Id)
    on st.FacilityId = s.Id

The retreive info will be link that:
Ex.

    id       Name       LastInspection        CompletedInspection        ActiveInspection
    1        Store1     18/2/2012             15/3/2011                  13/3/2012
    1        Store1     18/2/2012             18/2/2012                  13/3/2012
    2        Store2     17/3/2012             17/3/2012                  
    3        Store3     11/1/2012             11/1/2012                  13/3/2012
    3        Store3     11/1/2012             11/1/2012                  27/3/2012

Notes that:
1. Store 1 will duplicate because we have two different dates in completed inspection
2. Store 2 there is no duplication because we have only one row
3. Store 3 we have duplication in last inspection, completed inspection because we have two different dates in active..


    The report formal: 
    Name: Store 1 
    Last Inspection: 18/2/2012
     
    Completed inspection         Active inspection  
    15/3/2011	                    13/3/2012 
    18/2/2012	                    13/3/2012

 

The problem is:

when i run the query in SSRS and use the table or list to retreive the information
I will have the duplicate dates!


I want the report format become like this:

    Name: Store1 
    Last Inspection: 18/2/2012
    
    Completed inspection         Active inspection  
    15/3/2011	                    13/3/2012 
    18/2/2012


I tried to use table and list and they give me the same results! (the duplication)


Can someone help me, please

",2
693874,03/29/2009 00:37:03,44286,12/08/2008 12:56:11,76,2,best way to get good with sql queries,"As a programmer I would like to get a strong hold on writing queries.  In my college years I've read a few sql books and rest I've just learned working as a programmer for last couple of years.  But as those queries were work related...they weren't that 'hard' or complex.  

what would you guys suggest ? Is there a good advanced sql book that would teach and then test the knowledge by giving some questions?

Thanks!",sql,,,,,09/16/2011 09:44:36,not constructive,1,78,8,"best way to get good with sql queries As a programmer I would like to get a strong hold on writing queries.  In my college years I've read a few sql books and rest I've just learned working as a programmer for last couple of years.  But as those queries were work related...they weren't that 'hard' or complex.  

what would you guys suggest ? Is there a good advanced sql book that would teach and then test the knowledge by giving some questions?

Thanks!",1
11010204,06/13/2012 07:38:05,1452946,06/13/2012 06:35:34,1,0,How can i get the Roomattributes Description which belongs to the Rooms SQL,"i have 3 Tables is my SQL Database:

    First Table: Room: ID <pk>, Roomname
    Second Table: RoomRelationsship: ID<pk>, Room_ID <fk>, Roomattributes_ID<fk>
    Third Table: Roomattributes: ID<pk>, Attributename


How can i get the Roomattributes, which belongs to the Rooms. I need a SQL Query. 



Thank you in advance",sql,sql-server-2008,,,,,open,0,54,13,"How can i get the Roomattributes Description which belongs to the Rooms SQL i have 3 Tables is my SQL Database:

    First Table: Room: ID <pk>, Roomname
    Second Table: RoomRelationsship: ID<pk>, Room_ID <fk>, Roomattributes_ID<fk>
    Third Table: Roomattributes: ID<pk>, Attributename


How can i get the Roomattributes, which belongs to the Rooms. I need a SQL Query. 



Thank you in advance",2
3302221,07/21/2010 17:49:52,368616,06/16/2010 19:54:13,13,0,Update a column in a table with values from two other tables,"I have to update a column in Table 'A' with values from Table 'B'. If any value in Table 'B'
is null or empty then I have to get the value from table 'C'. 

Manu ",sql,,,,,,open,0,35,12,"Update a column in a table with values from two other tables I have to update a column in Table 'A' with values from Table 'B'. If any value in Table 'B'
is null or empty then I have to get the value from table 'C'. 

Manu ",1
4017603,10/25/2010 18:24:41,397339,07/20/2010 22:16:35,13,1,SQL duplicate data for excel dynamic table,"First thanks for reading me and sorry for my bad english.

I have the following code on sql server 2008 r2

    
<pre><code>SELECT FA960.*,
UMCONVPZ.UMFR,
UMCONVPZ.UMCONF AS Piezas,
UMCONVPL.UMCONF AS PL, 
UMCONVCJ.UMCONF AS Cajas
FROM FA960 FA960
INNER JOIN UMCONV UMCONVPZ
ON FA960.RECURV = UMCONVPZ.UMRESR 
INNER JOIN UMCONV UMCONVPL
ON FA960.RECURV = UMCONVPL.UMRESR 
INNER JOIN UMCONV UMCONVCJ
ON FA960.RECURV = UMCONVCJ.UMRESR
WHERE FA960.RMUMSR = UMCONVPZ.UMFR
AND UMCONVPZ.UMTO = 'PZ' 
AND UMCONVPL.UMTO = 'PL' 
AND UMCONVCJ.UMTO = 'CJ'
</code></pre>

This is a view, the UMCONV table is a conversion of measures that goes from palets to boxes, to pieces.

Now my problem is that CJ (Boxes) go to both PZ (Pieces) and PL (Palets) thus making me a duplicate entry that bring ""trash data"".

Any idea of how to solve it? so far I think force it to convert and do a rock paper scissors

Any other idea?",sql,sql-server,excel,,,,open,0,133,7,"SQL duplicate data for excel dynamic table First thanks for reading me and sorry for my bad english.

I have the following code on sql server 2008 r2

    
<pre><code>SELECT FA960.*,
UMCONVPZ.UMFR,
UMCONVPZ.UMCONF AS Piezas,
UMCONVPL.UMCONF AS PL, 
UMCONVCJ.UMCONF AS Cajas
FROM FA960 FA960
INNER JOIN UMCONV UMCONVPZ
ON FA960.RECURV = UMCONVPZ.UMRESR 
INNER JOIN UMCONV UMCONVPL
ON FA960.RECURV = UMCONVPL.UMRESR 
INNER JOIN UMCONV UMCONVCJ
ON FA960.RECURV = UMCONVCJ.UMRESR
WHERE FA960.RMUMSR = UMCONVPZ.UMFR
AND UMCONVPZ.UMTO = 'PZ' 
AND UMCONVPL.UMTO = 'PL' 
AND UMCONVCJ.UMTO = 'CJ'
</code></pre>

This is a view, the UMCONV table is a conversion of measures that goes from palets to boxes, to pieces.

Now my problem is that CJ (Boxes) go to both PZ (Pieces) and PL (Palets) thus making me a duplicate entry that bring ""trash data"".

Any idea of how to solve it? so far I think force it to convert and do a rock paper scissors

Any other idea?",3
312552,11/23/2008 14:10:59,1969,08/19/2008 16:03:19,1555,97,Looking for an embeddable SQL beautifier or reformatter,"I am looking for a Java open source beautifier or reformatter for SQL that I can use to clean up DDL statements that I am generating with [openArchitectureWare][1].

Nothing in the answer to ""[Online Code Beautifier And Formatter][2]"" is of use to me and I have not been able to get [Simple SQL Formatter][3] to work for me.


  [1]: http://www.openarchitectureware.org
  [2]: http://stackoverflow.com/questions/206441/online-code-beautifier-and-formatter
  [3]: http://www.ohloh.net/projects/simplesqlformatter",sql,java,,,,,open,0,66,8,"Looking for an embeddable SQL beautifier or reformatter I am looking for a Java open source beautifier or reformatter for SQL that I can use to clean up DDL statements that I am generating with [openArchitectureWare][1].

Nothing in the answer to ""[Online Code Beautifier And Formatter][2]"" is of use to me and I have not been able to get [Simple SQL Formatter][3] to work for me.


  [1]: http://www.openarchitectureware.org
  [2]: http://stackoverflow.com/questions/206441/online-code-beautifier-and-formatter
  [3]: http://www.ohloh.net/projects/simplesqlformatter",2
7278905,09/02/2011 03:16:39,924520,09/02/2011 02:03:19,1,0,Efficiently find top-N values from multiple columns independently in Oracle,"Suppose I have 30 billion rows with multiple columns, and I want to efficiently find the top N most-frequent values for each column independently, and with the most elegant SQL possible. For example, if I have 

    FirstName LastName FavoriteAnimal FavoriteBook
    --------- -------- -------------- ------------
    Ferris    Freemont Possum         Ubik
    Nancy     Freemont Lemur          Housekeeping
    Nancy     Drew     Penguin        Ubik
    Bill      Ribbits  Lemur          Dhalgren

and I want the top-1, then the result would be:

    FirstName LastName FavoriteAnimal FavoriteBook
    --------- -------- -------------- ------------
    Nancy     Freemont Lemur          Ubik

I can probably think of ways to do it, but not sure if they're optimal, which is important when there are 30 billion rows; and the SQL might be big and ugly, and maybe too much temp space would be used.

Using Oracle.

",sql,oracle,top-n,,,,open,0,217,10,"Efficiently find top-N values from multiple columns independently in Oracle Suppose I have 30 billion rows with multiple columns, and I want to efficiently find the top N most-frequent values for each column independently, and with the most elegant SQL possible. For example, if I have 

    FirstName LastName FavoriteAnimal FavoriteBook
    --------- -------- -------------- ------------
    Ferris    Freemont Possum         Ubik
    Nancy     Freemont Lemur          Housekeeping
    Nancy     Drew     Penguin        Ubik
    Bill      Ribbits  Lemur          Dhalgren

and I want the top-1, then the result would be:

    FirstName LastName FavoriteAnimal FavoriteBook
    --------- -------- -------------- ------------
    Nancy     Freemont Lemur          Ubik

I can probably think of ways to do it, but not sure if they're optimal, which is important when there are 30 billion rows; and the SQL might be big and ugly, and maybe too much temp space would be used.

Using Oracle.

",3
6663890,07/12/2011 12:05:10,826790,07/03/2011 10:31:27,18,0,sql query - how to filter results from last hour?,"I would only like to get only the data from the last hour. the query should be something like that...


SELECT some_date_related_data FROM some_table
WHERE time > now() - (1hour)

how can i achieve that?

Thanks!",sql,,,,,11/11/2011 09:42:20,not a real question,1,32,10,"sql query - how to filter results from last hour? I would only like to get only the data from the last hour. the query should be something like that...


SELECT some_date_related_data FROM some_table
WHERE time > now() - (1hour)

how can i achieve that?

Thanks!",1
2042773,01/11/2010 15:31:20,209437,11/12/2009 09:27:49,11,1,Make an SQL request more efficient and tidy?,"I have the following SQL query:

    SELECT Phrases.*
    FROM Phrases
    WHERE (((Phrases.phrase) Like ""*ing aids*"") AND ((Phrases.phrase) Not Like ""*getting*"") AND ((Phrases.phrase) Not Like ""*contracting*"")) AND ((Phrases.phrase) Not Like ""*preventing*""); //(etc.)
 


Now, if I were using RegEx, I might bunch all the Nots into one big (getting|contracting|preventing), but I'm not sure how to do this in SQL.

Is there a way to render this query more legibly/elegantly?",sql,query,database,,,,open,0,75,8,"Make an SQL request more efficient and tidy? I have the following SQL query:

    SELECT Phrases.*
    FROM Phrases
    WHERE (((Phrases.phrase) Like ""*ing aids*"") AND ((Phrases.phrase) Not Like ""*getting*"") AND ((Phrases.phrase) Not Like ""*contracting*"")) AND ((Phrases.phrase) Not Like ""*preventing*""); //(etc.)
 


Now, if I were using RegEx, I might bunch all the Nots into one big (getting|contracting|preventing), but I'm not sure how to do this in SQL.

Is there a way to render this query more legibly/elegantly?",3
9481714,02/28/2012 12:14:12,873055,08/01/2011 15:39:55,84,2,Getting the last Monday of the current month using T-sql,"I know this is quite a generic question but does anyone know a good way of checking if the date is the last monday of the month. I need to use it in a stored procedure to determine if the stored procedure returns data or does nothing.

Cheers!",sql,sql-server-2008,tsql,,,,open,0,47,10,"Getting the last Monday of the current month using T-sql I know this is quite a generic question but does anyone know a good way of checking if the date is the last monday of the month. I need to use it in a stored procedure to determine if the stored procedure returns data or does nothing.

Cheers!",3
123234,09/23/2008 19:29:13,7780,09/15/2008 14:24:14,228,26,What is the best SQL libary for use in lisp?,"Ideally something that will work with Oracle, MS SQL Server, MySQL and Posgress",sql,database,postgresql,lisp,common-lisp,,open,0,13,10,"What is the best SQL libary for use in lisp? Ideally something that will work with Oracle, MS SQL Server, MySQL and Posgress",5
7752256,10/13/2011 09:45:37,970694,09/29/2011 08:22:08,34,0,change the value of tag in xml column,"I've got some code that adds new xml tag with the value of existing item to my XML MyColumn column in table MyTable. 

UPDATE MyTable SET MyColumn.modify('insert element NewItem {/RootElement/ExistingItem/node()} after (/RootElement/ExistingItem)[1]') 

What I want to do is edit this value presented as xpath expression. 
Let's say I have value of ""Test"" in my ExistingItem element.
And I want to have ""something Test else"" in my NewItem element.

What should I do?",sql,xml,tsql,xpath,,,open,0,70,8,"change the value of tag in xml column I've got some code that adds new xml tag with the value of existing item to my XML MyColumn column in table MyTable. 

UPDATE MyTable SET MyColumn.modify('insert element NewItem {/RootElement/ExistingItem/node()} after (/RootElement/ExistingItem)[1]') 

What I want to do is edit this value presented as xpath expression. 
Let's say I have value of ""Test"" in my ExistingItem element.
And I want to have ""something Test else"" in my NewItem element.

What should I do?",4
8024612,11/06/2011 01:25:09,802136,06/16/2011 19:07:58,93,0,Case function assistance needed,"I have four tables.  I'll call them A-D.  

    SELECT A.ID, B.FirstName, B.LastName, C.Desc, A.Qty, A.Price, D.State,
    D.Qty * D.Price AS ""Total Price"",
    CASE D.State
    when 'CA' then '***'
    when 'MD' then '***'
    when 'IL' then '***'
    Else D.State
    END
    FROM A, B, C, D;

The above SELECT statement displays all of that data and when the state is CA, MD, or IL it lists a new column called CASE and shows the three asterisks.  

I need to get it so that whenever the D.State is CA, MD, or IL that the A.Qty, A.Price, and the Total Price calculation are all filled with the three asterisks as to hide the data and no extra CASE column is created.  If rows don't have CA, MD, or IL in the D.State then the entire row needs to be shown as normal with no asterisks.  I have tried a few loops and I can't seem to get this correct.  If anyone has any thoughts, I would appreciate it.",sql,oracle,case,,,,open,0,197,4,"Case function assistance needed I have four tables.  I'll call them A-D.  

    SELECT A.ID, B.FirstName, B.LastName, C.Desc, A.Qty, A.Price, D.State,
    D.Qty * D.Price AS ""Total Price"",
    CASE D.State
    when 'CA' then '***'
    when 'MD' then '***'
    when 'IL' then '***'
    Else D.State
    END
    FROM A, B, C, D;

The above SELECT statement displays all of that data and when the state is CA, MD, or IL it lists a new column called CASE and shows the three asterisks.  

I need to get it so that whenever the D.State is CA, MD, or IL that the A.Qty, A.Price, and the Total Price calculation are all filled with the three asterisks as to hide the data and no extra CASE column is created.  If rows don't have CA, MD, or IL in the D.State then the entire row needs to be shown as normal with no asterisks.  I have tried a few loops and I can't seem to get this correct.  If anyone has any thoughts, I would appreciate it.",3
4704761,01/16/2011 10:03:37,498574,11/05/2010 16:57:57,84,5,SQL indexing in a key/value database?,"How to build a full index in a sorted *(e.g., based on a B+ tree)* or unsorted *(e.g., simple hashtable)* key/value database manually, to store and access data using SQL syntax?

Thanks.",sql,indexing,hashtable,binary-tree,key-value,07/21/2011 03:15:54,not constructive,1,31,6,"SQL indexing in a key/value database? How to build a full index in a sorted *(e.g., based on a B+ tree)* or unsorted *(e.g., simple hashtable)* key/value database manually, to store and access data using SQL syntax?

Thanks.",5
6317681,06/11/2011 18:09:37,631704,02/24/2011 05:31:44,1,0,Convert row into Column Sql 2008,"    Table a

>     name |  job profile
>     --------------------
>       a   |   Admin
>       b   |   user
>       c   |   employee
>       d   |   Admin
>       e   |   user
>       f   |   user
>       g   |   employee
>     
>     
>      output 
>      
>      user  | employee |  Admin
>     ___________________________
>      b     |  c       |  a
>      e     |  g       |  d
>      f     |  null    |  null",sql,sql-server-2008,,,,06/12/2011 04:30:58,not a real question,1,214,6,"Convert row into Column Sql 2008     Table a

>     name |  job profile
>     --------------------
>       a   |   Admin
>       b   |   user
>       c   |   employee
>       d   |   Admin
>       e   |   user
>       f   |   user
>       g   |   employee
>     
>     
>      output 
>      
>      user  | employee |  Admin
>     ___________________________
>      b     |  c       |  a
>      e     |  g       |  d
>      f     |  null    |  null",2
10664342,05/19/2012 10:26:24,1352310,04/23/2012 20:52:51,35,3,Is it better to make more columns or rows in a database,"Is it better to make more columns or rows in a database .
I am entering student attendance information in the table of attendance.
condition 1:
Should i include 1 week column and 3 lecture column but this is increasing the number of rows for each student because there are 16 weeks and every week has 3 lectures.??

condition 2:
Or should i add 48 lecture column which will store the attendance of each student separately.??? 

i saw many answers but i can not get it can some one help me??
thank you in advance",sql,sql-server,sql-server-2008,,,05/19/2012 20:26:59,not constructive,1,89,12,"Is it better to make more columns or rows in a database Is it better to make more columns or rows in a database .
I am entering student attendance information in the table of attendance.
condition 1:
Should i include 1 week column and 3 lecture column but this is increasing the number of rows for each student because there are 16 weeks and every week has 3 lectures.??

condition 2:
Or should i add 48 lecture column which will store the attendance of each student separately.??? 

i saw many answers but i can not get it can some one help me??
thank you in advance",3
10081262,04/09/2012 23:42:11,1313998,04/04/2012 22:41:49,6,0,SQL missing data,"Hello I wondering if there are any SQL people out there who might know the answer to a brief question:

I am attempting to search for missing data points within a table.  The data points are not suppose to be on weekends as well as various other
holidays.  I have it working by building a temporary table that holds all data points that should exist(less weekends and holidays) and then deleting
all of the valid data points that exist in the main table, leaving a remainder of data points that should be in existence however are not.

ie:   
Main Table

point 1
point 2
point 4
point 5

Temp Table  
point 1
point 2
point 3
point 4
point 5

(delete main from temp)

Remaining Temp
point 3



This is operational by passing in a start time and an end time and how many minutes per interval between data points.  I am looking to optimize so that
I don't build the temp table by looping from start time to end time in time intervals until complete, then deleting in accordance with the main table.


I am not super strong with SQL statements so I was wondering if there is a way to do dateADD within a select statement like a loop where it increases
based on how many total intervals it has completed without slowing down the server in a loop?  Honestly if anyone has any ideas as to make this go faster
it will be greatly appreciated.  I can always calculate the next expected value from the value currently being read, but again not sure how to do this outside
of a loop.  Thanks in advance, any help will be appreciated.",sql,,,,,04/09/2012 23:55:55,not a real question,1,269,3,"SQL missing data Hello I wondering if there are any SQL people out there who might know the answer to a brief question:

I am attempting to search for missing data points within a table.  The data points are not suppose to be on weekends as well as various other
holidays.  I have it working by building a temporary table that holds all data points that should exist(less weekends and holidays) and then deleting
all of the valid data points that exist in the main table, leaving a remainder of data points that should be in existence however are not.

ie:   
Main Table

point 1
point 2
point 4
point 5

Temp Table  
point 1
point 2
point 3
point 4
point 5

(delete main from temp)

Remaining Temp
point 3



This is operational by passing in a start time and an end time and how many minutes per interval between data points.  I am looking to optimize so that
I don't build the temp table by looping from start time to end time in time intervals until complete, then deleting in accordance with the main table.


I am not super strong with SQL statements so I was wondering if there is a way to do dateADD within a select statement like a loop where it increases
based on how many total intervals it has completed without slowing down the server in a loop?  Honestly if anyone has any ideas as to make this go faster
it will be greatly appreciated.  I can always calculate the next expected value from the value currently being read, but again not sure how to do this outside
of a loop.  Thanks in advance, any help will be appreciated.",1
10287615,04/23/2012 20:16:07,807019,06/20/2011 16:29:42,65,0,"When is it best to use which method of storing data out of XML, JSON and SQL in terms of performance?",For a website or an app. Thanks a lot for any help!,sql,xml,json,performance,,04/23/2012 20:31:56,not a real question,1,12,21,"When is it best to use which method of storing data out of XML, JSON and SQL in terms of performance? For a website or an app. Thanks a lot for any help!",4
5095123,02/23/2011 18:14:12,87778,04/06/2009 19:39:01,35,4,What is your favorite SQL Administrative or META Queries?,"Just stumbled upon this query for a MS-SQL server

    SELECT
    	SPID			= s.spid
    ,	BlockingSPID	= s.blocked
    ,	DatabaseName	= DB_NAME(s.dbid)
    ,	ProgramName		= s.program_name
    ,	[Status]		= s.[status]
    ,	loginName		= s.loginame
    ,	ObjectName		= OBJECT_NAME(objectid, s.dbid)
    ,	[Definition]	= CAST([text] AS VARCHAR(MAX))
    FROM      sys.sysprocesses s
    CROSS APPLY sys.dm_exec_sql_text (sql_handle)
    WHERE 
     s.spid > 50
    ORDER BY
    	DatabaseName
    ,	loginName

and was wondering if anyone else had some nifty Administrative Queries.",sql,tsql,administration,meta,,02/23/2011 18:40:27,not a real question,1,109,9,"What is your favorite SQL Administrative or META Queries? Just stumbled upon this query for a MS-SQL server

    SELECT
    	SPID			= s.spid
    ,	BlockingSPID	= s.blocked
    ,	DatabaseName	= DB_NAME(s.dbid)
    ,	ProgramName		= s.program_name
    ,	[Status]		= s.[status]
    ,	loginName		= s.loginame
    ,	ObjectName		= OBJECT_NAME(objectid, s.dbid)
    ,	[Definition]	= CAST([text] AS VARCHAR(MAX))
    FROM      sys.sysprocesses s
    CROSS APPLY sys.dm_exec_sql_text (sql_handle)
    WHERE 
     s.spid > 50
    ORDER BY
    	DatabaseName
    ,	loginName

and was wondering if anyone else had some nifty Administrative Queries.",4
8816192,01/11/2012 08:21:00,1043575,11/12/2011 21:05:51,101,0,Select query on multiple tables multiple times,"I have two tables. COMMENTS and USERS. I save user's name on COMMENTS table, but user's avatar details should be taken from USERS table.

    select c.id, c.tarih, c.yorum, c.yorumcu, (select avatarID from USERS where Username=c.yorumcu) as avatarID FROM COMMENTS c WHERE c.id = ?

The question mark at final gets replaced with NEWS_ID. (e.g news.php?id=5)

I managed to code this, but it only gets the ""last comment"" details from database, not all of them. (Let's say 5 people commented on page, it only gets the last (5th) comment, ignoring the rest.)

Can anybody help me?

Ps. Yorumcu means ""Commenter"". COMMENTS.Commenter and USERS.Username are the same.",sql,query,select,multiple,,,open,0,104,7,"Select query on multiple tables multiple times I have two tables. COMMENTS and USERS. I save user's name on COMMENTS table, but user's avatar details should be taken from USERS table.

    select c.id, c.tarih, c.yorum, c.yorumcu, (select avatarID from USERS where Username=c.yorumcu) as avatarID FROM COMMENTS c WHERE c.id = ?

The question mark at final gets replaced with NEWS_ID. (e.g news.php?id=5)

I managed to code this, but it only gets the ""last comment"" details from database, not all of them. (Let's say 5 people commented on page, it only gets the last (5th) comment, ignoring the rest.)

Can anybody help me?

Ps. Yorumcu means ""Commenter"". COMMENTS.Commenter and USERS.Username are the same.",4
3781839,09/23/2010 19:30:08,34537,11/05/2008 03:00:23,6399,129,Turing complete SQL lib?,"This probably makes no sense but is there a turing complete sql lib?
I would like to pass in a list and ask the engine to return results that has a match with EVERYTHING in this list of strings and i'll tell you what to join/compare the data.

I guess linq is the answer but i am working with plain old data (class Blah { ID id; string name; SomeClass class; //note this should be treated as a foreign key })

or maybe simple built in functions and or loops i can write in a SQL statement so i can pass the array as a parameter and write a condition inside the SQL statement (as oppose to library).

I have a feeling this will be downvoted.
I am using MySql + C#",sql,loops,turing-complete,,,09/25/2010 19:04:08,not a real question,1,127,4,"Turing complete SQL lib? This probably makes no sense but is there a turing complete sql lib?
I would like to pass in a list and ask the engine to return results that has a match with EVERYTHING in this list of strings and i'll tell you what to join/compare the data.

I guess linq is the answer but i am working with plain old data (class Blah { ID id; string name; SomeClass class; //note this should be treated as a foreign key })

or maybe simple built in functions and or loops i can write in a SQL statement so i can pass the array as a parameter and write a condition inside the SQL statement (as oppose to library).

I have a feeling this will be downvoted.
I am using MySql + C#",3
92082,09/18/2008 12:30:04,7241,09/15/2008 13:24:02,1,1,Add column to existing table in MSSQL,"How do you add a column, with a default value, to an existing table in MSSQL 2000/2005?",sql,database,mssql,db,,,open,0,17,7,"Add column to existing table in MSSQL How do you add a column, with a default value, to an existing table in MSSQL 2000/2005?",4
11349954,07/05/2012 18:01:38,635600,02/26/2011 14:47:22,7,0,Please explain me this SQL statement,"I have this select statement but I don't know what it is doing please help me understand 
I know tell u follow

 1. OBZXQ is Database 
 2. OBS_EVENT_FACT is table 
 3. EVENTNAME is column in OBS_EVENT_FACT
 4. I don't see absent_count as a column in OBS_EVENT_FACT

Thanks<br>

    select absent_count from (select count(e.EVENTNAME) as ABSENT_COUNT
    from OBZXQ.OBS_EVENT_FACT e
    where To_Date(to_char(e.STARTDATETIME, 'DD-MON-YYYY')) = To_Date('3/17/2011','MM/DD/YYYY'))",sql,sql-select,,,,07/07/2012 07:14:01,too localized,1,72,6,"Please explain me this SQL statement I have this select statement but I don't know what it is doing please help me understand 
I know tell u follow

 1. OBZXQ is Database 
 2. OBS_EVENT_FACT is table 
 3. EVENTNAME is column in OBS_EVENT_FACT
 4. I don't see absent_count as a column in OBS_EVENT_FACT

Thanks<br>

    select absent_count from (select count(e.EVENTNAME) as ABSENT_COUNT
    from OBZXQ.OBS_EVENT_FACT e
    where To_Date(to_char(e.STARTDATETIME, 'DD-MON-YYYY')) = To_Date('3/17/2011','MM/DD/YYYY'))",2
279540,11/10/2008 23:21:31,8803,09/15/2008 16:54:36,31,6,Email Notification Service,What are some ideas (using .NET and SQL 2005) for implementing a service that sends emails?  The emails are to be data-driven.,sql,email,c#,.net,,,open,0,23,3,Email Notification Service What are some ideas (using .NET and SQL 2005) for implementing a service that sends emails?  The emails are to be data-driven.,4
6354130,06/15/2011 06:55:51,184046,10/04/2009 20:35:01,5061,36,Is there a SELECT ... INTO OUTFILE equivalent in SQL Server Management Studio?,"MySQL had a nifty command `SELECT ... INTO OUTFILE` that could write the result set into a file (CSV format or some other optional format). 

I am currently using SQL Server Management Studio to query an MS-SQL backend server. I have multiple SQL queries and would like to write the output result set into a file. Is there any way I could store the results from a query directly into a file?

",sql,sql-server,sql-server-2008,,,,open,0,72,13,"Is there a SELECT ... INTO OUTFILE equivalent in SQL Server Management Studio? MySQL had a nifty command `SELECT ... INTO OUTFILE` that could write the result set into a file (CSV format or some other optional format). 

I am currently using SQL Server Management Studio to query an MS-SQL backend server. I have multiple SQL queries and would like to write the output result set into a file. Is there any way I could store the results from a query directly into a file?

",3
2423863,03/11/2010 09:35:05,155758,08/13/2009 12:16:30,125,0,Database modeling tool,"I am looking for a simple tool to draw up my database in. I know that i saw one that was made in C# on Codeproject but i can't find that one.
I just need to be able to visually draw my tables and relations for MS SQLServer 2008.",sql,sql-server,,,,06/03/2012 05:24:07,not constructive,1,48,3,"Database modeling tool I am looking for a simple tool to draw up my database in. I know that i saw one that was made in C# on Codeproject but i can't find that one.
I just need to be able to visually draw my tables and relations for MS SQLServer 2008.",2
5665874,04/14/2011 15:45:05,708268,04/14/2011 15:45:05,1,0,SQL relationships between tables,"it might sound stupid.
can we have a database containing some tables without relations.",sql,,,,,,open,0,13,4,"SQL relationships between tables it might sound stupid.
can we have a database containing some tables without relations.",1
10586516,05/14/2012 15:37:12,1178888,01/30/2012 20:01:51,624,61,Odd behaviour on left join query,"I have a query similar to this:


SELECT *
FROM TableA a
LEFT JOIN TABLEB b

WHERE b.Col1 IS NULL 
OR (b.Col1 = A AND b.Col2 = B AND b.Col3 BETWEEN @StartDate AND @EndDate)

I get a strange result set because Im expecting every row to be returned from TableA but the date part of the query is screwing up the result set only returning 3 rows. I know this because when I remove the datetime filter and leave the other two filters in then I get the correct results.

Really stumped this seems like 'unexpected behaviour' I cant logically explain why this is happening.",sql,sql-server,query,tsql,,05/15/2012 09:27:52,not a real question,1,99,6,"Odd behaviour on left join query I have a query similar to this:


SELECT *
FROM TableA a
LEFT JOIN TABLEB b

WHERE b.Col1 IS NULL 
OR (b.Col1 = A AND b.Col2 = B AND b.Col3 BETWEEN @StartDate AND @EndDate)

I get a strange result set because Im expecting every row to be returned from TableA but the date part of the query is screwing up the result set only returning 3 rows. I know this because when I remove the datetime filter and leave the other two filters in then I get the correct results.

Really stumped this seems like 'unexpected behaviour' I cant logically explain why this is happening.",4
1411072,09/11/2009 14:04:37,57120,01/20/2009 14:33:43,3137,101,Parse a date from unformatted text in SQL,"I'm trying to figure out an elegant way to get a date from a text column that has data like this ""YYYYMMDD""...so we might see ""20060508"" as a value in the column, which I would like to be able to return from a query as a date (May 8, 2006).

I'm sure I can hack something together given enough time, but the approaches I'm thinking of seem pretty kludgy, and I suspect there's a way this can be elegantly done in a single query.

Any suggestions?

",sql,sql-server,,,,,open,0,84,8,"Parse a date from unformatted text in SQL I'm trying to figure out an elegant way to get a date from a text column that has data like this ""YYYYMMDD""...so we might see ""20060508"" as a value in the column, which I would like to be able to return from a query as a date (May 8, 2006).

I'm sure I can hack something together given enough time, but the approaches I'm thinking of seem pretty kludgy, and I suspect there's a way this can be elegantly done in a single query.

Any suggestions?

",2
11636534,07/24/2012 17:53:03,1166862,01/24/2012 11:25:15,58,0,Ole DB Select Count Statement,"I have the following statement which I believe has missing brackets. Could someone correct my sql statement?

    var query = ""SELECT COUNT(*) FROM usersTable WHERE Date BETWEEN Format$(DateAdd(“d”, 0, Now(), “mm/dd/yyyy”) AND Format$(Now(), “mm/dd/yyyy”)"";

MS-ACCESS DB",sql,ms-access,oledb,,,07/25/2012 13:58:35,too localized,1,38,5,"Ole DB Select Count Statement I have the following statement which I believe has missing brackets. Could someone correct my sql statement?

    var query = ""SELECT COUNT(*) FROM usersTable WHERE Date BETWEEN Format$(DateAdd(“d”, 0, Now(), “mm/dd/yyyy”) AND Format$(Now(), “mm/dd/yyyy”)"";

MS-ACCESS DB",3
4714975,01/17/2011 15:39:37,4639,09/04/2008 23:07:22,13432,67,How to SELECT the last 10 rows of an SQL table which has no ID field?,"I have an MySQL table with 25000 rows.

This is an imported CSV file so I want to look at the last ten rows to make sure it imported everything.

However, since there is no ID column, I can't say:

    SELECT * FROM big_table ORDER BY id DESC

**What SQL statement would show me the last 10 rows of this table?**",sql,mysql,phpmyadmin,,,,open,0,61,16,"How to SELECT the last 10 rows of an SQL table which has no ID field? I have an MySQL table with 25000 rows.

This is an imported CSV file so I want to look at the last ten rows to make sure it imported everything.

However, since there is no ID column, I can't say:

    SELECT * FROM big_table ORDER BY id DESC

**What SQL statement would show me the last 10 rows of this table?**",3
4585431,01/03/2011 14:52:21,561357,01/03/2011 14:48:39,1,0,2 update queries running at the exact same time,"If I have a situation (which I do, but changing the situation is not an option) where I run a statement such as:

Update Table1
Set Field5 = 'Blah' Where Field5 Is Not Null

And that statement runs at the exact same time multiple times, how can I avoid the same row being updated by multiple threads?",sql,,,,,,open,0,54,9,"2 update queries running at the exact same time If I have a situation (which I do, but changing the situation is not an option) where I run a statement such as:

Update Table1
Set Field5 = 'Blah' Where Field5 Is Not Null

And that statement runs at the exact same time multiple times, how can I avoid the same row being updated by multiple threads?",1
5067684,02/21/2011 15:19:25,263957,02/02/2010 00:14:50,329,3,SQL ORDER by. Problem,"I have a database

    id    |     parentid     |       name
    1     |        0         |      CatOne
    2     |        0         |      CatTwo
    3     |        0         |      CatThree
    4     |        1         |      SubCatOne
    5     |        1         |      SubCatOne2
    6     |        3         |      SubCatThree

How I can select this cats Order By `id`, `parentid`? That is

    CatOne 1
    --SubCatOne 4
    --SubCatOne2 5
    CatTwo 2
    CatThree 3
    --SubCatThree 6",sql,select,order,,,,open,0,262,4,"SQL ORDER by. Problem I have a database

    id    |     parentid     |       name
    1     |        0         |      CatOne
    2     |        0         |      CatTwo
    3     |        0         |      CatThree
    4     |        1         |      SubCatOne
    5     |        1         |      SubCatOne2
    6     |        3         |      SubCatThree

How I can select this cats Order By `id`, `parentid`? That is

    CatOne 1
    --SubCatOne 4
    --SubCatOne2 5
    CatTwo 2
    CatThree 3
    --SubCatThree 6",3
3162623,07/02/2010 00:51:36,98215,04/30/2009 03:15:21,1378,23,How do I get a list of unique values and the number of occurences from SQL Server 2008?,"I have a SQL Server 2008 database with millions of records. One field has values ranging from 0 to 250 and may, or may not, include all numbers witin the range. How do I query the database to get a list of distinct values and the number of records contaiing that value?

I used a Select Count(Distinct) query but that only gives me the number of distinct values.",sql,,,,,,open,0,67,18,"How do I get a list of unique values and the number of occurences from SQL Server 2008? I have a SQL Server 2008 database with millions of records. One field has values ranging from 0 to 250 and may, or may not, include all numbers witin the range. How do I query the database to get a list of distinct values and the number of records contaiing that value?

I used a Select Count(Distinct) query but that only gives me the number of distinct values.",1
2494211,03/22/2010 17:06:54,285490,03/03/2010 16:14:58,6,0,Getting next row using SQL,"I have 2 tables with data thus:
 
    Col1      Col2  
    ------- --------  
    Admin001  A  
    Admin001  B  
    Admin002  C   
    Admin002  C  
    Admin003  A  
    Admin003  C

I need to find all instances of Col2 values with 'A' immediately followed by 'B'. 'A' followed by any other symbol does not count. Is there a way to use SQL to accomplish this?   
Environment is DB2 LUW v9.5 ",sql,db2,,,,,open,0,115,5,"Getting next row using SQL I have 2 tables with data thus:
 
    Col1      Col2  
    ------- --------  
    Admin001  A  
    Admin001  B  
    Admin002  C   
    Admin002  C  
    Admin003  A  
    Admin003  C

I need to find all instances of Col2 values with 'A' immediately followed by 'B'. 'A' followed by any other symbol does not count. Is there a way to use SQL to accomplish this?   
Environment is DB2 LUW v9.5 ",2
11494466,07/15/2012 18:23:20,271224,02/11/2010 16:51:27,33,1,HOW CAN I implement the OBSERVER PATTERN on SQL 2008 r2 database table?,"To anyone who can help?

**CASE: Observer pattern on a SQL DATABASE TABLE**

**SCENARIO / PROBLEM**
I am trying to implement secuirity on my database for as many as 4 applications.  The security of the database record can be impacted by changes( to a minimum of 4 tables).  On top of the mulitple entities which could impact security the security is very complicated.  


**HENCE THE OBSERVER PATTERN:**  I can not find anything which states SQL 2008 r2 database tables have the capability to implement Subscriptions, notifications or the observer pattern.  I also want it to occur outside of the transaction which performs the change(loosly coupled) as to not hold up the INSERT/UPDATE or DELETE STATEMENT.   

**SITUATIONS #1 I thought of:**
Since I want to peform the ""SECURITY ALGORITHM"" outside of the current executing statement or process(locking problems will occur if I do this); I can not use nested triggers.  NESTED TRIGGERS are also a maintenance nightmare and they are directly coupled to the process.

**SITUATION #2 I thought of:**
Use a simple trigger: Send 1 record to a secuirty_change_log table when security changes in any of the concerned tables.  Then have a SQL JOB which runs every minute and looks at timestamps.  The problem is that it is not real time.

**SITUATION #3 i thought of:**
Use NEST TRIGGERS; already descibed above

**SITUATION #4 I though of:**
Create .net code which runs every X seconds to check for changes to the security_Change_log table; but this is very talky and appears to be a headache.


**SO MY QUESTION TO ALL:**
What is the best method to implement the OBSERVER PATTERN 
on a single SQL database table?

***WITH ACHEVING NEAR REAL-TIME UPDATES
***WITH ACHCING 100% accurate updates
***WITH OUT SACRAFICING PERFORMANCE ON THE UPDATE/INSERT/DELETE  (out of process)

***Example***>When I insert a record; I want the next command issued via .net (which updates the
datagrid) to show the record (and applying the proper security to the record).

THANKS,
DOUG LUBEY OF LOUISIANA
www.douglubey.com


**OHTER WEBSITES WHICH I USED SO FAR:**
------------------------------------------------------------------
trigger-example-Nested-triggers-in-SQL-Server
http://searchsqlserver.techtarget.com/feature/SQL-Server-


Introduction to Change Data Capture (CDC) in SQL Server 2008
http://www.simple-talk.com/sql/learn-sql-server/introduction-to-change-data-capture-(cdc)-in-sql-server-2008/

metatags searchenine reference:
How to implement the observer pattern in sql 2008 R2
ARE MICROSOFT SQL NESTED TRIGGERS EXECUTE IN SAME PROCESS
SQL implement observer pattern
SQL implement observer pattern on table
SQL OBSERVER PATTERN
sql .net observe changes to data table
.net observer pattern implemented on sql table
observer pattern sql table
observer pattern sql database table
how to implement oberver pattern for changes to a sql 
database table",sql,database,design-patterns,triggers,observer-pattern,07/17/2012 20:41:09,not constructive,1,395,13,"HOW CAN I implement the OBSERVER PATTERN on SQL 2008 r2 database table? To anyone who can help?

**CASE: Observer pattern on a SQL DATABASE TABLE**

**SCENARIO / PROBLEM**
I am trying to implement secuirity on my database for as many as 4 applications.  The security of the database record can be impacted by changes( to a minimum of 4 tables).  On top of the mulitple entities which could impact security the security is very complicated.  


**HENCE THE OBSERVER PATTERN:**  I can not find anything which states SQL 2008 r2 database tables have the capability to implement Subscriptions, notifications or the observer pattern.  I also want it to occur outside of the transaction which performs the change(loosly coupled) as to not hold up the INSERT/UPDATE or DELETE STATEMENT.   

**SITUATIONS #1 I thought of:**
Since I want to peform the ""SECURITY ALGORITHM"" outside of the current executing statement or process(locking problems will occur if I do this); I can not use nested triggers.  NESTED TRIGGERS are also a maintenance nightmare and they are directly coupled to the process.

**SITUATION #2 I thought of:**
Use a simple trigger: Send 1 record to a secuirty_change_log table when security changes in any of the concerned tables.  Then have a SQL JOB which runs every minute and looks at timestamps.  The problem is that it is not real time.

**SITUATION #3 i thought of:**
Use NEST TRIGGERS; already descibed above

**SITUATION #4 I though of:**
Create .net code which runs every X seconds to check for changes to the security_Change_log table; but this is very talky and appears to be a headache.


**SO MY QUESTION TO ALL:**
What is the best method to implement the OBSERVER PATTERN 
on a single SQL database table?

***WITH ACHEVING NEAR REAL-TIME UPDATES
***WITH ACHCING 100% accurate updates
***WITH OUT SACRAFICING PERFORMANCE ON THE UPDATE/INSERT/DELETE  (out of process)

***Example***>When I insert a record; I want the next command issued via .net (which updates the
datagrid) to show the record (and applying the proper security to the record).

THANKS,
DOUG LUBEY OF LOUISIANA
www.douglubey.com


**OHTER WEBSITES WHICH I USED SO FAR:**
------------------------------------------------------------------
trigger-example-Nested-triggers-in-SQL-Server
http://searchsqlserver.techtarget.com/feature/SQL-Server-


Introduction to Change Data Capture (CDC) in SQL Server 2008
http://www.simple-talk.com/sql/learn-sql-server/introduction-to-change-data-capture-(cdc)-in-sql-server-2008/

metatags searchenine reference:
How to implement the observer pattern in sql 2008 R2
ARE MICROSOFT SQL NESTED TRIGGERS EXECUTE IN SAME PROCESS
SQL implement observer pattern
SQL implement observer pattern on table
SQL OBSERVER PATTERN
sql .net observe changes to data table
.net observer pattern implemented on sql table
observer pattern sql table
observer pattern sql database table
how to implement oberver pattern for changes to a sql 
database table",5
7264641,08/31/2011 23:31:06,505152,11/11/2010 23:05:12,86,5,How much time will it take a server to update half million records?,"We will be making a system that needs to take the data from the last day and update it to another system.

This update will be about half million records daily. Assuming that this is run in a good server (i don't know the exact specifications), how much time will it take to perform this task?

This will be done using SQL Server 2005

Thanks in advance!",sql,time,,,,08/31/2011 23:41:09,not constructive,1,64,13,"How much time will it take a server to update half million records? We will be making a system that needs to take the data from the last day and update it to another system.

This update will be about half million records daily. Assuming that this is run in a good server (i don't know the exact specifications), how much time will it take to perform this task?

This will be done using SQL Server 2005

Thanks in advance!",2
5290050,03/13/2011 14:39:44,626477,02/21/2011 11:37:22,1,0,Query for finding the tuple with other corresponding elements of value x,"If we have the following table called data:
`(id, n1, n2, n3, n4)
111,  2,  4,  7, 0
444,  1,  1,  2, 1
555,  1,  1,  2, 0
777,  5,  3,  8, 0`

How do we get only (2,4,7) and (5,3,8)?

SELECT DISTINCT n1,n2,n3
FROM data
WHERE n4 = 0;

doesn't work as it returns the (1,1,2) tuple as well. I only need the tuples that have n4 = 0 all the time.",sql,postgresql,,,,,open,0,75,12,"Query for finding the tuple with other corresponding elements of value x If we have the following table called data:
`(id, n1, n2, n3, n4)
111,  2,  4,  7, 0
444,  1,  1,  2, 1
555,  1,  1,  2, 0
777,  5,  3,  8, 0`

How do we get only (2,4,7) and (5,3,8)?

SELECT DISTINCT n1,n2,n3
FROM data
WHERE n4 = 0;

doesn't work as it returns the (1,1,2) tuple as well. I only need the tuples that have n4 = 0 all the time.",2
3852171,10/04/2010 00:42:09,253348,01/18/2010 16:35:40,509,20,SQL Select Help,"I kind of but not really know how to do the following, but could use some help from the folks out here at Stackoverflow.

Basically I'm trying to count how many created vs published posts there are per user in my database. 

POST ID | USER ID | STATUS and an example would be

User ID 1 has 5 posts (5 distinct post IDs) with 3 STATUS = CREATED and 2 STATUS = PUBLISHED. I want the output to show the following columns

USER | CREATED | PUBLISHED --> 1 | 3 | 2",sql,mysql,select,,,,open,0,91,3,"SQL Select Help I kind of but not really know how to do the following, but could use some help from the folks out here at Stackoverflow.

Basically I'm trying to count how many created vs published posts there are per user in my database. 

POST ID | USER ID | STATUS and an example would be

User ID 1 has 5 posts (5 distinct post IDs) with 3 STATUS = CREATED and 2 STATUS = PUBLISHED. I want the output to show the following columns

USER | CREATED | PUBLISHED --> 1 | 3 | 2",3
8537273,12/16/2011 16:41:25,969902,09/28/2011 20:24:19,1,0,PL/SQL column mask with fixed number of characters in queries,"I'd like to write a query so its output would be a well formated text. Each of its columns would be a specific number of characters wide, if the column's value returned by the query is smaller then the columns number of characters, the remaining characters would be informed as ""0"" if the column represents a number or "" "" if the column represents a string. Is it possible?

Thanks,

Thiago",sql,oracle,plsql,mask,,,open,0,69,10,"PL/SQL column mask with fixed number of characters in queries I'd like to write a query so its output would be a well formated text. Each of its columns would be a specific number of characters wide, if the column's value returned by the query is smaller then the columns number of characters, the remaining characters would be informed as ""0"" if the column represents a number or "" "" if the column represents a string. Is it possible?

Thanks,

Thiago",4
433913,01/11/2009 22:50:55,52551,01/07/2009 19:09:16,136,16,In SQL is there a difference between count(*) and count(<fieldname>),Pretty self explanatory question. Is there any reason to use one or the other?,sql,,,,,,open,0,14,10,In SQL is there a difference between count(*) and count(<fieldname>) Pretty self explanatory question. Is there any reason to use one or the other?,1
1882555,12/10/2009 17:19:19,155077,08/12/2009 13:22:25,81,8,Extract name and prename from email address?,"Question:
I have a table with the columns ID, Name, Prename, Mail

Mail contains the e-mail address of a person, for example john.doe@example.com

Now I need to check whether Name='' or Prename=''
and extract ""John"" from Mail and put it into Prename, and put ""Doe"" into column Name

Can i do that with SQL, if yes how ?

I use MS-SQL 2005",sql,mssql,,,,,open,0,56,7,"Extract name and prename from email address? Question:
I have a table with the columns ID, Name, Prename, Mail

Mail contains the e-mail address of a person, for example john.doe@example.com

Now I need to check whether Name='' or Prename=''
and extract ""John"" from Mail and put it into Prename, and put ""Doe"" into column Name

Can i do that with SQL, if yes how ?

I use MS-SQL 2005",2
3534735,08/20/2010 20:39:52,427354,08/17/2010 19:20:06,1,0,SQL Query question - please help,"how can i put the results from a query into a table which is NOT created?

For example, i wanna put the follwoing query results into a new table EmployeeDetail which IS NOT CREATED. so i wanna create the table and put the results at the same time.

select a.Name, b.Id
from Database1 a left join 
     Database2 b
ON a.Id = b.Id

Thanks

Nick",sql,,,,,,open,0,63,6,"SQL Query question - please help how can i put the results from a query into a table which is NOT created?

For example, i wanna put the follwoing query results into a new table EmployeeDetail which IS NOT CREATED. so i wanna create the table and put the results at the same time.

select a.Name, b.Id
from Database1 a left join 
     Database2 b
ON a.Id = b.Id

Thanks

Nick",1
4555261,12/29/2010 15:15:49,557234,12/29/2010 14:34:59,1,0,Convert SQL to SQLite in an easy way?,"My question: has someone a super-easy way to convert a SQL-file in SQLite?
",sql,sqlite,,,,12/29/2010 15:51:42,not a real question,1,13,8,"Convert SQL to SQLite in an easy way? My question: has someone a super-easy way to convert a SQL-file in SQLite?
",2
8862361,01/14/2012 12:59:59,1092683,12/11/2011 20:29:05,8,0,Sql error at Drupal site,"http://img403.imageshack.us/img403/9197/drupalerror.png

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'drupal501.cache_token' doesn't exist: TRUNCATE {cache_toekn}; Array () in Cache_clear_all)() (line 169 of path\www\drupal\includes\cache.inc).

Hello all,

At first i didnt had this error and now just popped up..!

Thanks in advance! 


",sql,drupal-7,,,,01/16/2012 02:32:19,not a real question,1,38,5,"Sql error at Drupal site http://img403.imageshack.us/img403/9197/drupalerror.png

PDOException: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'drupal501.cache_token' doesn't exist: TRUNCATE {cache_toekn}; Array () in Cache_clear_all)() (line 169 of path\www\drupal\includes\cache.inc).

Hello all,

At first i didnt had this error and now just popped up..!

Thanks in advance! 


",2
1902155,12/14/2009 17:03:55,192963,10/20/2009 09:15:48,14,0,Setting a default value for a stored proc select statement,"I am creating a stored proc that selects a value from a table and uses it in another procedure. If the first value that is searched doesn’t exist I need it to use a default value. I’m new to stored procs so I’m not sure of the best practices.

Here is the first select statement which may or may not return a value. If it doesn’t return a value I need to set the “@theValue” to 10 so that it can be used in the next select statement.

    DECLARE @TheValue nvarchar(50)

    SELECT @TheValue = deviceManager.SystemSettings.Value 
    FROM deviceManager.SystemSettings 
    WHERE (deviceManager.SystemSettings.Setting = 'expire-terminal-requests'

What would be the best solution?
",sql,stored-procedures,,,,,open,0,119,10,"Setting a default value for a stored proc select statement I am creating a stored proc that selects a value from a table and uses it in another procedure. If the first value that is searched doesn’t exist I need it to use a default value. I’m new to stored procs so I’m not sure of the best practices.

Here is the first select statement which may or may not return a value. If it doesn’t return a value I need to set the “@theValue” to 10 so that it can be used in the next select statement.

    DECLARE @TheValue nvarchar(50)

    SELECT @TheValue = deviceManager.SystemSettings.Value 
    FROM deviceManager.SystemSettings 
    WHERE (deviceManager.SystemSettings.Setting = 'expire-terminal-requests'

What would be the best solution?
",2
5623191,04/11/2011 14:55:17,702394,04/11/2011 14:55:17,1,0,One row with 2 same name columns,"I wish to have one row answer by creating 2 columns with info from one column:
for example.
select cust,date,data from cust_a1 where ai_code between '17' and '19';

this will return multiple rows

1234567 04-04-2011 special offer
1234567 04-04-2011 cheep offer
1345678 04-04-2011 friday offer
1345678 04-04-2011 special offer

I would like this to be
1234567 04-04-2011 special offer cheep offer
1345678 04-04-2011 special offer friday offer

any Ideas?",sql,select,plus,,,,open,0,58,7,"One row with 2 same name columns I wish to have one row answer by creating 2 columns with info from one column:
for example.
select cust,date,data from cust_a1 where ai_code between '17' and '19';

this will return multiple rows

1234567 04-04-2011 special offer
1234567 04-04-2011 cheep offer
1345678 04-04-2011 friday offer
1345678 04-04-2011 special offer

I would like this to be
1234567 04-04-2011 special offer cheep offer
1345678 04-04-2011 special offer friday offer

any Ideas?",3
10735105,05/24/2012 09:52:33,1285948,03/22/2012 12:52:55,61,5,practising database queries (sql/tsql),I wish to refine my skills on t-sql (remote procedure calls etc) and making queries on DB's. I have a macbook and would like to know is there any software i can use to accomplish this? Ideally i would not like to install any software on this computer at all but if i have no choice then so be it.,sql,database,query,tsql,,05/25/2012 19:46:34,off topic,1,60,4,practising database queries (sql/tsql) I wish to refine my skills on t-sql (remote procedure calls etc) and making queries on DB's. I have a macbook and would like to know is there any software i can use to accomplish this? Ideally i would not like to install any software on this computer at all but if i have no choice then so be it.,4
2140244,01/26/2010 15:09:46,237681,12/23/2009 15:31:25,32,4,SQL INJECTION and two queries,"So, I read article about SQL injection and there was an example:

> SELECT * FROM table_name WHERE smth =
> 'x'; UPDATE table_name SET smth =
> 'smth@email.addr' WHERE user = 'admin'
> ';

Why it doesn't work? Or it is an old article and nowadays this way is nonsense? So how hackers update mysql then?
Thanks.",sql,injection,,,,01/27/2010 17:17:30,not a real question,1,52,5,"SQL INJECTION and two queries So, I read article about SQL injection and there was an example:

> SELECT * FROM table_name WHERE smth =
> 'x'; UPDATE table_name SET smth =
> 'smth@email.addr' WHERE user = 'admin'
> ';

Why it doesn't work? Or it is an old article and nowadays this way is nonsense? So how hackers update mysql then?
Thanks.",2
4163821,11/12/2010 10:45:41,78334,03/15/2009 18:18:51,119,4,Joining One table to many using Joins,"In [this question][1] it's finally clicked how to write joins between multiple tables, where they link in a line e.g. 

    Table A - Table B - Table C

Where Table A references Table B, and Table B references Table C and so on.

What I still don't understand is how to reference the situation where Table A references Table B as above and *also* reference Table D.  

In implicit Joins I can get the following to work, but want to move it to explicits...

    SELECT a.name, b.office, c.firm, d.status
    FROM job a, depts b, firms c, statuses d
    WHERE a.office = b.ref
    AND b.firm  = c.ref
    AND a.status = d.ref

Any tips?

  [1]: http://stackoverflow.com/questions/4156341/multi-table-joins-can-i-add-an-outer-join-to-this",sql,join,,,,,open,0,133,7,"Joining One table to many using Joins In [this question][1] it's finally clicked how to write joins between multiple tables, where they link in a line e.g. 

    Table A - Table B - Table C

Where Table A references Table B, and Table B references Table C and so on.

What I still don't understand is how to reference the situation where Table A references Table B as above and *also* reference Table D.  

In implicit Joins I can get the following to work, but want to move it to explicits...

    SELECT a.name, b.office, c.firm, d.status
    FROM job a, depts b, firms c, statuses d
    WHERE a.office = b.ref
    AND b.firm  = c.ref
    AND a.status = d.ref

Any tips?

  [1]: http://stackoverflow.com/questions/4156341/multi-table-joins-can-i-add-an-outer-join-to-this",2
7614914,09/30/2011 19:04:23,877202,08/03/2011 18:19:03,35,0,is there any function in sql which may return the result from first two alphabet or the first alphabet?,"i am working on oracle10g. I was curious to know that is there any sql function which may give results from the starting alphabet of a string.
for example, if i have road-1, road-A, road-89 and i want to know total number of such road sets without using the sql count() function.",sql,oracle10g,,,,,open,0,51,19,"is there any function in sql which may return the result from first two alphabet or the first alphabet? i am working on oracle10g. I was curious to know that is there any sql function which may give results from the starting alphabet of a string.
for example, if i have road-1, road-A, road-89 and i want to know total number of such road sets without using the sql count() function.",2
7078263,08/16/2011 12:34:38,896663,08/16/2011 12:34:38,1,0,"If else issue in stored procedure. I try to run this but get error at every ""then"" and at the ""end""","`

    create or replace procedure CONTACT_REFERENCES(
    datetype IN NUMBER,
    created IN DATE,
    oprtr IN NUMBER)
    
    is
    BEGIN
    
    EXECUTE IMMEDIATE 'CREATE TABLE DUP_REF
    (
    SEQID NUMBER(19),
    SITEID NUMBER(10)
    )';
    
    DELETE FROM PURGE_CONTACT;
    DELETE FROM CONTACT_REF;
    if (oprtr = 0 and datetype = 0)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE CREATED < created;
    
    elseif (oprtr = 1 and datetype = 0)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE EXTRACT(YEAR FROM CREATED) = EXTRACT(YEAR FROM created)
    																				AND EXTRACT(MONTH FROM CREATED) = EXTRACT(MONTH FROM created)
    																				AND EXTRACT(DAY FROM CREATED) = EXTRACT(DAY FROM created);
    
    elseif (oprtr = 2 and datetype = 0)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE CREATED > created;
    
    elseif (oprtr = 0 and datetype = 1)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE LASTMODIFIED < created;
    
    elseif (oprtr = 1 and datetype = 1)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE EXTRACT(YEAR FROM LASTMODIFIED) = EXTRACT(YEAR FROM created)
    																				AND EXTRACT(MONTH FROM LASTMODIFIED) = EXTRACT(MONTH FROM created)
    																				AND EXTRACT(DAY FROM LASTMODIFIED) = EXTRACT(DAY FROM created);
    																				
    elseif (oprtr = 2 and datetype = 1)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE LASTMODIFIED > created;
    end if;
    
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM LEAD
                  WHERE LEAD.CONTACTID = PURGE_CONTACT.SEQID
                        AND LEAD.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM MAPRESULT
                  WHERE MAPRESULT.CONTACTSEQ = PURGE_CONTACT.SEQID
                        AND MAPRESULT.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM USERS
                  WHERE USERS.CONTACTID = PURGE_CONTACT.SEQID
                        AND USERS.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM PLAYER
                  WHERE PLAYER.CONTACTID = PURGE_CONTACT.SEQID
                        AND PLAYER.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM SHOPPINGCART
                  WHERE SHOPPINGCART.CONTACT_SEQID = PURGE_CONTACT.SEQID
                        AND SHOPPINGCART.CONTACT_SITEID = PURGE_CONTACT.SITEID);
    
    INSERT INTO CONTACT_REF SELECT DISTINCT SEQID,SITEID FROM DUP_REF;
    
    EXECUTE IMMEDIATE 'DROP TABLE DUP_REF';
    
    DELETE FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
    			  FROM CONTACT_REF
    			  WHERE CONTACT_REF.SEQID = PURGE_CONTACT.SEQID
    					AND CONTACT_REF.SITEID = PURGE_CONTACT.SITEID);
    
    COMMIT;
    END CONTACT_REFERENCES;

`",sql,oracle,stored-procedures,if-statement,,08/16/2011 14:20:31,not a real question,1,875,21,"If else issue in stored procedure. I try to run this but get error at every ""then"" and at the ""end"" `

    create or replace procedure CONTACT_REFERENCES(
    datetype IN NUMBER,
    created IN DATE,
    oprtr IN NUMBER)
    
    is
    BEGIN
    
    EXECUTE IMMEDIATE 'CREATE TABLE DUP_REF
    (
    SEQID NUMBER(19),
    SITEID NUMBER(10)
    )';
    
    DELETE FROM PURGE_CONTACT;
    DELETE FROM CONTACT_REF;
    if (oprtr = 0 and datetype = 0)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE CREATED < created;
    
    elseif (oprtr = 1 and datetype = 0)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE EXTRACT(YEAR FROM CREATED) = EXTRACT(YEAR FROM created)
    																				AND EXTRACT(MONTH FROM CREATED) = EXTRACT(MONTH FROM created)
    																				AND EXTRACT(DAY FROM CREATED) = EXTRACT(DAY FROM created);
    
    elseif (oprtr = 2 and datetype = 0)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE CREATED > created;
    
    elseif (oprtr = 0 and datetype = 1)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE LASTMODIFIED < created;
    
    elseif (oprtr = 1 and datetype = 1)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE EXTRACT(YEAR FROM LASTMODIFIED) = EXTRACT(YEAR FROM created)
    																				AND EXTRACT(MONTH FROM LASTMODIFIED) = EXTRACT(MONTH FROM created)
    																				AND EXTRACT(DAY FROM LASTMODIFIED) = EXTRACT(DAY FROM created);
    																				
    elseif (oprtr = 2 and datetype = 1)
    then
    INSERT INTO PURGE_CONTACT SELECT SEQID,SITEID,DETAILID,DETAILSITE from CONTACT WHERE LASTMODIFIED > created;
    end if;
    
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM LEAD
                  WHERE LEAD.CONTACTID = PURGE_CONTACT.SEQID
                        AND LEAD.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM MAPRESULT
                  WHERE MAPRESULT.CONTACTSEQ = PURGE_CONTACT.SEQID
                        AND MAPRESULT.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM USERS
                  WHERE USERS.CONTACTID = PURGE_CONTACT.SEQID
                        AND USERS.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM PLAYER
                  WHERE PLAYER.CONTACTID = PURGE_CONTACT.SEQID
                        AND PLAYER.CONTACTSITE = PURGE_CONTACT.SITEID);
    
    INSERT INTO DUP_REF SELECT SEQID,SITEID
    FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
                  FROM SHOPPINGCART
                  WHERE SHOPPINGCART.CONTACT_SEQID = PURGE_CONTACT.SEQID
                        AND SHOPPINGCART.CONTACT_SITEID = PURGE_CONTACT.SITEID);
    
    INSERT INTO CONTACT_REF SELECT DISTINCT SEQID,SITEID FROM DUP_REF;
    
    EXECUTE IMMEDIATE 'DROP TABLE DUP_REF';
    
    DELETE FROM PURGE_CONTACT
    WHERE EXISTS (SELECT *
    			  FROM CONTACT_REF
    			  WHERE CONTACT_REF.SEQID = PURGE_CONTACT.SEQID
    					AND CONTACT_REF.SITEID = PURGE_CONTACT.SITEID);
    
    COMMIT;
    END CONTACT_REFERENCES;

`",4
11197780,06/25/2012 21:42:01,1336983,04/16/2012 18:13:26,29,1,How to insert data from dat to sql table?,"I want to insert data from a .dat file to an sql table. But I dont want to use bulk insert.

The dat file looks like this:

    dd	qwe	3
    ss	asd	3

How can I do this?

Thanks..
",sql,,,,,06/26/2012 11:45:56,not a real question,1,38,9,"How to insert data from dat to sql table? I want to insert data from a .dat file to an sql table. But I dont want to use bulk insert.

The dat file looks like this:

    dd	qwe	3
    ss	asd	3

How can I do this?

Thanks..
",1
6221915,06/03/2011 00:45:21,280802,02/24/2010 23:54:43,168,7,Testing For Primary Key Existance In Oracle SQL Trigger,"I'm trying to write a trigger within SQL, and the code within needs to determine whether an entry exists in the table before either attempting to update, or insert.

I have tried using both

    IF EXISTS
    UPDATE
    ELSE
    INSERT

And

    UPDATE
    IF @@ROWCOUNT = 0
    INSERT

But neither of them work. I'm partial to using the latter because my employer is nuts about efficiency (well...duh...) For this reason I'm also reluctant to use 

    IF SELECT COUNT(*) = 0
    UPDATE
    ELSE
    INSERT

Does anybody know any ways to get around this?",sql,triggers,,,,,open,0,120,9,"Testing For Primary Key Existance In Oracle SQL Trigger I'm trying to write a trigger within SQL, and the code within needs to determine whether an entry exists in the table before either attempting to update, or insert.

I have tried using both

    IF EXISTS
    UPDATE
    ELSE
    INSERT

And

    UPDATE
    IF @@ROWCOUNT = 0
    INSERT

But neither of them work. I'm partial to using the latter because my employer is nuts about efficiency (well...duh...) For this reason I'm also reluctant to use 

    IF SELECT COUNT(*) = 0
    UPDATE
    ELSE
    INSERT

Does anybody know any ways to get around this?",2
10834515,05/31/2012 13:22:28,249615,01/13/2010 08:30:41,34,1,Cannot reference jdbc.SQLServerDriver in Eclipse (ClassNotFoundException),"I am trying to use the MSSQL driver for JDBC.  I have followed the instructions on how to add an external JAR file to the Eclipse Windows IDE as follow:<br/><br/>
 - Download the installation from here http://msdn.microsoft.com/en-us/sqlserver/aa937724.aspx (Microsoft JDBC Driver 4.0 for SQL Server) <br/>
 - Extract the zip to a file location I have extracted it here (c:\MsJDBCforSqlDriver)
 - In Eclipse Package Explorer right click your project -> Build Path -> Configure Build Path -> Java Build Path -> Libraries Tab- Add External JAR file and then I browse to 
""C:\MsJDBCforSqlDriver\sqljdbc_4.0\enu\sqljdbc4.jar"" <br/>
- I then view the successful reference as in image below including SQLServerDriver.class

![enter image description here][1]


When I try to execute Class.forName(""com.microsoft.sqlserver.jdbc.SQLServerDriver"") I get a ClassNotFound Exception as below:

![enter image description here][2]


  [1]: http://i.stack.imgur.com/WSYbE.jpg
  [2]: http://i.stack.imgur.com/4cUDG.png

I tried all suggestions I could find on Google including setting the classpath in Windows Environment Variables.

",sql,eclipse,jdbc,classpath,classnotfoundexception,,open,0,146,6,"Cannot reference jdbc.SQLServerDriver in Eclipse (ClassNotFoundException) I am trying to use the MSSQL driver for JDBC.  I have followed the instructions on how to add an external JAR file to the Eclipse Windows IDE as follow:<br/><br/>
 - Download the installation from here http://msdn.microsoft.com/en-us/sqlserver/aa937724.aspx (Microsoft JDBC Driver 4.0 for SQL Server) <br/>
 - Extract the zip to a file location I have extracted it here (c:\MsJDBCforSqlDriver)
 - In Eclipse Package Explorer right click your project -> Build Path -> Configure Build Path -> Java Build Path -> Libraries Tab- Add External JAR file and then I browse to 
""C:\MsJDBCforSqlDriver\sqljdbc_4.0\enu\sqljdbc4.jar"" <br/>
- I then view the successful reference as in image below including SQLServerDriver.class

![enter image description here][1]


When I try to execute Class.forName(""com.microsoft.sqlserver.jdbc.SQLServerDriver"") I get a ClassNotFound Exception as below:

![enter image description here][2]


  [1]: http://i.stack.imgur.com/WSYbE.jpg
  [2]: http://i.stack.imgur.com/4cUDG.png

I tried all suggestions I could find on Google including setting the classpath in Windows Environment Variables.

",5
2909099,05/25/2010 22:55:54,344535,05/18/2010 21:56:17,1,0,SQL Server 2005 sp_send_dbmail,"When we use sp_send_dbmail to send email with attachment, the attachment gets copied into a folder inside C:\Windows\Temp. As we have many emails to be sent every day, the temp folder grows rapidly. This is the case with SQL Server 2005. We noticed that, with SQL Server 2008, we dont see these file under temp folder. 

Is there any setting to turn the above behavior off? 

Does SQL Server 2008 store the files in any other folder and not in temp?

Appreciate your help and time. 

Thanks.",sql,sql-server-2005,server,sp-send-dbmail,,,open,0,86,4,"SQL Server 2005 sp_send_dbmail When we use sp_send_dbmail to send email with attachment, the attachment gets copied into a folder inside C:\Windows\Temp. As we have many emails to be sent every day, the temp folder grows rapidly. This is the case with SQL Server 2005. We noticed that, with SQL Server 2008, we dont see these file under temp folder. 

Is there any setting to turn the above behavior off? 

Does SQL Server 2008 store the files in any other folder and not in temp?

Appreciate your help and time. 

Thanks.",4
11727150,07/30/2012 18:10:52,960567,09/23/2011 06:57:46,1155,11,Allow users to do anything within his own schema but cannot create or drop the schema itself,"I have created a schema in SQL Azure using following permissions on my database role:

    CREATE ROLE myrole AUTHORIZATION dbo;
    EXEC sp_addrolemember 'myrole', 'myuser';

    CREATE SCHEMA myschema AUTHORIZATION dbo;

    GRANT ALTER, CONTROL, DELETE, EXECUTE, INSERT, REFERENCES, SELECT, UPDATE, VIEW DEFINITION ON SCHEMA::myschema TO myrole;

    GRANT CREATE TABLE, CREATE PROCEDURE, CREATE FUNCTION, CREATE VIEW TO myrole;


Through the above defined permissions a user can create/drop his own schema, so to overcome the problem I tried the ALTER ANY SCHEMA permission. But this permission also denies the user to create/drop tables. What permissions are required in order to allow the user to do anything within his own schema but cannot create or drop the schema itself?",sql,sql-server,,,,07/31/2012 07:32:07,off topic,1,128,17,"Allow users to do anything within his own schema but cannot create or drop the schema itself I have created a schema in SQL Azure using following permissions on my database role:

    CREATE ROLE myrole AUTHORIZATION dbo;
    EXEC sp_addrolemember 'myrole', 'myuser';

    CREATE SCHEMA myschema AUTHORIZATION dbo;

    GRANT ALTER, CONTROL, DELETE, EXECUTE, INSERT, REFERENCES, SELECT, UPDATE, VIEW DEFINITION ON SCHEMA::myschema TO myrole;

    GRANT CREATE TABLE, CREATE PROCEDURE, CREATE FUNCTION, CREATE VIEW TO myrole;


Through the above defined permissions a user can create/drop his own schema, so to overcome the problem I tried the ALTER ANY SCHEMA permission. But this permission also denies the user to create/drop tables. What permissions are required in order to allow the user to do anything within his own schema but cannot create or drop the schema itself?",2
2664839,04/19/2010 01:56:46,228497,12/10/2009 04:14:53,26,5,Recommended SQL Practice and Books ,"Please recommend me some books and practices for me.
I am quite weak in SQL though not that bad in C# and VB.NET.

Thanks.",sql,,,,,09/20/2011 15:09:23,not constructive,1,22,6,"Recommended SQL Practice and Books  Please recommend me some books and practices for me.
I am quite weak in SQL though not that bad in C# and VB.NET.

Thanks.",1
834912,05/07/2009 14:19:09,60096,01/29/2009 07:42:15,6493,296,SQL: search for a string in every varchar column in a database,"I have a database where a misspelled string appears in various places in different tables.  Is there a SQL query that I can use to search for this string in every possible varchar/text column in the database?

I was thinking of trying to use the information_schema views somehow to create dynamic queries, but I'm not sure if that will work, or if there's a better way.

I'm using MS SQL Server if that helps.",sql,string,search,sql-server,,,open,0,73,12,"SQL: search for a string in every varchar column in a database I have a database where a misspelled string appears in various places in different tables.  Is there a SQL query that I can use to search for this string in every possible varchar/text column in the database?

I was thinking of trying to use the information_schema views somehow to create dynamic queries, but I'm not sure if that will work, or if there's a better way.

I'm using MS SQL Server if that helps.",4
6904828,08/01/2011 21:43:16,196210,10/25/2009 15:26:47,99,1,Oracle: split string to rows,"Let's take this query:

WITH temp as SELECT '123455' colum from dual
SELECT * FROM big_table WHERE cod IN (SELECT colum from temp)
UNION ALL
SELECT * FROM big_table2 WHERE cod IN (SELECT colum from temp)

I'd like to search for a list of values as well as I can look for one single, but how can I build a list of rows without having to write a lot of UNION?

",sql,oracle,,,,,open,0,66,5,"Oracle: split string to rows Let's take this query:

WITH temp as SELECT '123455' colum from dual
SELECT * FROM big_table WHERE cod IN (SELECT colum from temp)
UNION ALL
SELECT * FROM big_table2 WHERE cod IN (SELECT colum from temp)

I'd like to search for a list of values as well as I can look for one single, but how can I build a list of rows without having to write a lot of UNION?

",2
9866951,03/26/2012 05:18:52,832446,07/06/2011 21:33:49,162,0,SQL query for select distinct with most recent timestamp first,"I have a mysql table with three columns: username, location, timestamp. This is basically a log of user activity of what location they are in and the time that they were there.

What I want to do is select a distinct username+location where only the most recent item (by timestamp) is provided.


So say the table consists of:

tom roomone 2011-3-25 10:45:00
tom roomtwo 2011-3-25 09:00:00
tom roomtwo 2011-3-25 08:30:00

I would want only these to be selected:

tom roomone 2011-3-25 10:45:00
tom roomtwo 2011-3-25 09:00:00

",sql,query,distinct,,,,open,0,78,10,"SQL query for select distinct with most recent timestamp first I have a mysql table with three columns: username, location, timestamp. This is basically a log of user activity of what location they are in and the time that they were there.

What I want to do is select a distinct username+location where only the most recent item (by timestamp) is provided.


So say the table consists of:

tom roomone 2011-3-25 10:45:00
tom roomtwo 2011-3-25 09:00:00
tom roomtwo 2011-3-25 08:30:00

I would want only these to be selected:

tom roomone 2011-3-25 10:45:00
tom roomtwo 2011-3-25 09:00:00

",3
2832938,05/14/2010 09:08:12,328895,04/29/2010 12:52:09,11,1,i want to know about sql injection,"friends

I want to know about sql injection
So, please help me

Thanks!",sql,sql-injection,,,,05/17/2010 02:29:29,not a real question,1,10,7,"i want to know about sql injection friends

I want to know about sql injection
So, please help me

Thanks!",2
7546752,09/25/2011 16:11:05,774018,05/28/2011 04:21:25,154,1,SQL random value in UPDATE,"In MYSQL db, I need to UPDATE table ""people"" with a random number between 8 and 120, but if the value is between 103 and 109, I want it to become 110.

How would I do such a query?

    UPDATE people SET column1 = '________random expression_________'",sql,,,,,,open,0,48,5,"SQL random value in UPDATE In MYSQL db, I need to UPDATE table ""people"" with a random number between 8 and 120, but if the value is between 103 and 109, I want it to become 110.

How would I do such a query?

    UPDATE people SET column1 = '________random expression_________'",1
10298654,04/24/2012 13:18:07,74238,03/05/2009 13:42:07,471,2,Get result from dynamic SQL in stored procedure,"I'm writing a stored procedure where I need to dynamically construct a SQL statement within the procedure to reference a passed in table name.

I need to have this SQL statement return a result that I can then use throughout the rest of the procedure.

I've tried using temp tables and everything but I keep getting a message that I need to declare the variable, etc.

For example:

    DECLARE @FiscalYear INT    
    DECLARE @DataSource NVARCHAR(25)
    DECLARE @SQL NVARCHAR(250)
    SELECT @DataSource = 'CustomerCosts20120328'
    DECLARE @tempFiscalYear TABLE (	FiscalYear INT ) 
    SELECT @SQL = 'INSERT INTO @tempFiscalYear SELECT DISTINCT FiscalYear FROM ' + @DataSource
    EXEC(@SQL)
    SELECT @FiscalYear = FiscalYear FROM @tempFiscalYear

Or...

    DECLARE @FiscalYear INT  
    DECLARE @DataSource NVARCHAR(25)
    DECLARE @SQL NVARCHAR(250)
    SELECT @DataSource = 'CustomerCosts20120328'
    SELECT @SQL = 'SELECT DISTINCT @FiscalYear = FiscalYear FROM ' + @DataSource
    EXEC(@SQL)

Is there anyway to do this without resorting to using an actual table?

Thanks.",sql,sql-server-2008,tsql,stored-procedures,,,open,0,191,8,"Get result from dynamic SQL in stored procedure I'm writing a stored procedure where I need to dynamically construct a SQL statement within the procedure to reference a passed in table name.

I need to have this SQL statement return a result that I can then use throughout the rest of the procedure.

I've tried using temp tables and everything but I keep getting a message that I need to declare the variable, etc.

For example:

    DECLARE @FiscalYear INT    
    DECLARE @DataSource NVARCHAR(25)
    DECLARE @SQL NVARCHAR(250)
    SELECT @DataSource = 'CustomerCosts20120328'
    DECLARE @tempFiscalYear TABLE (	FiscalYear INT ) 
    SELECT @SQL = 'INSERT INTO @tempFiscalYear SELECT DISTINCT FiscalYear FROM ' + @DataSource
    EXEC(@SQL)
    SELECT @FiscalYear = FiscalYear FROM @tempFiscalYear

Or...

    DECLARE @FiscalYear INT  
    DECLARE @DataSource NVARCHAR(25)
    DECLARE @SQL NVARCHAR(250)
    SELECT @DataSource = 'CustomerCosts20120328'
    SELECT @SQL = 'SELECT DISTINCT @FiscalYear = FiscalYear FROM ' + @DataSource
    EXEC(@SQL)

Is there anyway to do this without resorting to using an actual table?

Thanks.",4
11265206,06/29/2012 16:03:44,1489504,06/28/2012 18:43:27,1,0,Script to generate insert staments,"I'm not an expert in MS SQL Server...
I am trying to write an SQL script to create an insert statement for each row of table TEST which has fied A (int) and field B varchar(30), in my MS SQL database. I would like to save those insert staments in a txt file to be able to apply that data back to another database.

Any idea about how to do it?

Thanks,

Abner.

 ",sql,,,,,06/29/2012 16:23:17,off topic,1,70,5,"Script to generate insert staments I'm not an expert in MS SQL Server...
I am trying to write an SQL script to create an insert statement for each row of table TEST which has fied A (int) and field B varchar(30), in my MS SQL database. I would like to save those insert staments in a txt file to be able to apply that data back to another database.

Any idea about how to do it?

Thanks,

Abner.

 ",1
5912353,05/06/2011 13:46:04,741874,05/06/2011 13:42:11,1,0,Is there an alternative to mySQL,the title says it all but anyways...is there an alternative to mySql.,sql,,,,,05/06/2011 14:08:32,not constructive,1,12,6,Is there an alternative to mySQL the title says it all but anyways...is there an alternative to mySql.,1
9821121,03/22/2012 11:09:40,1004978,10/20/2011 10:22:52,338,11,"Postgresql column reference ""id"" is ambiguous","I tried the following select:

    SELECT (id,name) FROM v_groups vg 
    inner join people2v_groups p2vg on vg.id = p2vg.v_group_id
    where p2vg.people_id =0;

and I get the following error column reference ""id"" is ambiguous.

Thing is if I try the same select but I only ask for (name) , and not for id also, it works.
I'm new to this and maybe I am missing something obvious. Any suggestions? 

Thanks.",sql,query,postgresql,select,,,open,0,75,6,"Postgresql column reference ""id"" is ambiguous I tried the following select:

    SELECT (id,name) FROM v_groups vg 
    inner join people2v_groups p2vg on vg.id = p2vg.v_group_id
    where p2vg.people_id =0;

and I get the following error column reference ""id"" is ambiguous.

Thing is if I try the same select but I only ask for (name) , and not for id also, it works.
I'm new to this and maybe I am missing something obvious. Any suggestions? 

Thanks.",4
1056390,06/29/2009 03:00:44,75500,03/09/2009 06:16:32,437,29,How to use SQL user defined functions in .NET?,"I created a scalar function in the DB

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    ALTER FUNCTION [dbo].[fn_GetUserId_Username]
    	(
    	@Username varchar(32)
    	)
    RETURNS int
    AS
    	BEGIN
    	DECLARE @UserId int
    	SELECT @UserId = UserId FROM [User] WHERE Username = @Username
        RETURN @UserId
    	END

Now I want to run it within my .NET C# or VB.NET code.

I use Entity Framework, I tried to map it with function mapping and I did not success.
i don't care to do it with simple DbCommand, the problem is that I get no results (the function exists in the Entities class):

    public int GetUserIdByUsername(string username)
    {
        EntityConnection connection = (EntityConnection)Connection;            
        DbCommand com = connection.StoreConnection.CreateCommand();
        com.CommandText = ""fn_GetUserId_Username"";
        com.CommandType = CommandType.StoredProcedure;
        com.Parameters.Add(new SqlParameter(""Username"", username));
        if (com.Connection.State == ConnectionState.Closed) com.Connection.Open();
        try
        {
            var result = com.ExecuteScalar(); //always null
        }
        catch (Exception e)
        { 
        }
        return result;
    }

Is there any solution?
Posts in either C# or VB.NET will be welcommed.",sql,udf,.net,oledbcommand,,,open,0,322,9,"How to use SQL user defined functions in .NET? I created a scalar function in the DB

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    ALTER FUNCTION [dbo].[fn_GetUserId_Username]
    	(
    	@Username varchar(32)
    	)
    RETURNS int
    AS
    	BEGIN
    	DECLARE @UserId int
    	SELECT @UserId = UserId FROM [User] WHERE Username = @Username
        RETURN @UserId
    	END

Now I want to run it within my .NET C# or VB.NET code.

I use Entity Framework, I tried to map it with function mapping and I did not success.
i don't care to do it with simple DbCommand, the problem is that I get no results (the function exists in the Entities class):

    public int GetUserIdByUsername(string username)
    {
        EntityConnection connection = (EntityConnection)Connection;            
        DbCommand com = connection.StoreConnection.CreateCommand();
        com.CommandText = ""fn_GetUserId_Username"";
        com.CommandType = CommandType.StoredProcedure;
        com.Parameters.Add(new SqlParameter(""Username"", username));
        if (com.Connection.State == ConnectionState.Closed) com.Connection.Open();
        try
        {
            var result = com.ExecuteScalar(); //always null
        }
        catch (Exception e)
        { 
        }
        return result;
    }

Is there any solution?
Posts in either C# or VB.NET will be welcommed.",4
10598124,05/15/2012 09:45:18,1395782,05/15/2012 09:30:54,1,0,Can you recommend a database design for survey questions and answers that would allow stroing all of its information?,"I have to create a database the stores the answers of the survey. The survey has three types of questions: Multiple choices, ranking and written questions. The survey consists of category and under some of the categories, there are subcategories. Under some categories or subcategories there are questions. Some questions has subquestions. The database should stores the respondent information. 
I am confusing and I don't know how to design a proper database that captures the answers of the three questions types
What I have up to now is the following:

    Respondents: RespondentID, Name, OrgCode
    Departments: OrgCode, DepartmentName
    Category: CategoryID, CategoryName
    SubCategory: SubCategoryID, SubCategoryName, CategoryID
    Questions: QuestionID, QuestionDesc
    SubQuestions: SubQuestionID, SubQuestionDesc, QuestionID
    Answers: AnswerID, AnswerDesc

More details on the survey questions: 
Multiple choice single answer (radio button) and the number of answers could 2 or 4 or 5
 
Ranking which is similar to multiple choice question with multiple answers (think like checkbox) but the main question will be mainly about ranking 7 areas from 1 to 3 

Written question is like asking the participants to add comments or something like this

**So how to modify the database design to capture the answers of the three questions types with relating them to the respondent?** 

Note that some questions have subquestions and sometimes not, so how to capture the answers for the questions that don't have subquestions and for those which have subquestions?",sql,database-design,sql-server-2008-r2,survey,,05/16/2012 17:11:55,not a real question,1,248,19,"Can you recommend a database design for survey questions and answers that would allow stroing all of its information? I have to create a database the stores the answers of the survey. The survey has three types of questions: Multiple choices, ranking and written questions. The survey consists of category and under some of the categories, there are subcategories. Under some categories or subcategories there are questions. Some questions has subquestions. The database should stores the respondent information. 
I am confusing and I don't know how to design a proper database that captures the answers of the three questions types
What I have up to now is the following:

    Respondents: RespondentID, Name, OrgCode
    Departments: OrgCode, DepartmentName
    Category: CategoryID, CategoryName
    SubCategory: SubCategoryID, SubCategoryName, CategoryID
    Questions: QuestionID, QuestionDesc
    SubQuestions: SubQuestionID, SubQuestionDesc, QuestionID
    Answers: AnswerID, AnswerDesc

More details on the survey questions: 
Multiple choice single answer (radio button) and the number of answers could 2 or 4 or 5
 
Ranking which is similar to multiple choice question with multiple answers (think like checkbox) but the main question will be mainly about ranking 7 areas from 1 to 3 

Written question is like asking the participants to add comments or something like this

**So how to modify the database design to capture the answers of the three questions types with relating them to the respondent?** 

Note that some questions have subquestions and sometimes not, so how to capture the answers for the questions that don't have subquestions and for those which have subquestions?",4
9538139,03/02/2012 18:01:30,444268,09/10/2010 10:59:50,57,4,CPU Usage to 100%,"I have Oracle 11G R2 running on M-4000 machine (supposedly a powerful machine). Recently, i noticed that my application has gone slow and is taking lot of time in quering from database. To my shock when i saw the statistics of DB machine i found the CPU usage to 100%. 
Here is the ash report..
https://picasaweb.google.com/chevalier51/March22012?authkey=Gv1sRgCMjIzInF3sXssAE#5715360392626499922

<br/>
Now can someone put me wise to what should i be doing to avoid such situation.",sql,oracle11g,cpu-usage,,,,open,0,70,4,"CPU Usage to 100% I have Oracle 11G R2 running on M-4000 machine (supposedly a powerful machine). Recently, i noticed that my application has gone slow and is taking lot of time in quering from database. To my shock when i saw the statistics of DB machine i found the CPU usage to 100%. 
Here is the ash report..
https://picasaweb.google.com/chevalier51/March22012?authkey=Gv1sRgCMjIzInF3sXssAE#5715360392626499922

<br/>
Now can someone put me wise to what should i be doing to avoid such situation.",3
3704580,09/13/2010 21:31:40,293249,03/14/2010 04:12:52,123,2,Interesting and challenging self join problem MS SQL 2005,"I have this table named **OrdersToCall**

Data types: All bigints, except for date which is a datetime

<kbd>|-Order Num-|----Date--- |- Primary Ph -| Secondary Ph | Alternate Ph</kbd>  
<kbd>|----101----| 02-07-2010 | 925-515-1234 | 916-515-1234 |  707-568-5778</kbd>  
<kbd>|----102----| 02-07-2010 | 925-888-4141 | 925-888-4141 |  000-000-0000</kbd>
<kbd>|----103----| 02-07-2010 | 000-000-0000 | 000-000-0000 |  510-555-4575</kbd>  
<kbd>|----104----| 02-07-2010 | 415-789-5454 | 415-707-5588 |  735-874-9566</kbd>
<kbd>|----105----| 02-07-2010 | 925-887-7979 | 925-887-7979 |  925-887-7979</kbd>

and I have another table named **PhoneNumCalled**

<kbd>|-AgentID-|----Date----|-Dialed Number|</kbd>  
<kbd>|-145564--| 02-07-2010 | 925-515-1234 |</kbd>  
<kbd>|-145564--| 02-07-2010 | 707-568-5778 |</kbd>  
<kbd>|-145566--| 02-07-2010 | 925-888-4141 |</kbd>  
<kbd>|-145567--| 02-07-2010 | 510-555-4575 |</kbd>  
<kbd>|-145568--| 02-07-2010 | 415-789-5454 |</kbd>  
<kbd>|-145568--| 02-07-2010 | 415-707-5588 |</kbd>  
<kbd>|-145568--| 02-07-2010 | 735-874-9566 |</kbd>  
<kbd>|-145570--| 02-07-2010 | 925-887-7979 |</kbd>  
<kbd>|-145570--| 02-07-2010 | 925-887-7979 |</kbd>  

Now my challenge is: I want to count how many *Order Num* were called and create a table based off the results.

So for example of agent 1234 called all 3 numbers on 1 order that would still only count as 1 order for that agent.

In less than 3 months time I already have almost 1/2 a million records so try to be as space conscious as possible.

My solution (Which I wish to revise with your help):  
I ended up creating a stored procedure which:

    Delete and recreate the CombinedData table created yesterday
    Insert into the CombinedData table
    Select Order Num, Date, Primary Ph as Phone from OrdersToCall
    Union
    Select Order Num, Date, Secondary Ph as Phone from OrdersToCall
    Union
    Select Order Num, Date, Alternate Ph as Phone from OrdersToCall
    Delete from the CombinedData table where phone in ('000-000-0000', '999-999-9999')

Now not only does this create a new table, but since each phone number in each order is now it's own row the table becomes HUGE and take up to 2 minutes to create.

Then from this table I derive the counts and store those in yet another table.

Please help, I'm lost on ideas, I've googled my heart out!",sql,sql-server-2005,join,,,,open,0,355,9,"Interesting and challenging self join problem MS SQL 2005 I have this table named **OrdersToCall**

Data types: All bigints, except for date which is a datetime

<kbd>|-Order Num-|----Date--- |- Primary Ph -| Secondary Ph | Alternate Ph</kbd>  
<kbd>|----101----| 02-07-2010 | 925-515-1234 | 916-515-1234 |  707-568-5778</kbd>  
<kbd>|----102----| 02-07-2010 | 925-888-4141 | 925-888-4141 |  000-000-0000</kbd>
<kbd>|----103----| 02-07-2010 | 000-000-0000 | 000-000-0000 |  510-555-4575</kbd>  
<kbd>|----104----| 02-07-2010 | 415-789-5454 | 415-707-5588 |  735-874-9566</kbd>
<kbd>|----105----| 02-07-2010 | 925-887-7979 | 925-887-7979 |  925-887-7979</kbd>

and I have another table named **PhoneNumCalled**

<kbd>|-AgentID-|----Date----|-Dialed Number|</kbd>  
<kbd>|-145564--| 02-07-2010 | 925-515-1234 |</kbd>  
<kbd>|-145564--| 02-07-2010 | 707-568-5778 |</kbd>  
<kbd>|-145566--| 02-07-2010 | 925-888-4141 |</kbd>  
<kbd>|-145567--| 02-07-2010 | 510-555-4575 |</kbd>  
<kbd>|-145568--| 02-07-2010 | 415-789-5454 |</kbd>  
<kbd>|-145568--| 02-07-2010 | 415-707-5588 |</kbd>  
<kbd>|-145568--| 02-07-2010 | 735-874-9566 |</kbd>  
<kbd>|-145570--| 02-07-2010 | 925-887-7979 |</kbd>  
<kbd>|-145570--| 02-07-2010 | 925-887-7979 |</kbd>  

Now my challenge is: I want to count how many *Order Num* were called and create a table based off the results.

So for example of agent 1234 called all 3 numbers on 1 order that would still only count as 1 order for that agent.

In less than 3 months time I already have almost 1/2 a million records so try to be as space conscious as possible.

My solution (Which I wish to revise with your help):  
I ended up creating a stored procedure which:

    Delete and recreate the CombinedData table created yesterday
    Insert into the CombinedData table
    Select Order Num, Date, Primary Ph as Phone from OrdersToCall
    Union
    Select Order Num, Date, Secondary Ph as Phone from OrdersToCall
    Union
    Select Order Num, Date, Alternate Ph as Phone from OrdersToCall
    Delete from the CombinedData table where phone in ('000-000-0000', '999-999-9999')

Now not only does this create a new table, but since each phone number in each order is now it's own row the table becomes HUGE and take up to 2 minutes to create.

Then from this table I derive the counts and store those in yet another table.

Please help, I'm lost on ideas, I've googled my heart out!",3
10985212,06/11/2012 18:02:57,1093674,12/12/2011 12:11:07,39,3,runing SQL excript daily on Linux server,A remote PC sends a SQL file daily to a linux server via FTP. Can I schedule the execution of the SQL script?,sql,remote,,,,06/13/2012 07:09:53,off topic,1,23,7,runing SQL excript daily on Linux server A remote PC sends a SQL file daily to a linux server via FTP. Can I schedule the execution of the SQL script?,2
6394487,06/18/2011 07:15:10,804302,06/18/2011 07:15:10,1,0,database design,"i saw this question in stackoverflow itself but i feel the question wasnt answered satisfactorily. I will copy-paste the same question here and being a newbie in database, it would be very helpful to me, more so as i have an initerview coming up next week.

**Database Design**

Part1: You are to design a schema (some tables) in which a student will have id, name; a course will have id, name; A schedule will have roomId, starting time; A room will have id, location, capacity.

Part2: You're to write the following queries a. return a list of all students and how many courses each of them took? order from highest to lowest.",sql,database-design,interview-questions,,,06/18/2011 11:25:08,not a real question,1,109,2,"database design i saw this question in stackoverflow itself but i feel the question wasnt answered satisfactorily. I will copy-paste the same question here and being a newbie in database, it would be very helpful to me, more so as i have an initerview coming up next week.

**Database Design**

Part1: You are to design a schema (some tables) in which a student will have id, name; a course will have id, name; A schedule will have roomId, starting time; A room will have id, location, capacity.

Part2: You're to write the following queries a. return a list of all students and how many courses each of them took? order from highest to lowest.",3
11691046,07/27/2012 15:33:30,834201,07/07/2011 19:09:40,113,4,Multiple columns in OVER ORDER BY,"Is there a way to specify multiple columns in the OVER ORDER BY clause?

    SELECT ROW_NUMBER() OVER(ORDER BY (A.Col1)) AS ID FROM MyTable A

The above works fine, but trying to add a second column does not work.

    SELECT ROW_NUMBER() OVER(ORDER BY (A.Col1, A.Col2)) AS ID FROM MyTable A

    **Incorrect syntax near ','.**",sql,order-by,row-number,,,,open,0,61,6,"Multiple columns in OVER ORDER BY Is there a way to specify multiple columns in the OVER ORDER BY clause?

    SELECT ROW_NUMBER() OVER(ORDER BY (A.Col1)) AS ID FROM MyTable A

The above works fine, but trying to add a second column does not work.

    SELECT ROW_NUMBER() OVER(ORDER BY (A.Col1, A.Col2)) AS ID FROM MyTable A

    **Incorrect syntax near ','.**",3
9112673,02/02/2012 12:54:58,1016726,10/27/2011 14:47:08,6,0,Sql update Query,"I recently got a question that I'm not sure I can complete. The is as follows: 'Using a single query update the 4 smallest customer id to male.' I'm using Oracle. My uncompleted code is below:

create table customer_09
		(
		custid varchar(5)primary key not null, 
		firstname varchar(20),
		lastname varchar(20),
		DOB date,
		address1 varchar(40),
		address2 varchar(40),
		phone varchar(7)
		);


UPDATE customer_09
SET gender = 'male'
WHERE custid = (select min(custid) from customer_09)


If anyone has the correct code, could you share with me please.

thank you",sql,windows,,,,02/03/2012 15:19:12,not a real question,1,71,3,"Sql update Query I recently got a question that I'm not sure I can complete. The is as follows: 'Using a single query update the 4 smallest customer id to male.' I'm using Oracle. My uncompleted code is below:

create table customer_09
		(
		custid varchar(5)primary key not null, 
		firstname varchar(20),
		lastname varchar(20),
		DOB date,
		address1 varchar(40),
		address2 varchar(40),
		phone varchar(7)
		);


UPDATE customer_09
SET gender = 'male'
WHERE custid = (select min(custid) from customer_09)


If anyone has the correct code, could you share with me please.

thank you",2
11296253,07/02/2012 15:03:50,966857,09/27/2011 10:52:33,16,0,How Make a Correct Sql Structure?,"I work on C# project.

i want to make sql db for my program.

in my program i have many section for each person such as Gender , Department , Education , Bank Name and etc. 

For Control Rows In Each Section if i make Tables for each section is correct?

for example make a table for Department With 4 rows . And Make Another Table For Education with 10 rows And ... . Or Make One Table With Many Column And Place All Of this section Together.

Which Way is Better?",sql,structure,,,,07/02/2012 22:08:19,not constructive,1,88,6,"How Make a Correct Sql Structure? I work on C# project.

i want to make sql db for my program.

in my program i have many section for each person such as Gender , Department , Education , Bank Name and etc. 

For Control Rows In Each Section if i make Tables for each section is correct?

for example make a table for Department With 4 rows . And Make Another Table For Education with 10 rows And ... . Or Make One Table With Many Column And Place All Of this section Together.

Which Way is Better?",2
3841170,10/01/2010 16:31:25,202875,11/04/2009 19:14:43,505,22,Rails find_by_sql database type dependent,"So in rails I use sqlite3 for development and mysql for production. Sqlite3 and mysql handle booleans differently (""t"" or ""f"" in sqlite3 and true or false on mysql). Usually it's not a problem when I do a find because I can do this:

    Comment.find(:all, :conditions => [""viewed = ?"", false])

And rails will insert the appropriate value depending on environment. But what if I want to do a find_by_sql in which I need a boolean? 

",sql,mysql,ruby-on-rails,sqlite,activerecord,,open,0,79,5,"Rails find_by_sql database type dependent So in rails I use sqlite3 for development and mysql for production. Sqlite3 and mysql handle booleans differently (""t"" or ""f"" in sqlite3 and true or false on mysql). Usually it's not a problem when I do a find because I can do this:

    Comment.find(:all, :conditions => [""viewed = ?"", false])

And rails will insert the appropriate value depending on environment. But what if I want to do a find_by_sql in which I need a boolean? 

",5
2041429,01/11/2010 11:18:51,247988,01/11/2010 11:18:51,1,0,update the val returned from aggreate function,how to update the col of table in sql using the aggregate function by udate statement ?,sql,,,,,,open,0,17,7,update the val returned from aggreate function how to update the col of table in sql using the aggregate function by udate statement ?,1
1570081,10/15/2009 03:02:29,182350,10/01/2009 08:31:43,-1,2,Any other way to make the query shorter?,"select A.regYear, A.regMonth, isnull(A.regCount,0), isnull(B.regCount,0), isnull(C.regCount,0), isnull(D.regCount,0),
isnull(E.regCount,0), isnull(F.regCount,0),
isnull(G.regCount,0),isnull(H.regCount,0),isnull(I.regCount,0),isnull(J.regCount,0),
isnull(K.regCount,0),isnull(L.regCount,0),isnull(M.regCount,0),isnull(N.regCount,0),
isnull(O.regCount,0),isnull(P.regCount,0),isnull(Q.regCount,0)
from (

select Year(reg_date) as regYear, Month(reg_Date) as RegMonth, count(*) as RegCount 
from dailyregistration
group by Year(reg_date) , Month(reg_Date)) A

left join 

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) < 0 
group by Year(reg_date) , Month(reg_Date) ) B on A.RegYear = B.regYear and A.RegMonth = B.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 0
group by Year(reg_date) , Month(reg_Date)) C on A.RegYear = C.regYear and A.RegMonth = C.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 1
group by Year(reg_date) , Month(reg_Date)) D on A.RegYear = D.regYear and A.RegMonth = D.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 2
group by Year(reg_date) , Month(reg_Date)) E on A.RegYear = E.regYear and A.RegMonth = E.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 3
group by Year(reg_date) , Month(reg_Date)) F on A.RegYear = F.regYear and A.RegMonth = F.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 4
group by Year(reg_date) , Month(reg_Date)) G on A.RegYear = G.regYear and A.RegMonth = G.RegMonth


left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 5
group by Year(reg_date) , Month(reg_Date)) H on A.RegYear = H.regYear and A.RegMonth = H.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 6
group by Year(reg_date) , Month(reg_Date)) I on A.RegYear = I.regYear and A.RegMonth = I.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 7
group by Year(reg_date) , Month(reg_Date)) J on A.RegYear = J.regYear and A.RegMonth = J.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 14
group by Year(reg_date) , Month(reg_Date)) K on A.RegYear = K.regYear and A.RegMonth = K.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 21
group by Year(reg_date) , Month(reg_Date)) L on A.RegYear = L.regYear and A.RegMonth = L.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 28
group by Year(reg_date) , Month(reg_Date)) M on A.RegYear = M.regYear and A.RegMonth = M.RegMonth
left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) > 28
group by Year(reg_date) , Month(reg_Date)) N on A.RegYear = N.regYear and A.RegMonth = N.RegMonth


left join 

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth, count(*) as RegCount 
from dailyregistration 
where reg_activationdate is not null
group by Year(reg_date) ,Month(reg_Date)) O on A.RegYear = O.regYear and A.RegMonth = O.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth, count(*) as RegCount 
from dailyregistration 
where reg_activationdate is null
group by Year(reg_date) ,Month(reg_Date)) P on A.RegYear = P.regYear and A.RegMonth = P.RegMonth

left join 
 
(select Year(prt_completed) as regYear, Month(prt_completed) as RegMonth, count(*) as RegCount 
from dailyPortOut 
where prt_status = 'COMPLETED'
group by Year(prt_completed) ,Month(prt_completed)) Q on A.RegYear = Q.regYear and A.RegMonth = Q.RegMonth 

order by A.regYear, A.regMonth




",sql,sql-server-2005,,,,04/21/2012 17:28:17,too localized,1,497,8,"Any other way to make the query shorter? select A.regYear, A.regMonth, isnull(A.regCount,0), isnull(B.regCount,0), isnull(C.regCount,0), isnull(D.regCount,0),
isnull(E.regCount,0), isnull(F.regCount,0),
isnull(G.regCount,0),isnull(H.regCount,0),isnull(I.regCount,0),isnull(J.regCount,0),
isnull(K.regCount,0),isnull(L.regCount,0),isnull(M.regCount,0),isnull(N.regCount,0),
isnull(O.regCount,0),isnull(P.regCount,0),isnull(Q.regCount,0)
from (

select Year(reg_date) as regYear, Month(reg_Date) as RegMonth, count(*) as RegCount 
from dailyregistration
group by Year(reg_date) , Month(reg_Date)) A

left join 

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) < 0 
group by Year(reg_date) , Month(reg_Date) ) B on A.RegYear = B.regYear and A.RegMonth = B.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 0
group by Year(reg_date) , Month(reg_Date)) C on A.RegYear = C.regYear and A.RegMonth = C.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 1
group by Year(reg_date) , Month(reg_Date)) D on A.RegYear = D.regYear and A.RegMonth = D.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 2
group by Year(reg_date) , Month(reg_Date)) E on A.RegYear = E.regYear and A.RegMonth = E.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 3
group by Year(reg_date) , Month(reg_Date)) F on A.RegYear = F.regYear and A.RegMonth = F.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 4
group by Year(reg_date) , Month(reg_Date)) G on A.RegYear = G.regYear and A.RegMonth = G.RegMonth


left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 5
group by Year(reg_date) , Month(reg_Date)) H on A.RegYear = H.regYear and A.RegMonth = H.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 6
group by Year(reg_date) , Month(reg_Date)) I on A.RegYear = I.regYear and A.RegMonth = I.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 7
group by Year(reg_date) , Month(reg_Date)) J on A.RegYear = J.regYear and A.RegMonth = J.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 14
group by Year(reg_date) , Month(reg_Date)) K on A.RegYear = K.regYear and A.RegMonth = K.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 21
group by Year(reg_date) , Month(reg_Date)) L on A.RegYear = L.regYear and A.RegMonth = L.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) = 28
group by Year(reg_date) , Month(reg_Date)) M on A.RegYear = M.regYear and A.RegMonth = M.RegMonth
left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth,
count(1) as RegCount from dailyregistration
where datediff(day, reg_date, reg_activationdate) > 28
group by Year(reg_date) , Month(reg_Date)) N on A.RegYear = N.regYear and A.RegMonth = N.RegMonth


left join 

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth, count(*) as RegCount 
from dailyregistration 
where reg_activationdate is not null
group by Year(reg_date) ,Month(reg_Date)) O on A.RegYear = O.regYear and A.RegMonth = O.RegMonth

left join

(select Year(reg_date) as regYear, Month(reg_Date) as RegMonth, count(*) as RegCount 
from dailyregistration 
where reg_activationdate is null
group by Year(reg_date) ,Month(reg_Date)) P on A.RegYear = P.regYear and A.RegMonth = P.RegMonth

left join 
 
(select Year(prt_completed) as regYear, Month(prt_completed) as RegMonth, count(*) as RegCount 
from dailyPortOut 
where prt_status = 'COMPLETED'
group by Year(prt_completed) ,Month(prt_completed)) Q on A.RegYear = Q.regYear and A.RegMonth = Q.RegMonth 

order by A.regYear, A.regMonth




",2
8811375,01/10/2012 22:20:57,1141850,01/10/2012 21:50:37,1,0,Getting a max value from a node of XML in SQL Server 2008,"I have some xml like this

    <variable>
    <historicDates>
    <item>
    <date>2012/01/13</date>
    <type>submitted</type>
    </item>
    <item>
    <date>2012/01/12</date>
    <type>required</type>
    </item>
    <item>
    <date>2012/01/11</date>
    <type>required</type>
    </item>
    </historicDates>
    </variable>
   

I am trying to write a sql statement to get the maximum date where the type equals required. To compound the issue I the column is a nvarchar(max) so I know I have to cast it as xml even before I start.

I've tried to figure out the cross apply but cannot get it to work.  Any help would be appreciated.
",sql,xml,server,value,max,,open,0,133,13,"Getting a max value from a node of XML in SQL Server 2008 I have some xml like this

    <variable>
    <historicDates>
    <item>
    <date>2012/01/13</date>
    <type>submitted</type>
    </item>
    <item>
    <date>2012/01/12</date>
    <type>required</type>
    </item>
    <item>
    <date>2012/01/11</date>
    <type>required</type>
    </item>
    </historicDates>
    </variable>
   

I am trying to write a sql statement to get the maximum date where the type equals required. To compound the issue I the column is a nvarchar(max) so I know I have to cast it as xml even before I start.

I've tried to figure out the cross apply but cannot get it to work.  Any help would be appreciated.
",5
7572584,09/27/2011 16:34:10,579843,01/18/2011 11:31:07,329,7,"Conditional SQL SELECT - when return set is empty, execute another SELECT?","I have webpage that has it's ""pages/articles"" stored in MySQL database. It also has feature to show different side menu for different page ... All that (menus, menu's items) is stored in DB.

Here's my SQL for getting all menu items for current page:

    SELECT * FROM menu_items JOIN pages ON menu_items.menu_id=pages.right_menu_id WHERE pages.link = ""some_link""

and it works. What I want is ability when this query returns an empty set, to execute another query and get it's result instead. Is it possible ?? If query mentioned above is empty, I would like to get result of this query:

    SELECT * FROM menu_items WHERE menu_id=2;

Is it possible, or should I just do it in PHP ?",sql,select,conditional,,,,open,0,120,12,"Conditional SQL SELECT - when return set is empty, execute another SELECT? I have webpage that has it's ""pages/articles"" stored in MySQL database. It also has feature to show different side menu for different page ... All that (menus, menu's items) is stored in DB.

Here's my SQL for getting all menu items for current page:

    SELECT * FROM menu_items JOIN pages ON menu_items.menu_id=pages.right_menu_id WHERE pages.link = ""some_link""

and it works. What I want is ability when this query returns an empty set, to execute another query and get it's result instead. Is it possible ?? If query mentioned above is empty, I would like to get result of this query:

    SELECT * FROM menu_items WHERE menu_id=2;

Is it possible, or should I just do it in PHP ?",3
7738526,10/12/2011 10:19:23,988670,10/11/2011 01:43:29,4,0,sql query to display employees with the same sally and commission,"hey guy im not that good at sql so need some help
the question is 

DISPLAY THE NAME,DEPARTMENT NAME AND SALARY OF ANY EMPLOYEE WHOSE SALARY AND COMMISSION(BOTH) MATCH THE SALARY AND COMMISSION OF ANY EMPLOYEE LOCATED IN DALLAS. INCLUDE EMPLOYEES WORKING IN DALLAS IN YOUR RESULT.

this is my code so far which comes up empty
select e.ename,d.dname,e.sal
from dept d,emp e
WHERE  (e.comm ,e.sal)IN (select e.comm,e.sal
                          from dept d,emp e
                          where d.loc = 'Dallas')

the actual answer should be 


ENAME      DNAME                 SAL                                            
---------- -------------- ----------                                            
SMITH      RESEARCH              800                                            
ADAMS      RESEARCH             1100                                            
JONES      RESEARCH             2975                                            
FORD       RESEARCH             3000                                            
SCOTT      RESEARCH             3000                                            


thanks guys",sql,query,,,,10/12/2011 20:05:38,too localized,1,558,11,"sql query to display employees with the same sally and commission hey guy im not that good at sql so need some help
the question is 

DISPLAY THE NAME,DEPARTMENT NAME AND SALARY OF ANY EMPLOYEE WHOSE SALARY AND COMMISSION(BOTH) MATCH THE SALARY AND COMMISSION OF ANY EMPLOYEE LOCATED IN DALLAS. INCLUDE EMPLOYEES WORKING IN DALLAS IN YOUR RESULT.

this is my code so far which comes up empty
select e.ename,d.dname,e.sal
from dept d,emp e
WHERE  (e.comm ,e.sal)IN (select e.comm,e.sal
                          from dept d,emp e
                          where d.loc = 'Dallas')

the actual answer should be 


ENAME      DNAME                 SAL                                            
---------- -------------- ----------                                            
SMITH      RESEARCH              800                                            
ADAMS      RESEARCH             1100                                            
JONES      RESEARCH             2975                                            
FORD       RESEARCH             3000                                            
SCOTT      RESEARCH             3000                                            


thanks guys",2
10933639,06/07/2012 14:14:36,1411630,05/23/2012 03:54:01,30,1,NULL vs NOT NULL,"In sql database column, empty fields will be set to `NULL` unless we specify it using `NOT NULL`. What are the advantages of using one instead of the other? Thanks!",sql,,,,,06/08/2012 13:44:13,not constructive,1,30,4,"NULL vs NOT NULL In sql database column, empty fields will be set to `NULL` unless we specify it using `NOT NULL`. What are the advantages of using one instead of the other? Thanks!",1
10464219,05/05/2012 17:22:25,575219,01/14/2011 04:26:09,159,1,Simplify Database design,"Could anyone suggest a good design for these 4tables. 

        Design
         Fields: DesignId (Primarykey),
        Iname..,....
        
        Table2 :InputFiles
        FileId int,
        DesignId ,
        FileName,
        Description,
        primary key (FileId,DesignId )
        foreign key(DesignId)...
        //This foreign key here seems to cause insert problems.
    
    
    Table3 : InputData
    DesignId int,
    TestCaseInputId,
    FileId int,
    MaterialType,
    primary key(DesignId ,TestCaseInputId,FileId)
    foreign key(FileId ) references InputFiles
    foreign key(DesignId) refernces Design
    
    
    Questions: 
    I am not sure or convinced abt the composite keys in Table2, Table3.
    Foreign Keys.The foreign keys seem to cause a insertion problem


Thank you
Sun
",sql,,,,,05/05/2012 18:39:01,not a real question,1,220,3,"Simplify Database design Could anyone suggest a good design for these 4tables. 

        Design
         Fields: DesignId (Primarykey),
        Iname..,....
        
        Table2 :InputFiles
        FileId int,
        DesignId ,
        FileName,
        Description,
        primary key (FileId,DesignId )
        foreign key(DesignId)...
        //This foreign key here seems to cause insert problems.
    
    
    Table3 : InputData
    DesignId int,
    TestCaseInputId,
    FileId int,
    MaterialType,
    primary key(DesignId ,TestCaseInputId,FileId)
    foreign key(FileId ) references InputFiles
    foreign key(DesignId) refernces Design
    
    
    Questions: 
    I am not sure or convinced abt the composite keys in Table2, Table3.
    Foreign Keys.The foreign keys seem to cause a insertion problem


Thank you
Sun
",1
1450773,09/20/2009 10:53:39,152776,08/07/2009 21:58:20,33,3,SQL Server 2008 - excluding rows,"I have the following query

> DECLARE @ProductIdsToExclude nvarchar(max)
>
> SET @ProductIdsToExclude = '49506541-4CE2-40AC-812A-7AB262E6F0B0,49506541-4ce2-40ac-812a-7ab262e6f0b0'

I'm then using [this][1] function to parse @ProductIdsToExclude to a temp table:

>CREATE TABLE 

>	#TempProductIdsToExclude (ProductId uniqueidentifier)

>INSERT 

>	#TempProductIdsToExclude (ProductId)

>SELECT

>	t.txt_value

>FROM 

>	dbo.fn_ParseText2Table(@ProductIdsToExclude,',') as t 


I'm then using this query to pull out all *Products*:

> SELECT * FROM Products

My question is - how can I get the query to **exclude** all results where the *ProductId* in the *Products* table is contained within *#TempProductIdsToExclude*

thanks!


  [1]: http://www.codeproject.com/KB/database/SQL_UDF_to_Parse_a_String.aspx?msg=2439257",sql,server,2008,exclude,rows,,open,0,73,6,"SQL Server 2008 - excluding rows I have the following query

> DECLARE @ProductIdsToExclude nvarchar(max)
>
> SET @ProductIdsToExclude = '49506541-4CE2-40AC-812A-7AB262E6F0B0,49506541-4ce2-40ac-812a-7ab262e6f0b0'

I'm then using [this][1] function to parse @ProductIdsToExclude to a temp table:

>CREATE TABLE 

>	#TempProductIdsToExclude (ProductId uniqueidentifier)

>INSERT 

>	#TempProductIdsToExclude (ProductId)

>SELECT

>	t.txt_value

>FROM 

>	dbo.fn_ParseText2Table(@ProductIdsToExclude,',') as t 


I'm then using this query to pull out all *Products*:

> SELECT * FROM Products

My question is - how can I get the query to **exclude** all results where the *ProductId* in the *Products* table is contained within *#TempProductIdsToExclude*

thanks!


  [1]: http://www.codeproject.com/KB/database/SQL_UDF_to_Parse_a_String.aspx?msg=2439257",5
10941823,06/08/2012 00:50:23,127671,06/23/2009 15:49:06,46,5,SQL database backups methods-tools-procedures,"Currently, I am investigating some way to more efficiently backup 4 Production SQL Databases (3 different servers/instances) and would like to know if anyone else has had the problems we are having and if anyone has any recommendations.

Database 1: 80GB
Database 2: 74GB
Database 3: 5GB
Database 4: 30GB

Database 3 & 4 are for new systems and will be growing rapidly over the next several months.  Currently Mirrored.

The problem we are running into is that there are maintenance tasks on the servers that run for these databases for backups that take roughly 30 min for Database 1 & 2.  Now these all run at the same time as several other environment backups that the Sys Eng have running.

After the backup, a schedules task using 7-zip is run to compress the backups.  All of this is killing the CPU during that time frame and if for whatever reason a job/task gets locked up, it will affect the entire system.

Now due to the business we are in, we have a very limited timeframe we can run these backup jobs, and these backups need to be done.  We also need to start encrypting the backups after the compression to further our HIPPA compliance... yep...

Another part of the problem that we are are aware of is we have 20 other databases doing the same thing at the same time, which is killing the SAN, all of which we know and believe don't need these backup tasks.

So aside from that which we are working on, we are trying new methods of backing up databases to try to take the CPU load off the database servers as much as possible and hopefully do the backups for the databases incrementally.

Any suggestions?  Tools, methods?  We've tested Red-Gates SQL backup pro tool, SQL backupandftp freeware and using SSIS but none have seemed to accomplish what we were hoping for (ability to quickly accomplish the task and/or run on another server taking the CPU off the DB server).",sql,sql-server-2008,backup,,,06/10/2012 15:24:38,off topic,1,331,4,"SQL database backups methods-tools-procedures Currently, I am investigating some way to more efficiently backup 4 Production SQL Databases (3 different servers/instances) and would like to know if anyone else has had the problems we are having and if anyone has any recommendations.

Database 1: 80GB
Database 2: 74GB
Database 3: 5GB
Database 4: 30GB

Database 3 & 4 are for new systems and will be growing rapidly over the next several months.  Currently Mirrored.

The problem we are running into is that there are maintenance tasks on the servers that run for these databases for backups that take roughly 30 min for Database 1 & 2.  Now these all run at the same time as several other environment backups that the Sys Eng have running.

After the backup, a schedules task using 7-zip is run to compress the backups.  All of this is killing the CPU during that time frame and if for whatever reason a job/task gets locked up, it will affect the entire system.

Now due to the business we are in, we have a very limited timeframe we can run these backup jobs, and these backups need to be done.  We also need to start encrypting the backups after the compression to further our HIPPA compliance... yep...

Another part of the problem that we are are aware of is we have 20 other databases doing the same thing at the same time, which is killing the SAN, all of which we know and believe don't need these backup tasks.

So aside from that which we are working on, we are trying new methods of backing up databases to try to take the CPU load off the database servers as much as possible and hopefully do the backups for the databases incrementally.

Any suggestions?  Tools, methods?  We've tested Red-Gates SQL backup pro tool, SQL backupandftp freeware and using SSIS but none have seemed to accomplish what we were hoping for (ability to quickly accomplish the task and/or run on another server taking the CPU off the DB server).",3
8889704,01/17/2012 04:35:16,456935,09/24/2010 05:44:23,75,6,getting multiple values from one table and using to retrive data from other table in stored procedure in sql server,"I am using sql server 2008 
I need to retrieve data from one table and use it to retrieve data from other table 
using stored procedure.

help me out ",sql,sql-server,stored-procedures,,,01/17/2012 15:42:46,not a real question,1,29,20,"getting multiple values from one table and using to retrive data from other table in stored procedure in sql server I am using sql server 2008 
I need to retrieve data from one table and use it to retrieve data from other table 
using stored procedure.

help me out ",3
7450511,09/16/2011 21:22:41,949586,09/16/2011 21:22:41,1,0,SQL Self Join without double cross results,"Hej!

Sorry I'm new to sql...
I'm searching for the solution since hours, but cat get it...
I hope someone can help me please!

My table:

    ID         name          value1      value2
    1          Meyer         20          _
    2          Schmitt       20          _
    3          Berger        _           20
    4          Chief         _           20


my query:

    SELECT A.ID, A.name AS nameA, B.name AS nameB, A.value1 
    FROM table AS A INNER JOIN table AS B
    ON A.value1 = B.value2

result:

    ID      nameA      nameB       value1
    1       Meyer      Berger      20
    1       Meyer      Chief       20
    2       Schmitt    Berger      20
    2       Schmitt    Chief       20  

THIS SHOULD IT LOOK LIKE:

    ID      nameA       nameB      value1
    1       Meyer       Berger     20
    2       Schmitt     Chief      20

I also tried the GROUP BY A.name: (wrong result...)

    ID       nameA      nameB     value1
    1        Meyer      Berger    20
    2        Schmitt    Berger    20

Looking forward to an answer!

Thank you & best regards
airfrank
     
",sql,,,,,09/22/2011 16:21:35,not a real question,1,487,7,"SQL Self Join without double cross results Hej!

Sorry I'm new to sql...
I'm searching for the solution since hours, but cat get it...
I hope someone can help me please!

My table:

    ID         name          value1      value2
    1          Meyer         20          _
    2          Schmitt       20          _
    3          Berger        _           20
    4          Chief         _           20


my query:

    SELECT A.ID, A.name AS nameA, B.name AS nameB, A.value1 
    FROM table AS A INNER JOIN table AS B
    ON A.value1 = B.value2

result:

    ID      nameA      nameB       value1
    1       Meyer      Berger      20
    1       Meyer      Chief       20
    2       Schmitt    Berger      20
    2       Schmitt    Chief       20  

THIS SHOULD IT LOOK LIKE:

    ID      nameA       nameB      value1
    1       Meyer       Berger     20
    2       Schmitt     Chief      20

I also tried the GROUP BY A.name: (wrong result...)

    ID       nameA      nameB     value1
    1        Meyer      Berger    20
    2        Schmitt    Berger    20

Looking forward to an answer!

Thank you & best regards
airfrank
     
",1
9119387,02/02/2012 20:21:11,389122,07/12/2010 01:23:57,418,3,What is a good database to keep track of general Statistics?,"I'm currently storing timestamps with pageviews and number of users online every minute in MongoDB. It's working well so far but I'm wondering if there's a better database to keep track of statistics. 

One thing that really bothers me about MongoDB is that I can't query every nth data point. This becomes annoying when I graph the data, and zoom in and out. For now I'm pulling all the data in the finest granularity into memory, and manually taking every nth one.

Preferably, a good database has:

1. fast writes (can support tracking a datapoint every few seconds from many sources)
2. advanced queries (eg query every nth data point)
3. has built in support for map reduce, and similarly useful tools
4. is a nosql (so I can throw whatever into a data point)

Thanks!",sql,database,statistics,nosql,,02/03/2012 17:39:42,off topic,1,130,11,"What is a good database to keep track of general Statistics? I'm currently storing timestamps with pageviews and number of users online every minute in MongoDB. It's working well so far but I'm wondering if there's a better database to keep track of statistics. 

One thing that really bothers me about MongoDB is that I can't query every nth data point. This becomes annoying when I graph the data, and zoom in and out. For now I'm pulling all the data in the finest granularity into memory, and manually taking every nth one.

Preferably, a good database has:

1. fast writes (can support tracking a datapoint every few seconds from many sources)
2. advanced queries (eg query every nth data point)
3. has built in support for map reduce, and similarly useful tools
4. is a nosql (so I can throw whatever into a data point)

Thanks!",4
5351270,03/18/2011 11:25:21,665942,03/18/2011 11:25:21,1,0,how the performance will be?,i have a huge application.now i have a requirement for image upload.do i need to create a new database or i can simply create a new table in the same database.how the performance will be?,sql,,,,,03/18/2011 11:36:16,not a real question,1,35,5,how the performance will be? i have a huge application.now i have a requirement for image upload.do i need to create a new database or i can simply create a new table in the same database.how the performance will be?,1
8536420,12/16/2011 15:35:51,968724,09/28/2011 09:01:25,1,0,Recursive CTE - consolidate start and end dates,"I have the following table:

    row_num customer_status    effective_from_datetime
    ------- ------------------ -----------------------
    1	    Active	           2011-01-01
    2	    Active	           2011-01-02
    3	    Active	           2011-01-03
    4	    Suspended	       2011-01-04
    5	    Suspended	       2011-01-05
    6	    Active	           2011-01-06


And am trying to achieve the following result whereby consecutive rows with the same status are merged into one row with an effective from and to date range:

    customer_status	effective_from_datetime effective_to_datetime
    --------------- ----------------------- ---------------------
    Active			2011-01-01				2011-01-04
    Suspended		2011-01-04				2011-01-06
    Active			2011-01-06				NULL


I can get a recursive CTE to output the correct effective_to_datetime based on the next row, but am having trouble merging the ranges.

Code to generate sample data:

	CREATE TABLE #temp
	(
	row_num INT IDENTITY(1,1),
	customer_status VARCHAR(10),
	effective_from_datetime DATE
	)

	INSERT INTO #temp
	VALUES 
	('Active','2011-01-01')
	,('Active','2011-01-02')
	,('Active','2011-01-03')
	,('Suspended','2011-01-04')
	,('Suspended','2011-01-05')
	,('Active','2011-01-06')
",sql,tsql,server,,,,open,0,211,8,"Recursive CTE - consolidate start and end dates I have the following table:

    row_num customer_status    effective_from_datetime
    ------- ------------------ -----------------------
    1	    Active	           2011-01-01
    2	    Active	           2011-01-02
    3	    Active	           2011-01-03
    4	    Suspended	       2011-01-04
    5	    Suspended	       2011-01-05
    6	    Active	           2011-01-06


And am trying to achieve the following result whereby consecutive rows with the same status are merged into one row with an effective from and to date range:

    customer_status	effective_from_datetime effective_to_datetime
    --------------- ----------------------- ---------------------
    Active			2011-01-01				2011-01-04
    Suspended		2011-01-04				2011-01-06
    Active			2011-01-06				NULL


I can get a recursive CTE to output the correct effective_to_datetime based on the next row, but am having trouble merging the ranges.

Code to generate sample data:

	CREATE TABLE #temp
	(
	row_num INT IDENTITY(1,1),
	customer_status VARCHAR(10),
	effective_from_datetime DATE
	)

	INSERT INTO #temp
	VALUES 
	('Active','2011-01-01')
	,('Active','2011-01-02')
	,('Active','2011-01-03')
	,('Suspended','2011-01-04')
	,('Suspended','2011-01-05')
	,('Active','2011-01-06')
",3
4124018,11/08/2010 12:57:13,50190,12/30/2008 14:33:25,200,8,SQL Query MAX with SUm,"I have a table where i have ID,matchid,point1,point2. I need to get the ID which has the maximum points but the problem i am facing is i need find max record depending on sum of both (point1+point), I have no idea how I can get the max with the combination of 2 columns i have tried query such as,

    SELECT MAX(column1+column2) FROM table
    
    MAX(SUM(column1,column2)) FROM table

but nothing works I am using Ms:Access ",sql,ms-access,,,,,open,0,83,5,"SQL Query MAX with SUm I have a table where i have ID,matchid,point1,point2. I need to get the ID which has the maximum points but the problem i am facing is i need find max record depending on sum of both (point1+point), I have no idea how I can get the max with the combination of 2 columns i have tried query such as,

    SELECT MAX(column1+column2) FROM table
    
    MAX(SUM(column1,column2)) FROM table

but nothing works I am using Ms:Access ",2
259157,11/03/2008 16:25:08,5618,09/10/2008 14:56:27,795,57,What is your recomendation for a good SQL IDE?,What is the best SQL IDE you have used?,sql,ide,,,,09/03/2011 23:15:32,not constructive,1,9,9,What is your recomendation for a good SQL IDE? What is the best SQL IDE you have used?,2
8452028,12/09/2011 21:40:14,79513,03/18/2009 14:30:08,1958,67,Updating rows based on a multiple column condition,"I'm trying to update some rows in a table based on two other columns in another table.  As a toy model, consider two tables: People, with columns first_name, last_name, and has_license; Drivers, with columns first_name and last_name.  Now I want to update the first table so has_license='Y' for all tuples of first_name and last_name that are also in the Drivers table.

I could do:

    UPDATE people SET has_license='Y'
    WHERE first_name + last_name IN (SELECT first_name + last_name FROM drivers)

(In my actual query, first_name and last_name are an externally-set record id and a date, and the subquery is more complex involving a join/EXCEPT clause.)

That's clumsy and has possible errors depending on the values.  Ideally I could just make the tuple in sql like so:

    UPDATE people SET has_license='Y'
    WHERE (first_name, last_name) IN (SELECT first_name, last_name FROM drivers)

But that's invalid SQL (according to SQLite).  So is what I want even possible?

(One other problem is that none of the tables have any primary keys, especially not single-column ones.  If that weren't the case, I would use that to simply identify the row.)
",sql,sqlite,,,,,open,0,195,8,"Updating rows based on a multiple column condition I'm trying to update some rows in a table based on two other columns in another table.  As a toy model, consider two tables: People, with columns first_name, last_name, and has_license; Drivers, with columns first_name and last_name.  Now I want to update the first table so has_license='Y' for all tuples of first_name and last_name that are also in the Drivers table.

I could do:

    UPDATE people SET has_license='Y'
    WHERE first_name + last_name IN (SELECT first_name + last_name FROM drivers)

(In my actual query, first_name and last_name are an externally-set record id and a date, and the subquery is more complex involving a join/EXCEPT clause.)

That's clumsy and has possible errors depending on the values.  Ideally I could just make the tuple in sql like so:

    UPDATE people SET has_license='Y'
    WHERE (first_name, last_name) IN (SELECT first_name, last_name FROM drivers)

But that's invalid SQL (according to SQLite).  So is what I want even possible?

(One other problem is that none of the tables have any primary keys, especially not single-column ones.  If that weren't the case, I would use that to simply identify the row.)
",2
2929936,05/28/2010 14:38:17,315491,04/13/2010 13:05:10,682,51,Looking for a good book on SQL,"Was wondering if any one could recommend any and all books for learning more about SQL and DB concepts?

I found this [one][1] while browsing SO, but was wondering if anyone had other or more up to date recommendations?


  [1]: http://oreilly.com/catalog/9780596009762/",sql,books,,,,06/04/2012 09:18:21,not constructive,1,41,7,"Looking for a good book on SQL Was wondering if any one could recommend any and all books for learning more about SQL and DB concepts?

I found this [one][1] while browsing SO, but was wondering if anyone had other or more up to date recommendations?


  [1]: http://oreilly.com/catalog/9780596009762/",2
3119403,06/25/2010 15:43:31,376206,06/25/2010 11:22:53,1,0,Roles of parentheses in SQL Server SELECT queries?,"The following query returns no result and no error on SQL Server 2008 (tested on SP1), you can run it against any database, even master:

    WITH computed_table (id) AS
    (
        SELECT id FROM this_table_does_not_exist
    )
    (SELECT * FROM computed_table)
    UNION
    (SELECT * FROM another_table_that_does_not_exists)

On SQL Server 2005, you get an error because the tables do not exist.
You get also get an error if you remove some parentheses:

    WITH computed_table (id) AS
    (
        SELECT id FROM this_table_does_not_exist
    )
    SELECT * FROM computed_table
    UNION
    (SELECT * FROM another_table_that_does_not_exists)

The same kind of problems appears with real tables: on some occasions, the query does not return any result, and if you make some some slight changes, like removing a space or a carriage return, it works again...

I think that there may be a problem in the query, because the SELECT enclosed in parentheses may be interpreted as an expression instead of a subquery, as in [this page][1]. But that should at least return an error.

Am I missing something?


  [1]: http://webcache.googleusercontent.com/search?q=cache:CEEDEIvJmWYJ:using-sqlite.labs.oreilly.com/re119.html+sql+parentheses+%22around+select%22&cd=4&hl=en&ct=clnk&client=firefox-a",sql,sql-server,sql-server-2005,sql-server-2008,,,open,0,217,8,"Roles of parentheses in SQL Server SELECT queries? The following query returns no result and no error on SQL Server 2008 (tested on SP1), you can run it against any database, even master:

    WITH computed_table (id) AS
    (
        SELECT id FROM this_table_does_not_exist
    )
    (SELECT * FROM computed_table)
    UNION
    (SELECT * FROM another_table_that_does_not_exists)

On SQL Server 2005, you get an error because the tables do not exist.
You get also get an error if you remove some parentheses:

    WITH computed_table (id) AS
    (
        SELECT id FROM this_table_does_not_exist
    )
    SELECT * FROM computed_table
    UNION
    (SELECT * FROM another_table_that_does_not_exists)

The same kind of problems appears with real tables: on some occasions, the query does not return any result, and if you make some some slight changes, like removing a space or a carriage return, it works again...

I think that there may be a problem in the query, because the SELECT enclosed in parentheses may be interpreted as an expression instead of a subquery, as in [this page][1]. But that should at least return an error.

Am I missing something?


  [1]: http://webcache.googleusercontent.com/search?q=cache:CEEDEIvJmWYJ:using-sqlite.labs.oreilly.com/re119.html+sql+parentheses+%22around+select%22&cd=4&hl=en&ct=clnk&client=firefox-a",4
18952,08/20/2008 22:01:16,1293,08/14/2008 12:38:08,86,13,What is your reporting tool of choice?,"Every project invariably needs some type of reporting functionality.  From a foreach loop in your language of choice to a full blow BI platform.  

> To get the job done what tools, widgets, platforms has the group used with success, frustration and failure?",sql,reporting,bi,business-intelligence,,10/05/2011 05:18:37,not constructive,1,45,7,"What is your reporting tool of choice? Every project invariably needs some type of reporting functionality.  From a foreach loop in your language of choice to a full blow BI platform.  

> To get the job done what tools, widgets, platforms has the group used with success, frustration and failure?",4
11334018,07/04/2012 18:34:22,1502264,07/04/2012 18:28:13,1,0,MsSql Query slow when paginated,"I am seeing some strange behaviour with following SQL Query: (SQL Server 2012)

select * FROM dbo.Person WHERE CONTAINS(Name, '""John"" AND ""Smith""')
order by Name

Executing this query alone gives me about 1'300 results in less than two seconds. (There's a fulltext-index on Name)

When I, however, change the query to the following: 

select * FROM dbo.Person WHERE CONTAINS(Name, '""John"" AND ""Smith""')
order by Name
offset 0 rows
fetch next 10 ROWS ONLY

It takes more than 20 seconds to give me 10 results.

Following Query is even worse:

SELECT Id FROM ( 
	SELECT ROW_NUMBER() OVER (ORDER BY Name) AS RowNum, * 
	FROM dbo.Person
	WHERE CONTAINS(Name, '""John"" AND ""Smith""') ) AS RowConstrainedResult 
	WHERE RowNum >= 0 AND RowNum < 11 
	ORDER BY RowNum

It takes more than 1.5 minutes to complete!

Any ideas?",sql,sql-server,,,,07/10/2012 16:25:37,off topic,1,120,5,"MsSql Query slow when paginated I am seeing some strange behaviour with following SQL Query: (SQL Server 2012)

select * FROM dbo.Person WHERE CONTAINS(Name, '""John"" AND ""Smith""')
order by Name

Executing this query alone gives me about 1'300 results in less than two seconds. (There's a fulltext-index on Name)

When I, however, change the query to the following: 

select * FROM dbo.Person WHERE CONTAINS(Name, '""John"" AND ""Smith""')
order by Name
offset 0 rows
fetch next 10 ROWS ONLY

It takes more than 20 seconds to give me 10 results.

Following Query is even worse:

SELECT Id FROM ( 
	SELECT ROW_NUMBER() OVER (ORDER BY Name) AS RowNum, * 
	FROM dbo.Person
	WHERE CONTAINS(Name, '""John"" AND ""Smith""') ) AS RowConstrainedResult 
	WHERE RowNum >= 0 AND RowNum < 11 
	ORDER BY RowNum

It takes more than 1.5 minutes to complete!

Any ideas?",2
3832282,09/30/2010 15:43:00,217323,11/23/2009 20:31:31,184,20,"Getting ""no join predicate"" warning even tho I am using ""inner join""","I am using SQL server 2008 r2 and I have a query that inner joins 3 tables:

    select * from  t1 INNER JOIN t2 on t1.""Account Key"" = t2.""Account Key""
    INNER JOIN t3 on t2.""Account Key"" = t3.""Account Key""
The problem is that I am getting a ""no join predicate"" warning on the second inner join; in addition to that, it is doing cross product of the table produced by the 1st join with t3 which makes the query run forever (besides giving the wrong results). 

I ran the following query to see if there are any account keys equal on both sides of the last join:

    select ""Account Key"" from  t1 INNER JOIN t2 on t1.""Account Key"" = t2.""Account Key""
    INTERSECT 
    select ""Account Key"" from t3 on t2.""Account Key"" = t3.""Account Key""

I get 0 rows, which means that there are no account keys equal on on both sides of the join. However, **should not the original query give 0 rows instead of giving a cross product since I am using an ""inner join""?**

Thanks in advanced for your answers and pointers.",sql,sql-server-2008,,,,,open,0,198,12,"Getting ""no join predicate"" warning even tho I am using ""inner join"" I am using SQL server 2008 r2 and I have a query that inner joins 3 tables:

    select * from  t1 INNER JOIN t2 on t1.""Account Key"" = t2.""Account Key""
    INNER JOIN t3 on t2.""Account Key"" = t3.""Account Key""
The problem is that I am getting a ""no join predicate"" warning on the second inner join; in addition to that, it is doing cross product of the table produced by the 1st join with t3 which makes the query run forever (besides giving the wrong results). 

I ran the following query to see if there are any account keys equal on both sides of the last join:

    select ""Account Key"" from  t1 INNER JOIN t2 on t1.""Account Key"" = t2.""Account Key""
    INTERSECT 
    select ""Account Key"" from t3 on t2.""Account Key"" = t3.""Account Key""

I get 0 rows, which means that there are no account keys equal on on both sides of the join. However, **should not the original query give 0 rows instead of giving a cross product since I am using an ""inner join""?**

Thanks in advanced for your answers and pointers.",2
11475970,07/13/2012 18:09:30,1514165,07/10/2012 08:27:16,8,0,Installed SQL Server 2008 R2 - sa password,"For SQL SERVER 2008 R2,

In my company, they give me a computer which was used by another employeer.
SQL Server 2008 R2 was installed but I don't know 'sa' password.

When I want to alter login, it gives below error.

""Cannot alter the login 'sa', because it does not exist or you do not have permission.""

When I want to restore a database, it gives pergaimission error again.

(When I enter the Security --> Logins --> sa --> Properties 
windows authentication is disabled.)


Can I change it?


P.S: Password is not ""password"" :)

",sql,sql-server-2008,,,,07/14/2012 21:07:09,off topic,1,86,8,"Installed SQL Server 2008 R2 - sa password For SQL SERVER 2008 R2,

In my company, they give me a computer which was used by another employeer.
SQL Server 2008 R2 was installed but I don't know 'sa' password.

When I want to alter login, it gives below error.

""Cannot alter the login 'sa', because it does not exist or you do not have permission.""

When I want to restore a database, it gives pergaimission error again.

(When I enter the Security --> Logins --> sa --> Properties 
windows authentication is disabled.)


Can I change it?


P.S: Password is not ""password"" :)

",2
85675,09/17/2008 17:35:42,16484,09/17/2008 17:35:42,1,0,How do I compare two glob values in Oracle,"I have two tables I would like to complare.  One of the columns is type glob.  I would like to do something like this:

    select key, glob_value source_table
    minus
    select key, glob_value target_table

Unfortunately, Oracle can't perform minus operations on globs.  How can I do this?",sql,oracle,minus,,,,open,0,57,9,"How do I compare two glob values in Oracle I have two tables I would like to complare.  One of the columns is type glob.  I would like to do something like this:

    select key, glob_value source_table
    minus
    select key, glob_value target_table

Unfortunately, Oracle can't perform minus operations on globs.  How can I do this?",3
5373030,03/21/2011 01:40:09,668728,03/21/2011 01:40:09,1,0,SQL Query Help: Need to write a query for the below described problem.,"Lets say i have table called Orders

id      qty1    qty2     qty3
-----------------------------------
1       1        2        3
2       0        1        0
3       3        2        1

Result of the query should be as following (Note qty are sum column wise for qty<i>)

productID  qty
----------------
1           4
2           5
3           4

Please help me to make query?
",sql,,,,,,open,0,146,13,"SQL Query Help: Need to write a query for the below described problem. Lets say i have table called Orders

id      qty1    qty2     qty3
-----------------------------------
1       1        2        3
2       0        1        0
3       3        2        1

Result of the query should be as following (Note qty are sum column wise for qty<i>)

productID  qty
----------------
1           4
2           5
3           4

Please help me to make query?
",1
4074430,11/02/2010 02:02:48,482664,10/21/2010 07:16:22,1,0,Insert data into 3 related tables,"How to insert data into 3 related tables (SQL Server)

For example, I have tables Customer <-- Customer_Address --> Address 
After I insert data into Customer and Address, how do I insert the IDs from Customer and Address in to Customer_Address? (join table)

Thanks!",sql,,,,,,open,0,42,6,"Insert data into 3 related tables How to insert data into 3 related tables (SQL Server)

For example, I have tables Customer <-- Customer_Address --> Address 
After I insert data into Customer and Address, how do I insert the IDs from Customer and Address in to Customer_Address? (join table)

Thanks!",1
6219893,06/02/2011 20:19:12,72871,03/02/2009 16:50:36,1371,21,Read/Write safe file based storage for local or network shared data. (SQL CF?),"We have a need to have a datastore of some form that has the following properties.

 - Relocatable, local or remote systems.
 - Capable of multiple readers/writers, new queries should contain updates.
 - De-centralized, no server would be required.
 - Capable of holding at least 16 Mb of data.

SQL CF seems capable, but I'm not sure I'd understand what technologies would go into integrating such a solution as I don't really have an SQL background.",sql,database,,,,06/03/2011 08:35:09,off topic,1,75,13,"Read/Write safe file based storage for local or network shared data. (SQL CF?) We have a need to have a datastore of some form that has the following properties.

 - Relocatable, local or remote systems.
 - Capable of multiple readers/writers, new queries should contain updates.
 - De-centralized, no server would be required.
 - Capable of holding at least 16 Mb of data.

SQL CF seems capable, but I'm not sure I'd understand what technologies would go into integrating such a solution as I don't really have an SQL background.",2
10505810,05/08/2012 20:13:15,1366353,04/30/2012 17:25:49,55,8,Good software to generate SQL from ER diagram?,"I am creating a database and I need to create some tables. I would like to know if there is a good software (preferably free) that generates SQL code from the ER diagram.
",sql,database,,,,05/10/2012 10:07:08,not constructive,1,33,8,"Good software to generate SQL from ER diagram? I am creating a database and I need to create some tables. I would like to know if there is a good software (preferably free) that generates SQL code from the ER diagram.
",2
9086763,01/31/2012 20:53:04,1128694,01/03/2012 20:58:56,6,0,SQL Server 2008 Installation Error,"I am having a problem installing SQL Server 2008 on a Windows Server. During the installation it comes up with an error message saying ""Attempt to perform an unauthorized operation"" with my only options to retry which displays the same message or cancel.

I am installing this as the Administrator of the computer. When I click cancel the 'Database Engine Services' and 'Full Text-Search' have both failed and 'Management Tools - Complete' and 'Management Tools - Basic' were successful.

Here is the problem in the details.txt:

 

    2012-01-31 11:48:40 Slp: PerfCounter calling lodctr: 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'
    2012-01-31 11:48:40 Slp: Prompting user if they want to retry this action due to the following failure:
    2012-01-31 11:48:40 Slp: ----------------------------------------
    2012-01-31 11:48:40 Slp: The following is an exception stack listing the exceptions in outermost to innermost order
    2012-01-31 11:48:40 Slp: Inner exceptions are being indented
    2012-01-31 11:48:40 Slp:
    2012-01-31 11:48:40 Slp: Exception type: Microsoft.SqlServer.Configuration.Sco.ScoException
    2012-01-31 11:48:40 Slp:     Message:
    2012-01-31 11:48:40 Slp:         Attempted to perform an unauthorized operation.
    2012-01-31 11:48:40 Slp:     Data:
    2012-01-31 11:48:40 Slp:       WatsonData = perf-MSSQL$FTLIVE-sqlctr10.0.1600.22.dll@OpenSQLPerformanceData@CollectSQLPerformanceData@CloseSQLPerformanceData
    2012-01-31 11:48:40 Slp:       DisableRetry = true
    2012-01-31 11:48:40 Slp:     Inner exception type: System.UnauthorizedAccessException
    2012-01-31 11:48:40 Slp:         Message:
    2012-01-31 11:48:40 Slp:                 Attempted to perform an unauthorized operation.
    2012-01-31 11:48:40 Slp:         Stack:
    2012-01-31 11:48:40 Slp:                 at Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.LoadPerformanceCounter(String symbolInstallPath, String counterPrefixServiceName)
    2012-01-31 11:48:40 Slp:                 at Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.RegisterPerformanceCounterCore(String libraryFileName, String openFunction, String collectionFunction, String closeFunction, String symbolInstallPath, String counterPrefixServiceName)
    2012-01-31 11:48:40 Slp:                 at Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.RegisterPerformanceCounter(String libraryFileName, String openFunction, String collectionFunction, String closeFunction, String symbolInstallPath, String counterPrefixServiceName)
    2012-01-31 11:48:40 Slp: ----------------------------------------
    2012-01-31 11:48:42 Slp: User has chosen to retry this action
    2012-01-31 11:48:42 Slp: PerfCounter service name: MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter original INI template file: D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\sqlctr.ini
    2012-01-31 11:48:42 Slp: PerfCounter temporary INI file that will be registered: D:\Cpompany\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini
    2012-01-31 11:48:42 Slp: PerfCounter Library file name: perf-MSSQL$FTLIVE-sqlctr10.0.1600.22.dll
    2012-01-31 11:48:42 Slp: PerfCounter Open function: OpenSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter Collect function: CollectSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter Close function: CloseSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter symbol file install path: D:\Company\MSSQL10.FTLIVE\MSSQL\Binn
    2012-01-31 11:48:42 Slp: PerfCounter counter test/help prefix: MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter unregister first before registration
    2012-01-31 11:48:42 Slp: PerfCounters will be unregistered for service name: MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter temporary INI file that will be removed: D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini
    2012-01-31 11:48:42 Slp: PerfCounter calling unlodctr: 'MSSQL$FTLIVE'
    2012-01-31 11:48:42 Slp: PerfCounter delete the temporary INI file: 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'
    2012-01-31 11:48:42 Slp: PerfCounter deleting registry key: HKLM\System\CurrentControlSet\Services\MSSQL$FTLIVE\Performance
    2012-01-31 11:48:42 Slp: PerfCounter writing to registry key: HKLM\System\CurrentControlSet\Services\MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter creating registry key: HKLM\System\CurrentControlSet\Services\MSSQL$FTLIVE\Performance
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Library = perf-MSSQL$FTLIVE-sqlctr10.0.1600.22.dll
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Open = OpenSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Collect = CollectSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Close = CloseSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter munging INI tempate: 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\sqlctr.ini' -> 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'
    2012-01-31 11:48:42 Slp: Sco: Attempting to replace string in file, source file 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\sqlctr.ini', output file 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'


This is the error:

http://social.microsoft.com/Forums/getfile/61073/
 

 

If anybody could help me resolve this issue, that would be great. I have spent all day searching on how to fix this problem with no luck.",sql,sql-server,server,,,,open,0,738,5,"SQL Server 2008 Installation Error I am having a problem installing SQL Server 2008 on a Windows Server. During the installation it comes up with an error message saying ""Attempt to perform an unauthorized operation"" with my only options to retry which displays the same message or cancel.

I am installing this as the Administrator of the computer. When I click cancel the 'Database Engine Services' and 'Full Text-Search' have both failed and 'Management Tools - Complete' and 'Management Tools - Basic' were successful.

Here is the problem in the details.txt:

 

    2012-01-31 11:48:40 Slp: PerfCounter calling lodctr: 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'
    2012-01-31 11:48:40 Slp: Prompting user if they want to retry this action due to the following failure:
    2012-01-31 11:48:40 Slp: ----------------------------------------
    2012-01-31 11:48:40 Slp: The following is an exception stack listing the exceptions in outermost to innermost order
    2012-01-31 11:48:40 Slp: Inner exceptions are being indented
    2012-01-31 11:48:40 Slp:
    2012-01-31 11:48:40 Slp: Exception type: Microsoft.SqlServer.Configuration.Sco.ScoException
    2012-01-31 11:48:40 Slp:     Message:
    2012-01-31 11:48:40 Slp:         Attempted to perform an unauthorized operation.
    2012-01-31 11:48:40 Slp:     Data:
    2012-01-31 11:48:40 Slp:       WatsonData = perf-MSSQL$FTLIVE-sqlctr10.0.1600.22.dll@OpenSQLPerformanceData@CollectSQLPerformanceData@CloseSQLPerformanceData
    2012-01-31 11:48:40 Slp:       DisableRetry = true
    2012-01-31 11:48:40 Slp:     Inner exception type: System.UnauthorizedAccessException
    2012-01-31 11:48:40 Slp:         Message:
    2012-01-31 11:48:40 Slp:                 Attempted to perform an unauthorized operation.
    2012-01-31 11:48:40 Slp:         Stack:
    2012-01-31 11:48:40 Slp:                 at Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.LoadPerformanceCounter(String symbolInstallPath, String counterPrefixServiceName)
    2012-01-31 11:48:40 Slp:                 at Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.RegisterPerformanceCounterCore(String libraryFileName, String openFunction, String collectionFunction, String closeFunction, String symbolInstallPath, String counterPrefixServiceName)
    2012-01-31 11:48:40 Slp:                 at Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.RegisterPerformanceCounter(String libraryFileName, String openFunction, String collectionFunction, String closeFunction, String symbolInstallPath, String counterPrefixServiceName)
    2012-01-31 11:48:40 Slp: ----------------------------------------
    2012-01-31 11:48:42 Slp: User has chosen to retry this action
    2012-01-31 11:48:42 Slp: PerfCounter service name: MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter original INI template file: D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\sqlctr.ini
    2012-01-31 11:48:42 Slp: PerfCounter temporary INI file that will be registered: D:\Cpompany\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini
    2012-01-31 11:48:42 Slp: PerfCounter Library file name: perf-MSSQL$FTLIVE-sqlctr10.0.1600.22.dll
    2012-01-31 11:48:42 Slp: PerfCounter Open function: OpenSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter Collect function: CollectSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter Close function: CloseSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter symbol file install path: D:\Company\MSSQL10.FTLIVE\MSSQL\Binn
    2012-01-31 11:48:42 Slp: PerfCounter counter test/help prefix: MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter unregister first before registration
    2012-01-31 11:48:42 Slp: PerfCounters will be unregistered for service name: MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter temporary INI file that will be removed: D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini
    2012-01-31 11:48:42 Slp: PerfCounter calling unlodctr: 'MSSQL$FTLIVE'
    2012-01-31 11:48:42 Slp: PerfCounter delete the temporary INI file: 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'
    2012-01-31 11:48:42 Slp: PerfCounter deleting registry key: HKLM\System\CurrentControlSet\Services\MSSQL$FTLIVE\Performance
    2012-01-31 11:48:42 Slp: PerfCounter writing to registry key: HKLM\System\CurrentControlSet\Services\MSSQL$FTLIVE
    2012-01-31 11:48:42 Slp: PerfCounter creating registry key: HKLM\System\CurrentControlSet\Services\MSSQL$FTLIVE\Performance
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Library = perf-MSSQL$FTLIVE-sqlctr10.0.1600.22.dll
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Open = OpenSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Collect = CollectSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter creating value: Close = CloseSQLPerformanceData
    2012-01-31 11:48:42 Slp: PerfCounter munging INI tempate: 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\sqlctr.ini' -> 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'
    2012-01-31 11:48:42 Slp: Sco: Attempting to replace string in file, source file 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\sqlctr.ini', output file 'D:\Company\MSSQL10.FTLIVE\MSSQL\Binn\perf-MSSQL$FTLIVEsqlctr.ini'


This is the error:

http://social.microsoft.com/Forums/getfile/61073/
 

 

If anybody could help me resolve this issue, that would be great. I have spent all day searching on how to fix this problem with no luck.",3
1787307,11/24/2009 01:55:26,217488,11/24/2009 01:45:28,1,0,Using JButtons to execute SQL queries with JDBC,"I'm writing a simple JAVA GUI to read an SQL query from a JTextFrame and execute it.  The connect and execute buttons are both JButtons, but the compiler won't compile my code because I can't append a ""throws SQLException"" to actionPerformed in my Listener private classes.  I tried writing separate methods, but the same problem still persists.  Here's an example: 

     public void connect() throws SQLException{
	    conxn = DriverManager.getConnection(URL, Username, Password);}
     private class SelectBut implements ActionListener{  
	    public void actionPerformed(ActionEvent event){connect();}}

The compiler just throws this back at me: 
 
TextFrame.java:123: unreported exception java.sql.SQLException; must be caught or declared to be thrown  
public void actionPerformed(ActionEvent event){connect();}}

Any suggestions?
",sql,jdbc,java,gui,,,open,0,125,8,"Using JButtons to execute SQL queries with JDBC I'm writing a simple JAVA GUI to read an SQL query from a JTextFrame and execute it.  The connect and execute buttons are both JButtons, but the compiler won't compile my code because I can't append a ""throws SQLException"" to actionPerformed in my Listener private classes.  I tried writing separate methods, but the same problem still persists.  Here's an example: 

     public void connect() throws SQLException{
	    conxn = DriverManager.getConnection(URL, Username, Password);}
     private class SelectBut implements ActionListener{  
	    public void actionPerformed(ActionEvent event){connect();}}

The compiler just throws this back at me: 
 
TextFrame.java:123: unreported exception java.sql.SQLException; must be caught or declared to be thrown  
public void actionPerformed(ActionEvent event){connect();}}

Any suggestions?
",4
2148005,01/27/2010 15:16:43,239241,12/27/2009 18:10:55,15,0,SQL count many-to-many values or have it counted every time new row is added?,"I have this query:

    SELECT `x`.`items`.id, `x`.`items`.name, COUNT(*) AS count
		FROM `x`.`items` INNER JOIN `x`.`user_items`
		ON `x`.`items`.id = `x`.`user_items`.item_id
		GROUP BY name HAVING count > 2 ORDER BY count DESC

I have about 36,000 users, 175,000 user_items and 60,000 items which are constantly added to. So this query is getting a bit slow...

Is it better to: 

 - Have a `count` field in `items` and update that periodically (say each time a user adds an item)
 - or run the query like this (slowly).. 

Or is there any SQL that will populate the count field for me?

Thanks",sql,count,many-to-many,,,,open,0,96,14,"SQL count many-to-many values or have it counted every time new row is added? I have this query:

    SELECT `x`.`items`.id, `x`.`items`.name, COUNT(*) AS count
		FROM `x`.`items` INNER JOIN `x`.`user_items`
		ON `x`.`items`.id = `x`.`user_items`.item_id
		GROUP BY name HAVING count > 2 ORDER BY count DESC

I have about 36,000 users, 175,000 user_items and 60,000 items which are constantly added to. So this query is getting a bit slow...

Is it better to: 

 - Have a `count` field in `items` and update that periodically (say each time a user adds an item)
 - or run the query like this (slowly).. 

Or is there any SQL that will populate the count field for me?

Thanks",3
10712968,05/23/2012 03:15:21,1411583,05/23/2012 03:06:48,1,0,Use wildcard in SQL table entry,"I have been looking around for such a solution, but no positive results so far...
My **table** consists of entries **data**, like 

 1. 1234
 2. 3241
 3. 8424
 4. 8_24
 5. 9_13

where '_' are wildcards which can be from 0-9.
I'd like to find a way to retrieve these data, like:
SELECT * from table WHERE data LIKE '8424', the query should return both 8424 and 8_24.

Thank you in advance! ",sql,sql-server-2008,visual-studio-2008,wildcard,,,open,0,69,6,"Use wildcard in SQL table entry I have been looking around for such a solution, but no positive results so far...
My **table** consists of entries **data**, like 

 1. 1234
 2. 3241
 3. 8424
 4. 8_24
 5. 9_13

where '_' are wildcards which can be from 0-9.
I'd like to find a way to retrieve these data, like:
SELECT * from table WHERE data LIKE '8424', the query should return both 8424 and 8_24.

Thank you in advance! ",4
8276178,11/26/2011 04:04:40,734984,05/02/2011 19:19:06,1438,30,Are subqueries not recommended?,"This questions comes after a friend afirmattion. He said that when a query have a lot of subqueries it's a signal that the database have desing flaws and they must be avoided. He said too that many books affirmates the same.

I agree in parts, but I think that are queries that have complex logic that a lot of subqueries are needed or to avoid the subqueries, a materialized view of a query or a lot of data redundancy.

So, what is the truth about subqueries? They must be always avoided? No problems with they? They indicate database desing flaws. It's possible have a database design that is possible do complex queries without having data redundancy?


",sql,subquery,,,,,open,0,114,4,"Are subqueries not recommended? This questions comes after a friend afirmattion. He said that when a query have a lot of subqueries it's a signal that the database have desing flaws and they must be avoided. He said too that many books affirmates the same.

I agree in parts, but I think that are queries that have complex logic that a lot of subqueries are needed or to avoid the subqueries, a materialized view of a query or a lot of data redundancy.

So, what is the truth about subqueries? They must be always avoided? No problems with they? They indicate database desing flaws. It's possible have a database design that is possible do complex queries without having data redundancy?


",2
7791634,10/17/2011 09:14:30,440659,09/06/2010 13:06:28,1,0,list of cities name in arabic and english," I am looking for a list of cities by country (the countries I mean here are all countries that exist on planet Earth) i want to show the English and Arabic names of the country and s
city. Is there any open-source SQL database available online which I can download and use, Excel file I Can use?",sql,,,,,10/17/2011 17:57:08,off topic,1,57,8,"list of cities name in arabic and english  I am looking for a list of cities by country (the countries I mean here are all countries that exist on planet Earth) i want to show the English and Arabic names of the country and s
city. Is there any open-source SQL database available online which I can download and use, Excel file I Can use?",1
2423422,03/11/2010 08:11:50,117647,06/04/2009 21:05:58,190,25,Find the most recent shipment for a product (sql subselect?),"I have three tables

    shipment (shipment_id, shipping_date)
    company_order (company_order_id, shipment_id)
    company_order_item (company_order_item_id, company_order_id, product_id)

Several companies get together and aggregate orders from a single manufacturer. This aggregate order is called a ""shipment"". 

How do I write an SQL query find the most recent shipment for each product_id ?

I've looked at
http://stackoverflow.com/questions/1792922/sql-query-get-most-recent-revision (much simpler case). 



",sql,subselect,mysql,,,,open,0,62,10,"Find the most recent shipment for a product (sql subselect?) I have three tables

    shipment (shipment_id, shipping_date)
    company_order (company_order_id, shipment_id)
    company_order_item (company_order_item_id, company_order_id, product_id)

Several companies get together and aggregate orders from a single manufacturer. This aggregate order is called a ""shipment"". 

How do I write an SQL query find the most recent shipment for each product_id ?

I've looked at
http://stackoverflow.com/questions/1792922/sql-query-get-most-recent-revision (much simpler case). 



",3
8587399,12/21/2011 09:15:01,226816,12/08/2009 02:18:15,7,0,SQL's store procedure,"    Select @vCtlPeriod = period from ctl
    IF @vCtlPeriod = @Period 
        Begin 
    	SET @vHdr = 'StkHdr'
    	SET @vDtl = 'StkDtl' 
        End 
    ELSE 
        Begin 
    	SET @vHdr = 'HStkHdr'
    	SET @vDtl = 'HStkDtl' 
        End 
    
    SELECt A.*, B.* from @vHDr A Join @vHdtl B ON A.Slipno = B.Slipno 

Above is some of my code in my store procedure, i intent to check the current period from the ctl file, if the period is current period then i will get from current transaction table or else it will be retrieve from history transaction table. 

But i failed at the last select statement. Can we predefined the table name in the variable? 

",sql,,,,,,open,0,172,3,"SQL's store procedure     Select @vCtlPeriod = period from ctl
    IF @vCtlPeriod = @Period 
        Begin 
    	SET @vHdr = 'StkHdr'
    	SET @vDtl = 'StkDtl' 
        End 
    ELSE 
        Begin 
    	SET @vHdr = 'HStkHdr'
    	SET @vDtl = 'HStkDtl' 
        End 
    
    SELECt A.*, B.* from @vHDr A Join @vHdtl B ON A.Slipno = B.Slipno 

Above is some of my code in my store procedure, i intent to check the current period from the ctl file, if the period is current period then i will get from current transaction table or else it will be retrieve from history transaction table. 

But i failed at the last select statement. Can we predefined the table name in the variable? 

",1
4629684,01/07/2011 19:55:42,79,08/01/2008 16:05:09,1148,32,Filtering on a left join in SQLalchemy,"Using SQLalchemy I want to perform a left outer join and **filter out rows that DO have a match in the joined table**.

I'm sending push notifications, so I have a `Notification` table. This means I also have a `ExpiredDeviceId` table to store device_ids that are no longer valid. (I don't want to just delete the affected notifications as the user might later re-install the app, at which point the notifications should resume according to Apple's docs.)

    CREATE TABLE Notification (device_id TEXT, time DATETIME);
    CREATE TABLE ExpiredDeviceId (device_id TEXT PRIMARY KEY, expiration_time DATETIME);

_Note: there may be multiple Notifications per device\_id. There is no ""Device"" table for each device._

So when doing `SELECT FROM Notification` I should filter accordingly. I can do it in SQL:

    SELECT * FROM Notification 
        LEFT OUTER JOIN ExpiredDeviceId 
        ON Notification.device_id = ExpiredDeviceId.device_id
    WHERE expiration_time == NULL

But how can I do it in SQLalchemy?

    sess.query(
        Notification, 
        ExpiredDeviceId
    ).outerjoin(
        (ExpiredDeviceId, Notification.device_id == ExpiredDeviceId.device_id)
    ).filter(
        ???
    )

Alternately I could do this with a `device_id NOT IN (SELECT device_id FROM ExpiredDeviceId)` clause, but that seems way less efficient.",sql,join,sqlalchemy,,,,open,0,245,7,"Filtering on a left join in SQLalchemy Using SQLalchemy I want to perform a left outer join and **filter out rows that DO have a match in the joined table**.

I'm sending push notifications, so I have a `Notification` table. This means I also have a `ExpiredDeviceId` table to store device_ids that are no longer valid. (I don't want to just delete the affected notifications as the user might later re-install the app, at which point the notifications should resume according to Apple's docs.)

    CREATE TABLE Notification (device_id TEXT, time DATETIME);
    CREATE TABLE ExpiredDeviceId (device_id TEXT PRIMARY KEY, expiration_time DATETIME);

_Note: there may be multiple Notifications per device\_id. There is no ""Device"" table for each device._

So when doing `SELECT FROM Notification` I should filter accordingly. I can do it in SQL:

    SELECT * FROM Notification 
        LEFT OUTER JOIN ExpiredDeviceId 
        ON Notification.device_id = ExpiredDeviceId.device_id
    WHERE expiration_time == NULL

But how can I do it in SQLalchemy?

    sess.query(
        Notification, 
        ExpiredDeviceId
    ).outerjoin(
        (ExpiredDeviceId, Notification.device_id == ExpiredDeviceId.device_id)
    ).filter(
        ???
    )

Alternately I could do this with a `device_id NOT IN (SELECT device_id FROM ExpiredDeviceId)` clause, but that seems way less efficient.",3
3888439,10/08/2010 07:21:52,430803,08/25/2010 14:30:08,372,5,how to write sqlquery for aggregate total value for a particular condition.,"        vote table					
       PK_ID ob_type	ob_id	VOTE 	user_id	VOTED_ON
        1	100	1	1	NISHANT	02/08/10
        2	100	1	1	DEVI	02/08/10
        3	100	1	1	VIRENDRA02/08/10
        4	100	1	0	XYZ	02/08/10
        5	200	1	1	XCXCX	02/08/10
        6	200	1	1	CXC	03/02/11
        7	200	1	0	XCCX	03/02/11
        8	200	1	0	XCCX	03/02/11
        9	300	1	1	XCCXXC	03/02/11
        10	300	1	1	XCCX	03/02/11
        11	300	1	1	SD	02/08/10
        12	300	1	0	XCCXXCC 02/08/10
        13	400	1	0	CXXCXC	02/08/10
        14	400	1	0	XCCX	03/02/11
        15	400	1	0	CXC	03/02/11
        16	400	1	1	CXC	03/02/11

here i want to calculate total no of vote on a particular object type and id.

      SELECT 
                                        COUNT (ALL  [PK_ID]) AS [TOTAL_VOTE],
                                        COALESCE (
                                                  ( SELECT 
                                                      [IS_THUMBS_UP]
                                                    FROM
                                                     [votetable]
                                                    WHERE
                                                      [ob_type] = 100 AND
                                                      [ob_id] = 4 AND
                                                      [FK_VOTED_BY] = Nishant ),-1) AS [MY_VOTING]  
                                     FROM  
                                        [votetable]
                                     WHERE
                                        [ob_type] = 100 AND
                                        [ob_id]  = 4 

here it give result 
total vote = 5
and my vote = 0

but here total voting is -2 (bcz 3 false(0) and 1 true)
so how i gate that value.

",sql,,,,,,open,0,924,12,"how to write sqlquery for aggregate total value for a particular condition.         vote table					
       PK_ID ob_type	ob_id	VOTE 	user_id	VOTED_ON
        1	100	1	1	NISHANT	02/08/10
        2	100	1	1	DEVI	02/08/10
        3	100	1	1	VIRENDRA02/08/10
        4	100	1	0	XYZ	02/08/10
        5	200	1	1	XCXCX	02/08/10
        6	200	1	1	CXC	03/02/11
        7	200	1	0	XCCX	03/02/11
        8	200	1	0	XCCX	03/02/11
        9	300	1	1	XCCXXC	03/02/11
        10	300	1	1	XCCX	03/02/11
        11	300	1	1	SD	02/08/10
        12	300	1	0	XCCXXCC 02/08/10
        13	400	1	0	CXXCXC	02/08/10
        14	400	1	0	XCCX	03/02/11
        15	400	1	0	CXC	03/02/11
        16	400	1	1	CXC	03/02/11

here i want to calculate total no of vote on a particular object type and id.

      SELECT 
                                        COUNT (ALL  [PK_ID]) AS [TOTAL_VOTE],
                                        COALESCE (
                                                  ( SELECT 
                                                      [IS_THUMBS_UP]
                                                    FROM
                                                     [votetable]
                                                    WHERE
                                                      [ob_type] = 100 AND
                                                      [ob_id] = 4 AND
                                                      [FK_VOTED_BY] = Nishant ),-1) AS [MY_VOTING]  
                                     FROM  
                                        [votetable]
                                     WHERE
                                        [ob_type] = 100 AND
                                        [ob_id]  = 4 

here it give result 
total vote = 5
and my vote = 0

but here total voting is -2 (bcz 3 false(0) and 1 true)
so how i gate that value.

",1
11591583,07/21/2012 11:00:25,1542565,07/21/2012 10:58:01,1,0,how to join Sql queries?,"I have these Data:-
 
----------------------- 1 ---------------------------------------------------------
 
select Com.CountryName+', '+Cm.CityName+', '+Fac.FacilityName+', '+FM.FloorCode as Details
 
from MC_MeetingRoom_Master MR join MC_Floor_Master FM on MR.FloorID=FM.FloorID AND FM.IsActive=1
 
JOIN MC_Building_Master BM on BM.BuildingID=FM.BuildingID AND BM.IsActive=1
 
JOIN MC_Facility_Master Fac on BM.FacilityID=Fac.FacilityID and Fac.IsActive=1
 
join MC_City_Master Cm on Fac.CityID = Cm.CityID and Cm.IsActive=1
 
join MC_Country_Master Com on Cm.CountryID=Com.CountryID and Com.IsActive=1
 
WHERE MeetingRoomID=1000
 

The above query shows:-
 
India, Chennai, CHN - DLF Infocity - SEZ, 3rd Floor
 
-------------------------- 2 -------------------------------------------------------------
 

Another table where 
 
select [MeetingRoomID],[Capacity],[MeetingRoomVNET], CASE WHEN [HasProjector] =0 then 'No' ELSE 'Yes' END [HasProjector],CASE WHEN [HasLan]=0 then 'No' ELSE 'Yes' END [HasLan],CASE WHEN [HasComputer]=0 then 'No' ELSE 'Yes' END [HasComputer],CASE WHEN [HasWhiteBoard]=0 then 'No' ELSE 'Yes' END [HasWhiteBoard],[MeetingRoomAdminMail]
 
from MC_MeetingRoom_Master where [MeetingRoomID]=1023
 
The above query shows columns:-
 
1023 25 0 No No No No Admin.Helpdesk@cognizant.com
 
-------------------------------------------------------------------------------------------
 
But i wanted to join both the queries...??
 
Do i need to create stored procedures..??
 
",sql,,,,,,open,0,147,5,"how to join Sql queries? I have these Data:-
 
----------------------- 1 ---------------------------------------------------------
 
select Com.CountryName+', '+Cm.CityName+', '+Fac.FacilityName+', '+FM.FloorCode as Details
 
from MC_MeetingRoom_Master MR join MC_Floor_Master FM on MR.FloorID=FM.FloorID AND FM.IsActive=1
 
JOIN MC_Building_Master BM on BM.BuildingID=FM.BuildingID AND BM.IsActive=1
 
JOIN MC_Facility_Master Fac on BM.FacilityID=Fac.FacilityID and Fac.IsActive=1
 
join MC_City_Master Cm on Fac.CityID = Cm.CityID and Cm.IsActive=1
 
join MC_Country_Master Com on Cm.CountryID=Com.CountryID and Com.IsActive=1
 
WHERE MeetingRoomID=1000
 

The above query shows:-
 
India, Chennai, CHN - DLF Infocity - SEZ, 3rd Floor
 
-------------------------- 2 -------------------------------------------------------------
 

Another table where 
 
select [MeetingRoomID],[Capacity],[MeetingRoomVNET], CASE WHEN [HasProjector] =0 then 'No' ELSE 'Yes' END [HasProjector],CASE WHEN [HasLan]=0 then 'No' ELSE 'Yes' END [HasLan],CASE WHEN [HasComputer]=0 then 'No' ELSE 'Yes' END [HasComputer],CASE WHEN [HasWhiteBoard]=0 then 'No' ELSE 'Yes' END [HasWhiteBoard],[MeetingRoomAdminMail]
 
from MC_MeetingRoom_Master where [MeetingRoomID]=1023
 
The above query shows columns:-
 
1023 25 0 No No No No Admin.Helpdesk@cognizant.com
 
-------------------------------------------------------------------------------------------
 
But i wanted to join both the queries...??
 
Do i need to create stored procedures..??
 
",1
7391090,09/12/2011 16:35:07,63392,02/06/2009 16:32:16,762,18,Insert data and set foreign keys with Postgres,"I have to migrate a large amount of existing data in a Postgres DB after a schema change.

In the old schema a country attribute would be stored in the users table. Now the country attribute has been moved into a separate address table:

    users:
      country # OLD
      address_id # NEW

    addresses:
      id
      country

When migrating the data, I'm having problems setting the foreign keys in the users table after inserting the addresses:

    INSERT INTO addresses (country) 
        SELECT country FROM users WHERE address_id IS NULL 
        RETURNING id;
   
**How do I propagate the IDs of the inserted rows and set the foreign key references in the users table?**

The only solution I could come up with so far is creating a temporary user_id column in the addresses table and then updating the the address_id:
  
    UPDATE users SET address_id = a.id FROM addresses AS a 
        WHERE users.id = a.user_id;

However, this turned out to be extremely slow (despite using indices on both users.id and addresses.user_id).

**Is there any other way to insert derived data into one table and setting the foreign key reference to the inserted data in the other (without changing the schema itself)?**

I'm using Postgres 8.3.14.

Thanks",sql,postgresql,data-migration,,,,open,0,251,8,"Insert data and set foreign keys with Postgres I have to migrate a large amount of existing data in a Postgres DB after a schema change.

In the old schema a country attribute would be stored in the users table. Now the country attribute has been moved into a separate address table:

    users:
      country # OLD
      address_id # NEW

    addresses:
      id
      country

When migrating the data, I'm having problems setting the foreign keys in the users table after inserting the addresses:

    INSERT INTO addresses (country) 
        SELECT country FROM users WHERE address_id IS NULL 
        RETURNING id;
   
**How do I propagate the IDs of the inserted rows and set the foreign key references in the users table?**

The only solution I could come up with so far is creating a temporary user_id column in the addresses table and then updating the the address_id:
  
    UPDATE users SET address_id = a.id FROM addresses AS a 
        WHERE users.id = a.user_id;

However, this turned out to be extremely slow (despite using indices on both users.id and addresses.user_id).

**Is there any other way to insert derived data into one table and setting the foreign key reference to the inserted data in the other (without changing the schema itself)?**

I'm using Postgres 8.3.14.

Thanks",3
7316091,09/06/2011 07:05:00,321862,04/21/2010 01:56:16,2005,94,How can i replace out IS NULL from an SQL statement?,"`IS [NOT] NULL` meddles with the indexes of SQL statements in Oracle, is there any way i replace `IS NULL` in an SQL statement?",sql,oracle,,,,09/06/2011 12:03:01,not a real question,1,24,11,"How can i replace out IS NULL from an SQL statement? `IS [NOT] NULL` meddles with the indexes of SQL statements in Oracle, is there any way i replace `IS NULL` in an SQL statement?",2
7720812,10/11/2011 02:31:06,119959,06/09/2009 16:16:19,1027,41,How To Pick a Database?,"In this day and age, with a new NoSQL databases popping up every weekend..

Are there any good and up-to-date resources on how to pick a database(s) that will suit your web application needs?",sql,database,web-applications,nosql,,10/11/2011 02:54:58,not constructive,1,33,5,"How To Pick a Database? In this day and age, with a new NoSQL databases popping up every weekend..

Are there any good and up-to-date resources on how to pick a database(s) that will suit your web application needs?",4
3807766,09/27/2010 20:52:06,347849,05/22/2010 15:00:03,347,28,SQL Query Assistance,"This is not a homework question, just something at work that's bugging me.

I'm trying to write a query against these tables below.  The two tables, history and code are joined to the historyassignment table by the historyid and codeid columns.  

	Table: HistoryAssignment

	| AssignmentID | HistoryID | CodeID |
	|--------------|-----------|--------|
	| 1            | 100       | 200    |
	|--------------|-----------|--------|
	| 2            | 101       | 201    |
	|--------------|-----------|--------|
	| 3            | 102       | 202    |
	|--------------|-----------|--------|
	 
	Table: Code 

	| CodeID | Desc |
	|--------|------|
	| 200    | ABC  |
	|--------|------|
	| 201    | DEF  |
	|--------|------|
	| 202    | GHI  |
	|--------|------|

	Table: History

	| HistoryID | Desc | HistDate |
	|-----------|------|----------|
	| 100       | JKL  | 5/1/2010 |
	|-----------|------|----------|
	| 101       | MNO  | 7/1/2009 |
	|-----------|------|----------|
	| 102       | PQR  | 7/9/2010 |
	|-----------|------|----------|
	| 103       | STU  | 6/2/2010 |
	|-----------|------|----------|
	| 104       | VWX  | 5/7/2010 |
	|-----------|------|----------|
	| 105       | YZ   | 2/5/2010 |
	|-----------|------|----------|

My goal is to get a count of total number of history IDs that are mapped in the historyassigment table and the total number of history IDs there are in the history table.  The results should be grouped the month and year of the histdate column in the history table.  Like below.  

	Year	Month	Total	Mapped
	2009	7	1	1
	2010	2	1	0
	2010	5	2	1
	2010	6	1	0
	2010	7	1	1

Any assistance would be greatly appreciated.",sql,sql-server-2005,stored-procedures,,,,open,0,305,3,"SQL Query Assistance This is not a homework question, just something at work that's bugging me.

I'm trying to write a query against these tables below.  The two tables, history and code are joined to the historyassignment table by the historyid and codeid columns.  

	Table: HistoryAssignment

	| AssignmentID | HistoryID | CodeID |
	|--------------|-----------|--------|
	| 1            | 100       | 200    |
	|--------------|-----------|--------|
	| 2            | 101       | 201    |
	|--------------|-----------|--------|
	| 3            | 102       | 202    |
	|--------------|-----------|--------|
	 
	Table: Code 

	| CodeID | Desc |
	|--------|------|
	| 200    | ABC  |
	|--------|------|
	| 201    | DEF  |
	|--------|------|
	| 202    | GHI  |
	|--------|------|

	Table: History

	| HistoryID | Desc | HistDate |
	|-----------|------|----------|
	| 100       | JKL  | 5/1/2010 |
	|-----------|------|----------|
	| 101       | MNO  | 7/1/2009 |
	|-----------|------|----------|
	| 102       | PQR  | 7/9/2010 |
	|-----------|------|----------|
	| 103       | STU  | 6/2/2010 |
	|-----------|------|----------|
	| 104       | VWX  | 5/7/2010 |
	|-----------|------|----------|
	| 105       | YZ   | 2/5/2010 |
	|-----------|------|----------|

My goal is to get a count of total number of history IDs that are mapped in the historyassigment table and the total number of history IDs there are in the history table.  The results should be grouped the month and year of the histdate column in the history table.  Like below.  

	Year	Month	Total	Mapped
	2009	7	1	1
	2010	2	1	0
	2010	5	2	1
	2010	6	1	0
	2010	7	1	1

Any assistance would be greatly appreciated.",3
4142984,11/10/2010 09:33:46,502844,11/10/2010 06:36:13,15,0,Using a Type I Nested Query for a Difference Problem,"Ok so I'm working on my homework and am having trouble figuring out the correct syntax for the ""NOT IN"" functionality.

The database is a small insurance database (carriers, members, employers, plans) made up for this assignment.

I am supposed to figure out ""Which Plans do not have any Member subscriptions?  List the PlanID, the plnDescription and plnCost.  (Hint: use the nested Select statement with a NOT IN clause.)""

This is what I have written as of right now:

    SELECT planid, plndescription, plncost
    FROM plans
    WHERE planid NOT IN
    (SELECT memberno FROM members);

And when I run that query, I get a 0 rows selected response.

When I take out the WHERE statement, I get the following response:

    PLANID                 PLNDESCRIPTION                      PLNCOST                
    ---------------------- ----------------------------------- ---------------------- 
    1                      Single Basic Medical                72.5                   
    2                      2-Party Basic Medical               140                    
    3                      Family Basic Medical                225                    
    4                      Single SuperMed                     110                    
    5                      2-Party SuperMed                    200                    
    6                      Family SuperMed                     350                    
    7                      Single Dental Only                  35                     
    8                      Family Dental Only                  70                     
    9                      Life Only                           16.5                   
    10                     Single SuperMed with Dental         125                    
    11                     2-Party SuperMed with Dental        240                    
    12                     Family SuperMed with Dental         425                    
    
    12 rows selected

I'm sure my error is in the WHERE statement because I'm sure I'm using the wrong field names in the WHERE statement as well as the second SELECT statement. Any help is very much appreciated.


",sql,oracle,,,,,open,0,1007,10,"Using a Type I Nested Query for a Difference Problem Ok so I'm working on my homework and am having trouble figuring out the correct syntax for the ""NOT IN"" functionality.

The database is a small insurance database (carriers, members, employers, plans) made up for this assignment.

I am supposed to figure out ""Which Plans do not have any Member subscriptions?  List the PlanID, the plnDescription and plnCost.  (Hint: use the nested Select statement with a NOT IN clause.)""

This is what I have written as of right now:

    SELECT planid, plndescription, plncost
    FROM plans
    WHERE planid NOT IN
    (SELECT memberno FROM members);

And when I run that query, I get a 0 rows selected response.

When I take out the WHERE statement, I get the following response:

    PLANID                 PLNDESCRIPTION                      PLNCOST                
    ---------------------- ----------------------------------- ---------------------- 
    1                      Single Basic Medical                72.5                   
    2                      2-Party Basic Medical               140                    
    3                      Family Basic Medical                225                    
    4                      Single SuperMed                     110                    
    5                      2-Party SuperMed                    200                    
    6                      Family SuperMed                     350                    
    7                      Single Dental Only                  35                     
    8                      Family Dental Only                  70                     
    9                      Life Only                           16.5                   
    10                     Single SuperMed with Dental         125                    
    11                     2-Party SuperMed with Dental        240                    
    12                     Family SuperMed with Dental         425                    
    
    12 rows selected

I'm sure my error is in the WHERE statement because I'm sure I'm using the wrong field names in the WHERE statement as well as the second SELECT statement. Any help is very much appreciated.


",2
2602638,04/08/2010 19:01:15,158958,08/19/2009 03:48:55,230,9,Microsoft SQL Count problem,"Hey smarties. I'm having trouble with the following SQL statement. I know that I can't do a GROUP BY on the OnlineStatus column, and it makes sense because it's a function call, not an actual column in my table. How would I modify this so that I can get a count of how many users are online?

    SELECT	CASE dbo.fnGetWebUserOnlineStatus(W.Id) 
				WHEN 1 THEN 'Online' 
				WHEN 2 THEN 'Ingame' 
				ELSE 'Offline' 
			END AS OnlineStatus
			
			FROM dbo.WebUsers W
			
			WHERE W.[Status]=1
			
			GROUP BY OnlineStatus",sql,count,microsoft-sql-server,,,,open,0,80,4,"Microsoft SQL Count problem Hey smarties. I'm having trouble with the following SQL statement. I know that I can't do a GROUP BY on the OnlineStatus column, and it makes sense because it's a function call, not an actual column in my table. How would I modify this so that I can get a count of how many users are online?

    SELECT	CASE dbo.fnGetWebUserOnlineStatus(W.Id) 
				WHEN 1 THEN 'Online' 
				WHEN 2 THEN 'Ingame' 
				ELSE 'Offline' 
			END AS OnlineStatus
			
			FROM dbo.WebUsers W
			
			WHERE W.[Status]=1
			
			GROUP BY OnlineStatus",3
9758008,03/18/2012 11:43:16,522257,11/27/2010 13:14:49,22,4,Microsoft SQL Select query,"I have a column in a ms Sql table that has the following records:
MyColumn : C1_xxx1,C2_xxx1,C3_xxx1,C1_xxx2,C1_xxx3,C3_xxx2  etc
It is a text column that containt strings that have the following format: ""CY_mystring"" where Y is a number from 1 to 5 ,followed by the'_' character then 'mystring' that can have any value.

Is there a way to make a select return this column ordered as following:
C1_xxx1
C1_xxx2
C1_xxx3
......
C1_xxxn
C2_xxx1
......
C2_xxxn
C3_xxx1
.......
C3_xxxn
etc

Ordered by the CY_ substring.

thank you
",sql,sql-server,ms,,,,open,0,69,4,"Microsoft SQL Select query I have a column in a ms Sql table that has the following records:
MyColumn : C1_xxx1,C2_xxx1,C3_xxx1,C1_xxx2,C1_xxx3,C3_xxx2  etc
It is a text column that containt strings that have the following format: ""CY_mystring"" where Y is a number from 1 to 5 ,followed by the'_' character then 'mystring' that can have any value.

Is there a way to make a select return this column ordered as following:
C1_xxx1
C1_xxx2
C1_xxx3
......
C1_xxxn
C2_xxx1
......
C2_xxxn
C3_xxx1
.......
C3_xxxn
etc

Ordered by the CY_ substring.

thank you
",3
5779763,04/25/2011 15:07:23,583123,01/20/2011 14:49:55,49,0,How to do Normalization?,Hi i am new to this concept and i need your suggestion. i have an excel spreadsheet having about 35 columns and i have to create tables out of it. i have to draw an ER diagram but i dont know which should be the main table having foreign keys of all other tables or is there going to be one main table or multiple main tables?,sql,database-design,,,,04/25/2011 15:49:41,not a real question,1,67,4,How to do Normalization? Hi i am new to this concept and i need your suggestion. i have an excel spreadsheet having about 35 columns and i have to create tables out of it. i have to draw an ER diagram but i dont know which should be the main table having foreign keys of all other tables or is there going to be one main table or multiple main tables?,2
9174677,02/07/2012 10:34:12,1194397,02/07/2012 10:28:13,1,0,Which database?,"I'm a java developer, currently starting developing a hospital management system that will server patients, doctors, accountant, .... etc the system is really huge that may have 900,000 records/day, data is really growing so fast, for that i'm confusing in which database to use since i have the following options: (Percona Server(Mysql), Oracle, SQLServer), since the application will run on network with average of 45 online users.

I hope to find a good answers here.

Thanks in advance",sql,database,oracle,percona,,02/07/2012 11:00:12,not constructive,1,76,2,"Which database? I'm a java developer, currently starting developing a hospital management system that will server patients, doctors, accountant, .... etc the system is really huge that may have 900,000 records/day, data is really growing so fast, for that i'm confusing in which database to use since i have the following options: (Percona Server(Mysql), Oracle, SQLServer), since the application will run on network with average of 45 online users.

I hope to find a good answers here.

Thanks in advance",4
4410996,12/10/2010 16:28:36,538072,12/10/2010 16:17:07,1,0,Grouping multiple columns with aggrgation and sum sql sever,"I want to create a table with 3 fields, EmpName, Request and AvgScore where 
EMPname is the concatenation of the name and surname, request is the number of requests the employee has been given and the AVGScore is their average score of the requests.
The following code snippet, does that for me.


SELECT     [Employee].surname + ', ' + [Employee].name AS EmpName, COUNT(DISTINCT [Request].ID) AS RequestNo, 
                      AVG([Answer]) / 4 AS AvgScore


FROM ..... (I haven't listed the joins and tables because it is too long winded)


GROUP BY [Ocean.Employee].surname + ', ' + [Ocean.Employee].name

My problem lies with the grouping of the table: 
I want to be able to group the table further, in which EMPName is descending, Request ASc and AvG descending and am unsure of how to present this in SQL Server.

I hope someone may be able to give me some assistance.

Thanks",sql,server,,,,,open,0,164,9,"Grouping multiple columns with aggrgation and sum sql sever I want to create a table with 3 fields, EmpName, Request and AvgScore where 
EMPname is the concatenation of the name and surname, request is the number of requests the employee has been given and the AVGScore is their average score of the requests.
The following code snippet, does that for me.


SELECT     [Employee].surname + ', ' + [Employee].name AS EmpName, COUNT(DISTINCT [Request].ID) AS RequestNo, 
                      AVG([Answer]) / 4 AS AvgScore


FROM ..... (I haven't listed the joins and tables because it is too long winded)


GROUP BY [Ocean.Employee].surname + ', ' + [Ocean.Employee].name

My problem lies with the grouping of the table: 
I want to be able to group the table further, in which EMPName is descending, Request ASc and AvG descending and am unsure of how to present this in SQL Server.

I hope someone may be able to give me some assistance.

Thanks",2
4749695,01/20/2011 16:24:59,422891,06/07/2010 22:07:37,65,1,Distinct Join Rails,"Video has many Events

I am trying to get all Videos that have Events scheduled in the future.

I have this which was already there:

    named_scope :scheduled_in_future, :joins => :event, :conditions => [""event.scheduled_start > ? AND event.status = ?"", Time.now.to_i, 'PENDING']

This works, but if the same Video has multiple events in the future it will give me duplicate Video records. Sure I can go through the array and weed out the duplicates, but there has to be a SQL way to do it. 

I tried adding in a

    :select => ""DISTINCT(video.id)""

but it only returns the ID field instead of the whole record.",sql,ruby-on-rails,ruby,activerecord,,,open,0,106,3,"Distinct Join Rails Video has many Events

I am trying to get all Videos that have Events scheduled in the future.

I have this which was already there:

    named_scope :scheduled_in_future, :joins => :event, :conditions => [""event.scheduled_start > ? AND event.status = ?"", Time.now.to_i, 'PENDING']

This works, but if the same Video has multiple events in the future it will give me duplicate Video records. Sure I can go through the array and weed out the duplicates, but there has to be a SQL way to do it. 

I tried adding in a

    :select => ""DISTINCT(video.id)""

but it only returns the ID field instead of the whole record.",4
10954445,06/08/2012 18:47:42,1046416,02/01/2011 15:48:40,8,1,SQL query not returning expected results - one column contains all null values,"I would expect this to return results where the column called flag called either an R, a C, or an N, but this column is null for every record.  Same thing with date added.  What am I missing here?        

    delete from wrkcompare;
    LOAD DATA LOCAL INFILE 'C:/PhoneCompares/TravelCruises/7.csv'
    INTO TABLE agnc.wrkcompare
    FIELDS TERMINATED BY ''
    LINES TERMINATED BY '\n'
    (phone);

    update wrkcompare as w 
    join consumersphone as c on w.phone = c.resphone
    set w.flag = 'R', w.dateadded = c.dateadded;

    update wrkcompare as w 
    join mocell as c on w.phone = c.cellphone
    set w.flag = 'C', w.dateadded = c.dateadded;

    update wrkcompare as w 
    join nomatch as n on w.phone = n.phone
    set w.flag = 'N', w.dateadded = n.dateadded;


",sql,,,,,06/08/2012 19:22:07,not a real question,1,174,13,"SQL query not returning expected results - one column contains all null values I would expect this to return results where the column called flag called either an R, a C, or an N, but this column is null for every record.  Same thing with date added.  What am I missing here?        

    delete from wrkcompare;
    LOAD DATA LOCAL INFILE 'C:/PhoneCompares/TravelCruises/7.csv'
    INTO TABLE agnc.wrkcompare
    FIELDS TERMINATED BY ''
    LINES TERMINATED BY '\n'
    (phone);

    update wrkcompare as w 
    join consumersphone as c on w.phone = c.resphone
    set w.flag = 'R', w.dateadded = c.dateadded;

    update wrkcompare as w 
    join mocell as c on w.phone = c.cellphone
    set w.flag = 'C', w.dateadded = c.dateadded;

    update wrkcompare as w 
    join nomatch as n on w.phone = n.phone
    set w.flag = 'N', w.dateadded = n.dateadded;


",1
4990454,02/14/2011 09:16:11,527892,12/02/2010 11:36:51,573,31,Bulk change all entries for a particular field in SQL database,"Let's just say I have a table called `TABLE_NAME` that looks like this:

    id  | name  | changeme
    ------------------------
    1   | One   | 1
    2   | Two   | 0
    3   | Three | 1
    4   | Four  | 0
    5   | Five  | 0

Is there an SQL statement I can run on this to change every `changeme` entry to '0'?",sql,mysql,,,,,open,0,99,11,"Bulk change all entries for a particular field in SQL database Let's just say I have a table called `TABLE_NAME` that looks like this:

    id  | name  | changeme
    ------------------------
    1   | One   | 1
    2   | Two   | 0
    3   | Three | 1
    4   | Four  | 0
    5   | Five  | 0

Is there an SQL statement I can run on this to change every `changeme` entry to '0'?",2
11635972,07/24/2012 17:15:41,1516286,07/10/2012 23:58:26,14,1,"SQL, Django (models.py) - suggestion, opinion","First of all I want to say that I'm complete beginner in SQL. And that's why i'm here =)

I'm doing tables for my website. And before I actually start typing code, I decided to kinda create a template of how it's going to be. Because change it after would take me a lot of time (already had this problem).  And just want to know your opinion, what would you change in order to make it more professional/efficient. 

that's how my tables should relate to each other:
Words in the middle are the Tables Names (Subjects, SubjectContent.... )



    			Subjects

    
    User = ForeignKey(User)
    Class = CharField
    ID = pk
    
    			SubjectContent

    Class = ForeignKey(Subject)
    Homework = ForeignKey(HomeworkContent)
    Class Papers = ForeignKey(ClassPapers)
    Random Papers = ForeignKey(RandomPapers)
    
    
    			FileDescription 
    			*Abstract Class


    Class = ForeignKey(Subject)
    FileLcation = URLField
    FileName = CharField
    FileDescription = TextField
    FileCreationTime = DateField
    
    	class Meta:
    		abstract = True;
    		ordering = ['FileCreationTime']
    
    
    			HomeworkContent (FileDescription)
    
    
    			ClassPapers (FileDescription)
    
    
    			RandomPapers (FileDescription)

",sql,django,django-models,,,07/25/2012 02:50:59,not constructive,1,265,6,"SQL, Django (models.py) - suggestion, opinion First of all I want to say that I'm complete beginner in SQL. And that's why i'm here =)

I'm doing tables for my website. And before I actually start typing code, I decided to kinda create a template of how it's going to be. Because change it after would take me a lot of time (already had this problem).  And just want to know your opinion, what would you change in order to make it more professional/efficient. 

that's how my tables should relate to each other:
Words in the middle are the Tables Names (Subjects, SubjectContent.... )



    			Subjects

    
    User = ForeignKey(User)
    Class = CharField
    ID = pk
    
    			SubjectContent

    Class = ForeignKey(Subject)
    Homework = ForeignKey(HomeworkContent)
    Class Papers = ForeignKey(ClassPapers)
    Random Papers = ForeignKey(RandomPapers)
    
    
    			FileDescription 
    			*Abstract Class


    Class = ForeignKey(Subject)
    FileLcation = URLField
    FileName = CharField
    FileDescription = TextField
    FileCreationTime = DateField
    
    	class Meta:
    		abstract = True;
    		ordering = ['FileCreationTime']
    
    
    			HomeworkContent (FileDescription)
    
    
    			ClassPapers (FileDescription)
    
    
    			RandomPapers (FileDescription)

",3
11669124,07/26/2012 12:17:51,1554611,07/26/2012 12:15:57,1,0,Bigint primary key & error converting varchar to bigint when selecting,"So I have this table where I have a bigint column being the primary key with autoincrement on. I also have a view which has all the columns from the table plus some additional columns. The problem is when i run a select statement and I want to filter on the primary key:

select * from Table where Request_ID = 123456  - selecting directly from the table works fine
select * from vw_Table where Request_ID = 123456  - selecting the same from the view fails with 'error converting varchar to bigint'

on the other hand though:

select * from vw_Table where Request_ID like 123456  - selecting the same from the view and using 'like' instead of '=' works fine

I am not doing any conversion on the primary key in the view and it comes as a bigint out of the view itself. Even explicitly converting both to varchar gives me the same error on the view:

select * from vw_Table where cast(Request_ID as varchar(max)) = cast('123456' as varchar(max)) - same error on this too.

Am I missing something here? Using 'like' seems to solve the problem but i feel it is a dirty fix.
Thanks",sql,varchar,bigint,,,07/26/2012 13:56:07,not a real question,1,191,11,"Bigint primary key & error converting varchar to bigint when selecting So I have this table where I have a bigint column being the primary key with autoincrement on. I also have a view which has all the columns from the table plus some additional columns. The problem is when i run a select statement and I want to filter on the primary key:

select * from Table where Request_ID = 123456  - selecting directly from the table works fine
select * from vw_Table where Request_ID = 123456  - selecting the same from the view fails with 'error converting varchar to bigint'

on the other hand though:

select * from vw_Table where Request_ID like 123456  - selecting the same from the view and using 'like' instead of '=' works fine

I am not doing any conversion on the primary key in the view and it comes as a bigint out of the view itself. Even explicitly converting both to varchar gives me the same error on the view:

select * from vw_Table where cast(Request_ID as varchar(max)) = cast('123456' as varchar(max)) - same error on this too.

Am I missing something here? Using 'like' seems to solve the problem but i feel it is a dirty fix.
Thanks",3
7743080,10/12/2011 16:07:34,991788,10/12/2011 15:59:26,1,0,ALTER TABLE ALTER COLUMN,"I have a column in a table so that it is no longer NVARCHAR(256) but is NVARCHAR(MAX).  I know the command to do this (ALTER TABLE <table> ALTER COLUMN <column> NVARCHAR(MAX)).  My quesiton is really about disruption.  I have to do this on a production environment and I was wondering if while I carry this out on the live environment there is a chance that there may be some disruption to usage to users.  Will users who are using the database at the time be booted off?  Will this operation likely take too long?

Thanks,

Sachin",sql,tsql,server,,,,open,0,99,4,"ALTER TABLE ALTER COLUMN I have a column in a table so that it is no longer NVARCHAR(256) but is NVARCHAR(MAX).  I know the command to do this (ALTER TABLE <table> ALTER COLUMN <column> NVARCHAR(MAX)).  My quesiton is really about disruption.  I have to do this on a production environment and I was wondering if while I carry this out on the live environment there is a chance that there may be some disruption to usage to users.  Will users who are using the database at the time be booted off?  Will this operation likely take too long?

Thanks,

Sachin",3
8473098,12/12/2011 10:46:45,664066,03/17/2011 09:46:14,20,2,Is recursive query slow?,"My manager asked me not to use recursive query since recursive by default means slow he claimed.

I'm just wondering if recursive query slow and if there is any other alternative way.",sql,oracle,recursive-query,,,12/12/2011 22:40:23,not a real question,1,31,4,"Is recursive query slow? My manager asked me not to use recursive query since recursive by default means slow he claimed.

I'm just wondering if recursive query slow and if there is any other alternative way.",3
6216361,06/02/2011 15:05:32,428404,08/23/2010 12:27:24,2691,202,Help with a SQL Query,"I have a question on a SQL query and im wondering where to start. Thoughts so far include creating a table in memory with a range of dates, and joining on to it to get the sum of hours entered for a particular day.

Just to give an idea of the background of this question here is a little information.

The database is structured like so:
![enter image description here][1]


The result im trying to achieve with the query im currently writing needs to look like this:
![enter image description here][2]

The Query I have written so far:

    DECLARE @Deleted AS BIT
    DECLARE @WeekStartDate AS DATETIME
    DECLARE @WeekEndDate AS DATETIME
    
    SET @Deleted = 0
    SET	@WeekStartDate = '2011/05/01 00:00'
    SET	@WeekEndDate = '2011/05/07 00:00'
    
    SELECT 
    [JobSheet].[JobSheetDate],
    [JobSheet].[ContractID],
    [JobSheet].[ContractCode],
    [JobSheet].[ContractTitle],
    [JobSheet].[ProjectID],
    [JobSheet].[ProjectCode],
    [JobSheet].[ProjectTitle],
    [JobSheet].[JobID],
    [JobSheet].[JobCode],
    [JobSheet].[JobTitle],
    [JobSheet].[SageDatabaseID],
    [JobSheetLineHours].[CostRateCode],
    SUM([JobSheetLineHours].[Hours]) AS TotalCostRateHours,
    '???' AS 'Mon',
    '???' AS 'Tue',
    '???' AS 'Wed',
    '???' AS 'Thu',
    '???' AS 'Fri',
    '???' AS 'Sat',
    '???' AS 'Sun'
    
    FROM [JobSheet]
    
    INNER JOIN [JobSheetLine]
    ON	[JobSheetLine].[JobSheetID]
    =	[JobSheet].[JobSheetID]
    
    INNER JOIN [JobSheetLineHours]
    ON	[JobSheetLineHours].[JobSheetLineID]
    =	[JobSheetLine].[JobSheetLineID]
    
    WHERE 
        [JobSheet].[Deleted]=@Deleted
    AND [JobSheet].[JobSheetDate] >= @WeekStartDate
    AND [JobSheet].[JobSheetDate] <= @WeekEndDate
    AND [JobSheetLine].[Deleted]=@Deleted
    AND [JobSheetLineHours].[Deleted]=@Deleted
    
    GROUP BY 
    	[JobSheet].[JobSheetDate],
    	[JobSheet].[ContractID],
    	[JobSheet].[ContractCode],
    	[JobSheet].[ContractTitle],
    	[JobSheet].[ProjectID],
    	[JobSheet].[ProjectCode],
    	[JobSheet].[ProjectTitle],
    	[JobSheet].[JobID],
    	[JobSheet].[JobCode],
    	[JobSheet].[JobTitle],
    	[JobSheet].[SageDatabaseID],
    	[JobSheetLineHours].[CostRateCode]

And this outputs the result set below:
![enter image description here][3]

As you can see the result set is almost there, I just need to total the number of hours worked on that particular day, grouping on ContractID, JobID, ProjectID, CostRateCode so I can get the number of hours for each cost rate on each unique project.

Is this possible with the current table design? or by using a temporary calendar table for the dates between the two passed in to the query?

  [1]: http://i.stack.imgur.com/ePBFs.jpg
  [2]: http://i.stack.imgur.com/bLeJj.jpg
  [3]: http://i.stack.imgur.com/0Vovc.jpg",sql,sql-server,,,,,open,0,475,5,"Help with a SQL Query I have a question on a SQL query and im wondering where to start. Thoughts so far include creating a table in memory with a range of dates, and joining on to it to get the sum of hours entered for a particular day.

Just to give an idea of the background of this question here is a little information.

The database is structured like so:
![enter image description here][1]


The result im trying to achieve with the query im currently writing needs to look like this:
![enter image description here][2]

The Query I have written so far:

    DECLARE @Deleted AS BIT
    DECLARE @WeekStartDate AS DATETIME
    DECLARE @WeekEndDate AS DATETIME
    
    SET @Deleted = 0
    SET	@WeekStartDate = '2011/05/01 00:00'
    SET	@WeekEndDate = '2011/05/07 00:00'
    
    SELECT 
    [JobSheet].[JobSheetDate],
    [JobSheet].[ContractID],
    [JobSheet].[ContractCode],
    [JobSheet].[ContractTitle],
    [JobSheet].[ProjectID],
    [JobSheet].[ProjectCode],
    [JobSheet].[ProjectTitle],
    [JobSheet].[JobID],
    [JobSheet].[JobCode],
    [JobSheet].[JobTitle],
    [JobSheet].[SageDatabaseID],
    [JobSheetLineHours].[CostRateCode],
    SUM([JobSheetLineHours].[Hours]) AS TotalCostRateHours,
    '???' AS 'Mon',
    '???' AS 'Tue',
    '???' AS 'Wed',
    '???' AS 'Thu',
    '???' AS 'Fri',
    '???' AS 'Sat',
    '???' AS 'Sun'
    
    FROM [JobSheet]
    
    INNER JOIN [JobSheetLine]
    ON	[JobSheetLine].[JobSheetID]
    =	[JobSheet].[JobSheetID]
    
    INNER JOIN [JobSheetLineHours]
    ON	[JobSheetLineHours].[JobSheetLineID]
    =	[JobSheetLine].[JobSheetLineID]
    
    WHERE 
        [JobSheet].[Deleted]=@Deleted
    AND [JobSheet].[JobSheetDate] >= @WeekStartDate
    AND [JobSheet].[JobSheetDate] <= @WeekEndDate
    AND [JobSheetLine].[Deleted]=@Deleted
    AND [JobSheetLineHours].[Deleted]=@Deleted
    
    GROUP BY 
    	[JobSheet].[JobSheetDate],
    	[JobSheet].[ContractID],
    	[JobSheet].[ContractCode],
    	[JobSheet].[ContractTitle],
    	[JobSheet].[ProjectID],
    	[JobSheet].[ProjectCode],
    	[JobSheet].[ProjectTitle],
    	[JobSheet].[JobID],
    	[JobSheet].[JobCode],
    	[JobSheet].[JobTitle],
    	[JobSheet].[SageDatabaseID],
    	[JobSheetLineHours].[CostRateCode]

And this outputs the result set below:
![enter image description here][3]

As you can see the result set is almost there, I just need to total the number of hours worked on that particular day, grouping on ContractID, JobID, ProjectID, CostRateCode so I can get the number of hours for each cost rate on each unique project.

Is this possible with the current table design? or by using a temporary calendar table for the dates between the two passed in to the query?

  [1]: http://i.stack.imgur.com/ePBFs.jpg
  [2]: http://i.stack.imgur.com/bLeJj.jpg
  [3]: http://i.stack.imgur.com/0Vovc.jpg",2
9427350,02/24/2012 08:03:58,960513,09/23/2011 06:17:19,96,0,Delphi: How to get table structure into object,"Using Delphi I need to create a class which will contain specific table structure (without data), including all fields, constraints, foreign keys, indexes. The goal is having ""standard"" table, compare them and find differences. This thing ought to be included into my big project so I can't use any ""outer"" comparators. Furthermore, this functionality might be extended, so I need to have my own realization. The question is how can I retrieve this information, having connection string and knowing specific table name. SQL Server 2008 is being used.",sql,sql-server,database,delphi,,,open,0,88,8,"Delphi: How to get table structure into object Using Delphi I need to create a class which will contain specific table structure (without data), including all fields, constraints, foreign keys, indexes. The goal is having ""standard"" table, compare them and find differences. This thing ought to be included into my big project so I can't use any ""outer"" comparators. Furthermore, this functionality might be extended, so I need to have my own realization. The question is how can I retrieve this information, having connection string and knowing specific table name. SQL Server 2008 is being used.",4
4101739,11/04/2010 21:49:42,379284,06/29/2010 17:53:49,18,0,MSSQL Select into existing table.,"I am trying to select some fields from one table and insert them into an existing table from a stored procedure. Here is what I am trying:

    SELECT col1, col2
    INTO dbo.TableTwo 
    FROM dbo.TableOne 
    WHERE col3 LIKE @search_key

I think select into is for tempory tables which is why I get an error that dbo.TableTwo already exists.

How can I insert multiple rows from dbo.TableOne into dbo.TableTwo?


",sql,sql-server,stored-procedures,,,,open,0,79,5,"MSSQL Select into existing table. I am trying to select some fields from one table and insert them into an existing table from a stored procedure. Here is what I am trying:

    SELECT col1, col2
    INTO dbo.TableTwo 
    FROM dbo.TableOne 
    WHERE col3 LIKE @search_key

I think select into is for tempory tables which is why I get an error that dbo.TableTwo already exists.

How can I insert multiple rows from dbo.TableOne into dbo.TableTwo?


",3
5881947,05/04/2011 10:25:00,737784,05/04/2011 10:25:00,1,0,query for available rooms in hotel reservation,"i was tasked to create an online hotel reservation system. the problem i encountered is the query to find the available rooms for a certain room category for a certain date range. My database design involves 4 tables. The database design is as follows:

tbl_reservationdetails ( stores the general details of the reservation )
 pk resrvdtl_id (primary key)
 fk client_id (insignificant for now)
    start_date (customer's check-in-date)
    end_date (customer's check-out-date)

tbl_reservation (stores the rooms reserved for a particular reservation )
 pk reserv_id (primary key)
 fk resrvdtl_id (foreign key, to know to whom and when the room should be occupied)
 fk room_id (the room reserved)

tbl_room
 pk room_id (primary key)
    room_number 
 fk room_categId (to know what category this room belongs to)

tbl_roomcategory
 pk room_categId (primary key)
    room_category (description of category.. example: Suite, Superior, Deluxe etc. in my case... there are four categories)
 
user input is the dates (start and end), and the category of room he wants. I'm quite new at this... how do I query to check the available room for that category for a certain date????? 

any response to this would be highly appreciated... thanks ",sql,query,online,reservation,,,open,0,195,7,"query for available rooms in hotel reservation i was tasked to create an online hotel reservation system. the problem i encountered is the query to find the available rooms for a certain room category for a certain date range. My database design involves 4 tables. The database design is as follows:

tbl_reservationdetails ( stores the general details of the reservation )
 pk resrvdtl_id (primary key)
 fk client_id (insignificant for now)
    start_date (customer's check-in-date)
    end_date (customer's check-out-date)

tbl_reservation (stores the rooms reserved for a particular reservation )
 pk reserv_id (primary key)
 fk resrvdtl_id (foreign key, to know to whom and when the room should be occupied)
 fk room_id (the room reserved)

tbl_room
 pk room_id (primary key)
    room_number 
 fk room_categId (to know what category this room belongs to)

tbl_roomcategory
 pk room_categId (primary key)
    room_category (description of category.. example: Suite, Superior, Deluxe etc. in my case... there are four categories)
 
user input is the dates (start and end), and the category of room he wants. I'm quite new at this... how do I query to check the available room for that category for a certain date????? 

any response to this would be highly appreciated... thanks ",4
5247417,03/09/2011 14:45:35,296231,03/18/2010 05:20:08,1199,110,Advantages in PL/SQL than T-SQL?,"Can we compare T-SQL & PL/SQL ? , how we define the differences between these  , and WHY its different ?  end of the day their scenario is Data definition and data manipulation :-S",sql,database,tsql,plsql,,03/10/2011 23:33:20,not a real question,1,36,5,"Advantages in PL/SQL than T-SQL? Can we compare T-SQL & PL/SQL ? , how we define the differences between these  , and WHY its different ?  end of the day their scenario is Data definition and data manipulation :-S",4
11745334,07/31/2012 17:01:09,1566421,07/31/2012 16:53:17,1,0,Can i use delete clause in Case Clause in teradata,"I am newbie to teradata

I need to delete a row once the case condition is satisfied.

Eg: case condtion true delete the selected row.",sql,delete,teradata,,,,open,0,23,10,"Can i use delete clause in Case Clause in teradata I am newbie to teradata

I need to delete a row once the case condition is satisfied.

Eg: case condtion true delete the selected row.",3
7900002,10/26/2011 07:52:51,510344,11/17/2010 04:04:11,151,17,How to insert select statement of get the day name,"i was create a table with 

    create table tblConsultationHour
    (
    	consultationID int primary key identity,
    	cday varchar(50),
    	cstartTime datetime,
    	cendTime datetime
    )

i want to insert value of the day name into cday, and i should know the day name from the cstarttime of date part. what i know on how to get the day name with this code

    SELECT DATENAME(dw,'2011-10-26 12:35:29.123')

may i know how can i insert this on the fly ?
or is that possible to insert in this way ?

insert into tblConsultationHour values (SELECT DATENAME(dw,'2011-10-26 12:35:29.123'),'2011-10-26 12:35', '2011-10-26 14:35')
",sql,sql-server-2008,datetime,select,insert,,open,0,115,10,"How to insert select statement of get the day name i was create a table with 

    create table tblConsultationHour
    (
    	consultationID int primary key identity,
    	cday varchar(50),
    	cstartTime datetime,
    	cendTime datetime
    )

i want to insert value of the day name into cday, and i should know the day name from the cstarttime of date part. what i know on how to get the day name with this code

    SELECT DATENAME(dw,'2011-10-26 12:35:29.123')

may i know how can i insert this on the fly ?
or is that possible to insert in this way ?

insert into tblConsultationHour values (SELECT DATENAME(dw,'2011-10-26 12:35:29.123'),'2011-10-26 12:35', '2011-10-26 14:35')
",5
7699303,10/08/2011 19:39:02,975828,10/02/2011 21:43:50,16,0,SQL 2008 the transaction changes are not transferring to subscriber from new principal server,"when failover occurs while configuring replication with mirroring with witness or without witness server. i configured with witness server

but the transaction changes are not transferring to subscriber from new principal server(initial mirror server)",sql,sql-server,sql-server-2008,,,10/10/2011 10:18:10,not a real question,1,33,14,"SQL 2008 the transaction changes are not transferring to subscriber from new principal server when failover occurs while configuring replication with mirroring with witness or without witness server. i configured with witness server

but the transaction changes are not transferring to subscriber from new principal server(initial mirror server)",3
10356999,04/27/2012 19:53:04,1361909,04/27/2012 19:45:40,1,0,How can i develope a website with huge database such as monster.com and dice.com,"1) How can i develop a website such as monster.com OR dice.com holds Huge Database.

2) what are the software  & programs i have to use any suggestion for a specific site with tutorial would be greatly appreciated.
",sql,database,development,,,04/27/2012 19:57:01,not constructive,1,38,14,"How can i develope a website with huge database such as monster.com and dice.com 1) How can i develop a website such as monster.com OR dice.com holds Huge Database.

2) what are the software  & programs i have to use any suggestion for a specific site with tutorial would be greatly appreciated.
",3
11377569,07/07/2012 18:25:29,331393,05/03/2010 12:20:59,534,4,"What is meant by a ""full SQL catalog""","[This answer][1] talks about a ""full catalogue"". What does it mean?

>Now SQL barely supports 5NF, it does not support 6NF at all (I think dportas says the same thing in different words). Now I implement 6NF at a deep level, for performance reasons, simplified pivoting (entirely table not the silly PIVOT function in MS), columnar access, etc. For that you need a full catalogue, which is an extension to the SQL catalogue, to support the 6NF that SQL does not support, and maintain data Integrity and business Rules.


  [1]: http://stackoverflow.com/a/4843859/331393",sql,database-design,,,,07/08/2012 07:10:11,too localized,1,91,8,"What is meant by a ""full SQL catalog"" [This answer][1] talks about a ""full catalogue"". What does it mean?

>Now SQL barely supports 5NF, it does not support 6NF at all (I think dportas says the same thing in different words). Now I implement 6NF at a deep level, for performance reasons, simplified pivoting (entirely table not the silly PIVOT function in MS), columnar access, etc. For that you need a full catalogue, which is an extension to the SQL catalogue, to support the 6NF that SQL does not support, and maintain data Integrity and business Rules.


  [1]: http://stackoverflow.com/a/4843859/331393",2
7583321,09/28/2011 12:40:00,952262,09/19/2011 08:37:58,1,0,SQL query to return columns and the values if any one condition matches,"I need an sql query  to get all the column values to be displayed if  any one condition is satisfied from multiple conditions?
             Is this can be possible..please help me...",sql,sql-server-2008,,,,09/28/2011 12:43:58,not a real question,1,44,13,"SQL query to return columns and the values if any one condition matches I need an sql query  to get all the column values to be displayed if  any one condition is satisfied from multiple conditions?
             Is this can be possible..please help me...",2
11714007,07/30/2012 00:00:17,1561679,07/29/2012 23:57:03,1,0,Is it possible to design a query in SQL without using nested queries? Can Some one explain with any example,Is it possible to design a query in SQL without using nested queries?,sql,sql-server,,,,07/31/2012 06:30:00,not a real question,1,13,20,Is it possible to design a query in SQL without using nested queries? Can Some one explain with any example Is it possible to design a query in SQL without using nested queries?,2
7152226,08/22/2011 19:00:47,906484,08/22/2011 19:00:47,1,0,Using SQL VB.NET: A quick SQL question need help asap,"Are the following 2 SQL statements the same? Will they produce the same results?

sql1 = ""SELECT * FROM [StudentDetials] WHERE ([Subject1] LIKE '"" & Subject(0) & ""' OR [Subject2] LIKE '"" & Subject(0) & ""') AND ([Day1] LIKE '"" & TabDay & ""' OR [Day2] LIKE '"" & TabDay & ""') AND ([Time1] >= '"" & Time(0) & ""' AND [ETime1] <= '"" & Time(1) & ""' OR [Time2] >= '"" & Time(0) & ""' AND [ETime2] <= '"" & Time(1) & ""')""

sql1 = ""SELECT * FROM [StudentDetials] WHERE ([Subject1] LIKE '"" & Subject(0) & ""' AND [Day1] LIKE '"" & TabDay & ""' AND [Time1] >= '"" & Time(0) & ""' AND [ETime1] <= '"" & Time(1) & ""') OR ([Subject2] LIKE '"" & Subject(0) & ""' AND [Day2] LIKE '"" & TabDay & ""' AND [Time2] >= '"" & Time(0) & ""' AND [ETime2] <= '"" & Time(1) & ""')""",sql,vb.net,,,,08/22/2011 19:18:19,too localized,1,152,10,"Using SQL VB.NET: A quick SQL question need help asap Are the following 2 SQL statements the same? Will they produce the same results?

sql1 = ""SELECT * FROM [StudentDetials] WHERE ([Subject1] LIKE '"" & Subject(0) & ""' OR [Subject2] LIKE '"" & Subject(0) & ""') AND ([Day1] LIKE '"" & TabDay & ""' OR [Day2] LIKE '"" & TabDay & ""') AND ([Time1] >= '"" & Time(0) & ""' AND [ETime1] <= '"" & Time(1) & ""' OR [Time2] >= '"" & Time(0) & ""' AND [ETime2] <= '"" & Time(1) & ""')""

sql1 = ""SELECT * FROM [StudentDetials] WHERE ([Subject1] LIKE '"" & Subject(0) & ""' AND [Day1] LIKE '"" & TabDay & ""' AND [Time1] >= '"" & Time(0) & ""' AND [ETime1] <= '"" & Time(1) & ""') OR ([Subject2] LIKE '"" & Subject(0) & ""' AND [Day2] LIKE '"" & TabDay & ""' AND [Time2] >= '"" & Time(0) & ""' AND [ETime2] <= '"" & Time(1) & ""')""",2
6513177,06/28/2011 21:16:00,395258,07/18/2010 17:06:28,670,31,"dbDelta/SQL error, very unexpected","Here's an error that I'm having trouble with. It occurs when I use the dbDelta function in Wordpress. I can't really figure it out, perhaps someone else has experience something similar? My code:

	$sql1 = ""CREATE TABLE `"".$table_name1.""` (
	`id` INT( 11 ) NOT NULL AUTO_INCREMENT  PRIMARY KEY ,
	`blogid` INT( 11 ) NOT NULL ,
	`symbol` VARCHAR( 255 ) NOT NULL
	) ENGINE = MYISAM"";

I trigger this code during the theme_switch action. And it does not seem to occur when I turn the theme on, only when I switch to something else (I know, it's weird). I have read and I have attempted to follow the caveats mentioned at <a href=""http://codex.wordpress.org/Creating_Tables_with_Plugins"">Wordpress.org</a>, for example putting two spaces between primary key and the definition. I have two other, similar, pieces of SQL code that generate the same error; all three were originally generated by phpMyAdmin so I know that they work.

    Notice: Undefined offset: 1 in /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php on line 1463
    
    Notice: Undefined offset: 1 in /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php on line 1463
    
    Notice: Undefined offset: 1 in /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php on line 1463
    
    WordPress database error: [Multiple primary key defined]
    ALTER TABLE wp_stocks_0 CHANGE COLUMN id `id` INT( 11 ) NOT NULL AUTO_INCREMENT PRIMARY KEY
    
    Warning: Cannot modify header information - headers already sent by (output started at /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php:1463) in /Applications/MAMP/htdocs/wp-experiment/wp-includes/pluggable.php on line 897",sql,wordpress,,,,,open,0,248,4,"dbDelta/SQL error, very unexpected Here's an error that I'm having trouble with. It occurs when I use the dbDelta function in Wordpress. I can't really figure it out, perhaps someone else has experience something similar? My code:

	$sql1 = ""CREATE TABLE `"".$table_name1.""` (
	`id` INT( 11 ) NOT NULL AUTO_INCREMENT  PRIMARY KEY ,
	`blogid` INT( 11 ) NOT NULL ,
	`symbol` VARCHAR( 255 ) NOT NULL
	) ENGINE = MYISAM"";

I trigger this code during the theme_switch action. And it does not seem to occur when I turn the theme on, only when I switch to something else (I know, it's weird). I have read and I have attempted to follow the caveats mentioned at <a href=""http://codex.wordpress.org/Creating_Tables_with_Plugins"">Wordpress.org</a>, for example putting two spaces between primary key and the definition. I have two other, similar, pieces of SQL code that generate the same error; all three were originally generated by phpMyAdmin so I know that they work.

    Notice: Undefined offset: 1 in /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php on line 1463
    
    Notice: Undefined offset: 1 in /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php on line 1463
    
    Notice: Undefined offset: 1 in /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php on line 1463
    
    WordPress database error: [Multiple primary key defined]
    ALTER TABLE wp_stocks_0 CHANGE COLUMN id `id` INT( 11 ) NOT NULL AUTO_INCREMENT PRIMARY KEY
    
    Warning: Cannot modify header information - headers already sent by (output started at /Applications/MAMP/htdocs/wp-experiment/wp-admin/includes/upgrade.php:1463) in /Applications/MAMP/htdocs/wp-experiment/wp-includes/pluggable.php on line 897",2
4248701,11/22/2010 18:12:44,71056,02/25/2009 21:02:16,1471,80,Advantages on using cursor variable in SQL Server (declare @cn cursor),"In T-SQL a cursor can be declared in two ways (that I know of):

declare CursorName cursor for … OR
declare @CursorName cursor

I was running some tests and I notice that the creation of a cursor variable will not add an entry to the result of sp_cursor_list.

Is there any advantage/disatvantage on using the second approach from the point of view of performance, resource utilization, etc?",sql,tsql,server,syntax,cursor,,open,0,63,11,"Advantages on using cursor variable in SQL Server (declare @cn cursor) In T-SQL a cursor can be declared in two ways (that I know of):

declare CursorName cursor for … OR
declare @CursorName cursor

I was running some tests and I notice that the creation of a cursor variable will not add an entry to the result of sp_cursor_list.

Is there any advantage/disatvantage on using the second approach from the point of view of performance, resource utilization, etc?",5
7635176,10/03/2011 12:48:55,835464,07/08/2011 13:41:53,120,6,Stored Procedure Tuning,"I have a big stored procedure, which runs for 2-3 secs at 100% CPU. Its not a big deal, if the SP runs once for a while, however this particular SP runs every second. so you can understand the total processor usage in a minute and through-out the day.

This stored procedure contains lots of queries, temporary tables, one or two cursors and some dynamic queries.

what will the best possible solution to tune-up my SP, and different ways to do that.

What are the points we need to remember while writing an SP in general?

Please Help...",sql,sql-server,stored-procedures,,,10/03/2011 13:11:39,not a real question,1,94,3,"Stored Procedure Tuning I have a big stored procedure, which runs for 2-3 secs at 100% CPU. Its not a big deal, if the SP runs once for a while, however this particular SP runs every second. so you can understand the total processor usage in a minute and through-out the day.

This stored procedure contains lots of queries, temporary tables, one or two cursors and some dynamic queries.

what will the best possible solution to tune-up my SP, and different ways to do that.

What are the points we need to remember while writing an SP in general?

Please Help...",3
7117158,08/19/2011 05:03:34,643192,03/03/2011 14:55:00,127,10,Entity framework equivalent to SQL 'IS NULL',"I am trying to translate the following query into entity framework:

    SELECT            Subjects.Name
    FROM              Subjects LEFT OUTER JOIN
                            Projects_Subjects ON Subjects.ID = Projects_Subjects.Section_ID
    WHERE             (Projects_Subjects.Project_ID IS NULL) OR
                            (Projects_Subjects.Project_ID <> 2)

Where subjects is a simple table with subject.ID, subject.Name and Projects_Subjects is a table effecting the many-to-many relationship between subjects and projects, with Projects_Subjects.Project_ID and Projects_Subjects.Subject_ID columns.

This query works fine in SQL, in that it returns all the subjects which are not yet associated with the project with ID = 2.

I am trying to translate this to Linq to Entities. So far I have:

    db.Subjects.Where(s => s.Projects == null || !s.Projects.Select(p => p.ID).Contains(ProjectID))

Which the compiler is happy with as far as syntax goes, but at runtime I get the following error:

    'System.Data.Objects.DataClasses.EntityCollection`1'. Only primitive types (such as Int32, String, and Guid) and entity types are supported.

There is no other info really. As far as I can tell it doesn't like the s.Projects == null bit as it works fine if I take that out. Question is: How can I perform that check on the entity collection?",sql,entity-framework,linq-to-entities,,,,open,0,281,7,"Entity framework equivalent to SQL 'IS NULL' I am trying to translate the following query into entity framework:

    SELECT            Subjects.Name
    FROM              Subjects LEFT OUTER JOIN
                            Projects_Subjects ON Subjects.ID = Projects_Subjects.Section_ID
    WHERE             (Projects_Subjects.Project_ID IS NULL) OR
                            (Projects_Subjects.Project_ID <> 2)

Where subjects is a simple table with subject.ID, subject.Name and Projects_Subjects is a table effecting the many-to-many relationship between subjects and projects, with Projects_Subjects.Project_ID and Projects_Subjects.Subject_ID columns.

This query works fine in SQL, in that it returns all the subjects which are not yet associated with the project with ID = 2.

I am trying to translate this to Linq to Entities. So far I have:

    db.Subjects.Where(s => s.Projects == null || !s.Projects.Select(p => p.ID).Contains(ProjectID))

Which the compiler is happy with as far as syntax goes, but at runtime I get the following error:

    'System.Data.Objects.DataClasses.EntityCollection`1'. Only primitive types (such as Int32, String, and Guid) and entity types are supported.

There is no other info really. As far as I can tell it doesn't like the s.Projects == null bit as it works fine if I take that out. Question is: How can I perform that check on the entity collection?",3
3378027,07/31/2010 12:10:28,357849,06/03/2010 19:29:39,145,2,Optimizing deleting a large number of rows (over a few millions) - MSSQL 2005,"First we get the max id from the ProductFileLocalName and then - 1000 (as we don't want to delete the most recent additions as they might not be inserted in ProductFileInfo yet)

Then we pass the max id to this stored procedure: 

    DELETE TOP (10000)
    FROM ProductFileLocalName WITH (ROWLOCK)
    FROM ProductFileLocalName
        LEFT OUTER JOIN ProductFileInfo AS pfi WITH (NOLOCK) ON ProductFileLocalName.ProductFileLocalNameId = pfi.ProductFileLocalNameId
    WHERE (ProductFileLocalName.ProductFileLocalNameId < @maxid AND pfi.ProductFileInfoId IS NULL);
    


Is this the most effective way to perform this operation?",sql,,,,,,open,0,103,14,"Optimizing deleting a large number of rows (over a few millions) - MSSQL 2005 First we get the max id from the ProductFileLocalName and then - 1000 (as we don't want to delete the most recent additions as they might not be inserted in ProductFileInfo yet)

Then we pass the max id to this stored procedure: 

    DELETE TOP (10000)
    FROM ProductFileLocalName WITH (ROWLOCK)
    FROM ProductFileLocalName
        LEFT OUTER JOIN ProductFileInfo AS pfi WITH (NOLOCK) ON ProductFileLocalName.ProductFileLocalNameId = pfi.ProductFileLocalNameId
    WHERE (ProductFileLocalName.ProductFileLocalNameId < @maxid AND pfi.ProductFileInfoId IS NULL);
    


Is this the most effective way to perform this operation?",1
3748533,09/20/2010 03:28:27,117700,06/04/2009 23:04:34,1685,7,connecting to a remote database anonymously,"i would like to be able to retrieve results from this search by connecting directly to their database instead of screen-scraping:

http://broinc.com/search.php

would it be possible to return the results programmatically into some variable, instead of manually doing this search and then going through every page to get the results?

thank you so much for your help",sql,database,remote,,,,open,0,54,6,"connecting to a remote database anonymously i would like to be able to retrieve results from this search by connecting directly to their database instead of screen-scraping:

http://broinc.com/search.php

would it be possible to return the results programmatically into some variable, instead of manually doing this search and then going through every page to get the results?

thank you so much for your help",3
10918065,06/06/2012 16:14:56,927034,09/03/2011 21:10:58,21526,940,Query to return elements with extra rows for groups,"I have an _SQLite_ database that stores a list of items with categories. Categories are _implicit_, there is no separate table for them. I would like a single query that would return all items ordered by category, with an extra row per category.

Consider the following scenario:

    ID    Name       Category
    1     Item 1     C1
    2     Item 2     C2
    3     Item 3     C1

The results I expect would be something like:

    ID    Name       Category
    null  null       C1
    1     Item 1     C1
    3     Item 3     C1
    null  null       C2
    2     Item 2     C2

This is to have a _direct mapping_ to the list view where the results will be displayed, that contain an extra separator item per category. What I'm doing right now is return all elements ordered by category, and iterate over them to know where the separators should be located.

I have experimented with a number of different `JOIN`s, but my _SQL-fu_ is weak and I cannot figure out how to write such query. How would I go about doing this? Which _SQL_ constructs would let me add those extra rows? Is it even possible to get the results in the way I need them in a single _-no matter how complex-_ query?",sql,sqlite,,,,,open,0,309,9,"Query to return elements with extra rows for groups I have an _SQLite_ database that stores a list of items with categories. Categories are _implicit_, there is no separate table for them. I would like a single query that would return all items ordered by category, with an extra row per category.

Consider the following scenario:

    ID    Name       Category
    1     Item 1     C1
    2     Item 2     C2
    3     Item 3     C1

The results I expect would be something like:

    ID    Name       Category
    null  null       C1
    1     Item 1     C1
    3     Item 3     C1
    null  null       C2
    2     Item 2     C2

This is to have a _direct mapping_ to the list view where the results will be displayed, that contain an extra separator item per category. What I'm doing right now is return all elements ordered by category, and iterate over them to know where the separators should be located.

I have experimented with a number of different `JOIN`s, but my _SQL-fu_ is weak and I cannot figure out how to write such query. How would I go about doing this? Which _SQL_ constructs would let me add those extra rows? Is it even possible to get the results in the way I need them in a single _-no matter how complex-_ query?",2
9544100,03/03/2012 06:36:33,1239554,02/29/2012 06:30:06,14,0,sql datetime issue,"can anyone help me, am facing some problem with the datetime function in the sql

see I have some records on the dates from 01/30/2012 to 02/21/2012 only, I need to get the datas in between these two dates, If I give 01/01/2012 as starting date and 12/01/2012 as ending date it shows all the datas correctly, but If I give 01/30/2012 as starting date and 02/21/2012 as ending date it shows only two records on 01/30/2012 and on 02/21/2012......what happened to the other records, how can I solve this problem.........thanks in advance",sql,datetime,,,,03/03/2012 11:33:26,not a real question,1,92,3,"sql datetime issue can anyone help me, am facing some problem with the datetime function in the sql

see I have some records on the dates from 01/30/2012 to 02/21/2012 only, I need to get the datas in between these two dates, If I give 01/01/2012 as starting date and 12/01/2012 as ending date it shows all the datas correctly, but If I give 01/30/2012 as starting date and 02/21/2012 as ending date it shows only two records on 01/30/2012 and on 02/21/2012......what happened to the other records, how can I solve this problem.........thanks in advance",2
11135541,06/21/2012 09:45:00,428073,08/23/2010 05:58:43,708,8,SQL SCRIPT ERROR : Invalid length parameter passed to the LEFT or SUBSTRING function,"I'm executing stored procedure inside SQL AGENT JOBS.

I'm getting this error :

>Executed as user: NT AUTHORITY\SYSTEM. Invalid length parameter passed to the LEFT or SUBSTRING function. [SQLSTATE 42000] (Error 537).  The step failed.

What is the issue I checked into function but can't find anything suspicious ?",sql,sql-server,stored-procedures,,,06/21/2012 10:17:20,not a real question,1,47,14,"SQL SCRIPT ERROR : Invalid length parameter passed to the LEFT or SUBSTRING function I'm executing stored procedure inside SQL AGENT JOBS.

I'm getting this error :

>Executed as user: NT AUTHORITY\SYSTEM. Invalid length parameter passed to the LEFT or SUBSTRING function. [SQLSTATE 42000] (Error 537).  The step failed.

What is the issue I checked into function but can't find anything suspicious ?",3
562608,02/18/2009 20:09:08,35903,11/09/2008 09:38:52,696,41,Aggregation with two Joins (MySQL),"I have one table called **gallery**. For each row in **gallery** there are several rows in the table **picture**. One picture belongs to one gallery. Then there is the table **vote**. There each row is an upvote or a downvote for a certain gallery.
Here is the (simplified) structure:

    gallery ( gallery_id )
    picture ( picture_id, picture_gallery_ref )
    vote ( vote_id, vote_value, vote_gallery_ref )

Now I want one query to give me the following information: All galleries with their own data fields and the number of pictures that are connected to the gallery and the sumarized value of the votes.

Here is my query, but due to the multiple joining the aggregated values are not the right ones. (At least when there is more than one row of either pictures or votes.)

    SELECT 
      *, SUM( vote_value ) as score, COUNT( picture_id ) AS pictures
    FROM 
      gallery
    LEFT JOIN 
      vote
      ON gallery_id = vote_gallery_ref
    LEFT JOIN 
      picture
      ON gallery_id = picture_gallery_ref
    GROUP BY question_id

Because I have noticed that `COUNT( DISTINCT picture_id )` gives me the correct number of pictures I tried this:

    ( SUM( vote_value ) / GREATEST( COUNT( DISTINCT picture_id ), 1 ) ) AS score

It works in this example, but what if there were more joins in one query? 

Just want to know whether there is a better or more 'elegant' way this problem can be solved. Also I'd like to know whether my solution is MySQL-specific or standard SQL?",sql,joins,aggregation,,,,open,0,299,5,"Aggregation with two Joins (MySQL) I have one table called **gallery**. For each row in **gallery** there are several rows in the table **picture**. One picture belongs to one gallery. Then there is the table **vote**. There each row is an upvote or a downvote for a certain gallery.
Here is the (simplified) structure:

    gallery ( gallery_id )
    picture ( picture_id, picture_gallery_ref )
    vote ( vote_id, vote_value, vote_gallery_ref )

Now I want one query to give me the following information: All galleries with their own data fields and the number of pictures that are connected to the gallery and the sumarized value of the votes.

Here is my query, but due to the multiple joining the aggregated values are not the right ones. (At least when there is more than one row of either pictures or votes.)

    SELECT 
      *, SUM( vote_value ) as score, COUNT( picture_id ) AS pictures
    FROM 
      gallery
    LEFT JOIN 
      vote
      ON gallery_id = vote_gallery_ref
    LEFT JOIN 
      picture
      ON gallery_id = picture_gallery_ref
    GROUP BY question_id

Because I have noticed that `COUNT( DISTINCT picture_id )` gives me the correct number of pictures I tried this:

    ( SUM( vote_value ) / GREATEST( COUNT( DISTINCT picture_id ), 1 ) ) AS score

It works in this example, but what if there were more joins in one query? 

Just want to know whether there is a better or more 'elegant' way this problem can be solved. Also I'd like to know whether my solution is MySQL-specific or standard SQL?",3
6471480,06/24/2011 17:27:24,514025,11/19/2010 22:11:00,76,5,what happened after a successful SQL injection?,"I am always interested in hacking, I understand the concept of SQL injection and cross site scripting. However, the thing I don't know is how to detecting a possible SQL injection. I have checked some books, but I didn't get too much information. Do hackers do the detection work by hand or they have smarter automatic tools?

So i am thinking of writing a simple tool to do automatic injection check (using qwebkit). I want to capture the http requests before sending them and replace some form data of the http header with SQL injection commands. The program checks the http response and compare it with a normal response and reports any difference.

The thing is that I have never found a SQL injection myself, so is this idea valid?

say, if I successfully upgrade myself to administrator of certain website, the returned http response should look normal. So I shouldn't be able to automatically report that with my program?",sql,detection,injection,,,06/24/2011 17:33:23,off topic,1,157,7,"what happened after a successful SQL injection? I am always interested in hacking, I understand the concept of SQL injection and cross site scripting. However, the thing I don't know is how to detecting a possible SQL injection. I have checked some books, but I didn't get too much information. Do hackers do the detection work by hand or they have smarter automatic tools?

So i am thinking of writing a simple tool to do automatic injection check (using qwebkit). I want to capture the http requests before sending them and replace some form data of the http header with SQL injection commands. The program checks the http response and compare it with a normal response and reports any difference.

The thing is that I have never found a SQL injection myself, so is this idea valid?

say, if I successfully upgrade myself to administrator of certain website, the returned http response should look normal. So I shouldn't be able to automatically report that with my program?",3
1515877,10/04/2009 08:04:52,89752,04/11/2009 12:32:07,295,12,SQL query to collect entries from different tables - need an alternate to UNION,"I'm running a sql query to get basic details from a number of tables. Sorted by the last update date field. Its terribly tricky and I'm thinking if there is an alternate to using the UNION clause instead...I'm working in PHP MYSQL.

Actually I have a few tables containing news, articles, photos, events etc and need to collect all of them in one query to show a simple - whats newly added on the website kind of thing.",sql,mysql,union,,,,open,0,77,14,"SQL query to collect entries from different tables - need an alternate to UNION I'm running a sql query to get basic details from a number of tables. Sorted by the last update date field. Its terribly tricky and I'm thinking if there is an alternate to using the UNION clause instead...I'm working in PHP MYSQL.

Actually I have a few tables containing news, articles, photos, events etc and need to collect all of them in one query to show a simple - whats newly added on the website kind of thing.",3
5829104,04/29/2011 07:16:30,730613,04/29/2011 07:04:39,1,0,Sql problem with my query,"SELECT     dbo.pi_employee.emp_firstname, dbo.pi_employee.emp_lastname, dbo.pi_employee.emp_no, dbo.pi_employee.emp_cnic, 
                      dbo.pi_employee.emp_currentadd, dbo.pi_employee.emp_cellph, dbo.pi_employee.emp_birthday, pi_jobtitle_1.jobtitle_name, 
                      dbo.pi_employee.emp_joindate, dbo.pi_education.edu_degree, dbo.pi_education.edu_year, dbo.pi_employee.emp_pension, 
                      dbo.pi_employee.emp_age, dbo.pi_employee.emp_service, dbo.pi_employee.emp_terminate, dbo.pi_employee.emp_termdate, 
                      dbo.pi_employee.emp_basicofpay, dbo.pi_employee.emp_terminationreason, dbo.pi_employee.emp_terminationdate, dbo.pi_employee.emp_status, 
                      dbo.pi_employee.emp_gender, dbo.pi_employee.emp_maritalstatus, dbo.pi_employee.emp_paymethod, dbo.pi_employee.emp_leaveentitle, 
                      dbo.pi_employee.emp_confirmation, dbo.pi_employee.emp_title, dbo.pi_employee.emp_basicamount, dbo.pi_salgrade.salgrade_name, 
                      dbo.tbl_emp_status.StatusName, dbo.pi_skills.skill_type, dbo.pi_location.loc_name, pi_location_1.loc_name AS wcity, 
                      dbo.pi_jobtitlehist.jthSaleGradetype, dbo.pi_workexp.exp_serperiod, dbo.pi_employee.emp_domicile, dbo.pi_skills.skill_type AS Skill, 
                      dbo.pi_skills.skill_exp, dbo.pi_education.edu_degree AS Degree, dbo.pi_education.edu_uni, dbo.pi_education.edu_distinction, 
                      dbo.pi_lochistory.lhstart_date, dbo.pi_lochistory.lhend_date
FROM         dbo.pi_location RIGHT OUTER JOIN
                      dbo.pi_workexp RIGHT OUTER JOIN
                      dbo.pi_employee ON dbo.pi_workexp.emp_no = dbo.pi_employee.emp_no LEFT OUTER JOIN
                      dbo.pi_jobtitlehist ON dbo.pi_employee.emp_no = dbo.pi_jobtitlehist.emp_no ON 
                      dbo.pi_location.loc_id = dbo.pi_employee.emp_location_id LEFT OUTER JOIN
                      dbo.pi_salgrade ON dbo.pi_employee.emp_salgrade_id = dbo.pi_salgrade.salgrade_id LEFT OUTER JOIN
                      dbo.tbl_emp_status ON dbo.pi_employee.emp_status = dbo.tbl_emp_status.StatusID LEFT OUTER JOIN
                      dbo.pi_skills ON dbo.pi_employee.emp_no = dbo.pi_skills.emp_no LEFT OUTER JOIN
                      dbo.pi_location AS pi_location_1 INNER JOIN
                      dbo.pi_lochistory ON pi_location_1.loc_id = dbo.pi_lochistory.loc_id ON dbo.pi_employee.emp_no = dbo.pi_lochistory.emp_no LEFT OUTER JOIN
                      dbo.pi_education ON dbo.pi_employee.emp_no = dbo.pi_education.emp_no LEFT OUTER JOIN
                      dbo.pi_jobtitle AS pi_jobtitle_1 ON dbo.pi_employee.emp_jobtitle_id = pi_jobtitle_1.jobtitle_id



i am writing sql query to implement different scenario but problem is that it gives repeated values i write distinct and order by too but result was same can any 1 help me to solve this issue",sql,,,,,,open,0,633,5,"Sql problem with my query SELECT     dbo.pi_employee.emp_firstname, dbo.pi_employee.emp_lastname, dbo.pi_employee.emp_no, dbo.pi_employee.emp_cnic, 
                      dbo.pi_employee.emp_currentadd, dbo.pi_employee.emp_cellph, dbo.pi_employee.emp_birthday, pi_jobtitle_1.jobtitle_name, 
                      dbo.pi_employee.emp_joindate, dbo.pi_education.edu_degree, dbo.pi_education.edu_year, dbo.pi_employee.emp_pension, 
                      dbo.pi_employee.emp_age, dbo.pi_employee.emp_service, dbo.pi_employee.emp_terminate, dbo.pi_employee.emp_termdate, 
                      dbo.pi_employee.emp_basicofpay, dbo.pi_employee.emp_terminationreason, dbo.pi_employee.emp_terminationdate, dbo.pi_employee.emp_status, 
                      dbo.pi_employee.emp_gender, dbo.pi_employee.emp_maritalstatus, dbo.pi_employee.emp_paymethod, dbo.pi_employee.emp_leaveentitle, 
                      dbo.pi_employee.emp_confirmation, dbo.pi_employee.emp_title, dbo.pi_employee.emp_basicamount, dbo.pi_salgrade.salgrade_name, 
                      dbo.tbl_emp_status.StatusName, dbo.pi_skills.skill_type, dbo.pi_location.loc_name, pi_location_1.loc_name AS wcity, 
                      dbo.pi_jobtitlehist.jthSaleGradetype, dbo.pi_workexp.exp_serperiod, dbo.pi_employee.emp_domicile, dbo.pi_skills.skill_type AS Skill, 
                      dbo.pi_skills.skill_exp, dbo.pi_education.edu_degree AS Degree, dbo.pi_education.edu_uni, dbo.pi_education.edu_distinction, 
                      dbo.pi_lochistory.lhstart_date, dbo.pi_lochistory.lhend_date
FROM         dbo.pi_location RIGHT OUTER JOIN
                      dbo.pi_workexp RIGHT OUTER JOIN
                      dbo.pi_employee ON dbo.pi_workexp.emp_no = dbo.pi_employee.emp_no LEFT OUTER JOIN
                      dbo.pi_jobtitlehist ON dbo.pi_employee.emp_no = dbo.pi_jobtitlehist.emp_no ON 
                      dbo.pi_location.loc_id = dbo.pi_employee.emp_location_id LEFT OUTER JOIN
                      dbo.pi_salgrade ON dbo.pi_employee.emp_salgrade_id = dbo.pi_salgrade.salgrade_id LEFT OUTER JOIN
                      dbo.tbl_emp_status ON dbo.pi_employee.emp_status = dbo.tbl_emp_status.StatusID LEFT OUTER JOIN
                      dbo.pi_skills ON dbo.pi_employee.emp_no = dbo.pi_skills.emp_no LEFT OUTER JOIN
                      dbo.pi_location AS pi_location_1 INNER JOIN
                      dbo.pi_lochistory ON pi_location_1.loc_id = dbo.pi_lochistory.loc_id ON dbo.pi_employee.emp_no = dbo.pi_lochistory.emp_no LEFT OUTER JOIN
                      dbo.pi_education ON dbo.pi_employee.emp_no = dbo.pi_education.emp_no LEFT OUTER JOIN
                      dbo.pi_jobtitle AS pi_jobtitle_1 ON dbo.pi_employee.emp_jobtitle_id = pi_jobtitle_1.jobtitle_id



i am writing sql query to implement different scenario but problem is that it gives repeated values i write distinct and order by too but result was same can any 1 help me to solve this issue",1
8312869,11/29/2011 14:55:47,1071509,11/29/2011 14:39:26,1,0,how to supply succeding values using the previous value,"I have a sutiation.

Recid field Name
1     aaaaaaaaa
2     
3     
4     bbbbbbbbb
5
6     

The result must be like this:

Recid Field Name
1     aaaaaaaaa
2     aaaaaaaaa
3     aaaaaaaaa
4     bbbbbbbbb
5     bbbbbbbbb
6     bbbbbbbbb

how will you do that in a single query/sql? except doing a loop. Thanks in advance.
",sql,tsql,,,,12/04/2011 22:51:32,not a real question,1,83,9,"how to supply succeding values using the previous value I have a sutiation.

Recid field Name
1     aaaaaaaaa
2     
3     
4     bbbbbbbbb
5
6     

The result must be like this:

Recid Field Name
1     aaaaaaaaa
2     aaaaaaaaa
3     aaaaaaaaa
4     bbbbbbbbb
5     bbbbbbbbb
6     bbbbbbbbb

how will you do that in a single query/sql? except doing a loop. Thanks in advance.
",2
10240788,04/20/2012 05:32:26,1345678,04/20/2012 05:27:18,1,0,converting the SQL Query to LINQ,"hi i am new to development. 

i need to convert the following SQL Query to LINQ query

    SELECT Distinct c.CompanyName, c.Email, c.FirstName, c.ConnectionString,
    (SELECT COUNT(*) FROM OZT_Users_Clients as cvm 
    join OZT_Users cam on cvm.UserID = cam.UserID
    WHERE cam.Active =1 and cvm.ClientID = c.ClientID) 
    as [Number of Active Users] FROM OZT_Clients as c 
    group by c.CompanyName, c.Email, c.FirstName, c.ConnectionString, c.ClientID

please help me in converting this to LINQ. 

Thanks,
abivenkat
",sql,linq,,,,04/20/2012 05:34:53,too localized,1,88,6,"converting the SQL Query to LINQ hi i am new to development. 

i need to convert the following SQL Query to LINQ query

    SELECT Distinct c.CompanyName, c.Email, c.FirstName, c.ConnectionString,
    (SELECT COUNT(*) FROM OZT_Users_Clients as cvm 
    join OZT_Users cam on cvm.UserID = cam.UserID
    WHERE cam.Active =1 and cvm.ClientID = c.ClientID) 
    as [Number of Active Users] FROM OZT_Clients as c 
    group by c.CompanyName, c.Email, c.FirstName, c.ConnectionString, c.ClientID

please help me in converting this to LINQ. 

Thanks,
abivenkat
",2
8437467,12/08/2011 20:44:58,868235,07/28/2011 20:06:22,49,0,I'm building my first SQL server with Linux. Which would be the best distro for this machine?,"It's basically a educational situation: 
We've got a Intel Celeron 2.5Ghz / 512 MB RAM / >40GB Hard Drive. 
We need to set up a basic SQL server for 5~15 LAN users with a >1GB database. 

I can use debian, fedora, freeBSD, mandrake, opensuse, redhat, slackware, suse or ubuntu with firebird, mysql or postgreSQL. 

[btw: it's a corporate decision, I can't pick anything else besides the one listed. What I can do is ask for support for another software - This is something that looks interesting since I believe that MariaDB w/ Slackware would be the best choice)

I basically need the most lightweight solution possible. 

I'm thinking about Slackware with PostgreSQL, but I was wondering which one would be less dependent on hardware specs and easiest to manage, the traffic flow itself won't be very high but the database will have to up for tests for at least a semester or two before we can apply for a dedicated server.. 
",sql,linux,server,,,12/08/2011 22:15:06,not constructive,1,161,17,"I'm building my first SQL server with Linux. Which would be the best distro for this machine? It's basically a educational situation: 
We've got a Intel Celeron 2.5Ghz / 512 MB RAM / >40GB Hard Drive. 
We need to set up a basic SQL server for 5~15 LAN users with a >1GB database. 

I can use debian, fedora, freeBSD, mandrake, opensuse, redhat, slackware, suse or ubuntu with firebird, mysql or postgreSQL. 

[btw: it's a corporate decision, I can't pick anything else besides the one listed. What I can do is ask for support for another software - This is something that looks interesting since I believe that MariaDB w/ Slackware would be the best choice)

I basically need the most lightweight solution possible. 

I'm thinking about Slackware with PostgreSQL, but I was wondering which one would be less dependent on hardware specs and easiest to manage, the traffic flow itself won't be very high but the database will have to up for tests for at least a semester or two before we can apply for a dedicated server.. 
",3
4153733,11/11/2010 11:05:45,129289,06/26/2009 08:44:44,1053,42,sql - adding time interval with skipping of certain period,"I have a mySql query which adds certain interval of time to datetime field. 

    UPDATE table T SET T.ending = DATE_ADD(T.ending, INTERVAL T.hours * 3600 * some_other_variable_factors SECONDS)) 

Now, I need to detect if new ending time is in between some hours (let's say 20:00 to 06:00), which should be excluded from calculation.

*Ie. if old ending is today, 19:58 and we are adding 4 minutes, new ending should be tomorrow, 06:02*  

Additional difficulty is that amount of time to add can be bigger than 24 hours. *So if old ending is today, 19.00 and we are adding 24 hours, new ending should be day after  tomorrow, 15.00* (which sounds as a title of a really bad movie ;)

Is there way to achieve this in mysql? In one query? I was also thinking about stored procedures, but i do not have any experience with. ",sql,mysql,datetime,stored-procedures,time,,open,0,150,10,"sql - adding time interval with skipping of certain period I have a mySql query which adds certain interval of time to datetime field. 

    UPDATE table T SET T.ending = DATE_ADD(T.ending, INTERVAL T.hours * 3600 * some_other_variable_factors SECONDS)) 

Now, I need to detect if new ending time is in between some hours (let's say 20:00 to 06:00), which should be excluded from calculation.

*Ie. if old ending is today, 19:58 and we are adding 4 minutes, new ending should be tomorrow, 06:02*  

Additional difficulty is that amount of time to add can be bigger than 24 hours. *So if old ending is today, 19.00 and we are adding 24 hours, new ending should be day after  tomorrow, 15.00* (which sounds as a title of a really bad movie ;)

Is there way to achieve this in mysql? In one query? I was also thinking about stored procedures, but i do not have any experience with. ",5
4875973,02/02/2011 15:03:25,600180,02/02/2011 15:03:25,1,0,"Getting Wordpress posts in a category, ordered by custom field","I am a newbie with WordPress and am trying to modify the standard SQL call for for custom field data posts to limit by category. Here is what I am basing my attempts on, but i just can't figure out how to filter for category 15.

$querystr = ""
SELECT wposts.*
FROM $wpdb->posts wposts, $wpdb->postmeta wpostmeta
WHERE wposts.ID = wpostmeta.post_id
AND wpostmeta.meta_key = 'priority'
AND wposts.post_type = 'post'
AND wposts.post_status = 'publish'
AND wposts.
ORDER BY wpostmeta.meta_value ASC
"";
",sql,wordpress,categories,,,,open,0,69,10,"Getting Wordpress posts in a category, ordered by custom field I am a newbie with WordPress and am trying to modify the standard SQL call for for custom field data posts to limit by category. Here is what I am basing my attempts on, but i just can't figure out how to filter for category 15.

$querystr = ""
SELECT wposts.*
FROM $wpdb->posts wposts, $wpdb->postmeta wpostmeta
WHERE wposts.ID = wpostmeta.post_id
AND wpostmeta.meta_key = 'priority'
AND wposts.post_type = 'post'
AND wposts.post_status = 'publish'
AND wposts.
ORDER BY wpostmeta.meta_value ASC
"";
",3
1808386,11/27/2009 12:08:20,156073,08/13/2009 20:28:52,58,0,SQL query problem,"I have two tables:

  

      emp (empno,ename)
        address(empno,address)

emp can have 0 or more address.

I want to print a result as follows:

- when emp has  0 address then: eno,ename,""no address""
- when emp has  1 or more address then: enomename ,""address found""

I am using oracle 9db







",sql,,,,,11/27/2009 12:31:12,not a real question,1,59,3,"SQL query problem I have two tables:

  

      emp (empno,ename)
        address(empno,address)

emp can have 0 or more address.

I want to print a result as follows:

- when emp has  0 address then: eno,ename,""no address""
- when emp has  1 or more address then: enomename ,""address found""

I am using oracle 9db







",1
10301649,04/24/2012 16:02:57,760445,05/19/2011 06:15:48,27,7,How SELECT query exactly works?,"Can some one explain to me how the SELECT query actually works and to find answers for the following questions? How does it return the result set? What is the default order it returns the result set??..Does it randomly return the order or some kind of a preserved order??
Does it depend on the different storage engine type??",sql,database,query,,,04/25/2012 02:33:07,not a real question,1,57,5,"How SELECT query exactly works? Can some one explain to me how the SELECT query actually works and to find answers for the following questions? How does it return the result set? What is the default order it returns the result set??..Does it randomly return the order or some kind of a preserved order??
Does it depend on the different storage engine type??",3
5192872,03/04/2011 11:03:00,219519,11/26/2009 15:51:17,184,6,Using extra() on ValuesQuerySet in Django,"I'm trying to calculate a percentage with two values which are themselves aggregated. The SQL query that explains what I'm after is as follows:

    SELECT (SUM(field_a) / SUM(field_b) * 100) AS percent
    FROM myapp_mymodel 
    GROUP BY field_c
    ORDER BY field_c

I tried to use the following to construct a QuerySet, but unfortunately it doesn't contain the extra field:
 

    MyModel.objects.values('field_c').annotate(
       sum_field_a=Sum('field_a'),
       sum_field_b=Sum('field_b')).extra(
          select={'percent': 'sum_field_a / sum_field_b * 100'})

What irritates me is that - according to the Django documentation - this seems to be the way to go:


> When a values() clause is used to
> constrain the columns that are
> returned in the result set […] 
> instead of returning an
> annotated result for each result in
> the original QuerySet, the original
> results are grouped according to the
> unique combinations of the fields
> specified in the values() clause. An
> annotation is then provided for each
> unique group; the annotation is
> computed over all members of the
> group.
>
> _Source:_ http://docs.djangoproject.com/en/dev/topics/db/aggregation/#values

> If you use a values() clause after an extra() clause, any fields defined by a select argument in the extra() must be explicitly included in the values() clause. However, if the extra() clause is used after the values(), the fields added by the select will be included automatically.
>
> _Source:_ http://docs.djangoproject.com/en/dev/ref/models/querysets/#values",sql,django,django-queryset,values,extra,,open,0,244,6,"Using extra() on ValuesQuerySet in Django I'm trying to calculate a percentage with two values which are themselves aggregated. The SQL query that explains what I'm after is as follows:

    SELECT (SUM(field_a) / SUM(field_b) * 100) AS percent
    FROM myapp_mymodel 
    GROUP BY field_c
    ORDER BY field_c

I tried to use the following to construct a QuerySet, but unfortunately it doesn't contain the extra field:
 

    MyModel.objects.values('field_c').annotate(
       sum_field_a=Sum('field_a'),
       sum_field_b=Sum('field_b')).extra(
          select={'percent': 'sum_field_a / sum_field_b * 100'})

What irritates me is that - according to the Django documentation - this seems to be the way to go:


> When a values() clause is used to
> constrain the columns that are
> returned in the result set […] 
> instead of returning an
> annotated result for each result in
> the original QuerySet, the original
> results are grouped according to the
> unique combinations of the fields
> specified in the values() clause. An
> annotation is then provided for each
> unique group; the annotation is
> computed over all members of the
> group.
>
> _Source:_ http://docs.djangoproject.com/en/dev/topics/db/aggregation/#values

> If you use a values() clause after an extra() clause, any fields defined by a select argument in the extra() must be explicitly included in the values() clause. However, if the extra() clause is used after the values(), the fields added by the select will be included automatically.
>
> _Source:_ http://docs.djangoproject.com/en/dev/ref/models/querysets/#values",5
7204847,08/26/2011 12:49:00,292982,03/13/2010 14:46:49,1111,64,"SQL Server Server 2008 R2 - Parallel datawarehouse - materials, blogs, literature sources","I tried searching stack overflow for a similar topic as well as web but there is suprisingly small amount of material on PDW features voew the Web. So to all the users and implementators of PDW and PDW specific features: What are Your sources of information, reading and learning about Sql Server 2008 r2 parallel features?

I know that modeling a large (100TB warehouse) is a material for a case study rather than a book, but maybe there are blogs about warehousing specific to PDW implementations and books about implementing a warehouse using the new PDW features.

I am not interested in regular SQL Server 2008 books, blogs. I have plenty of those. I am interested in specific PDW architecture, features and how to use them in DW implementations (i am familiar with DW modeling and building principles both Star/snowflake and 3NF model).

luke",sql,sql-server-2008,self-improvement,data-warehouse,,02/08/2012 14:28:29,not constructive,1,141,13,"SQL Server Server 2008 R2 - Parallel datawarehouse - materials, blogs, literature sources I tried searching stack overflow for a similar topic as well as web but there is suprisingly small amount of material on PDW features voew the Web. So to all the users and implementators of PDW and PDW specific features: What are Your sources of information, reading and learning about Sql Server 2008 r2 parallel features?

I know that modeling a large (100TB warehouse) is a material for a case study rather than a book, but maybe there are blogs about warehousing specific to PDW implementations and books about implementing a warehouse using the new PDW features.

I am not interested in regular SQL Server 2008 books, blogs. I have plenty of those. I am interested in specific PDW architecture, features and how to use them in DW implementations (i am familiar with DW modeling and building principles both Star/snowflake and 3NF model).

luke",4
11078631,06/18/2012 07:36:12,1463012,06/18/2012 07:29:20,1,0,SQL Server Management Studio Trial Version,"I have SQL Server 2008 running fine.  I then installed SQL Server 2008 R2 120 day trial.

This removed my SQL Server 2008 management studio and replaced it with the new version.

The trial has now expired so I have no management studio.  I uninstalled R2 trial and reinstalled 2008 managemnet studio only but when I try and run this it says the 120 trial has expired!

Any ideas please?",sql,server,,,,06/18/2012 23:52:05,off topic,1,69,6,"SQL Server Management Studio Trial Version I have SQL Server 2008 running fine.  I then installed SQL Server 2008 R2 120 day trial.

This removed my SQL Server 2008 management studio and replaced it with the new version.

The trial has now expired so I have no management studio.  I uninstalled R2 trial and reinstalled 2008 managemnet studio only but when I try and run this it says the 120 trial has expired!

Any ideas please?",2
10416762,05/02/2012 15:22:55,656523,03/12/2011 11:29:15,99,0,Accuracy in rounding numbers,"I have the following requirement-

    1. Get the A_MINUTES column value from TableA for all rows 
    2. Sum the A_MINUTES. 
    3. Convert the summed minutes values to hours - divide by 60 
    4. Round off the final hours value to 2 decimal places.

 

This needs to be written in SQL. 

Do you think this query will have any rounding errors?

    SELECT ROUND ( (SUM(A_MINUTES)/60.0) , 2) FROM TABLEA

 ",sql,rounding,accuracy,,,05/03/2012 19:18:00,not a real question,1,87,4,"Accuracy in rounding numbers I have the following requirement-

    1. Get the A_MINUTES column value from TableA for all rows 
    2. Sum the A_MINUTES. 
    3. Convert the summed minutes values to hours - divide by 60 
    4. Round off the final hours value to 2 decimal places.

 

This needs to be written in SQL. 

Do you think this query will have any rounding errors?

    SELECT ROUND ( (SUM(A_MINUTES)/60.0) , 2) FROM TABLEA

 ",3
11416933,07/10/2012 15:39:27,1357627,04/26/2012 02:46:00,6,0,sql bulk delete is much slower?,"I have a DB that is about 3.5GB. 2 tables use most spaces. each table has about 2.8M rows. now I need to delete about 1.9M rows from each table. using the batch delete

* DELETE TOP (n) syntax, then loop until now more needs to be deleted

it seems we controlled the log size problem. however,  the performance downgraded a lot. for example, if I delete the data from the first table A in one batch (delete from ...), it takes about 9 minutes. Now, if I delete in a batch of 2000, after the whole night, it does not finish yet. If I get the # of rows that will be deleted, then batch delete 10% of it in each loop (so, about 200,000 for each batch), it takes about 40 minutes.

Is this normal? one thing I want to point out is: there is no primary key in these 2 tables, although they have non-cluster index. it was designed by previous developer who never thought we would have so much data to process. Now, we have to live with this, change database structure is not an option. Could it because of this that makes the delete slow?

Any suggest of what can cause the slow?


Thanks.",sql,sql-server,,,,07/11/2012 17:17:33,off topic,1,205,6,"sql bulk delete is much slower? I have a DB that is about 3.5GB. 2 tables use most spaces. each table has about 2.8M rows. now I need to delete about 1.9M rows from each table. using the batch delete

* DELETE TOP (n) syntax, then loop until now more needs to be deleted

it seems we controlled the log size problem. however,  the performance downgraded a lot. for example, if I delete the data from the first table A in one batch (delete from ...), it takes about 9 minutes. Now, if I delete in a batch of 2000, after the whole night, it does not finish yet. If I get the # of rows that will be deleted, then batch delete 10% of it in each loop (so, about 200,000 for each batch), it takes about 40 minutes.

Is this normal? one thing I want to point out is: there is no primary key in these 2 tables, although they have non-cluster index. it was designed by previous developer who never thought we would have so much data to process. Now, we have to live with this, change database structure is not an option. Could it because of this that makes the delete slow?

Any suggest of what can cause the slow?


Thanks.",2
9101795,02/01/2012 19:16:48,1183513,02/01/2012 19:07:18,1,0,Combining 2 Views into 1 View in Postgres,"so I need to do something completely insane. I have 2 Views that have the same number of columns (different column names though except the ID column) and they happen to have
both have 2 existing UNION queries, from my understanding UNION and UNION ALL only work when combining 2 SELECT Queries, here I'm trying to combine 4 of them! Aka The 2 Views.

help would be highly appreciated.",sql,postgresql,views,pgadmin3,pgadmin,,open,0,67,8,"Combining 2 Views into 1 View in Postgres so I need to do something completely insane. I have 2 Views that have the same number of columns (different column names though except the ID column) and they happen to have
both have 2 existing UNION queries, from my understanding UNION and UNION ALL only work when combining 2 SELECT Queries, here I'm trying to combine 4 of them! Aka The 2 Views.

help would be highly appreciated.",5
7550790,09/26/2011 04:58:29,871317,07/31/2011 06:02:18,13,2,Why can't I find SQL Server Management Studio after installation?,So I downloaded Microsoft SQL Server 2008 R2 on a new computer I have to be using and when I go to Start -> Programs -> Microsoft SQL Server 2008 R2 I don't see SQL Server Management Studio. I followed the step by step installation and configuration. Why can't I find the program? What am I missing?,sql,server,microsoft,,,11/16/2011 10:06:50,off topic,1,57,10,Why can't I find SQL Server Management Studio after installation? So I downloaded Microsoft SQL Server 2008 R2 on a new computer I have to be using and when I go to Start -> Programs -> Microsoft SQL Server 2008 R2 I don't see SQL Server Management Studio. I followed the step by step installation and configuration. Why can't I find the program? What am I missing?,3
11332891,07/04/2012 16:45:40,1464357,06/18/2012 17:19:47,1,0,I want sql code to calculate leave compliance on a quartely basis,"I want sql code to calculate leave compliance per manager in percenatge on a quartely basis,as some employees might accept the leave compliance so to calculate those ones that accepted/total number of employees per manager in the 1st quarter(Januar-Marh)",sql,,,,,07/04/2012 20:50:43,not a real question,1,39,12,"I want sql code to calculate leave compliance on a quartely basis I want sql code to calculate leave compliance per manager in percenatge on a quartely basis,as some employees might accept the leave compliance so to calculate those ones that accepted/total number of employees per manager in the 1st quarter(Januar-Marh)",1
5352313,03/18/2011 13:00:24,666073,03/18/2011 13:00:24,1,0,How to calculate Last Week of Month by WeekNO and Year in SQL,"I want to calculate Last Week Number of Month in SQL. I am having Week Number and Year.

Eg. If I pass WeekNo=51 , Year=2008 , than function should return LastWeekofMonth= 52.

I want to calculate Week number using below standards.

According to ISO 8601:1988 that is used in Sweden the first week of the year is the first week that has at least four days within the new year.

So if your week starts on a Monday the first Thursday any year is within the first week. You can DateAdd or DateDiff from that.

Please Help me..........

Thanks in advance.",sql,,,,,,open,0,95,13,"How to calculate Last Week of Month by WeekNO and Year in SQL I want to calculate Last Week Number of Month in SQL. I am having Week Number and Year.

Eg. If I pass WeekNo=51 , Year=2008 , than function should return LastWeekofMonth= 52.

I want to calculate Week number using below standards.

According to ISO 8601:1988 that is used in Sweden the first week of the year is the first week that has at least four days within the new year.

So if your week starts on a Monday the first Thursday any year is within the first week. You can DateAdd or DateDiff from that.

Please Help me..........

Thanks in advance.",1
9950778,03/30/2012 21:43:45,1301850,03/29/2012 20:47:42,1,0,SQL XML Replacing elements,"Please help! Is it possible to replace elements within an xml field of an sql database with other elements.  I have tried using .modify(replace value of) but I can only replace text within elements rather than nodes.

Ultimately I am trying to update an element which may or may not contain other elements, with another element (possibly of the same name) within an XML field. (I am using SQL Server 2008)

E.g:

    <Root>
      <Sub>
        <Value1>
        </Value1>
        <Value2>
        </Value2>
        <Value3>
        </Value3>
      </Sub>
    </Root>

Would be replaced by:

    <Root>
      <SubVERSION2>
        <Value1>
        </Value1>
        <Value2>
        </Value2>
        <Value3>
        </Value3>
      </SubVERSION2>
    </Root>

Any help would be very much appreciated!
",sql,xml,sql-server-2008,xpath,xquery,,open,0,216,4,"SQL XML Replacing elements Please help! Is it possible to replace elements within an xml field of an sql database with other elements.  I have tried using .modify(replace value of) but I can only replace text within elements rather than nodes.

Ultimately I am trying to update an element which may or may not contain other elements, with another element (possibly of the same name) within an XML field. (I am using SQL Server 2008)

E.g:

    <Root>
      <Sub>
        <Value1>
        </Value1>
        <Value2>
        </Value2>
        <Value3>
        </Value3>
      </Sub>
    </Root>

Would be replaced by:

    <Root>
      <SubVERSION2>
        <Value1>
        </Value1>
        <Value2>
        </Value2>
        <Value3>
        </Value3>
      </SubVERSION2>
    </Root>

Any help would be very much appreciated!
",5
2851242,05/17/2010 17:25:25,343296,05/17/2010 17:25:25,1,0,Grouping records by subsets SQL,"I have a database with PermitHolders (PermitNum = PK) and DetailedFacilities of each Permit Holder.  In the tblPermitDetails table there are 2 columns, 1. PermitNum (foreign Key), 2. FacilityID (integer Foreign Key Lookup to Facility table).  A permitee can have 1 - 29 items on their permit, e.i.  Permit 50 can have a Boat Dock (FacID 4), a Paved walkway (FacID 17) a Retaining Wall (FacID 20) etc.  I need an SQL filter/display whatever, ALL PERMIT #s that have ONLY FacIDs 19, 20, or 28, NOT ones that have those plus ""x"" others,....just that subset.  I've worked on this for 4 days, would someone PLEASE help me?  I HAVE posted to other BB but have not received any helpful suggestions.

Thanks,
Stacy",sql,,,,,,open,0,126,5,"Grouping records by subsets SQL I have a database with PermitHolders (PermitNum = PK) and DetailedFacilities of each Permit Holder.  In the tblPermitDetails table there are 2 columns, 1. PermitNum (foreign Key), 2. FacilityID (integer Foreign Key Lookup to Facility table).  A permitee can have 1 - 29 items on their permit, e.i.  Permit 50 can have a Boat Dock (FacID 4), a Paved walkway (FacID 17) a Retaining Wall (FacID 20) etc.  I need an SQL filter/display whatever, ALL PERMIT #s that have ONLY FacIDs 19, 20, or 28, NOT ones that have those plus ""x"" others,....just that subset.  I've worked on this for 4 days, would someone PLEASE help me?  I HAVE posted to other BB but have not received any helpful suggestions.

Thanks,
Stacy",1
10705097,05/22/2012 15:24:50,777982,05/31/2011 15:53:56,1214,166,What am I doing wrong SQL query pulls null records,"When I run this condition
    
    and A.[ID] = @ID
    and 
     ((datediff(dd, startDate, B.MeterStart) < 0) /* flaw in start date */
      or 
     ( (A.[End Date] is not null) and (B.MeterEnd > A.[End Date] ))) /* flaw in end date */

I am pull all records where there is problem in start date and end date. End date is not filled for all accont so I am applying the condition `(A.[End Date] is not null)` to make null end dates are not pulled, but they are still pulled. Why? Is their problem with this syntax?

",sql,sql-server-2005,,,,06/22/2012 19:35:50,too localized,1,118,10,"What am I doing wrong SQL query pulls null records When I run this condition
    
    and A.[ID] = @ID
    and 
     ((datediff(dd, startDate, B.MeterStart) < 0) /* flaw in start date */
      or 
     ( (A.[End Date] is not null) and (B.MeterEnd > A.[End Date] ))) /* flaw in end date */

I am pull all records where there is problem in start date and end date. End date is not filled for all accont so I am applying the condition `(A.[End Date] is not null)` to make null end dates are not pulled, but they are still pulled. Why? Is their problem with this syntax?

",2
1869479,12/08/2009 20:05:07,18132,09/18/2008 19:12:18,16,3,"Database design question, using multiple tables or XML","Imaging the following 3 relationships in a data model

Entity > Path > Link

Both relationships are 1 to many.  So Entity has multiple paths and a path has multiple links.

Should I do this as 3 tables with relationships between the tables

Or create a table that stores that path information as XML.

This table (lets call it Paths), will store 1 path/row.  So we end up with 2 tables instead of 3: Entity > Path

The XML looks something like this:

    <path>
       <link entitySource=1 entityTarget=2>
       <link entitySource=2 entityTarget=6>
       <link entitySource=6 entityTarget=9>
    </path>

What are the benefits of each design?  I want to use the 3-table design and need a good explanation to convince the CTO why I should.  He is convinced that the XML route is a better design because it will reduce database joins and hence improve read performance.

Read performance is important because this table will be used to store millions of records and needs to be searched quickly.",sql,xml,database,database-design,,,open,0,183,8,"Database design question, using multiple tables or XML Imaging the following 3 relationships in a data model

Entity > Path > Link

Both relationships are 1 to many.  So Entity has multiple paths and a path has multiple links.

Should I do this as 3 tables with relationships between the tables

Or create a table that stores that path information as XML.

This table (lets call it Paths), will store 1 path/row.  So we end up with 2 tables instead of 3: Entity > Path

The XML looks something like this:

    <path>
       <link entitySource=1 entityTarget=2>
       <link entitySource=2 entityTarget=6>
       <link entitySource=6 entityTarget=9>
    </path>

What are the benefits of each design?  I want to use the 3-table design and need a good explanation to convince the CTO why I should.  He is convinced that the XML route is a better design because it will reduce database joins and hence improve read performance.

Read performance is important because this table will be used to store millions of records and needs to be searched quickly.",4
6815184,07/25/2011 11:13:09,153086,08/08/2009 21:14:12,474,5,User defined function returning null in sql server,"I've created a user defined scalar function in sql server 2005, and I want it to return me the id based on the passing parameter name. But the following function always returns me null, even the passing name already exists in table. Could anyone please tell me the reason?

    create function IsNameExist(@Name varchar)
    returns int
    As
    Begin
    Declare @Id int
    Select @Id = ProductId from [Product] where ProductName = @Name
    return @Id
    End",sql,sql-server,sql-server-2005,function,,,open,0,97,8,"User defined function returning null in sql server I've created a user defined scalar function in sql server 2005, and I want it to return me the id based on the passing parameter name. But the following function always returns me null, even the passing name already exists in table. Could anyone please tell me the reason?

    create function IsNameExist(@Name varchar)
    returns int
    As
    Begin
    Declare @Id int
    Select @Id = ProductId from [Product] where ProductName = @Name
    return @Id
    End",4
11569882,07/19/2012 21:51:29,438055,09/02/2010 14:05:20,63,0,Cant attach the sample database in sql server 2012,"I have downloaded the sample database for Sql Server 2012 Express but I am having the following error message whenever I try to attach it. 

   The database 'AdventureWorks2012' cannot be opened because it is version 706. This server  supports version 655 and earlier. A downgrade path is not supported.

Kindly help me.",sql,sql-server,sql-server-2012,sql-server-2012-express,,07/22/2012 10:33:44,not constructive,1,55,9,"Cant attach the sample database in sql server 2012 I have downloaded the sample database for Sql Server 2012 Express but I am having the following error message whenever I try to attach it. 

   The database 'AdventureWorks2012' cannot be opened because it is version 706. This server  supports version 655 and earlier. A downgrade path is not supported.

Kindly help me.",4
2779244,05/06/2010 07:26:25,20879,09/23/2008 03:20:04,353,11,Getting the most recent entry per group in a select statement,"I have 3 tables to join to get table1.code, table1.series, table2.entry_date, table3.title1
and I'm trying to get the most recent non null table3.title1 grouped by table1.code and table1.series.

    select table1.code, table1.series, max(table2.entry_date), table3.Title1 
                    from table3 INNER JOIN table2 ON  table3.ID = table2.ID
                    INNER JOIN table1 ON table2.source_code = table1.code
                    where table3.Title1 is not NULL 
                    group by table1.code, table1.series, table3.Title1

seems to give me all entries with a non null title1 instead of the most recent one. How should I structure the query to just pick the newest version of Title1 per code & series? 

              


",sql,tsql,sql-server,,,,open,0,189,11,"Getting the most recent entry per group in a select statement I have 3 tables to join to get table1.code, table1.series, table2.entry_date, table3.title1
and I'm trying to get the most recent non null table3.title1 grouped by table1.code and table1.series.

    select table1.code, table1.series, max(table2.entry_date), table3.Title1 
                    from table3 INNER JOIN table2 ON  table3.ID = table2.ID
                    INNER JOIN table1 ON table2.source_code = table1.code
                    where table3.Title1 is not NULL 
                    group by table1.code, table1.series, table3.Title1

seems to give me all entries with a non null title1 instead of the most recent one. How should I structure the query to just pick the newest version of Title1 per code & series? 

              


",3
5822352,04/28/2011 17:04:33,729769,04/28/2011 16:58:33,1,0,Insert Data Into Sql Server With DataGrid In Vb.net,"I want Insert Multi Data Into Table In Sql Server
So I Use DataGrid , I Test Lot Of Codes But Don't Work , Can Somebody Give Me Exemple , To Start !!",sql,vb.net,datagrid,,,05/27/2011 13:32:28,not a real question,1,32,9,"Insert Data Into Sql Server With DataGrid In Vb.net I want Insert Multi Data Into Table In Sql Server
So I Use DataGrid , I Test Lot Of Codes But Don't Work , Can Somebody Give Me Exemple , To Start !!",3
9078127,01/31/2012 10:39:48,1162524,01/21/2012 16:35:45,1,0,about sql query is below query correct?,"  $query = ""INSERT INTO add (`category`,`subcategory`,`selectapet`,`breed`,`title`,`description`,`inthisad`,`sizeatmaturity`,`age`,`gender`,`price`,`picture`,`email`,`name`,`mobile`,`phone`,`address`,`city`,`state`,`country`) VALUES (Now(),'$category', '$subcategory', '$selectapet','$breed','$title','$description','$inthisad','$sizeatmaturity','$age','$gender','$price','$picture','$email','$name','$mobile','$phone','$address','$city','$state','$country')"" or die ('Data not inserted.'); id this query correct",sql,,,,,02/01/2012 02:08:43,not constructive,1,21,7,"about sql query is below query correct?   $query = ""INSERT INTO add (`category`,`subcategory`,`selectapet`,`breed`,`title`,`description`,`inthisad`,`sizeatmaturity`,`age`,`gender`,`price`,`picture`,`email`,`name`,`mobile`,`phone`,`address`,`city`,`state`,`country`) VALUES (Now(),'$category', '$subcategory', '$selectapet','$breed','$title','$description','$inthisad','$sizeatmaturity','$age','$gender','$price','$picture','$email','$name','$mobile','$phone','$address','$city','$state','$country')"" or die ('Data not inserted.'); id this query correct",1
5949095,05/10/2011 11:11:29,732360,04/30/2011 12:00:43,11,0,Sql Backup Need,"We Have A Server Named ""Exserver""
Now I Want To Take Backup Of A Database Which Is On Exserver Named ""User""
And I Want To Take That Backup On My Local Pc's Hard Drive 
How Could I Do That????",sql,sql-server-2008,server,,,05/10/2011 22:32:49,off topic,1,37,3,"Sql Backup Need We Have A Server Named ""Exserver""
Now I Want To Take Backup Of A Database Which Is On Exserver Named ""User""
And I Want To Take That Backup On My Local Pc's Hard Drive 
How Could I Do That????",3
8052064,11/08/2011 14:38:18,1010655,10/24/2011 10:25:14,1,0,What are the steps or best pracices to follow while moving SQL Server to all new Server having less down time?,"I have many things configured on current sql server. I know configuring these manually. Is there a way to configure all at once on new server?

1. Logins -- Here a user having only read access on a DB and for some particular user is having R/W access on a particular table. Similarly Execute Permissions on some specific stored procs. How can manage this on new sql server?
2. Jobs --How to script all at once ?
3. Database Mail 
4. Linked Servers 
5. Log Shipping
6. Operators 
7. Maintenance Plans
8. SSIS Packages -- Packages currently residing on File System on same server and accessing in some SQL Jobs.
9. Windows Scheduled Tasks --How to move all tasks to new server at once?
10. Shared Folders on Network -- How to configure sharing permissions on a folder, since many users are accessing shared folder on server some with full control & some with only read access.
",sql,sql-server-2008,automation,,,11/08/2011 17:53:38,off topic,1,150,21,"What are the steps or best pracices to follow while moving SQL Server to all new Server having less down time? I have many things configured on current sql server. I know configuring these manually. Is there a way to configure all at once on new server?

1. Logins -- Here a user having only read access on a DB and for some particular user is having R/W access on a particular table. Similarly Execute Permissions on some specific stored procs. How can manage this on new sql server?
2. Jobs --How to script all at once ?
3. Database Mail 
4. Linked Servers 
5. Log Shipping
6. Operators 
7. Maintenance Plans
8. SSIS Packages -- Packages currently residing on File System on same server and accessing in some SQL Jobs.
9. Windows Scheduled Tasks --How to move all tasks to new server at once?
10. Shared Folders on Network -- How to configure sharing permissions on a folder, since many users are accessing shared folder on server some with full control & some with only read access.
",3
5541519,04/04/2011 16:35:07,468972,10/07/2010 10:49:26,1,0,SQL Server native client 10.0 versus OleDb differences?,"We have an SQL Server 2008 R1 Environment.

We have poorly performing queries across linked servers which are quite complex.

First question:
Are there any differences between (particularly performance) of SQL native client 10.0 and the listing for oledb within linked servers? My understanding of this was that Native client just packages up oledb with some other items. But I would appreciate some guidance.

Additionally does anyone know where to find some good white papers on optimising Linked server queries?

many thanks
D",sql,performance,linked-server,,,,open,0,77,8,"SQL Server native client 10.0 versus OleDb differences? We have an SQL Server 2008 R1 Environment.

We have poorly performing queries across linked servers which are quite complex.

First question:
Are there any differences between (particularly performance) of SQL native client 10.0 and the listing for oledb within linked servers? My understanding of this was that Native client just packages up oledb with some other items. But I would appreciate some guidance.

Additionally does anyone know where to find some good white papers on optimising Linked server queries?

many thanks
D",3
1572927,10/15/2009 14:56:00,42229,12/01/2008 19:54:24,289,16,SQL - Converting military time into regular time and inserting : in the appropriate place,"I have 2 fields I'm working with that are stored as smallint military structured times.

beg_tm and end_tm

Sample values<br>

    beg_tm   545
    end_tm   815
    
    beg_tm   1245
    end_tm   1330

Sample output<br>

    beg_tm   5:45 am
    end_tm   8:15 am
    
    beg_tm   12:45 pm
    end_tm   1:30 pm

I had this working in Perl, but I'm looking for a way to do it with SQL and case statements.

Is this even possible?",sql,formatting,military,time,,,open,0,109,15,"SQL - Converting military time into regular time and inserting : in the appropriate place I have 2 fields I'm working with that are stored as smallint military structured times.

beg_tm and end_tm

Sample values<br>

    beg_tm   545
    end_tm   815
    
    beg_tm   1245
    end_tm   1330

Sample output<br>

    beg_tm   5:45 am
    end_tm   8:15 am
    
    beg_tm   12:45 pm
    end_tm   1:30 pm

I had this working in Perl, but I'm looking for a way to do it with SQL and case statements.

Is this even possible?",4
9736505,03/16/2012 11:34:51,1147410,01/13/2012 09:54:22,100,2,SQL Decimal Confusion,"Could someone help me clear up some confusion...

I want to put in some decimal values into Ms SQL... These decimals can be from 0.0001 to 1.9999

Do I set my data type to:

Decimal(1,4) meaning 1 digit before the point and 4 after

or 

Decimal(5,4) meaning 5 total digits with 4 digits after the point.


Thanks!",sql,,,,,03/16/2012 11:41:08,too localized,1,52,3,"SQL Decimal Confusion Could someone help me clear up some confusion...

I want to put in some decimal values into Ms SQL... These decimals can be from 0.0001 to 1.9999

Do I set my data type to:

Decimal(1,4) meaning 1 digit before the point and 4 after

or 

Decimal(5,4) meaning 5 total digits with 4 digits after the point.


Thanks!",1
8682787,12/30/2011 18:39:55,1118485,12/28/2011 00:25:06,6,0,How can I create a Stored Procedure where returns a table?,"I stared doing this using a Function. But as I'm using entity frameworks, I only can create functions using stored procedures.

Thanks in advance.",sql,sql-server,sql-server-2008,,,12/30/2011 19:31:38,not a real question,1,23,11,"How can I create a Stored Procedure where returns a table? I stared doing this using a Function. But as I'm using entity frameworks, I only can create functions using stored procedures.

Thanks in advance.",3
3999044,10/22/2010 16:45:47,484455,10/22/2010 16:45:47,1,0,TSQL - Locating first occurrence of value in a string,"I need to run a simple select statement for a column called AddrZip to show all records that contain  '1/2 ' after the first space in the column. In Access 2007 it would be **Left([Names],InStr(1,[Names],"" "")-1), but can't find out how to do it in SQL 2005. All help will be appreciated.",sql,string,select,left,,,open,0,53,10,"TSQL - Locating first occurrence of value in a string I need to run a simple select statement for a column called AddrZip to show all records that contain  '1/2 ' after the first space in the column. In Access 2007 it would be **Left([Names],InStr(1,[Names],"" "")-1), but can't find out how to do it in SQL 2005. All help will be appreciated.",4
11475338,07/13/2012 17:22:22,236499,12/22/2009 01:41:35,471,24,Maximum of tables a SQLite database file supports,"Even after reading [SQLite limits][1] I could not find the **maximum number of tables** a SQLite database file can hold. So, I'd like to know if

1. There is a maximum number of tables a SQLite database can hold?
2. It is an issue to have thousands of small tables in a SQLite database file?
3. Many tables in a SQLite database file can impact performance of queries?


  [1]: http://www.sqlite.org/limits.html",sql,database,sqlite,sqlite3,,,open,0,68,8,"Maximum of tables a SQLite database file supports Even after reading [SQLite limits][1] I could not find the **maximum number of tables** a SQLite database file can hold. So, I'd like to know if

1. There is a maximum number of tables a SQLite database can hold?
2. It is an issue to have thousands of small tables in a SQLite database file?
3. Many tables in a SQLite database file can impact performance of queries?


  [1]: http://www.sqlite.org/limits.html",4
5937860,05/09/2011 13:54:40,690766,04/04/2011 08:33:41,27,0,Identifying duplicate combinations for n-field data table on Oracle,"I managed to make up sql query to update duplicate rows containing combinations to null value for 2-field table. However, I am stuck with more than 2-field table. <br>
My 2-field solution is:<br>
*Inserting test data for combinations' table:*<br>
<code>
create table combinations as <br>
select 1 col1, 2 col2 from dual --*row1* <br>
union all <br>
select 2, 1 from dual --*row2*<br>
union all <br>
select 1, 3 from dual --*row3*<br>
union all <br>
select 1,4 from dual; --*row4*</code><br>
From combinations' table row1 and row2 are duplicate because ordering of elements doesn't matter.
</code><br>
*Updating duplicate combinations to null for 2 fields (updating row2 to null):*
<code><br>
update combinations <br>set col1=null, col2=null <br>
where rowid IN(<br>
select x.rid from (<br>
    select <br>
        rowid rid, <br>
        col1, <br>
        col2, <br>
        row_number() over (partition by least(col1,col2), greatest(col1,col2) order by rownum) duplicate_row <br>
    from combinations) x <br>
where duplicate_row > 1);<br>
</code><br>
My code above depends on least(,) and greatest(,) functions and that's why it works neatly. Any ideas to adjusting this code to 3-field table?<br>
*Inserting test data for combinations2' table (3-fields)*<br>
<code>create table combinations2 as<br>
select 1 col1, 2 col2, 3 col3 from dual --*row1*<br>
union all<br>
select 2, 1, 3 from dual --*row2*<br>
union all<br>
select 1, 3, 2 from dual --*row3*;
</code><br>
Combinations2 table with 3-fields has row1, row2, row3 which are equal. My goal is to update row2 and row3 to null.",sql,oracle,combinations,,,,open,0,239,9,"Identifying duplicate combinations for n-field data table on Oracle I managed to make up sql query to update duplicate rows containing combinations to null value for 2-field table. However, I am stuck with more than 2-field table. <br>
My 2-field solution is:<br>
*Inserting test data for combinations' table:*<br>
<code>
create table combinations as <br>
select 1 col1, 2 col2 from dual --*row1* <br>
union all <br>
select 2, 1 from dual --*row2*<br>
union all <br>
select 1, 3 from dual --*row3*<br>
union all <br>
select 1,4 from dual; --*row4*</code><br>
From combinations' table row1 and row2 are duplicate because ordering of elements doesn't matter.
</code><br>
*Updating duplicate combinations to null for 2 fields (updating row2 to null):*
<code><br>
update combinations <br>set col1=null, col2=null <br>
where rowid IN(<br>
select x.rid from (<br>
    select <br>
        rowid rid, <br>
        col1, <br>
        col2, <br>
        row_number() over (partition by least(col1,col2), greatest(col1,col2) order by rownum) duplicate_row <br>
    from combinations) x <br>
where duplicate_row > 1);<br>
</code><br>
My code above depends on least(,) and greatest(,) functions and that's why it works neatly. Any ideas to adjusting this code to 3-field table?<br>
*Inserting test data for combinations2' table (3-fields)*<br>
<code>create table combinations2 as<br>
select 1 col1, 2 col2, 3 col3 from dual --*row1*<br>
union all<br>
select 2, 1, 3 from dual --*row2*<br>
union all<br>
select 1, 3, 2 from dual --*row3*;
</code><br>
Combinations2 table with 3-fields has row1, row2, row3 which are equal. My goal is to update row2 and row3 to null.",3
3801514,09/27/2010 06:23:49,118811,06/07/2009 13:11:44,356,32,have u ever done sql injection?,"i want to know if u have ever inject to a website using sql injection.

what tricks u have used. (especially mysql)",sql,mysql,sql-injection,,,09/27/2010 09:08:02,not a real question,1,21,6,"have u ever done sql injection? i want to know if u have ever inject to a website using sql injection.

what tricks u have used. (especially mysql)",3
840565,05/08/2009 16:03:04,54429,01/13/2009 02:19:02,30,2,can sql server reporting services be used as a report writer?,"we are trying to create reports programmatically in asp.net using microsoft reporting services. We are not sure if it is possible though. We have several queries for our reports. Instead of creating a separate .rdlc report for each of those queries, we are looking for a way so that we can feed the query / stored procedure to the reporting services engine and the reporting services engine will create a report and display it on the web. Is that possible?

Thanks",sql,server,reporting-services,,,,open,0,80,11,"can sql server reporting services be used as a report writer? we are trying to create reports programmatically in asp.net using microsoft reporting services. We are not sure if it is possible though. We have several queries for our reports. Instead of creating a separate .rdlc report for each of those queries, we are looking for a way so that we can feed the query / stored procedure to the reporting services engine and the reporting services engine will create a report and display it on the web. Is that possible?

Thanks",3
9718351,03/15/2012 11:01:27,920431,08/30/2011 20:05:53,18,0,Faster fetching data from View or Table?,hi we have a stored procedure which is scheduled for daily basis that fetches records from a table having huge data after filtering. my question is if i create a view on the table and fetch the data from the view will this be faster process or slower?,sql,sql-server,sql-server-2008,sql-server-2005,,,open,0,48,7,Faster fetching data from View or Table? hi we have a stored procedure which is scheduled for daily basis that fetches records from a table having huge data after filtering. my question is if i create a view on the table and fetch the data from the view will this be faster process or slower?,4
1316289,08/22/2009 16:01:36,25300,10/05/2008 17:21:53,976,65,"What is the purpose of tbl_Product, tbl_Order naming conventions?","I've seen tbl_ prefixes decorating all tables in the last two code bases I've worked with.  I can't think of any reason they'd be useful for application developers or database administrators.

If a DBA needs to see what objects are tables they can always join up to DMV's or the schema tables in master right?  I can't think of how they'd be useful to a programmer either, even more so if the project is using an ORM tool.  

Still even while writing stored procs they just seem to get in the way.

Can anybody explain how they'd be useful in a non-subjective way?  Ex ( having tbl_ helps me perform x task )",sql,naming-conventions,,,,,open,0,115,9,"What is the purpose of tbl_Product, tbl_Order naming conventions? I've seen tbl_ prefixes decorating all tables in the last two code bases I've worked with.  I can't think of any reason they'd be useful for application developers or database administrators.

If a DBA needs to see what objects are tables they can always join up to DMV's or the schema tables in master right?  I can't think of how they'd be useful to a programmer either, even more so if the project is using an ORM tool.  

Still even while writing stored procs they just seem to get in the way.

Can anybody explain how they'd be useful in a non-subjective way?  Ex ( having tbl_ helps me perform x task )",2
8585481,12/21/2011 05:32:23,281705,02/26/2010 00:16:28,399,1,"How make a select with ""repeated"" condition in SQL?","I have the following select that need to be done:

> select top 1 a, b, c, d from Products where  
CodDep = 10 or  
CodDep = 11 or  
CodDep = 12 or 
CodDep = 13 or  
CodDep = 26 or  
CodDep = 27 or 
CodDep = 32 or  
CodDep = 34 or  
CodDep = 248442 or  
CodDep = 259741
> order by LastUpdate

Is there an easy way to do this without all this repetition?",sql,windows,,,,,open,0,81,9,"How make a select with ""repeated"" condition in SQL? I have the following select that need to be done:

> select top 1 a, b, c, d from Products where  
CodDep = 10 or  
CodDep = 11 or  
CodDep = 12 or 
CodDep = 13 or  
CodDep = 26 or  
CodDep = 27 or 
CodDep = 32 or  
CodDep = 34 or  
CodDep = 248442 or  
CodDep = 259741
> order by LastUpdate

Is there an easy way to do this without all this repetition?",2
5268640,03/11/2011 03:27:42,607848,02/08/2011 09:17:42,512,49,SQL query to get the source of a Stored Procedure,"I'm using a DB2 database and I'm hoping for a query which will iterate over all stored procedures in a single database and print out the source code of each. No fancy formatting or performance requirements. 

The reason for this (in case there's a better way of doing it) is I'm trying to track down usages of a particular table in our stored procs, so I want to be able to do a simple text search through all of them.

Also, I've got access to SQuirreL SQL client if anyone knows of a way via that.",sql,stored-procedures,db2,,,,open,0,95,10,"SQL query to get the source of a Stored Procedure I'm using a DB2 database and I'm hoping for a query which will iterate over all stored procedures in a single database and print out the source code of each. No fancy formatting or performance requirements. 

The reason for this (in case there's a better way of doing it) is I'm trying to track down usages of a particular table in our stored procs, so I want to be able to do a simple text search through all of them.

Also, I've got access to SQuirreL SQL client if anyone knows of a way via that.",3
11295185,07/02/2012 13:57:44,981971,10/06/2011 10:08:57,1,0,Sql to remove utf8 invalid characters,We have a large database of products and gave up on fixing the invalid utf8 characters.  Is there a way via a query just to remove those characters from a certain field?,sql,utf-8,,,,07/03/2012 09:47:48,not a real question,1,33,6,Sql to remove utf8 invalid characters We have a large database of products and gave up on fixing the invalid utf8 characters.  Is there a way via a query just to remove those characters from a certain field?,2
7393140,09/12/2011 19:49:18,841297,07/12/2011 18:04:12,50,0,SQL Syntax error with ms-access query,"Here is my query below. The problem im having is that B.REVISED_DATE is a string and B.REVISED_DATE a date and when i try to run the query, i get a data mismatch error. What i am trying to do is change B.REVISED_DATE into a string but I dont remember the exact syntax. I am using microsoft access as the database. Any help would be appreciated.
 
       
         SELECT A.ICAO, A.RWY, A.REVISED_DATE, B.REVISED_DATE
         FROM RUNWAYS A, RUNWAYS_UPDATABLE B, AIRPORT_CHECKLIST C
         WHERE A.RWYKEY = B.RWYKEY
         AND A.ICAO = C.ICAO
         AND A.REVISED_DATE <> B.REVISED_DATE
         AND TO_CHAR(B.REVISED_DATE) <> C.EMAIL_DATE
         ORDER BY A.ICAO",sql,ms-access,,,,,open,0,160,6,"SQL Syntax error with ms-access query Here is my query below. The problem im having is that B.REVISED_DATE is a string and B.REVISED_DATE a date and when i try to run the query, i get a data mismatch error. What i am trying to do is change B.REVISED_DATE into a string but I dont remember the exact syntax. I am using microsoft access as the database. Any help would be appreciated.
 
       
         SELECT A.ICAO, A.RWY, A.REVISED_DATE, B.REVISED_DATE
         FROM RUNWAYS A, RUNWAYS_UPDATABLE B, AIRPORT_CHECKLIST C
         WHERE A.RWYKEY = B.RWYKEY
         AND A.ICAO = C.ICAO
         AND A.REVISED_DATE <> B.REVISED_DATE
         AND TO_CHAR(B.REVISED_DATE) <> C.EMAIL_DATE
         ORDER BY A.ICAO",2
3753346,09/20/2010 16:14:22,452925,09/20/2010 16:14:22,1,0,Passing from Form to Query in Access/SQL/VB,"Access 2007 / SQL / VB
I have a query: 
SELECT Count(*) AS CountOfCR1
FROM PData
WHERE (((PData.DestID)='CR1') And (((PData.AnswerTime)>=Starting)<Ending+1));

I am trying to pass the variables Starting and Ending to the above query from the below form:
Starting = StartDate & "" "" & StartTime
Ending = EndDate & "" "" & EndTime
On Error GoTo Err_Command5_Click
    Dim stDocName As String
    stDocName = ""CountOfCR1 : Query""
    DoCmd.OpenQuery stDocName, acNormal, acEdit
Exit_Command5_Click:
    Exit Sub
Err_Command5_Click:
    MsgBox Err.Description
    Resume Exit_Command5_Click

How can I pass Starting and Ending from my form to my query?",sql,vb,access,,,,open,0,100,7,"Passing from Form to Query in Access/SQL/VB Access 2007 / SQL / VB
I have a query: 
SELECT Count(*) AS CountOfCR1
FROM PData
WHERE (((PData.DestID)='CR1') And (((PData.AnswerTime)>=Starting)<Ending+1));

I am trying to pass the variables Starting and Ending to the above query from the below form:
Starting = StartDate & "" "" & StartTime
Ending = EndDate & "" "" & EndTime
On Error GoTo Err_Command5_Click
    Dim stDocName As String
    stDocName = ""CountOfCR1 : Query""
    DoCmd.OpenQuery stDocName, acNormal, acEdit
Exit_Command5_Click:
    Exit Sub
Err_Command5_Click:
    MsgBox Err.Description
    Resume Exit_Command5_Click

How can I pass Starting and Ending from my form to my query?",3
323857,11/27/2008 14:08:06,16316,09/17/2008 16:09:20,11,4,Optimizing unions,"HI, im having trouble trying to optimize the following query for sql server 2005. Does anyone know how could i improve it. Each one of the tables used there have about 40 million rows each. I've tried my best trying to optimize it but, i manage to do the exact opposite.

Thanks


    SELECT
            cos
          , SIN
        FROM
            ConSisHis2005
        union all
        SELECT
            cos
          , SIN
        FROM
            ConSisHis2006
        union all
        SELECT
            cos
          , SIN
        FROM
            ConSisHis2007
        UNION ALL
        SELECT
            cos
          , SIN
        FROM
            ConSisHis2008",sql,sql-server-2005,optimization,query,,,open,0,278,2,"Optimizing unions HI, im having trouble trying to optimize the following query for sql server 2005. Does anyone know how could i improve it. Each one of the tables used there have about 40 million rows each. I've tried my best trying to optimize it but, i manage to do the exact opposite.

Thanks


    SELECT
            cos
          , SIN
        FROM
            ConSisHis2005
        union all
        SELECT
            cos
          , SIN
        FROM
            ConSisHis2006
        union all
        SELECT
            cos
          , SIN
        FROM
            ConSisHis2007
        UNION ALL
        SELECT
            cos
          , SIN
        FROM
            ConSisHis2008",4
11426929,07/11/2012 06:37:39,1249117,03/05/2012 05:27:07,119,5,Can we use join For two difference Database Table,"Hi everyone I have Some confusion can we use `join operation` for two difference Database Tables and if yes then How we use?

Thanks in advanced.",sql,database,query,,,07/11/2012 12:57:05,not a real question,1,25,9,"Can we use join For two difference Database Table Hi everyone I have Some confusion can we use `join operation` for two difference Database Tables and if yes then How we use?

Thanks in advanced.",3
564525,02/19/2009 09:29:27,41424,11/27/2008 16:48:01,120,15,What are the good SQL Podcasts out there?,"inspired by [this question][1] since i do not find any good sql casts out there and i fail to find any good ones to this day online.


  [1]: http://stackoverflow.com/questions/1644/what-good-technology-podcasts-are-out-there",sql,sql-server,podcast,,,09/18/2011 02:16:41,off topic,1,30,8,"What are the good SQL Podcasts out there? inspired by [this question][1] since i do not find any good sql casts out there and i fail to find any good ones to this day online.


  [1]: http://stackoverflow.com/questions/1644/what-good-technology-podcasts-are-out-there",3
10970148,06/10/2012 15:59:14,436493,12/15/2009 16:58:55,976,10,Data tables exercise,"Hi everyone I was working through a databases exercise and came across the following exercise where I have to create a set of data tables from a given case scenario. But I'm having difficulty working out the attributes in bold:

*A database is to be designed for a university to monitor students’ progress 
throughout their course of study. The students are studying for a degree (such as 
BSc, MSc, etc.) within the framework of a modular system. The university provides 
a number of modules, each  being characterised by its code, title, credit value, 
module leader, academic staff and the department they come from. A module is coordinated by a module leader who shares teaching duties with one or more 
lecturers. A lecturer may teach (and be a module leader for) more than one module. 
Students are free to choose any module they wish but the following rules must be 
observed:  some modules require pre-requisite modules and some degree 
programmes have compulsory modules. The database is also to contain some 
information about students including their  student  numbers, names, addresses, 
degrees they  study for, and their past performance (i.e., modules taken and 
examination results).*

So far the tables I have are:

**University**

*ModuleCode, ModuleTitle, CreditValue, Department*

**Module**

*ModuleCode, ModuleTitle, LecturerID*

**Lecturer**

*LecturerID, ModuleCode, ModuleTitle*

**Student**

*StudentID, Name, Address, DegreeCode*

**Degree**

*DegreeCode, DegreeType, DegreeTitle*

**Performance**

*ModuleCode, ModuleTitle, StudentID, Result*

Is there anything that I'm missing out on or can improve?",sql,database,homework,,,06/11/2012 16:26:04,too localized,1,227,3,"Data tables exercise Hi everyone I was working through a databases exercise and came across the following exercise where I have to create a set of data tables from a given case scenario. But I'm having difficulty working out the attributes in bold:

*A database is to be designed for a university to monitor students’ progress 
throughout their course of study. The students are studying for a degree (such as 
BSc, MSc, etc.) within the framework of a modular system. The university provides 
a number of modules, each  being characterised by its code, title, credit value, 
module leader, academic staff and the department they come from. A module is coordinated by a module leader who shares teaching duties with one or more 
lecturers. A lecturer may teach (and be a module leader for) more than one module. 
Students are free to choose any module they wish but the following rules must be 
observed:  some modules require pre-requisite modules and some degree 
programmes have compulsory modules. The database is also to contain some 
information about students including their  student  numbers, names, addresses, 
degrees they  study for, and their past performance (i.e., modules taken and 
examination results).*

So far the tables I have are:

**University**

*ModuleCode, ModuleTitle, CreditValue, Department*

**Module**

*ModuleCode, ModuleTitle, LecturerID*

**Lecturer**

*LecturerID, ModuleCode, ModuleTitle*

**Student**

*StudentID, Name, Address, DegreeCode*

**Degree**

*DegreeCode, DegreeType, DegreeTitle*

**Performance**

*ModuleCode, ModuleTitle, StudentID, Result*

Is there anything that I'm missing out on or can improve?",3
2559549,04/01/2010 10:01:42,61529,02/02/2009 14:41:34,264,16,How to get SQL Function run a different query and return value from either query?,"I need a function, but cannot seem to get it quite right, I have looked at examples here and elsewhere and cannot seem to get this just right, I need an optional item to be included in my query, I have this query (which works):

    SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
    (1000),Description)) AS LenDesc FROM tblItem
    WHERE Title = @Title AND Manufacturer = @Manufacturer
    ORDER BY LenDesc DESC

This works within a Function, however the Manufacturer is Optional for this search - which is to find the description of a similar item, if none is present, the other query is:

    SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
    (1000),Description)) AS LenDesc FROM tblItem
    WHERE Title = @Title ORDER BY LenDesc DESC

Which is missing the Manufacturer, how to I get my function to use either query based on the Manufacturer Value being present or not.
The reason is I will have a function which first checks an SKU for a Description, if it is not present - it uses this method to get a Description from a Similar Product, then updates the product being added with the similar product's description.

Here is the function so far:

    ALTER FUNCTION [dbo].[GetDescriptionByTitleManufacturer]
    (	
    	@Title varchar(400),
    	@Manufacturer varchar(160)
    )
    RETURNS TABLE 
    AS
    RETURN (
        SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
        (1000),Description)) AS LenDesc FROM tblItem
        WHERE Title = @Title AND Manufacturer = @Manufacturer
        ORDER BY LenDesc DESC
    	)

I've tried adding BEGINs and IF...ELSEs but get errors or syntax problems each way I try it, I want to be able to do something like this pseudo-function (which does not work):

    ALTER FUNCTION [dbo].[GetDescriptionByTitleManufacturer]
    (	
    	@Title varchar(400),
    	@Manufacturer varchar(160)
    )
    RETURNS TABLE 
    AS
    BEGIN
    IF (@Manufacturer = Null)
    RETURN (
        SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
        (1000),Description)) AS LenDesc FROM tblItem
        WHERE Title = @Title ORDER BY LenDesc DESC
    	)
    ELSE
    RETURN (
        SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
        (1000),Description)) AS LenDesc FROM tblItem
        WHERE Title = @Title AND Manufacturer = @Manufacturer
        ORDER BY LenDesc DESC
    	)
   END",sql,sql-server,function,optional,sql-server-2008,,open,0,502,15,"How to get SQL Function run a different query and return value from either query? I need a function, but cannot seem to get it quite right, I have looked at examples here and elsewhere and cannot seem to get this just right, I need an optional item to be included in my query, I have this query (which works):

    SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
    (1000),Description)) AS LenDesc FROM tblItem
    WHERE Title = @Title AND Manufacturer = @Manufacturer
    ORDER BY LenDesc DESC

This works within a Function, however the Manufacturer is Optional for this search - which is to find the description of a similar item, if none is present, the other query is:

    SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
    (1000),Description)) AS LenDesc FROM tblItem
    WHERE Title = @Title ORDER BY LenDesc DESC

Which is missing the Manufacturer, how to I get my function to use either query based on the Manufacturer Value being present or not.
The reason is I will have a function which first checks an SKU for a Description, if it is not present - it uses this method to get a Description from a Similar Product, then updates the product being added with the similar product's description.

Here is the function so far:

    ALTER FUNCTION [dbo].[GetDescriptionByTitleManufacturer]
    (	
    	@Title varchar(400),
    	@Manufacturer varchar(160)
    )
    RETURNS TABLE 
    AS
    RETURN (
        SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
        (1000),Description)) AS LenDesc FROM tblItem
        WHERE Title = @Title AND Manufacturer = @Manufacturer
        ORDER BY LenDesc DESC
    	)

I've tried adding BEGINs and IF...ELSEs but get errors or syntax problems each way I try it, I want to be able to do something like this pseudo-function (which does not work):

    ALTER FUNCTION [dbo].[GetDescriptionByTitleManufacturer]
    (	
    	@Title varchar(400),
    	@Manufacturer varchar(160)
    )
    RETURNS TABLE 
    AS
    BEGIN
    IF (@Manufacturer = Null)
    RETURN (
        SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
        (1000),Description)) AS LenDesc FROM tblItem
        WHERE Title = @Title ORDER BY LenDesc DESC
    	)
    ELSE
    RETURN (
        SELECT TOP 100 PERCENT SKU, Description, LEN(CONVERT(VARCHAR
        (1000),Description)) AS LenDesc FROM tblItem
        WHERE Title = @Title AND Manufacturer = @Manufacturer
        ORDER BY LenDesc DESC
    	)
   END",5
11727727,07/30/2012 18:51:04,759549,05/18/2011 16:05:10,549,17,"sql query returning multiple dates, only need latest date","I have a query that returns users by first name, last name, user id and a date they've completed an event.

I want the query to only return one row per user, but some users have completed the same event on multiple dates.  I can't use a distinct becuase the dates are distinct, and I can't use a group by for the same reason.

how can I have the query return only the latest date on which the event was completed?",sql,sql-server,tsql,,,,open,0,80,9,"sql query returning multiple dates, only need latest date I have a query that returns users by first name, last name, user id and a date they've completed an event.

I want the query to only return one row per user, but some users have completed the same event on multiple dates.  I can't use a distinct becuase the dates are distinct, and I can't use a group by for the same reason.

how can I have the query return only the latest date on which the event was completed?",3
4142044,11/10/2010 07:15:17,359047,06/05/2010 05:50:22,36,1,SQL Server 2005,"SQL Server 2005 quickly allocates memory spaces to objects and reuses the free spaces created by deleted rows.
Is the above statement correct or not.",sql,sql-server,,,,11/10/2010 07:52:24,not a real question,1,24,3,"SQL Server 2005 SQL Server 2005 quickly allocates memory spaces to objects and reuses the free spaces created by deleted rows.
Is the above statement correct or not.",2
9182315,02/07/2012 19:10:02,808921,06/21/2011 17:09:45,6107,314,How to disable PL/SQL in Oracle queries,"Here's an example of the sort of query I would like to prevent from running on my server:

    begin
      While True
      LOOP
         dbms_output.put_line('tst');
      END LOOP;
    end

This query (or others like it) may be hitting my Oracle server via the Oracle JDBC thin driver.  I would be open to preventing this query from running either at the JDBC configuration level, the database configuration level, or via user permissions within the database.  I would like the user to continue to be able to run normal select/insert/update/delete queries.  Honestly I'd be quite happy if none of the PL/SQL type commands were available, and instead only standard SQL.",sql,oracle,jdbc,plsql,oracle11g,,open,0,136,7,"How to disable PL/SQL in Oracle queries Here's an example of the sort of query I would like to prevent from running on my server:

    begin
      While True
      LOOP
         dbms_output.put_line('tst');
      END LOOP;
    end

This query (or others like it) may be hitting my Oracle server via the Oracle JDBC thin driver.  I would be open to preventing this query from running either at the JDBC configuration level, the database configuration level, or via user permissions within the database.  I would like the user to continue to be able to run normal select/insert/update/delete queries.  Honestly I'd be quite happy if none of the PL/SQL type commands were available, and instead only standard SQL.",5
8075847,11/10/2011 06:43:46,1039157,11/10/2011 06:40:37,1,0,privilege for query execution on a existing view,"for executing a query on existing views what is required
a)the underlying tables must have data
b)the underlying tables must be in same schema
c)select privileges on underlying tables
d)select privileges on view is enough",sql,oracle,,,,11/10/2011 13:32:41,not a real question,1,31,8,"privilege for query execution on a existing view for executing a query on existing views what is required
a)the underlying tables must have data
b)the underlying tables must be in same schema
c)select privileges on underlying tables
d)select privileges on view is enough",2
10928003,06/07/2012 08:07:35,1441614,06/07/2012 07:52:27,1,0,Moving stored procedure from Firebird to MS SQL,"There are databases on firebird and MS SQL. I have working stored procedure in firebird.
Question is:
How to translate it into MS SQL syntax...

    begin
      IF ((:PHONE_N is NULL) or (STRLEN(:PHONE_N)<1))  THEN
        BEGIN
          O_PHONE_N = NULL;
          EXIT;
        END
    
      IF (STRLEN(PHONE_N) > 3) THEN
        BEGIN
          O_PHONE_N = '(' || SUBSTR(:PHONE_N, 1, 3) || ') ';
          PHONE_N = SUBSTR(:PHONE_N, 4, STRLEN(:PHONE_N));
          IF (STRLEN(:PHONE_N)> 3) THEN
            begin
              O_PHONE_N = O_PHONE_N || SUBSTR(:PHONE_N, 1, 3);
              PHONE_N = SUBSTR(:PHONE_N, 4, STRLEN(:PHONE_N));
              IF (STRLEN(:PHONE_NUMBER)> 0) THEN
                O_PHONE_N = O_PHONE_N || '-' ||:PHONE_N;
            END
          ELSE
            O_PHONE_N = :O_PHONE_N || :PHONE_N;
        END
      ELSE
        O_PHONE_N = :PHONE_N;
    end",sql,,,,,06/07/2012 14:19:45,too localized,1,300,8,"Moving stored procedure from Firebird to MS SQL There are databases on firebird and MS SQL. I have working stored procedure in firebird.
Question is:
How to translate it into MS SQL syntax...

    begin
      IF ((:PHONE_N is NULL) or (STRLEN(:PHONE_N)<1))  THEN
        BEGIN
          O_PHONE_N = NULL;
          EXIT;
        END
    
      IF (STRLEN(PHONE_N) > 3) THEN
        BEGIN
          O_PHONE_N = '(' || SUBSTR(:PHONE_N, 1, 3) || ') ';
          PHONE_N = SUBSTR(:PHONE_N, 4, STRLEN(:PHONE_N));
          IF (STRLEN(:PHONE_N)> 3) THEN
            begin
              O_PHONE_N = O_PHONE_N || SUBSTR(:PHONE_N, 1, 3);
              PHONE_N = SUBSTR(:PHONE_N, 4, STRLEN(:PHONE_N));
              IF (STRLEN(:PHONE_NUMBER)> 0) THEN
                O_PHONE_N = O_PHONE_N || '-' ||:PHONE_N;
            END
          ELSE
            O_PHONE_N = :O_PHONE_N || :PHONE_N;
        END
      ELSE
        O_PHONE_N = :PHONE_N;
    end",1
11453748,07/12/2012 14:12:17,440775,09/06/2010 15:44:59,142,10,How can I enable the MTENANT feature in SQL Server 2008 R2?,"I've read about the MTENANT feature in SQL Server 2008 R2?

How can I enable it?

Unfortunately I couldn't run the command CREATE MTENANT t1.

Thanks for your help.

Kind regards, pro",sql,sql-server,multi-tenant,server,,07/12/2012 14:31:48,not a real question,1,28,12,"How can I enable the MTENANT feature in SQL Server 2008 R2? I've read about the MTENANT feature in SQL Server 2008 R2?

How can I enable it?

Unfortunately I couldn't run the command CREATE MTENANT t1.

Thanks for your help.

Kind regards, pro",4
7809421,10/18/2011 15:03:11,21155,09/23/2008 14:37:57,1225,27,identify siblings in database,"I currently have a database with a students table like so:

     Students
     _________
     StudentID PK
     FirstName
     LastName
     BirthDate
     AddressL1
     AddressL2
     City
     State
     Zip
     etc.....




My client has asked me to add a feature so she can identify siblings in the system. If Jimmy is a student and Billy is a student and Jimmy and Billy are brothers, she wants a way to know that. 


How would you implement this?

I'm thinking adding a Family Table with a FamilyID FK is overkill for this problem. Do you agree?

My instinct is to add a nullable column Called **Family**. Set it to null if the student has no siblings. If the student has siblings, each students get the same GUID stored in the **Family** column.

If you want to list the siblings of a given student you'd execute:
     Select Siblings.*
     From Students 
     Inner Join
     Students as Siblings
     On
     Students.Family = Siblings.Family
     Where
     Students.StudentID = ?



What are the downsides of this approach? Is there an alternate strategy I should consider?


",sql,database-design,,,,,open,0,244,4,"identify siblings in database I currently have a database with a students table like so:

     Students
     _________
     StudentID PK
     FirstName
     LastName
     BirthDate
     AddressL1
     AddressL2
     City
     State
     Zip
     etc.....




My client has asked me to add a feature so she can identify siblings in the system. If Jimmy is a student and Billy is a student and Jimmy and Billy are brothers, she wants a way to know that. 


How would you implement this?

I'm thinking adding a Family Table with a FamilyID FK is overkill for this problem. Do you agree?

My instinct is to add a nullable column Called **Family**. Set it to null if the student has no siblings. If the student has siblings, each students get the same GUID stored in the **Family** column.

If you want to list the siblings of a given student you'd execute:
     Select Siblings.*
     From Students 
     Inner Join
     Students as Siblings
     On
     Students.Family = Siblings.Family
     Where
     Students.StudentID = ?



What are the downsides of this approach? Is there an alternate strategy I should consider?


",2
8699582,01/02/2012 10:11:30,499863,11/07/2010 13:53:53,6,0,SQL query TO_INTEGER substr,"Please explain me how to understand the next query

    TO_INTEGER(substr(NAME,1,length(NAME)-3))*100",sql,oracle,plsql,,,,open,0,13,4,"SQL query TO_INTEGER substr Please explain me how to understand the next query

    TO_INTEGER(substr(NAME,1,length(NAME)-3))*100",3
6538934,06/30/2011 17:49:43,486518,10/25/2010 14:09:57,146,1,Long Query Times,"I have a table with 23.5 million rows and 20 columns.  I updated the table to set one of the columns to `null`.  This query took an hour to complete.  Granted, I don't have an amazingly fast database server, but is this update time normal?  I didn't have an index on this table when I ran the update.  How much would that have helped?

Thanks in advance!",sql,tsql,sql-server-2008,,,,open,0,71,3,"Long Query Times I have a table with 23.5 million rows and 20 columns.  I updated the table to set one of the columns to `null`.  This query took an hour to complete.  Granted, I don't have an amazingly fast database server, but is this update time normal?  I didn't have an index on this table when I ran the update.  How much would that have helped?

Thanks in advance!",3
6203939,06/01/2011 15:45:23,730858,04/29/2011 10:26:31,137,1,SQL server 2008 DBA certification?,"My friend is working on SQL server 2008 and he wants to be a DBA for same.
Can you please let us know which certification path he should follow.

",sql,sql-server-2008,server,,,06/01/2011 15:52:13,off topic,1,28,5,"SQL server 2008 DBA certification? My friend is working on SQL server 2008 and he wants to be a DBA for same.
Can you please let us know which certification path he should follow.

",3
2704655,04/24/2010 13:43:46,86729,04/03/2009 13:14:55,679,22,How to model a mutually exclusive relationship in sql server,"I have to add functionality to an existing application and I've run into a data situation that I'm not sure how to model.

I have an Item table that can me link to any number of tables, and these tables may increase over time. The Item can only me linked to one other table, but the record in the other table may have many items linked to it.

My intital thoughts are:

Item
{
ID,
Name
}

LinkedItem
{
ItemID,
LinkedToTableName,
LinkedToID
}

The LinkedToTableName field will then allow me to identify the correct table to link to in my code. 

I'm not overly happy with this solution, but I can't quite think of anything else. Please help! :)

Thanks!



",sql,sql-server,database-design,,,,open,0,105,10,"How to model a mutually exclusive relationship in sql server I have to add functionality to an existing application and I've run into a data situation that I'm not sure how to model.

I have an Item table that can me link to any number of tables, and these tables may increase over time. The Item can only me linked to one other table, but the record in the other table may have many items linked to it.

My intital thoughts are:

Item
{
ID,
Name
}

LinkedItem
{
ItemID,
LinkedToTableName,
LinkedToID
}

The LinkedToTableName field will then allow me to identify the correct table to link to in my code. 

I'm not overly happy with this solution, but I can't quite think of anything else. Please help! :)

Thanks!



",3
10438314,05/03/2012 19:44:53,63264,02/06/2009 10:09:35,3677,267,SQL coding style: commas,"Which of these SQL coding styles is better and why?

**Comma first:**


    SELECT Name
        , Email
        , Phone
    FROM Contact

**Comma last:**

    SELECT Name,
        Email,
        Phone
    FROM Contact
",sql,coding-style,,,,05/03/2012 19:53:33,not constructive,1,66,4,"SQL coding style: commas Which of these SQL coding styles is better and why?

**Comma first:**


    SELECT Name
        , Email
        , Phone
    FROM Contact

**Comma last:**

    SELECT Name,
        Email,
        Phone
    FROM Contact
",2
5929896,05/08/2011 19:50:21,744176,05/08/2011 19:50:21,1,0,Linq/SQL help compare unique id's from prev/next month to count new,"I am trying to get a list of months from a table of payments that tells me how many customers are in a program that month. I can do that, the hard part is i need to know how many customers each month were NOT in the month before, and then also who WAS in the month before but is no longer. Basically to count joining/quitting people. The reason i can't do this with a min or max is that sometimes they will be out of the program a few months and come back in.

Here is what i have in LINQ that gets me the original count, now i just need a way to compare each month to see how many unique ""Customer Id""'s from the prev month and next month.

	var query2 =
	from p in Payments	
	where (p.Products == ""c30"" || p.Products == ""c3"") && (p.PayType != ""Credit"" || p.PayType != ""Return"" || p.PayType != ""Refund"" || p.PayType != ""Charge Back"" || p.PayType != ""Adjustment"")  
		&& p.PayAmt > 0 //&& p.Date == queryDate
	//order by p.Date.Value.Month descending
	group p by p.Date.Value.Year into yearGroups
	select new
	{
		Year = yearGroups.Key,
		Months = 
			from mg in yearGroups
			group mg.ContactId by mg.Date.Value.Month into monthGroup
			select new
			{
				Month = monthGroup.Key,
				AdvMembers = monthGroup.Distinct().Count(),
			}
	};",sql,linq,linq-to-sql,,,07/11/2011 11:19:23,not a real question,1,199,11,"Linq/SQL help compare unique id's from prev/next month to count new I am trying to get a list of months from a table of payments that tells me how many customers are in a program that month. I can do that, the hard part is i need to know how many customers each month were NOT in the month before, and then also who WAS in the month before but is no longer. Basically to count joining/quitting people. The reason i can't do this with a min or max is that sometimes they will be out of the program a few months and come back in.

Here is what i have in LINQ that gets me the original count, now i just need a way to compare each month to see how many unique ""Customer Id""'s from the prev month and next month.

	var query2 =
	from p in Payments	
	where (p.Products == ""c30"" || p.Products == ""c3"") && (p.PayType != ""Credit"" || p.PayType != ""Return"" || p.PayType != ""Refund"" || p.PayType != ""Charge Back"" || p.PayType != ""Adjustment"")  
		&& p.PayAmt > 0 //&& p.Date == queryDate
	//order by p.Date.Value.Month descending
	group p by p.Date.Value.Year into yearGroups
	select new
	{
		Year = yearGroups.Key,
		Months = 
			from mg in yearGroups
			group mg.ContactId by mg.Date.Value.Month into monthGroup
			select new
			{
				Month = monthGroup.Key,
				AdvMembers = monthGroup.Distinct().Count(),
			}
	};",3
7609204,09/30/2011 10:40:16,608945,02/08/2011 23:19:20,25,6,SQL Query crafting,"I have a database with potentially thousands thousands of records (we're talking a 2MB result string if it was just `SELECT * FROM xxx` in a standard use case.

Now for reasons of security this result cannot be held anywhere for much more processing.

There is a path field where I want to extract all records with each level of folder structure.

So run the query one way I get every record in the root:

C:\

Query again another way I get every record in the first folder level:

C:\a\
C:\b\

etc

Then of course I will GROUP somehow in order to return

C:\a\
C:\b\

and not

C:\a\
C:\a\
C:\b\
C:\b\

hopefully you get the idea?
Any answers that at least move me in the right direction I will be grateful for. I really am stumped where to start with this as downloading every record and processing is far from the ideal solution in my context. (Which is what we do now).",sql,,,,,,open,0,144,3,"SQL Query crafting I have a database with potentially thousands thousands of records (we're talking a 2MB result string if it was just `SELECT * FROM xxx` in a standard use case.

Now for reasons of security this result cannot be held anywhere for much more processing.

There is a path field where I want to extract all records with each level of folder structure.

So run the query one way I get every record in the root:

C:\

Query again another way I get every record in the first folder level:

C:\a\
C:\b\

etc

Then of course I will GROUP somehow in order to return

C:\a\
C:\b\

and not

C:\a\
C:\a\
C:\b\
C:\b\

hopefully you get the idea?
Any answers that at least move me in the right direction I will be grateful for. I really am stumped where to start with this as downloading every record and processing is far from the ideal solution in my context. (Which is what we do now).",1
