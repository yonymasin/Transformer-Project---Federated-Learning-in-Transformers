PostId,PostCreationDate,OwnerUserId,OwnerCreationDate,ReputationAtPostCreation,OwnerUndeletedAnswerCountAtPostTime,Title,BodyMarkdown,Tag1,Tag2,Tag3,Tag4,Tag5,PostClosedDate,OpenStatus,OpenStatusInt,BodyLength,TitleLength,TitleConcatWithBody,NumberOfTags
9936449,03/30/2012 03:00:37,657514,03/13/2011 13:26:09,451,0,Ruby Script with SQLite3 query to remove duplicate entries from a DB table is throwing an exception,"I have the following file ""dupeExtracter.rb"" to remove duplicate entries from a DB table that is throwing an exception when I run it:

    require 'sqlite3'

db = SQLite3::Database.new('development.sqlite3')
db.results_as_hash = true;

#This query will return the lowest id of every entry that occurs more than once in the DB
#Entries that occur only once will NOT be in this resultset
#In other words this query will return the lowest id of every Duplicate in the DB
#It takes all these entries and populates the duplicates table with them
rows = db.execute(""SELECT L1.* FROM listings L1
WHERE L1.id = 
(SELECT MIN(L2.id) FROM Listings L2 WHERE 
L1.name = L2.name 
AND L1.telephone = L2.telephone
AND L1.latitude = L2.latitude
AND L1.longitude = L2.longitude)
"") 


rows.each do |row|
  
  db.execute(""DELETE FROM listings L
  WHERE L.id <> row['id']
  AND L.name = row['name']
  AND L.telephone = row['telephone']
  AND L.latitude = row['latitude']
  AND L.longitude = row['longitude']
  "")

end

This is the exception:

    /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:91:in `initialize': near ""L"": syntax error (SQLite3::SQLException)
	from /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:91:in `new'
	from /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:91:in `prepare'
	from /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:134:in `execute'
	from dupeExtracter.rb:22:in `block in <main>'
	from dupeExtracter.rb:20:in `each'
	from dupeExtracter.rb:20:in `<main>'


Im not sure how to debug it or fix it. Tried a couple of ways but it seems to not work.

Please help",sql,query,sqlite3,duplicates,,04/01/2012 04:36:16,too localized,1,197,17,"Ruby Script with SQLite3 query to remove duplicate entries from a DB table is throwing an exception I have the following file ""dupeExtracter.rb"" to remove duplicate entries from a DB table that is throwing an exception when I run it:

    require 'sqlite3'

db = SQLite3::Database.new('development.sqlite3')
db.results_as_hash = true;

#This query will return the lowest id of every entry that occurs more than once in the DB
#Entries that occur only once will NOT be in this resultset
#In other words this query will return the lowest id of every Duplicate in the DB
#It takes all these entries and populates the duplicates table with them
rows = db.execute(""SELECT L1.* FROM listings L1
WHERE L1.id = 
(SELECT MIN(L2.id) FROM Listings L2 WHERE 
L1.name = L2.name 
AND L1.telephone = L2.telephone
AND L1.latitude = L2.latitude
AND L1.longitude = L2.longitude)
"") 


rows.each do |row|
  
  db.execute(""DELETE FROM listings L
  WHERE L.id <> row['id']
  AND L.name = row['name']
  AND L.telephone = row['telephone']
  AND L.latitude = row['latitude']
  AND L.longitude = row['longitude']
  "")

end

This is the exception:

    /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:91:in `initialize': near ""L"": syntax error (SQLite3::SQLException)
	from /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:91:in `new'
	from /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:91:in `prepare'
	from /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/sqlite3-1.3.5/lib/sqlite3/database.rb:134:in `execute'
	from dupeExtracter.rb:22:in `block in <main>'
	from dupeExtracter.rb:20:in `each'
	from dupeExtracter.rb:20:in `<main>'


Im not sure how to debug it or fix it. Tried a couple of ways but it seems to not work.

Please help",4
4808337,01/26/2011 18:23:20,440266,09/06/2010 00:05:05,218,0,SQL Function that uses a time-stamp to output how old a question is,"I have a calculated field whose value I want to modify depending on how old the entry is. Is there way in MySQL to take a time stamp and use it to determine how old a query is. 

Here is the calculated field

    ((ces.EXPERT_SCORE * cirm.CONSUMER_RATING) + (12.5 * scs.SIMILARITY)* (1 - EXP(-0.5 * (cal.TIPS_AMOUNT / ATV.AVG_TIPS)) + .15))AS ANSWER_SCORE

Basically, I want to multply this calculated field based on the age of a timestamp.",sql,mysql,query,timestamp,calculated-field,,open,0,77,13,"SQL Function that uses a time-stamp to output how old a question is I have a calculated field whose value I want to modify depending on how old the entry is. Is there way in MySQL to take a time stamp and use it to determine how old a query is. 

Here is the calculated field

    ((ces.EXPERT_SCORE * cirm.CONSUMER_RATING) + (12.5 * scs.SIMILARITY)* (1 - EXP(-0.5 * (cal.TIPS_AMOUNT / ATV.AVG_TIPS)) + .15))AS ANSWER_SCORE

Basically, I want to multply this calculated field based on the age of a timestamp.",5
7084577,08/16/2011 20:28:47,777982,05/31/2011 15:53:56,325,31,Removing duplicates from SQL Join,"The following is a hypothetical situations this which is close to my real problem. Table1


    recid   firstname    lastname   company
    1       A             B          AAA
    2       D             E          DEF
    3       G             H          IJK
    4       A             B          ABC

I have a table2 which looks like this

    recid   firstname    lastname   company
    10      A             B          ABC
    20      D             E          DEF
    30      M             D          DIM
    40      A             B          CCC


Now if I join the table on recid, it will give 0 result, there will be no duplicates because recid is unique. But if I join on firstname and lastname column, which are not unique and there are duplicates, I get duplicates on inner join. The more columns I add on join, the worse it becomes (more duplicates are created).

In the above simple situation, how can I remove duplicates in the following query. I want to compare firstname and lastname, if they match, I return firstname, lastname and recid from table2 

    select distinct * from
    (select recid, first, last from table1) a
    inner join
    (select recid, first,last from table2) b
    on a.first = b.first

-----------------------------------------------------------------------------
Script is here if anyone wants to play with it in future

    create table table1 (recid int not null primary key, first varchar(20), last varchar(20), company varchar(20))
    create table table2 (recid int not null primary key, first varchar(20), last varchar(20), company varchar(20))
    
    insert into table1 values(1,'A','B','ABC')
    insert into table1 values(2,'D','E','DEF')
    insert into table1 values(3,'M','N','MNO')
    insert into table1 values(4,'A','B','ABC')
    
    insert into table2 values(10,'A','B','ABC')
    insert into table2 values(20,'D','E','DEF')
    insert into table2 values(30,'Q','R','QRS')
    insert into table2 values(40,'A','B','ABC')

",sql,join,,,,,open,0,558,5,"Removing duplicates from SQL Join The following is a hypothetical situations this which is close to my real problem. Table1


    recid   firstname    lastname   company
    1       A             B          AAA
    2       D             E          DEF
    3       G             H          IJK
    4       A             B          ABC

I have a table2 which looks like this

    recid   firstname    lastname   company
    10      A             B          ABC
    20      D             E          DEF
    30      M             D          DIM
    40      A             B          CCC


Now if I join the table on recid, it will give 0 result, there will be no duplicates because recid is unique. But if I join on firstname and lastname column, which are not unique and there are duplicates, I get duplicates on inner join. The more columns I add on join, the worse it becomes (more duplicates are created).

In the above simple situation, how can I remove duplicates in the following query. I want to compare firstname and lastname, if they match, I return firstname, lastname and recid from table2 

    select distinct * from
    (select recid, first, last from table1) a
    inner join
    (select recid, first,last from table2) b
    on a.first = b.first

-----------------------------------------------------------------------------
Script is here if anyone wants to play with it in future

    create table table1 (recid int not null primary key, first varchar(20), last varchar(20), company varchar(20))
    create table table2 (recid int not null primary key, first varchar(20), last varchar(20), company varchar(20))
    
    insert into table1 values(1,'A','B','ABC')
    insert into table1 values(2,'D','E','DEF')
    insert into table1 values(3,'M','N','MNO')
    insert into table1 values(4,'A','B','ABC')
    
    insert into table2 values(10,'A','B','ABC')
    insert into table2 values(20,'D','E','DEF')
    insert into table2 values(30,'Q','R','QRS')
    insert into table2 values(40,'A','B','ABC')

",2
10124604,04/12/2012 13:29:21,1239554,02/29/2012 06:30:06,70,2,datename function in sql,"I wanted to get the week from the given date, for this I tried with the DATENAME function to get the WEEK like,
   
     Select DateName(WEEK,'2012-03-09')

am getting the output as 10. I want to get the starting date and ending date of this week like, `2012-03-04 to 2012-03-10` Is it possible?",sql,,,,,,open,0,57,4,"datename function in sql I wanted to get the week from the given date, for this I tried with the DATENAME function to get the WEEK like,
   
     Select DateName(WEEK,'2012-03-09')

am getting the output as 10. I want to get the starting date and ending date of this week like, `2012-03-04 to 2012-03-10` Is it possible?",1
10845895,06/01/2012 07:07:04,1429149,05/31/2012 18:13:06,1,0,what is the difference between database for decision support system and data warehousing,I would like to know about what is the difference between a database for decision support system and dataware housing. Both provide the same functionality as far as i am cocern.,sql,database,data-mining,data-warehouse,,06/03/2012 16:16:19,not a real question,1,31,13,what is the difference between database for decision support system and data warehousing I would like to know about what is the difference between a database for decision support system and dataware housing. Both provide the same functionality as far as i am cocern.,4
8220825,11/22/2011 01:19:11,1057668,11/21/2011 11:04:15,1,0,What are the advantages of using LINQ?,What are the advantages of using LINQ over other data querying mechanisms such as SQL?,sql,linq,,,,11/22/2011 10:10:34,not constructive,1,15,7,What are the advantages of using LINQ? What are the advantages of using LINQ over other data querying mechanisms such as SQL?,2
3477064,08/13/2010 13:06:48,327073,04/27/2010 16:56:12,198,6,ERD help needed Bug Tracking System image attached,"Can you see anything that might have been left out for a simple bug tracking system?

![ERD][1]


  [1]: http://img694.imageshack.us/img694/8166/captureqpe.jpg",sql,mysql,oracle,erd,,,open,0,19,8,"ERD help needed Bug Tracking System image attached Can you see anything that might have been left out for a simple bug tracking system?

![ERD][1]


  [1]: http://img694.imageshack.us/img694/8166/captureqpe.jpg",4
10308223,04/25/2012 01:29:27,1345260,04/19/2012 22:49:52,20,0,"How to write a Query so that based on a Date, it takes data for the next 7 days","I have a Calendar from which I need to pick a date so when a date is picked, the query should show all the data for that date & also for the next 7 days.

My current Query is as below, but it only shows the data for the date that's been picked.

SELECT MailDate, Status, JobNo
FROM Table_1
WHERE MailDate=@MailDate

Please help me out with this.",sql,query,,,,,open,0,62,19,"How to write a Query so that based on a Date, it takes data for the next 7 days I have a Calendar from which I need to pick a date so when a date is picked, the query should show all the data for that date & also for the next 7 days.

My current Query is as below, but it only shows the data for the date that's been picked.

SELECT MailDate, Status, JobNo
FROM Table_1
WHERE MailDate=@MailDate

Please help me out with this.",2
11203098,06/26/2012 08:03:37,1199662,02/09/2012 12:39:45,12,0,Retrieving data by SQL,"short briefing of my situation: we have a flat TV at our college where the rooms for each group lessons are displayed. I've decided to create an app which will retrieve that information and dispay it so the studens don't need to go for the TV. 

The administrator said the corresponding data is stored as an Excel-spreadshit on the server so that means it can be retrieved online via an SQL-query. Since I've never done such kind of apps before, I could need some information about how to establish a http/TCP connection to the server and get the data I need. Any help is appreciated. ",sql,connection,online,,,06/27/2012 14:32:20,not a real question,1,106,4,"Retrieving data by SQL short briefing of my situation: we have a flat TV at our college where the rooms for each group lessons are displayed. I've decided to create an app which will retrieve that information and dispay it so the studens don't need to go for the TV. 

The administrator said the corresponding data is stored as an Excel-spreadshit on the server so that means it can be retrieved online via an SQL-query. Since I've never done such kind of apps before, I could need some information about how to establish a http/TCP connection to the server and get the data I need. Any help is appreciated. ",3
8947353,01/20/2012 20:17:04,1044581,11/13/2011 20:42:38,63,0,How do I add Code(bound) to button to control a Function value in a WHERE Clause?,"I have this piece of code that controls the day(s) ago in a Date Add Function.

How do I embed this code to a form button, so that I can enter the days in a text box?

> WHERE
> ((DateSerial(CInt(Left([MY_DATE],4)),CInt(Mid([MY_DATE],5,2)),CInt(Right([MY_DATE],2))))=DateAdd(""d"",-2,Date())))


I want to bound the day(s) to the button so I can type it in.

I already have the form and the button on it.

Thanks everyone!",sql,ms-access-2007,,,,,open,0,62,16,"How do I add Code(bound) to button to control a Function value in a WHERE Clause? I have this piece of code that controls the day(s) ago in a Date Add Function.

How do I embed this code to a form button, so that I can enter the days in a text box?

> WHERE
> ((DateSerial(CInt(Left([MY_DATE],4)),CInt(Mid([MY_DATE],5,2)),CInt(Right([MY_DATE],2))))=DateAdd(""d"",-2,Date())))


I want to bound the day(s) to the button so I can type it in.

I already have the form and the button on it.

Thanks everyone!",2
7193292,08/25/2011 15:43:33,236860,12/22/2009 13:05:32,84,3,What Order should I Call @@ROWCOUNT/@@ERROR,"I am inserting a number or rows into a table using INSERT with SELECT.
After the transaction, I want to store both the @@ROWCOUNT and @@ERROR values into locallay declared variables.


    INSERT SubscriberList (PublicationId, SubscriberId)
    SELECT @PublicationId, S.SubscriberId
    FROM Subscribers S

    SET @NoRows = @@ROWCOUNT
    SET @ErrorCode = @@ERROR

I wasn't sure if this was valid in as much if I call one, will I negate the other?",sql,tsql,,,,,open,0,81,6,"What Order should I Call @@ROWCOUNT/@@ERROR I am inserting a number or rows into a table using INSERT with SELECT.
After the transaction, I want to store both the @@ROWCOUNT and @@ERROR values into locallay declared variables.


    INSERT SubscriberList (PublicationId, SubscriberId)
    SELECT @PublicationId, S.SubscriberId
    FROM Subscribers S

    SET @NoRows = @@ROWCOUNT
    SET @ErrorCode = @@ERROR

I wasn't sure if this was valid in as much if I call one, will I negate the other?",2
6245565,06/05/2011 20:13:04,215614,11/20/2009 17:01:14,224,14,Advanced MS SQL Server book with practical examples,"I realize that this is already fairly well tread ground on the stack and have found fairly fertile questions/answers here:

http://stackoverflow.com/questions/tagged/books+sql?sort=votes&pagesize=50

However, I'm curious to know if anyone has had good experience with a book targeted at MS SQL Server that treats the subject similar to the way that Design Patterns by Gamma, Helm, Johnson, and Vlissides treats issues of design patterns.  That book cuts an exellent balance between theory and practical application with careful attention paid to trade offs for a given pattern.  I'm particularly interrested in the following topics:

* How and when to apply partioning strategies
* Scalable backup strategies as databases grow in size
* How to handle tables that seem always to need more columns
* How to handle heavily queried and manipulated tables

Any help is greatly appreciated ;-)",sql,books,,,,10/03/2011 16:43:28,not constructive,1,130,8,"Advanced MS SQL Server book with practical examples I realize that this is already fairly well tread ground on the stack and have found fairly fertile questions/answers here:

http://stackoverflow.com/questions/tagged/books+sql?sort=votes&pagesize=50

However, I'm curious to know if anyone has had good experience with a book targeted at MS SQL Server that treats the subject similar to the way that Design Patterns by Gamma, Helm, Johnson, and Vlissides treats issues of design patterns.  That book cuts an exellent balance between theory and practical application with careful attention paid to trade offs for a given pattern.  I'm particularly interrested in the following topics:

* How and when to apply partioning strategies
* Scalable backup strategies as databases grow in size
* How to handle tables that seem always to need more columns
* How to handle heavily queried and manipulated tables

Any help is greatly appreciated ;-)",2
10527108,05/10/2012 03:24:09,1386053,05/10/2012 03:16:16,1,0,SQL Server 2008 SP: Nested Select Possible?,"I am new to SQL server (just 2 days).  I have two tables.

One table is State_Manager (fields: name, email, state)

One table is Employee (fields: Name, State)

Common key is State.

What I need to do is loop through State_Manager table, using the field ""State"" and loop through the Employee table to pull out names of all employees in that state.

Then using EXEC msdb.dbo.sp_send_dbmail to email each state manager the list of employees in their state.

This is like a nested FOR loops in Programming 101. 

But I have no idea how to implement it in SQL server.",sql,server,select,nested,,05/11/2012 14:11:51,not a real question,1,95,7,"SQL Server 2008 SP: Nested Select Possible? I am new to SQL server (just 2 days).  I have two tables.

One table is State_Manager (fields: name, email, state)

One table is Employee (fields: Name, State)

Common key is State.

What I need to do is loop through State_Manager table, using the field ""State"" and loop through the Employee table to pull out names of all employees in that state.

Then using EXEC msdb.dbo.sp_send_dbmail to email each state manager the list of employees in their state.

This is like a nested FOR loops in Programming 101. 

But I have no idea how to implement it in SQL server.",4
11241391,06/28/2012 09:09:30,1488002,06/28/2012 08:58:26,1,0,sql statement retuns walue in wrong order from oracle 11g,"I need to get some data from an oracle database.In the database there's three columns, city, number and date. 

The problem is that for every city in the database, except one, the data is in the correct order, orderd by date. For this specific city, the last two have changed place.

I use the statement SELECT date FROM data_table WHERE city='city_name'

I have tried the 'order by' statement too, but it's not helping. Have anybond had a similar problem or does someone know what the problem might be?

Thanks in advance /Arvid

Example how it looks (correct):

1. New York   100   2012-01-19
2. New York   103   2012-02-04
3. New York   108   2012-03-27
4. New York   111   2012-04-14

Example how the one city that doesn't work looks

1. New York   100   2012-01-19
2. New York   103   2012-02-04
3. New York   111   2012-04-14
4. New York   108   2012-03-27
",sql,oracle11g,,,,06/28/2012 10:29:51,too localized,1,165,10,"sql statement retuns walue in wrong order from oracle 11g I need to get some data from an oracle database.In the database there's three columns, city, number and date. 

The problem is that for every city in the database, except one, the data is in the correct order, orderd by date. For this specific city, the last two have changed place.

I use the statement SELECT date FROM data_table WHERE city='city_name'

I have tried the 'order by' statement too, but it's not helping. Have anybond had a similar problem or does someone know what the problem might be?

Thanks in advance /Arvid

Example how it looks (correct):

1. New York   100   2012-01-19
2. New York   103   2012-02-04
3. New York   108   2012-03-27
4. New York   111   2012-04-14

Example how the one city that doesn't work looks

1. New York   100   2012-01-19
2. New York   103   2012-02-04
3. New York   111   2012-04-14
4. New York   108   2012-03-27
",2
3691732,09/11/2010 16:22:40,407528,07/31/2010 15:54:19,180,8,SubSonic column named 'Key',"I have a column named 'Key' in a MySQL database. Seems that the   

    repo.Find<Class>(x=>x.Key.StartsWith(""BLAH"")); 

generates the SQL code

    WHERE Key LIKE 'BLAH%'

instead of the correct one like
    
    WHERE `Key` LIKE 'BLAH%'

How can I force the later behaviour (is it a bug in SubSonic?) 

Cheers,
Tomasz
    ",sql,mysql,subsonic,subsonic3,subsonic-simplerepository,,open,0,64,4,"SubSonic column named 'Key' I have a column named 'Key' in a MySQL database. Seems that the   

    repo.Find<Class>(x=>x.Key.StartsWith(""BLAH"")); 

generates the SQL code

    WHERE Key LIKE 'BLAH%'

instead of the correct one like
    
    WHERE `Key` LIKE 'BLAH%'

How can I force the later behaviour (is it a bug in SubSonic?) 

Cheers,
Tomasz
    ",5
2317686,02/23/2010 11:31:17,279408,02/23/2010 11:31:17,1,0,Joining 2 SQL SELECT result sets into one,"I've got 2 select statements, returning data like this:

Select 1
col_a   col_b

Select 2
col_a   col_c

If I do union, I get something like
col_a col_b

And rows joined. What i need is getting it like this:
col_a  col_b  col_c

Joined on data in col_a.",sql,join,select,result,,,open,0,43,8,"Joining 2 SQL SELECT result sets into one I've got 2 select statements, returning data like this:

Select 1
col_a   col_b

Select 2
col_a   col_c

If I do union, I get something like
col_a col_b

And rows joined. What i need is getting it like this:
col_a  col_b  col_c

Joined on data in col_a.",4
623607,03/08/2009 13:50:58,47281,12/18/2008 03:16:49,65,6,Dynamic SQL Java library,"We need to generate dynamic SQL in our Java app.  Does anyone know a simple library to do this? 

In our Java app we have a bunch of `where` clause filter criteria (database column, operand, value).  In other words, we could have a `Date` instance that we need to use to filter a given `datetime` Oracle column, a `String` instance that we need to use to query a `varchar2` column, an `Integer` instance for a `number` column, etc.

Is there a library that will take a base query (`select a,b,c from d`) and some filter criteria and output sql in a valid format?  By valid format, I'd mean that the `String` filters would be surrounded by quotes, the `Integer` values wouldn't be surrounded by quotes, the `Date` values formatted using `to_date`, etc.  Something like this:

    select a, b, c from table --base query
    where
    date_col > to_date('2003/07/09 13:15', 'yyyy/mm/dd HH24:MM') and --Date 
    int_col = 5 and --Integer
    string_col = 'abc'

We weren't planning on using `PreparedStatement`-s as it seems like this would be harder to use to generate dynamic sql.  We are only doing `select`-s (don't need to worry about [sql injection][1] attacks).


  [1]: http://en.wikipedia.org/wiki/SQL_injection",sql,dynamic-sql,oracle,java,,,open,0,215,4,"Dynamic SQL Java library We need to generate dynamic SQL in our Java app.  Does anyone know a simple library to do this? 

In our Java app we have a bunch of `where` clause filter criteria (database column, operand, value).  In other words, we could have a `Date` instance that we need to use to filter a given `datetime` Oracle column, a `String` instance that we need to use to query a `varchar2` column, an `Integer` instance for a `number` column, etc.

Is there a library that will take a base query (`select a,b,c from d`) and some filter criteria and output sql in a valid format?  By valid format, I'd mean that the `String` filters would be surrounded by quotes, the `Integer` values wouldn't be surrounded by quotes, the `Date` values formatted using `to_date`, etc.  Something like this:

    select a, b, c from table --base query
    where
    date_col > to_date('2003/07/09 13:15', 'yyyy/mm/dd HH24:MM') and --Date 
    int_col = 5 and --Integer
    string_col = 'abc'

We weren't planning on using `PreparedStatement`-s as it seems like this would be harder to use to generate dynamic sql.  We are only doing `select`-s (don't need to worry about [sql injection][1] attacks).


  [1]: http://en.wikipedia.org/wiki/SQL_injection",4
8405293,12/06/2011 19:02:08,1079392,12/03/2011 20:34:46,11,0,SQL Query doesn`t work,"hi i have created these tables :

create table Department
(

D_Number int not null,
D_Name varchar(20),
D_MgrSSN int,
D_MgrDate datetime,

primary key(D_Number),
unique(D_Name),

)

create table Empolyee
(

E_SSN int not null,
E_FName varchar(20),
E_LName varchar(20),
E_Sex varchar(6),
E_BDate datetime,
E_Salary decimal(10,2),
E_Address varchar(50),
E_Department varchar(20),
E_SuperSSN int,

primary key(E_SSN),
foreign key(E_Department) references Department(D_Number),

)


and whe i run i get that error : Column 'Department.D_Number' is not the same data type as referencing column 'Empolyee.E_Department' in foreign key 'FK__Empolyee__E_Depa__0CBAE877'.",sql,query,,,,12/06/2011 21:03:10,too localized,1,57,4,"SQL Query doesn`t work hi i have created these tables :

create table Department
(

D_Number int not null,
D_Name varchar(20),
D_MgrSSN int,
D_MgrDate datetime,

primary key(D_Number),
unique(D_Name),

)

create table Empolyee
(

E_SSN int not null,
E_FName varchar(20),
E_LName varchar(20),
E_Sex varchar(6),
E_BDate datetime,
E_Salary decimal(10,2),
E_Address varchar(50),
E_Department varchar(20),
E_SuperSSN int,

primary key(E_SSN),
foreign key(E_Department) references Department(D_Number),

)


and whe i run i get that error : Column 'Department.D_Number' is not the same data type as referencing column 'Empolyee.E_Department' in foreign key 'FK__Empolyee__E_Depa__0CBAE877'.",2
10200333,04/17/2012 22:48:40,1175870,01/28/2012 23:53:26,8,0,sql query that not show all records,"i have a problem with a query, for example with this one i can retrieve the records:
 

    SELECT 
    l.*, 
    ll.f_cocacola as cocacola, 
     le.name AS deposit, 
     lp.price
    FROM 
     KPC AS l, 
     KPC_cocacola AS ll, 
     KPC_deposit AS le, 
     KPC_price AS lp 
    WHERE 
    l.cod_deposit = le.id_deposit 
    AND l.code = ll.code
    AND lp.code = l.code
    AND l.code_deposit = '002365' 


but now i need to include another date from another table -intranet- that has the fields *code* and *url* then need to show from this table the *url* field .. keep in mind that the relationship is on the *code* field.

so i change the query in this way:

    SELECT l.*,ll.f_cocacola as cocacola, le.name AS deposit, 
    lp.price, lintranet.url 
    FROM tableX AS l, intranet_cocacola AS ll, tableX_deposit AS le, 
    tableX_price AS lp, 
    tableX_intranet as lintranet 
    WHERE l.code_deposit = le.id_deposit
    AND l.code = ll.code
    AND lp.code = l.code 
    AND l.code = lintranet.code
    AND l.code_deposit = '456852147'

 

but the issue is that some records don't have a *url* and if is not exist a *url* then this query don't show me the record .. well what i need that even if there is not a *url* associated to a record i want to see that recorda, thanks",sql,oracle,plsql,,,,open,0,297,7,"sql query that not show all records i have a problem with a query, for example with this one i can retrieve the records:
 

    SELECT 
    l.*, 
    ll.f_cocacola as cocacola, 
     le.name AS deposit, 
     lp.price
    FROM 
     KPC AS l, 
     KPC_cocacola AS ll, 
     KPC_deposit AS le, 
     KPC_price AS lp 
    WHERE 
    l.cod_deposit = le.id_deposit 
    AND l.code = ll.code
    AND lp.code = l.code
    AND l.code_deposit = '002365' 


but now i need to include another date from another table -intranet- that has the fields *code* and *url* then need to show from this table the *url* field .. keep in mind that the relationship is on the *code* field.

so i change the query in this way:

    SELECT l.*,ll.f_cocacola as cocacola, le.name AS deposit, 
    lp.price, lintranet.url 
    FROM tableX AS l, intranet_cocacola AS ll, tableX_deposit AS le, 
    tableX_price AS lp, 
    tableX_intranet as lintranet 
    WHERE l.code_deposit = le.id_deposit
    AND l.code = ll.code
    AND lp.code = l.code 
    AND l.code = lintranet.code
    AND l.code_deposit = '456852147'

 

but the issue is that some records don't have a *url* and if is not exist a *url* then this query don't show me the record .. well what i need that even if there is not a *url* associated to a record i want to see that recorda, thanks",3
8508492,12/14/2011 16:59:43,880954,08/05/2011 16:30:48,96,1,Apply Where Clause if Condition Met,"I want to apply a where clause if a local variable is not null. eg.

    declare @controlName nvarchar(250);
    		
    	SELECT 
    		*
    	FROM
    	(
    	SELECT  TOP (100) PERCENT 
    		dbo.Blah.PageName, 
    		dbo.BlahBlah.ControlName, 
    		dbo.BlahBlah.ControlText, 
    		'en' AS FriedEgg
    	FROM         
    		dbo.WebPageText INNER JOIN
            dbo.Blah ON dbo.BlahBlah.WebPageID = dbo.Blah.WebPageID
         
         if @controlName is not null
       
             WHERE dbo.BlahBlah.ControlName = IN(@controlName, not null)

So if the control name  variable is not null, apply the where clause",sql,,,,,,open,0,167,6,"Apply Where Clause if Condition Met I want to apply a where clause if a local variable is not null. eg.

    declare @controlName nvarchar(250);
    		
    	SELECT 
    		*
    	FROM
    	(
    	SELECT  TOP (100) PERCENT 
    		dbo.Blah.PageName, 
    		dbo.BlahBlah.ControlName, 
    		dbo.BlahBlah.ControlText, 
    		'en' AS FriedEgg
    	FROM         
    		dbo.WebPageText INNER JOIN
            dbo.Blah ON dbo.BlahBlah.WebPageID = dbo.Blah.WebPageID
         
         if @controlName is not null
       
             WHERE dbo.BlahBlah.ControlName = IN(@controlName, not null)

So if the control name  variable is not null, apply the where clause",1
10749121,05/25/2012 05:50:26,174129,09/16/2009 06:00:16,1671,86,How to regroup records with different values in one SQL query,"Let's say I have the following table :

    Name - Country - Age
    --------------------
    Toto - Switzerland - 10
    Titi - France - 12
    Tata - Italy - 21
    Tutu - England - 13
    Tete - Italy - 14

I want to create a sql query as simple as possible to regroup people living in defined grouped countries like :

Group A = Switzerland + Italy
Group B = France + England

I don't know how to create a group withn my records with a column that could have multiple different values in the same group...

Could somebody help me with this ?

More information : SQL Server 2008 database.",sql,query,columns,group,,,open,0,125,11,"How to regroup records with different values in one SQL query Let's say I have the following table :

    Name - Country - Age
    --------------------
    Toto - Switzerland - 10
    Titi - France - 12
    Tata - Italy - 21
    Tutu - England - 13
    Tete - Italy - 14

I want to create a sql query as simple as possible to regroup people living in defined grouped countries like :

Group A = Switzerland + Italy
Group B = France + England

I don't know how to create a group withn my records with a column that could have multiple different values in the same group...

Could somebody help me with this ?

More information : SQL Server 2008 database.",4
3620828,09/01/2010 18:00:15,175071,09/17/2009 16:25:19,252,9,sqlite select where empty?,"Select in sqlite where some_colum is empty.
empty counts as both NULL and """".",sql,sqlite,select,isnullorempty,,,open,0,13,4,"sqlite select where empty? Select in sqlite where some_colum is empty.
empty counts as both NULL and """".",4
7846606,10/21/2011 08:01:41,109849,05/20/2009 10:16:24,351,7,"Keeping getting a Msg 102, Level 15, State 1, Line 18 Incorrect syntax near 'e'.","    SELECT TOP(5000) 
     a.actions, 
     b.backtracks, 
     i.items,  
     u.users,     
     ROUND(a.actions/u.users,2) AS average_actions_per_user,     
     ROUND((e.number_of_total_actions_of_items_in_itemassoc/a.actions)*100,2) as recommendation_coverage  
     FROM  (SELECT count(1) as actions FROM [action] WHERE tenantid='1') a JOIN  
    	   (SELECT count(1) as backtracks FROM backtracking WHERE tenantid='') b JOIN   
    	   (SELECT count(1) as items FROM (SELECT distinct itemid FROM [action] where tenantid = '1') a) i JOIN    
    	   (SELECT count(1) as users FROM (SELECT distinct userid FROM [action] where tenantid = '1') a) u JOIN  
    	   
    	   (SELECT SUM(c) AS number_of_total_actions_of_items_in_itemassoc FROM 
    	   (SELECT c FROM 
           (SELECT itemid, itemtypeid, tenantid, COUNT(1) as c 
    			FROM [action] WHERE tenantid = '1' GROUP BY itemId,itemTypeId,tenantId) a 
    			INNER JOIN itemassoc i ON (i.itemfromid = a.itemid AND a.itemtypeid = i.itemFromTypeId AND a.tenantid = i.tenantid)
    			     GROUP BY a.itemid, a.itemtypeid, a.tenantid) a) e JOIN 


Can someone help me? I see the error, but I don't know why it's happening :( ",sql,sql-server,tsql,sql-server-2008,,,open,0,259,15,"Keeping getting a Msg 102, Level 15, State 1, Line 18 Incorrect syntax near 'e'.     SELECT TOP(5000) 
     a.actions, 
     b.backtracks, 
     i.items,  
     u.users,     
     ROUND(a.actions/u.users,2) AS average_actions_per_user,     
     ROUND((e.number_of_total_actions_of_items_in_itemassoc/a.actions)*100,2) as recommendation_coverage  
     FROM  (SELECT count(1) as actions FROM [action] WHERE tenantid='1') a JOIN  
    	   (SELECT count(1) as backtracks FROM backtracking WHERE tenantid='') b JOIN   
    	   (SELECT count(1) as items FROM (SELECT distinct itemid FROM [action] where tenantid = '1') a) i JOIN    
    	   (SELECT count(1) as users FROM (SELECT distinct userid FROM [action] where tenantid = '1') a) u JOIN  
    	   
    	   (SELECT SUM(c) AS number_of_total_actions_of_items_in_itemassoc FROM 
    	   (SELECT c FROM 
           (SELECT itemid, itemtypeid, tenantid, COUNT(1) as c 
    			FROM [action] WHERE tenantid = '1' GROUP BY itemId,itemTypeId,tenantId) a 
    			INNER JOIN itemassoc i ON (i.itemfromid = a.itemid AND a.itemtypeid = i.itemFromTypeId AND a.tenantid = i.tenantid)
    			     GROUP BY a.itemid, a.itemtypeid, a.tenantid) a) e JOIN 


Can someone help me? I see the error, but I don't know why it's happening :( ",4
3279935,07/19/2010 09:41:59,394435,07/17/2010 02:34:28,118,16,What is wrong with this SQL?,"I'm sure this is something really simple that I'm overlooking, but MS SQL is new to me -- I am (or at least thought I was) fairly comfortable with basic MySql though.

    SELECT l.link_id, l.link_allcount, d.desc_id, d.desc_count, d.desc_text, h.hour_17,   dl.day_19 
    FROM lnktrk_links AS l, lnktrk_hourly AS h, lnktrk_daily AS dl 
    LEFT JOIN lnktrk_descriptions AS d ON l.link_id = d.link_id 
    WHERE l.link_id = h.link_id AND l.link_id = dl.link_id AND l.link_is_click = 1

The error I get is:

    'The multi-part identifier ""l.link_id"" could not be bound.

However l.link_id definitely exists. The following query without the join works as expected:

    SELECT l.link_id, l.link_allcount, d.desc_id, d.desc_count, d.desc_text, h.hour_17, dl.day_19 
    FROM lnktrk_links AS l, lnktrk_hourly AS h, lnktrk_daily AS dl, lnktrk_descriptions AS d 
    WHERE l.link_id = h.link_id AND l.link_id = dl.link_id AND d.link_id = l.link_id AND l.link_is_click = 1",sql,sql-server,asp-classic,asp,left-join,,open,0,163,6,"What is wrong with this SQL? I'm sure this is something really simple that I'm overlooking, but MS SQL is new to me -- I am (or at least thought I was) fairly comfortable with basic MySql though.

    SELECT l.link_id, l.link_allcount, d.desc_id, d.desc_count, d.desc_text, h.hour_17,   dl.day_19 
    FROM lnktrk_links AS l, lnktrk_hourly AS h, lnktrk_daily AS dl 
    LEFT JOIN lnktrk_descriptions AS d ON l.link_id = d.link_id 
    WHERE l.link_id = h.link_id AND l.link_id = dl.link_id AND l.link_is_click = 1

The error I get is:

    'The multi-part identifier ""l.link_id"" could not be bound.

However l.link_id definitely exists. The following query without the join works as expected:

    SELECT l.link_id, l.link_allcount, d.desc_id, d.desc_count, d.desc_text, h.hour_17, dl.day_19 
    FROM lnktrk_links AS l, lnktrk_hourly AS h, lnktrk_daily AS dl, lnktrk_descriptions AS d 
    WHERE l.link_id = h.link_id AND l.link_id = dl.link_id AND d.link_id = l.link_id AND l.link_is_click = 1",5
5437909,03/25/2011 20:41:15,660065,03/15/2011 06:30:18,40,9,How do SQL server 2000 and XML linked?,"How do SQL server 2000 and XML linked? Can XML be used to access data?
FOR XML (ROW, AUTO, EXPLICIT)",sql,xml,,,,03/25/2011 21:14:16,not a real question,1,19,8,"How do SQL server 2000 and XML linked? How do SQL server 2000 and XML linked? Can XML be used to access data?
FOR XML (ROW, AUTO, EXPLICIT)",2
6962876,08/05/2011 21:34:42,706697,04/13/2011 19:33:26,60,0,PHP & SQL: Function to insert and update tables not working,"I have a simple code where tables are created and modified, but the tables are not created to start with, and the following errors are appearing:

    Undefined variable: price on line 28
    Undefined variable: newbrand on line 28
    Undefined variable: newprice on line 28

Line 28:

    $conexion-> modify(""Mitsubishi"",40000000,$price,$newbrand,$newprice);

Complete code:

    <?php
    
    class MyDataBase{
        private $link;
    
        public function __construct($server,$user,$password,$base){
            //Conectar
            $this->link = mysql_connect($server,$user,$password);
            mysql_select_db($base,$this->link);
            }
    
            public function insert($model,$brand,$price){
                mysql_query(""INSERT INTO autos (model, brand, price) VALUES ($model,'$brand', $price)"",$this->link);}
    
            public function modify($model,$brand,$price,$newbrand,$newprice){
                mysql_query(""UPDATE 'crautos'.'autos' SET 'brand' = '$newbrand',
    						'price' = '$newprice' WHERE 'autos'.'model' =5 AND 'autos'.'brand' = '$brand' AND 'autos'.'price' ='$price' LIMIT 1"" ,$this->link);}
    
            public function __destruct(){
            //desconectar
            }
    
    }
    
    
    $conexion = new MyDataBase ('localhost', 'root', '','crcars');
    $conexion-> insert(05,""Ford"",50000000);
    $conexion-> modify(""Mitsubishi"",40000000,$price,$newbrand,$newprice);
    ?>",sql,database,table,database-connection,,,open,0,328,11,"PHP & SQL: Function to insert and update tables not working I have a simple code where tables are created and modified, but the tables are not created to start with, and the following errors are appearing:

    Undefined variable: price on line 28
    Undefined variable: newbrand on line 28
    Undefined variable: newprice on line 28

Line 28:

    $conexion-> modify(""Mitsubishi"",40000000,$price,$newbrand,$newprice);

Complete code:

    <?php
    
    class MyDataBase{
        private $link;
    
        public function __construct($server,$user,$password,$base){
            //Conectar
            $this->link = mysql_connect($server,$user,$password);
            mysql_select_db($base,$this->link);
            }
    
            public function insert($model,$brand,$price){
                mysql_query(""INSERT INTO autos (model, brand, price) VALUES ($model,'$brand', $price)"",$this->link);}
    
            public function modify($model,$brand,$price,$newbrand,$newprice){
                mysql_query(""UPDATE 'crautos'.'autos' SET 'brand' = '$newbrand',
    						'price' = '$newprice' WHERE 'autos'.'model' =5 AND 'autos'.'brand' = '$brand' AND 'autos'.'price' ='$price' LIMIT 1"" ,$this->link);}
    
            public function __destruct(){
            //desconectar
            }
    
    }
    
    
    $conexion = new MyDataBase ('localhost', 'root', '','crcars');
    $conexion-> insert(05,""Ford"",50000000);
    $conexion-> modify(""Mitsubishi"",40000000,$price,$newbrand,$newprice);
    ?>",4
8028931,11/06/2011 17:35:56,30512,10/22/2008 19:44:43,1069,57,Extra clauses with a CTE and Geopgraphy datatype,"I'm creating a query to match based on distance people using zip codes using the Geography datatype in SQL Server. I have it 99% there, but I have two problems. At the moment, this searches by zip, city and state, but I also need to match on [u.username] really. I can't get the syntax right to add an ""OR Username LIKE @Name"". Secondly, the performance isn't great. With 21 test users from all over the US, the query takes 4 seconds.

Is there a way to speed this up and add the extra search parameters. I have this so far:

    DECLARE @miles [float] = 10000;
    DECLARE @myposition geography;
    SELECT @myposition = GeoLocation FROM ZipCodes
    WHERE Zip LIKE '11204';
    
    SELECT z.*,z.GeoLocation.STDistance(@myposition) AS Distance INTO #HASHTABLE FROM ZipCodes z
    WHERE z.GeoLocation.STDistance(@myposition) <= (@miles*1609.344)
    ORDER BY Distance asc
    
    ;WITH Results_CTE AS (SELECT u.*,z.GeoLocation.STDistance(@myposition) AS Distance, ROW_NUMBER() OVER (ORDER BY z.GeoLocation.STDistance(@myposition)) AS RowNum
    FROM Users u INNER JOIN ZipCodes z ON u.PostCode = z.Zip
    WHERE u.PostCode in (SELECT Zip from #hashtable) OR u.City in (SELECT City from #hashtable) 
    ) SELECT * FROM Results_CTE WHERE RowNum > 0 
    DROP TABLE #Hashtable

",sql,sql-server,geolocation,sql-server-2008-r2,sqlgeography,,open,0,231,8,"Extra clauses with a CTE and Geopgraphy datatype I'm creating a query to match based on distance people using zip codes using the Geography datatype in SQL Server. I have it 99% there, but I have two problems. At the moment, this searches by zip, city and state, but I also need to match on [u.username] really. I can't get the syntax right to add an ""OR Username LIKE @Name"". Secondly, the performance isn't great. With 21 test users from all over the US, the query takes 4 seconds.

Is there a way to speed this up and add the extra search parameters. I have this so far:

    DECLARE @miles [float] = 10000;
    DECLARE @myposition geography;
    SELECT @myposition = GeoLocation FROM ZipCodes
    WHERE Zip LIKE '11204';
    
    SELECT z.*,z.GeoLocation.STDistance(@myposition) AS Distance INTO #HASHTABLE FROM ZipCodes z
    WHERE z.GeoLocation.STDistance(@myposition) <= (@miles*1609.344)
    ORDER BY Distance asc
    
    ;WITH Results_CTE AS (SELECT u.*,z.GeoLocation.STDistance(@myposition) AS Distance, ROW_NUMBER() OVER (ORDER BY z.GeoLocation.STDistance(@myposition)) AS RowNum
    FROM Users u INNER JOIN ZipCodes z ON u.PostCode = z.Zip
    WHERE u.PostCode in (SELECT Zip from #hashtable) OR u.City in (SELECT City from #hashtable) 
    ) SELECT * FROM Results_CTE WHERE RowNum > 0 
    DROP TABLE #Hashtable

",5
3928097,10/13/2010 21:18:16,199712,10/30/2009 15:06:00,175,12,The necessity of auto-incrementing primary keys,"Almost every table in every database I've seen in my 7 years of development experience has an auto-incrementing primary key. Why is this? If I have a table of U.S. states where each state where each state must have a unique name, what's the use of an auto-incrementing primary key? Why not just use the state name as the primary key? Seems to me like an excuse to allow duplicates disguised as unique rows.

This seems plainly obvious to me, but then again, no one else seems to be arriving at and acting on the same logical conclusion as me, so I must assume there's a good chance I'm wrong.

Is there any real, practical reason we need to use auto-incrementing keys?",sql,database,relational-database,relational-model,,10/13/2010 23:15:57,not constructive,1,120,6,"The necessity of auto-incrementing primary keys Almost every table in every database I've seen in my 7 years of development experience has an auto-incrementing primary key. Why is this? If I have a table of U.S. states where each state where each state must have a unique name, what's the use of an auto-incrementing primary key? Why not just use the state name as the primary key? Seems to me like an excuse to allow duplicates disguised as unique rows.

This seems plainly obvious to me, but then again, no one else seems to be arriving at and acting on the same logical conclusion as me, so I must assume there's a good chance I'm wrong.

Is there any real, practical reason we need to use auto-incrementing keys?",4
10314771,04/25/2012 11:35:39,1017742,10/28/2011 04:58:01,30,0,is this sql table definition and relations is right?,"The problem is not big but logic comes hard sometime so the same is there. I have to save the customer data into a sql tables. the customer record looks like this in a excel shet. The contract duration lies 6 month or 12 month. every customer pay in installments after a month. every month have two records installment amount and commision amount. the excel sheet has record data like this 

        SR,CustomerID,Customername,CompanyName,relationType,ContractStartDate,ContractDuration,TotalInstallment,Comission,paymentMode,JanuaryInstallment,JanuaryCommision,.......DecemberMonthInstallment,DecemberMonthCommision

for this i have define these tables in sql 
![enter image description here][1]


  [1]: http://i.stack.imgur.com/zjTSo.png

are these tables are in correct manner? and i'm confused about the month name record do i put it in the installment table with every installment like(firstInstallmentMonth,firstinstallment,firstinstallmentCommision) I'm confused guid me seniors?",sql,database-design,,,,04/26/2012 11:54:34,not constructive,1,126,9,"is this sql table definition and relations is right? The problem is not big but logic comes hard sometime so the same is there. I have to save the customer data into a sql tables. the customer record looks like this in a excel shet. The contract duration lies 6 month or 12 month. every customer pay in installments after a month. every month have two records installment amount and commision amount. the excel sheet has record data like this 

        SR,CustomerID,Customername,CompanyName,relationType,ContractStartDate,ContractDuration,TotalInstallment,Comission,paymentMode,JanuaryInstallment,JanuaryCommision,.......DecemberMonthInstallment,DecemberMonthCommision

for this i have define these tables in sql 
![enter image description here][1]


  [1]: http://i.stack.imgur.com/zjTSo.png

are these tables are in correct manner? and i'm confused about the month name record do i put it in the installment table with every installment like(firstInstallmentMonth,firstinstallment,firstinstallmentCommision) I'm confused guid me seniors?",2
968305,06/09/2009 05:32:29,90922,04/15/2009 03:45:48,12,1,Advanced grouping without using a sub query,"This is a sample of the data that I have.

    -ID-		-Rank-		-Type-		-Status-	-Amount-
    1142474		2		Under Offer	Approved 	23
    1148492		1		Present		Current	 	56
    1148492		2		Under Offer	Approved 	3
    2273605		1		Present		Current 	24

Where the ID is the same I only want the record with the highest rank. So the end result of the query.

    -ID-		-Rank-		-Type-		-Status-	-Amount-
    1142474		2		Under Offer	Approved 	23
    1148492		1		Present		Current	 	56
    2273605		1		Present		Current 	24

Now to get the original data set is an expensive operation, so **I *don't* want to** do a **group by the ID** and then **mins the rank** and **then joins back** onto the dataset again. Hence the query needs to do its work another way.

Cheers
Anthony",sql,sql-server,tsql,query,,,open,0,121,7,"Advanced grouping without using a sub query This is a sample of the data that I have.

    -ID-		-Rank-		-Type-		-Status-	-Amount-
    1142474		2		Under Offer	Approved 	23
    1148492		1		Present		Current	 	56
    1148492		2		Under Offer	Approved 	3
    2273605		1		Present		Current 	24

Where the ID is the same I only want the record with the highest rank. So the end result of the query.

    -ID-		-Rank-		-Type-		-Status-	-Amount-
    1142474		2		Under Offer	Approved 	23
    1148492		1		Present		Current	 	56
    2273605		1		Present		Current 	24

Now to get the original data set is an expensive operation, so **I *don't* want to** do a **group by the ID** and then **mins the rank** and **then joins back** onto the dataset again. Hence the query needs to do its work another way.

Cheers
Anthony",4
9590560,03/06/2012 19:33:44,1253073,03/06/2012 19:23:30,1,0,DB connections are closing causing slow performance: MS SQL SERVER,"I have two applications that uses the same 2 databases. 1 application runs fine, no performance issues. When i run the query below i get 1 connection per database. They stay open for a while. So as I browse it seems that those two connections are reused. After a while they close. 

When I run the second application the connection is opened and immediately closed. I notice that when I run the query below the values of the number of connections increases while the page is refreshing and as soon as the page is done loading the number of connections is reduced. 

I added this to the connection string: 

       Max Pool Size=75;Min Pool Size=5;

but the number of connections now jumped from 0 to 5 and then jumps back down to 0

This is causing the app to be very slow as some pages have many queries in them. 

Any help on resolving this issue would be appreciated.

The query:



 

    SELECT
       DB_NAME(dbid) as DBName, 
       COUNT(dbid) as NumberOfConnections,
       loginame as LoginName
      FROM
       sys.sysprocesses
     WHERE 
       dbid > 0
    GROUP BY 
       dbid, loginame	",sql,sql-server-2008,connection-pooling,,,,open,0,239,10,"DB connections are closing causing slow performance: MS SQL SERVER I have two applications that uses the same 2 databases. 1 application runs fine, no performance issues. When i run the query below i get 1 connection per database. They stay open for a while. So as I browse it seems that those two connections are reused. After a while they close. 

When I run the second application the connection is opened and immediately closed. I notice that when I run the query below the values of the number of connections increases while the page is refreshing and as soon as the page is done loading the number of connections is reduced. 

I added this to the connection string: 

       Max Pool Size=75;Min Pool Size=5;

but the number of connections now jumped from 0 to 5 and then jumps back down to 0

This is causing the app to be very slow as some pages have many queries in them. 

Any help on resolving this issue would be appreciated.

The query:



 

    SELECT
       DB_NAME(dbid) as DBName, 
       COUNT(dbid) as NumberOfConnections,
       loginame as LoginName
      FROM
       sys.sysprocesses
     WHERE 
       dbid > 0
    GROUP BY 
       dbid, loginame	",3
3847732,10/02/2010 22:18:48,464859,10/02/2010 22:18:48,1,0,CouchDB select all where field contains value,"Is it possible to select all documents where a field contains a value.

i.e is the following sql possible?

    Select * FROM table WHERE field LIKE %substring%
",sql,couchdb,,,,,open,0,29,7,"CouchDB select all where field contains value Is it possible to select all documents where a field contains a value.

i.e is the following sql possible?

    Select * FROM table WHERE field LIKE %substring%
",2
11667261,07/26/2012 10:21:21,1083736,12/06/2011 14:56:58,3,5,Disable access to the DB via Windows Authentication.also disable SQL Management Studio,"I am deploying my application including database for a client. what i need is to install sql server 2008 **Without  SQL Management Studio** so that only i can access the db using my laptop.
what should i do for that...?",sql,sql-server,sql-server-2008,,,07/30/2012 06:34:44,off topic,1,40,12,"Disable access to the DB via Windows Authentication.also disable SQL Management Studio I am deploying my application including database for a client. what i need is to install sql server 2008 **Without  SQL Management Studio** so that only i can access the db using my laptop.
what should i do for that...?",3
8492606,12/13/2011 16:30:33,222427,12/01/2009 21:04:28,1063,8,sql select column names where the column is a key,"using this query, 

    SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.Columns where TABLE_NAME <table>

how would i modify it to select only column names that are primary keys? or keys of any type?

Using the same type of select is prefered.",sql,,,,,,open,0,39,10,"sql select column names where the column is a key using this query, 

    SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.Columns where TABLE_NAME <table>

how would i modify it to select only column names that are primary keys? or keys of any type?

Using the same type of select is prefered.",1
10999396,06/12/2012 15:03:49,850749,07/18/2011 19:52:20,968,72,How do I use an INSERT statement's OUTPUT clause to get the identity value?,"If I have an insert statement such as:

    INSERT INTO MyTable
    (  
      Name,
      Address,
      PhoneNo
    )
    VALUES
    (
      'Yatrix',
       '1234 Address Stuff',
       '1112223333'
    )

How do I set `@var INT` to the new row's identity value (called `Id`) using the OUTPUT clause? I've seen samples of putting INSERTED.Name into table variables, for example, but I can't get it into a non-table variable. 

I've tried `OUPUT INSERTED.Id AS @var`, `SET @var = INSERTED.Id`, but neither have worked. 

Thanks in advance.
",sql,sql-server-2005,insert,output,,,open,0,130,14,"How do I use an INSERT statement's OUTPUT clause to get the identity value? If I have an insert statement such as:

    INSERT INTO MyTable
    (  
      Name,
      Address,
      PhoneNo
    )
    VALUES
    (
      'Yatrix',
       '1234 Address Stuff',
       '1112223333'
    )

How do I set `@var INT` to the new row's identity value (called `Id`) using the OUTPUT clause? I've seen samples of putting INSERTED.Name into table variables, for example, but I can't get it into a non-table variable. 

I've tried `OUPUT INSERTED.Id AS @var`, `SET @var = INSERTED.Id`, but neither have worked. 

Thanks in advance.
",4
3685381,09/10/2010 14:24:55,192204,10/19/2009 03:57:14,346,3,A lot of Many To Manys,"I am working on a DB Structure and it seems like I have ended up with a lot of many to many tables.  The reason I have am getting so many of them is that my base table is items and each item can have multiple occurrences of the search criteria that will be surfaced to the users.  So I normalized all of the search criteria and used many to many tables to link the items and search criteria.  For whatever reason it just doesn't feel right to have 7 search criteria tables and 7 many to manys.  

Are there better ways to formulate these relationships and still hold to 3rd normal form? 

As always greatly appreciate the input.

--S",sql,tsql,sql-server-2008,,,,open,0,123,6,"A lot of Many To Manys I am working on a DB Structure and it seems like I have ended up with a lot of many to many tables.  The reason I have am getting so many of them is that my base table is items and each item can have multiple occurrences of the search criteria that will be surfaced to the users.  So I normalized all of the search criteria and used many to many tables to link the items and search criteria.  For whatever reason it just doesn't feel right to have 7 search criteria tables and 7 many to manys.  

Are there better ways to formulate these relationships and still hold to 3rd normal form? 

As always greatly appreciate the input.

--S",3
11265864,06/29/2012 16:52:33,78162,03/14/2009 23:55:56,7187,331,All-or-none exclusive lock on 2 SQL tables,"My simplistic testing suggested that I can acquire an exclusive lock on 2 tables or postpone acquiring the lock on either until both can be acquired at once by using a query like this:

    SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK)
    WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode

the key feature being the CROSS JOIN used to include multiple tables in a single query. I confirmed that if an exclusive lock already exists on the OITM row for @ItemCode in another transaction, then this statement doesn't introduce any lock on ONNM until it can acquire both locks. However, in the more complex full test run, SQL profiler returns some conflicting information. I have imported the SQL profiler results into a table and executed the following query:

    select rownum, e.name, EventClass, TextData, SPID, ClientProcessID from #pmit t
    join sys.trace_events e on t.EventClass = e.trace_event_id
    where rownum between 275799 and 546130
    and (TextData LIKE '(ca73a6396124)' or TextData LIKE '(36fa3e654c8f)'
         or TextData LIKE '%(XLOCK)%' or TextData LIKE '%DeadLock%')
    order by rownum

And these are the results I got back:

    Row    | Event                | SPID | Text
    275799 | SP:StmtStarting      | 99   | SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode
    304781 | Lock:Acquired        | 139  | (36fa3e654c8f)
    305365 | Lock:Acquired        | 139  | (36fa3e654c8f)
    351093 | Lock:Acquired        | 139  | (ca73a6396124)
    468768 | Lock:Released        | 13   | (ca73a6396124)
    470912 | Lock:Released        | 13   | (36fa3e654c8f)
    470922 | Lock:Acquired        | 164  | (36fa3e654c8f)
    470928 | Lock:Released        | 164  | (36fa3e654c8f)
    470971 | Lock:Acquired        | 99   | (36fa3e654c8f)
    471013 | RPC:Completed        | 99   | exec sp_executesql N'SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (''20'', ''10000048'') AND ItemCode = @ItemCode',N'@ItemCode nvarchar(3)',@ItemCode=N'FX1'
    490843 | SP:StmtStarting      | 78   | SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode
    490848 | Lock:Acquired        | 78   | (ca73a6396124)
    495391 | Lock:Acquired        | 114  | (36fa3e654c8f)
    495396 | Lock:Acquired        | 114  | (36fa3e654c8f)
    542738 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 78 (36fa3e654c8f)                                                                                                                                                                                                                                                  
    545746 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 154 (36fa3e654c8f)                                                                                                                                                                                                                                                  
    545769 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 114 (ca73a6396124)                                                                                                                                                                                                                                                  
    545982 | Lock:Deadlock        | 78   | (36fa3e654c8f)
    545985 | RPC:Completed        | 78   | exec sp_executesql N'SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (''20'', ''10000048'') AND ItemCode = @ItemCode',N'@ItemCode nvarchar(3)',@ItemCode=N'FC3'
    545990 | Lock:Released        | 78   | (ca73a6396124)
    545998 | Lock:Acquired        | 114  | (ca73a6396124)
    546130 | Deadlock graph       | 17	 | (See below)

The deadlock graph is as follows:

    <deadlock-list>
       <deadlock victim=""process5e3ae08"">
          <process-list>
             <process id=""process5e3ae08"" taskpriority=""0"" logused=""0"" waitresource=""KEY: 6:72057598620205056 (36fa3e654c8f)"" waittime=""9507"" ownerId=""513854688"" transactionname=""user_transaction"" lasttranstarted=""2012-06-28T13:38:54.463"" XDES=""0x1bbf9b950"" lockMode=""RangeX-X"" schedulerid=""6"" kpid=""13248"" status=""suspended"" spid=""78"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2012-06-28T13:38:54.483"" lastbatchcompleted=""2012-06-28T13:38:54.463"" clientapp="".Net SqlClient Data Provider"" hostname=""PMIUSRSTL00013"" hostpid=""3180"" loginname=""RICFSE01SAPB1"" isolationlevel=""serializable (4)"" xactid=""513854688"" currentdb=""6"" lockTimeout=""4294967295"" clientoption1=""671088672"" clientoption2=""128056"">
                <executionStack>
                   <frame procname=""adhoc"" line=""1"" stmtstart=""46"" sqlhandle=""0x02000000151c651e3c8b4437ee414cefdbc46b70aceca960"">  SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (&apos;20&apos;, &apos;10000048&apos;) AND ItemCode = @ItemCode     </frame>
                   <frame procname=""unknown"" line=""1"" sqlhandle=""0x000000000000000000000000000000000000000000000000"">  unknown     </frame>
                </executionStack>
                <inputbuf>  (@ItemCode nvarchar(3))SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (&apos;20&apos;, &apos;10000048&apos;) AND ItemCode = @ItemCode    </inputbuf>
             </process>
             <process id=""process5e45048"" taskpriority=""0"" logused=""0"" waitresource=""KEY: 6:72057598620205056 (36fa3e654c8f)"" waittime=""12866"" ownerId=""513845303"" transactionname=""SELECT"" lasttranstarted=""2012-06-28T13:38:28.463"" XDES=""0x80048e50"" lockMode=""S"" schedulerid=""7"" kpid=""12772"" status=""suspended"" spid=""154"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""0"" lastbatchstarted=""2012-06-28T13:38:28.390"" lastbatchcompleted=""2012-06-28T13:38:28.380"" lastattention=""2012-06-28T13:38:27.927"" clientapp=""TagClerkService"" hostname=""PMIUSRSTW00008"" hostpid=""2772"" loginname=""RICFSE01SAPB1"" isolationlevel=""read committed (2)"" xactid=""513845303"" currentdb=""6"" lockTimeout=""4294967295"" clientoption1=""671088672"" clientoption2=""128056"">
                <executionStack>
                   <frame procname=""adhoc"" line=""1"" sqlhandle=""0x020000000d86e30171762b464b35e0923de532c497188b81"">  SELECT T0.*  FROM [dbo].[ONNM] T0     </frame>
                </executionStack>
                <inputbuf>  SELECT T0.*  FROM [dbo].[ONNM] T0    </inputbuf>
             </process>
             <process id=""process5e31708"" taskpriority=""0"" logused=""25240"" waitresource=""KEY: 6:72057597517103104 (ca73a6396124)"" waittime=""2031"" ownerId=""513831818"" transactionguid=""0xdefde99023405d4a96d101faac79ef96"" transactionname=""user_transaction"" lasttranstarted=""2012-06-28T13:38:19.237"" XDES=""0xd68df950"" lockMode=""RangeS-S"" schedulerid=""5"" kpid=""11564"" status=""suspended"" spid=""114"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2012-06-28T13:38:58.560"" lastbatchcompleted=""2012-06-28T13:38:58.490"" lastattention=""2012-06-28T12:48:33.060"" clientapp=""TagClerkService"" hostname=""PMIUSRSTL00011"" hostpid=""2908"" loginname=""RICFSE01SAPB1"" isolationlevel=""serializable (4)"" xactid=""513831818"" currentdb=""6"" lockTimeout=""4294967295"" clientoption1=""671088672"" clientoption2=""128056"">
                <executionStack>
                   <frame procname=""adhoc"" line=""1"" stmtstart=""24"" sqlhandle=""0x02000000a329a30eb1319f2df684296f889a1613a585b3a0"">  SELECT ISNULL(a.U_FSE_ApplicationUsr,a.UserSign) ,a.DocNum ,b.LineNum ,f.IsLotTraced ,h.LotNumber ,b.WhsCode ,n.Bin ,g.Quantity ,b.LineTotal ,i.OnTimeDeliveryDaysEarly ,i.OnTimeDeliveryDaysLate ,i.ReceiptVarianceUnderAllowed ,i.ReceiptVarianceOverAllowed ,k.ItemCode ,d.Revision ,a.Comments ,e.RolledMaterialCost ,e.RolledLaborCost ,e.RolledVariableOverheadCost ,e.RolledFixedOverheadCost ,e.RolledOutsideCost ,ISNULL(c.Quantity, c2.Quantity) ,c.DocumentLineDetailKey /* TODO: Handle serial numbers for blanket deliveries */ ,ISNULL(c.InventoryCode, c2.InventoryCode) ,k.InvntryUom ,r.Resource ,p.ItemName ,CASE WHEN m.MOKey IS NULL THEN NULL ELSE b.U_FSE_STypeItemQty END ,a.DocDate FROM OPDN a LEFT JOIN PDN1 b ON a.DocEntry=b.DocEntry  LEFT JOIN FSE_PurchaseGoodsReceiptLineDetail c ON (b.DocEntry=c.DocumentKey and b.LineNum=c.DocumentLineKey) LEFT JOIN FSE_PurchaseGoodsReceiptDeliveryLineDetail c2 ON (b.DocEntry=c2.DocumentKey and b.LineNum=c2.DocumentLineKey) LEFT JOIN FSE_MO m ON m.DocumentNumber = b.U_FSE_MONumbe     </frame>
                   <frame procname=""unknown"" sqlhandle=""0x000000000000000000000000000000000000000000000000"">  unknown     </frame>
                   <frame procname=""FSDB00.dbo.SBO_SP_TransactionNotification"" line=""25"" stmtstart=""1588"" stmtend=""2032"" sqlhandle=""0x030006000a73d75dfe95d60059a000000100000000000000"">  exec usp_FSE_HandleSBONotification @object_type, @transaction_type, @num_of_cols_in_key, @list_of_key_cols_tab_del, @list_of_cols_val_tab_del, @error out, @error_message out  -- keep this on one line    --PMI DataTransfer     </frame>
                   <frame procname=""adhoc"" line=""1"" sqlhandle=""0x01000600fd116804e00371a5000000000000000000000000"">  EXECUTE SBO_SP_TransactionNotification N&apos;20&apos;,N&apos;A&apos;,1,N&apos;DocEntry&apos;,N&apos;134138&apos;     </frame>
                </executionStack>
                <inputbuf>  EXECUTE SBO_SP_TransactionNotification N&apos;20&apos;,N&apos;A&apos;,1,N&apos;DocEntry&apos;,N&apos;134138&apos;    </inputbuf>
             </process>
          </process-list>
          <resource-list>
             <keylock hobtid=""72057598620205056"" dbid=""6"" objectname=""FSDB00.dbo.ONNM"" indexname=""ONNM_PRIMARY"" id=""lock1aa7d9880"" mode=""RangeX-X"" associatedObjectId=""72057598620205056"">
                <owner-list/>
                <waiter-list>
                   <waiter id=""process5e3ae08"" mode=""RangeX-X"" requestType=""wait""/>
                </waiter-list>
             </keylock>
             <keylock hobtid=""72057598620205056"" dbid=""6"" objectname=""FSDB00.dbo.ONNM"" indexname=""ONNM_PRIMARY"" id=""lock1aa7d9880"" mode=""RangeX-X"" associatedObjectId=""72057598620205056"">
                <owner-list>
                   <owner id=""process5e31708"" mode=""RangeX-X""/>
                </owner-list>
                <waiter-list>
                   <waiter id=""process5e45048"" mode=""S"" requestType=""wait""/>
                </waiter-list>
             </keylock>
             <keylock hobtid=""72057597517103104"" dbid=""6"" objectname=""FSDB00.dbo.OITM"" indexname=""OITM_PRIMARY"" id=""lock215ce6980"" mode=""X"" associatedObjectId=""72057597517103104"">
                <owner-list>
                   <owner id=""process5e3ae08"" mode=""X""/>
                </owner-list>
                <waiter-list>
                   <waiter id=""process5e31708"" mode=""RangeS-S"" requestType=""wait""/>
                </waiter-list>
             </keylock>
          </resource-list>
       </deadlock>
    </deadlock-list>

My question is, why was it possible (is it normal) for SPID 78 to acquire a lock on OITM (ca73a6396124) (which happens to represent ItemCode FC1 if I recall correctly) even though it could not acquire a lock on ONNM (36fa3e654c8f). Is my assumption that SQL statements get all-or-none locks incorrect? Does it not hold if the holder of the ONNM lock was a shared lock on a different connection within a transaction that contains multiple connections in the other process? (I think SPID 99 is another connection in the same process as SPID 114.)

This seems to be a really complicated problem to decipher; I don't know if there's a better way of going about deadlock avoidance or finding out what happened here.",sql,sql-server,locking,deadlock,,06/29/2012 23:52:26,off topic,1,2715,7,"All-or-none exclusive lock on 2 SQL tables My simplistic testing suggested that I can acquire an exclusive lock on 2 tables or postpone acquiring the lock on either until both can be acquired at once by using a query like this:

    SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK)
    WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode

the key feature being the CROSS JOIN used to include multiple tables in a single query. I confirmed that if an exclusive lock already exists on the OITM row for @ItemCode in another transaction, then this statement doesn't introduce any lock on ONNM until it can acquire both locks. However, in the more complex full test run, SQL profiler returns some conflicting information. I have imported the SQL profiler results into a table and executed the following query:

    select rownum, e.name, EventClass, TextData, SPID, ClientProcessID from #pmit t
    join sys.trace_events e on t.EventClass = e.trace_event_id
    where rownum between 275799 and 546130
    and (TextData LIKE '(ca73a6396124)' or TextData LIKE '(36fa3e654c8f)'
         or TextData LIKE '%(XLOCK)%' or TextData LIKE '%DeadLock%')
    order by rownum

And these are the results I got back:

    Row    | Event                | SPID | Text
    275799 | SP:StmtStarting      | 99   | SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode
    304781 | Lock:Acquired        | 139  | (36fa3e654c8f)
    305365 | Lock:Acquired        | 139  | (36fa3e654c8f)
    351093 | Lock:Acquired        | 139  | (ca73a6396124)
    468768 | Lock:Released        | 13   | (ca73a6396124)
    470912 | Lock:Released        | 13   | (36fa3e654c8f)
    470922 | Lock:Acquired        | 164  | (36fa3e654c8f)
    470928 | Lock:Released        | 164  | (36fa3e654c8f)
    470971 | Lock:Acquired        | 99   | (36fa3e654c8f)
    471013 | RPC:Completed        | 99   | exec sp_executesql N'SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (''20'', ''10000048'') AND ItemCode = @ItemCode',N'@ItemCode nvarchar(3)',@ItemCode=N'FX1'
    490843 | SP:StmtStarting      | 78   | SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN ('20', '10000048') AND ItemCode = @ItemCode
    490848 | Lock:Acquired        | 78   | (ca73a6396124)
    495391 | Lock:Acquired        | 114  | (36fa3e654c8f)
    495396 | Lock:Acquired        | 114  | (36fa3e654c8f)
    542738 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 78 (36fa3e654c8f)                                                                                                                                                                                                                                                  
    545746 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 154 (36fa3e654c8f)                                                                                                                                                                                                                                                  
    545769 | Lock:Deadlock Chain  | 6    | Deadlock Chain SPID = 114 (ca73a6396124)                                                                                                                                                                                                                                                  
    545982 | Lock:Deadlock        | 78   | (36fa3e654c8f)
    545985 | RPC:Completed        | 78   | exec sp_executesql N'SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (''20'', ''10000048'') AND ItemCode = @ItemCode',N'@ItemCode nvarchar(3)',@ItemCode=N'FC3'
    545990 | Lock:Released        | 78   | (ca73a6396124)
    545998 | Lock:Acquired        | 114  | (ca73a6396124)
    546130 | Deadlock graph       | 17	 | (See below)

The deadlock graph is as follows:

    <deadlock-list>
       <deadlock victim=""process5e3ae08"">
          <process-list>
             <process id=""process5e3ae08"" taskpriority=""0"" logused=""0"" waitresource=""KEY: 6:72057598620205056 (36fa3e654c8f)"" waittime=""9507"" ownerId=""513854688"" transactionname=""user_transaction"" lasttranstarted=""2012-06-28T13:38:54.463"" XDES=""0x1bbf9b950"" lockMode=""RangeX-X"" schedulerid=""6"" kpid=""13248"" status=""suspended"" spid=""78"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2012-06-28T13:38:54.483"" lastbatchcompleted=""2012-06-28T13:38:54.463"" clientapp="".Net SqlClient Data Provider"" hostname=""PMIUSRSTL00013"" hostpid=""3180"" loginname=""RICFSE01SAPB1"" isolationlevel=""serializable (4)"" xactid=""513854688"" currentdb=""6"" lockTimeout=""4294967295"" clientoption1=""671088672"" clientoption2=""128056"">
                <executionStack>
                   <frame procname=""adhoc"" line=""1"" stmtstart=""46"" sqlhandle=""0x02000000151c651e3c8b4437ee414cefdbc46b70aceca960"">  SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (&apos;20&apos;, &apos;10000048&apos;) AND ItemCode = @ItemCode     </frame>
                   <frame procname=""unknown"" line=""1"" sqlhandle=""0x000000000000000000000000000000000000000000000000"">  unknown     </frame>
                </executionStack>
                <inputbuf>  (@ItemCode nvarchar(3))SELECT AutoKey, OnHand FROM ONNM(XLOCK) CROSS JOIN OITM(XLOCK) WHERE ObjectCode IN (&apos;20&apos;, &apos;10000048&apos;) AND ItemCode = @ItemCode    </inputbuf>
             </process>
             <process id=""process5e45048"" taskpriority=""0"" logused=""0"" waitresource=""KEY: 6:72057598620205056 (36fa3e654c8f)"" waittime=""12866"" ownerId=""513845303"" transactionname=""SELECT"" lasttranstarted=""2012-06-28T13:38:28.463"" XDES=""0x80048e50"" lockMode=""S"" schedulerid=""7"" kpid=""12772"" status=""suspended"" spid=""154"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""0"" lastbatchstarted=""2012-06-28T13:38:28.390"" lastbatchcompleted=""2012-06-28T13:38:28.380"" lastattention=""2012-06-28T13:38:27.927"" clientapp=""TagClerkService"" hostname=""PMIUSRSTW00008"" hostpid=""2772"" loginname=""RICFSE01SAPB1"" isolationlevel=""read committed (2)"" xactid=""513845303"" currentdb=""6"" lockTimeout=""4294967295"" clientoption1=""671088672"" clientoption2=""128056"">
                <executionStack>
                   <frame procname=""adhoc"" line=""1"" sqlhandle=""0x020000000d86e30171762b464b35e0923de532c497188b81"">  SELECT T0.*  FROM [dbo].[ONNM] T0     </frame>
                </executionStack>
                <inputbuf>  SELECT T0.*  FROM [dbo].[ONNM] T0    </inputbuf>
             </process>
             <process id=""process5e31708"" taskpriority=""0"" logused=""25240"" waitresource=""KEY: 6:72057597517103104 (ca73a6396124)"" waittime=""2031"" ownerId=""513831818"" transactionguid=""0xdefde99023405d4a96d101faac79ef96"" transactionname=""user_transaction"" lasttranstarted=""2012-06-28T13:38:19.237"" XDES=""0xd68df950"" lockMode=""RangeS-S"" schedulerid=""5"" kpid=""11564"" status=""suspended"" spid=""114"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2012-06-28T13:38:58.560"" lastbatchcompleted=""2012-06-28T13:38:58.490"" lastattention=""2012-06-28T12:48:33.060"" clientapp=""TagClerkService"" hostname=""PMIUSRSTL00011"" hostpid=""2908"" loginname=""RICFSE01SAPB1"" isolationlevel=""serializable (4)"" xactid=""513831818"" currentdb=""6"" lockTimeout=""4294967295"" clientoption1=""671088672"" clientoption2=""128056"">
                <executionStack>
                   <frame procname=""adhoc"" line=""1"" stmtstart=""24"" sqlhandle=""0x02000000a329a30eb1319f2df684296f889a1613a585b3a0"">  SELECT ISNULL(a.U_FSE_ApplicationUsr,a.UserSign) ,a.DocNum ,b.LineNum ,f.IsLotTraced ,h.LotNumber ,b.WhsCode ,n.Bin ,g.Quantity ,b.LineTotal ,i.OnTimeDeliveryDaysEarly ,i.OnTimeDeliveryDaysLate ,i.ReceiptVarianceUnderAllowed ,i.ReceiptVarianceOverAllowed ,k.ItemCode ,d.Revision ,a.Comments ,e.RolledMaterialCost ,e.RolledLaborCost ,e.RolledVariableOverheadCost ,e.RolledFixedOverheadCost ,e.RolledOutsideCost ,ISNULL(c.Quantity, c2.Quantity) ,c.DocumentLineDetailKey /* TODO: Handle serial numbers for blanket deliveries */ ,ISNULL(c.InventoryCode, c2.InventoryCode) ,k.InvntryUom ,r.Resource ,p.ItemName ,CASE WHEN m.MOKey IS NULL THEN NULL ELSE b.U_FSE_STypeItemQty END ,a.DocDate FROM OPDN a LEFT JOIN PDN1 b ON a.DocEntry=b.DocEntry  LEFT JOIN FSE_PurchaseGoodsReceiptLineDetail c ON (b.DocEntry=c.DocumentKey and b.LineNum=c.DocumentLineKey) LEFT JOIN FSE_PurchaseGoodsReceiptDeliveryLineDetail c2 ON (b.DocEntry=c2.DocumentKey and b.LineNum=c2.DocumentLineKey) LEFT JOIN FSE_MO m ON m.DocumentNumber = b.U_FSE_MONumbe     </frame>
                   <frame procname=""unknown"" sqlhandle=""0x000000000000000000000000000000000000000000000000"">  unknown     </frame>
                   <frame procname=""FSDB00.dbo.SBO_SP_TransactionNotification"" line=""25"" stmtstart=""1588"" stmtend=""2032"" sqlhandle=""0x030006000a73d75dfe95d60059a000000100000000000000"">  exec usp_FSE_HandleSBONotification @object_type, @transaction_type, @num_of_cols_in_key, @list_of_key_cols_tab_del, @list_of_cols_val_tab_del, @error out, @error_message out  -- keep this on one line    --PMI DataTransfer     </frame>
                   <frame procname=""adhoc"" line=""1"" sqlhandle=""0x01000600fd116804e00371a5000000000000000000000000"">  EXECUTE SBO_SP_TransactionNotification N&apos;20&apos;,N&apos;A&apos;,1,N&apos;DocEntry&apos;,N&apos;134138&apos;     </frame>
                </executionStack>
                <inputbuf>  EXECUTE SBO_SP_TransactionNotification N&apos;20&apos;,N&apos;A&apos;,1,N&apos;DocEntry&apos;,N&apos;134138&apos;    </inputbuf>
             </process>
          </process-list>
          <resource-list>
             <keylock hobtid=""72057598620205056"" dbid=""6"" objectname=""FSDB00.dbo.ONNM"" indexname=""ONNM_PRIMARY"" id=""lock1aa7d9880"" mode=""RangeX-X"" associatedObjectId=""72057598620205056"">
                <owner-list/>
                <waiter-list>
                   <waiter id=""process5e3ae08"" mode=""RangeX-X"" requestType=""wait""/>
                </waiter-list>
             </keylock>
             <keylock hobtid=""72057598620205056"" dbid=""6"" objectname=""FSDB00.dbo.ONNM"" indexname=""ONNM_PRIMARY"" id=""lock1aa7d9880"" mode=""RangeX-X"" associatedObjectId=""72057598620205056"">
                <owner-list>
                   <owner id=""process5e31708"" mode=""RangeX-X""/>
                </owner-list>
                <waiter-list>
                   <waiter id=""process5e45048"" mode=""S"" requestType=""wait""/>
                </waiter-list>
             </keylock>
             <keylock hobtid=""72057597517103104"" dbid=""6"" objectname=""FSDB00.dbo.OITM"" indexname=""OITM_PRIMARY"" id=""lock215ce6980"" mode=""X"" associatedObjectId=""72057597517103104"">
                <owner-list>
                   <owner id=""process5e3ae08"" mode=""X""/>
                </owner-list>
                <waiter-list>
                   <waiter id=""process5e31708"" mode=""RangeS-S"" requestType=""wait""/>
                </waiter-list>
             </keylock>
          </resource-list>
       </deadlock>
    </deadlock-list>

My question is, why was it possible (is it normal) for SPID 78 to acquire a lock on OITM (ca73a6396124) (which happens to represent ItemCode FC1 if I recall correctly) even though it could not acquire a lock on ONNM (36fa3e654c8f). Is my assumption that SQL statements get all-or-none locks incorrect? Does it not hold if the holder of the ONNM lock was a shared lock on a different connection within a transaction that contains multiple connections in the other process? (I think SPID 99 is another connection in the same process as SPID 114.)

This seems to be a really complicated problem to decipher; I don't know if there's a better way of going about deadlock avoidance or finding out what happened here.",4
10528016,05/10/2012 05:30:55,562422,01/04/2011 10:49:29,251,12,Error in using group by in firebird 1,"I am trying to run the following query but it is not working!

    select extract(month from flight_date_time) mnt from T_PEREXOD where extract( year from flight_date_time)='2012'
    group by mnt 
    order by mnt

I tried also subquerying 

    select mnt from (select extract(month from flight_date_time) AS mnt from T_PEREXOD)
    group by mnt
    order by mnt

but it pops out an error 
Invalid token.

    Dynamic SQL Error.
    SQL error code = -104.
    Token unknown - line 1, char 18.
    select.


Is that a problem of Firebird version 1 ??

How about making groupping work without any views, procedures, computed fields and so on ? 'cause I don't like to alter that database !


",sql,firebird,,,,,open,0,137,8,"Error in using group by in firebird 1 I am trying to run the following query but it is not working!

    select extract(month from flight_date_time) mnt from T_PEREXOD where extract( year from flight_date_time)='2012'
    group by mnt 
    order by mnt

I tried also subquerying 

    select mnt from (select extract(month from flight_date_time) AS mnt from T_PEREXOD)
    group by mnt
    order by mnt

but it pops out an error 
Invalid token.

    Dynamic SQL Error.
    SQL error code = -104.
    Token unknown - line 1, char 18.
    select.


Is that a problem of Firebird version 1 ??

How about making groupping work without any views, procedures, computed fields and so on ? 'cause I don't like to alter that database !


",2
2236500,02/10/2010 11:46:31,249593,01/13/2010 07:53:08,1,0,what should be the query for this ?,"how do I swap records in SQL . I have a case in which I have to swap records of one employee to other , for example I have to update like "" **A's hat on B's head and B's hat on A's head**"" .
Only I need the query , i have the fields.


what should be the best approach for this? Is there any easy query for this ?",sql,,,,,,open,0,69,8,"what should be the query for this ? how do I swap records in SQL . I have a case in which I have to swap records of one employee to other , for example I have to update like "" **A's hat on B's head and B's hat on A's head**"" .
Only I need the query , i have the fields.


what should be the best approach for this? Is there any easy query for this ?",1
6099826,05/23/2011 16:04:35,24481,10/02/2008 12:49:03,386,36,Nested query using while condition - sql,"I need to do a nested query on a single table. Each row is potentially the parent or child of another row.

Is it possible to do this with a single select statement? Ive started using this statement but it only goes down one level. 

    select * from nested_table where parent_id in (select id from nested_table where name = 'manager' )

This select however will only go down one level. If a row has multiple children they will be ignored. (In the table each row has an **Id** field , if a row has a parent then the parents **Id** value will be in the child's **parent_Id** field. )

If i could include a while loop in the SQL which would always check to see if the returned **Id** was a parent or not and if it was check and see if any other row was its child by checking the other rows **parent_Id**. However i m concerned this would take alot of cycles to eventually find all parent child relationships. Any suggestions? Thanks



",sql,query,nested,,,,open,0,175,7,"Nested query using while condition - sql I need to do a nested query on a single table. Each row is potentially the parent or child of another row.

Is it possible to do this with a single select statement? Ive started using this statement but it only goes down one level. 

    select * from nested_table where parent_id in (select id from nested_table where name = 'manager' )

This select however will only go down one level. If a row has multiple children they will be ignored. (In the table each row has an **Id** field , if a row has a parent then the parents **Id** value will be in the child's **parent_Id** field. )

If i could include a while loop in the SQL which would always check to see if the returned **Id** was a parent or not and if it was check and see if any other row was its child by checking the other rows **parent_Id**. However i m concerned this would take alot of cycles to eventually find all parent child relationships. Any suggestions? Thanks



",3
11309691,07/03/2012 11:11:01,459384,09/27/2010 10:48:59,602,21,sql search by many conditions and order the results by the number of conditions met,A concrete example is that in my `table` I store tags in a column as a `comma separated list`. now the user's query will be as a `comma seperated list` of tags. I have to pull the results that have matching tags but I'd also like the results to be sorted by the number of tags matched. ,sql,tags,comma,comma-separated,quickbase,07/03/2012 14:17:01,not a real question,1,58,15,sql search by many conditions and order the results by the number of conditions met A concrete example is that in my `table` I store tags in a column as a `comma separated list`. now the user's query will be as a `comma seperated list` of tags. I have to pull the results that have matching tags but I'd also like the results to be sorted by the number of tags matched. ,5
5837462,04/29/2011 21:13:59,715956,04/19/2011 20:33:06,11,0,SQL Query Quick Question,"The following does not work. I get the error message that it doesn't recognize Table2.Field4, Table2.Field5, and Table2.Field6 :

SELECT Table.*
FROM Table
WHERE ((Table.Field1=Query.Field4) AND ((Table.Field2)=(Query.Field5)) AND (Table.Field3=Query.Field6));

How can I fix this?

",sql,,,,,,open,0,30,4,"SQL Query Quick Question The following does not work. I get the error message that it doesn't recognize Table2.Field4, Table2.Field5, and Table2.Field6 :

SELECT Table.*
FROM Table
WHERE ((Table.Field1=Query.Field4) AND ((Table.Field2)=(Query.Field5)) AND (Table.Field3=Query.Field6));

How can I fix this?

",1
10763296,05/26/2012 03:07:11,795817,06/13/2011 11:13:59,115,1,Entity Framework bug with Views?,"I use Entity Framework 4.3.1.0

SQL Server 2008 Express

I have Views

    SELECT  dbo.Dealers.Name AS DealerName, dbo.Dealers.LogoImage, dbo.DealersProducts.Price, dbo.DealersProducts.StatusType, dbo.Products.Description,                       dbo.Products.Name, dbo.DealersProducts.DealerId, dbo.Products.Id FROM dbo.Dealers INNER JOIN
    dbo.DealersProducts ON dbo.Dealers.Id = dbo.DealersProducts.DealerId INNER JOIN                       dbo.Products ON dbo.DealersProducts.ProductId = dbo.Products.Id

and I have Entity

    public class DealerViews : BasePersistentEntity
	{
		public int DealerId { get; set; }

		public string DealerName { get; set; }

		public string LogoImage { get; set; }

		public string Name { get; set; }

		public string Description { get; set; }

		public decimal Price { get; set; }

		public int StatusType { get; set; }
	}

This View I use for return dealer ho have request product. When I request SQL query in SQL Manager I gate correct result but in Entity Framework I get strange result.
Examples

**SQL result**

Dealer 1

Dealer 2

**Entity Framework result**

Dealer 1

Dealer 1",sql,asp.net-mvc-3,entity-framework,views,,,open,0,178,5,"Entity Framework bug with Views? I use Entity Framework 4.3.1.0

SQL Server 2008 Express

I have Views

    SELECT  dbo.Dealers.Name AS DealerName, dbo.Dealers.LogoImage, dbo.DealersProducts.Price, dbo.DealersProducts.StatusType, dbo.Products.Description,                       dbo.Products.Name, dbo.DealersProducts.DealerId, dbo.Products.Id FROM dbo.Dealers INNER JOIN
    dbo.DealersProducts ON dbo.Dealers.Id = dbo.DealersProducts.DealerId INNER JOIN                       dbo.Products ON dbo.DealersProducts.ProductId = dbo.Products.Id

and I have Entity

    public class DealerViews : BasePersistentEntity
	{
		public int DealerId { get; set; }

		public string DealerName { get; set; }

		public string LogoImage { get; set; }

		public string Name { get; set; }

		public string Description { get; set; }

		public decimal Price { get; set; }

		public int StatusType { get; set; }
	}

This View I use for return dealer ho have request product. When I request SQL query in SQL Manager I gate correct result but in Entity Framework I get strange result.
Examples

**SQL result**

Dealer 1

Dealer 2

**Entity Framework result**

Dealer 1

Dealer 1",4
9809671,03/21/2012 17:22:31,339428,05/12/2010 14:48:05,1569,87,SQL: Check constraint depends on other tables,"I have 3 tables: Member, Employer, and Location. Member has MemberID, EmployerID, and LocationID. Employer has EmployerID. Location has EmployerID, LocationID.  

Member <<---> Employer
Location <<---> Employer
Member <---> Location

I need to make a check constraint on member that says ""A member's location is either null, or a location belonging to its employer""

How do I constrain Member.LocationID to a location having the same EmployerID? ie: Member.EmployerID = Location.EmployerID?",sql,check-constraints,,,,,open,0,67,7,"SQL: Check constraint depends on other tables I have 3 tables: Member, Employer, and Location. Member has MemberID, EmployerID, and LocationID. Employer has EmployerID. Location has EmployerID, LocationID.  

Member <<---> Employer
Location <<---> Employer
Member <---> Location

I need to make a check constraint on member that says ""A member's location is either null, or a location belonging to its employer""

How do I constrain Member.LocationID to a location having the same EmployerID? ie: Member.EmployerID = Location.EmployerID?",2
4635880,01/08/2011 20:08:40,116671,06/03/2009 15:32:15,1116,58,Free online shared data storage for Windows Phone 7 application,"I'm wanting to develop a WP7 application that requires a central online data store, since this is initially something I'd only be using for myself (especially while I develop it) I want to keep my costs down. Does anybody know of any free services I could use? If not I may have to look at SQL Azure.",sql,windows-phone-7,,,,01/10/2011 01:44:21,off topic,1,57,10,"Free online shared data storage for Windows Phone 7 application I'm wanting to develop a WP7 application that requires a central online data store, since this is initially something I'd only be using for myself (especially while I develop it) I want to keep my costs down. Does anybody know of any free services I could use? If not I may have to look at SQL Azure.",2
996863,06/15/2009 15:48:46,48461,12/22/2008 20:06:08,419,2,SQL newbie question,"In

    SELECT a.NAME, a.NUMBER, a.STRING, a.RDB$DB_KEY FROM AMDIN a

what is a stands for?

Thanks.",sql,,,,,,open,0,16,3,"SQL newbie question In

    SELECT a.NAME, a.NUMBER, a.STRING, a.RDB$DB_KEY FROM AMDIN a

what is a stands for?

Thanks.",1
7882782,10/24/2011 22:37:08,189826,10/14/2009 12:53:09,449,23,How do I pivot/turn a table so that each row becomes a set of columns in the new table?,"I have to say this question is hard to phrase. 

So, here is what I have - a table(the number of records is limited to 4):

    tax_name	    tax_amount
    TAX_A	           58.39 
    TAX_B              151.81
    TAX_C	           78.00 
    ...
 

and this is what the end result should look like:

    tax_name1  tax_amount1  tax_name2  tax_amount2  tax_name2  tax_amount2
        TAX_A      58.39        TAX_B      151.81       TAX_C      78.00

I was thinking to use a PIVOT at first, but then I am not sure how to deal with the second column as I want to move the values in pairs(name, amount). 

Please, advise. How can it be done in SQL?",sql,sql-server-2005,tsql,,,,open,0,193,19,"How do I pivot/turn a table so that each row becomes a set of columns in the new table? I have to say this question is hard to phrase. 

So, here is what I have - a table(the number of records is limited to 4):

    tax_name	    tax_amount
    TAX_A	           58.39 
    TAX_B              151.81
    TAX_C	           78.00 
    ...
 

and this is what the end result should look like:

    tax_name1  tax_amount1  tax_name2  tax_amount2  tax_name2  tax_amount2
        TAX_A      58.39        TAX_B      151.81       TAX_C      78.00

I was thinking to use a PIVOT at first, but then I am not sure how to deal with the second column as I want to move the values in pairs(name, amount). 

Please, advise. How can it be done in SQL?",3
6960824,08/05/2011 18:16:17,548807,12/20/2010 15:20:34,114,2,Where can I find Refrence manuals for SQL and PLSQL,"Is there any Manuals available,which cater the needs of SQL and PLSQL developers in the industry. I tried to search,but  I found nothing like that of eual to  PHP's manual quality in .chm Format.

So, can anyone give me or share their useful material direct links to PLSQL and SQL manuals in .chm format, for Quick development and learning along the way.",sql,oracle,plsql,manual,,,open,0,63,10,"Where can I find Refrence manuals for SQL and PLSQL Is there any Manuals available,which cater the needs of SQL and PLSQL developers in the industry. I tried to search,but  I found nothing like that of eual to  PHP's manual quality in .chm Format.

So, can anyone give me or share their useful material direct links to PLSQL and SQL manuals in .chm format, for Quick development and learning along the way.",4
2141089,01/26/2010 17:09:17,76123,03/10/2009 13:02:16,1806,95,"Loading data from one table into two other tables (one detail, one summary) that are related","Suppose that I have a source table like this:

    Source
        SourceKey (PK)
        Data1
        Data2
        Amount

And I am loading data from 'Source' into two related tables that look like this:

    Summary
        SummaryKey (PK)
        Data1
        Data2
        Amount

    Detail
        DetailKey (PK)
        SummaryKey (FK)
        SourceKey (FK)
        Data2
        Amount

For each record coming from 'Source', one record is created in 'Detail'. Records are also created in 'Summary' based on an aggregate of the detail records. This is all pretty straightforward, I think, except that I need to relate records in 'Detail' to the corresponding records in 'Summary'.

I've 'solved' this problem with a pair of temporary holding tables (corresponding to the destination tables) along with a semi-complicated UPDATE statement to relate them by matching on grouping fields (the _real_ example has a much more complicated grouping). I can't help but feel there exists a simpler solution than what I've created.

Thanks for any ideas.",sql,tsql,sql-server,,,,open,0,246,16,"Loading data from one table into two other tables (one detail, one summary) that are related Suppose that I have a source table like this:

    Source
        SourceKey (PK)
        Data1
        Data2
        Amount

And I am loading data from 'Source' into two related tables that look like this:

    Summary
        SummaryKey (PK)
        Data1
        Data2
        Amount

    Detail
        DetailKey (PK)
        SummaryKey (FK)
        SourceKey (FK)
        Data2
        Amount

For each record coming from 'Source', one record is created in 'Detail'. Records are also created in 'Summary' based on an aggregate of the detail records. This is all pretty straightforward, I think, except that I need to relate records in 'Detail' to the corresponding records in 'Summary'.

I've 'solved' this problem with a pair of temporary holding tables (corresponding to the destination tables) along with a semi-complicated UPDATE statement to relate them by matching on grouping fields (the _real_ example has a much more complicated grouping). I can't help but feel there exists a simpler solution than what I've created.

Thanks for any ideas.",3
2973558,06/04/2010 11:15:06,290413,03/10/2010 10:45:50,18,4,select a value where it doesnt exist in another table,"I have two tables

Table A:

    ID
    1
    2
    3
    4

Table B:

    ID
    1
    2
    3

What I want is to select all rows in table A that table B don't have, which in case is row 4.
My other question is if it is possible to delete all rows that table B don't have.
I am using SQL Server 2000",sql,,,,,,open,0,84,10,"select a value where it doesnt exist in another table I have two tables

Table A:

    ID
    1
    2
    3
    4

Table B:

    ID
    1
    2
    3

What I want is to select all rows in table A that table B don't have, which in case is row 4.
My other question is if it is possible to delete all rows that table B don't have.
I am using SQL Server 2000",1
5716329,04/19/2011 12:27:55,713288,04/18/2011 11:14:31,1,0,sql create statements,"Create the SELECT statement for a query on the following table that uses the AS, COUNT,
GROUP BY and ORDER BY clauses.


 Particular Vessels.
Below is a list of some ships.
Name of Vessels Type Starting Port
SS Diana Mega-Liner Kingston
SS Esmerelda Mega-Liner Kingston
Missy Yacht Athens
SS Madam Mid-size ship London
Campanela River Boat Vienna",sql,statement,,,,04/19/2011 12:34:05,not a real question,1,49,3,"sql create statements Create the SELECT statement for a query on the following table that uses the AS, COUNT,
GROUP BY and ORDER BY clauses.


 Particular Vessels.
Below is a list of some ships.
Name of Vessels Type Starting Port
SS Diana Mega-Liner Kingston
SS Esmerelda Mega-Liner Kingston
Missy Yacht Athens
SS Madam Mid-size ship London
Campanela River Boat Vienna",2
2004147,01/05/2010 04:23:02,75500,03/09/2009 06:16:32,1854,117,"SQL CASE [Column] WHEN IN ('case1', 'case2') THEN 'oops' END?","Is there a way to check a CASE when it's in an array:

    SELECT CASE [Option] WHEN IN (1, 3, 99) THEN 'Wrong option' ELSE 'You go!' END",sql,sql-server,case,,,,open,0,31,10,"SQL CASE [Column] WHEN IN ('case1', 'case2') THEN 'oops' END? Is there a way to check a CASE when it's in an array:

    SELECT CASE [Option] WHEN IN (1, 3, 99) THEN 'Wrong option' ELSE 'You go!' END",3
8463990,12/11/2011 12:35:29,882130,08/06/2011 17:19:58,22,1,SQL Server Express 'sa' login failed,"I've written a program in QT that connects to a SQL Server Express DB using the following code



        QSqlDatabase db = QSqlDatabase::addDatabase(""QODBC"");
        bool driverAvailable = QSqlDatabase::isDriverAvailable(""QODBC"");
        if( !driverAvailable )
        {
            mConnected = false;
            return false;
        }
        QString connectionTemplate = ""DRIVER={SQL SERVER};SERVER=%1;DATABASE=%2;"";
        QString connectionString = connectionTemplate.arg(serverIP).arg(dbName);
        db.setConnectOptions(""SQL_ATTR_CONNECTION_TIMEOUT=5;SQL_ATTR_ODBC_VERSION=SQL_OV_ODBC3;"");
        db.setDatabaseName( connectionString );

        db.setUserName( username );
        db.setPassword( password );

However when I attempt to connect to the server I get an error stating :

        Login failed for user 'sa', Unable to Connect

 1. I have checked and rechecked the password to make sure it was
    correct.
    
 2.   I have made sure that ""SQL Server and Windows Authentication mode""
    is set in the server properties.
    
 3.   I have also tried to create a completely new user account and
    granted admin for the database.

 4. I am able to successfully connect and run queries to the database through SQL server management studio

I am now completely stumped and I don't know what else to try, any help will be greatly appreciated!
",sql,qt,login,odbc,,,open,0,290,6,"SQL Server Express 'sa' login failed I've written a program in QT that connects to a SQL Server Express DB using the following code



        QSqlDatabase db = QSqlDatabase::addDatabase(""QODBC"");
        bool driverAvailable = QSqlDatabase::isDriverAvailable(""QODBC"");
        if( !driverAvailable )
        {
            mConnected = false;
            return false;
        }
        QString connectionTemplate = ""DRIVER={SQL SERVER};SERVER=%1;DATABASE=%2;"";
        QString connectionString = connectionTemplate.arg(serverIP).arg(dbName);
        db.setConnectOptions(""SQL_ATTR_CONNECTION_TIMEOUT=5;SQL_ATTR_ODBC_VERSION=SQL_OV_ODBC3;"");
        db.setDatabaseName( connectionString );

        db.setUserName( username );
        db.setPassword( password );

However when I attempt to connect to the server I get an error stating :

        Login failed for user 'sa', Unable to Connect

 1. I have checked and rechecked the password to make sure it was
    correct.
    
 2.   I have made sure that ""SQL Server and Windows Authentication mode""
    is set in the server properties.
    
 3.   I have also tried to create a completely new user account and
    granted admin for the database.

 4. I am able to successfully connect and run queries to the database through SQL server management studio

I am now completely stumped and I don't know what else to try, any help will be greatly appreciated!
",4
8443621,12/09/2011 09:43:16,829237,07/05/2011 08:03:11,145,2,Dynamic update sql,"Im building a dynamic sql update statement. This statement will update an unknown number of columns. Im looking for a clever way to set the commas between the columns in the update-statement correct.

    DECLARE @UpdateSQL nvarchar(max) = 'UPDATE MYTABLE SET '
    WHILE (somecondition)
    BEGIN
        IF (someothercondition)
            SET @UpdateSQL = @UpdateSQL + @ColNameVar + ' = ' @ColNameVar + ',' --How to set this comma only on columns that are not the last??
    END

There is ofcourse more building to do with this updateSQL, but this is the only relevant part for my question. 

One important note is that the last run of the while-loop is not necessarly putting in a new column in the update, so i could not use that as a check.

Any ideas?

Using SQL Server-2008",sql,sql-server,sql-server-2008,tsql,,,open,0,156,3,"Dynamic update sql Im building a dynamic sql update statement. This statement will update an unknown number of columns. Im looking for a clever way to set the commas between the columns in the update-statement correct.

    DECLARE @UpdateSQL nvarchar(max) = 'UPDATE MYTABLE SET '
    WHILE (somecondition)
    BEGIN
        IF (someothercondition)
            SET @UpdateSQL = @UpdateSQL + @ColNameVar + ' = ' @ColNameVar + ',' --How to set this comma only on columns that are not the last??
    END

There is ofcourse more building to do with this updateSQL, but this is the only relevant part for my question. 

One important note is that the last run of the while-loop is not necessarly putting in a new column in the update, so i could not use that as a check.

Any ideas?

Using SQL Server-2008",4
7571899,09/27/2011 15:43:00,573616,01/13/2011 02:53:58,64,4,SSIS Pass Datasource Between Control Flow Tasks Help,"Im having troubles solving this little problem, hopefully someone can help me.

In my SSIS package I have a data flow task.
There's several different transforms, merges and conversions that happen in here.

At the end of the dataflow task, there is two datasets,  one that contains two numbers that need to be compared,  and another dataset that contains a bunch of records.

Idealy, I would like to have these passed onto a whole new data flow task (seperate sequence container) where I can do some validation work on it and seperate the logic.

I cant for the life of me figure out how to do it.  Iv tried looking into scripting and storing the datasets as variables, but im not sure this is the right way to do it.

The next step is to export the large dataset as a spreadsheet,  but before this happens i need to compare the two numbers from the other dataset and ensure they're correct.


can anyone suggest a solution for me ?

Cheers
",sql,ssis,,,,,open,0,166,8,"SSIS Pass Datasource Between Control Flow Tasks Help Im having troubles solving this little problem, hopefully someone can help me.

In my SSIS package I have a data flow task.
There's several different transforms, merges and conversions that happen in here.

At the end of the dataflow task, there is two datasets,  one that contains two numbers that need to be compared,  and another dataset that contains a bunch of records.

Idealy, I would like to have these passed onto a whole new data flow task (seperate sequence container) where I can do some validation work on it and seperate the logic.

I cant for the life of me figure out how to do it.  Iv tried looking into scripting and storing the datasets as variables, but im not sure this is the right way to do it.

The next step is to export the large dataset as a spreadsheet,  but before this happens i need to compare the two numbers from the other dataset and ensure they're correct.


can anyone suggest a solution for me ?

Cheers
",2
1714877,11/11/2009 12:26:43,197878,10/28/2009 07:01:55,23,1,Roles vs Schema,I want to give different level of access on tables to different users based on their department. Should I use Schema or Roles for this purpose. Any Insights!,sql,sql-server-2005,,,,07/30/2012 13:52:58,off topic,1,28,3,Roles vs Schema I want to give different level of access on tables to different users based on their department. Should I use Schema or Roles for this purpose. Any Insights!,2
6365804,06/16/2011 00:03:01,32892,10/30/2008 20:51:01,2885,105,Convert CMMDDYY into date in SQL Server,"If I have a date string in the format of CMMDDYY 

C = 0, 1 or 2 where 0 represents 19, 1 represents 20 and 2 represents 21

Example:

1022511 would be 02/25/2011 in mm/dd/yyyy format.

Is there a way to convert this into mm/dd/yyyy format in sql server?

Is CMMDDYY even a valid date format?  I haven't found much information on it.",sql,sql-server-2008,date-format,,,,open,0,60,7,"Convert CMMDDYY into date in SQL Server If I have a date string in the format of CMMDDYY 

C = 0, 1 or 2 where 0 represents 19, 1 represents 20 and 2 represents 21

Example:

1022511 would be 02/25/2011 in mm/dd/yyyy format.

Is there a way to convert this into mm/dd/yyyy format in sql server?

Is CMMDDYY even a valid date format?  I haven't found much information on it.",3
1274260,08/13/2009 20:05:14,154603,08/11/2009 19:49:37,8,0,Rebuilding large SQL indexes isn't changing the fragmentation percentage,"I have a large database running on SQL Server 2005.   I query the DMV sys.dm_db_index_physical_stats to get index fragmentation information.

I was shocked to see avg_fragment_size_in_percent reporting a large amount of indexes with very bad fragmentation levels (99% for a lot of them).

I proceded to run the following on the worst offenders:

ALTER INDEX ALL ON myTable REBUILD WITH(ONLINE = ON)

I then re-queried sys.dm_db_index_physical_stats, however it reports exactly the same fragmentation levels before and after the index REBUILD.

Is this information cached, or am I doing something wrong?",sql,sql-server,sql-server-2005,,,,open,0,87,9,"Rebuilding large SQL indexes isn't changing the fragmentation percentage I have a large database running on SQL Server 2005.   I query the DMV sys.dm_db_index_physical_stats to get index fragmentation information.

I was shocked to see avg_fragment_size_in_percent reporting a large amount of indexes with very bad fragmentation levels (99% for a lot of them).

I proceded to run the following on the worst offenders:

ALTER INDEX ALL ON myTable REBUILD WITH(ONLINE = ON)

I then re-queried sys.dm_db_index_physical_stats, however it reports exactly the same fragmentation levels before and after the index REBUILD.

Is this information cached, or am I doing something wrong?",3
3597078,08/29/2010 23:53:43,286260,03/04/2010 13:02:36,807,49,"unique pair in a ""friendship"" database","I'm posting this question which is somewhat a summary of my other [question][1].

I have **two databases**:<br>
1) db_users.<br>
2) db_friends.

I stress that they're stored in **separate databases** on different servers and therefore no foreign keys can be used.

In 'db_friends' I have the table 'tbl_friends' which has the following columns:<br>
- id_user<br>
- id_friend

Now **how do I make sure that each pair is unique** at this table ('tbl_friends')?<br>
I'd like to enfore that at the table level, and not through a query.

For example **these are invalid rows**:<br>
1 - 2<br>
2 - 1

I'd like this to be impossible to add.

Additionally - how would I seach for all of the friends of user 713 **while he could be mentioned**, on some friendship rows, **at the second column** ('id_friend')?

  [1]: http://stackoverflow.com/questions/3596947",sql,relationship,,,,,open,0,122,6,"unique pair in a ""friendship"" database I'm posting this question which is somewhat a summary of my other [question][1].

I have **two databases**:<br>
1) db_users.<br>
2) db_friends.

I stress that they're stored in **separate databases** on different servers and therefore no foreign keys can be used.

In 'db_friends' I have the table 'tbl_friends' which has the following columns:<br>
- id_user<br>
- id_friend

Now **how do I make sure that each pair is unique** at this table ('tbl_friends')?<br>
I'd like to enfore that at the table level, and not through a query.

For example **these are invalid rows**:<br>
1 - 2<br>
2 - 1

I'd like this to be impossible to add.

Additionally - how would I seach for all of the friends of user 713 **while he could be mentioned**, on some friendship rows, **at the second column** ('id_friend')?

  [1]: http://stackoverflow.com/questions/3596947",2
8990123,01/24/2012 16:12:40,78649,03/16/2009 15:54:26,173,8,"Why is SQL input required in our application, and not handled in SQL?","I don't normally deal in databases (I've managed a few small ones for web apps I wrote for me and my friends)   So I'm going to verify that I understand how everything works, before asking my question.

1. SQL is a program that ""does"" databases.  It manages all the tables and the schemes and the links, and it does most everything in response to commands it receives.  You could type these commands in by hand, or have a script you write with commands in them, or have another program send these commands to SQL, but the commands haven't really changed.

2. SQL Injection occurs when a web application Takes input received from the user, and sends it to SQL without cleaning it up first.   If the end-user is wiley enough, SQL will see commands that it was supposed to see as Data to be stored in a table somewhere, resulting in travesty.

3. Typical SQL injection prevention involves sanitizing your user input, that is, stripping out any characters that would make SQL think a command was being sent, instead of data.

Now, My question:

Why does SQL not handle this for us?  Why does SQL, on each command, not look for the first "", and the last "", and ignore any ""s in between?  (I don't think ""'s are a part of standard SQL command syntax, it's been a while, but if not, change could happen)  It would, of course, prevent you from sending multiple commands simultaneously (as the 2nd/3rd commands would be ignored) but on a ""I send 1 command at a time"" rule, this pretty much ignores any shenanigans the end-user might try to pull.

I'm sure someone else has thought of this, and dismissed it as not working for some reason or another.   But I don't know enough to understand why, and I'd like to.",sql,security,sql-injection,,,01/24/2012 22:39:15,not a real question,1,313,13,"Why is SQL input required in our application, and not handled in SQL? I don't normally deal in databases (I've managed a few small ones for web apps I wrote for me and my friends)   So I'm going to verify that I understand how everything works, before asking my question.

1. SQL is a program that ""does"" databases.  It manages all the tables and the schemes and the links, and it does most everything in response to commands it receives.  You could type these commands in by hand, or have a script you write with commands in them, or have another program send these commands to SQL, but the commands haven't really changed.

2. SQL Injection occurs when a web application Takes input received from the user, and sends it to SQL without cleaning it up first.   If the end-user is wiley enough, SQL will see commands that it was supposed to see as Data to be stored in a table somewhere, resulting in travesty.

3. Typical SQL injection prevention involves sanitizing your user input, that is, stripping out any characters that would make SQL think a command was being sent, instead of data.

Now, My question:

Why does SQL not handle this for us?  Why does SQL, on each command, not look for the first "", and the last "", and ignore any ""s in between?  (I don't think ""'s are a part of standard SQL command syntax, it's been a while, but if not, change could happen)  It would, of course, prevent you from sending multiple commands simultaneously (as the 2nd/3rd commands would be ignored) but on a ""I send 1 command at a time"" rule, this pretty much ignores any shenanigans the end-user might try to pull.

I'm sure someone else has thought of this, and dismissed it as not working for some reason or another.   But I don't know enough to understand why, and I'd like to.",3
4936587,02/08/2011 18:03:07,608574,02/08/2011 18:03:07,1,0,"how to avoid getting this error ""non-nullable column cannot be updated to null"" when using ADO Master-Detail relation?","I am trying to build Master-Detail Form using TADODataSet, TDBText for Master Table and TDBGrid for Details Table (something smiller to Orders Form like Master Table includs the order header and Details Table includes the Order Items)

Master primary key is Identity column (autoincreament Field)

When trying to add a new record in Master Table and then trying to add records in Details Table before posting the record in Master Table I get this error ""non-nullable column cannot be updated to null"" and this happens because the master table primary key value is still not known because I didn't post the master record but if I tried the same scenario except that before I add the details records I posted the Master record then the error doesn't appear.

how to work around this problem?

I am connecting Master Table with Details Table using the followig properties :
Both DataSets have courser location : Client

Details Table : 
DataSource : Master Table DataSource
Master Records : Id (Primary key of the master table)
IndexFieldNames : OrderId (the field in Details Table that indecates to which master record does this detail record belong to)
Lock Type : BatchOptimistic

Please help me 
Thanks in advance
Yazan Al-lahham",sql,delphi,server,ado,master-detail,,open,0,193,18,"how to avoid getting this error ""non-nullable column cannot be updated to null"" when using ADO Master-Detail relation? I am trying to build Master-Detail Form using TADODataSet, TDBText for Master Table and TDBGrid for Details Table (something smiller to Orders Form like Master Table includs the order header and Details Table includes the Order Items)

Master primary key is Identity column (autoincreament Field)

When trying to add a new record in Master Table and then trying to add records in Details Table before posting the record in Master Table I get this error ""non-nullable column cannot be updated to null"" and this happens because the master table primary key value is still not known because I didn't post the master record but if I tried the same scenario except that before I add the details records I posted the Master record then the error doesn't appear.

how to work around this problem?

I am connecting Master Table with Details Table using the followig properties :
Both DataSets have courser location : Client

Details Table : 
DataSource : Master Table DataSource
Master Records : Id (Primary key of the master table)
IndexFieldNames : OrderId (the field in Details Table that indecates to which master record does this detail record belong to)
Lock Type : BatchOptimistic

Please help me 
Thanks in advance
Yazan Al-lahham",5
4022136,10/26/2010 09:04:54,1104408,10/26/2010 08:55:12,1,0,"Cannot Connect to the SQL Server , SQL 2005 and it doesnot want to connect to the server and there is no Server name ? ","TITLE: Connect to Server
------------------------------

Cannot connect to ..

------------------------------
ADDITIONAL INFORMATION:

A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) (Microsoft SQL Server, Error: 2)

For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=2&LinkId=20476

------------------------------
BUTTONS:

OK
------------------------------
",sql,sql-server-2005-express,,,,10/27/2010 10:14:15,off topic,1,69,26,"Cannot Connect to the SQL Server , SQL 2005 and it doesnot want to connect to the server and there is no Server name ?  TITLE: Connect to Server
------------------------------

Cannot connect to ..

------------------------------
ADDITIONAL INFORMATION:

A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) (Microsoft SQL Server, Error: 2)

For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=2&LinkId=20476

------------------------------
BUTTONS:

OK
------------------------------
",2
7224222,08/28/2011 21:53:29,916857,08/28/2011 21:35:36,1,0,Selecting fields from joined tables,"I am new to SQL.  I am trying to select some of the fields from 2 of 3 joined tables and all of the fields from a 3rd table.  Other than specifying each individual field from the Pr table, is the a simpler way to SELECT individual fields from two of the tables and SELECT * from the 3rd table.  My current query is below.  This is an exercise from a book.  If the 3rd table contained more fields this method would become very cumbersome.
 
SELECT 
     Lo.City, Em.FirstName, Em.LastName, Pr.EmpID, Pr.YearlySalary, Pr.MonthlySalary,
     Pr.HourlyRate 
FROM 
     Location AS Lo inner join Employee AS Em
ON 
     Lo.LocationID = Em.LocationID
INNER JOIN 
     PayRates AS Pr
ON 
     Em.EmpID = Pr.EmpID",sql,,,,,,open,0,146,5,"Selecting fields from joined tables I am new to SQL.  I am trying to select some of the fields from 2 of 3 joined tables and all of the fields from a 3rd table.  Other than specifying each individual field from the Pr table, is the a simpler way to SELECT individual fields from two of the tables and SELECT * from the 3rd table.  My current query is below.  This is an exercise from a book.  If the 3rd table contained more fields this method would become very cumbersome.
 
SELECT 
     Lo.City, Em.FirstName, Em.LastName, Pr.EmpID, Pr.YearlySalary, Pr.MonthlySalary,
     Pr.HourlyRate 
FROM 
     Location AS Lo inner join Employee AS Em
ON 
     Lo.LocationID = Em.LocationID
INNER JOIN 
     PayRates AS Pr
ON 
     Em.EmpID = Pr.EmpID",1
2713189,04/26/2010 11:57:35,325950,04/26/2010 11:57:35,1,0,Deny Drop DB Objects Sql2008,"Need help, i need to set GRANT CREATE, ALTER BUT DENY DROP DB Objects to db users using sql 2008.

I've tried this but it returns error:
use DBName
GO
DENY DROP TO dbUser
Error: Incorrect syntax near 'DROP'.

Any help would be much appreciated.
Many thanks..

rfs",sql,,,,,,open,0,40,5,"Deny Drop DB Objects Sql2008 Need help, i need to set GRANT CREATE, ALTER BUT DENY DROP DB Objects to db users using sql 2008.

I've tried this but it returns error:
use DBName
GO
DENY DROP TO dbUser
Error: Incorrect syntax near 'DROP'.

Any help would be much appreciated.
Many thanks..

rfs",1
9058057,01/30/2012 00:16:37,434089,08/29/2010 06:08:12,690,0,Shortcomings of SQL and reasons why you would choose NoSQL over it,"I am doing a report on NoSQL databases and I would like to know why and in what instances would you want to switch to a NoSQL DBMS over a relational DBMS. Also, it would be helpful if I could get some links to the reasons why you choose NoSQL, so that I could put it in  the endnotes of my paper",sql,database,homework,nosql,,01/30/2012 00:48:34,not constructive,1,63,12,"Shortcomings of SQL and reasons why you would choose NoSQL over it I am doing a report on NoSQL databases and I would like to know why and in what instances would you want to switch to a NoSQL DBMS over a relational DBMS. Also, it would be helpful if I could get some links to the reasons why you choose NoSQL, so that I could put it in  the endnotes of my paper",4
10039128,04/06/2012 04:30:27,434899,08/30/2010 11:39:11,15,0,Need to optimize my sql server query,"I have one store procedure which populate one table. From that stored procedure below are the some queries which have more cost as per execution plan. I want to optimize this, please suggest me better way.

    /* Query 1 */
        SELECT @SSID AS SSID,  
        E.AdEnrollID,  
        E.GPA,  
        E.SyCampusID,  
	E.SyStudentID,  
	DA.genadAdvisorID,  
	CASE WHEN E.AdSapStatusID = 8 THEN 1 ELSE 0 END AS ExcededMaxTimeFrameInd,  
	CASE WHEN E.SySchoolStatusID = 15 THEN 1 ELSE 0 END AS CurrentStatusLeaveOfAbsenceInd,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 10 AND 19 THEN 1 ELSE 0 END AS ActiveStudentLastAttendance10to19Ind,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 20 AND 29 THEN 1 ELSE 0 END ActiveStudentLastAttendance20to29Ind,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) >= 30 THEN 1 ELSE 0 END AS ActiveStudentLastAttendance30UpInd,  
	E.LDA,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 10 AND 19 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 20 AND 29 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 2 AND 3 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 0 AND 3 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) >= 14 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) = 1 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 20 AND 29 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 2 AND 3 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) >= 30 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 4 AND 6 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 4 AND 7 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 7 AND 9 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 8 AND 14 THEN 1 ELSE 0 END,  
	DATEDIFF(d,ISNULL(E.LDA,'01/01/1900'),@Date) AS LastDateOfAttendanceTodayDiff,  
	1 AS NoCurrentCourseInd,  
	1 AS NoScheduledCourseInd,  
	0 AS ConsecutiveAbsence2to3Ind,  
	0 AS ConsecutiveAbsence3to4Ind,  
	0 AS ConsecutiveAbsence4UpInd,  
	0 AS ProgressRatePct,  
	0 AS CurrentCreditsAttempted,  
	0 AS CurrGradePointAverageAmt,  
	2 AS genAdReasonID  
	FROM   AdEnroll E WITH (INDEX (AdEnroll_AdAdvisorID_N_N_IDX), NOLOCK)  
	LEFT JOIN DimAdvisor DA WITH (INDEX (DimAdvisor_SSID_adAdvisorid_IDX), NOLOCK) ON DA.SSID = @SSID AND DA.AdAdvisorID = CASE WHEN ISNULL(E.AdAdvisorID, 0) = 0 	THEN -1 ELSE E.AdAdvisorID END  
	WHERE E.StartDate > '2010/12/31'   

	/* Query 2 */

	SELECT adenrollsched.AdEnrollID,  
	SUM(adenrollsched.MinutesAttended) AS Attend,  
	SUM(adenrollsched.MinutesAbsent) AS Absent,  
	SUM(adCourse.Hours) AS TotalHoursSchedule,  
	0,0,0,0,0  
	into #class  
	FROM adenrollsched (NOLOCK)  
	JOIN adCourse (NOLOCK) ON adCourse.adCourseID = adenrollsched.adCourseID  
	WHERE adCourse.Code NOT LIKE '%TESTPREP%'  
	GROUP BY enrollsched.AdEnrollID  
	
	/* Query 3 */

	SELECT adenrollid,adgradelettercode  
	into #grads  
	FROM adEnrollSched (NOLOCK) s  
	JOIN ADCourse (NOLOCK) c ON c.AdCourseID = s.AdCourseID  
	WHERE c.Code NOT LIKE '%TESTPREP%'  
	AND EXISTS (SELECT NULL FROM adenroll (NOLOCK) a WHERE a.adenrollid = s.adenrollid)  
	AND s.status IN ('D','P')  
	
	/* Query 4 */
 
	UPDATE e SET genAdReasonID = A.genAdReasonID  
	FROM EnrollmentAcademicPerformanceWIP AS e WITH (TABLOCK)  
	LEFT JOIN (SELECT SC.AdenrollID, DR.genAdReasonID, ROW_NUMBER() OVER (PARTITION BY SC.AdenrollID ORDER BY EffectiveDate DESC) AS rownum  
	FROM SyStatChange (NOLOCK) SC  
	JOIN DimDropReason (NOLOCK) DR ON DR.SSID = @SSID AND DR.AdReasonID = SC.AdReasonID  
	WHERE SC.NewSySchoolStatusID <> SC.PrevSySchoolStatusID AND SC.Status = 'P' AND   SC.NewSySchoolStatusID = 20) AS A ON e.AdEnrollID = A.AdEnrollID AND rownum=1


Thanks In advance.",sql,sql-server-2008,,,,04/06/2012 10:32:55,too localized,1,670,7,"Need to optimize my sql server query I have one store procedure which populate one table. From that stored procedure below are the some queries which have more cost as per execution plan. I want to optimize this, please suggest me better way.

    /* Query 1 */
        SELECT @SSID AS SSID,  
        E.AdEnrollID,  
        E.GPA,  
        E.SyCampusID,  
	E.SyStudentID,  
	DA.genadAdvisorID,  
	CASE WHEN E.AdSapStatusID = 8 THEN 1 ELSE 0 END AS ExcededMaxTimeFrameInd,  
	CASE WHEN E.SySchoolStatusID = 15 THEN 1 ELSE 0 END AS CurrentStatusLeaveOfAbsenceInd,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 10 AND 19 THEN 1 ELSE 0 END AS ActiveStudentLastAttendance10to19Ind,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 20 AND 29 THEN 1 ELSE 0 END ActiveStudentLastAttendance20to29Ind,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) >= 30 THEN 1 ELSE 0 END AS ActiveStudentLastAttendance30UpInd,  
	E.LDA,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 10 AND 19 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 20 AND 29 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 2 AND 3 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 0 AND 3 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) >= 14 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) = 1 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 20 AND 29 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 2 AND 3 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) >= 30 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 4 AND 6 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 4 AND 7 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 7 AND 9 THEN 1 ELSE 0 END,  
	CASE WHEN E.LDA IS NULL THEN 0 WHEN DATEDIFF(d,E.LDA,@Date) BETWEEN 8 AND 14 THEN 1 ELSE 0 END,  
	DATEDIFF(d,ISNULL(E.LDA,'01/01/1900'),@Date) AS LastDateOfAttendanceTodayDiff,  
	1 AS NoCurrentCourseInd,  
	1 AS NoScheduledCourseInd,  
	0 AS ConsecutiveAbsence2to3Ind,  
	0 AS ConsecutiveAbsence3to4Ind,  
	0 AS ConsecutiveAbsence4UpInd,  
	0 AS ProgressRatePct,  
	0 AS CurrentCreditsAttempted,  
	0 AS CurrGradePointAverageAmt,  
	2 AS genAdReasonID  
	FROM   AdEnroll E WITH (INDEX (AdEnroll_AdAdvisorID_N_N_IDX), NOLOCK)  
	LEFT JOIN DimAdvisor DA WITH (INDEX (DimAdvisor_SSID_adAdvisorid_IDX), NOLOCK) ON DA.SSID = @SSID AND DA.AdAdvisorID = CASE WHEN ISNULL(E.AdAdvisorID, 0) = 0 	THEN -1 ELSE E.AdAdvisorID END  
	WHERE E.StartDate > '2010/12/31'   

	/* Query 2 */

	SELECT adenrollsched.AdEnrollID,  
	SUM(adenrollsched.MinutesAttended) AS Attend,  
	SUM(adenrollsched.MinutesAbsent) AS Absent,  
	SUM(adCourse.Hours) AS TotalHoursSchedule,  
	0,0,0,0,0  
	into #class  
	FROM adenrollsched (NOLOCK)  
	JOIN adCourse (NOLOCK) ON adCourse.adCourseID = adenrollsched.adCourseID  
	WHERE adCourse.Code NOT LIKE '%TESTPREP%'  
	GROUP BY enrollsched.AdEnrollID  
	
	/* Query 3 */

	SELECT adenrollid,adgradelettercode  
	into #grads  
	FROM adEnrollSched (NOLOCK) s  
	JOIN ADCourse (NOLOCK) c ON c.AdCourseID = s.AdCourseID  
	WHERE c.Code NOT LIKE '%TESTPREP%'  
	AND EXISTS (SELECT NULL FROM adenroll (NOLOCK) a WHERE a.adenrollid = s.adenrollid)  
	AND s.status IN ('D','P')  
	
	/* Query 4 */
 
	UPDATE e SET genAdReasonID = A.genAdReasonID  
	FROM EnrollmentAcademicPerformanceWIP AS e WITH (TABLOCK)  
	LEFT JOIN (SELECT SC.AdenrollID, DR.genAdReasonID, ROW_NUMBER() OVER (PARTITION BY SC.AdenrollID ORDER BY EffectiveDate DESC) AS rownum  
	FROM SyStatChange (NOLOCK) SC  
	JOIN DimDropReason (NOLOCK) DR ON DR.SSID = @SSID AND DR.AdReasonID = SC.AdReasonID  
	WHERE SC.NewSySchoolStatusID <> SC.PrevSySchoolStatusID AND SC.Status = 'P' AND   SC.NewSySchoolStatusID = 20) AS A ON e.AdEnrollID = A.AdEnrollID AND rownum=1


Thanks In advance.",2
11232247,06/27/2012 17:56:19,1464379,06/18/2012 17:31:17,3,0,Compound Statement unable to change the delimiter,"I am attempting to run a simple compound statement within the Query Editor of DB Solo 4.2.2

It appears I am unable to properly change the end of line delimiter. I am using DB2. Here is a simple example that gives the error:

    --#SET TERMINATOR @
    
    BEGIN ATOMIC
    
    DECLARE id INT;
    SET id = 10;
    
    END @
    
    --#SET TERMINATOR ;

Error is:
An unexpected token ""INT"" was found following ""N ATOMIC  DECLARE id"". Expected tokens may include: ""END-OF-STATEMENT""

Thanks in advance

",sql,db2,,,,,open,0,112,7,"Compound Statement unable to change the delimiter I am attempting to run a simple compound statement within the Query Editor of DB Solo 4.2.2

It appears I am unable to properly change the end of line delimiter. I am using DB2. Here is a simple example that gives the error:

    --#SET TERMINATOR @
    
    BEGIN ATOMIC
    
    DECLARE id INT;
    SET id = 10;
    
    END @
    
    --#SET TERMINATOR ;

Error is:
An unexpected token ""INT"" was found following ""N ATOMIC  DECLARE id"". Expected tokens may include: ""END-OF-STATEMENT""

Thanks in advance

",2
148004,09/29/2008 08:56:14,16279,09/17/2008 15:54:57,1,1,Find out the calling stored procedure in SQL Server,"Is it possible to find out who called a store procedure. So if you get an error in proc3, I know if it was called by proc1 or proc2.

I'm using SQL Server 2005.",sql,database,stored-procedures,sql-server-2005,,,open,0,33,9,"Find out the calling stored procedure in SQL Server Is it possible to find out who called a store procedure. So if you get an error in proc3, I know if it was called by proc1 or proc2.

I'm using SQL Server 2005.",4
6526606,06/29/2011 20:08:19,511609,11/18/2010 03:05:35,61,4,vanilla SQl that select multiple values in single column,"If I have a table with customer IDs in one column and time zones in another, is there a plain SQL statement that can select all customer IDs that have different time zone values?  In other words, I want to find those customers with offices in New York, Chicago, and San Francisco but not those who ONLY have an office in one or the other time zones.",sql,,,,,,open,0,68,9,"vanilla SQl that select multiple values in single column If I have a table with customer IDs in one column and time zones in another, is there a plain SQL statement that can select all customer IDs that have different time zone values?  In other words, I want to find those customers with offices in New York, Chicago, and San Francisco but not those who ONLY have an office in one or the other time zones.",1
11096573,06/19/2012 07:46:37,508377,11/15/2010 14:47:43,1458,7,How to get the result of `elect statement grouped by a column to perform join statement on it?,How to get the result of `select` statement `grouped by` a column to perform `join` statement on it ?,sql,sql-server,select,join,,,open,0,19,18,How to get the result of `elect statement grouped by a column to perform join statement on it? How to get the result of `select` statement `grouped by` a column to perform `join` statement on it ?,4
1297007,08/18/2009 22:54:23,135152,07/08/2009 18:28:13,628,97,[sp_executesql] Incorrect syntax near 'sp_executesql',"I don't understand why the following is giving me the error.  I thought it was related to the commented out section, but @SQL is nvarchar(4000).

    BEGIN
      sp_executesql N'SELECT ''td'''
      --sp_executesql @SQL, N'@StartDate DateTime, @EndDate DateTime, @End2 DateTime, @Program varchar(4)', @StartDate, @EndDate, @End2, @Program
    END",sql,tsql,sql-server-2005,dynamic-sql,,,open,0,61,5,"[sp_executesql] Incorrect syntax near 'sp_executesql' I don't understand why the following is giving me the error.  I thought it was related to the commented out section, but @SQL is nvarchar(4000).

    BEGIN
      sp_executesql N'SELECT ''td'''
      --sp_executesql @SQL, N'@StartDate DateTime, @EndDate DateTime, @End2 DateTime, @Program varchar(4)', @StartDate, @EndDate, @End2, @Program
    END",4
8338896,12/01/2011 09:16:54,36633,11/11/2008 16:39:14,416,4,SQL Query Speed,"I'm building a report that collates a huge amount of data, the data for the report has taken shape as a view which run's in about 2 to 9 seconds (which is acceptable). I also have a function that returns a set of ids which needs to filter the view:

    select *
    from vw_report
    where employee_id in (select id from dbo.fnc_security(@personRanAsID))

The security function on it's own run's in less than a second. However when I combine the two as I have above the query takes over 15 minutes. 

Both the view and the security function do quite a lot of work so originally I thought it might be down to locking, I've tried no lock on the security function but it made no difference. 

Any tips or tricks as to where I may be going wrong?

It may be worth noting that when I copy the result of the function into the in part of the statement:

    select *
    from vw_report
    where employee_id in (123, 456, 789)

The speed increases back to 2 to 9 seconds.",sql,performance,reporting,,,,open,0,192,3,"SQL Query Speed I'm building a report that collates a huge amount of data, the data for the report has taken shape as a view which run's in about 2 to 9 seconds (which is acceptable). I also have a function that returns a set of ids which needs to filter the view:

    select *
    from vw_report
    where employee_id in (select id from dbo.fnc_security(@personRanAsID))

The security function on it's own run's in less than a second. However when I combine the two as I have above the query takes over 15 minutes. 

Both the view and the security function do quite a lot of work so originally I thought it might be down to locking, I've tried no lock on the security function but it made no difference. 

Any tips or tricks as to where I may be going wrong?

It may be worth noting that when I copy the result of the function into the in part of the statement:

    select *
    from vw_report
    where employee_id in (123, 456, 789)

The speed increases back to 2 to 9 seconds.",3
11723449,07/30/2012 14:21:44,419730,10/14/2008 18:29:10,1032,4,Finding Duplicate names sql,"   

    SELECT COUNT(organization.ID) 
    FROM organization 
    WHERE name in ( SELECT name FROM organization GROUP BY name HAVING count( name ) >1 )
    AND organization.APPROVED=0 
    AND organization.CREATED_AT>'2010-07-30 10:30:21'



I'm trying to find duplicates, but this query is taking a very long time roughly 5-6 seconds. Is there another way I can find duplicates without using my method? Thanks.",sql,duplicates,,,,,open,0,77,4,"Finding Duplicate names sql    

    SELECT COUNT(organization.ID) 
    FROM organization 
    WHERE name in ( SELECT name FROM organization GROUP BY name HAVING count( name ) >1 )
    AND organization.APPROVED=0 
    AND organization.CREATED_AT>'2010-07-30 10:30:21'



I'm trying to find duplicates, but this query is taking a very long time roughly 5-6 seconds. Is there another way I can find duplicates without using my method? Thanks.",2
9960548,03/31/2012 23:17:58,1287366,03/23/2012 02:32:50,17,0,trouble with qury finding the entry with the highest number,"I need some help a query. For each movie in my database that has at least one rating, I need to find the highest number of stars that movie has recieved. The data I want the query to return is movie, title and the number of stars sorted by movie title.

The tables I am working with are the following:

    Movie(mID int, title text, year int, director text);
    Reviewer(rID int, name text);
    Rating(rID int, mID int, stars int, ratingDate date);",sql,query,statement,,,,open,0,88,10,"trouble with qury finding the entry with the highest number I need some help a query. For each movie in my database that has at least one rating, I need to find the highest number of stars that movie has recieved. The data I want the query to return is movie, title and the number of stars sorted by movie title.

The tables I am working with are the following:

    Movie(mID int, title text, year int, director text);
    Reviewer(rID int, name text);
    Rating(rID int, mID int, stars int, ratingDate date);",3
9069278,01/30/2012 19:04:58,337422,05/10/2010 15:49:34,2730,79,Oracle To_Char function How to handle if it's already a string,"Scenario: I am calling a function that returns a field that the user enters in. The field usually returns a number like '120000' which I then use to_char to convert into '120,000'.

Problem: Some users enter in values such as '120,000' which gives me an error when trying to use to_char. Also the function will return a space ' ' if no value is found. I tried something with to_number earlier and it has a problem with the ' ' I believe.

Question: What would be the best way to handle this problem? Case statement checking for the ','? Using to_number then to_char?

Note: I can hack a solution together I'm just wondering what the best way to handle this is.",sql,oracle,formatting,to-char,to-number,,open,0,118,11,"Oracle To_Char function How to handle if it's already a string Scenario: I am calling a function that returns a field that the user enters in. The field usually returns a number like '120000' which I then use to_char to convert into '120,000'.

Problem: Some users enter in values such as '120,000' which gives me an error when trying to use to_char. Also the function will return a space ' ' if no value is found. I tried something with to_number earlier and it has a problem with the ' ' I believe.

Question: What would be the best way to handle this problem? Case statement checking for the ','? Using to_number then to_char?

Note: I can hack a solution together I'm just wondering what the best way to handle this is.",5
2155160,01/28/2010 14:31:28,261052,01/28/2010 14:28:11,1,0,SQL Query JOIN Performance,"I wanted to know what is better performance-wise:
to put the conditions in the JOIN? (x JOIN y on x.hi = y.hi AND ....) or maybe to put it under the WHERE, and leave the JOIN only with the crossing condition.



thanks folks",sql,join,where,query,performance,,open,0,41,4,"SQL Query JOIN Performance I wanted to know what is better performance-wise:
to put the conditions in the JOIN? (x JOIN y on x.hi = y.hi AND ....) or maybe to put it under the WHERE, and leave the JOIN only with the crossing condition.



thanks folks",5
8255641,11/24/2011 10:35:20,1063585,11/24/2011 09:11:27,-1,0,What s the use of count in stored proc?,"ex:SELECT @records = COUNT(FS.FILESET_ID) FROM FILE_SET FS WHERE (FILESET_NAME = @FILESET_NAME)
thank you",sql,,,,,11/24/2011 14:04:07,not a real question,1,12,9,"What s the use of count in stored proc? ex:SELECT @records = COUNT(FS.FILESET_ID) FROM FILE_SET FS WHERE (FILESET_NAME = @FILESET_NAME)
thank you",1
7142988,08/22/2011 03:52:44,609350,02/09/2011 07:22:06,11,0,SQL query performance,"please review my sample queries (given below), and let me know which query would perform better and why.Thankyou!

Approach 1:

    select team_id,grp_name,grp_desc from
    (
    select distinct team_id,grp_name,grp_desc from team_table tt where .....
    UNION
    select team_id,grp_name,grp_desc from sec_team_table stt where ....
    UNION
    select team_id,grp_name,grp_desc from ter_team_table ttt where...
    )

Approach 2:

    select distinct team_id,grp_name,grp_desc from team_table tt where .....
    UNION
    select team_id,grp_name,grp_desc from sec_team_table stt where ....
    UNION
    select team_id,grp_name,grp_desc from ter_team_table ttt where...



",sql,performance,,,,07/08/2012 01:17:11,not a real question,1,110,3,"SQL query performance please review my sample queries (given below), and let me know which query would perform better and why.Thankyou!

Approach 1:

    select team_id,grp_name,grp_desc from
    (
    select distinct team_id,grp_name,grp_desc from team_table tt where .....
    UNION
    select team_id,grp_name,grp_desc from sec_team_table stt where ....
    UNION
    select team_id,grp_name,grp_desc from ter_team_table ttt where...
    )

Approach 2:

    select distinct team_id,grp_name,grp_desc from team_table tt where .....
    UNION
    select team_id,grp_name,grp_desc from sec_team_table stt where ....
    UNION
    select team_id,grp_name,grp_desc from ter_team_table ttt where...



",2
4421768,12/12/2010 12:59:49,336186,05/08/2010 13:17:50,1448,115,The most useful User-Defined Aggregate Functions.,Do you have any aggregate functions that you have implemented because the standard ones were not good enough?,sql,aggregate-functions,,,,06/23/2012 20:39:08,not constructive,1,18,6,The most useful User-Defined Aggregate Functions. Do you have any aggregate functions that you have implemented because the standard ones were not good enough?,2
8503297,12/14/2011 10:55:00,1097627,12/14/2011 10:53:25,1,0,Oracle SQL query,"""select f.equipment_ID, f.LOT_NUM from fab.drill_solas f where f.equipment_ID = (select a.equipment_ID from fab.drill_solas a where (sysdate-a.prod_date) <=31 and a.prod_date = maxdate and group by a.EQUIPMENT_ID ) and f.prod_date = (select max(l.prod_date) as maxdate from fab.drill_solas l where (sysdate-l.prod_date) <=31 and l.equipment_ID=f.equipment_ID group by l.EQUIPMENT_ID) and (sysdate-f.prod_date)<=31""


I think my query is very wrong...
but i can't think of a better way for the sub query",sql,oracle,,,,12/14/2011 21:22:56,not a real question,1,63,3,"Oracle SQL query ""select f.equipment_ID, f.LOT_NUM from fab.drill_solas f where f.equipment_ID = (select a.equipment_ID from fab.drill_solas a where (sysdate-a.prod_date) <=31 and a.prod_date = maxdate and group by a.EQUIPMENT_ID ) and f.prod_date = (select max(l.prod_date) as maxdate from fab.drill_solas l where (sysdate-l.prod_date) <=31 and l.equipment_ID=f.equipment_ID group by l.EQUIPMENT_ID) and (sysdate-f.prod_date)<=31""


I think my query is very wrong...
but i can't think of a better way for the sub query",2
8588491,12/21/2011 10:38:20,349877,05/25/2010 12:17:27,174,0,I need to sync to Databases,"I want to create an environment where I have a database on one server and replicate (backup) db on another. The two need to synchronize data, i.e. if I add data to one database it's added to the other. If my main db falls I would like to fall back to the backup, however, and this is important, I don't want to lose the data that I entered into the backup db when I revert to the main once it's fixed. For example let's say I am adding users and my main db falls. I revert to the backup db while I fix the problem. I fix the problem and revert back to the main db. i don't want to lose the users I've added to the backup DB. However 99% of the time my main db is up and replicating to the backup db.

**I am using SQL Server 2008**",sql,sql-server,sql-server-2008,replication,,12/21/2011 18:11:47,off topic,1,150,6,"I need to sync to Databases I want to create an environment where I have a database on one server and replicate (backup) db on another. The two need to synchronize data, i.e. if I add data to one database it's added to the other. If my main db falls I would like to fall back to the backup, however, and this is important, I don't want to lose the data that I entered into the backup db when I revert to the main once it's fixed. For example let's say I am adding users and my main db falls. I revert to the backup db while I fix the problem. I fix the problem and revert back to the main db. i don't want to lose the users I've added to the backup DB. However 99% of the time my main db is up and replicating to the backup db.

**I am using SQL Server 2008**",4
3441277,08/09/2010 14:56:48,183408,10/02/2009 23:11:37,118,32,Data Design question,"I am having a tough time with this design problem and would appreciate any insight.

i have a doctors office that is provided certain privileges currently there are only 5 privileges but more could be added. Each of these privileges has a status of Yes or No, but there could be a finer grained status in the future and each of these privileges are related to a location(er,inpatient, outpatient) and they too could expand in future.

so currently i have the tables OfficePrivileges, PrivilegeLocation, PrivilegeType, PrivilegeStatus.

OfficePrivilege is a Joining table between PrivilegeLocation and DoctorOffice. It has a double primary key of OfficeID and PrivilegeLocationID.

At one time I had Type and status joined to the OfficePrivileges Table then switched to have the type table be a child of Location and status be a child of type. They are all single primary key tables.

**if you were designing this set of tables how would you do it?** I am thinking that this is almost a hierarchy problem..and I hate them. I would like to lay out the edit screen as crosstab table having Location across the top, Type down the side and details being the statuses. That is how it is currently in the system I am trying to integrate to, but its a cobol backend and handles hierachies better than relational db....",sql,database-design,table,,,,open,0,218,3,"Data Design question I am having a tough time with this design problem and would appreciate any insight.

i have a doctors office that is provided certain privileges currently there are only 5 privileges but more could be added. Each of these privileges has a status of Yes or No, but there could be a finer grained status in the future and each of these privileges are related to a location(er,inpatient, outpatient) and they too could expand in future.

so currently i have the tables OfficePrivileges, PrivilegeLocation, PrivilegeType, PrivilegeStatus.

OfficePrivilege is a Joining table between PrivilegeLocation and DoctorOffice. It has a double primary key of OfficeID and PrivilegeLocationID.

At one time I had Type and status joined to the OfficePrivileges Table then switched to have the type table be a child of Location and status be a child of type. They are all single primary key tables.

**if you were designing this set of tables how would you do it?** I am thinking that this is almost a hierarchy problem..and I hate them. I would like to lay out the edit screen as crosstab table having Location across the top, Type down the side and details being the statuses. That is how it is currently in the system I am trying to integrate to, but its a cobol backend and handles hierachies better than relational db....",3
3191623,07/07/2010 03:06:37,259348,01/26/2010 15:50:47,368,18,How to Optimize a Database - The Basics,"It seems that all questions regarding this topic are very specific, and while I value specific examples, I'm interested in the basics of SQL optimization.  I am very comfortable working in SQL, and have a background in hardware/low level software.

What I want is the tools both tangible software, and a method to look at the mysql databases I look at on a regular basis and know what the difference between orders of join statements and where statements.

I want to know why an index helps, like, exactly why.  I want to know specifically what happens differently, and I want to know how I can actually look at what is happening.  I don't need a tool that will breakdown every step of my SQL, I just want to be able to poke around and if someone can't tell me what column to index, I will be able to get out a sheet of paper and within some period of time be able to come up with the answers.

Databases are complicated, but they aren't THAT complicated, and there must be some great material out there for learning the basics so that you know how to find the answers to optimization problems you encounter, even if could hunt down the exact answer on a forum.

Please recommend some reading that is concise, intuitive, and not afraid to get down to the low level nuts and bolts.  I prefer online free resources, but if a book recommendation demolishes the nail head it hits I'd consider accepting it.",sql,mysql,database,optimization,query-optimization,,open,0,255,8,"How to Optimize a Database - The Basics It seems that all questions regarding this topic are very specific, and while I value specific examples, I'm interested in the basics of SQL optimization.  I am very comfortable working in SQL, and have a background in hardware/low level software.

What I want is the tools both tangible software, and a method to look at the mysql databases I look at on a regular basis and know what the difference between orders of join statements and where statements.

I want to know why an index helps, like, exactly why.  I want to know specifically what happens differently, and I want to know how I can actually look at what is happening.  I don't need a tool that will breakdown every step of my SQL, I just want to be able to poke around and if someone can't tell me what column to index, I will be able to get out a sheet of paper and within some period of time be able to come up with the answers.

Databases are complicated, but they aren't THAT complicated, and there must be some great material out there for learning the basics so that you know how to find the answers to optimization problems you encounter, even if could hunt down the exact answer on a forum.

Please recommend some reading that is concise, intuitive, and not afraid to get down to the low level nuts and bolts.  I prefer online free resources, but if a book recommendation demolishes the nail head it hits I'd consider accepting it.",5
769291,04/20/2009 17:30:15,18297,09/18/2008 21:51:20,81,7,Time arithmetics in SQL TABLE DEFAULT,"In my table I want to set default of a column to 30 days from now. This needs to be a real, not computed column. Something like

`alter table T_NAME alter column EXPIRATION set defaul CURRENT_TIMESTAMP + 2592000` 

is not valid, but you get the idea. I am sure I can do that with a before insert trigger, but I was just wondering if there is a trick for doing arithmetics in default clause that I just don't know about. 

My DB is Firebird 2.1.2",sql,firebird,,,,,open,0,84,6,"Time arithmetics in SQL TABLE DEFAULT In my table I want to set default of a column to 30 days from now. This needs to be a real, not computed column. Something like

`alter table T_NAME alter column EXPIRATION set defaul CURRENT_TIMESTAMP + 2592000` 

is not valid, but you get the idea. I am sure I can do that with a before insert trigger, but I was just wondering if there is a trick for doing arithmetics in default clause that I just don't know about. 

My DB is Firebird 2.1.2",2
3257269,07/15/2010 15:43:23,388113,07/09/2010 20:38:11,1,0,TSQL Merge statement hanging ,"I currently run the following statement and the query never completes. I am unsure why as I use the same query with other source tables and it completes very quickly, this source table is not bigger.

 merge into dbo.Tickets_Amends as target
 using  dbo.Tickets_Healthchecks_parentlesstickets as source
 on     (target.fault_ID = source.fault_ID)
 when not matched by target then 
 insert  (fault_ID) values (source.fault_ID);
 GO

Any ideas on how I can establish the error here ?",sql,sql-server-2008,merge,hanging,,05/26/2011 11:02:14,too localized,1,77,5,"TSQL Merge statement hanging  I currently run the following statement and the query never completes. I am unsure why as I use the same query with other source tables and it completes very quickly, this source table is not bigger.

 merge into dbo.Tickets_Amends as target
 using  dbo.Tickets_Healthchecks_parentlesstickets as source
 on     (target.fault_ID = source.fault_ID)
 when not matched by target then 
 insert  (fault_ID) values (source.fault_ID);
 GO

Any ideas on how I can establish the error here ?",4
1969812,12/28/2009 14:47:25,199722,10/30/2009 15:19:19,41,1,How I could assign a preset set of string values to a field of table in SQLServer 2008?,"I want a field in a table of SQLServer 2008 to contain a preset number of string values for user to be able then to select one value from a dropdown listbox in my WPF front-end app.

Is it possible only through assigning a numeric int type in a SQLServer table field and then doing all the stuff through C# front-end coding, or are there other ways?

 ",sql,c#,wpf,mapping,,,open,0,67,18,"How I could assign a preset set of string values to a field of table in SQLServer 2008? I want a field in a table of SQLServer 2008 to contain a preset number of string values for user to be able then to select one value from a dropdown listbox in my WPF front-end app.

Is it possible only through assigning a numeric int type in a SQLServer table field and then doing all the stuff through C# front-end coding, or are there other ways?

 ",4
10073754,04/09/2012 13:15:09,1031690,11/06/2011 00:10:33,83,2,how can i sort the table columns according to datetime in sql server 2008?,"I added a lot of rows to table. it is sorted by ID However, I want to sort by datetime.

 table name's is rss and column's name is rss_date(type: DateTime)",sql,sql-server,,,,04/09/2012 19:27:22,not a real question,1,30,14,"how can i sort the table columns according to datetime in sql server 2008? I added a lot of rows to table. it is sorted by ID However, I want to sort by datetime.

 table name's is rss and column's name is rss_date(type: DateTime)",2
8039961,11/07/2011 17:12:07,236573,12/22/2009 04:29:46,1106,73,SQL Server XML Import - Is there a way to make the value operator return null on missing elements,"I have a stored proc that inserts XML into an underlying table.  Unfortunately the XML passed in as a Sql XML type sometimes has particular elements missing.  This makes the INSERT statement insert XML node values into the wrong columns.

My T-SQL looks something like this:

    ALTER PROCEDURE [dbo].[up_Test_Insert]
    	@xmlData XML
    AS
    BEGIN
    INSERT INTO
    TestTable
    (
      ColumnA,
      ColumnB,
      ColumnC
    )
    SELECT
        Tbl.Col.value(ColumnA[1]', 'INT'),
        Tbl.Col.value('ColumnB[1]', 'INT'),
        Tbl.Col.value('ColumnC[1]', 'INT')
     FROM
       @xmlData.nodes('DocumentElement/DataTable') Tbl(Col) 

Sometimes ColumnB element may be missing in the XML structure.  This results in the ColumnC node value being inserted into the ColumnB table column.

Is there a way to make the value operator return null on missing elements?",sql,xml,sql-server-2008,,,,open,0,183,19,"SQL Server XML Import - Is there a way to make the value operator return null on missing elements I have a stored proc that inserts XML into an underlying table.  Unfortunately the XML passed in as a Sql XML type sometimes has particular elements missing.  This makes the INSERT statement insert XML node values into the wrong columns.

My T-SQL looks something like this:

    ALTER PROCEDURE [dbo].[up_Test_Insert]
    	@xmlData XML
    AS
    BEGIN
    INSERT INTO
    TestTable
    (
      ColumnA,
      ColumnB,
      ColumnC
    )
    SELECT
        Tbl.Col.value(ColumnA[1]', 'INT'),
        Tbl.Col.value('ColumnB[1]', 'INT'),
        Tbl.Col.value('ColumnC[1]', 'INT')
     FROM
       @xmlData.nodes('DocumentElement/DataTable') Tbl(Col) 

Sometimes ColumnB element may be missing in the XML structure.  This results in the ColumnC node value being inserted into the ColumnB table column.

Is there a way to make the value operator return null on missing elements?",3
11048130,06/15/2012 09:35:46,1359743,04/26/2012 21:18:44,1,0,V-79-65323-3201 - Cannot open SQL backup device,"I am not able to carry out any backups of the SQL databases on the one of server. 
These are the errors that are coming  up:
 
 V-79-65323-3201 -  An error occurred on a query to database 
 DBNAME.V-79-65323-3201 - Cannot open backup device 
 'DBNAME_ 80a0cdb40e3a_'. Operating system error 0x80070005(failed to retrieve text for this error. Reason: 15105).

TO TRACE THIS ISSUE : 

I have tested access to the server from Backup Exec using the sqlservice account but this account is not able to access a number of the SQL DB's. The administrator account is able to access all the database components but I am receiving the following error on all the databases: An error occurred on a query to database <database name>. V-79-65323-3201 - Cannot open SQL backup device. 

By using ssms I cane take te .BAK fomat backup b bot through backup exec.

PLease let me know if you need any other details.
Thanks in Advance.

",sql,,,,,06/15/2012 15:35:04,off topic,1,158,7,"V-79-65323-3201 - Cannot open SQL backup device I am not able to carry out any backups of the SQL databases on the one of server. 
These are the errors that are coming  up:
 
 V-79-65323-3201 -  An error occurred on a query to database 
 DBNAME.V-79-65323-3201 - Cannot open backup device 
 'DBNAME_ 80a0cdb40e3a_'. Operating system error 0x80070005(failed to retrieve text for this error. Reason: 15105).

TO TRACE THIS ISSUE : 

I have tested access to the server from Backup Exec using the sqlservice account but this account is not able to access a number of the SQL DB's. The administrator account is able to access all the database components but I am receiving the following error on all the databases: An error occurred on a query to database <database name>. V-79-65323-3201 - Cannot open SQL backup device. 

By using ssms I cane take te .BAK fomat backup b bot through backup exec.

PLease let me know if you need any other details.
Thanks in Advance.

",1
4055258,10/29/2010 19:34:03,166229,07/06/2009 10:14:19,193,8,Compatible boolean data type of various relational databases,"I am trying to create a select statement that is compatible with all major relational databases (MySQL, PostgreSQL, Derby, SQLite, ...).

Here the simple select statement: `SELECT * FROM taggings WHERE public IS TRUE`

The problem is that SQLite for example does not support the boolean data type, so I rewrote my statement to: `SELECT * FROM taggings WHERE public = 1`

As far as I know it is valid for SQLite (wich uses some kind of byte for the public field) and also MySQL (which interprets the 1 as true, cause it uses the boolean type for the public field).

How about PostgreSQL when also uses a boolean public field? From the manual it looks like that I have to write `SELECT * FROM taggings WHERE public = '1'`. Or is that equivalent in that case to the above statement? (I don't have a chance to setup a PostgreSQL database here.)

Thanks for the help!",sql,mysql,database,sqlite,postgresql,,open,0,151,8,"Compatible boolean data type of various relational databases I am trying to create a select statement that is compatible with all major relational databases (MySQL, PostgreSQL, Derby, SQLite, ...).

Here the simple select statement: `SELECT * FROM taggings WHERE public IS TRUE`

The problem is that SQLite for example does not support the boolean data type, so I rewrote my statement to: `SELECT * FROM taggings WHERE public = 1`

As far as I know it is valid for SQLite (wich uses some kind of byte for the public field) and also MySQL (which interprets the 1 as true, cause it uses the boolean type for the public field).

How about PostgreSQL when also uses a boolean public field? From the manual it looks like that I have to write `SELECT * FROM taggings WHERE public = '1'`. Or is that equivalent in that case to the above statement? (I don't have a chance to setup a PostgreSQL database here.)

Thanks for the help!",5
657336,03/18/2009 08:16:44,78493,03/16/2009 08:38:35,1,0,Error start sql developer,"HI everyone.

I am trying to run sqldeveloper on my Red Hat Linux Enterprise 5 machine but get the following error:

[root@machine plugins]# sqldeveloper

Oracle SQL Developer
Copyright (c) 2006, 2007, Oracle. All rights reserved. 

WARNING: error instantiating 'java.util.logging.FileHandler,' referenced by handlers, class not found
java.lang.ClassNotFoundException: java.util.logging.FileHandler,
<<No stacktrace available>>
Exception during runtime initialization
java.lang.ExceptionInInitializerError
<<No stacktrace available>>
Caused by: java.lang.NullPointerException
<<No stacktrace available>>
[root@machine plugins]# 

Do anyone have idea to help me?",sql,developer,,,,,open,0,61,4,"Error start sql developer HI everyone.

I am trying to run sqldeveloper on my Red Hat Linux Enterprise 5 machine but get the following error:

[root@machine plugins]# sqldeveloper

Oracle SQL Developer
Copyright (c) 2006, 2007, Oracle. All rights reserved. 

WARNING: error instantiating 'java.util.logging.FileHandler,' referenced by handlers, class not found
java.lang.ClassNotFoundException: java.util.logging.FileHandler,
<<No stacktrace available>>
Exception during runtime initialization
java.lang.ExceptionInInitializerError
<<No stacktrace available>>
Caused by: java.lang.NullPointerException
<<No stacktrace available>>
[root@machine plugins]# 

Do anyone have idea to help me?",2
4853361,01/31/2011 16:31:17,576850,01/15/2011 16:25:44,11,0,MSSQL Insert next available int,"I'm dealing with a table in MSSQL that has a serial_no column, which is defined as a non null int. It doesn't appear to be an auto incrementing field, as if I leave that column out of my insert statement I get an error saying that the serial_no field cannot be null.

So how do I insert the next available number?

I tried this:

    INSERT INTO mytable (serial_no) VALUES ( (SELECT MAX(serial_no)+1 FROM mytable))

but I get an error saying that subqueries cannot be used in this context.",sql,sql-server,insert,autoincrement,,,open,0,88,5,"MSSQL Insert next available int I'm dealing with a table in MSSQL that has a serial_no column, which is defined as a non null int. It doesn't appear to be an auto incrementing field, as if I leave that column out of my insert statement I get an error saying that the serial_no field cannot be null.

So how do I insert the next available number?

I tried this:

    INSERT INTO mytable (serial_no) VALUES ( (SELECT MAX(serial_no)+1 FROM mytable))

but I get an error saying that subqueries cannot be used in this context.",4
11570879,07/19/2012 23:40:35,858040,07/22/2011 13:46:39,69,12,Simple and intuitive way to make visual query,"This question is for UX/UI/GUI... Is there a simple and visual way to make querys?? im looking for a simple and intuitive way... I suppose that the user wish select all fields of a table, but i don't find the way to make simple the filters for this. my boss don't wish a classic query builder, example http://tinypic.com/r/2j2z6et/6

i would appreciate your help.",sql,gui,user-interface,user-experience,,07/20/2012 14:48:21,not a real question,1,62,8,"Simple and intuitive way to make visual query This question is for UX/UI/GUI... Is there a simple and visual way to make querys?? im looking for a simple and intuitive way... I suppose that the user wish select all fields of a table, but i don't find the way to make simple the filters for this. my boss don't wish a classic query builder, example http://tinypic.com/r/2j2z6et/6

i would appreciate your help.",4
8644365,12/27/2011 11:58:01,128071,06/24/2009 08:39:06,1543,0,How to order the nvarchar values,"Table1

    Values
    
    03 - Rajan
    02 - Kumar
    01 - Vijayan
    ....

Query

Select * from table1 order by values

Output is showing as

    Values

    02 - Kumar
    03 - Rajan
    01 - Vijayan
    ....

I want to order by 01, 02, 03

Expected Output

Values
    
    01 - Vijayan
    02 - Kumar
    03 - Rajan
    ....

How to make a query

Need Query Help",sql,sql-server,sql-server-2000,,,12/28/2011 07:54:58,not a real question,1,106,6,"How to order the nvarchar values Table1

    Values
    
    03 - Rajan
    02 - Kumar
    01 - Vijayan
    ....

Query

Select * from table1 order by values

Output is showing as

    Values

    02 - Kumar
    03 - Rajan
    01 - Vijayan
    ....

I want to order by 01, 02, 03

Expected Output

Values
    
    01 - Vijayan
    02 - Kumar
    03 - Rajan
    ....

How to make a query

Need Query Help",3
6207139,06/01/2011 20:19:39,310465,04/06/2010 23:04:45,279,13,"How to do ""where exists"" in Arel","How do you do a query that includes a ""where exists"" in Arel? For example on a query like this to show all the suppliers with at least one order:

    SELECT *
    FROM suppliers
    WHERE EXISTS
      (SELECT *
        FROM orders
        WHERE suppliers.supplier_id = orders.supplier_id);

I see ""exists"" in the Arel docs http://rubydoc.info/gems/arel/2.0.7/Arel/Nodes/Exists but I'm having trouble using it.",sql,ruby,database,ruby-on-rails-3,arel,,open,0,85,7,"How to do ""where exists"" in Arel How do you do a query that includes a ""where exists"" in Arel? For example on a query like this to show all the suppliers with at least one order:

    SELECT *
    FROM suppliers
    WHERE EXISTS
      (SELECT *
        FROM orders
        WHERE suppliers.supplier_id = orders.supplier_id);

I see ""exists"" in the Arel docs http://rubydoc.info/gems/arel/2.0.7/Arel/Nodes/Exists but I'm having trouble using it.",5
3149470,06/30/2010 13:03:32,380074,06/30/2010 12:57:43,1,0,sql trigger error:invalid specification,"i am creating a trigger and receiving some error, which i m not able to understand. Pls can anyone help me with that.


create or REPLACE TRIGGER trig_data
  BEFORE INSERT
    ON data_db REFERENCING OLD AS OLD AND NEW AS NEW
    FOR EACH ROW
    BEGIN
      SELECT RAHUL_SEQUENCE.NEXTVAL INTO :NEW.USERID FROM DUAL; 
    END;
Error report:
ORA-04079: invalid trigger specification
04079. 00000 -  ""invalid trigger specification""
*Cause:    The create TRIGGER statement is invalid.
*Action:   Check the statement for correct syntax.",sql,sql-server,oracle11g,plsqldeveloper,,,open,0,96,4,"sql trigger error:invalid specification i am creating a trigger and receiving some error, which i m not able to understand. Pls can anyone help me with that.


create or REPLACE TRIGGER trig_data
  BEFORE INSERT
    ON data_db REFERENCING OLD AS OLD AND NEW AS NEW
    FOR EACH ROW
    BEGIN
      SELECT RAHUL_SEQUENCE.NEXTVAL INTO :NEW.USERID FROM DUAL; 
    END;
Error report:
ORA-04079: invalid trigger specification
04079. 00000 -  ""invalid trigger specification""
*Cause:    The create TRIGGER statement is invalid.
*Action:   Check the statement for correct syntax.",4
7990265,11/03/2011 04:28:17,128071,06/24/2009 08:39:06,1392,0,How to delete the last record,"Using SQL Server 2000

Table

    ID Date Value
    
    001 23-02-2009 300
    001 24-02-2009 400
    001 25-02-2009 150
    002 23-02-2009 300
    002 24-02-2009 400
    003 23-02-2009 150
    .....
    .....

From the above table i want to delete the last date for each id.

How to make a query

Expected output

     ID Date Value
        
        001 23-02-2009 300
        001 24-02-2009 400
        002 23-02-2009 300
        .....
        .....
        .....

Need Query Help
",sql,sql-server,,,,,open,0,147,6,"How to delete the last record Using SQL Server 2000

Table

    ID Date Value
    
    001 23-02-2009 300
    001 24-02-2009 400
    001 25-02-2009 150
    002 23-02-2009 300
    002 24-02-2009 400
    003 23-02-2009 150
    .....
    .....

From the above table i want to delete the last date for each id.

How to make a query

Expected output

     ID Date Value
        
        001 23-02-2009 300
        001 24-02-2009 400
        002 23-02-2009 300
        .....
        .....
        .....

Need Query Help
",2
812675,05/01/2009 18:44:34,18821,09/19/2008 13:10:32,933,63,Sum different row in column based on second column value,"I have an Orders table (simplified)

    OrderId,
    SalesPersonId,
    SaleAmount,
    CurrencyId,
    ...


I am attempting to create a report on this table, I'm hoping for something like:

<table>
<thead>
<th>SalesPersonId &nbsp;</th> <th>TotalCAD &nbsp;</th> <th>TotalUSD &nbsp;</th>
</thead>
<tr>
<td>1</td><td>12,345.00</td><td>6,789.00</td>
</tr>
<tr>
<td>2</td><td>7,890.00</td><td>1,234.00</td>
</tr>
</table>


I'd prefer not to do a self join (perhaps I'm optimizing prematurely, but this seems inefficient) IE:


    SELECT SalesPersonId, SUM(OrdersCAD.SaleAmount), SUM(OrderUSD.SaleAmount)
    FROM Orders
        LEFT JOIN Orders AS OrdersCAD ON Orders.OrderID AND Orders.CurrencyID = 1
        LEFT JOIN Orders AS OrdersUSD ON Orders.OrderID AND Orders.CurrencyID = 2

But I cannot think of another way to do this, any idea's?",sql,sql-server,,,,,open,0,120,10,"Sum different row in column based on second column value I have an Orders table (simplified)

    OrderId,
    SalesPersonId,
    SaleAmount,
    CurrencyId,
    ...


I am attempting to create a report on this table, I'm hoping for something like:

<table>
<thead>
<th>SalesPersonId &nbsp;</th> <th>TotalCAD &nbsp;</th> <th>TotalUSD &nbsp;</th>
</thead>
<tr>
<td>1</td><td>12,345.00</td><td>6,789.00</td>
</tr>
<tr>
<td>2</td><td>7,890.00</td><td>1,234.00</td>
</tr>
</table>


I'd prefer not to do a self join (perhaps I'm optimizing prematurely, but this seems inefficient) IE:


    SELECT SalesPersonId, SUM(OrdersCAD.SaleAmount), SUM(OrderUSD.SaleAmount)
    FROM Orders
        LEFT JOIN Orders AS OrdersCAD ON Orders.OrderID AND Orders.CurrencyID = 1
        LEFT JOIN Orders AS OrdersUSD ON Orders.OrderID AND Orders.CurrencyID = 2

But I cannot think of another way to do this, any idea's?",2
10455106,05/04/2012 19:38:39,1069771,11/28/2011 16:43:11,29,0,translate SQL query into relational algebra,"I know how to convert sql to relational algebra when there is only one condiction. I have diffculty when there are two condictions.
Here is an example:

    SELECT R.A
    FROM R S
    WHERE R.A = S.A AND R.B = S.D

Can someone teach me how to do the translation. Many thanks.",sql,relational-algebra,,,,05/04/2012 20:13:02,off topic,1,58,6,"translate SQL query into relational algebra I know how to convert sql to relational algebra when there is only one condiction. I have diffculty when there are two condictions.
Here is an example:

    SELECT R.A
    FROM R S
    WHERE R.A = S.A AND R.B = S.D

Can someone teach me how to do the translation. Many thanks.",2
4873222,02/02/2011 10:21:58,264586,02/02/2010 17:46:20,395,33,SQL Perameter as Char[],"All I am having a little problem here is the sample code 


    create table Sections (ID int, name char(1), Description nvarchar(50))
    
    insert into Sections values (1,'A','A Section')
    insert into Sections values (2,'B','B Section')
    insert into Sections values (3,'C','C Section')
    insert into Sections values (4,'D','D Section')
    insert into Sections values (5,'E','E Section')
    insert into Sections values (6,'F','F Section')
    
    select * from Sections
    declare @Names nvarchar(10) ='A,B,C';
    select *from Sections where name in (@Names)


What i want is that i will pass an string that string will be splited into each char and that char array will be passed in the where clause. 
I have tried it with numeric that works fine but in the char it not working properly. 
what i have done is like this 




    declare @Categories nvarchar(50)='ABC';
    declare @array nvarchar(50);
    declare @lenth int =len(@Categories);
    Declare @c int =1;
    declare @param nvarchar(50)='' ;
    
    while @c <=@lenth
    begin
    set @param = @param + ''''+ SUBSTRING(@Categories ,@c,1) +''''+','
    set @c =@c+1
    
    end
    print @param
    
    declare @Cats nvarchar(50); 
    set @Cats=  substring(@param, 0,len(@param)-0)

Its output like 'A','B','C'. but when i am passing this @Cats to the sp this will return no records. 


",sql,sql-server,,,,,open,0,280,4,"SQL Perameter as Char[] All I am having a little problem here is the sample code 


    create table Sections (ID int, name char(1), Description nvarchar(50))
    
    insert into Sections values (1,'A','A Section')
    insert into Sections values (2,'B','B Section')
    insert into Sections values (3,'C','C Section')
    insert into Sections values (4,'D','D Section')
    insert into Sections values (5,'E','E Section')
    insert into Sections values (6,'F','F Section')
    
    select * from Sections
    declare @Names nvarchar(10) ='A,B,C';
    select *from Sections where name in (@Names)


What i want is that i will pass an string that string will be splited into each char and that char array will be passed in the where clause. 
I have tried it with numeric that works fine but in the char it not working properly. 
what i have done is like this 




    declare @Categories nvarchar(50)='ABC';
    declare @array nvarchar(50);
    declare @lenth int =len(@Categories);
    Declare @c int =1;
    declare @param nvarchar(50)='' ;
    
    while @c <=@lenth
    begin
    set @param = @param + ''''+ SUBSTRING(@Categories ,@c,1) +''''+','
    set @c =@c+1
    
    end
    print @param
    
    declare @Cats nvarchar(50); 
    set @Cats=  substring(@param, 0,len(@param)-0)

Its output like 'A','B','C'. but when i am passing this @Cats to the sp this will return no records. 


",2
5858032,05/02/2011 13:56:22,198183,10/28/2009 14:55:35,2226,42,SQL: fetching-order,"    my $sth = $dbh->prepare( ""SELECT id, name, size, date FROM $table"" );

    while ( my @row = $sth->fetchrow_array ) {
	    say ""@row"";
    }


Are the elements in the `@row`-array always be in the same order as written in the SELECT-query?",sql,perl,,,,,open,0,52,2,"SQL: fetching-order     my $sth = $dbh->prepare( ""SELECT id, name, size, date FROM $table"" );

    while ( my @row = $sth->fetchrow_array ) {
	    say ""@row"";
    }


Are the elements in the `@row`-array always be in the same order as written in the SELECT-query?",2
8885214,01/16/2012 19:25:40,816627,06/27/2011 00:14:24,24,1,How to convert mmm d yyyy HH:MM[AM] to datetime in SQL?,"I am going nuts with datatime and MS SQL.

i have (example) Aug  4 2011 12:00AM

how do I converto to a datetime (or smalldatetime) type.

    convert(datetime, 'Aug  4 2011 12:00AM') doesn't work.

Thanks.

",sql,datetime,,,,01/16/2012 20:37:57,too localized,1,36,11,"How to convert mmm d yyyy HH:MM[AM] to datetime in SQL? I am going nuts with datatime and MS SQL.

i have (example) Aug  4 2011 12:00AM

how do I converto to a datetime (or smalldatetime) type.

    convert(datetime, 'Aug  4 2011 12:00AM') doesn't work.

Thanks.

",2
8875926,01/16/2012 04:56:41,983477,10/07/2011 06:29:59,604,45,SQL Query Issue,"I stuck in a SQL query,

I have a table salary whose structure is as follow :

    Name Amount
    a     100
    b     300
    c     250

I have to write a query which gives the following result :

   

     Name Amount RelevantAmount
        a     100    100
        b     300    400
        c     250    650

I didn't found any idea that how to write this query without using any cursor and trigger.

  

",sql,,,,,01/16/2012 06:49:20,not a real question,1,138,3,"SQL Query Issue I stuck in a SQL query,

I have a table salary whose structure is as follow :

    Name Amount
    a     100
    b     300
    c     250

I have to write a query which gives the following result :

   

     Name Amount RelevantAmount
        a     100    100
        b     300    400
        c     250    650

I didn't found any idea that how to write this query without using any cursor and trigger.

  

",1
7107294,08/18/2011 12:19:31,37532,11/14/2008 00:57:13,3442,189,optimizing memory intensive script,"I currently have this code:

      shop_category.shop_sub_categories.each do |sub_category|
         products << sub_category.products 
       end 
    
       products = products.flatten.uniq.compact
    
    
       data = products.first(100).map do |product|
        {
          :name => CGI.unescapeHTML(product.name),
          :manufacturer => product.manufacturer,
          :detail => product.description,
          :sales_rank => product.sales_rank,
          :price => product.price,
          :retailer => product.retailer
        }
       end

I have found this pretty much memory intensive as it uses up to 96% of my CPU:

       shop_category.shop_sub_categories.each do |sub_category|
         products << sub_category.products 
       end 

I am thinking of making a writing something in tune of a WHERE IN statement so that I might only query data from like so:

SELECT * FROM products JOIN shop_categorization ON product_id = products.id WHERE shop_sub_category_id IN (1,2,3,4,5)

I currently put on this script which does great. I am thinking if there is something that can be done to make this more Rails-y.

      sub_category_ids = shop_category.shop_sub_categories.map(&:id)
      sub_category_ids = sub_category_ids.join(',')
      products = Product.find_by_sql(""SELECT * FROM products JOIN shop_sub_categorizations ON product_id = products.id WHERE shop_sub_categorizations.shop_sub_category_id IN (#{sub_category_ids}) LIMIT 100"")",sql,ruby-on-rails,,,,,open,0,305,4,"optimizing memory intensive script I currently have this code:

      shop_category.shop_sub_categories.each do |sub_category|
         products << sub_category.products 
       end 
    
       products = products.flatten.uniq.compact
    
    
       data = products.first(100).map do |product|
        {
          :name => CGI.unescapeHTML(product.name),
          :manufacturer => product.manufacturer,
          :detail => product.description,
          :sales_rank => product.sales_rank,
          :price => product.price,
          :retailer => product.retailer
        }
       end

I have found this pretty much memory intensive as it uses up to 96% of my CPU:

       shop_category.shop_sub_categories.each do |sub_category|
         products << sub_category.products 
       end 

I am thinking of making a writing something in tune of a WHERE IN statement so that I might only query data from like so:

SELECT * FROM products JOIN shop_categorization ON product_id = products.id WHERE shop_sub_category_id IN (1,2,3,4,5)

I currently put on this script which does great. I am thinking if there is something that can be done to make this more Rails-y.

      sub_category_ids = shop_category.shop_sub_categories.map(&:id)
      sub_category_ids = sub_category_ids.join(',')
      products = Product.find_by_sql(""SELECT * FROM products JOIN shop_sub_categorizations ON product_id = products.id WHERE shop_sub_categorizations.shop_sub_category_id IN (#{sub_category_ids}) LIMIT 100"")",2
8177665,11/18/2011 04:10:54,586208,01/23/2011 07:54:09,8,0,Oracle joins (need tutorial),"Can anyone direct me to some ""in depth"" material convering sql joins, specifically table-field joins in oracle?

All the software at my new job use uses crazy 250+ line sql queries joining up to 12 table fields at a time on oracle, and I was never very good with joins, nor do I have much experience with oracle (I've always used MySQL).

I figure I should to take a ""go big or go home"" approach to this (if I wanna keep my job) and need something that covers it really well. I've already read a book on the ins and outs of oracle but for an in depth book on a database it didn't have a lot of info on the queries used by it.",sql,oracle,join,,,11/19/2011 07:46:24,not a real question,1,123,4,"Oracle joins (need tutorial) Can anyone direct me to some ""in depth"" material convering sql joins, specifically table-field joins in oracle?

All the software at my new job use uses crazy 250+ line sql queries joining up to 12 table fields at a time on oracle, and I was never very good with joins, nor do I have much experience with oracle (I've always used MySQL).

I figure I should to take a ""go big or go home"" approach to this (if I wanna keep my job) and need something that covers it really well. I've already read a book on the ins and outs of oracle but for an in depth book on a database it didn't have a lot of info on the queries used by it.",3
6285900,06/08/2011 22:12:12,395416,07/19/2010 01:02:31,3,0,Set permissions on newly created databases with rules,"I have a situation whereby an application we use has many databases used for storage, and creates new ones on the fly as needed (SQL Server 2008 R2).

- ApplicationDatabase
- ApplicationDatabase_Storage001
- ApplicationDatabase_Storage002
- ApplicationDatabase_Storage003
- etc...

As needed the application will create a new storage database for itself.

My problem is that I have a sql server account that is used for the ApplicationDatabase, and I want to automatically give it permissions to the storage databases as they are created, but not to any other database that happens to be created in the same sql server instance. I have no control over the creation of the storage databases.

I read [In the answer to this question](http://stackoverflow.com/questions/3550497/sql-server-give-a-login-permission-for-read-access-to-all-existing-and-future-d) that I can add the account in the model database however this appears to add the permissions for all new databases, when I only want it to apply to the databases mentioned above.

The best solution I could come up with is a SQL server job or external app that runs once a day or so and looks for the existence of each database, applying the permissions on each that it finds, but this does not seem ideal.",sql,sql-server,,,,,open,0,187,8,"Set permissions on newly created databases with rules I have a situation whereby an application we use has many databases used for storage, and creates new ones on the fly as needed (SQL Server 2008 R2).

- ApplicationDatabase
- ApplicationDatabase_Storage001
- ApplicationDatabase_Storage002
- ApplicationDatabase_Storage003
- etc...

As needed the application will create a new storage database for itself.

My problem is that I have a sql server account that is used for the ApplicationDatabase, and I want to automatically give it permissions to the storage databases as they are created, but not to any other database that happens to be created in the same sql server instance. I have no control over the creation of the storage databases.

I read [In the answer to this question](http://stackoverflow.com/questions/3550497/sql-server-give-a-login-permission-for-read-access-to-all-existing-and-future-d) that I can add the account in the model database however this appears to add the permissions for all new databases, when I only want it to apply to the databases mentioned above.

The best solution I could come up with is a SQL server job or external app that runs once a day or so and looks for the existence of each database, applying the permissions on each that it finds, but this does not seem ideal.",2
5188817,03/04/2011 01:51:55,643974,03/04/2011 01:51:55,1,0,How to capture stored procedure text when passing from Dephi 2006,"HI all,

I have a large (100+) parameter list for my SP in my delphi code.  This is for MS SQL Server 2005.  For debugging purposes, I want to capture the text of the stored procedure command, so i can execute it on the SQL server and debug the SP.  Is there a way i can capture what is exactly passed to the database? I thought about using a trace, and I'll try that tomorrow if this fails, but its cumbersome to set up and sift through and catch the SP.

Thanks
",sql,sql-server-2005,delphi,,,,open,0,93,11,"How to capture stored procedure text when passing from Dephi 2006 HI all,

I have a large (100+) parameter list for my SP in my delphi code.  This is for MS SQL Server 2005.  For debugging purposes, I want to capture the text of the stored procedure command, so i can execute it on the SQL server and debug the SP.  Is there a way i can capture what is exactly passed to the database? I thought about using a trace, and I'll try that tomorrow if this fails, but its cumbersome to set up and sift through and catch the SP.

Thanks
",3
8289353,11/27/2011 21:48:43,475337,10/14/2010 04:51:29,372,24,Tryinng to understand why would I make my result dataset in mssql into xml,"<pre>
Are these the reasons why would I set this result into xml?
1. So that I can give other technologies my data oracle?
2. People can use this output without committing to a technology (linq to sql, linq to entities)
3. What else?

Here a sample code for those who need sample codes
</pre>

    with 
    cte_OrderSummary
    AS
    (
     select OH.ord_id,OD.prod_id,ord_date,quantity_ordered, cust_zip_code 
     from oe.order_headers OH
     inner join oe.order_details OD
     ON OH.ord_id =OD.ord_id
     INNER JOIN oe.customers C
     ON C.cust_id =OH.cust_id
     
    ),
    cte_ProductDescription
    AS
    (
    	Select prod_id,prod_desc from prd.products P
        WHERE prod_id =2002
    	
    )
    SELECT 
    
    So.prod_id as ""@prod_id"" ,
    prod_desc as ""@prod_desc"",
    cust_zip_code,
    ord_date	,
    quantity_ordered	
    
    FROM cte_OrderSummary SO INNER JOIN cte_ProductDescription CP
    ON SO.prod_id = CP.prod_id
    FOR XML PATH('product'), Root('order_data');

<h1>which returns this xml</h1>
    <order_data>
      <product prod_id=""2002"" prod_desc=""Cave of Forgotten Dreams"">
        <cust_zip_code>94119</cust_zip_code>
        <ord_date>2010-08-04T00:00:00</ord_date>
        <quantity_ordered>1</quantity_ordered>
      </product>
      <product prod_id=""2002"" prod_desc=""Cave of Forgotten Dreams"">
        <cust_zip_code>25845</cust_zip_code>
        <ord_date>2010-09-10T00:00:00</ord_date>
        <quantity_ordered>1</quantity_ordered>
      </product>
    </order_data>",sql,xml,software-engineering,,,11/27/2011 23:31:24,not constructive,1,313,14,"Tryinng to understand why would I make my result dataset in mssql into xml <pre>
Are these the reasons why would I set this result into xml?
1. So that I can give other technologies my data oracle?
2. People can use this output without committing to a technology (linq to sql, linq to entities)
3. What else?

Here a sample code for those who need sample codes
</pre>

    with 
    cte_OrderSummary
    AS
    (
     select OH.ord_id,OD.prod_id,ord_date,quantity_ordered, cust_zip_code 
     from oe.order_headers OH
     inner join oe.order_details OD
     ON OH.ord_id =OD.ord_id
     INNER JOIN oe.customers C
     ON C.cust_id =OH.cust_id
     
    ),
    cte_ProductDescription
    AS
    (
    	Select prod_id,prod_desc from prd.products P
        WHERE prod_id =2002
    	
    )
    SELECT 
    
    So.prod_id as ""@prod_id"" ,
    prod_desc as ""@prod_desc"",
    cust_zip_code,
    ord_date	,
    quantity_ordered	
    
    FROM cte_OrderSummary SO INNER JOIN cte_ProductDescription CP
    ON SO.prod_id = CP.prod_id
    FOR XML PATH('product'), Root('order_data');

<h1>which returns this xml</h1>
    <order_data>
      <product prod_id=""2002"" prod_desc=""Cave of Forgotten Dreams"">
        <cust_zip_code>94119</cust_zip_code>
        <ord_date>2010-08-04T00:00:00</ord_date>
        <quantity_ordered>1</quantity_ordered>
      </product>
      <product prod_id=""2002"" prod_desc=""Cave of Forgotten Dreams"">
        <cust_zip_code>25845</cust_zip_code>
        <ord_date>2010-09-10T00:00:00</ord_date>
        <quantity_ordered>1</quantity_ordered>
      </product>
    </order_data>",3
10515622,05/09/2012 11:59:26,1384512,05/09/2012 11:56:46,1,0,Amazon RDS MS SQL,I have successfully connected to a new Amazon AWS RDS MS SQL - what I can't work out is how to change the security settings so that I can import a DACPAC - any clues would be appreciated.,sql,amazon-web-services,microsoft,,,05/10/2012 03:59:55,off topic,1,38,4,Amazon RDS MS SQL I have successfully connected to a new Amazon AWS RDS MS SQL - what I can't work out is how to change the security settings so that I can import a DACPAC - any clues would be appreciated.,3
2719747,04/27/2010 08:28:54,215912,11/21/2009 01:17:53,480,1,Need some tips on my SQL script?,"Hi I plan to create a tale to store the race result like this,

    Place    RaceNumber       Gender    Name             Result    
    12  	 0112  	           Male     Mike	        1:32:40 
    16  	 0117  	           Female   Rose            2:20:40 




I am not sure the `result` can be set to `varchar(32)` or other type?

and for `racenumber`, between `int(11)` and `varchar(11)`, which one is better?

Can IUNIQUE KEY 


`````` table?
 	

    DROP TABLE IF EXISTS `race_result`;
    CREATE TABLE IF NOT EXISTS `race_result` (
      `id` int(11) NOT NULL auto_increment,
      `racenumber` int(11) NOT NULL,
      `gender` enum('male','female') NOT NULL,
      `name` varchar(16) NOT NULL,
      `result` varchar(32) NOT NULL,
      PRIMARY KEY  (`id`),
      UNIQUE KEY `racenumber` (`racenumber`,`id`)
    ) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=utf8 AUTO_INCREMENT=3;",sql,table,mysql,,,,open,0,239,7,"Need some tips on my SQL script? Hi I plan to create a tale to store the race result like this,

    Place    RaceNumber       Gender    Name             Result    
    12  	 0112  	           Male     Mike	        1:32:40 
    16  	 0117  	           Female   Rose            2:20:40 




I am not sure the `result` can be set to `varchar(32)` or other type?

and for `racenumber`, between `int(11)` and `varchar(11)`, which one is better?

Can IUNIQUE KEY 


`````` table?
 	

    DROP TABLE IF EXISTS `race_result`;
    CREATE TABLE IF NOT EXISTS `race_result` (
      `id` int(11) NOT NULL auto_increment,
      `racenumber` int(11) NOT NULL,
      `gender` enum('male','female') NOT NULL,
      `name` varchar(16) NOT NULL,
      `result` varchar(32) NOT NULL,
      PRIMARY KEY  (`id`),
      UNIQUE KEY `racenumber` (`racenumber`,`id`)
    ) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=utf8 AUTO_INCREMENT=3;",3
9843364,03/23/2012 17:01:49,793468,06/10/2011 22:29:53,316,2,What is wrong with my SQL,"I am getting an ""Incorrect syntax near '+' error at the following line:

    Select * FROM  + @DATABASE_NAME + '.' + @SCHEMA_NAME + '.' + @TABLE_NAME;

Here is my SQL:

    Declare @TABLE_NAME varchar(10)
    Declare @SCHEMA_NAME varchar(10)
    Declare @DATABASE_NAME varchar(10)
    
    Set @TABLE_NAME = 'Freshmen';
    Set @SCHEMA_NAME = 'stu';
    Set @DATABASE_NAME = 'Student';
    
    Select * FROM  + @DATABASE_NAME + '.' + @SCHEMA_NAME + '.' + @TABLE_NAME;

Am I missing something here?",sql,sql-server-2008,,,,03/23/2012 22:23:00,too localized,1,101,6,"What is wrong with my SQL I am getting an ""Incorrect syntax near '+' error at the following line:

    Select * FROM  + @DATABASE_NAME + '.' + @SCHEMA_NAME + '.' + @TABLE_NAME;

Here is my SQL:

    Declare @TABLE_NAME varchar(10)
    Declare @SCHEMA_NAME varchar(10)
    Declare @DATABASE_NAME varchar(10)
    
    Set @TABLE_NAME = 'Freshmen';
    Set @SCHEMA_NAME = 'stu';
    Set @DATABASE_NAME = 'Student';
    
    Select * FROM  + @DATABASE_NAME + '.' + @SCHEMA_NAME + '.' + @TABLE_NAME;

Am I missing something here?",2
3605096,08/30/2010 23:56:15,384080,07/06/2010 00:37:49,98,2,installing second instance of reporting service,getting confused here. I'm trying to install a second instance of reporting service sql server 2008 r2. Now does it mean I need to install a second instance of sql server or can i use the existing sql server instance to create anothe reportserver database? ,sql,reporting-services,server,,,,open,0,46,6,installing second instance of reporting service getting confused here. I'm trying to install a second instance of reporting service sql server 2008 r2. Now does it mean I need to install a second instance of sql server or can i use the existing sql server instance to create anothe reportserver database? ,3
11356976,07/06/2012 06:30:41,1505869,07/06/2012 06:00:37,1,0,Need a sql query to display the data in this format. Any help appreciated,"Area      | TotalWorkstations | AvailableWorkstations |WorkstationsBooked|Projectname
-------------------------------------------------------------------------------
1st floor | 100               | 95                    | 1                 | A
 -        | -                 | -                     | 2                 | B
 -        | -                 | -                     | 3                 | C
 -        | -                 | -                     | 4                 | D
 -        | -                 | -                     | 5                 | E
--------------------------------------------------------------------------------
Total     | 100               | 95                    | 5                 | -",sql,,,,,07/06/2012 07:28:45,not a real question,1,402,14,"Need a sql query to display the data in this format. Any help appreciated Area      | TotalWorkstations | AvailableWorkstations |WorkstationsBooked|Projectname
-------------------------------------------------------------------------------
1st floor | 100               | 95                    | 1                 | A
 -        | -                 | -                     | 2                 | B
 -        | -                 | -                     | 3                 | C
 -        | -                 | -                     | 4                 | D
 -        | -                 | -                     | 5                 | E
--------------------------------------------------------------------------------
Total     | 100               | 95                    | 5                 | -",1
9759248,03/18/2012 14:46:37,378159,06/28/2010 15:25:49,115,5,"Doing just one query search, saving it to an array and then search only the array instead of doing multiple sql queries","i have this

    class PagesController < ApplicationController
	def index
		@textos = Texto.all
		@texto_historia			= Texto.where(:title => ""Histria"").first.contents
		@texto_capas_para_sofa	= Texto.where(:title => ""Capas para Sof"").first.contents
		@texto_cortinas			= Texto.where(:title => ""Cortinas"").first.contents
		@texto_almofadas		= Texto.where(:title => ""Almofadas"").first.contents
	end

The SQL output is:

<pre>
  [1m[36mTexto Load (2.0ms)[0m  [1mSELECT ""textos"".* FROM ""textos""[0m
  [1m[35mTexto Load (1.0ms)[0m  SELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Histria') LIMIT 1
  [1m[36mTexto Load (0.0ms)[0m  [1mSELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Capas para Sof') LIMIT 1[0m
  [1m[35mTexto Load (1.0ms)[0m  SELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Cortinas') LIMIT 1
  [1m[36mTexto Load (1.0ms)[0m  [1mSELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Almofadas') LIMIT 1[0m
  [1m[35mTexto Load (0.0ms)[0m  SELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Informaes de Contato') LIMIT 1
</pre>

What i want is to do just one query for all ""textos"" model and then search inside an array or anything like that to get the specific variable.",sql,ruby-on-rails,,,,,open,0,145,22,"Doing just one query search, saving it to an array and then search only the array instead of doing multiple sql queries i have this

    class PagesController < ApplicationController
	def index
		@textos = Texto.all
		@texto_historia			= Texto.where(:title => ""Histria"").first.contents
		@texto_capas_para_sofa	= Texto.where(:title => ""Capas para Sof"").first.contents
		@texto_cortinas			= Texto.where(:title => ""Cortinas"").first.contents
		@texto_almofadas		= Texto.where(:title => ""Almofadas"").first.contents
	end

The SQL output is:

<pre>
  [1m[36mTexto Load (2.0ms)[0m  [1mSELECT ""textos"".* FROM ""textos""[0m
  [1m[35mTexto Load (1.0ms)[0m  SELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Histria') LIMIT 1
  [1m[36mTexto Load (0.0ms)[0m  [1mSELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Capas para Sof') LIMIT 1[0m
  [1m[35mTexto Load (1.0ms)[0m  SELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Cortinas') LIMIT 1
  [1m[36mTexto Load (1.0ms)[0m  [1mSELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Almofadas') LIMIT 1[0m
  [1m[35mTexto Load (0.0ms)[0m  SELECT ""textos"".* FROM ""textos"" WHERE (""textos"".""title"" = 'Informaes de Contato') LIMIT 1
</pre>

What i want is to do just one query for all ""textos"" model and then search inside an array or anything like that to get the specific variable.",2
1139719,07/16/2009 19:15:52,130680,06/29/2009 20:52:04,11,1,SQL Server Query for Rank (RowNumber) and Groupings,"I have a table that has some columns: User, Category, Value

And I want to make a query that will give me a ranking, of all the users by the value, but reset for the category.

Example:

user1   CategoryA 10
user2   CategoryA 11
user3   CategoryA 9
user4   CategoryB 3
user1   CategoryB 11

the query would return:

Rank  User   Category  
1     user2   CategoryA
2     user1   CategoryA
3     user3   CategoryA
1     user1   CategoryB
2     user4   CategoryB

Any ideas? 

I write the query and specify the Category, It works but then I have to write loops and its very slow.

Thanks in advance.",sql,server,rank,group,,,open,0,129,8,"SQL Server Query for Rank (RowNumber) and Groupings I have a table that has some columns: User, Category, Value

And I want to make a query that will give me a ranking, of all the users by the value, but reset for the category.

Example:

user1   CategoryA 10
user2   CategoryA 11
user3   CategoryA 9
user4   CategoryB 3
user1   CategoryB 11

the query would return:

Rank  User   Category  
1     user2   CategoryA
2     user1   CategoryA
3     user3   CategoryA
1     user1   CategoryB
2     user4   CategoryB

Any ideas? 

I write the query and specify the Category, It works but then I have to write loops and its very slow.

Thanks in advance.",4
2048592,01/12/2010 11:42:23,246935,01/09/2010 06:20:45,14,0,What is the most interesting SQL Question(TSQL Program included) that you encountered?,"Actually I am a newbie in SQL SERVER(only 2 months as of now) and want to learn more and master over it in the upcoming days.

So I have asked this question.

I believe it will help peoples like me a lot to grow if we follow those that the experienced peoples here have faced or seen so far in their career.

Also it will help us in our job or interview

Thanks",sql,sql-server,tsql,,,01/12/2010 13:21:03,not constructive,1,69,12,"What is the most interesting SQL Question(TSQL Program included) that you encountered? Actually I am a newbie in SQL SERVER(only 2 months as of now) and want to learn more and master over it in the upcoming days.

So I have asked this question.

I believe it will help peoples like me a lot to grow if we follow those that the experienced peoples here have faced or seen so far in their career.

Also it will help us in our job or interview

Thanks",3
7937799,10/29/2011 08:33:09,387423,07/09/2010 06:02:37,92,2,How to fill column values length same in SQL Server 2008?,"Excel Sheet data

    Eno  EName  Pincode
    1     aaa    123456
    2     bbb    123423
    3     ccc    34
    4     ddd     567
    5     eee     4532

Table Structure

      Eno  Varchar(10)
      EName  vachar(25)
      Pincode  Nvarchar(6)


I fetch data from excel sheet on the time pincode have 3 or 2 or 6 or 4, I have to check that If pincode column values is less than 6 i have concat 0.

     Eg: Pincode 34 it have only 2 digit so i add 4 zero in front 000034.
 
Result

EmpInfo

  

     Eno  EName   PinCode
        1    aaa      123456
        2     bbb     123423 
        3     ccc     000034
        4     ddd     000567
        5      eee    004532

   


",sql,sql-server,,,,,open,0,264,11,"How to fill column values length same in SQL Server 2008? Excel Sheet data

    Eno  EName  Pincode
    1     aaa    123456
    2     bbb    123423
    3     ccc    34
    4     ddd     567
    5     eee     4532

Table Structure

      Eno  Varchar(10)
      EName  vachar(25)
      Pincode  Nvarchar(6)


I fetch data from excel sheet on the time pincode have 3 or 2 or 6 or 4, I have to check that If pincode column values is less than 6 i have concat 0.

     Eg: Pincode 34 it have only 2 digit so i add 4 zero in front 000034.
 
Result

EmpInfo

  

     Eno  EName   PinCode
        1    aaa      123456
        2     bbb     123423 
        3     ccc     000034
        4     ddd     000567
        5      eee    004532

   


",2
11421856,07/10/2012 20:59:55,1515992,07/10/2012 20:48:57,1,0,"MySQL CPU is way to high, just increases","Right now I have 4 2.13 Ghz CPU's

This morning my CPU usage was normal, around 0.6 of 4.
Right now my CPU keeps skyrocketing to around 20 of 4 to 40 of 4.

The amount of users/ tasks that MYSQL is running has stayed the same the entire time, and now my site keeps getting 'Max Connections' errors.

At first i thought it might be that the mysql connections were not closing, but I inserted mysql_close(); code into each page that uses any connection.

Any tips on what might be happening?

Thanks a lot in advance.",sql,cpu,,,,07/10/2012 22:58:55,not a real question,1,91,8,"MySQL CPU is way to high, just increases Right now I have 4 2.13 Ghz CPU's

This morning my CPU usage was normal, around 0.6 of 4.
Right now my CPU keeps skyrocketing to around 20 of 4 to 40 of 4.

The amount of users/ tasks that MYSQL is running has stayed the same the entire time, and now my site keeps getting 'Max Connections' errors.

At first i thought it might be that the mysql connections were not closing, but I inserted mysql_close(); code into each page that uses any connection.

Any tips on what might be happening?

Thanks a lot in advance.",2
6699843,07/14/2011 20:58:22,156611,08/14/2009 16:32:33,255,6,SQL combine two selects into one,"The blog part of our site is wordpress.  What i would like to do to the home page of the main site is to take the most recent blog post excerpt and place it on the main site with a link to the article on the blog site.  I'm trying to get the SQL statement to work properly  and i think i have the main pieces, but want to put it into a single SELECT instead of two SELECTs.

The reason i have two SELECTs is to make sure i get the latest revision of the post.  First i try the revision SELECT to see if i get a row returned - if I do, i'm done.  If there is no row (no revisions on the post), use the second SELECT statement.


	SELECT TOP 1 * FROM wp_posts
	WHERE post_type = 'revision'
		AND post_parent IN (SELECT [object_id]
					FROM wp_term_relationships
					WHERE term_taxonomy_id = 3)
	ORDER BY post_modified DESC

	SELECT TOP 1 * FROM wp_posts
	WHERE id IN (SELECT [object_id]
				FROM wp_term_relationships
				WHERE term_taxonomy_id = 3)
	ORDER BY post_modified DESC


How can I combine these two SELECTs into a single SELECT so I can be assured of always getting a row back (i.e. the most recent blog post)

Thanks in advance.",sql,select,,,,,open,0,200,6,"SQL combine two selects into one The blog part of our site is wordpress.  What i would like to do to the home page of the main site is to take the most recent blog post excerpt and place it on the main site with a link to the article on the blog site.  I'm trying to get the SQL statement to work properly  and i think i have the main pieces, but want to put it into a single SELECT instead of two SELECTs.

The reason i have two SELECTs is to make sure i get the latest revision of the post.  First i try the revision SELECT to see if i get a row returned - if I do, i'm done.  If there is no row (no revisions on the post), use the second SELECT statement.


	SELECT TOP 1 * FROM wp_posts
	WHERE post_type = 'revision'
		AND post_parent IN (SELECT [object_id]
					FROM wp_term_relationships
					WHERE term_taxonomy_id = 3)
	ORDER BY post_modified DESC

	SELECT TOP 1 * FROM wp_posts
	WHERE id IN (SELECT [object_id]
				FROM wp_term_relationships
				WHERE term_taxonomy_id = 3)
	ORDER BY post_modified DESC


How can I combine these two SELECTs into a single SELECT so I can be assured of always getting a row back (i.e. the most recent blog post)

Thanks in advance.",2
9826913,03/22/2012 16:54:09,1004278,10/20/2011 00:53:10,580,6,How to write a FOR EACH loop in PL/SQL?,"Is it possible to run a for each loop on a PL/SQL array?
",sql,plsql,,,,,open,0,13,9,"How to write a FOR EACH loop in PL/SQL? Is it possible to run a for each loop on a PL/SQL array?
",2
7223223,08/28/2011 19:07:52,707111,04/08/2011 20:01:10,7201,397,SQLCE Query having no effect?,"I'm attempting to insert rows into an SQLCE database, and it's returning that 1 row is affected, there's no exception, and no syntax error in the query as far as I can see - but it's having no effect, when I look in the table from the Database Explorer.

If I run a query through VS, everything works fine. There's no connection problem as far as I can tell... what am I doing wrong here?

Here's the code, though it probably doesn't make a difference:

<!-- language: lang-vb -->

        Using conn As New SqlCeConnection(My.Settings.DietSafetyCheckerReportsConnectionString)
            conn.Open()

            Using cmd As SqlCeCommand = conn.CreateCommand()
                cmd.CommandText = ""INSERT INTO Reports(PatientID, PreparedBy, PreparedFor, WeightInKilos, HeightInMeters, Age, PercentBodyFat, ElbowMeasurementInCentimeters, ReportDate, Gender) "" &
                                  ""VALUES(@pid, @pby, @pfor, @weight, @height, @age, @bodyfat, @elbow, @rdate, @gender);""

                cmd.Parameters.Add(""@pid"", SqlDbType.NVarChar, 100).Value = Me.PatientID
                cmd.Parameters.Add(""@pby"", SqlDbType.NVarChar, 100).Value = Me.PreparedBy
                cmd.Parameters.Add(""@pfor"", SqlDbType.NVarChar, 100).Value = Me.PreparedFor
                cmd.Parameters.Add(""@weight"", SqlDbType.Float).Value = Me.WeightInKilos
                cmd.Parameters.Add(""@height"", SqlDbType.Float).Value = Me.HeightInMeters
                cmd.Parameters.Add(""@age"", SqlDbType.TinyInt).Value = Me.Age
                cmd.Parameters.Add(""@bodyfat"", SqlDbType.Float, 100).Value = Me.PercentBodyFat
                cmd.Parameters.Add(""@elbow"", SqlDbType.TinyInt, 100).Value = Me.ElbowMeasurementInCentimeters
                cmd.Parameters.Add(""@rdate"", SqlDbType.DateTime).Value = Me.ReportDate
                cmd.Parameters.Add(""@gender"", SqlDbType.TinyInt, 100).Value = Me.Gender

                If cmd.ExecuteNonQuery() <> 1 Then Throw New ApplicationException(""Failed to insert row into databse."")
            End Using

            conn.Close()
        End Using",sql,vb.net,sql-server-ce,,,,open,0,459,5,"SQLCE Query having no effect? I'm attempting to insert rows into an SQLCE database, and it's returning that 1 row is affected, there's no exception, and no syntax error in the query as far as I can see - but it's having no effect, when I look in the table from the Database Explorer.

If I run a query through VS, everything works fine. There's no connection problem as far as I can tell... what am I doing wrong here?

Here's the code, though it probably doesn't make a difference:

<!-- language: lang-vb -->

        Using conn As New SqlCeConnection(My.Settings.DietSafetyCheckerReportsConnectionString)
            conn.Open()

            Using cmd As SqlCeCommand = conn.CreateCommand()
                cmd.CommandText = ""INSERT INTO Reports(PatientID, PreparedBy, PreparedFor, WeightInKilos, HeightInMeters, Age, PercentBodyFat, ElbowMeasurementInCentimeters, ReportDate, Gender) "" &
                                  ""VALUES(@pid, @pby, @pfor, @weight, @height, @age, @bodyfat, @elbow, @rdate, @gender);""

                cmd.Parameters.Add(""@pid"", SqlDbType.NVarChar, 100).Value = Me.PatientID
                cmd.Parameters.Add(""@pby"", SqlDbType.NVarChar, 100).Value = Me.PreparedBy
                cmd.Parameters.Add(""@pfor"", SqlDbType.NVarChar, 100).Value = Me.PreparedFor
                cmd.Parameters.Add(""@weight"", SqlDbType.Float).Value = Me.WeightInKilos
                cmd.Parameters.Add(""@height"", SqlDbType.Float).Value = Me.HeightInMeters
                cmd.Parameters.Add(""@age"", SqlDbType.TinyInt).Value = Me.Age
                cmd.Parameters.Add(""@bodyfat"", SqlDbType.Float, 100).Value = Me.PercentBodyFat
                cmd.Parameters.Add(""@elbow"", SqlDbType.TinyInt, 100).Value = Me.ElbowMeasurementInCentimeters
                cmd.Parameters.Add(""@rdate"", SqlDbType.DateTime).Value = Me.ReportDate
                cmd.Parameters.Add(""@gender"", SqlDbType.TinyInt, 100).Value = Me.Gender

                If cmd.ExecuteNonQuery() <> 1 Then Throw New ApplicationException(""Failed to insert row into databse."")
            End Using

            conn.Close()
        End Using",3
6763729,07/20/2011 14:43:26,823893,06/30/2011 21:45:26,1,0,How to split a string ...,"How do I convert the following c# to ms sql?
Thanks for your help!

            #region determine if Dimension has length & width
            decimal _dimension = 0;
            string[] xy = new string[1];
            Dimension = Dimension.ToUpper();
            if (Dimension.Contains('X'))
            {
                xy = Dimension.Split('X');
                _dimension = (Convert.ToInt32(xy[0]) * Convert.ToInt32(xy[1]) / 144);
            }
            else
            {
                _dimension = Convert.ToDecimal(Dimension);
            }
         #endregion


DECLARE @_dimension numeric
select @_dimension = Dimension

how to upcase string?

how to split string at 'X'?",sql,ms,,,,07/21/2011 00:51:01,not a real question,1,230,6,"How to split a string ... How do I convert the following c# to ms sql?
Thanks for your help!

            #region determine if Dimension has length & width
            decimal _dimension = 0;
            string[] xy = new string[1];
            Dimension = Dimension.ToUpper();
            if (Dimension.Contains('X'))
            {
                xy = Dimension.Split('X');
                _dimension = (Convert.ToInt32(xy[0]) * Convert.ToInt32(xy[1]) / 144);
            }
            else
            {
                _dimension = Convert.ToDecimal(Dimension);
            }
         #endregion


DECLARE @_dimension numeric
select @_dimension = Dimension

how to upcase string?

how to split string at 'X'?",2
4956302,02/10/2011 11:08:44,183680,10/03/2009 17:43:45,76,7,SQL Reconcillation Query,"Need assistance with SQL Query which can reconcile multiple entries (Buy/Sell) from one table to single line entries, tracking the amount bought and sold in Qty and Qty Left Columns:

I have a table as follows:

    CREATE TABLE [dbo].[Trades(
    [Id] [bigint] IDENTITY(1,1) NOT NULL,
    [ExecId] [varchar](35) NULL,
    [Side] [varchar](6) NULL,
    [Symbol] [varchar](35) NULL,
    [LastQty] [varchar](35) NULL,
    [LastPrice] [varchar](25) NULL,
    [LeftQty] [varchar](35) NULL,
    [Date] [varchar](35) NULL
    )

with Entries:

     Id    Side	Symbol	Qty	LastPrice  LeftQty   Date
     1     Buy	  ABC	100	10.00	    0	    1/1/2011
     2     Sell	  ABC	100	12.00	    0	    1/1/2011
     3     Sell	  XYZ	200	8.00	    0	    1/1/2011
     4     Buy	  XYZ	100	7.00	    100	    1/1/2011

How can I query table to produce a reconcillation report from the previous data as follows:

     Id  Side  Symbol  EntQty  EntPrice EntQty EntLeft ExtSide ExtQty ExtPrice	ExtLeft
      1  Buy    ABC	100     10.00   100     0       Sell    100     12.00      0
      2  Sell   XYZ	200     8.00    200     0       Buy     100      7.00    100

I need to combine opposite buy/sell entries onto the same line and then track the amount (Qty) remaining if the Buy Qty does not equal the Sell Qty
",sql,query,,,,,open,0,344,3,"SQL Reconcillation Query Need assistance with SQL Query which can reconcile multiple entries (Buy/Sell) from one table to single line entries, tracking the amount bought and sold in Qty and Qty Left Columns:

I have a table as follows:

    CREATE TABLE [dbo].[Trades(
    [Id] [bigint] IDENTITY(1,1) NOT NULL,
    [ExecId] [varchar](35) NULL,
    [Side] [varchar](6) NULL,
    [Symbol] [varchar](35) NULL,
    [LastQty] [varchar](35) NULL,
    [LastPrice] [varchar](25) NULL,
    [LeftQty] [varchar](35) NULL,
    [Date] [varchar](35) NULL
    )

with Entries:

     Id    Side	Symbol	Qty	LastPrice  LeftQty   Date
     1     Buy	  ABC	100	10.00	    0	    1/1/2011
     2     Sell	  ABC	100	12.00	    0	    1/1/2011
     3     Sell	  XYZ	200	8.00	    0	    1/1/2011
     4     Buy	  XYZ	100	7.00	    100	    1/1/2011

How can I query table to produce a reconcillation report from the previous data as follows:

     Id  Side  Symbol  EntQty  EntPrice EntQty EntLeft ExtSide ExtQty ExtPrice	ExtLeft
      1  Buy    ABC	100     10.00   100     0       Sell    100     12.00      0
      2  Sell   XYZ	200     8.00    200     0       Buy     100      7.00    100

I need to combine opposite buy/sell entries onto the same line and then track the amount (Qty) remaining if the Buy Qty does not equal the Sell Qty
",2
3056596,06/16/2010 19:40:10,134348,07/07/2009 15:51:06,56,4,How to get Sql Server XML variable into TEXT column,"I need to update an XML document stored in a Microsoft SQL Server database, however the vendor of the product chose to store the XML in a TEXT column.

I've been able to extract the TEXT into an XML-type variable and perform the update I need on the xml within this variable, but when I try to UPDATE the column to push the change back to the database, I run into trouble.

Looking through the documentation it appears that it's not possible to simply CAST/CONVERT an XML type variable to insert it into a TEXT column, but I would think there is some way to extract the xml ""string"" from the XML-type variable and UPDATE the column using this value.

Any suggestions are appreciated, but I would like to keep the solution pure SQL that it can be run directly (no C# custom function, etc.); just to keep the impact on the database minimal.




(note: isn't it a bit absurd that you can't just CAST XML as TEXT?  I'm just saying...)",sql,sql-server,xml,,,,open,0,168,10,"How to get Sql Server XML variable into TEXT column I need to update an XML document stored in a Microsoft SQL Server database, however the vendor of the product chose to store the XML in a TEXT column.

I've been able to extract the TEXT into an XML-type variable and perform the update I need on the xml within this variable, but when I try to UPDATE the column to push the change back to the database, I run into trouble.

Looking through the documentation it appears that it's not possible to simply CAST/CONVERT an XML type variable to insert it into a TEXT column, but I would think there is some way to extract the xml ""string"" from the XML-type variable and UPDATE the column using this value.

Any suggestions are appreciated, but I would like to keep the solution pure SQL that it can be run directly (no C# custom function, etc.); just to keep the impact on the database minimal.




(note: isn't it a bit absurd that you can't just CAST XML as TEXT?  I'm just saying...)",3
10622856,05/16/2012 16:35:28,1399137,05/16/2012 16:25:23,1,0,Oracle Grouping,"I want to be able to do is sum up the time for each episode of time the ID is with one group.  In the table below I manually added the GRP_Time column. 
This is the metric I'm trying to generate systematically Any help will be appreciated

Thanks,

ID    Asgn_ID    GRP      Time            GRP_Time   
11    1788       NC       6  
           
11    1802       NC       1               7

11    2995       C        7               7

11    5496       NC       11              11

11    6077       C        2 

11    6216       C        2

11    6226       C        4               8  

11    6790       NC       5               5",sql,oracle,,,,,open,0,315,2,"Oracle Grouping I want to be able to do is sum up the time for each episode of time the ID is with one group.  In the table below I manually added the GRP_Time column. 
This is the metric I'm trying to generate systematically Any help will be appreciated

Thanks,

ID    Asgn_ID    GRP      Time            GRP_Time   
11    1788       NC       6  
           
11    1802       NC       1               7

11    2995       C        7               7

11    5496       NC       11              11

11    6077       C        2 

11    6216       C        2

11    6226       C        4               8  

11    6790       NC       5               5",2
7239755,08/30/2011 07:08:04,344027,05/18/2010 12:56:02,101,6,Is there any problem if I use rowid to delete duplicate rows from an oracle database?,"I'm using the following query to delete duplicate rows from a table. There are only 2 columns in the table(col1 and col2).

    delete from tab1 where rowid not in
    (select min(rowid) from tab1 t group by col1, col2);
Is there any problem, like some side effects, if I use this query to delete duplicate rows?",sql,oracle,delete,,,,open,0,60,16,"Is there any problem if I use rowid to delete duplicate rows from an oracle database? I'm using the following query to delete duplicate rows from a table. There are only 2 columns in the table(col1 and col2).

    delete from tab1 where rowid not in
    (select min(rowid) from tab1 t group by col1, col2);
Is there any problem, like some side effects, if I use this query to delete duplicate rows?",3
8351060,12/02/2011 02:27:01,624859,09/03/2010 16:50:53,22,0,Difference of records from same table,"I have table from which I am fetching records for two time interval as written below. 

    Query1:

    select distinct(Id) 
    from dbo.tableA 
    where datediff(hour, dtCreate, getdate()) < 24

    Query2:
    select distinct(Id) 
    from dbo.tableA 
    where datediff(hour, dtCreate, getdate()) < 48
	and datediff(hour, dtCreate, getdate()) > 24


The query1 returns 50 records and query2  returns 45 records.
After this I want to find those records which which are not present in query2 but present in query1. Can anybody suggest me how to do this?? Thanks in advance. ",sql,sql-server,join,,,,open,0,112,6,"Difference of records from same table I have table from which I am fetching records for two time interval as written below. 

    Query1:

    select distinct(Id) 
    from dbo.tableA 
    where datediff(hour, dtCreate, getdate()) < 24

    Query2:
    select distinct(Id) 
    from dbo.tableA 
    where datediff(hour, dtCreate, getdate()) < 48
	and datediff(hour, dtCreate, getdate()) > 24


The query1 returns 50 records and query2  returns 45 records.
After this I want to find those records which which are not present in query2 but present in query1. Can anybody suggest me how to do this?? Thanks in advance. ",3
2521014,03/26/2010 03:39:41,93468,02/03/2009 22:24:01,1701,35,Combine 2 apps into one DB?,"I'm debating whether to use the same DB for both my blog and my wiki.  Since both are open source, and both install the required tables which is a very small number of tables for both apps, I'm thinking about just using one database to represent both sets of tables.

Is this common and safe to do?  I am hesitant because I always create a new DB for every application I create or use.  But in this case, I don't want to spend another $10 a month from my shared hosting just to get another SQL 2008 DB to host a wiki..it's small and I'm the only one using the wiki.  I just want to point the wiki to my existing blog DB that's already running and have the wiki wizard auto gen the tables to that DB and just hold both sets of tables there.",sql,sql-server-2008,,,,,open,0,149,6,"Combine 2 apps into one DB? I'm debating whether to use the same DB for both my blog and my wiki.  Since both are open source, and both install the required tables which is a very small number of tables for both apps, I'm thinking about just using one database to represent both sets of tables.

Is this common and safe to do?  I am hesitant because I always create a new DB for every application I create or use.  But in this case, I don't want to spend another $10 a month from my shared hosting just to get another SQL 2008 DB to host a wiki..it's small and I'm the only one using the wiki.  I just want to point the wiki to my existing blog DB that's already running and have the wiki wizard auto gen the tables to that DB and just hold both sets of tables there.",2
11382125,07/08/2012 09:38:16,181421,09/29/2009 21:11:35,572,4,SSIS. Stop running after 10pm,"I have an SSIS package with a for loop.
I would like to keep the value ""10pm"" in my sql database, and I want the loop the check every time if it's after this value of ""10pm"" (or whatever i decide to put in the database). If the time now is after 10pm, then stop looping.

Thanks.
 ",sql,sql-server,ssis,,,07/09/2012 17:50:06,not a real question,1,56,5,"SSIS. Stop running after 10pm I have an SSIS package with a for loop.
I would like to keep the value ""10pm"" in my sql database, and I want the loop the check every time if it's after this value of ""10pm"" (or whatever i decide to put in the database). If the time now is after 10pm, then stop looping.

Thanks.
 ",3
8367970,12/03/2011 13:29:54,155196,08/12/2009 16:08:13,1678,39,Database Tables for Reservation site,"We are building an Reservation booking system. There are three modules

 1. Customers
 2. Rooms
 3. Bookings

A customer can book one or many rooms and for varying dates. While booking a room(s) i want to search for which rooms are available to be booked between date A and date B.


**Tables ( likely solution)**
customers(id, name, .....)
rooms(id, roomNo, roomType, ....)
bookings(id, room_id, fromDate, toDate)

Presently i have the tables like this

    CREATE TABLE IF NOT EXISTS `bookings` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `checkin` datetime NOT NULL,
      `checkout` datetime NOT NULL,
      `advance` int(11) NOT NULL,
      `amount` int(11) NOT NULL,
      `booking_details_id` int(11) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
    
    
    CREATE TABLE IF NOT EXISTS `bookings_rooms` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `booking_id` int(11) NOT NULL,
      `room_id` int(11) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;
    
    
    CREATE TABLE IF NOT EXISTS `customers` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `name` varchar(255) NOT NULL,
      `age` int(11) NOT NULL,
      `address` varchar(255) NOT NULL,
      `nationality_id` int(11) NOT NULL,
      `mobile` int(20) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
    
    CREATE TABLE IF NOT EXISTS `rooms` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `number` int(4) NOT NULL,
      `category_id` int(11) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;



Need help to design the database and which is a better approach.",sql,database-design,schema,database-schema,,12/04/2011 15:33:36,not constructive,1,374,5,"Database Tables for Reservation site We are building an Reservation booking system. There are three modules

 1. Customers
 2. Rooms
 3. Bookings

A customer can book one or many rooms and for varying dates. While booking a room(s) i want to search for which rooms are available to be booked between date A and date B.


**Tables ( likely solution)**
customers(id, name, .....)
rooms(id, roomNo, roomType, ....)
bookings(id, room_id, fromDate, toDate)

Presently i have the tables like this

    CREATE TABLE IF NOT EXISTS `bookings` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `checkin` datetime NOT NULL,
      `checkout` datetime NOT NULL,
      `advance` int(11) NOT NULL,
      `amount` int(11) NOT NULL,
      `booking_details_id` int(11) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
    
    
    CREATE TABLE IF NOT EXISTS `bookings_rooms` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `booking_id` int(11) NOT NULL,
      `room_id` int(11) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;
    
    
    CREATE TABLE IF NOT EXISTS `customers` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `name` varchar(255) NOT NULL,
      `age` int(11) NOT NULL,
      `address` varchar(255) NOT NULL,
      `nationality_id` int(11) NOT NULL,
      `mobile` int(20) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
    
    CREATE TABLE IF NOT EXISTS `rooms` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `number` int(4) NOT NULL,
      `category_id` int(11) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=3 ;



Need help to design the database and which is a better approach.",4
4683404,01/13/2011 17:57:31,472647,10/11/2010 20:02:08,3,0,Updating Datatable to EXISTING global database connection,"I am using Microsoft Visual Basic 2010 Express. I have a WPF-based project. I have a successful connection to a database in Database Explorer, and a working existing Data Source in Data Sources.

I created a datatable from the datasource using this code:

    Dim roster_table As New DataTable(""AGENT_ROSTER"")

I can manipulate this datatable just fine, but I cannot figure out how to save its data to my database (agentroster.sdf) since the connection is on a global level, and isn't declared in this particular window.

**How do I update this database from the datatable on this window?**

By the way, I tried creating a connection on this window's code, using the exact same connection string as the successful globally-connected database, yet it said that it couldn't connect.",sql,wpf,vb.net,ado.net,,,open,0,125,7,"Updating Datatable to EXISTING global database connection I am using Microsoft Visual Basic 2010 Express. I have a WPF-based project. I have a successful connection to a database in Database Explorer, and a working existing Data Source in Data Sources.

I created a datatable from the datasource using this code:

    Dim roster_table As New DataTable(""AGENT_ROSTER"")

I can manipulate this datatable just fine, but I cannot figure out how to save its data to my database (agentroster.sdf) since the connection is on a global level, and isn't declared in this particular window.

**How do I update this database from the datatable on this window?**

By the way, I tried creating a connection on this window's code, using the exact same connection string as the successful globally-connected database, yet it said that it couldn't connect.",4
8300406,11/28/2011 18:20:29,193830,10/21/2009 13:52:20,884,46,Restoring Microsoft SQL Databases - Tips and Tricks?,"Anyone have any tips and tricks when it comes to restoring MS SQL databases?

I recently restored a .bak from one server/instance to another, using 2005 on both, and have run into the following issues (so far):

1 - All of the identity insert values were reset to their original values (1 in my case).  A pain in the butt until I found the following command to go through all tables, and reseed to the current value + 1: 

    exec sp_MSforeachtable @command1 = 'DBCC CHECKIDENT (''?'', RESEED)'

2 - Permissions were gone.  The database level accounts came over of course (with their role assignments), but most of the DB permissions for each Role were gone...meaning read,insert,delete,execute etc permissions were missing on each table,view, and stored procedure.  I wrote some scripts like the below to rectify, but still a pain in the ass.

     select 'GRANT SELECT ON ' + TABLE_NAME + ' TO rolename' 
     from Information_schema.tables
     where left(table_name,2) <> 'MS' 

3 - Instance level permissions obviously aren't present if restoring to a new instance...but that was kind of a pain since it seems you can't recreate an instance level account if the account already exists at the database level.  What's the best approach here? In my case I deleted the database account, the created the instance, then granted permissions using scripts like the above.


Generally I'm just curious about some best practices, when it comes to restoring MS SQL databases...and/or tips on somehow avoiding the issues I encountered. I'm just trying to pave the way for the most error free restores I can.",sql,sql-server,sql-server-2005,,,11/28/2011 18:45:24,not constructive,1,279,8,"Restoring Microsoft SQL Databases - Tips and Tricks? Anyone have any tips and tricks when it comes to restoring MS SQL databases?

I recently restored a .bak from one server/instance to another, using 2005 on both, and have run into the following issues (so far):

1 - All of the identity insert values were reset to their original values (1 in my case).  A pain in the butt until I found the following command to go through all tables, and reseed to the current value + 1: 

    exec sp_MSforeachtable @command1 = 'DBCC CHECKIDENT (''?'', RESEED)'

2 - Permissions were gone.  The database level accounts came over of course (with their role assignments), but most of the DB permissions for each Role were gone...meaning read,insert,delete,execute etc permissions were missing on each table,view, and stored procedure.  I wrote some scripts like the below to rectify, but still a pain in the ass.

     select 'GRANT SELECT ON ' + TABLE_NAME + ' TO rolename' 
     from Information_schema.tables
     where left(table_name,2) <> 'MS' 

3 - Instance level permissions obviously aren't present if restoring to a new instance...but that was kind of a pain since it seems you can't recreate an instance level account if the account already exists at the database level.  What's the best approach here? In my case I deleted the database account, the created the instance, then granted permissions using scripts like the above.


Generally I'm just curious about some best practices, when it comes to restoring MS SQL databases...and/or tips on somehow avoiding the issues I encountered. I'm just trying to pave the way for the most error free restores I can.",3
1784254,11/23/2009 16:25:17,176627,09/21/2009 15:23:47,29,3,SQL Select Distinct with Conditional,"Table1 has columns (id, a, b, c, group).  There are several rows that have the same group, but id is always unique.  I would like to SELECT group,a,b FROM Table1 WHERE the group is distinct.  However, I would like the returned data to be from the row with the greatest id for that group.

Thus, if we have the rows

(id=10, a=6, b=40, c=3, group=14)
(id=5, a=21, b=45, c=31, group=230)
(id=4, a=42, b=65, c=2, group=230)

I would like to return these 2 rows:

[group=14, a=6,b=40] and 
[group=230, a=21,b=45] (because id=5 > id=4)

Is there a simple SELECT statement to do this?",sql,mysql,jquery,,,,open,0,97,5,"SQL Select Distinct with Conditional Table1 has columns (id, a, b, c, group).  There are several rows that have the same group, but id is always unique.  I would like to SELECT group,a,b FROM Table1 WHERE the group is distinct.  However, I would like the returned data to be from the row with the greatest id for that group.

Thus, if we have the rows

(id=10, a=6, b=40, c=3, group=14)
(id=5, a=21, b=45, c=31, group=230)
(id=4, a=42, b=65, c=2, group=230)

I would like to return these 2 rows:

[group=14, a=6,b=40] and 
[group=230, a=21,b=45] (because id=5 > id=4)

Is there a simple SELECT statement to do this?",3
7597050,09/29/2011 12:04:53,959128,09/22/2011 12:45:24,20,0,Select rows with same value and then insert a null record,"

i have written an query but it inserts alternate null columns. I want the null column after different orderids. Suppose i have two orderids 100 and 101. i have only one record for orderid 100 and two records for orderid 101 so it should insert null column after orderid 100 and then after 101 orderid.


    DECLARE @tmp TABLE 
    (
        srno int identity (1,1) ,
        orderid int,
        orderdate datetime,
        orderstatus varchar(255),
        product_name varchar(255),
        shipping_cost decimal(18,2),
        Quantity int,
        TotalPrice money,
        SalesTax1 money,
        CVV2_Response varchar(255),
        ShipFirstName varchar(255),
        ShipLastName varchar(255),
        ShipAddress1 varchar(255),
        ShipCity varchar(255),
        ShipState varchar(255),
        ShipPostalCode varchar(255),
        EmailAddress varchar(255),
        CustomerID int
        
    )
    
    SELECT CASE D.N WHEN 1 THEN ord.orderid end as orderid,CASE D.N WHEN 1 THEN ord.orderdate end as orderdate, 
    CASE D.N WHEN 1 THEN ord.OrderStatus end as Orderstatus, 
    CASE D.N WHEN 1 THEN ord.productname end as Productname,
    CASE D.N WHEN 1 THEN ord.Quantity end as Quantity,
    CASE D.N WHEN 1 THEN ord.TotalPrice end AS PaymentAmount,
    CASE D.N WHEN 1 THEN ord.SalesTax1 ELSE 0.0 END AS Tax ,
    CASE WHEN row_no = 1 THEN ord.totalshippingcost ELSE 0.0 END AS Totalshippingcost,
    CASE D.N WHEN 1 THEN ord.CVV2_Response end as CVV2_Response  ,
    CASE D.N WHEN 1 THEN ord.ShipFirstName end as ShipFirstName ,
    CASE D.N WHEN 1 THEN ord.ShipLastName end as ShipLastName ,
    CASE D.N WHEN 1 THEN ord.ShipAddress1 end as ShipAddress1 ,
    CASE D.N WHEN 1 THEN ord.ShipCity end as ShipCity ,
    CASE D.N WHEN 1 THEN ord.ShipState end as ShipState ,
    CASE D.N WHEN 1 THEN ord.ShipPostalCode  end as ShipPostalCode,
    CASE D.N WHEN 1 THEN ord.EmailAddress end AS CustomerEmail
    
    FROM
    (
    SELECT ROW_NUMBER() OVER(PARTITION BY ord.orderid ORDER BY ord.orderid, ord.orderdate, ord.OrderStatus, odn.productname, odn.Quantity, odn.TotalPrice,ord.SalesTax1,ord.totalshippingcost,ord.CVV2_Response ,ord.ShipFirstName ,ord.ShipLastName ,
    ord.ShipAddress1 ,ord.ShipCity ,ord.ShipState ,ord.ShipPostalCode ,cus.EmailAddress) AS row_no, ord.orderid, 
    ord.orderdate, ord.OrderStatus, odn.productname, odn.Quantity, odn.TotalPrice,ord.SalesTax1,ord.totalshippingcost,ord.CVV2_Response ,ord.ShipFirstName ,ord.ShipLastName ,
    ord.ShipAddress1 ,ord.ShipCity ,ord.ShipState ,ord.ShipPostalCode ,cus.EmailAddress
    FROM Orders AS ord 
        INNER JOIN orderdetails AS odn ON odn.orderid = ord.orderid INNER Join Customers AS cus on  ord.CustomerID = cus.CustomerID WHERE ord.OrderStatus = 'Processing'
    ) ord
    CROSS JOIN (SELECT 1 UNION ALL SELECT 2) AS D(N)
    ORDER BY ord.orderid, ord.orderdate, ord.productname, D.N",sql,sql-server,,,,,open,0,579,11,"Select rows with same value and then insert a null record 

i have written an query but it inserts alternate null columns. I want the null column after different orderids. Suppose i have two orderids 100 and 101. i have only one record for orderid 100 and two records for orderid 101 so it should insert null column after orderid 100 and then after 101 orderid.


    DECLARE @tmp TABLE 
    (
        srno int identity (1,1) ,
        orderid int,
        orderdate datetime,
        orderstatus varchar(255),
        product_name varchar(255),
        shipping_cost decimal(18,2),
        Quantity int,
        TotalPrice money,
        SalesTax1 money,
        CVV2_Response varchar(255),
        ShipFirstName varchar(255),
        ShipLastName varchar(255),
        ShipAddress1 varchar(255),
        ShipCity varchar(255),
        ShipState varchar(255),
        ShipPostalCode varchar(255),
        EmailAddress varchar(255),
        CustomerID int
        
    )
    
    SELECT CASE D.N WHEN 1 THEN ord.orderid end as orderid,CASE D.N WHEN 1 THEN ord.orderdate end as orderdate, 
    CASE D.N WHEN 1 THEN ord.OrderStatus end as Orderstatus, 
    CASE D.N WHEN 1 THEN ord.productname end as Productname,
    CASE D.N WHEN 1 THEN ord.Quantity end as Quantity,
    CASE D.N WHEN 1 THEN ord.TotalPrice end AS PaymentAmount,
    CASE D.N WHEN 1 THEN ord.SalesTax1 ELSE 0.0 END AS Tax ,
    CASE WHEN row_no = 1 THEN ord.totalshippingcost ELSE 0.0 END AS Totalshippingcost,
    CASE D.N WHEN 1 THEN ord.CVV2_Response end as CVV2_Response  ,
    CASE D.N WHEN 1 THEN ord.ShipFirstName end as ShipFirstName ,
    CASE D.N WHEN 1 THEN ord.ShipLastName end as ShipLastName ,
    CASE D.N WHEN 1 THEN ord.ShipAddress1 end as ShipAddress1 ,
    CASE D.N WHEN 1 THEN ord.ShipCity end as ShipCity ,
    CASE D.N WHEN 1 THEN ord.ShipState end as ShipState ,
    CASE D.N WHEN 1 THEN ord.ShipPostalCode  end as ShipPostalCode,
    CASE D.N WHEN 1 THEN ord.EmailAddress end AS CustomerEmail
    
    FROM
    (
    SELECT ROW_NUMBER() OVER(PARTITION BY ord.orderid ORDER BY ord.orderid, ord.orderdate, ord.OrderStatus, odn.productname, odn.Quantity, odn.TotalPrice,ord.SalesTax1,ord.totalshippingcost,ord.CVV2_Response ,ord.ShipFirstName ,ord.ShipLastName ,
    ord.ShipAddress1 ,ord.ShipCity ,ord.ShipState ,ord.ShipPostalCode ,cus.EmailAddress) AS row_no, ord.orderid, 
    ord.orderdate, ord.OrderStatus, odn.productname, odn.Quantity, odn.TotalPrice,ord.SalesTax1,ord.totalshippingcost,ord.CVV2_Response ,ord.ShipFirstName ,ord.ShipLastName ,
    ord.ShipAddress1 ,ord.ShipCity ,ord.ShipState ,ord.ShipPostalCode ,cus.EmailAddress
    FROM Orders AS ord 
        INNER JOIN orderdetails AS odn ON odn.orderid = ord.orderid INNER Join Customers AS cus on  ord.CustomerID = cus.CustomerID WHERE ord.OrderStatus = 'Processing'
    ) ord
    CROSS JOIN (SELECT 1 UNION ALL SELECT 2) AS D(N)
    ORDER BY ord.orderid, ord.orderdate, ord.productname, D.N",2
4141031,11/10/2010 03:39:58,273212,02/11/2010 02:04:56,291,5,NLSTERRITORY IN ORACLE,what is the purpose of NLSTERRITORY session variable in oracle. If i change NLSTERRITORY point to a different country what it does. Does it change any date parameter? Because always 10Nov2010 is wednesday. what difference it make if i change the territory,sql,oracle,plsql,,,,open,0,42,3,NLSTERRITORY IN ORACLE what is the purpose of NLSTERRITORY session variable in oracle. If i change NLSTERRITORY point to a different country what it does. Does it change any date parameter? Because always 10Nov2010 is wednesday. what difference it make if i change the territory,3
4767104,01/22/2011 09:26:35,439448,09/04/2010 04:36:34,77,0,how to filter duplicate rows with different value,"I hv a table like this

Model     Qty        Date
ABC        1         20110102
ABC       -1         20110105
QWE        1         20110103
ZXC        1         20110103
ABC        1         20110110
QWE       -1         20110110

I wish to hv the final output like this:-

Model     Qty        Date
ZXC        1         20110103
ABC        1         20110110

How can I do this via SQL ?

Thanks



",sql,,,,,,open,0,181,8,"how to filter duplicate rows with different value I hv a table like this

Model     Qty        Date
ABC        1         20110102
ABC       -1         20110105
QWE        1         20110103
ZXC        1         20110103
ABC        1         20110110
QWE       -1         20110110

I wish to hv the final output like this:-

Model     Qty        Date
ZXC        1         20110103
ABC        1         20110110

How can I do this via SQL ?

Thanks



",1
10488686,05/07/2012 20:30:56,1380647,05/07/2012 20:27:40,1,0,What sql service/hosting to choose?,"I have an application where students will logon many users at the same time. So then the sql database needs to support many simultaniously connections at the same time. at most 1000. This is basically the only thing i need.



What will be a good solution to choose.



Regards Vegaredo",sql,application,,,,05/07/2012 20:35:15,off topic,1,48,5,"What sql service/hosting to choose? I have an application where students will logon many users at the same time. So then the sql database needs to support many simultaniously connections at the same time. at most 1000. This is basically the only thing i need.



What will be a good solution to choose.



Regards Vegaredo",2
6251921,06/06/2011 12:23:23,785880,06/06/2011 12:23:23,1,0,select some records from table using IN keyword,"I want to select some records from table using IN keyword ,where parameter under IN keyword are Varchar type as concatenated value of Id using "","" where as Id is int type


select UserId, Name from UserMaster WHERE UserId IN ('1,2,3,4,5')
help me to get record asap.",sql,,,,,,open,0,45,8,"select some records from table using IN keyword I want to select some records from table using IN keyword ,where parameter under IN keyword are Varchar type as concatenated value of Id using "","" where as Id is int type


select UserId, Name from UserMaster WHERE UserId IN ('1,2,3,4,5')
help me to get record asap.",1
10614515,05/16/2012 08:17:00,1348163,04/21/2012 10:29:31,0,0,procedure in pl/sql,"i am facing a little problem with this question.. i have done what i know 
Help if you can 

a)	Create a procedure insert_History that inserts a new record into the History table.
b)	Write a small PL/SQL program that calls the ""insert_History""  procedure to insert the three records based on the facts given below: 

i.	Mark jackop  hired 01/05/2009 as SH-CLERK  got a new position of a sales representative (Job_ID = SA-REP) on 04/06/2009. Assume that the end date for the previous position is 31/05/2009.

table: history---> emp_id , start_date , end_date , job_id, dep_id
table: employee ----> emp_id , name,job_id,dep_id 

this what i have done ! 

    create or replace
    procedure insert_History(emp_id in integer , job_id in number) 
    is 
    begin 
    update History
    set ?????? = insert into history(.....) 
    where employees.emp_id= emp_id;
    end;



",sql,oracle,stored-procedures,plsql,sql-developer,,open,0,159,3,"procedure in pl/sql i am facing a little problem with this question.. i have done what i know 
Help if you can 

a)	Create a procedure insert_History that inserts a new record into the History table.
b)	Write a small PL/SQL program that calls the ""insert_History""  procedure to insert the three records based on the facts given below: 

i.	Mark jackop  hired 01/05/2009 as SH-CLERK  got a new position of a sales representative (Job_ID = SA-REP) on 04/06/2009. Assume that the end date for the previous position is 31/05/2009.

table: history---> emp_id , start_date , end_date , job_id, dep_id
table: employee ----> emp_id , name,job_id,dep_id 

this what i have done ! 

    create or replace
    procedure insert_History(emp_id in integer , job_id in number) 
    is 
    begin 
    update History
    set ?????? = insert into history(.....) 
    where employees.emp_id= emp_id;
    end;



",5
11376908,07/07/2012 16:51:52,584018,01/21/2011 05:51:03,97,0,looking for best optimize query?,"below are my 2 sample master data tables,

    CREATE TABLE PROJECTS(PROJECT_ID INT, PROJECT_NAME VARCHAR(50))
    INSERT INTO PROJECTS(PROJECT_ID, PROJECT_NAME) VALUES(1, 'P-1')
    INSERT INTO PROJECTS(PROJECT_ID, PROJECT_NAME) VALUES(2, 'P-2')


    CREATE TABLE PROJECTS_WORKS(PROJECT_WORK_ID INT, PROJECT_WORK_NAME VARCHAR(50), PROJECT_ID INT)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(1, 'W-1', 1)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(2, 'W-2', 1)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(3, 'W-3', 1)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(4, 'W-4', 2)

below are 2 transaction tables structures and to I need to insert data to these tables which also has IDENTITY column and  their data comes in 2 SP's parameters,

    CREATE TABLE GROUPS(GROUP_ID INT IDENTITY(1,1), GROUP_NAME VARCHAR(50))
    CREATE TABLE GROUP_PROJECT_WORKS(ID INT IDENTITY(1,1), GROUP_ID INT,  PROJECT_WORK_ID INT)

    --sp's parameter's
    DECLARE @GROUP_NAME VARCHAR(50)
    SET @GROUP_NAME = 'G-1'
    DECLARE @PROJECTS_WORKS_IDS VARCHAR(MAX)
    SET @PROJECTS_WORKS_IDS = '<ROOT>
							<WORK_ID>1</WORK_ID>
							<WORK_ID>3</WORK_ID>
						   </ROOT>'

Output should be,
![output][1]


  [1]: http://i.stack.imgur.com/dI8FX.jpg",sql,sql-server,,,,07/08/2012 00:01:27,not a real question,1,181,5,"looking for best optimize query? below are my 2 sample master data tables,

    CREATE TABLE PROJECTS(PROJECT_ID INT, PROJECT_NAME VARCHAR(50))
    INSERT INTO PROJECTS(PROJECT_ID, PROJECT_NAME) VALUES(1, 'P-1')
    INSERT INTO PROJECTS(PROJECT_ID, PROJECT_NAME) VALUES(2, 'P-2')


    CREATE TABLE PROJECTS_WORKS(PROJECT_WORK_ID INT, PROJECT_WORK_NAME VARCHAR(50), PROJECT_ID INT)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(1, 'W-1', 1)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(2, 'W-2', 1)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(3, 'W-3', 1)
    INSERT INTO PROJECTS_WORKS(PROJECT_WORK_ID, PROJECT_WORK_NAME, PROJECT_ID) VALUES(4, 'W-4', 2)

below are 2 transaction tables structures and to I need to insert data to these tables which also has IDENTITY column and  their data comes in 2 SP's parameters,

    CREATE TABLE GROUPS(GROUP_ID INT IDENTITY(1,1), GROUP_NAME VARCHAR(50))
    CREATE TABLE GROUP_PROJECT_WORKS(ID INT IDENTITY(1,1), GROUP_ID INT,  PROJECT_WORK_ID INT)

    --sp's parameter's
    DECLARE @GROUP_NAME VARCHAR(50)
    SET @GROUP_NAME = 'G-1'
    DECLARE @PROJECTS_WORKS_IDS VARCHAR(MAX)
    SET @PROJECTS_WORKS_IDS = '<ROOT>
							<WORK_ID>1</WORK_ID>
							<WORK_ID>3</WORK_ID>
						   </ROOT>'

Output should be,
![output][1]


  [1]: http://i.stack.imgur.com/dI8FX.jpg",2
5859841,05/02/2011 16:42:43,225799,12/06/2009 14:39:09,542,5,Coding standards and best programming practices for SQL Server,I am looking for some decent coding standards and best programming practices for SQL Server?,sql,sql-server,database,sql-server-2005,sql-server-2008,05/02/2011 16:47:45,not a real question,1,15,9,Coding standards and best programming practices for SQL Server I am looking for some decent coding standards and best programming practices for SQL Server?,5
10082168,04/10/2012 01:55:34,1297050,03/28/2012 03:08:45,0,0,Creating a Trigger every insert and update in oracle with sum on table,"Good day...

i have 2 tables 

allowance(detailed table)
----------
1.driver_name
2.amount

master_daily_allowance(master table)
----------
1.driver_name
2.total_allowance_delivery


what i want to do is to get the sum of amount(allowance_table) as the total amount per driver_name(distinct the driver_name in allowance_table) and when insert or update in allowance table.. will be get by master_daily_allowance



please help me master.. i'm new in oracle.. i'm using oracle 11g EX and apex for application.. thanks!



",sql,sql-server,oracle11g,apex-code,oracle-apex,04/23/2012 02:35:16,not a real question,1,59,13,"Creating a Trigger every insert and update in oracle with sum on table Good day...

i have 2 tables 

allowance(detailed table)
----------
1.driver_name
2.amount

master_daily_allowance(master table)
----------
1.driver_name
2.total_allowance_delivery


what i want to do is to get the sum of amount(allowance_table) as the total amount per driver_name(distinct the driver_name in allowance_table) and when insert or update in allowance table.. will be get by master_daily_allowance



please help me master.. i'm new in oracle.. i'm using oracle 11g EX and apex for application.. thanks!



",5
7160893,08/23/2011 12:16:25,907693,08/23/2011 12:16:25,1,0,Got Problem With Join Quey :(,"i have two tables 

table_a

id | name | in1 | in2 |
_______________________
 1  | jose | 1  | 2   |
 2  | John | 2  | 3   |
 3  | Mary | 1  | 2   |
_______________________

table_b

id  | itemName |
________________
 1  |  sugar   |
 2  |  Pepper  |
 3  |  salt    |
________________

I need the  out put as 


name | it1 | it2 |
_____________________
jose | sugar| pepper |
John | pepper | Salt |
mary | sugar  | salt |
______________________

Please help me ..thanks in advance :) 

i tryd some join query but it gives some repeated data
",sql,join,,,,08/23/2011 20:45:04,not a real question,1,120,6,"Got Problem With Join Quey :( i have two tables 

table_a

id | name | in1 | in2 |
_______________________
 1  | jose | 1  | 2   |
 2  | John | 2  | 3   |
 3  | Mary | 1  | 2   |
_______________________

table_b

id  | itemName |
________________
 1  |  sugar   |
 2  |  Pepper  |
 3  |  salt    |
________________

I need the  out put as 


name | it1 | it2 |
_____________________
jose | sugar| pepper |
John | pepper | Salt |
mary | sugar  | salt |
______________________

Please help me ..thanks in advance :) 

i tryd some join query but it gives some repeated data
",2
8444140,12/09/2011 10:27:35,1087367,12/08/2011 09:06:40,1,0,About transaction in SQL,"
Here list a piece of pseudocode. <br/>
<strong>And my question is that suppose the original number of records in table1 is 10, then what is the print method output? (10 or 11)</strong>

    transaction->begin();
    try{
        table1->insert(...);
        count = table1->search(""select count(*) from table1"");
        print(count);
        transaction->commit();
    }catch(Exception e){
        transaction->rollback();
    }",sql,transactions,,,,12/09/2011 10:38:36,not a real question,1,93,4,"About transaction in SQL 
Here list a piece of pseudocode. <br/>
<strong>And my question is that suppose the original number of records in table1 is 10, then what is the print method output? (10 or 11)</strong>

    transaction->begin();
    try{
        table1->insert(...);
        count = table1->search(""select count(*) from table1"");
        print(count);
        transaction->commit();
    }catch(Exception e){
        transaction->rollback();
    }",2
9845492,03/23/2012 19:37:41,1289024,03/23/2012 19:22:35,1,0,Retrieving data from SQL Server using LINQ,"How can I retrieve data from a SQL Server using LINQ and display each tuple in a table in the UI? 
I would also like to know how I can convert the data retrieved in to JSON and send it to clients who accessed that particular service.

Any help is highly appreciated.",sql,wcf,linq,,,03/24/2012 22:45:57,not a real question,1,51,7,"Retrieving data from SQL Server using LINQ How can I retrieve data from a SQL Server using LINQ and display each tuple in a table in the UI? 
I would also like to know how I can convert the data retrieved in to JSON and send it to clients who accessed that particular service.

Any help is highly appreciated.",3
10313004,04/25/2012 09:37:54,349026,05/24/2010 14:18:18,1628,77,Points of SQL failure and moving ahead to NOSQL,"I have experience over Relational DB's but very little over NoSQL data stores and for these two I need a well defined reason to say that one needs to move to NoSQL.

Since I cannot replicate a situation where I can push a DB to its limits and make it loose performance, let alone scaling it. Therefore wandered about to see what others had to say. May be I have been treading the wrong path path, but I have read people saying why we should move to NoSQL or how or even at what sort of different scenarios eventually leads to NoSQL. Article after article explains what Big Data is and how it is managed in the NoSQL domain and how useful it is with it architecture of being scalable,robust,ACID,BASE, Data modelling from Sql to NoSQL, etc features.

But none would provide some solid numbers. E.g. A web service that had a DB of X-TB's and eventually the queries (read/write/etc) took T-seconds or so to complete so we moved on to NoSQL to get back the performance. My concern is at what point it really did a team shift to NoSQL when they said, OK we're done with scaling and everything, lets move on to NoSQL!

So I have had to ask SO users. Maybe someone can share some valuable information.  This seems to be an open issue for me as I have been trying to get hold of even just one document that explains a real case scenario where the SQL DB eventually had to be replaced with a NoSQL DB/DS/storage. 

Any guidance is much appreciated.  ",sql,database,comparison,nosql,switch-statement,05/15/2012 12:29:45,not constructive,1,267,9,"Points of SQL failure and moving ahead to NOSQL I have experience over Relational DB's but very little over NoSQL data stores and for these two I need a well defined reason to say that one needs to move to NoSQL.

Since I cannot replicate a situation where I can push a DB to its limits and make it loose performance, let alone scaling it. Therefore wandered about to see what others had to say. May be I have been treading the wrong path path, but I have read people saying why we should move to NoSQL or how or even at what sort of different scenarios eventually leads to NoSQL. Article after article explains what Big Data is and how it is managed in the NoSQL domain and how useful it is with it architecture of being scalable,robust,ACID,BASE, Data modelling from Sql to NoSQL, etc features.

But none would provide some solid numbers. E.g. A web service that had a DB of X-TB's and eventually the queries (read/write/etc) took T-seconds or so to complete so we moved on to NoSQL to get back the performance. My concern is at what point it really did a team shift to NoSQL when they said, OK we're done with scaling and everything, lets move on to NoSQL!

So I have had to ask SO users. Maybe someone can share some valuable information.  This seems to be an open issue for me as I have been trying to get hold of even just one document that explains a real case scenario where the SQL DB eventually had to be replaced with a NoSQL DB/DS/storage. 

Any guidance is much appreciated.  ",5
6336795,06/13/2011 21:48:40,607986,02/08/2011 11:03:24,28,0,sql-join two queries,"I have the query below that returns the number of phones repeated into a certain period time minus 1, i.e. if one phone number is appeared ten times the query will return 9. The key of this output is the samephone=0 in the where statement. If i replace the '=' with <> then the query will return all the phone numbers, repeated and not repeated. Although, i want to use a join statement between the query uses samephone=0 and the query uses samephone<>0 in order to return the number of the the repeated phone numbers without subtracting -1 (in the previous example, the result must be 10 instead of 9).
(the query implements an algorithm, so its select criteria has to remain as it is).

--query 
select phone_num ,cause,start,end from
(select phone_num,cause,start,end,start - LEAD(start,1)over (order by phone_num) as diff,
phone_num - LEAD(phone_num,1)over (order by phone_num)as samephone
FROM  (select * from faults_pstn  order by phone_num , start desc)
order by phone_num , start desc)
where diff>0 and diff<30 and
end  between to_date('1/05/2011 00:00:00', 'dd/mm/yyyy hh24:mi:ss')and to_date('31/05/2011 23:55:00','dd/mm/yyyy hh24:mi:ss')
and samephone=0
order by phone_num;",sql,,,,,08/30/2011 18:40:11,not a real question,1,175,3,"sql-join two queries I have the query below that returns the number of phones repeated into a certain period time minus 1, i.e. if one phone number is appeared ten times the query will return 9. The key of this output is the samephone=0 in the where statement. If i replace the '=' with <> then the query will return all the phone numbers, repeated and not repeated. Although, i want to use a join statement between the query uses samephone=0 and the query uses samephone<>0 in order to return the number of the the repeated phone numbers without subtracting -1 (in the previous example, the result must be 10 instead of 9).
(the query implements an algorithm, so its select criteria has to remain as it is).

--query 
select phone_num ,cause,start,end from
(select phone_num,cause,start,end,start - LEAD(start,1)over (order by phone_num) as diff,
phone_num - LEAD(phone_num,1)over (order by phone_num)as samephone
FROM  (select * from faults_pstn  order by phone_num , start desc)
order by phone_num , start desc)
where diff>0 and diff<30 and
end  between to_date('1/05/2011 00:00:00', 'dd/mm/yyyy hh24:mi:ss')and to_date('31/05/2011 23:55:00','dd/mm/yyyy hh24:mi:ss')
and samephone=0
order by phone_num;",1
4975484,02/12/2011 00:39:30,613799,02/12/2011 00:08:51,1,0,need example sql transaction procedures for sales tracking or financial database,"i am making a database for an accounting/sales type system similar to a car sales database and would like to make some transactions for the following real world actions

salesman creates new product shipped onto floor (itempk, car make, year, price).  
salesman changes price.  
salesman creates sale entry for product sold (salespk, itemforeignkey, price sold, salesman).  
salesman cancels item for removed product.  
salesman cancels sale for cancelled sale
  
the examples i have found online are too generic...like this is a transaction... i would like something resembling what i am trying to do to understand it.

 anybody have some good similar or related sql examples i can look at to design these?  or if you have done this kind of sql transaction before could you make an outline for how these could be made?  thanks 

",sql,stored-procedures,transactions,financial,sales,02/12/2011 14:57:34,not a real question,1,141,11,"need example sql transaction procedures for sales tracking or financial database i am making a database for an accounting/sales type system similar to a car sales database and would like to make some transactions for the following real world actions

salesman creates new product shipped onto floor (itempk, car make, year, price).  
salesman changes price.  
salesman creates sale entry for product sold (salespk, itemforeignkey, price sold, salesman).  
salesman cancels item for removed product.  
salesman cancels sale for cancelled sale
  
the examples i have found online are too generic...like this is a transaction... i would like something resembling what i am trying to do to understand it.

 anybody have some good similar or related sql examples i can look at to design these?  or if you have done this kind of sql transaction before could you make an outline for how these could be made?  thanks 

",5
10553909,05/11/2012 15:01:45,742102,05/06/2011 16:04:04,45,8,sql query with multiple filter in where,"I would like to share my solution for a query that has multiple filter in where section with out using case when, coalesece and other complicated tl/sql.
This query will filter category filters, location and businessName if the user asks for it. I struggled a lil bit until I came up whith this. 

Entity: CLient

The filters: IsIncludeLocation, IsIncludeCategoryFilter, OrderBy, BusinessName. 
Condition: the client will only be filtered by location if IsIncludeLocation=1, will be filtered by category if IsIncludeCategoryFilter=1 and will be ordered b y if an orderby input is provided. 

The problem: You can not do this inside where

Solution: if include location is true thats the only time you will filter it by gpslong and gpslat (location) otherwise it shoudl display all. Same goes with categoryfilter.


    CREATE PROCEDURE dbo.FindByCriteria (
    
    @SearchText NVARCHAR(50),
    @IncludeLocation bit,
    @Long float,
    @Lat float, 
    @IncludeCategoryFilter bit,
    @CategoryFilters NVARCHAR(250),
    @IncludePaging bit,
    @PageNumber int,
    @PageSize int,
    @OrderBy NVARCHAR(50)
    )
    AS
    SELECT *
    FROM Client c inner join ClientCategories cg on c.ClientId=cg.ClientId
    WHERE 
    	BusinessName like '%'+@SearchText+'%'
      And (
    		(@IncludeLocation=1 and  (c.GPSLat = @Lat AND c.GPSLong = @Long)) 
    		or
    		(@IncludeLocation=0)
    	  )
      AND 
    	(
    		(@IncludeCategoryFilter=1 and CategoryName in (SELECT s FROM [SupplierSearch].[dbo].[SplitString](@CategoryFilters, ',')))
    		or
     		(@IncludeCategoryFilter=0)
    	)
    order by 
    CASE @OrderBy 
                WHEN 'BusinessName' THEN BusinessName 
                WHEN 'FirstName' THEN FirstName 
                WHEN 'PostCode' THEN PostCode 
                WHEN 'LastName' THEN LastName 
            END
            

CategoryFilters ='A,B,C' so we will split it by , delimiter by using this function:


    create function [dbo].[SplitString] 
        (
            @str nvarchar(4000), 
            @separator char(1)
        )
        returns table
        AS
        return (
            with tokens(p, a, b) AS (
                select 
                    1, 
                    1, 
                    charindex(@separator, @str)
                union all
                select
                    p + 1, 
                    b + 1, 
                    charindex(@separator, @str, b + 1)
                from tokens
                where b > 0
            )
            select
                p-1 zeroBasedOccurance,
                substring(
                    @str, 
                    a, 
                    case when b > 0 then b-a ELSE 4000 end) 
                AS s
            from tokens
          )
    
    GO





	
",sql,query,function,stored-procedures,multiple,05/12/2012 11:07:47,not a real question,1,912,7,"sql query with multiple filter in where I would like to share my solution for a query that has multiple filter in where section with out using case when, coalesece and other complicated tl/sql.
This query will filter category filters, location and businessName if the user asks for it. I struggled a lil bit until I came up whith this. 

Entity: CLient

The filters: IsIncludeLocation, IsIncludeCategoryFilter, OrderBy, BusinessName. 
Condition: the client will only be filtered by location if IsIncludeLocation=1, will be filtered by category if IsIncludeCategoryFilter=1 and will be ordered b y if an orderby input is provided. 

The problem: You can not do this inside where

Solution: if include location is true thats the only time you will filter it by gpslong and gpslat (location) otherwise it shoudl display all. Same goes with categoryfilter.


    CREATE PROCEDURE dbo.FindByCriteria (
    
    @SearchText NVARCHAR(50),
    @IncludeLocation bit,
    @Long float,
    @Lat float, 
    @IncludeCategoryFilter bit,
    @CategoryFilters NVARCHAR(250),
    @IncludePaging bit,
    @PageNumber int,
    @PageSize int,
    @OrderBy NVARCHAR(50)
    )
    AS
    SELECT *
    FROM Client c inner join ClientCategories cg on c.ClientId=cg.ClientId
    WHERE 
    	BusinessName like '%'+@SearchText+'%'
      And (
    		(@IncludeLocation=1 and  (c.GPSLat = @Lat AND c.GPSLong = @Long)) 
    		or
    		(@IncludeLocation=0)
    	  )
      AND 
    	(
    		(@IncludeCategoryFilter=1 and CategoryName in (SELECT s FROM [SupplierSearch].[dbo].[SplitString](@CategoryFilters, ',')))
    		or
     		(@IncludeCategoryFilter=0)
    	)
    order by 
    CASE @OrderBy 
                WHEN 'BusinessName' THEN BusinessName 
                WHEN 'FirstName' THEN FirstName 
                WHEN 'PostCode' THEN PostCode 
                WHEN 'LastName' THEN LastName 
            END
            

CategoryFilters ='A,B,C' so we will split it by , delimiter by using this function:


    create function [dbo].[SplitString] 
        (
            @str nvarchar(4000), 
            @separator char(1)
        )
        returns table
        AS
        return (
            with tokens(p, a, b) AS (
                select 
                    1, 
                    1, 
                    charindex(@separator, @str)
                union all
                select
                    p + 1, 
                    b + 1, 
                    charindex(@separator, @str, b + 1)
                from tokens
                where b > 0
            )
            select
                p-1 zeroBasedOccurance,
                substring(
                    @str, 
                    a, 
                    case when b > 0 then b-a ELSE 4000 end) 
                AS s
            from tokens
          )
    
    GO





	
",5
11564219,07/19/2012 15:31:24,1538370,07/19/2012 15:24:55,1,0,To view all tables' queries on SQL Server 2008 Management Studio,Im lookin for view table query on sql 2008 mngmnt studio for days but i couldnt find it. I have a database and it contains lots of tables. I want to see the query of these tables.,sql,sql-server-2008,query,table,,07/19/2012 15:59:18,off topic,1,37,11,To view all tables' queries on SQL Server 2008 Management Studio Im lookin for view table query on sql 2008 mngmnt studio for days but i couldnt find it. I have a database and it contains lots of tables. I want to see the query of these tables.,4
11674201,07/26/2012 16:53:30,1555463,07/26/2012 16:50:27,1,0,my sql trigger is not working?,"SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER TRIGGER [dbo].[AutoUpdate_Daily_STO26_7_9]
   ON  [AlgorithTrading_Stocks].[dbo].[Daily_STO26_7_9] 
   AFTER INSERT,DELETE,UPDATE
AS 
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	WITH [TABLA_BASE_1] AS (SELECT [char_Symbol], [date_Date], [dec_Close_Market]
			, MAX([dec_Close_Market]) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 25 FOLLOWING) AS MAXIMO
			, MIN([dec_Close_Market]) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 25 FOLLOWING) AS MINIMO
	FROM [AlgorithTrading_Stocks].[dbo].[Daily_Historical_Data])

	MERGE INTO [AlgorithTrading_Stocks].[dbo].[Daily_STO26_7_9] AS DatabaseTARGET
	USING (

	SELECT [char_Symbol], [date_Date], [dec_Close_Market] ,[dec_K]
	, CAST(AVG([dec_K]) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 8 FOLLOWING) AS decimal (18,2)) AS dec_D 
	FROM(
		SELECT [char_Symbol], [date_Date], [dec_Close_Market]
		, ROW_NUMBER() OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol]) AS RowNumber
		, CAST(AVG((([dec_Close_Market]-MINIMO)/(MAXIMO-MINIMO))*100) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 6 FOLLOWING) AS decimal (18,2)) AS dec_K
		FROM [TABLA_BASE_1] WHERE (MAXIMO-MINIMO)>0) AS TABLA_BASE_2
	WHERE RowNumber<21
	) AS DatabaseSOURCE

	ON (DatabaseTARGET.[char_Symbol]	= DatabaseSOURCE.[char_Symbol] 
	AND DatabaseTARGET.[date_Date]		= DatabaseSOURCE.[date_Date])
	WHEN MATCHED THEN
		UPDATE SET	  DatabaseTARGET.[dec_Close_Market]	= DatabaseSOURCE.[dec_Close_Market]
					, DatabaseTARGET.[dec_K]			= DatabaseSOURCE.[dec_K]
					, DatabaseTARGET.[dec_D]			= DatabaseSOURCE.[dec_D]
	WHEN NOT MATCHED THEN
		INSERT ([char_Symbol], [date_Date], [dec_Close_Market],[dec_K], [dec_D])
		VALUES (DatabaseSOURCE.[char_Symbol], DatabaseSOURCE.[date_Date], DatabaseSOURCE.[dec_Close_Market], DatabaseSOURCE.[dec_K], DatabaseSOURCE.[dec_D]);

END",sql,triggers,server,,,07/26/2012 20:32:47,not a real question,1,173,6,"my sql trigger is not working? SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER TRIGGER [dbo].[AutoUpdate_Daily_STO26_7_9]
   ON  [AlgorithTrading_Stocks].[dbo].[Daily_STO26_7_9] 
   AFTER INSERT,DELETE,UPDATE
AS 
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	WITH [TABLA_BASE_1] AS (SELECT [char_Symbol], [date_Date], [dec_Close_Market]
			, MAX([dec_Close_Market]) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 25 FOLLOWING) AS MAXIMO
			, MIN([dec_Close_Market]) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 25 FOLLOWING) AS MINIMO
	FROM [AlgorithTrading_Stocks].[dbo].[Daily_Historical_Data])

	MERGE INTO [AlgorithTrading_Stocks].[dbo].[Daily_STO26_7_9] AS DatabaseTARGET
	USING (

	SELECT [char_Symbol], [date_Date], [dec_Close_Market] ,[dec_K]
	, CAST(AVG([dec_K]) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 8 FOLLOWING) AS decimal (18,2)) AS dec_D 
	FROM(
		SELECT [char_Symbol], [date_Date], [dec_Close_Market]
		, ROW_NUMBER() OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol]) AS RowNumber
		, CAST(AVG((([dec_Close_Market]-MINIMO)/(MAXIMO-MINIMO))*100) OVER (PARTITION BY [char_Symbol] ORDER BY [char_Symbol] ROWS BETWEEN CURRENT ROW AND 6 FOLLOWING) AS decimal (18,2)) AS dec_K
		FROM [TABLA_BASE_1] WHERE (MAXIMO-MINIMO)>0) AS TABLA_BASE_2
	WHERE RowNumber<21
	) AS DatabaseSOURCE

	ON (DatabaseTARGET.[char_Symbol]	= DatabaseSOURCE.[char_Symbol] 
	AND DatabaseTARGET.[date_Date]		= DatabaseSOURCE.[date_Date])
	WHEN MATCHED THEN
		UPDATE SET	  DatabaseTARGET.[dec_Close_Market]	= DatabaseSOURCE.[dec_Close_Market]
					, DatabaseTARGET.[dec_K]			= DatabaseSOURCE.[dec_K]
					, DatabaseTARGET.[dec_D]			= DatabaseSOURCE.[dec_D]
	WHEN NOT MATCHED THEN
		INSERT ([char_Symbol], [date_Date], [dec_Close_Market],[dec_K], [dec_D])
		VALUES (DatabaseSOURCE.[char_Symbol], DatabaseSOURCE.[date_Date], DatabaseSOURCE.[dec_Close_Market], DatabaseSOURCE.[dec_K], DatabaseSOURCE.[dec_D]);

END",3
3965049,10/19/2010 03:04:28,247243,01/09/2010 21:16:54,1634,4,How to sort ENUM column in MySQL database ?,"I have `color` column in MySQL table which type is `ENUM('RED', 'YELLOW', 'MY_COLOR', 'BLACK')`, and another `name` column which type is `VARCHAR(30)`.

I would like to get all table rows in the following order:

- `YELLOW` rows first, sorted by `name`
- `RED` rows last, sorted by `name`
- In the middle, all other rows, sorted by `name`

Is that possible to make this kind of sort in 1 query ?

",sql,mysql,sorting,enums,,,open,0,66,9,"How to sort ENUM column in MySQL database ? I have `color` column in MySQL table which type is `ENUM('RED', 'YELLOW', 'MY_COLOR', 'BLACK')`, and another `name` column which type is `VARCHAR(30)`.

I would like to get all table rows in the following order:

- `YELLOW` rows first, sorted by `name`
- `RED` rows last, sorted by `name`
- In the middle, all other rows, sorted by `name`

Is that possible to make this kind of sort in 1 query ?

",4
10257411,04/21/2012 08:21:09,1348044,04/21/2012 08:17:17,1,0,MY SQL help please,"    $con = mysql_connect(""localhost"",""--------"",""------"")
    or die (""Could not connect to mysql because "".mysql_error());
    mysql_select_db(""-----------"");
    
    $insert = mysql_query(""INSERT INTO count (user, day, hour) VALUES ('"".$user.""', "".$day."", "".$hour."") ON DUPLICATE KEY UPDATE day="".$day."", hour="".$hour."""")
    or die(""Error Code:"".mysql_error());
    mysql_close($con);


It just creates a new row every time.",sql,,,,,04/22/2012 18:22:23,too localized,1,65,4,"MY SQL help please     $con = mysql_connect(""localhost"",""--------"",""------"")
    or die (""Could not connect to mysql because "".mysql_error());
    mysql_select_db(""-----------"");
    
    $insert = mysql_query(""INSERT INTO count (user, day, hour) VALUES ('"".$user.""', "".$day."", "".$hour."") ON DUPLICATE KEY UPDATE day="".$day."", hour="".$hour."""")
    or die(""Error Code:"".mysql_error());
    mysql_close($con);


It just creates a new row every time.",1
7933070,10/28/2011 18:02:51,1018875,10/28/2011 17:56:24,1,0,"Nested SQL statements For Oracle, How can I do this?","I am taking a sql database class using oracle,

I am stuck on this problem I dont get it,..

""Find the book title, author last name, and units on hand for each book in branch number 4""

I've tried different ways of nesting statement but none have worked.

the tables are as fallows

BOOK
AUTHOR
INVENTORY
BRANCH

can anyone help me fast!",sql,database,oracle,,,10/28/2011 18:56:24,not a real question,1,53,10,"Nested SQL statements For Oracle, How can I do this? I am taking a sql database class using oracle,

I am stuck on this problem I dont get it,..

""Find the book title, author last name, and units on hand for each book in branch number 4""

I've tried different ways of nesting statement but none have worked.

the tables are as fallows

BOOK
AUTHOR
INVENTORY
BRANCH

can anyone help me fast!",3
9188484,02/08/2012 05:56:53,883529,08/08/2011 06:39:10,1,0,Finding Coefficient of Determination for Microsoft Linear Regression Algorithm,"I am using Microsoft Linear Regression Algorithm in a Mining Model to predict some value using case table as input. I get the equation for the Mining Model in the Mining Legend window of BI studio and I am also able to get coefficients using DMX query. I want to get the value of coefficient of determination (R squared) for this regression. Is there any way to get it directly or deriving it using some of the available coefficients etc.?
P.S.  I am aware that Microsoft is using decision tree algorithm internally to implement linear regression.",sql,data-mining,business-intelligence,,,,open,0,96,9,"Finding Coefficient of Determination for Microsoft Linear Regression Algorithm I am using Microsoft Linear Regression Algorithm in a Mining Model to predict some value using case table as input. I get the equation for the Mining Model in the Mining Legend window of BI studio and I am also able to get coefficients using DMX query. I want to get the value of coefficient of determination (R squared) for this regression. Is there any way to get it directly or deriving it using some of the available coefficients etc.?
P.S.  I am aware that Microsoft is using decision tree algorithm internally to implement linear regression.",3
11033271,06/14/2012 12:41:45,1440113,06/06/2012 15:06:05,1,0,CPU Space Occupied by Sql server objects? who?,"

In Our Production server 32 GB RAM, Last week In C drive total size is 72 GB and free space 23 GB Size But This week suddenly 10 GB of resource(disk space) occupied by SQL resources So Now total size is 72 GB and free space is 13 GB only. Is any Query to find which SQL server objects(view/table/sp/triggers etc) consumes this 10 GB of CPU resource(space)? How to sort out in future? any method available ? Quick suggestions are highly appreciated....................

Note: this week no installation or update/delete/insert had done in cpu and sql server.
",sql,sql-server,object,cpu,consumption,06/15/2012 01:35:10,not constructive,1,95,8,"CPU Space Occupied by Sql server objects? who? 

In Our Production server 32 GB RAM, Last week In C drive total size is 72 GB and free space 23 GB Size But This week suddenly 10 GB of resource(disk space) occupied by SQL resources So Now total size is 72 GB and free space is 13 GB only. Is any Query to find which SQL server objects(view/table/sp/triggers etc) consumes this 10 GB of CPU resource(space)? How to sort out in future? any method available ? Quick suggestions are highly appreciated....................

Note: this week no installation or update/delete/insert had done in cpu and sql server.
",5
2684621,04/21/2010 16:10:59,276535,02/18/2010 22:31:11,38,0,Sql Server related question,"I have this thing that i need to do and some advices will be greatly appreciated.
I have a Sql server table with some phone calls.For each phone call i have the start and end time.
What i need to accomplish: a stored procedure which for a certain period of time, let's say 5 hours at a x interval, lets say 2 minutes returns the number of connected calls.

    Something like:
    
    Interval                                    Nr of Calls Connected
    01-01-2010 12:00:00 - 01-01-2010 12:05:00   30
    01-01-2010 12:05:01 - 01-01-2010 12:10:00   10
    .............


Which will be the fastest way to do that? Thank you for your help",sql,server,,,,,open,0,158,4,"Sql Server related question I have this thing that i need to do and some advices will be greatly appreciated.
I have a Sql server table with some phone calls.For each phone call i have the start and end time.
What i need to accomplish: a stored procedure which for a certain period of time, let's say 5 hours at a x interval, lets say 2 minutes returns the number of connected calls.

    Something like:
    
    Interval                                    Nr of Calls Connected
    01-01-2010 12:00:00 - 01-01-2010 12:05:00   30
    01-01-2010 12:05:01 - 01-01-2010 12:10:00   10
    .............


Which will be the fastest way to do that? Thank you for your help",2
458175,01/19/2009 16:20:58,51275,01/04/2009 00:01:41,230,25,Pseudo Random in MS SQL (not NEWID() and not RAND()),"I would like to randomly sort a result in a repeatable fashion.  For this NEWID() is too random in that the same results cannot be re-obtained.  Ideally order by Rand(seed) would be great since with the same seed the same random collection would result.  But, the Rand resets with ever row anyone have a fix?




    declare @seed as int;
    set @seed = 1000;
    
    create table temp (
    id int,
    date datetime)
    
    insert into temp (id, date) values (1,'20090119')
    insert into temp (id, date) values (2,'20090118')
    insert into temp (id, date) values (3,'20090117')
    insert into temp (id, date) values (4,'20090116')
    insert into temp (id, date) values (5,'20090115')
    insert into temp (id, date) values (6,'20090114')
    
    -- re-seeds for every item
    select *, RAND() as r from temp order by r
    --1	2009-01-19 00:00:00.000	0.277720118060575
    --2	2009-01-18 00:00:00.000	0.277720118060575
    --3	2009-01-17 00:00:00.000	0.277720118060575
    --4	2009-01-16 00:00:00.000	0.277720118060575
    --5	2009-01-15 00:00:00.000	0.277720118060575
    --6	2009-01-14 00:00:00.000	0.277720118060575
    
    drop table temp
    
    -- interestingly this works:
    select RAND(@seed), RAND()
    --0.732206331499865	0.306382810665955

Note, I tried Rand(id) but that just turns out to be sorted. Apparently Rand(n) < Rand(n+1)",sql,msql,,,,,open,0,258,10,"Pseudo Random in MS SQL (not NEWID() and not RAND()) I would like to randomly sort a result in a repeatable fashion.  For this NEWID() is too random in that the same results cannot be re-obtained.  Ideally order by Rand(seed) would be great since with the same seed the same random collection would result.  But, the Rand resets with ever row anyone have a fix?




    declare @seed as int;
    set @seed = 1000;
    
    create table temp (
    id int,
    date datetime)
    
    insert into temp (id, date) values (1,'20090119')
    insert into temp (id, date) values (2,'20090118')
    insert into temp (id, date) values (3,'20090117')
    insert into temp (id, date) values (4,'20090116')
    insert into temp (id, date) values (5,'20090115')
    insert into temp (id, date) values (6,'20090114')
    
    -- re-seeds for every item
    select *, RAND() as r from temp order by r
    --1	2009-01-19 00:00:00.000	0.277720118060575
    --2	2009-01-18 00:00:00.000	0.277720118060575
    --3	2009-01-17 00:00:00.000	0.277720118060575
    --4	2009-01-16 00:00:00.000	0.277720118060575
    --5	2009-01-15 00:00:00.000	0.277720118060575
    --6	2009-01-14 00:00:00.000	0.277720118060575
    
    drop table temp
    
    -- interestingly this works:
    select RAND(@seed), RAND()
    --0.732206331499865	0.306382810665955

Note, I tried Rand(id) but that just turns out to be sorted. Apparently Rand(n) < Rand(n+1)",2
8007821,11/04/2011 10:24:14,688412,04/01/2011 23:10:33,129,4,sql - single query to return values that are not present,"For example, you have a simple table with just one column.
ie.

    CREATE TABLE movies   (title VARCHAR2(255 BYTE))

set up with the following data:

    INSERT INTO movies   (title) VALUES ('Scream');
    INSERT INTO movies   (title) VALUES ('Blair Witch');
    INSERT INTO movies   (title) VALUES ('Friday the 13th');
    INSERT INTO movies   (title) VALUES ('Scary Movie');
    INSERT INTO movies   (title) VALUES ('Hide and Seek');
    INSERT INTO movies   (title) VALUES ('Alien vs Predator');

Is there a single query or PL/SQL that will do the following dynamically (ie without having to manually do a ""UNION select 'scream' from dual..."" for every value)?

Obviously this query is wrong but you get the idea:

    Select * from movies
    where title in (
    'Scream',
    'Scary Movie',
    'Exorcist',
    'Dracula',
    'Saw',
    'Hide and Seek'
    )

Desired result being a record for every value in the ""WHERE TITLE IN"" clause where the record is not present in the table.
ie.

    'Exorcist'
    'Dracula'
    'Saw'



",sql,database,oracle,query,plsql,,open,0,216,11,"sql - single query to return values that are not present For example, you have a simple table with just one column.
ie.

    CREATE TABLE movies   (title VARCHAR2(255 BYTE))

set up with the following data:

    INSERT INTO movies   (title) VALUES ('Scream');
    INSERT INTO movies   (title) VALUES ('Blair Witch');
    INSERT INTO movies   (title) VALUES ('Friday the 13th');
    INSERT INTO movies   (title) VALUES ('Scary Movie');
    INSERT INTO movies   (title) VALUES ('Hide and Seek');
    INSERT INTO movies   (title) VALUES ('Alien vs Predator');

Is there a single query or PL/SQL that will do the following dynamically (ie without having to manually do a ""UNION select 'scream' from dual..."" for every value)?

Obviously this query is wrong but you get the idea:

    Select * from movies
    where title in (
    'Scream',
    'Scary Movie',
    'Exorcist',
    'Dracula',
    'Saw',
    'Hide and Seek'
    )

Desired result being a record for every value in the ""WHERE TITLE IN"" clause where the record is not present in the table.
ie.

    'Exorcist'
    'Dracula'
    'Saw'



",5
2645849,04/15/2010 13:51:11,25110,10/04/2008 13:14:34,151,4,SQL - suppressing duplicate *adjacent* records,"I need to run a Select statement (DB2 SQL) that does not pull adjacent row duplicates based on a certain field. In specific, I am trying to find out when data *changes*, which is made difficult because it might change back to its original value. 

That is to say, I have a table that vaguely resembles:

    A, 5, Jan  
    A, 12, Feb  
    A, 12, Mar  
    A, 12, Apr  
    A, 9, May
    A, 9, Jun  
    A, 5, Jul  

And I want to get the results:

    A, 5, Jan  
    A, 12, Feb  
    A, 9, May  
    A, 5, Jul  

discarding *adjacent* duplicates but keeping the last row. The obvious: 

    Select Letter, Number, Min(Month) from Table group by Letter, Number 

does not work -- it doesn't include the last row. 
",sql,,,,,,open,0,182,6,"SQL - suppressing duplicate *adjacent* records I need to run a Select statement (DB2 SQL) that does not pull adjacent row duplicates based on a certain field. In specific, I am trying to find out when data *changes*, which is made difficult because it might change back to its original value. 

That is to say, I have a table that vaguely resembles:

    A, 5, Jan  
    A, 12, Feb  
    A, 12, Mar  
    A, 12, Apr  
    A, 9, May
    A, 9, Jun  
    A, 5, Jul  

And I want to get the results:

    A, 5, Jan  
    A, 12, Feb  
    A, 9, May  
    A, 5, Jul  

discarding *adjacent* duplicates but keeping the last row. The obvious: 

    Select Letter, Number, Min(Month) from Table group by Letter, Number 

does not work -- it doesn't include the last row. 
",1
11038466,06/14/2012 17:41:13,356550,06/02/2010 14:38:57,1561,86,Is logging in SQL a bad practice?,"I work at an eCommerce company. Our DBA recently told me that using SQL for logging is a bad practice, and recommended a flat file and grepping instead. I had never heard that logging in SQL was a bad practice before and I don't find anything online that confirms this.

When I say logging, I mean logging user actions like signing in, changing account information, etc, and data like their user agent, ip address, account id, and event information.

While it would lead to a lot of rows over time, it makes it extremely easy to search if there is an issue with a customer.

**Is logging in SQL a bad practice, and is it preferable to log to a file?**

Thanks.",sql,tsql,logging,,,06/17/2012 05:07:21,not constructive,1,118,7,"Is logging in SQL a bad practice? I work at an eCommerce company. Our DBA recently told me that using SQL for logging is a bad practice, and recommended a flat file and grepping instead. I had never heard that logging in SQL was a bad practice before and I don't find anything online that confirms this.

When I say logging, I mean logging user actions like signing in, changing account information, etc, and data like their user agent, ip address, account id, and event information.

While it would lead to a lot of rows over time, it makes it extremely easy to search if there is an issue with a customer.

**Is logging in SQL a bad practice, and is it preferable to log to a file?**

Thanks.",3
4787104,01/24/2011 21:00:02,127659,06/23/2009 15:30:43,404,2,How to Select and Order By columns not in Groupy By SQL statement - Oracle,"I have the following statement:

    SELECT  
    	IMPORTID,Region,RefObligor,SUM(NOTIONAL) AS SUM_NOTIONAL
    From 
    	Positions
    Where
    	ID = :importID
    GROUP BY 
    	IMPORTID, Region,RefObligor
    Order BY 
    	IMPORTID, Region,RefObligor

There exists some extra columns in table `Positions` that I want as output for ""display data"" but I don't want in the group by statement.

These are `Site, Desk`

Final output would have the following columns:

    IMPORTID,Region,Site,Desk,RefObligor,SUM(NOTIONAL) AS SUM_NOTIONAL

Ideally I'd want the data sorted like:

    Order BY 
    	IMPORTID,Region,Site,Desk,RefObligor

How to achieve this?",sql,oracle,group-by,order-by,,,open,0,116,15,"How to Select and Order By columns not in Groupy By SQL statement - Oracle I have the following statement:

    SELECT  
    	IMPORTID,Region,RefObligor,SUM(NOTIONAL) AS SUM_NOTIONAL
    From 
    	Positions
    Where
    	ID = :importID
    GROUP BY 
    	IMPORTID, Region,RefObligor
    Order BY 
    	IMPORTID, Region,RefObligor

There exists some extra columns in table `Positions` that I want as output for ""display data"" but I don't want in the group by statement.

These are `Site, Desk`

Final output would have the following columns:

    IMPORTID,Region,Site,Desk,RefObligor,SUM(NOTIONAL) AS SUM_NOTIONAL

Ideally I'd want the data sorted like:

    Order BY 
    	IMPORTID,Region,Site,Desk,RefObligor

How to achieve this?",4
5836950,04/29/2011 20:15:42,724047,04/25/2011 17:02:13,25,0,SQL Query date range,"Working from an oracle 10g environment. 

Suppose you were given: *NOTE (Duration is in Weeks)

    CLASSNAME                 INSTURCTOR        DAYS     STARTDATE   *DURATION TIMESTART TIMEEND
    ------------------------- ----------------------- ------------- ---------  -------- --------
    Power Dance               Robert Backman    MWF      03-MAR-11          2 0930 	     1100
    Power Dance               Lynn Parker       MWF      03-MAY-11          2 0930 	     1100
    Power Dance               Lynn Parker       MTTh     18-MAY-11          2 1230 	     0100
    Club Stretch              Kevin Lopez	   MT       24-OCT-11          3 1930 	       2015
    Club Stretch              Kevin Lopez       F        17-JUN-11          3 1130 	     1300
    Hatha Yoga                Susan Wanzer      MW       25-MAY-11          3 1900 	     2000

A user wants to be able to query the Classname, Instructor, Timestart, and TimeEnd for a class given a specific date. 

I understand how to find the EndDate using (Duration * 7) + StartDate. The trouble I am having is finding out which classes are running on a day of the week. As in say the user enters in 24-JUN-11, the only class that should show up should be Club Stretch. ",sql,query,date,oracle10g,,,open,0,437,4,"SQL Query date range Working from an oracle 10g environment. 

Suppose you were given: *NOTE (Duration is in Weeks)

    CLASSNAME                 INSTURCTOR        DAYS     STARTDATE   *DURATION TIMESTART TIMEEND
    ------------------------- ----------------------- ------------- ---------  -------- --------
    Power Dance               Robert Backman    MWF      03-MAR-11          2 0930 	     1100
    Power Dance               Lynn Parker       MWF      03-MAY-11          2 0930 	     1100
    Power Dance               Lynn Parker       MTTh     18-MAY-11          2 1230 	     0100
    Club Stretch              Kevin Lopez	   MT       24-OCT-11          3 1930 	       2015
    Club Stretch              Kevin Lopez       F        17-JUN-11          3 1130 	     1300
    Hatha Yoga                Susan Wanzer      MW       25-MAY-11          3 1900 	     2000

A user wants to be able to query the Classname, Instructor, Timestart, and TimeEnd for a class given a specific date. 

I understand how to find the EndDate using (Duration * 7) + StartDate. The trouble I am having is finding out which classes are running on a day of the week. As in say the user enters in 24-JUN-11, the only class that should show up should be Club Stretch. ",4
11041109,06/14/2012 20:48:42,763029,05/20/2011 15:55:58,1198,94,"In-line commenting in SQL, is there a way to do that?","What if I want to make a comment within a single line in SQL? Can I do something like(to temporarily get rid of ""TargetName"":

    select SessionSID, TargetID, /* TargetName,*/ FEDSurveyName, 
    SupplierID,ClientLK_ResponseStatusID from BI_Sessions (nolock)
    		 WHERE EntryDate BETWEEN '05-15-2012' AND '05-16-2012'
                     AND SupplierID = 336 

Does any version of SQL allow us to do such commenting(preferably MSSQL)?",sql,commenting,,,,06/20/2012 03:00:07,too localized,1,87,11,"In-line commenting in SQL, is there a way to do that? What if I want to make a comment within a single line in SQL? Can I do something like(to temporarily get rid of ""TargetName"":

    select SessionSID, TargetID, /* TargetName,*/ FEDSurveyName, 
    SupplierID,ClientLK_ResponseStatusID from BI_Sessions (nolock)
    		 WHERE EntryDate BETWEEN '05-15-2012' AND '05-16-2012'
                     AND SupplierID = 336 

Does any version of SQL allow us to do such commenting(preferably MSSQL)?",2
9198967,02/08/2012 18:07:04,110161,05/20/2009 19:54:39,839,13,Oracle Analytic Preceding Returns wrong/unanticipated results,"Writing a SQL query that should return the average charges for a preceding 91 day window. I truncate the date down to the first day of the week and expect the 91 day average to be the 91 days **prior** to this date. 

However when validating it appears that the 91 day average is including the current week that I truncated. 

Query: 

    SELECT
    	week AS WEEK,
    	to_char(week,'ww-yyyy') AS Week_num
    	--Sum of the charges for the previous 91 days / 91 will give you avg charges per day for the last 91 days
    	--Need to count days regardless of if there are any charges on that day
    	,(SUM(CHARGES) OVER (ORDER BY WEEK RANGE INTERVAL '91' DAY PRECEDING))/91 MV_91_DAY_AVG
    FROM 
    ( 
    	
    	SELECT
             --Truncate date down to first of week. Goal is to make 91 day preceding being at this date.
             TRUNC(TRANS.ORIG_POST_DATE,'WW') AS WEEK
             ,SUM(TRANS.AMOUNT) AS CHARGES
    	FROM TRANS
    	WHERE
    		(TRANS.DETAIL_TYPE = 1 OR TRANS.DETAIL_TYPE = 10)
    	GROUP BY TRUNC(TRANS.ORIG_POST_DATE,'WW')
    )
    ORDER BY WEEK

Current output:
![enter image description here][1]


  [1]: http://i.stack.imgur.com/2grex.jpg",sql,oracle,date,analytics,,02/14/2012 16:24:10,too localized,1,256,6,"Oracle Analytic Preceding Returns wrong/unanticipated results Writing a SQL query that should return the average charges for a preceding 91 day window. I truncate the date down to the first day of the week and expect the 91 day average to be the 91 days **prior** to this date. 

However when validating it appears that the 91 day average is including the current week that I truncated. 

Query: 

    SELECT
    	week AS WEEK,
    	to_char(week,'ww-yyyy') AS Week_num
    	--Sum of the charges for the previous 91 days / 91 will give you avg charges per day for the last 91 days
    	--Need to count days regardless of if there are any charges on that day
    	,(SUM(CHARGES) OVER (ORDER BY WEEK RANGE INTERVAL '91' DAY PRECEDING))/91 MV_91_DAY_AVG
    FROM 
    ( 
    	
    	SELECT
             --Truncate date down to first of week. Goal is to make 91 day preceding being at this date.
             TRUNC(TRANS.ORIG_POST_DATE,'WW') AS WEEK
             ,SUM(TRANS.AMOUNT) AS CHARGES
    	FROM TRANS
    	WHERE
    		(TRANS.DETAIL_TYPE = 1 OR TRANS.DETAIL_TYPE = 10)
    	GROUP BY TRUNC(TRANS.ORIG_POST_DATE,'WW')
    )
    ORDER BY WEEK

Current output:
![enter image description here][1]


  [1]: http://i.stack.imgur.com/2grex.jpg",4
10193220,04/17/2012 14:30:01,1113251,12/23/2011 10:36:38,71,0,Return only employee types who have a presence in all countries in a subregion,"Table 1 

Employee Name,Employee type, Country Present 

Jim Mith , Consulting,England
Jim Mith, Manfacturing, Scotland
Jim Mith, Consulting, Northern Ireland
Mavis Mith, Consulting, France
Jim Mith,Consulting, Wales

Table 2 

County Present , Corresponding SubReegion 

England, UK & I 
Scotland, UK & I 
Northern Ireland, UK& I
Wales, UK & I
France, CEE

I want the Employee names who are present in all the countries for a SubRegion ONLY, not employees present in one country in a subregion of 5 countries say. For the above data the query should only return Jim Mith. 

Any ideas?

",sql,sql-server,,,,04/18/2012 04:19:32,not a real question,1,86,14,"Return only employee types who have a presence in all countries in a subregion Table 1 

Employee Name,Employee type, Country Present 

Jim Mith , Consulting,England
Jim Mith, Manfacturing, Scotland
Jim Mith, Consulting, Northern Ireland
Mavis Mith, Consulting, France
Jim Mith,Consulting, Wales

Table 2 

County Present , Corresponding SubReegion 

England, UK & I 
Scotland, UK & I 
Northern Ireland, UK& I
Wales, UK & I
France, CEE

I want the Employee names who are present in all the countries for a SubRegion ONLY, not employees present in one country in a subregion of 5 countries say. For the above data the query should only return Jim Mith. 

Any ideas?

",2
5497755,03/31/2011 09:30:00,644073,09/07/2010 11:37:33,260,22,Include error : sqlfront.h & sqldb.h,"why do i get an error when i try to include **sqlfront.h** & **sqldb.h** in my program???

Thanks",sql,sql-server,sql-server-2005,,,,open,0,17,6,"Include error : sqlfront.h & sqldb.h why do i get an error when i try to include **sqlfront.h** & **sqldb.h** in my program???

Thanks",3
2707860,04/25/2010 10:29:24,325418,05/09/2009 15:50:29,3192,104,"In SQL, can we always write an inner join statement as a main query and subquery if we only want to find the intersection?","In SQL, can we always write an inner join statement as a main query and subquery or vice versa if we only want to find the intersection?

For example,

     select * from gifts g where g.giftID in (select giftID from sentGifts);

can do a join and show the gifts sent in the sentGifts table, but it won't be able to show the sentTime because that is inside the subquery.  But if all we care is to find the intersection, without caring what is being displayed, then we can always convert one to the other?


",sql,mysql,join,subquery,inner-join,,open,0,97,24,"In SQL, can we always write an inner join statement as a main query and subquery if we only want to find the intersection? In SQL, can we always write an inner join statement as a main query and subquery or vice versa if we only want to find the intersection?

For example,

     select * from gifts g where g.giftID in (select giftID from sentGifts);

can do a join and show the gifts sent in the sentGifts table, but it won't be able to show the sentTime because that is inside the subquery.  But if all we care is to find the intersection, without caring what is being displayed, then we can always convert one to the other?


",5
9286521,02/15/2012 01:00:13,1108407,12/20/2011 17:56:55,43,1,Only show items with price over average,"My sql looks like this and i only want to show items with price over average

    SELECT COUNT(Artikelnamn) AS 'Antal Artiklar', FLOOR(SUM(Price)) AS 'Lagervrde', FLOOR(MAX(Price)) AS 'Max', FLOOR(MIN(Pris)) AS 'Min',FLOOR(AVG(Price)) AS 'Genomsnitt'
    FROM Artikel
    GROUP BY Price HAVING Price > AVG(Price);

It's especially the GROUP BY things that doesent work and I really have googled.

Sorry if some words looks stange, originally written in another language ;)",sql,sql-server,sql-server-2008,,,,open,0,74,7,"Only show items with price over average My sql looks like this and i only want to show items with price over average

    SELECT COUNT(Artikelnamn) AS 'Antal Artiklar', FLOOR(SUM(Price)) AS 'Lagervrde', FLOOR(MAX(Price)) AS 'Max', FLOOR(MIN(Pris)) AS 'Min',FLOOR(AVG(Price)) AS 'Genomsnitt'
    FROM Artikel
    GROUP BY Price HAVING Price > AVG(Price);

It's especially the GROUP BY things that doesent work and I really have googled.

Sorry if some words looks stange, originally written in another language ;)",3
3788667,09/24/2010 15:39:17,405398,07/29/2010 07:41:10,311,0,Can any one explain this SQL Query?,"Today, my boss told the below SQL query and went out without explaining it. Its working good.
But i want to know the way how it works.


`SELECT NAME FROM PERMISSIONTOKENS WHERE ID IN(SELECT TOKENID FROM ROLETOKENASSOCIATION WHERE ROLEID = '1');`


",sql,,,,,,open,0,39,7,"Can any one explain this SQL Query? Today, my boss told the below SQL query and went out without explaining it. Its working good.
But i want to know the way how it works.


`SELECT NAME FROM PERMISSIONTOKENS WHERE ID IN(SELECT TOKENID FROM ROLETOKENASSOCIATION WHERE ROLEID = '1');`


",1
8482206,12/12/2011 23:03:28,1094702,12/12/2011 22:54:24,1,0,Super nested tables,"Im having to put together as an assingment an access database for a chain of hotels.
My dilemma is this the task requires multi step downs as you progress layers.

There are 19 hotels each with different number of floors
Each floor within different hotels has different areas 
Each of these areas then has elements within it
Finally each element has items associated with it.

The idea being you have multiple combo boxes on a form where you select the hotel which the gives the appropriate floors in the next cb. A floor is selected and the areas associated with that floor for the given hotel are listed and so in till the final cb gives the items.

I'm struggling as the tables all seem to need to be many is to many relationship wise and so can't see how to nest them or if this is even the best option.

Help please",sql,database,table,access,nesting,,open,0,146,3,"Super nested tables Im having to put together as an assingment an access database for a chain of hotels.
My dilemma is this the task requires multi step downs as you progress layers.

There are 19 hotels each with different number of floors
Each floor within different hotels has different areas 
Each of these areas then has elements within it
Finally each element has items associated with it.

The idea being you have multiple combo boxes on a form where you select the hotel which the gives the appropriate floors in the next cb. A floor is selected and the areas associated with that floor for the given hotel are listed and so in till the final cb gives the items.

I'm struggling as the tables all seem to need to be many is to many relationship wise and so can't see how to nest them or if this is even the best option.

Help please",5
8987856,01/24/2012 13:45:56,302677,03/26/2010 16:06:34,17674,855,How can I find the differences between two databases?,"I am trying to copy changes from DatabaseA to DatabaseB, however I don't know exactly what those changes were.

Is there a SQL script around that will find objects that are different between the databases, then generate a script to update DatabaseB to match DatabaseA?

I'm using SQL 2005, and I don't want to lose the existing data in DatabaseB",sql,sql-server,sql-server-2005,,,01/24/2012 14:31:35,off topic,1,58,9,"How can I find the differences between two databases? I am trying to copy changes from DatabaseA to DatabaseB, however I don't know exactly what those changes were.

Is there a SQL script around that will find objects that are different between the databases, then generate a script to update DatabaseB to match DatabaseA?

I'm using SQL 2005, and I don't want to lose the existing data in DatabaseB",3
7825528,10/19/2011 17:37:32,415282,08/09/2010 16:09:01,466,12,R - query large text file using RODBC package and Microsoft Text driver,"R version: 2.12.2 / OS: Windows XP

Data that I need to query and manipulate is stored in a SPSS .sav file (size ~ 112MB) and I have a very basic knowledge of SPSS syntax.  I am much more comfortable with R (and generally prefer it for data manipulation and analysis), so I saved the SPSS file as a tab-delimited file (size ~ 85MB) and have attempted to query it using functionality from the RODBC package.

Using the 'Data Sources (ODBC)' application within the Administrative Tools group on Windows Control Panel, I setup a database (Windows folder) which has tables (tab-delimited files) with the Microsoft Text Driver.

The current table of interest has a 'Date' field (called 'DateTime') where dates are formatted '%Y/%m/%d'.  When I first tried to query the database with conditions on this field, I was returned a result set with zero observations.  So, I changed 'DateTime' to datatype 'Character' and tried my query again (to no avail).

I am able to successfully query the database, i.e.

`sqlQuery(channel = cn, query = ""SELECT * FROM large_table.txt"", as.is = TRUE, stringsAsFactors = FALSE, max = 20)` 

returns results.  The following queries return result sets with zero observations (I have verified that there is at least one record with the the value '2011/04/01' in its 'DateTime' field).

`sqlQuery(channel = cn, query = ""SELECT DateTime FROM large_table.txt WHERE DateTime = {d '2011-04-01'}"", as.is = TRUE, stringsAsFactors = FALSE)`

`sqlQuery(channel = cn, query = ""SELECT DateTime FROM large_table.txt WHERE DateTime = '2011/04/01'"", as.is = TRUE, stringsAsFactors = FALSE)`

Can anyone tell me why the result set has no observations?

Any suggestions to improve my database connection or query are greatly appreciated.  I prefer to use the RODBC package instead of another database-query package, but am willing to try something new if necessary.

",sql,r,rodbc,,,,open,0,296,13,"R - query large text file using RODBC package and Microsoft Text driver R version: 2.12.2 / OS: Windows XP

Data that I need to query and manipulate is stored in a SPSS .sav file (size ~ 112MB) and I have a very basic knowledge of SPSS syntax.  I am much more comfortable with R (and generally prefer it for data manipulation and analysis), so I saved the SPSS file as a tab-delimited file (size ~ 85MB) and have attempted to query it using functionality from the RODBC package.

Using the 'Data Sources (ODBC)' application within the Administrative Tools group on Windows Control Panel, I setup a database (Windows folder) which has tables (tab-delimited files) with the Microsoft Text Driver.

The current table of interest has a 'Date' field (called 'DateTime') where dates are formatted '%Y/%m/%d'.  When I first tried to query the database with conditions on this field, I was returned a result set with zero observations.  So, I changed 'DateTime' to datatype 'Character' and tried my query again (to no avail).

I am able to successfully query the database, i.e.

`sqlQuery(channel = cn, query = ""SELECT * FROM large_table.txt"", as.is = TRUE, stringsAsFactors = FALSE, max = 20)` 

returns results.  The following queries return result sets with zero observations (I have verified that there is at least one record with the the value '2011/04/01' in its 'DateTime' field).

`sqlQuery(channel = cn, query = ""SELECT DateTime FROM large_table.txt WHERE DateTime = {d '2011-04-01'}"", as.is = TRUE, stringsAsFactors = FALSE)`

`sqlQuery(channel = cn, query = ""SELECT DateTime FROM large_table.txt WHERE DateTime = '2011/04/01'"", as.is = TRUE, stringsAsFactors = FALSE)`

Can anyone tell me why the result set has no observations?

Any suggestions to improve my database connection or query are greatly appreciated.  I prefer to use the RODBC package instead of another database-query package, but am willing to try something new if necessary.

",3
4524019,12/24/2010 03:32:29,427484,08/22/2010 06:41:32,132,0,How to get the size of resultset in an SQL query?,"Is it possible to get the size in bytes of the results of an sql query in MySQL?

For example:

select * from sometable;

ths returns 10000 rows. I don't want the rows but the size of the resultset in bytes. Is it possible?",sql,mysql,rdbms,,,,open,0,41,11,"How to get the size of resultset in an SQL query? Is it possible to get the size in bytes of the results of an sql query in MySQL?

For example:

select * from sometable;

ths returns 10000 rows. I don't want the rows but the size of the resultset in bytes. Is it possible?",3
7104917,08/18/2011 09:07:53,900261,08/18/2011 09:07:53,1,0,Detect partial match in a table field,"I have a table with ID, CompanyName and flag fields, having thousands of records. Some of these records have the same company names but with different formats, example 
""Commercial international Bank"" similar to ""CIB""
""Europe African Bank"" similar to ""Bank of Europe Africa""

How Could I detect the match and place ""1"" in the flag field for the detected records??

Thx

",sql,duplicates,design-patterns,match,,09/03/2011 16:05:35,not a real question,1,58,7,"Detect partial match in a table field I have a table with ID, CompanyName and flag fields, having thousands of records. Some of these records have the same company names but with different formats, example 
""Commercial international Bank"" similar to ""CIB""
""Europe African Bank"" similar to ""Bank of Europe Africa""

How Could I detect the match and place ""1"" in the flag field for the detected records??

Thx

",4
5061749,02/21/2011 02:34:16,625888,02/21/2011 02:34:16,1,0,Repeat Event Calendar based - Database Design,"I have got similar question to: http://stackoverflow.com/questions/2481937/how-to-best-handle-exception-to-repeating-calendar-events.

My questions is regarding the database design.

I have some event running indefinitely however sometimes the end date is known. Lets say i am creating one event to take one medicine so i know when it is going to start but i don't know when it need to be stopped, it will depend on the progress and how the doctor advises.

Now the interesting bit is, though i will be taking medicine everyday at particular time, for some day it can CHANGE (Time, Dose etc).

So, i will have one table storing the medication name, dose, start date etc. 

Questions:
1. Should there be physical record for each day [As its subject to change on particular date]. But there can be millions of record if we start to store for each date.

2. Alternatively, i can have exception for the date user is changing the details.

3. Or i can create record for 6 months and when the time will get closer either user can increase or system will increase automatically if the event is still going.

I wonder how Google calendar handles repeat indefinably.

Your suggestion will be appreciated.

Pankaj. ",sql,ms,,,,,open,0,189,7,"Repeat Event Calendar based - Database Design I have got similar question to: http://stackoverflow.com/questions/2481937/how-to-best-handle-exception-to-repeating-calendar-events.

My questions is regarding the database design.

I have some event running indefinitely however sometimes the end date is known. Lets say i am creating one event to take one medicine so i know when it is going to start but i don't know when it need to be stopped, it will depend on the progress and how the doctor advises.

Now the interesting bit is, though i will be taking medicine everyday at particular time, for some day it can CHANGE (Time, Dose etc).

So, i will have one table storing the medication name, dose, start date etc. 

Questions:
1. Should there be physical record for each day [As its subject to change on particular date]. But there can be millions of record if we start to store for each date.

2. Alternatively, i can have exception for the date user is changing the details.

3. Or i can create record for 6 months and when the time will get closer either user can increase or system will increase automatically if the event is still going.

I wonder how Google calendar handles repeat indefinably.

Your suggestion will be appreciated.

Pankaj. ",2
761700,04/17/2009 18:44:33,53007,01/08/2009 16:57:03,1603,87,"How can I check for average concurrent events in a SQL table based on the date, time and duration of the events?","I think the data that's being requested from me is nearly impossible to get. I have a set of call detail records, and from those records, I'm supposed to determine the average concurrent active calls per system, per hour (at a precision of one minute). If I query 7pm to 8pm, I should see the average concurrent calls for the hour (averaging the concurrent calls for each minute) within that hour (for each system). 

So, I need a way to check for a count of active calls for 7:00-7:01, 7:01-7:02, etc then average those numbers. A call is considered active if the call's time and duration fall within the current minute being checked.

What makes this even more difficult is that it needs to span SQL 7.0 and SQL 2000 (some functions in 2000 aren't available in 7.0, such as GetUTCTime()), if I can just get 2000 working I'll be happy.

What approaches to this problem can I take?
----
 I thought about looping through minutes (60) in the hour being checked and adding the count of calls that fall between that minute and then somehow cross referencing the duration to make sure that a call that starts at 7:00 pm and has a duration of 300 seconds shows active at 7:04, but I can't imagine how to approach the problem. I tried to figure out a way to weight each call against particular minute that would tell me if the call was active during that minute or not, but couldn't come up with an effective solution. 

The data types here are the same as I have to query against. I don't have any control over the schema (other than possibly converting the data and inserting into another table with more appropriate data types). I've provided some example data that I know has concurrent active calls.

    CREATE TABLE Records(
      seconds char(10),
      time char(4),
      date char(8),
      dur int,
      system int,
      port int,
    )
    
    --seconds is an stime value. It's the difference of seconds from UTC 1/1/1970 00:00:00 to the current UTC time, we use it as an identifier (like epoch).
    --time is the time the call was made.
    --date is the day the call was made.
    --dur is the duration of the call in seconds.
    --system is the system number.
    --port is the port on the system (not particularly relevant for this question).
    
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924228','1923','20090416',105,2,2)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923455','1910','20090416',884,1,97)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924221','1923','20090416',116,2,15)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924259','1924','20090416',90,1,102)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923458','1910','20090416',891,2,1)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924255','1924','20090416',99,2,42)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924336','1925','20090416',20,2,58)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924293','1924','20090416',64,2,41)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923472','1911','20090416',888,2,27)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924347','1925','20090416',25,1,100)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924301','1925','20090416',77,2,55)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924332','1925','20090416',52,2,43)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924240','1924','20090416',151,1,17)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924313','1925','20090416',96,2,62)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924094','1921','20090416',315,2,16)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923643','1914','20090416',788,2,34)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924447','1927','20090416',6,2,27)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924342','1925','20090416',119,2,15)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924397','1926','20090416',76,2,41)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924457','1927','20090416',23,2,27)",sql,sql2000,sql7,algorithm,,,open,0,691,22,"How can I check for average concurrent events in a SQL table based on the date, time and duration of the events? I think the data that's being requested from me is nearly impossible to get. I have a set of call detail records, and from those records, I'm supposed to determine the average concurrent active calls per system, per hour (at a precision of one minute). If I query 7pm to 8pm, I should see the average concurrent calls for the hour (averaging the concurrent calls for each minute) within that hour (for each system). 

So, I need a way to check for a count of active calls for 7:00-7:01, 7:01-7:02, etc then average those numbers. A call is considered active if the call's time and duration fall within the current minute being checked.

What makes this even more difficult is that it needs to span SQL 7.0 and SQL 2000 (some functions in 2000 aren't available in 7.0, such as GetUTCTime()), if I can just get 2000 working I'll be happy.

What approaches to this problem can I take?
----
 I thought about looping through minutes (60) in the hour being checked and adding the count of calls that fall between that minute and then somehow cross referencing the duration to make sure that a call that starts at 7:00 pm and has a duration of 300 seconds shows active at 7:04, but I can't imagine how to approach the problem. I tried to figure out a way to weight each call against particular minute that would tell me if the call was active during that minute or not, but couldn't come up with an effective solution. 

The data types here are the same as I have to query against. I don't have any control over the schema (other than possibly converting the data and inserting into another table with more appropriate data types). I've provided some example data that I know has concurrent active calls.

    CREATE TABLE Records(
      seconds char(10),
      time char(4),
      date char(8),
      dur int,
      system int,
      port int,
    )
    
    --seconds is an stime value. It's the difference of seconds from UTC 1/1/1970 00:00:00 to the current UTC time, we use it as an identifier (like epoch).
    --time is the time the call was made.
    --date is the day the call was made.
    --dur is the duration of the call in seconds.
    --system is the system number.
    --port is the port on the system (not particularly relevant for this question).
    
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924228','1923','20090416',105,2,2)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923455','1910','20090416',884,1,97)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924221','1923','20090416',116,2,15)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924259','1924','20090416',90,1,102)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923458','1910','20090416',891,2,1)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924255','1924','20090416',99,2,42)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924336','1925','20090416',20,2,58)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924293','1924','20090416',64,2,41)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923472','1911','20090416',888,2,27)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924347','1925','20090416',25,1,100)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924301','1925','20090416',77,2,55)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924332','1925','20090416',52,2,43)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924240','1924','20090416',151,1,17)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924313','1925','20090416',96,2,62)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924094','1921','20090416',315,2,16)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923643','1914','20090416',788,2,34)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924447','1927','20090416',6,2,27)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924342','1925','20090416',119,2,15)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924397','1926','20090416',76,2,41)
    INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924457','1927','20090416',23,2,27)",4
3809229,09/28/2010 02:13:16,460100,09/28/2010 02:13:16,1,0,HTML5 readTransaction not supported on iPad (iOS 3.2)?,"I have a HTML5 app that uses websql for storing data.

Where possible, I'm using the readTransaction() method for read-only SELECT queries, and the transaction() method for INSERT/UPDATE/DELETE queries.

I'm not sure if there's a performance benefit to using readTransaction(), but it seems like the right thing to do.

The app works fine on desktop Safari, Chrome, iPhone (iOS4)...but on the iPad (iOS 3.2), it doesn't.  When I enable the debug console (Settings -> Safari -> Developer -> Debug Console), I can see that it's complaining that there's no readTransaction() method.

Can anyone confirm if the iPad only supports a subset of the HTML5 database API?  Obviously the easy fix is to change all readTransaction() calls to transaction(), but I just was wondering if anyone knows why readTransaction() doesn't work on the iPad?

I can't find any reference to this discrepancy on developer.apple.com or anywhere else.",sql,ipad,html5,ios,mobile-safari,,open,0,143,8,"HTML5 readTransaction not supported on iPad (iOS 3.2)? I have a HTML5 app that uses websql for storing data.

Where possible, I'm using the readTransaction() method for read-only SELECT queries, and the transaction() method for INSERT/UPDATE/DELETE queries.

I'm not sure if there's a performance benefit to using readTransaction(), but it seems like the right thing to do.

The app works fine on desktop Safari, Chrome, iPhone (iOS4)...but on the iPad (iOS 3.2), it doesn't.  When I enable the debug console (Settings -> Safari -> Developer -> Debug Console), I can see that it's complaining that there's no readTransaction() method.

Can anyone confirm if the iPad only supports a subset of the HTML5 database API?  Obviously the easy fix is to change all readTransaction() calls to transaction(), but I just was wondering if anyone knows why readTransaction() doesn't work on the iPad?

I can't find any reference to this discrepancy on developer.apple.com or anywhere else.",5
3818828,09/29/2010 04:55:34,255562,01/21/2010 07:22:32,1459,102,Sql server - Inserting records using OpenXML vs delimited string,"I have a bunch of employee names which need to be inserted in a table.

Should I represent my data like this and use OpenXML to insert into the database:-

    <Employees>
    <Employee>
    Emp1
    </Employee>
    <Employee>
    Emp2
    </Employee>
    <Employee>
    Emp2
    </Employee>
    </Employees>

OR

I should represent the Employee like `Emp1,Emp2,Emp3`, split the string, add to a table variable and then insert into the database table.

Are there any performance difference between the two approaches. Please note that this is very simple structure without any nesting of employees in the XML and without more than one delimiter in the string. This XML is also not going to be used as schema or anything. Would OpenXML be the overkill? Could anybody give some direction on this? 
",sql,server,openxml,,,,open,0,153,10,"Sql server - Inserting records using OpenXML vs delimited string I have a bunch of employee names which need to be inserted in a table.

Should I represent my data like this and use OpenXML to insert into the database:-

    <Employees>
    <Employee>
    Emp1
    </Employee>
    <Employee>
    Emp2
    </Employee>
    <Employee>
    Emp2
    </Employee>
    </Employees>

OR

I should represent the Employee like `Emp1,Emp2,Emp3`, split the string, add to a table variable and then insert into the database table.

Are there any performance difference between the two approaches. Please note that this is very simple structure without any nesting of employees in the XML and without more than one delimiter in the string. This XML is also not going to be used as schema or anything. Would OpenXML be the overkill? Could anybody give some direction on this? 
",3
3788470,09/24/2010 15:17:00,311509,04/08/2010 01:12:42,131,0,How Can I Rid off Redundant Values from a Column?,"This is the sample output![alt text][1]

Let me explain what's going on:

The query returns all invoices # of every year along with the products
that is involved in the invoice.

As you see, we have two invoice in 2010...The invoices are 30463 and 30516.
The invoice 30463 has 4 products, its shipping price is 105.88. As you see
the shipping price is repeated on every product which causes troubles when
i calculate sum at reporting level. The 4 products of invoice # 30463 has
shipping price of 105.00 overall. I want every shipping price of every invoice
to be shown only once regardless how many products within an invoice. How can i achieve it?


  [1]: http://i.stack.imgur.com/s7RQV.jpg


HERE IS THE QUERY:

    SELECT 
          DATEPART(year, CustomerInvDetail.sentDate) AS ""Year"", 
          CustomerInvoice.cuInvoiceID,  
          Product.productName, 
          CustomerQuoteProducts.unitPrice, 
          CustomerQuoteProducts.qty, 
          CustomerQuoteProducts.qty * CustomerQuoteProducts.unitPrice AS ""Price"",
          CustomerShipping.shippingPrice
    FROM  CustomerInvoice INNER JOIN CustomerInvDetail 
          ON CustomerInvoice.cuInvoiceID = CustomerInvDetail.cuInvoiceID
          INNER JOIN CustomerQuote 
          ON CustomerQuote.customerQuoteID = CustomerInvoice.customerQuoteID
          INNER JOIN CustomerQuoteProducts 
          ON CustomerQuoteProducts.customerQuoteID = CustomerQuote.customerQuoteID
          INNER JOIN CustomerShipping 
          ON CustomerShipping.customerQuoteID = CustomerInvoice.customerQuoteID
          INNER JOIN Customer 
          ON Customer.customerID = CustomerQuote.customerID
          INNER JOIN Product 
          ON CustomerQuoteProducts.productID = Product.productID
    WHERE (DATEPART(year, CustomerInvDetail.sentDate) BETWEEN 2001 AND 2022) AND (Customer.customerID = 500)


",sql,sql-server,sql-server-2005,tsql,sql-server-2008,,open,0,367,10,"How Can I Rid off Redundant Values from a Column? This is the sample output![alt text][1]

Let me explain what's going on:

The query returns all invoices # of every year along with the products
that is involved in the invoice.

As you see, we have two invoice in 2010...The invoices are 30463 and 30516.
The invoice 30463 has 4 products, its shipping price is 105.88. As you see
the shipping price is repeated on every product which causes troubles when
i calculate sum at reporting level. The 4 products of invoice # 30463 has
shipping price of 105.00 overall. I want every shipping price of every invoice
to be shown only once regardless how many products within an invoice. How can i achieve it?


  [1]: http://i.stack.imgur.com/s7RQV.jpg


HERE IS THE QUERY:

    SELECT 
          DATEPART(year, CustomerInvDetail.sentDate) AS ""Year"", 
          CustomerInvoice.cuInvoiceID,  
          Product.productName, 
          CustomerQuoteProducts.unitPrice, 
          CustomerQuoteProducts.qty, 
          CustomerQuoteProducts.qty * CustomerQuoteProducts.unitPrice AS ""Price"",
          CustomerShipping.shippingPrice
    FROM  CustomerInvoice INNER JOIN CustomerInvDetail 
          ON CustomerInvoice.cuInvoiceID = CustomerInvDetail.cuInvoiceID
          INNER JOIN CustomerQuote 
          ON CustomerQuote.customerQuoteID = CustomerInvoice.customerQuoteID
          INNER JOIN CustomerQuoteProducts 
          ON CustomerQuoteProducts.customerQuoteID = CustomerQuote.customerQuoteID
          INNER JOIN CustomerShipping 
          ON CustomerShipping.customerQuoteID = CustomerInvoice.customerQuoteID
          INNER JOIN Customer 
          ON Customer.customerID = CustomerQuote.customerID
          INNER JOIN Product 
          ON CustomerQuoteProducts.productID = Product.productID
    WHERE (DATEPART(year, CustomerInvDetail.sentDate) BETWEEN 2001 AND 2022) AND (Customer.customerID = 500)


",5
9809823,03/21/2012 17:32:26,1072081,11/29/2011 19:49:26,48,0,Script to find text datatypes in SQL Server,"I have a few thousand tables in my SQL Server instance, and I need to start converted old deprecated datatypes into the new version (text to varchar(max)). Is it possible to script this out so I can just run select statement to find all of these without manually going through each of the tables in the database instance? TIA",sql,sql-server-2008,tsql,,,,open,0,59,8,"Script to find text datatypes in SQL Server I have a few thousand tables in my SQL Server instance, and I need to start converted old deprecated datatypes into the new version (text to varchar(max)). Is it possible to script this out so I can just run select statement to find all of these without manually going through each of the tables in the database instance? TIA",3
10674761,05/20/2012 15:31:56,286364,03/04/2010 15:22:10,79,5,Difference between SQL View and WITH clause,"Can anybody in here tell me the difference of VIEW and WITH, as I have searched many placed and I can't find anything about it. <br />
My thoughts is that VIEW and WITH are the same, except for VIEWs is saved as a Schema-object, but I can be wrong",sql,sql-view,,,,,open,0,49,7,"Difference between SQL View and WITH clause Can anybody in here tell me the difference of VIEW and WITH, as I have searched many placed and I can't find anything about it. <br />
My thoughts is that VIEW and WITH are the same, except for VIEWs is saved as a Schema-object, but I can be wrong",2
8795327,01/09/2012 21:18:47,1050454,11/16/2011 20:16:32,18,0,"Access 2003 VBA SQL ""Too few parameters"" error","    Dim sort_slots_sql As String
    sort_slots_sql = _
        ""select date, part, service, slot"" & _
        "" from ass_slots, ass_occasions"" & _
        "" where ass_slots.occasion = ass_occasions.occasion"" & _
        "" order by slot, service, date, part""
    Set slots_rst = db.OpenRecordset(sort_slots_sql)

This gives a too few parameters error. One is expected. On another place in the code, there is an almost identical situation but there, _two_ parameters are expected!",sql,vba,access,,,,open,0,103,8,"Access 2003 VBA SQL ""Too few parameters"" error     Dim sort_slots_sql As String
    sort_slots_sql = _
        ""select date, part, service, slot"" & _
        "" from ass_slots, ass_occasions"" & _
        "" where ass_slots.occasion = ass_occasions.occasion"" & _
        "" order by slot, service, date, part""
    Set slots_rst = db.OpenRecordset(sort_slots_sql)

This gives a too few parameters error. One is expected. On another place in the code, there is an almost identical situation but there, _two_ parameters are expected!",3
9359098,02/20/2012 09:50:33,1220691,02/20/2012 09:47:22,1,0,"Incorrect syntax near ','.","I've been spending like a whole day just to figure out what is wrong with my coding. Can someone tell me what should i alter just to make my coding working. Thanksssss :)


SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[""Connection""].ConnectionString);
        SqlCommand cmd = new SqlCommand(""Insert into ExpTab (username,month,ex1,p1,ex2,p2,ex3,p3,ex4,p4,ex5,p5,ex6,p6,ex7,p7,ex8,p8,,p3,p4,p5,p6,p7,p8) Values (@name,@month1,@ex1s,@p1s,@ex2s,@p2s,@ex3s,@p3s,@ex4s,@p4s,@ex5s,@p5s,@ex6s,@p6s,@ex7s,@p7s,@ex8s,@p8s)"", conn);

        cmd.CommandType = CommandType.Text;
        cmd.Parameters.AddWithValue(""@name"", Membership.GetUser().UserName);
        cmd.Parameters.AddWithValue(""@month1"", Label1.Text);
        cmd.Parameters.AddWithValue(""@ex1s"", Label18.Text);
        cmd.Parameters.AddWithValue(""@p1s"", Label20.Text);
        cmd.Parameters.AddWithValue(""@ex2s"", Label2.Text);
        cmd.Parameters.AddWithValue(""@p2s"", Label21.Text);
        cmd.Parameters.AddWithValue(""@ex3s"", Label3.Text);
        cmd.Parameters.AddWithValue(""@p3s"", Label22.Text);
        cmd.Parameters.AddWithValue(""@ex4s"", Label4.Text);
        cmd.Parameters.AddWithValue(""@p4s"", Label23.Text);
        cmd.Parameters.AddWithValue(""@ex5s"", Label5.Text);
        cmd.Parameters.AddWithValue(""@p5s"", Label24.Text);
        cmd.Parameters.AddWithValue(""@ex6s"", Label6.Text);
        cmd.Parameters.AddWithValue(""@p6s"", Label25.Text);
        cmd.Parameters.AddWithValue(""@ex7s"", Label7.Text);
        cmd.Parameters.AddWithValue(""@p7s"", Label26.Text);
        cmd.Parameters.AddWithValue(""@ex8s"", Label8.Text);     
        cmd.Parameters.AddWithValue(""@p8s"", Label27.Text);
       
        conn.Open();
        cmd.ExecuteNonQuery();

I really need help :(",sql,asp-classic,,,,02/22/2012 05:27:53,too localized,1,259,4,"Incorrect syntax near ','. I've been spending like a whole day just to figure out what is wrong with my coding. Can someone tell me what should i alter just to make my coding working. Thanksssss :)


SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[""Connection""].ConnectionString);
        SqlCommand cmd = new SqlCommand(""Insert into ExpTab (username,month,ex1,p1,ex2,p2,ex3,p3,ex4,p4,ex5,p5,ex6,p6,ex7,p7,ex8,p8,,p3,p4,p5,p6,p7,p8) Values (@name,@month1,@ex1s,@p1s,@ex2s,@p2s,@ex3s,@p3s,@ex4s,@p4s,@ex5s,@p5s,@ex6s,@p6s,@ex7s,@p7s,@ex8s,@p8s)"", conn);

        cmd.CommandType = CommandType.Text;
        cmd.Parameters.AddWithValue(""@name"", Membership.GetUser().UserName);
        cmd.Parameters.AddWithValue(""@month1"", Label1.Text);
        cmd.Parameters.AddWithValue(""@ex1s"", Label18.Text);
        cmd.Parameters.AddWithValue(""@p1s"", Label20.Text);
        cmd.Parameters.AddWithValue(""@ex2s"", Label2.Text);
        cmd.Parameters.AddWithValue(""@p2s"", Label21.Text);
        cmd.Parameters.AddWithValue(""@ex3s"", Label3.Text);
        cmd.Parameters.AddWithValue(""@p3s"", Label22.Text);
        cmd.Parameters.AddWithValue(""@ex4s"", Label4.Text);
        cmd.Parameters.AddWithValue(""@p4s"", Label23.Text);
        cmd.Parameters.AddWithValue(""@ex5s"", Label5.Text);
        cmd.Parameters.AddWithValue(""@p5s"", Label24.Text);
        cmd.Parameters.AddWithValue(""@ex6s"", Label6.Text);
        cmd.Parameters.AddWithValue(""@p6s"", Label25.Text);
        cmd.Parameters.AddWithValue(""@ex7s"", Label7.Text);
        cmd.Parameters.AddWithValue(""@p7s"", Label26.Text);
        cmd.Parameters.AddWithValue(""@ex8s"", Label8.Text);     
        cmd.Parameters.AddWithValue(""@p8s"", Label27.Text);
       
        conn.Open();
        cmd.ExecuteNonQuery();

I really need help :(",2
11733359,07/31/2012 04:58:45,1386445,05/10/2012 07:37:56,6,0,how to uninstall sql 2008 multiple instances without restarting server ?,"how to uninstall sql 2008 multiple instances without restarting  server ?

SQl installer failing with error : server need restart after one instance uninstalled . 

Its not practical for us to  restrart the server to uninstall every single instance, thank you . ",sql,sql-server-2008-r2,,,,07/31/2012 15:16:25,off topic,1,44,11,"how to uninstall sql 2008 multiple instances without restarting server ? how to uninstall sql 2008 multiple instances without restarting  server ?

SQl installer failing with error : server need restart after one instance uninstalled . 

Its not practical for us to  restrart the server to uninstall every single instance, thank you . ",2
6714421,07/16/2011 00:17:06,335876,05/07/2010 22:20:48,74,1,What duration (in ms) is considered good for crud operations?,"I am using a profiler to determine the speed of my sql operations but am not sure what duration in milliseconds is considered good and what speed is bad? If its bad I can alter the query or fetchplan. So far I have anything ranging from 1 - 44 ms, with two outliers at 110ms.

I have a ms sql compact 3.5 database, using Telerik Open Access and its Open Access Profiler (which is pretty good btw). My application is a WPF desktop app.",sql,profiling,sql-server-ce,telerik-open-access,,07/17/2011 04:21:58,not constructive,1,83,10,"What duration (in ms) is considered good for crud operations? I am using a profiler to determine the speed of my sql operations but am not sure what duration in milliseconds is considered good and what speed is bad? If its bad I can alter the query or fetchplan. So far I have anything ranging from 1 - 44 ms, with two outliers at 110ms.

I have a ms sql compact 3.5 database, using Telerik Open Access and its Open Access Profiler (which is pretty good btw). My application is a WPF desktop app.",4
11203254,06/26/2012 08:14:52,155077,08/12/2009 13:22:25,5676,261,How to create a read-only user in PostGreSQL ?,"Question:

I want to create a read-only user in PostGreSQL.
The intention is to have a publicly accessible data explorer, where users can write custom SQL queries.


I do this to create the user:

    CREATE USER MyReadOnlyUser WITH ENCRYPTED PASSWORD 'MY_WEAK_PASSWORD';
    
    GRANT ALL PRIVILEGES ON DATABASE ""MY_DB_NAME"" to MyReadOnlyUser;
    
    GRANT ALL ON SCHEMA public TO MyReadOnlyUser; 
    GRANT SELECT ON ALL TABLES IN SCHEMA public TO MyReadOnlyUser; 

The intention is to give the user SELECT access to all tables, then revoke select access on the sensitive tables, and then the user can run custom queries with that db user, without any need for me to sanitize input.

Especially, he may not: 

    insert, delete, drop database, see stored procedure / functions sources & table column definitions.

Sooo - now my question:<br />
Why does this user have access to information_schema ? <br />
It wasn't granted access to any views...",sql,postgresql,postgresql-9.1,postgresql-8.4,postgresql-9.0,,open,0,166,9,"How to create a read-only user in PostGreSQL ? Question:

I want to create a read-only user in PostGreSQL.
The intention is to have a publicly accessible data explorer, where users can write custom SQL queries.


I do this to create the user:

    CREATE USER MyReadOnlyUser WITH ENCRYPTED PASSWORD 'MY_WEAK_PASSWORD';
    
    GRANT ALL PRIVILEGES ON DATABASE ""MY_DB_NAME"" to MyReadOnlyUser;
    
    GRANT ALL ON SCHEMA public TO MyReadOnlyUser; 
    GRANT SELECT ON ALL TABLES IN SCHEMA public TO MyReadOnlyUser; 

The intention is to give the user SELECT access to all tables, then revoke select access on the sensitive tables, and then the user can run custom queries with that db user, without any need for me to sanitize input.

Especially, he may not: 

    insert, delete, drop database, see stored procedure / functions sources & table column definitions.

Sooo - now my question:<br />
Why does this user have access to information_schema ? <br />
It wasn't granted access to any views...",5
9094342,02/01/2012 10:34:19,907828,08/23/2011 13:45:46,53,1,How to create oracle procedures but not store,"I want to use some smart procedures I wrote, but not store them. For example here is this quite big select, that retrieves the primary keys for a table:

    SELECT cols.table_name, cols.column_name, cols.position, cons.status, cons.owner
    FROM all_constraints cons, all_cons_columns cols
    WHERE cols.table_name = 'TABLE_NAME'
    AND cons.constraint_type = 'P'
    AND cons.constraint_name = cols.constraint_name
    AND cons.owner = cols.owner
    ORDER BY cols.table_name, cols.position;

I don't want to remember this, not even type it every time I need the constraints of a table. BUT I don't want to create a procedure for this into the DB, because it is a prod DB, and noone else needs my procedure. Just me. Just for developing.

So here is where I am now:

    SQL> declare procedure hello as begin dbms_output.put_line('Hello world!'); end; begin hello; end;
      2  /
    Hello world!
    
    PL/SQL procedure successfully completed.
  
    SQL> hello;
    SP2-0042: unknown command ""hello"" - rest of line ignored.

... so I can declare and define hello function from command line. I can call it from the begin - end block after the declare, but after that the hello procedure is gone.

Question: is there a solution to make the second ""hello;"" work, so I can create clever and useful procedures and not make any trash in the DB itself?

If this would work, I would create a file with that, and make the alias for sqlplus to execute that file at startup.",sql,oracle,procedure,,,,open,0,274,8,"How to create oracle procedures but not store I want to use some smart procedures I wrote, but not store them. For example here is this quite big select, that retrieves the primary keys for a table:

    SELECT cols.table_name, cols.column_name, cols.position, cons.status, cons.owner
    FROM all_constraints cons, all_cons_columns cols
    WHERE cols.table_name = 'TABLE_NAME'
    AND cons.constraint_type = 'P'
    AND cons.constraint_name = cols.constraint_name
    AND cons.owner = cols.owner
    ORDER BY cols.table_name, cols.position;

I don't want to remember this, not even type it every time I need the constraints of a table. BUT I don't want to create a procedure for this into the DB, because it is a prod DB, and noone else needs my procedure. Just me. Just for developing.

So here is where I am now:

    SQL> declare procedure hello as begin dbms_output.put_line('Hello world!'); end; begin hello; end;
      2  /
    Hello world!
    
    PL/SQL procedure successfully completed.
  
    SQL> hello;
    SP2-0042: unknown command ""hello"" - rest of line ignored.

... so I can declare and define hello function from command line. I can call it from the begin - end block after the declare, but after that the hello procedure is gone.

Question: is there a solution to make the second ""hello;"" work, so I can create clever and useful procedures and not make any trash in the DB itself?

If this would work, I would create a file with that, and make the alias for sqlplus to execute that file at startup.",3
618928,03/06/2009 13:54:41,53341,01/09/2009 13:56:08,712,50,Commiting a specific INSERT inside a TRANSACTION which may ROLLBACK,"Is this possible in SQL Server 2005, and if so, how? :)

    BEGIN TRANSACTION  

    -- This insert should commit, even if the transaction rolls back  
    INSERT INTO dbo.log (fields) SELECT fields  

    -- This insert should roll back if the transaction rolls back  
    INSERT INTO dbo.table (fields) SELECT field  

    EXEC @myvar = myProc @parameters  

    IF @myvar <> 0  
       ROLLBACK TRANSACTION  
    ELSE  
       COMMIT TRANSACTION  



Also, is there a way to lock only the rows being inserted into the tables, rather than the whole table?  (The tables have identity columns which is preventing this)


Cheers,  
Dems.",sql,sql-server-2005,transactions,transaction-isolation,locking,,open,0,149,10,"Commiting a specific INSERT inside a TRANSACTION which may ROLLBACK Is this possible in SQL Server 2005, and if so, how? :)

    BEGIN TRANSACTION  

    -- This insert should commit, even if the transaction rolls back  
    INSERT INTO dbo.log (fields) SELECT fields  

    -- This insert should roll back if the transaction rolls back  
    INSERT INTO dbo.table (fields) SELECT field  

    EXEC @myvar = myProc @parameters  

    IF @myvar <> 0  
       ROLLBACK TRANSACTION  
    ELSE  
       COMMIT TRANSACTION  



Also, is there a way to lock only the rows being inserted into the tables, rather than the whole table?  (The tables have identity columns which is preventing this)


Cheers,  
Dems.",5
11546750,07/18/2012 17:10:39,1535256,07/18/2012 15:05:07,1,0,How to get Table B from Table A? Thanks,"Table A:

AB
BC
CD
EF
FG


Table B: 

AD
BD
CD
EG
FG

I have tried multiple ways but the query is too long and would like to find a simplified method. Thanks so much.",sql,,,,,07/19/2012 14:47:35,not a real question,1,25,9,"How to get Table B from Table A? Thanks Table A:

AB
BC
CD
EF
FG


Table B: 

AD
BD
CD
EG
FG

I have tried multiple ways but the query is too long and would like to find a simplified method. Thanks so much.",1
10335420,04/26/2012 14:22:23,1253545,03/07/2012 00:43:45,1,1,Comparison Operators with Date/Time value in Access,"I'm writing a utility in C#.NET that accesses an .MDB file and retrieves shipping records, which have fields of type Date/Time (values in the database are stored in MM/dd/yyyy format). 

The query below returns a valid result:

    SELECT Req_Ship, Actual_Ship
    FROM Operations
    WHERE Received BETWEEN #date1# AND #date2#;

(where _date1_ and _date2_ are arbitrary dates in MM/dd/yyyy format; Req_Ship, Actual_Ship, and Received are all of Access type Date/Time in Operations).

I have several other queries in a similar structure as the one above. However, not all of the standard comparison operators work.

These comparison operators return a valid result:

    = (EQUALS)
    BETWEEN (BETWEEN)

However, these comparison operators throw an Exception, with the error message ""Specified cast is not valid.""

    > (GREATER THAN)
    < (LESS THAN)
    <> (NOT EQUALS)
    NOT BETWEEN (NOT BETWEEN)

Is my query syntax incorrect, or are these operators just incompatible with Access Date/Time values? If there is a way to use these comparison operators or another equivalent with Date/Time values, it would make writing this utility a lot easier.

Thanks in advance for the help,

-Max",sql,ms-access,datetime,comparison,access,05/01/2012 04:14:10,too localized,1,199,7,"Comparison Operators with Date/Time value in Access I'm writing a utility in C#.NET that accesses an .MDB file and retrieves shipping records, which have fields of type Date/Time (values in the database are stored in MM/dd/yyyy format). 

The query below returns a valid result:

    SELECT Req_Ship, Actual_Ship
    FROM Operations
    WHERE Received BETWEEN #date1# AND #date2#;

(where _date1_ and _date2_ are arbitrary dates in MM/dd/yyyy format; Req_Ship, Actual_Ship, and Received are all of Access type Date/Time in Operations).

I have several other queries in a similar structure as the one above. However, not all of the standard comparison operators work.

These comparison operators return a valid result:

    = (EQUALS)
    BETWEEN (BETWEEN)

However, these comparison operators throw an Exception, with the error message ""Specified cast is not valid.""

    > (GREATER THAN)
    < (LESS THAN)
    <> (NOT EQUALS)
    NOT BETWEEN (NOT BETWEEN)

Is my query syntax incorrect, or are these operators just incompatible with Access Date/Time values? If there is a way to use these comparison operators or another equivalent with Date/Time values, it would make writing this utility a lot easier.

Thanks in advance for the help,

-Max",5
7552550,09/26/2011 08:35:06,840145,07/12/2011 06:16:10,79,0,renaming a temporary table into a physical one,"Can I do something like this?


create table #tbl_tmp (col1 int)

insert into #tbl_tmp select 3

exec sp_rename '#tbl_tmp','tbl_new'

",sql,sql-server,sql-server-2008,,,,open,0,16,8,"renaming a temporary table into a physical one Can I do something like this?


create table #tbl_tmp (col1 int)

insert into #tbl_tmp select 3

exec sp_rename '#tbl_tmp','tbl_new'

",3
7826545,10/19/2011 18:53:55,618677,02/15/2011 22:26:28,73,3,SQL INNER JOIN ON and USING,"Say I have a tables and I join them with inner join. What is the advantage of using ""ON"" over ""USING"". Or are they the same in all sense?",sql,,,,,,open,0,29,6,"SQL INNER JOIN ON and USING Say I have a tables and I join them with inner join. What is the advantage of using ""ON"" over ""USING"". Or are they the same in all sense?",1
5464887,03/28/2011 20:49:06,680942,03/28/2011 20:49:06,1,0,MySql Query Grouping by Time,"I am trying to create a report to understand the time-of-day that orders are being placed, so I need to sum and group them by time.  For example, I would like a sum of all orders placed between 1 and 1:59, then the next row listing the sum of all orders between 2:00 and 2:59, etc.  The field is a datetime variable, but for the life me I haven't been able to find the right query to do this.  Any suggestions sending me down the right path would be greatly appreciated.

Thanks

",sql,query,count,group-by,sum,,open,0,94,5,"MySql Query Grouping by Time I am trying to create a report to understand the time-of-day that orders are being placed, so I need to sum and group them by time.  For example, I would like a sum of all orders placed between 1 and 1:59, then the next row listing the sum of all orders between 2:00 and 2:59, etc.  The field is a datetime variable, but for the life me I haven't been able to find the right query to do this.  Any suggestions sending me down the right path would be greatly appreciated.

Thanks

",5
3075395,06/19/2010 12:02:30,141579,07/20/2009 18:41:00,152,4,help for a JOIN query ,"i've this 3 following table

    table ads
    ...
    categoryID
    subcategoryID

  
    table category
    categoryID
    description

    table subcategory
    subCategoryID
    description

How can i JOIN this 3 table to have all field from ADS and category description and also subcategory description... 

(when i use sql server, i can ""design"" the relations, but now, i'm using mysql and i haven't a graphical environment to do it.. and i'm not good to write the sql) 

THanks in advance
",sql,,,,,,open,0,104,6,"help for a JOIN query  i've this 3 following table

    table ads
    ...
    categoryID
    subcategoryID

  
    table category
    categoryID
    description

    table subcategory
    subCategoryID
    description

How can i JOIN this 3 table to have all field from ADS and category description and also subcategory description... 

(when i use sql server, i can ""design"" the relations, but now, i'm using mysql and i haven't a graphical environment to do it.. and i'm not good to write the sql) 

THanks in advance
",1
7337088,09/07/2011 16:11:01,888766,08/10/2011 21:09:15,15,1,SQL Query Choose last record,"Salut!

I have a Table in MSSQL base with the following structure:

ID_Period, ID_Club, DateStart, DateEnd, Cash, Less, InWay

1, 1, 2010-08-01, 2010-08-31, 0, 0, 0

2, 1, 2010-08-01, 2010-08-31, 166013.01, 343697.42, 748231.00

3, 2, 2010-08-01, 2010-08-31, 0, 0, 0

4, 2, 2010-08-01, 2010-08-31, 331408.11, 6981028.26, 738000.00




I wanna make query, that will choose last records, that are earlier, than the parameter date 
I enter, grouped by ID_Club, it means, that the result of the query will be like:

2, 1, 166013.01, 343697.42, 748231.00, 2010-02-28,

4, 2, 331408.11, 6981028.26, 738000.00, 2011-02-28,

etc...

I can make similar query not with last record, but with sum. It looks like:

    select ID_Club, SUM(Cash), SUM(Less), SUM(InWay) from dbo.Period where DateEnd<'2011-03-01' GROUP BY ID_Club


  [1]: http://i.stack.imgur.com/vVkc9.jpg",sql,query,,,,,open,0,114,5,"SQL Query Choose last record Salut!

I have a Table in MSSQL base with the following structure:

ID_Period, ID_Club, DateStart, DateEnd, Cash, Less, InWay

1, 1, 2010-08-01, 2010-08-31, 0, 0, 0

2, 1, 2010-08-01, 2010-08-31, 166013.01, 343697.42, 748231.00

3, 2, 2010-08-01, 2010-08-31, 0, 0, 0

4, 2, 2010-08-01, 2010-08-31, 331408.11, 6981028.26, 738000.00




I wanna make query, that will choose last records, that are earlier, than the parameter date 
I enter, grouped by ID_Club, it means, that the result of the query will be like:

2, 1, 166013.01, 343697.42, 748231.00, 2010-02-28,

4, 2, 331408.11, 6981028.26, 738000.00, 2011-02-28,

etc...

I can make similar query not with last record, but with sum. It looks like:

    select ID_Club, SUM(Cash), SUM(Less), SUM(InWay) from dbo.Period where DateEnd<'2011-03-01' GROUP BY ID_Club


  [1]: http://i.stack.imgur.com/vVkc9.jpg",2
6271350,06/07/2011 20:39:40,658890,03/14/2011 13:47:36,8,0,Preventing SQL Max function from using timestamp as part of criteria on a date column,"If I query:

    select max(date_created) date_created

on a datefield, and there are records that were created on the same date but at different times, Max() returns only the latest times on that date.  What I would like to do is have the times be ignored and return ALL records that match the max date, regardless of their associated timestamp in that column.  What is the best practice for doing this?",sql,datetime,max,,,,open,0,74,15,"Preventing SQL Max function from using timestamp as part of criteria on a date column If I query:

    select max(date_created) date_created

on a datefield, and there are records that were created on the same date but at different times, Max() returns only the latest times on that date.  What I would like to do is have the times be ignored and return ALL records that match the max date, regardless of their associated timestamp in that column.  What is the best practice for doing this?",3
7797879,10/17/2011 18:23:48,408141,08/01/2010 21:42:52,342,3,Get file name that contains the object,Is there a way to find out the name of the file contains an object(table/view/trigger/etc.) given by its name?,sql,oracle,,,,10/17/2011 20:48:20,not a real question,1,19,7,Get file name that contains the object Is there a way to find out the name of the file contains an object(table/view/trigger/etc.) given by its name?,2
25460,08/24/2008 23:43:00,1704,08/18/2008 05:42:19,1,0,Asynchronous Stored Procedure Calls,Is it possible to call a stored prodcedure from another stored procedure asynchronously?,sql,stored-procedures,,,,,open,0,13,4,Asynchronous Stored Procedure Calls Is it possible to call a stored prodcedure from another stored procedure asynchronously?,2
7074750,08/16/2011 07:15:54,210756,11/13/2009 21:37:25,162,4,SQL Query help - 10 records for each distinct column value,"I have a cars table which contains car listings.
The table structure looks something like:

     cars
       - id
       - title
       - make
       - year


I would like a query which returns 10 cars of each make.

Something equivalent to the following pseudo code:

    car_makes = select distinct make from cars
    for each make in car_makes 
      select id, title, make from clcars where make = $make limit 10;
    end

Here's what I've tried unsuccessfully:
      
    select id,title,make 
    from cars where make in 
                        (select distinct make from cars) 
    group by make;

 --- This returns only one record per make.


    select a.id,a.title,a.make 
    from cars a left join  
     (select distinct make from cars) car_make 
       on a.make = car_make.make;

This returns every record.

I need only 10 records per car make.

Thanks for your help",sql,,,,,,open,0,226,11,"SQL Query help - 10 records for each distinct column value I have a cars table which contains car listings.
The table structure looks something like:

     cars
       - id
       - title
       - make
       - year


I would like a query which returns 10 cars of each make.

Something equivalent to the following pseudo code:

    car_makes = select distinct make from cars
    for each make in car_makes 
      select id, title, make from clcars where make = $make limit 10;
    end

Here's what I've tried unsuccessfully:
      
    select id,title,make 
    from cars where make in 
                        (select distinct make from cars) 
    group by make;

 --- This returns only one record per make.


    select a.id,a.title,a.make 
    from cars a left join  
     (select distinct make from cars) car_make 
       on a.make = car_make.make;

This returns every record.

I need only 10 records per car make.

Thanks for your help",1
9996655,04/03/2012 15:36:26,1243960,03/01/2012 23:30:42,25,0,Fastest way to loop through SQL table and execute multiple queries,"I'm using the solution provided by one of the members here to loop through all records (currently about a 1000) and execute roughly 60 SELECT queries for each record. That comes out to roughly 60,000 calculations. This is done once a day. My concern is whether this ""loop through"" for all the records is the most efficient and fastest in this case. Special thanks to marc_s for providing the solution below. Thanks for your answers!


    DECLARE @LastCustomerID CHAR(10)
    SET @LastCustomerID = 0

    -- define the customer ID to be handled now
    DECLARE @CustomerIDToHandle CHAR(10)

    -- select the next customer to handle    
    SELECT TOP 1 @CustomerIDToHandle = bl_id
    FROM dbo.bl
    WHERE bl_id > @LastCustomerID AND status = 'a'
    ORDER BY bl_id

    -- as long as we have customers......    
    WHILE @CustomerIDToHandle IS NOT NULL
    BEGIN
        -- call your sproc. this is where i have the 60 SQL SELECT queries defined 
        -- in another stored procedure called myStoredProc. it just takes the parameter
        -- @CustomerIDToHandle provided here and uses it in the where clauses
        
        EXEC myStoredProc @CustomerIDToHandle

        -- set the last customer handled to the one we just handled
        SET @LastCustomerID = @CustomerIDToHandle
        SET @CustomerIDToHandle = NULL

        -- select the next customer to handle    
        SELECT TOP 1 @CustomerIDToHandle = bl_id
        FROM dbo.bl
        WHERE bl_id > @LastCustomerID AND status = 'a'
        ORDER BY bl_id
    END

",sql,database,query,select,loops,04/04/2012 15:50:04,too localized,1,365,11,"Fastest way to loop through SQL table and execute multiple queries I'm using the solution provided by one of the members here to loop through all records (currently about a 1000) and execute roughly 60 SELECT queries for each record. That comes out to roughly 60,000 calculations. This is done once a day. My concern is whether this ""loop through"" for all the records is the most efficient and fastest in this case. Special thanks to marc_s for providing the solution below. Thanks for your answers!


    DECLARE @LastCustomerID CHAR(10)
    SET @LastCustomerID = 0

    -- define the customer ID to be handled now
    DECLARE @CustomerIDToHandle CHAR(10)

    -- select the next customer to handle    
    SELECT TOP 1 @CustomerIDToHandle = bl_id
    FROM dbo.bl
    WHERE bl_id > @LastCustomerID AND status = 'a'
    ORDER BY bl_id

    -- as long as we have customers......    
    WHILE @CustomerIDToHandle IS NOT NULL
    BEGIN
        -- call your sproc. this is where i have the 60 SQL SELECT queries defined 
        -- in another stored procedure called myStoredProc. it just takes the parameter
        -- @CustomerIDToHandle provided here and uses it in the where clauses
        
        EXEC myStoredProc @CustomerIDToHandle

        -- set the last customer handled to the one we just handled
        SET @LastCustomerID = @CustomerIDToHandle
        SET @CustomerIDToHandle = NULL

        -- select the next customer to handle    
        SELECT TOP 1 @CustomerIDToHandle = bl_id
        FROM dbo.bl
        WHERE bl_id > @LastCustomerID AND status = 'a'
        ORDER BY bl_id
    END

",5
8022811,11/05/2011 19:47:13,1019776,10/29/2011 12:52:07,1,0,SQL Query Optimization: is SELECT * FROM Persons really that much slower than SELECT * FROM Persons WHERE City='Sandnes'?,"I have a question as to how much faster the SQL query SELECT * FROM Persons WHERE City='Sandnes'  is from the query SELECT * FROM Persons  is?  From various sources on the net the consensus is that there is a pickup in performance with a more filtered query, but they never seem to get specific.

I realize the answer depends on how big the database is, so let's say there are three databases, one having a mere 1000 records, the second having 1M records, and the third having 10M records.  Assume the records are just a few bytes large, so these data all fit into the server RAM.

How big a difference in speed, in say percent, am I likely to see?  Even a ballpark guess is helpful. 

I am using Microsoft SQL Server but that should not matter.",sql,query-optimization,,,,11/05/2011 20:10:44,not a real question,1,142,19,"SQL Query Optimization: is SELECT * FROM Persons really that much slower than SELECT * FROM Persons WHERE City='Sandnes'? I have a question as to how much faster the SQL query SELECT * FROM Persons WHERE City='Sandnes'  is from the query SELECT * FROM Persons  is?  From various sources on the net the consensus is that there is a pickup in performance with a more filtered query, but they never seem to get specific.

I realize the answer depends on how big the database is, so let's say there are three databases, one having a mere 1000 records, the second having 1M records, and the third having 10M records.  Assume the records are just a few bytes large, so these data all fit into the server RAM.

How big a difference in speed, in say percent, am I likely to see?  Even a ballpark guess is helpful. 

I am using Microsoft SQL Server but that should not matter.",2
5339651,03/17/2011 13:27:28,431879,08/26/2010 13:28:06,128,1,SQL query Where clause problem,"I am having trouble finding a query.
I have a table 'NotificationExcludes' that contains 1 column 'Name'.
I have a table 'NotificationEvents' that contains columns: Id, Description.
Now I need to select all the NotificationEvents where the description doesn't start with the values contained in 'NotificationExcludes'.

Small example:

NotificationExcludes contains: 

    Name
    The instance was terminated by

NotificationEvents:

    ID  Description
    1   There was a failure on ..
    2   The instance was terminated by administrator

Now I need to select everything except if the description starts with a value that is kept in the 'NotificationExcludes'.

I have tried

    Select Id, Description from NotificationEvent WHERE Description NOT IN (select Name form NotificationExcludes)

But 2 problems with that:

    1 The query obviously fails because 'select Name form NotificationExcludes' returns more than 1 record
    2 The statement should contain a Like statement where I can use the '%' key. So where description not like 'The instance was terminated by%' can be used somehow

Thx ",sql,query,,,,,open,0,180,5,"SQL query Where clause problem I am having trouble finding a query.
I have a table 'NotificationExcludes' that contains 1 column 'Name'.
I have a table 'NotificationEvents' that contains columns: Id, Description.
Now I need to select all the NotificationEvents where the description doesn't start with the values contained in 'NotificationExcludes'.

Small example:

NotificationExcludes contains: 

    Name
    The instance was terminated by

NotificationEvents:

    ID  Description
    1   There was a failure on ..
    2   The instance was terminated by administrator

Now I need to select everything except if the description starts with a value that is kept in the 'NotificationExcludes'.

I have tried

    Select Id, Description from NotificationEvent WHERE Description NOT IN (select Name form NotificationExcludes)

But 2 problems with that:

    1 The query obviously fails because 'select Name form NotificationExcludes' returns more than 1 record
    2 The statement should contain a Like statement where I can use the '%' key. So where description not like 'The instance was terminated by%' can be used somehow

Thx ",2
6985487,08/08/2011 16:43:10,517408,11/23/2010 12:21:26,183,7,optimize sql query,"I have a monster legacy query that is in the core of my program,
the query takes too much time , what is the best way to make it run faster ? 
I use oracle 11g     
    
    
     SELECT   *
         FROM     ( SELECT  COUNT(*) AS countme,
                           string_value        ,
                           name                ,
                           property_id         ,
                           category_id
                  FROM    ( SELECT DISTINCT a.string_value,
                                            a.name        ,
                                            a.property_id ,
                                            b.product_id  ,
                                            a.category_id
                           FROM             filter_criterias a
                                            JOIN product_properties b
                                            ON              (
                                                                              a.property_id = b.property_id
                                                             AND
                                                                              (
                                                                                               (
                                                                                                                isnumber(b.value)        IS NOT NULL
                                                                                               AND              isnumber(a.range_bottom) IS NOT NULL
                                                                                               AND              isnumber(a.range_top)    IS NOT NULL
                                                                                               AND
                                                                                                                (
                                                                                                                                 a.range_bottom >a.range_top
                                                                                                                AND              b.value       >= a.range_bottom
                                                                                                                OR               a.range_bottom<=a.range_top
                                                                                                                AND              b.value       >= a.range_bottom
                                                                                                                AND              b.value       <=a.range_top
                                                                                                                )
                                                                                               )
                                                                              )
                                                             )
                                            JOIN PRODUCT_CATEGORY prc
                                            ON               (
                                                                              prc.sku         = b.product_id
                                                             AND              prc.category_id = a.category_id
                                                             )
                                            JOIN PRODUCT pr
                                            ON               (
                                                                              b.product_id = pr.SKU
                                                             AND              pr.visible   = '1'
                                                             )
                           )
                  GROUP BY (string_value, name, property_id,category_id)
                  
                  UNION
                  
                  SELECT   COUNT(*) AS countme,
                           string_value       ,
                           name               ,
                           property_id        ,
                           category_id
                  FROM    ( SELECT DISTINCT a.string_value,
                                            a.name        ,
                                            a.property_id ,
                                            b.product_id  ,
                                            a.category_id
                           FROM             filter_criterias a
                                            JOIN product_properties b
                                            ON              (
                                                                              a.property_id = b.property_id
                                                             AND
                                                                              (
                                                                                               (
                                                                                                                a.name= b.value
                                                                                               )
                                                                              )
                                                             )
                                            JOIN PRODUCT_CATEGORY prc
                                            ON               (
                                                                              prc.sku         = b.product_id
                                                             AND              prc.category_id = a.category_id
                                                             )
                                            JOIN PRODUCT pr
                                            ON               (
                                                                              b.product_id = pr.SKU
                                                             AND              pr.visible   = '1'
                                                             )
                           )
                  GROUP BY (string_value, name, property_id,category_id)
                  )
         ORDER BY 5,4,3,2",sql,optimization,oracle11g,,,08/09/2011 08:33:00,too localized,1,5119,3,"optimize sql query I have a monster legacy query that is in the core of my program,
the query takes too much time , what is the best way to make it run faster ? 
I use oracle 11g     
    
    
     SELECT   *
         FROM     ( SELECT  COUNT(*) AS countme,
                           string_value        ,
                           name                ,
                           property_id         ,
                           category_id
                  FROM    ( SELECT DISTINCT a.string_value,
                                            a.name        ,
                                            a.property_id ,
                                            b.product_id  ,
                                            a.category_id
                           FROM             filter_criterias a
                                            JOIN product_properties b
                                            ON              (
                                                                              a.property_id = b.property_id
                                                             AND
                                                                              (
                                                                                               (
                                                                                                                isnumber(b.value)        IS NOT NULL
                                                                                               AND              isnumber(a.range_bottom) IS NOT NULL
                                                                                               AND              isnumber(a.range_top)    IS NOT NULL
                                                                                               AND
                                                                                                                (
                                                                                                                                 a.range_bottom >a.range_top
                                                                                                                AND              b.value       >= a.range_bottom
                                                                                                                OR               a.range_bottom<=a.range_top
                                                                                                                AND              b.value       >= a.range_bottom
                                                                                                                AND              b.value       <=a.range_top
                                                                                                                )
                                                                                               )
                                                                              )
                                                             )
                                            JOIN PRODUCT_CATEGORY prc
                                            ON               (
                                                                              prc.sku         = b.product_id
                                                             AND              prc.category_id = a.category_id
                                                             )
                                            JOIN PRODUCT pr
                                            ON               (
                                                                              b.product_id = pr.SKU
                                                             AND              pr.visible   = '1'
                                                             )
                           )
                  GROUP BY (string_value, name, property_id,category_id)
                  
                  UNION
                  
                  SELECT   COUNT(*) AS countme,
                           string_value       ,
                           name               ,
                           property_id        ,
                           category_id
                  FROM    ( SELECT DISTINCT a.string_value,
                                            a.name        ,
                                            a.property_id ,
                                            b.product_id  ,
                                            a.category_id
                           FROM             filter_criterias a
                                            JOIN product_properties b
                                            ON              (
                                                                              a.property_id = b.property_id
                                                             AND
                                                                              (
                                                                                               (
                                                                                                                a.name= b.value
                                                                                               )
                                                                              )
                                                             )
                                            JOIN PRODUCT_CATEGORY prc
                                            ON               (
                                                                              prc.sku         = b.product_id
                                                             AND              prc.category_id = a.category_id
                                                             )
                                            JOIN PRODUCT pr
                                            ON               (
                                                                              b.product_id = pr.SKU
                                                             AND              pr.visible   = '1'
                                                             )
                           )
                  GROUP BY (string_value, name, property_id,category_id)
                  )
         ORDER BY 5,4,3,2",3
4303248,11/29/2010 11:21:19,208486,11/11/2009 07:43:27,1805,133,UDF to display string as hexcode,"I have some strange characters in a VARCHAR field which prevent me from converting the field into an INTEGER. I want to debug this and so I need an UDF that will convert the string to a hexadecimal code (just like in a hex editor) so that I can see which characters I am dealing with.

Where can I find such a function or how can I write it?
",sql,tsql,sql-server-2008,udf,,,open,0,68,6,"UDF to display string as hexcode I have some strange characters in a VARCHAR field which prevent me from converting the field into an INTEGER. I want to debug this and so I need an UDF that will convert the string to a hexadecimal code (just like in a hex editor) so that I can see which characters I am dealing with.

Where can I find such a function or how can I write it?
",4
7128959,08/20/2011 01:26:31,903184,08/19/2011 22:00:43,1,0,"SQL: How to select a count of multiple records from one table, based on records in a different table?","Let's say I have two tables:

**TABLE A**

MessageID | Message

1 | Hello<br>
2 | Bonjour

etc..

**TABLE B**

CommentID | MessageID | Comment

1 | 2 | This is a comment to someone saying Bonjour<br>
2 | 2 | This is another comment to Bonjour

What I'm trying to do is run one query that pulls all the records from Table A (""the messages"") along with a count of all the comments for each message from Table B.

The result would be:

**Hello - 0 comments<br>
Bonjour - 2 comments**

I know this is probably some combination of using a join with a count(*), but I can't seem to hit on just the right syntax. 

Any ideas?



",sql,sql-server,database,join,count,,open,0,105,19,"SQL: How to select a count of multiple records from one table, based on records in a different table? Let's say I have two tables:

**TABLE A**

MessageID | Message

1 | Hello<br>
2 | Bonjour

etc..

**TABLE B**

CommentID | MessageID | Comment

1 | 2 | This is a comment to someone saying Bonjour<br>
2 | 2 | This is another comment to Bonjour

What I'm trying to do is run one query that pulls all the records from Table A (""the messages"") along with a count of all the comments for each message from Table B.

The result would be:

**Hello - 0 comments<br>
Bonjour - 2 comments**

I know this is probably some combination of using a join with a count(*), but I can't seem to hit on just the right syntax. 

Any ideas?



",5
7852892,10/21/2011 17:14:26,186643,10/08/2009 18:58:37,632,20,Why does TSQL on Sql Server 2000 round decimals inconsistently?,"I'm trying to calculate percent off values for dollar amounts. At 50%, sometimes you get half a penny, and I need to round it to the nearest cent.

In Sql, my calculation is as follows:

`round(retail * 0.5, 2, 0)`

If I take the following values I get different results:

* 4.39
* 2.49

Unrounded I get:

* 4.39 --> 2.195
* 2.49 --> 1.245

When rounded I get:

* 2.195 --> 2.19
* 1.245 --> 1.25

I'm told this is a form of ""banker's rounding"", but it seems like the value that is affecting the rounding direction is the integer value. 

My problem is that I expect the top value to round to 2.20. If this is indeed bankers rounding, and it is affected by the integer value here, does anyone have an example for preventing this behavior. If it is not bankers rounding, can someone please provide an explanation and potentially a solution to just get normal rounding behavior?

Thanks in advance!",sql,sql-server,tsql,sql-server-2000,rounding,,open,0,151,10,"Why does TSQL on Sql Server 2000 round decimals inconsistently? I'm trying to calculate percent off values for dollar amounts. At 50%, sometimes you get half a penny, and I need to round it to the nearest cent.

In Sql, my calculation is as follows:

`round(retail * 0.5, 2, 0)`

If I take the following values I get different results:

* 4.39
* 2.49

Unrounded I get:

* 4.39 --> 2.195
* 2.49 --> 1.245

When rounded I get:

* 2.195 --> 2.19
* 1.245 --> 1.25

I'm told this is a form of ""banker's rounding"", but it seems like the value that is affecting the rounding direction is the integer value. 

My problem is that I expect the top value to round to 2.20. If this is indeed bankers rounding, and it is affected by the integer value here, does anyone have an example for preventing this behavior. If it is not bankers rounding, can someone please provide an explanation and potentially a solution to just get normal rounding behavior?

Thanks in advance!",5
11110338,06/19/2012 22:21:51,502526,11/09/2010 22:52:56,1,1,"Database virtualization - Yet again, why not?","I'm currently leading a datacenter virtualization effort in order to improve our uptime and recovery times, given the current baremetal server topology that we have.

Talking to some of the vendors, in order to evaluate whether their solutions support virtualization, it came out that, most of them, don't encourage or even support database virtualization, because of the I/O performance issues it might have.

More specifically I'm talking about a 80 Gb MSSQL database, which holds transaction tickets from the last 6 weeks and historic values of the last 2 years. The level of transactions per minute it's relatively high.
This is just an example but can be related to other systems as well.

I have been studying the matter for a quite some time now and haven't found anything conclusive, although I did find a post [here](http://stackoverflow.com/questions/149318/virtualized-sql-server-why-not) which helped me channel my next moves. 
Still it's an older post, from '08, and since technology keeps improving, very much in the virtualization arena, I was wondering if there's more to it now, than a few years ago.

Thanks in advance for your help, but I'm keen to know whether moving a large database to a virtual environment it's the right thing to do.

Cheers!

@GastnAlgaze",sql,database,io,virtualization,,06/19/2012 22:27:13,off topic,1,197,7,"Database virtualization - Yet again, why not? I'm currently leading a datacenter virtualization effort in order to improve our uptime and recovery times, given the current baremetal server topology that we have.

Talking to some of the vendors, in order to evaluate whether their solutions support virtualization, it came out that, most of them, don't encourage or even support database virtualization, because of the I/O performance issues it might have.

More specifically I'm talking about a 80 Gb MSSQL database, which holds transaction tickets from the last 6 weeks and historic values of the last 2 years. The level of transactions per minute it's relatively high.
This is just an example but can be related to other systems as well.

I have been studying the matter for a quite some time now and haven't found anything conclusive, although I did find a post [here](http://stackoverflow.com/questions/149318/virtualized-sql-server-why-not) which helped me channel my next moves. 
Still it's an older post, from '08, and since technology keeps improving, very much in the virtualization arena, I was wondering if there's more to it now, than a few years ago.

Thanks in advance for your help, but I'm keen to know whether moving a large database to a virtual environment it's the right thing to do.

Cheers!

@GastnAlgaze",4
5292145,03/13/2011 20:27:37,28760,10/16/2008 22:36:00,4579,181,SQL query for maximum date,"I asked [a related question][1] and I got some really good answers, but I'm trying to make the query without making a temporary table. I believe it can be done, but I can't figure out how to do it.

I have two tables and I want to get the latest status for each entry, where the status date is less than or equal to the entry date.

**Entries Table (Entry):**

      UserID   | EntryDate  
        1      |  5/4/2010  
        1      |  4/4/2010  
        1      |  3/4/2010  
        1      |  2/4/2010  
        2      |  5/4/2010
        2      |  4/4/2010

**Entry Status Table (Status):** 

      UserID   | StatusDate  | Detail
        1      |  5/28/2010  |  D-1
        1      |  4/24/2010  |  D-2
        1      |  4/5/2010   |  D-3
        1      |  2/28/2010  |  D-4

**Expected Output:**

UserID | EntryDate | Detail
  1    | 5/4/2010  |  D-2
  1    | 4/4/2010  |  D-4
  1    | 3/4/2010  |  D-4
  1    | 2/4/2010  | <NULL>

In my [previous question][2] you can see my effort and the related answers, but I've narrowed down the issue in order to simplify the problem. 

I tried to do something like this (but I know I must be horribly off):

    SELECT        E.EntryDate, S.Detail, MAX(S.StatusDate) AS MaxStatusDate
    FROM            Entry AS E 
    LEFT OUTER JOIN Status AS S ON E.EntryDate >= S.StatusDate

  [1]: http://stackoverflow.com/questions/5280452/multiple-join-statements-not-returning-the-expected-result
  [2]: http://stackoverflow.com/questions/5280452/multiple-join-statements-not-returning-the-expected-result",sql,table,join,left-join,,,open,0,423,5,"SQL query for maximum date I asked [a related question][1] and I got some really good answers, but I'm trying to make the query without making a temporary table. I believe it can be done, but I can't figure out how to do it.

I have two tables and I want to get the latest status for each entry, where the status date is less than or equal to the entry date.

**Entries Table (Entry):**

      UserID   | EntryDate  
        1      |  5/4/2010  
        1      |  4/4/2010  
        1      |  3/4/2010  
        1      |  2/4/2010  
        2      |  5/4/2010
        2      |  4/4/2010

**Entry Status Table (Status):** 

      UserID   | StatusDate  | Detail
        1      |  5/28/2010  |  D-1
        1      |  4/24/2010  |  D-2
        1      |  4/5/2010   |  D-3
        1      |  2/28/2010  |  D-4

**Expected Output:**

UserID | EntryDate | Detail
  1    | 5/4/2010  |  D-2
  1    | 4/4/2010  |  D-4
  1    | 3/4/2010  |  D-4
  1    | 2/4/2010  | <NULL>

In my [previous question][2] you can see my effort and the related answers, but I've narrowed down the issue in order to simplify the problem. 

I tried to do something like this (but I know I must be horribly off):

    SELECT        E.EntryDate, S.Detail, MAX(S.StatusDate) AS MaxStatusDate
    FROM            Entry AS E 
    LEFT OUTER JOIN Status AS S ON E.EntryDate >= S.StatusDate

  [1]: http://stackoverflow.com/questions/5280452/multiple-join-statements-not-returning-the-expected-result
  [2]: http://stackoverflow.com/questions/5280452/multiple-join-statements-not-returning-the-expected-result",4
8329661,11/30/2011 16:45:58,1073816,11/30/2011 16:40:07,1,0,"In SQL Server, I want to use the same query for all the tables in a database","  I need to find a way to perform the same query to all the tables in an specific database.

 For example, if my database ""DB"" has the tables ""Table1"", ""Table2"", ""Table3"", ""Table4"" and ""Table5"". I want to perform the query 'Select * From <All 5 Tables> '

  Anyone knows how to do this ??? ",sql,query,table,server,all,12/03/2011 17:57:29,not a real question,1,58,17,"In SQL Server, I want to use the same query for all the tables in a database   I need to find a way to perform the same query to all the tables in an specific database.

 For example, if my database ""DB"" has the tables ""Table1"", ""Table2"", ""Table3"", ""Table4"" and ""Table5"". I want to perform the query 'Select * From <All 5 Tables> '

  Anyone knows how to do this ??? ",5
11664575,07/26/2012 07:39:49,1493053,06/30/2012 13:33:25,43,0,The benefits of switching access BackEnd to sql express,"I have an access DB, which is splited into a Backend and Frontend, that have c.a 100000 records in 60 tables.
I got this idea, that I can switch my Backend to a MSSQL Server Express. I would like to know Is it worth to do that or not? and which advantage do I have if my Backend is SQL Express and Front End access
Thank you for your ideas",sql,ms-access,sql-server-express,,,07/28/2012 11:00:29,not a real question,1,68,9,"The benefits of switching access BackEnd to sql express I have an access DB, which is splited into a Backend and Frontend, that have c.a 100000 records in 60 tables.
I got this idea, that I can switch my Backend to a MSSQL Server Express. I would like to know Is it worth to do that or not? and which advantage do I have if my Backend is SQL Express and Front End access
Thank you for your ideas",3
8236878,11/23/2011 03:10:14,1061061,11/23/2011 03:08:40,1,0,Sharepoint webservices: Need a query to find all sub-sites with write permission,"I have an external application for which I am using web services to get sub-sites and their permissions for the logged in user. i am using the Web and User web services. But now i wish to minimize the number of calls to the server and wish to get the information of the sub-sites and their permissions for the logged in user.

I was thinking of using the Query Webservice(spsearch.asmx), but am not able to find out the exact SQL query i need to run to get the data required by me.

Please help.

Thanks and Regards,
Aakanksha",sql,web-services,sharepoint2010,,,,open,0,94,12,"Sharepoint webservices: Need a query to find all sub-sites with write permission I have an external application for which I am using web services to get sub-sites and their permissions for the logged in user. i am using the Web and User web services. But now i wish to minimize the number of calls to the server and wish to get the information of the sub-sites and their permissions for the logged in user.

I was thinking of using the Query Webservice(spsearch.asmx), but am not able to find out the exact SQL query i need to run to get the data required by me.

Please help.

Thanks and Regards,
Aakanksha",3
1380626,09/04/2009 17:42:18,13954,09/16/2008 21:26:44,1727,96,Active Data Structure - Does this model (or similar) already exist?,"Active Data Structure
-----------------------------

the concept is.. 

You have a table (one that holds lots of records)..

    [data1] (call this the 'active' table)
    ---------
    Data1ID (required)
    SysID (required)
    createdDate (required)
    lastUpdatedDate (required)
    [mydata] (user's fields)

you also have n tables holding the same columns as Data1. 

    [data2] (call these the 'inactive' tables)
    ---------
    Data2ID (req.)
    SysID (req.)
    createdDate (req.)
    lastUpdatedDate (req.)
    [mydata] (user's fields)

...

    [data(n)]
    ---------
    Data(n)ID (req.)
    SysID (req.)
    createdDate (req.)
    lastUpdatedDate  (req.)
    [mydata] (user's fields)



When a user queries for a record, a **Trigger** is activated which 
initiates the search to happen on Data1 (the 'active' table).  
If a record isn't found, it checks the 'inactive' tables in 
order down the line.

If a record is found in a 'inactive' table,
the record is removed from that table and inserted into
Data1 (the 'active' table).

New records go into Data1.

There would never be redundant records across tables sharing the sysid.

**Daily Job**

- Each table is assigned a 'Term' date range: 

Data1: now - 3 months past.<br>
Data2: 3months - 6 months<br>
Data(n): anything previous to the last defined etc..

- Any Row modifications are applied to the 'inactive' tables based on the 'active' table.

- Any records with lastUpdatedDate in the 'active' table that fall within the 'Term' of the 'inactive' tables, are deleted from the 'active' table and moved to the appropriate 'inactive' table. Inactive tables are also checked in the same fasion.

Benefits
--------------------------------------------------------
My thinking is that this structure could easily be added to existing
bloated tables and make them more manageable as well as being a scalable
solution by simply redefining your 'Term' ranges and adding 'inactive' tables.


Issues.. 
--------------------------------------------------------
Searches on inactive data will obviously take longer.






",sql,database-design,,,,,open,0,330,11,"Active Data Structure - Does this model (or similar) already exist? Active Data Structure
-----------------------------

the concept is.. 

You have a table (one that holds lots of records)..

    [data1] (call this the 'active' table)
    ---------
    Data1ID (required)
    SysID (required)
    createdDate (required)
    lastUpdatedDate (required)
    [mydata] (user's fields)

you also have n tables holding the same columns as Data1. 

    [data2] (call these the 'inactive' tables)
    ---------
    Data2ID (req.)
    SysID (req.)
    createdDate (req.)
    lastUpdatedDate (req.)
    [mydata] (user's fields)

...

    [data(n)]
    ---------
    Data(n)ID (req.)
    SysID (req.)
    createdDate (req.)
    lastUpdatedDate  (req.)
    [mydata] (user's fields)



When a user queries for a record, a **Trigger** is activated which 
initiates the search to happen on Data1 (the 'active' table).  
If a record isn't found, it checks the 'inactive' tables in 
order down the line.

If a record is found in a 'inactive' table,
the record is removed from that table and inserted into
Data1 (the 'active' table).

New records go into Data1.

There would never be redundant records across tables sharing the sysid.

**Daily Job**

- Each table is assigned a 'Term' date range: 

Data1: now - 3 months past.<br>
Data2: 3months - 6 months<br>
Data(n): anything previous to the last defined etc..

- Any Row modifications are applied to the 'inactive' tables based on the 'active' table.

- Any records with lastUpdatedDate in the 'active' table that fall within the 'Term' of the 'inactive' tables, are deleted from the 'active' table and moved to the appropriate 'inactive' table. Inactive tables are also checked in the same fasion.

Benefits
--------------------------------------------------------
My thinking is that this structure could easily be added to existing
bloated tables and make them more manageable as well as being a scalable
solution by simply redefining your 'Term' ranges and adding 'inactive' tables.


Issues.. 
--------------------------------------------------------
Searches on inactive data will obviously take longer.






",2
3304018,07/21/2010 21:30:03,398167,07/21/2010 15:35:08,1,0,SQL Server XML Data Type and QUOTED_IDENTIFIER,"Can anyone provide insight into this?

I've developed an import process using an XML data type. After the data is inserted in to a table by the import sProc I run another procedures to update another table with the imported table.

The update procedure throws an exception if it is created with SET QUOTED_IDENTIFIER OFF. I'd like to understand why that is happening.

Here's the code:

	DECLARE @xmlRecords XML
	SET		@xmlRecords = (SELECT importedXML FROM importTable WHERE importId = @lastImportId)

	UPDATE	o
	SET		o.ReferralCode = import.refCode
	FROM	(
				SELECT	records.record.value('(@orderId)[1]', 'INT') AS orderId, 
						records.record.value('(@refCode)[1]', 'VARCHAR(15)') AS refCode
				FROM	@xmlRecords.nodes('/records/record') records(record)
				) import 
				INNER JOIN tblOrder o ON import.OrderId = o.orderId

I'm assuming it has to do with the quoted datatypes ('VARCHAR(15)') or the xml query path elements ('/records/record').

Thanks for any insight you can provide.",sql,xml,server,quoted-identifier,,,open,0,116,7,"SQL Server XML Data Type and QUOTED_IDENTIFIER Can anyone provide insight into this?

I've developed an import process using an XML data type. After the data is inserted in to a table by the import sProc I run another procedures to update another table with the imported table.

The update procedure throws an exception if it is created with SET QUOTED_IDENTIFIER OFF. I'd like to understand why that is happening.

Here's the code:

	DECLARE @xmlRecords XML
	SET		@xmlRecords = (SELECT importedXML FROM importTable WHERE importId = @lastImportId)

	UPDATE	o
	SET		o.ReferralCode = import.refCode
	FROM	(
				SELECT	records.record.value('(@orderId)[1]', 'INT') AS orderId, 
						records.record.value('(@refCode)[1]', 'VARCHAR(15)') AS refCode
				FROM	@xmlRecords.nodes('/records/record') records(record)
				) import 
				INNER JOIN tblOrder o ON import.OrderId = o.orderId

I'm assuming it has to do with the quoted datatypes ('VARCHAR(15)') or the xml query path elements ('/records/record').

Thanks for any insight you can provide.",4
3763623,09/21/2010 19:13:43,394178,07/16/2010 18:00:24,229,16,How can I get the 'External name' of a SQL CLR trigger?,"I have created a SQL CLR trigger with the follow SQL:

    GO
    CREATE TRIGGER AuditAccountsTable
       ON [dbo].[Accounts]
       FOR INSERT,DELETE,UPDATE
    AS 
    EXTERNAL NAME namespace.Triggers.AuditTrigger

I am trying to query:

    select * from sys.triggers

Is there a way to find the: `EXTERNAL NAME namespace.Triggers.AuditTrigger` on the trigger from querying in the DB?",sql,sql-server,triggers,sqlclr,,,open,0,76,12,"How can I get the 'External name' of a SQL CLR trigger? I have created a SQL CLR trigger with the follow SQL:

    GO
    CREATE TRIGGER AuditAccountsTable
       ON [dbo].[Accounts]
       FOR INSERT,DELETE,UPDATE
    AS 
    EXTERNAL NAME namespace.Triggers.AuditTrigger

I am trying to query:

    select * from sys.triggers

Is there a way to find the: `EXTERNAL NAME namespace.Triggers.AuditTrigger` on the trigger from querying in the DB?",4
10068699,04/09/2012 03:50:32,1305846,04/01/2012 03:51:25,1,0,Stored Procedure doesnt work properly on Windows Azure?,"I am using stored procedure check If table exist on sql server 2008 R2 works fine.
Windows Azure always return table Exist.
any suggestion ? here is the Stored Procedure scripted for windows azure

USE [MyDatabaseAzure]
GO

/****** Object:  StoredProcedure [dbo].[CheckUserName]    Script Date: 04/08/2012 21:11:35 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[CheckUserName](  @Name VARCHAR(50) )  

 AS  

 BEGIN  
   
   IF EXISTS (SELECT * FROM Users WHERE  [Name] = @Name )   
   
   SELECT '1'; --user name already exist in database   
 
   ELSE  

   SELECT '0'; --user name does not exist in database
  
 END
GO



Here is original Procedure for sql server 2008 r2          works fine



USE [MyDATABASE.MDF]
GO
/****** Object:  StoredProcedure [dbo].[CheckUserName]    Script Date: 04/08/2012 21:39:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[CheckUserName](  @Name VARCHAR(50) )  

 AS  

 BEGIN  
 

   IF EXISTS (SELECT * FROM Users WHERE  [Name] = @Name )   
 

   SELECT '1'; --user name already exist in database  
 

   ELSE  
 

   SELECT '0'; --user name does not exist in database  

    
 END ",sql,,,,,04/10/2012 09:53:51,too localized,1,226,8,"Stored Procedure doesnt work properly on Windows Azure? I am using stored procedure check If table exist on sql server 2008 R2 works fine.
Windows Azure always return table Exist.
any suggestion ? here is the Stored Procedure scripted for windows azure

USE [MyDatabaseAzure]
GO

/****** Object:  StoredProcedure [dbo].[CheckUserName]    Script Date: 04/08/2012 21:11:35 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[CheckUserName](  @Name VARCHAR(50) )  

 AS  

 BEGIN  
   
   IF EXISTS (SELECT * FROM Users WHERE  [Name] = @Name )   
   
   SELECT '1'; --user name already exist in database   
 
   ELSE  

   SELECT '0'; --user name does not exist in database
  
 END
GO



Here is original Procedure for sql server 2008 r2          works fine



USE [MyDATABASE.MDF]
GO
/****** Object:  StoredProcedure [dbo].[CheckUserName]    Script Date: 04/08/2012 21:39:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[CheckUserName](  @Name VARCHAR(50) )  

 AS  

 BEGIN  
 

   IF EXISTS (SELECT * FROM Users WHERE  [Name] = @Name )   
 

   SELECT '1'; --user name already exist in database  
 

   ELSE  
 

   SELECT '0'; --user name does not exist in database  

    
 END ",1
6542302,06/30/2011 23:52:35,824011,06/30/2011 23:52:35,1,0,Full text search with php,"I do not get any results for the following query:

    ""SELECT * FROM test2 WHERE MATCH(txt) AGAINST('hello' IN BOOLEAN MODE)""

while test2 looks like:

    id | txt
     1 | ...
     2 | ...
     3 | ...
     4 | ...
    .. | ...

txt is 30 characters long and fulltext. I have about 16 records (little db) and the word hello is placed almost in every record in txt along with other words. I just wanted to know how full-text search works. So i get zero results and I can't understand why.",sql,full-text-search,,,,,open,0,114,5,"Full text search with php I do not get any results for the following query:

    ""SELECT * FROM test2 WHERE MATCH(txt) AGAINST('hello' IN BOOLEAN MODE)""

while test2 looks like:

    id | txt
     1 | ...
     2 | ...
     3 | ...
     4 | ...
    .. | ...

txt is 30 characters long and fulltext. I have about 16 records (little db) and the word hello is placed almost in every record in txt along with other words. I just wanted to know how full-text search works. So i get zero results and I can't understand why.",2
3013048,06/10/2010 09:09:12,258293,01/25/2010 09:38:52,191,7,SQL like conditions,"What does this mean within my like statement? 

    LIKE '%[ .,!?]' + keyword + '[ .,!?]%'


I'm trying to get something, that will match for whole words

",sql,,,,,,open,0,30,3,"SQL like conditions What does this mean within my like statement? 

    LIKE '%[ .,!?]' + keyword + '[ .,!?]%'


I'm trying to get something, that will match for whole words

",1
6172182,05/30/2011 04:06:52,670597,03/22/2011 04:55:26,166,0,SQL - Trouble with simple select query,"Im having some trouble figuring out why the sql query below isnt working ... when members_only is set to 0, its still showing them ... cant figure out why.

    SELECT * FROM reports WHERE story = ""1"" OR barebones = ""1"" AND members_only = ""1""

Any help would be grand.",sql,,,,,,open,0,52,7,"SQL - Trouble with simple select query Im having some trouble figuring out why the sql query below isnt working ... when members_only is set to 0, its still showing them ... cant figure out why.

    SELECT * FROM reports WHERE story = ""1"" OR barebones = ""1"" AND members_only = ""1""

Any help would be grand.",1
1433490,09/16/2009 14:49:53,155355,08/12/2009 19:31:50,1,0,SQL Server - Efficiently storing the results of a query in a tracking table,"I have been asked to keep track of how many times each item comes up within the results of a particular query.  My thought is to just store the result of a query into a tracking table and then spit the results back to the caller.  I am wondering what the most efficient method of storing these results would be since the result set could include up to 1000 records.

My plan is to pull the query results into a temp table and insert those results into the tracking table then return the temp table as the result of the SPROC.  Something like this:
    
    DECLARE @QueryTime datetime
    SET @QueryTime = GETDATE()
    
    DECLARE @Results TABLE (X nvarchar(255), Y nvarchar(255))
    
    INSERT INTO @Results
    SELECT X,Y FROM TableA
    
    INSERT INTO TableB
    SELECT X, @QueryTime FROM @Results
    
    SELECT X, Y FROM @Results

Does anyone have a more efficient way to post the bulk result set into a tracking table?",sql,stored-procedures,,,,,open,0,200,14,"SQL Server - Efficiently storing the results of a query in a tracking table I have been asked to keep track of how many times each item comes up within the results of a particular query.  My thought is to just store the result of a query into a tracking table and then spit the results back to the caller.  I am wondering what the most efficient method of storing these results would be since the result set could include up to 1000 records.

My plan is to pull the query results into a temp table and insert those results into the tracking table then return the temp table as the result of the SPROC.  Something like this:
    
    DECLARE @QueryTime datetime
    SET @QueryTime = GETDATE()
    
    DECLARE @Results TABLE (X nvarchar(255), Y nvarchar(255))
    
    INSERT INTO @Results
    SELECT X,Y FROM TableA
    
    INSERT INTO TableB
    SELECT X, @QueryTime FROM @Results
    
    SELECT X, Y FROM @Results

Does anyone have a more efficient way to post the bulk result set into a tracking table?",2
10866393,06/02/2012 22:24:19,818669,06/28/2011 06:53:58,44,14,rewriting sql of counting offers made by user,"I have two tables Cargo and Offer. I just want to list all cargos along with count of valid offers which has an offer made by particular user.
Table structure is as fallows:   

**Cargo - Table**  
CargoId  
CargoTime  
..    

  
**Offer - Table**  
OfferId  
CargoId  
UserId  
OfferStatu  
..  

In this system users can make multiple offers for a cargo but latest offer will be count as valid  for particular user. So if OfferStatu is 1 then this refers to a previous offer of particular user.

I wrote a sql as fallows assuming :

    SELECT cargo.CargoId,cargo.CargoTime,COUNT(offer.OfferId) 
    FROM cargo INNER join offer on offer.CargoId=cargo.CargoId
    WHERE cargo.CargoId in
    (
    	select c.CargoId from cargo as c inner  join offer as o 
    	on o.CargoId=c.CargoId
    	WHERE o.UserId=12  
    )
    and offer.OfferStatu<>1
    GROUP BY cargo.CargoId

But this query executed in approximately 1 seconds which is too much for me. I know that there is a more efficient way to write but i am struggling right now.

 ",sql,table,join,count,,,open,0,207,8,"rewriting sql of counting offers made by user I have two tables Cargo and Offer. I just want to list all cargos along with count of valid offers which has an offer made by particular user.
Table structure is as fallows:   

**Cargo - Table**  
CargoId  
CargoTime  
..    

  
**Offer - Table**  
OfferId  
CargoId  
UserId  
OfferStatu  
..  

In this system users can make multiple offers for a cargo but latest offer will be count as valid  for particular user. So if OfferStatu is 1 then this refers to a previous offer of particular user.

I wrote a sql as fallows assuming :

    SELECT cargo.CargoId,cargo.CargoTime,COUNT(offer.OfferId) 
    FROM cargo INNER join offer on offer.CargoId=cargo.CargoId
    WHERE cargo.CargoId in
    (
    	select c.CargoId from cargo as c inner  join offer as o 
    	on o.CargoId=c.CargoId
    	WHERE o.UserId=12  
    )
    and offer.OfferStatu<>1
    GROUP BY cargo.CargoId

But this query executed in approximately 1 seconds which is too much for me. I know that there is a more efficient way to write but i am struggling right now.

 ",4
7187069,08/25/2011 08:15:26,825820,07/02/2011 06:32:34,1,0,I want Get the Result from the the follwing table?,"user_type_id         user_Type
---------------------------------
1                    SuperAdmin
2                    Admin
3                    User  
4                    Reviewer 


when superAdmin logedin  i want display admin user and reviewer how?",sql,,,,,08/25/2011 08:48:48,not a real question,1,104,10,"I want Get the Result from the the follwing table? user_type_id         user_Type
---------------------------------
1                    SuperAdmin
2                    Admin
3                    User  
4                    Reviewer 


when superAdmin logedin  i want display admin user and reviewer how?",1
3823661,09/29/2010 16:23:11,284604,03/02/2010 17:14:20,24,0,"Show failure for SQL 2005 Job that executes Powershell script through CMD prompt, IF PS script fails","I have a SQL 2005 instance that runs a job that uses a Powershell script to rename the current SQL TX Log backup file by appending ""-PrevDay"" to it, (subsequently deleting the backup already named ""XXX-PrevDay.bak"" if it exists), and then run a full backup of the DB and a TX Log backup, if the DB is not in Simple mode.

SQL Job kicks off the Powershell script through CMD in each job step and the powershell script kicks off the sql backup using ""Invoke-SQLCmd"" cmdlet.  This works great, unless the backup fails, because the SQL job still shows as ""Successful"".  This is because the SQL job that kicks off the Powershell script through the CMD prompt, only cares if the Powershell script runs...not if the commands IN the script actually succeed or fail.

Is it possible, using error trapping in powershell (or any method really), to have the powershell script ""fail"" the cmd prompt action of running the script...so that the SQL Job reports a failure?

Does this even make sense? LOL

I would assume that if I was able to use SQL 2008, which allows for a SQL job step type of ""Powershell Script"" (instead of the step type having to be Operating System...that kicks off the PS script) this wouldn't be an issue...however...that's not an option.

Right now, the job step runs the powershell script, through CMD using Parameters for DBName, Path, and Servername and looks like this:

    powershell.exe ""C:\SQLBackupScriptsTest\SQLServerBackup.ps1"" -DBName 'Angel_Food' -Path 'E:\SQLBackup1' -Server 'DEVSQLSRV'

The actual Powershell script looks like this:

    Param($DBName,$Path,$Server)
    
    ## Add sql snapins...must have for Invoke-Sqlcmd with powershell 2.0 ##
    
    add-pssnapin sqlserverprovidersnapin100
    add-pssnapin sqlservercmdletsnapin100
    [reflection.assembly]::LoadWithPartialName(""Microsoft.SqlServer.Smo"") | out-null
    
    ## Set parameter for finding DB recovery model ##
    $Recovery = (Invoke-Sqlcmd -Query ""SELECT recovery_model_desc FROM sys.databases WHERE name = '$DBName'"" -Server $Server)
    
    ## Do full backup of DB ##
    (Invoke-Sqlcmd -Query ""BACKUP DATABASE $DBName TO  DISK = N'$Path\$DBName\$DBName.bak' WITH NOFORMAT, INIT,  NAME = N'$DBNameTEST', SKIP, NOREWIND, NOUNLOAD,  STATS = 10, CHECKSUM"" -Server $Server -ConnectionTimeout 0 -QueryTimeout 65535)
    
    ############################################################################################################
    ## Check recovery mode, if FULL, check for Log-PrevDay.bak. If exists then delete.  If not exist, move on ##
    ## Then check for Current TX log backup.  If exists, rename to Log-PreDay.bak. If not exist, move on      ##
    ## Then perform TX Log backup                                                                             ##
    ## If recovery mode NOT FULL, do nothing                                                                  ##
    ############################################################################################################
    	IF
    	($Recovery.recovery_model_desc -eq 'FULL')
    	#THEN#
    	{
    			## Look to see if PrevDay TX log exists.  If so, delete, if not, move on ##
    			IF 
    			(Test-Path $Path\$DBName\$DBName-Log-PrevDay.bak) 
    			#THEN#
    			{remove-item $Path\$DBName\$DBName-Log-PrevDay.bak -force}
    			ELSE
    			{}
    				## Look to see if current TX log exists, if so, rename to Prev Day TX Log, if not, move on ##
    				IF
    				(Test-Path $Path\$DBName\$DBName-Log.bak)
    				#THEN#
    				{rename-item $Path\$DBName\$DBName-Log.bak -newname $DBName-Log-PrevDay.bak -force}
    				ELSE
    				{}
    			
    	Invoke-Sqlcmd -Query ""BACKUP LOG $DBName TO  DISK = N'$Path\$DBName\$DBName-Log.bak' WITH NOFORMAT, INIT,  NAME = N'$DBName LogTEST (Init)', SKIP, NOREWIND, NOUNLOAD,  STATS = 10, CHECKSUM"" -Server $Server -ConnectionTimeout 0 -QueryTimeout 65535}
    	ELSE
    	{}

Thanks so much!",sql,sql-server-2005,powershell-v2.0,,,,open,0,776,17,"Show failure for SQL 2005 Job that executes Powershell script through CMD prompt, IF PS script fails I have a SQL 2005 instance that runs a job that uses a Powershell script to rename the current SQL TX Log backup file by appending ""-PrevDay"" to it, (subsequently deleting the backup already named ""XXX-PrevDay.bak"" if it exists), and then run a full backup of the DB and a TX Log backup, if the DB is not in Simple mode.

SQL Job kicks off the Powershell script through CMD in each job step and the powershell script kicks off the sql backup using ""Invoke-SQLCmd"" cmdlet.  This works great, unless the backup fails, because the SQL job still shows as ""Successful"".  This is because the SQL job that kicks off the Powershell script through the CMD prompt, only cares if the Powershell script runs...not if the commands IN the script actually succeed or fail.

Is it possible, using error trapping in powershell (or any method really), to have the powershell script ""fail"" the cmd prompt action of running the script...so that the SQL Job reports a failure?

Does this even make sense? LOL

I would assume that if I was able to use SQL 2008, which allows for a SQL job step type of ""Powershell Script"" (instead of the step type having to be Operating System...that kicks off the PS script) this wouldn't be an issue...however...that's not an option.

Right now, the job step runs the powershell script, through CMD using Parameters for DBName, Path, and Servername and looks like this:

    powershell.exe ""C:\SQLBackupScriptsTest\SQLServerBackup.ps1"" -DBName 'Angel_Food' -Path 'E:\SQLBackup1' -Server 'DEVSQLSRV'

The actual Powershell script looks like this:

    Param($DBName,$Path,$Server)
    
    ## Add sql snapins...must have for Invoke-Sqlcmd with powershell 2.0 ##
    
    add-pssnapin sqlserverprovidersnapin100
    add-pssnapin sqlservercmdletsnapin100
    [reflection.assembly]::LoadWithPartialName(""Microsoft.SqlServer.Smo"") | out-null
    
    ## Set parameter for finding DB recovery model ##
    $Recovery = (Invoke-Sqlcmd -Query ""SELECT recovery_model_desc FROM sys.databases WHERE name = '$DBName'"" -Server $Server)
    
    ## Do full backup of DB ##
    (Invoke-Sqlcmd -Query ""BACKUP DATABASE $DBName TO  DISK = N'$Path\$DBName\$DBName.bak' WITH NOFORMAT, INIT,  NAME = N'$DBNameTEST', SKIP, NOREWIND, NOUNLOAD,  STATS = 10, CHECKSUM"" -Server $Server -ConnectionTimeout 0 -QueryTimeout 65535)
    
    ############################################################################################################
    ## Check recovery mode, if FULL, check for Log-PrevDay.bak. If exists then delete.  If not exist, move on ##
    ## Then check for Current TX log backup.  If exists, rename to Log-PreDay.bak. If not exist, move on      ##
    ## Then perform TX Log backup                                                                             ##
    ## If recovery mode NOT FULL, do nothing                                                                  ##
    ############################################################################################################
    	IF
    	($Recovery.recovery_model_desc -eq 'FULL')
    	#THEN#
    	{
    			## Look to see if PrevDay TX log exists.  If so, delete, if not, move on ##
    			IF 
    			(Test-Path $Path\$DBName\$DBName-Log-PrevDay.bak) 
    			#THEN#
    			{remove-item $Path\$DBName\$DBName-Log-PrevDay.bak -force}
    			ELSE
    			{}
    				## Look to see if current TX log exists, if so, rename to Prev Day TX Log, if not, move on ##
    				IF
    				(Test-Path $Path\$DBName\$DBName-Log.bak)
    				#THEN#
    				{rename-item $Path\$DBName\$DBName-Log.bak -newname $DBName-Log-PrevDay.bak -force}
    				ELSE
    				{}
    			
    	Invoke-Sqlcmd -Query ""BACKUP LOG $DBName TO  DISK = N'$Path\$DBName\$DBName-Log.bak' WITH NOFORMAT, INIT,  NAME = N'$DBName LogTEST (Init)', SKIP, NOREWIND, NOUNLOAD,  STATS = 10, CHECKSUM"" -Server $Server -ConnectionTimeout 0 -QueryTimeout 65535}
    	ELSE
    	{}

Thanks so much!",3
1093106,07/07/2009 15:43:08,24204,10/01/2008 16:16:32,191,31,Tidy for SQL,"I'm looking for a tool that that I can use to clean up (formatting, tabs etc...) my stored procedures and views.  Is there anything like html's tidy, but for SQL which is free/open source?",sql,,,,,,open,0,35,3,"Tidy for SQL I'm looking for a tool that that I can use to clean up (formatting, tabs etc...) my stored procedures and views.  Is there anything like html's tidy, but for SQL which is free/open source?",1
11697143,07/28/2012 00:13:59,999690,10/17/2011 17:32:07,45,0,sql - sum columns from same table having multiple unique ids,"I  would like to sum 3 columns from the same table based on three unique id.

    If id=""1"" sum(area1) 
    If id=""2"" sum(area2)
    if id=""3"" sum(area3)


Table data:

    id area1 area2 area3
    1   10     2    10
    1    1     10    10
    2    1     10    10
    3    1     10    10
    3  10     2     10

Output should be:

  id1= 43 id2 = 21 id3 = 43



    Select houseID, sum(area1), b.sum(area2), c.sum(area3) FROM table1, table1 b, table1 c
    WHERE table1.id=""1"" or b.id = ""2"" or c.id=""3""


",sql,database,query,tsql,reporting-services,,open,0,163,11,"sql - sum columns from same table having multiple unique ids I  would like to sum 3 columns from the same table based on three unique id.

    If id=""1"" sum(area1) 
    If id=""2"" sum(area2)
    if id=""3"" sum(area3)


Table data:

    id area1 area2 area3
    1   10     2    10
    1    1     10    10
    2    1     10    10
    3    1     10    10
    3  10     2     10

Output should be:

  id1= 43 id2 = 21 id3 = 43



    Select houseID, sum(area1), b.sum(area2), c.sum(area3) FROM table1, table1 b, table1 c
    WHERE table1.id=""1"" or b.id = ""2"" or c.id=""3""


",5
7720998,10/11/2011 03:09:59,985895,10/08/2011 23:10:44,3,0,"how can i turn off lines from ""Report Server"" on my SQL Server Profiler?","It's my first time using SQL Server Profiler and I'm wondering **how can i turn off event lines from the application ""Report Server"" on my SQL Server Profiler?** I just want certain activities to be logged like ones from LINQPad and Entity Framework.

Thanks for the help!",sql,sql-server,sql-server-profiler,,,,open,0,46,14,"how can i turn off lines from ""Report Server"" on my SQL Server Profiler? It's my first time using SQL Server Profiler and I'm wondering **how can i turn off event lines from the application ""Report Server"" on my SQL Server Profiler?** I just want certain activities to be logged like ones from LINQPad and Entity Framework.

Thanks for the help!",3
11055754,06/15/2012 17:47:54,777982,05/31/2011 15:53:56,1265,169,How to make a cursor faster,"I have wrote this cursor for commission report. What happens is commission comes in one table, the records are another table. I match two based on certain critera (there is not exact match available). The problem is there are duplicates where records exist. When I match commission with the `records` table, it can result picking up these duplicates. Thus the rep gets paid more. On the other hand, there are duplicates in commission table also but those are valid beause they simple mean an account got paid for 2 months.

I wrote this query but it takes 5+ minutes to run. I have 50,000 records in records table and 100,000 in commission table. Is there any way I an improve this cursor?


    /* just preparation of cursor, this is not time consuming */
    create table #result (
    repid int,
    AccountNo varchar(100),
    supplier varchar(15),
    CompanyName varchar(200),
    StartDate datetime,
    EndDate datetime,
    Product varchar(25),
    commodity varchar(25),
    ContractEnd datetime,
    EstUsage int,
    EnrollStatus varchar(10),
    EnrollDate datetime,
    ActualEndDate datetime,
    MeterStart datetime,
    MeterEnd datetime,
    ActualUsage int)
    
    
    declare @AccountNo varchar(100)
    declare @supplier varchar(10)
    declare @commodity varchar(15)
    declare @meterstart datetime
    declare @meterEnd datetime
    declare @volume float
    
    declare @RepID int
    declare @Month int
    declare @Year int
    
    set @repID = 80
    set @Month = 1
    set @year = 2012
    
    /* the actual cursor */

    declare commission_cursor cursor
    for 
    select AccountNo, supplier, commodity,meterStart, MeterEnd, Volume from commission where DatePart(m,PaymentDate) = @Month and DatePart(YYYY,PaymentDate) = @Year 
    
    open commission_cursor
       fetch next from commission_cursor into @AccountNo, @supplier,@commodity, @MeterStart, @MeterEnd, @Volume;
      while @@fetch_status =0
      begin
        if exists (select id from Records where AccountNo =@AccountNo and supplier=@supplier and Commodity = @commodity and RepID=@repID)
    		insert into #result select top 1 RepID,AccountNo,Supplier,CompanyName,[Supplier Start Date],[Supplier End Date],
    		Product, Commodity, [customer end date], [Expected Usage], EnrollStatus,ActualStartDate,ActualEndDate,@meterstart,@MeterEnd,@volume from Records where
    		AccountNo =@AccountNo and supplier=@supplier and Commodity = @commodity and RepID=@repID and
    		@MeterStart >= dateadd(dd,-7,ActualStartDate) and  @meterEnd <= ISNULL(dateAdd(dd,30,ActualEndDate),'2015-12-31')
    		
      fetch next from commission_cursor into @AccountNo, @supplier,@commodity, @MeterStart, @MeterEnd, @Volume;
      end 
      select  * from #result
    
    /* clean up */
  
    close commission_cursor
    deallocate commission_cursor
    
    drop table #result


I have read answer to http://stackoverflow.com/questions/859407/how-to-make-a-t-sql-cursor-faster, for that what I get is rewrite this query in table form. But I do have another query which uses join and is lightening fast. The problem is, it can not differentiate between the dups in my `records` table.

Is there anything I can do to make is faster. This is primary question. If not, do you have any alternative way to do it.",sql,sql-server-2005,join,cursor,duplicate-removal,,open,0,609,6,"How to make a cursor faster I have wrote this cursor for commission report. What happens is commission comes in one table, the records are another table. I match two based on certain critera (there is not exact match available). The problem is there are duplicates where records exist. When I match commission with the `records` table, it can result picking up these duplicates. Thus the rep gets paid more. On the other hand, there are duplicates in commission table also but those are valid beause they simple mean an account got paid for 2 months.

I wrote this query but it takes 5+ minutes to run. I have 50,000 records in records table and 100,000 in commission table. Is there any way I an improve this cursor?


    /* just preparation of cursor, this is not time consuming */
    create table #result (
    repid int,
    AccountNo varchar(100),
    supplier varchar(15),
    CompanyName varchar(200),
    StartDate datetime,
    EndDate datetime,
    Product varchar(25),
    commodity varchar(25),
    ContractEnd datetime,
    EstUsage int,
    EnrollStatus varchar(10),
    EnrollDate datetime,
    ActualEndDate datetime,
    MeterStart datetime,
    MeterEnd datetime,
    ActualUsage int)
    
    
    declare @AccountNo varchar(100)
    declare @supplier varchar(10)
    declare @commodity varchar(15)
    declare @meterstart datetime
    declare @meterEnd datetime
    declare @volume float
    
    declare @RepID int
    declare @Month int
    declare @Year int
    
    set @repID = 80
    set @Month = 1
    set @year = 2012
    
    /* the actual cursor */

    declare commission_cursor cursor
    for 
    select AccountNo, supplier, commodity,meterStart, MeterEnd, Volume from commission where DatePart(m,PaymentDate) = @Month and DatePart(YYYY,PaymentDate) = @Year 
    
    open commission_cursor
       fetch next from commission_cursor into @AccountNo, @supplier,@commodity, @MeterStart, @MeterEnd, @Volume;
      while @@fetch_status =0
      begin
        if exists (select id from Records where AccountNo =@AccountNo and supplier=@supplier and Commodity = @commodity and RepID=@repID)
    		insert into #result select top 1 RepID,AccountNo,Supplier,CompanyName,[Supplier Start Date],[Supplier End Date],
    		Product, Commodity, [customer end date], [Expected Usage], EnrollStatus,ActualStartDate,ActualEndDate,@meterstart,@MeterEnd,@volume from Records where
    		AccountNo =@AccountNo and supplier=@supplier and Commodity = @commodity and RepID=@repID and
    		@MeterStart >= dateadd(dd,-7,ActualStartDate) and  @meterEnd <= ISNULL(dateAdd(dd,30,ActualEndDate),'2015-12-31')
    		
      fetch next from commission_cursor into @AccountNo, @supplier,@commodity, @MeterStart, @MeterEnd, @Volume;
      end 
      select  * from #result
    
    /* clean up */
  
    close commission_cursor
    deallocate commission_cursor
    
    drop table #result


I have read answer to http://stackoverflow.com/questions/859407/how-to-make-a-t-sql-cursor-faster, for that what I get is rewrite this query in table form. But I do have another query which uses join and is lightening fast. The problem is, it can not differentiate between the dups in my `records` table.

Is there anything I can do to make is faster. This is primary question. If not, do you have any alternative way to do it.",5
10303679,04/24/2012 18:15:49,134367,07/07/2009 16:18:04,4211,294,SQL: determine that an activity occurs with a given frequency,"A common problem in electronic-medical-record (EMR) reporting in determining that an activity occurs with a specific frequency.  In this situation, I need to determine that a note was written every 72-hours after admission.

Given:

    A                                       D
    |-0-|-1-|-2-|-3-|-4-|-5-|-6-|-7-|-8-|-9-|
    |---- 1 ----|---- 2 ----|---- 3 ----|-4-|

There would need to be at least one note during periods 1, 2, and 3.  Because 4 isn't a full 72-hour period, it doesn't require a note.  Failure to find a note in periods 1, 2, and 3 would be a FAIL.

Data:

(ENC):

    ENC_ID	ADMITTED	DISCHARGED	PERIODS PASS_FAIL
    4114221	06/15/09 18:30	06/24/09 15:40	3	?

PERIODS:	`TRUNC(CEIL((DISCHARGED - ADMITTED)/3))`

The 'PASS_FAIL' column would indicate if the encounter had an adequate number and timing of notes.

(NOTE):

    ENC_ID	NOTE_ID	NOTE_TIME	PERIOD
    4114221	1833764	06/17/09 08:42	1
    4114221	1843613	06/18/09 08:14	1
    4114221	1858159	06/18/09 20:15	2
    4114221	1850948	06/18/09 20:15	2
    4114221	1850912	06/18/09 20:18	2
    4114221	1859315	06/19/09 18:35	2
    4114221	1863982	06/20/09 10:29	2
    4114221	1868895	06/21/09 22:00	3
    4114221	1873539	06/22/09 15:42	3

PERIOD:	`CEIL((NOTE_TIME - ADMITTED)/3)`

Is there an efficient way to solve this problem?

",sql,oracle,oracle10g,epic-clarity,,,open,0,221,10,"SQL: determine that an activity occurs with a given frequency A common problem in electronic-medical-record (EMR) reporting in determining that an activity occurs with a specific frequency.  In this situation, I need to determine that a note was written every 72-hours after admission.

Given:

    A                                       D
    |-0-|-1-|-2-|-3-|-4-|-5-|-6-|-7-|-8-|-9-|
    |---- 1 ----|---- 2 ----|---- 3 ----|-4-|

There would need to be at least one note during periods 1, 2, and 3.  Because 4 isn't a full 72-hour period, it doesn't require a note.  Failure to find a note in periods 1, 2, and 3 would be a FAIL.

Data:

(ENC):

    ENC_ID	ADMITTED	DISCHARGED	PERIODS PASS_FAIL
    4114221	06/15/09 18:30	06/24/09 15:40	3	?

PERIODS:	`TRUNC(CEIL((DISCHARGED - ADMITTED)/3))`

The 'PASS_FAIL' column would indicate if the encounter had an adequate number and timing of notes.

(NOTE):

    ENC_ID	NOTE_ID	NOTE_TIME	PERIOD
    4114221	1833764	06/17/09 08:42	1
    4114221	1843613	06/18/09 08:14	1
    4114221	1858159	06/18/09 20:15	2
    4114221	1850948	06/18/09 20:15	2
    4114221	1850912	06/18/09 20:18	2
    4114221	1859315	06/19/09 18:35	2
    4114221	1863982	06/20/09 10:29	2
    4114221	1868895	06/21/09 22:00	3
    4114221	1873539	06/22/09 15:42	3

PERIOD:	`CEIL((NOTE_TIME - ADMITTED)/3)`

Is there an efficient way to solve this problem?

",4
759199,04/17/2009 06:00:17,91172,04/15/2009 16:06:32,16,0,SQL Server Indexes,what is the difference between clustered index scan and clustered index seek?,sql,sql-server,,,,,open,0,12,3,SQL Server Indexes what is the difference between clustered index scan and clustered index seek?,2
8620743,12/23/2011 21:23:53,1105026,12/18/2011 23:38:47,1,0,how to filter and select specifc information form a column and add date?,"/****** how to add a date range to this querry and how can i make it better*****/


SELECT     TOP (100) 
[sitewatch].[dbo].Punchinterval.PUNCHDATE,[sitewatch].[dbo].employee.NAME,[sitewatch].[dbo].employee.CODE,
'punchin'=
    case 
        when 
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='10'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='11'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='12'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='101'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='102'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='215'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='216'
        OR
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='219'
        
        then [sitewatch].[dbo].Punchinterval.INTIME 
        else ' ' 
    end,'BreakStart'=
    case 
    when 
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='500003'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end,
    'Lunch'=
    case
    when
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='500006'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end,
    'PunchIn2'=
    case
    when
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='10'
    or 
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='11'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='12'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='101'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='102'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='215'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='216'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='219'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end,
    'Punchout'=
    case
    when
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='1'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end
    
from [sitewatch].[dbo].Punchinterval,[sitewatch].[dbo].employee
/* i'm looking to select intime of an employee in a specifc date range also their break, lunch,Second start, second_break, and punch out.",sql,query,,,,12/24/2011 05:41:20,off topic,1,421,13,"how to filter and select specifc information form a column and add date? /****** how to add a date range to this querry and how can i make it better*****/


SELECT     TOP (100) 
[sitewatch].[dbo].Punchinterval.PUNCHDATE,[sitewatch].[dbo].employee.NAME,[sitewatch].[dbo].employee.CODE,
'punchin'=
    case 
        when 
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='10'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='11'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='12'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='101'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='102'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='215'
        or
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='216'
        OR
        [sitewatch].[dbo].Punchinterval.DEPARTMENT='219'
        
        then [sitewatch].[dbo].Punchinterval.INTIME 
        else ' ' 
    end,'BreakStart'=
    case 
    when 
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='500003'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end,
    'Lunch'=
    case
    when
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='500006'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end,
    'PunchIn2'=
    case
    when
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='10'
    or 
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='11'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='12'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='101'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='102'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='215'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='216'
    or
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='219'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end,
    'Punchout'=
    case
    when
    [sitewatch].[dbo].Punchinterval.DEPARTMENT='1'
    then
    [sitewatch].[dbo].Punchinterval.INTIME
    else
    ' '
    end
    
from [sitewatch].[dbo].Punchinterval,[sitewatch].[dbo].employee
/* i'm looking to select intime of an employee in a specifc date range also their break, lunch,Second start, second_break, and punch out.",2
5604306,04/09/2011 09:59:05,699823,04/09/2011 09:59:05,1,0,Can an SQL subscription notification be properly registered for an SQL query on which it is not possible to create an indexed view?,SQL Server Service Broker - Query Notifications,sql,query,view,notifications,indexed,04/09/2011 10:07:48,not a real question,1,7,23,Can an SQL subscription notification be properly registered for an SQL query on which it is not possible to create an indexed view? SQL Server Service Broker - Query Notifications,5
11380928,07/08/2012 05:37:19,1509613,07/08/2012 05:24:25,1,0,Combine two unl files,"I have two unl files like header.unl and store.unl..
header.unl contains only column of the table where as store.unl contains output information of the table..
for example..

header.unl-->store_nbr country_code state_code

store.unl-->100 US 15

Now i want to combine both the files,also my output should be like below..
store_nbr country_code state_code
100       US           15
...       ....         ....
....      ....         ....

also i would like to get this in email.. 

Any ideas and help would be greatly appreciated..Since this is urgent for me...

Thanks,


",sql,perl,unix,informix,,07/09/2012 01:46:51,not a real question,1,114,4,"Combine two unl files I have two unl files like header.unl and store.unl..
header.unl contains only column of the table where as store.unl contains output information of the table..
for example..

header.unl-->store_nbr country_code state_code

store.unl-->100 US 15

Now i want to combine both the files,also my output should be like below..
store_nbr country_code state_code
100       US           15
...       ....         ....
....      ....         ....

also i would like to get this in email.. 

Any ideas and help would be greatly appreciated..Since this is urgent for me...

Thanks,


",4
2673457,04/20/2010 07:52:06,321048,04/20/2010 07:11:22,1,0,Help needed on an SQL configuration problem.,"I have been banging my head with this one more the two weeks, and still don't know what the problem is ( I can't narrow it down). The problem is the following. I have a solution with 3 project in it all written in c# and I with LINQ. One project is the main web site, the other is the data layer (communication with the database) and the third one is a custom little CMS. The problem is the following: On a hosting provider when I publish the site it all works perfectly, but this site was needed to be hosted on the client server so I needed to do that. But the problem is that I also needed to configure the client server, because they don't have an Administrator employed (I know, I know ;) ). For the first time I some how managed, to set it up but a problem appear. My main web site is working just as it suppose to be - it reads (communicates with) the database, but My CMS is not. It shows the first log in page, but after that when I try to log in it throws the following error:
    A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.) 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

<pre><code>Exception Details: System.Data.SqlClient.SqlException: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.)

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 


[SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.)]
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +4846887
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) +194
   System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, SqlConnection owningObject) +4860189
   System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject) +90
   System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart) +342
   System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) +221
   System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance) +189
   System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) +185
   System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) +31
   System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) +433
   System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) +66
   System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +499
   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +65
   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +117
   System.Data.SqlClient.SqlConnection.Open() +122
   System.Data.Linq.SqlClient.SqlConnectionManager.UseConnection(IConnectionUser user) +44
   System.Data.Linq.SqlClient.SqlProvider.get_IsSqlCe() +45
   System.Data.Linq.SqlClient.SqlProvider.InitializeProviderMode() +20
   System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query) +57
   System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute(Expression expression) +23
   System.Linq.Queryable.Count(IQueryable`1 source) +240
   CMS.Security.UserProfile.LoginUser() in C:\Documents and Settings\Dimitar\Desktop\New Mepso Final 08_04\CMS\Classes\UserProfile.cs:132
   CMS.Default.Login1_Authenticate(Object sender, AuthenticateEventArgs e) in C:\Documents and Settings\Dimitar\Desktop\New Mepso Final 08_04\CMS\Default.aspx.cs:37
   System.Web.UI.WebControls.Login.OnAuthenticate(AuthenticateEventArgs e) +108
   System.Web.UI.WebControls.Login.AttemptLogin() +115
   System.Web.UI.WebControls.Login.OnBubbleEvent(Object source, EventArgs e) +101
   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +37
   System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e) +118
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +166
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1565

 </code></pre>

Maybe this is a dumb question, but I cannot find the root of the problem, let alone the solution. So far I have tried the following:

-setting time out on connection string to a higher value
-configuration and after that turning off server firewall
-checking the connection string over and over again (they are the same for all three projects and are saved in web.config)

**Important notes**: I have tried executing the project from VS2008 with a connection string to the same database and the results are the same. That's why I think the problem is the SQL Server 2005 and not the IIS7.

Any bit of information is more then welcomed. ",sql,configuration,timeout,connection-string,,07/25/2012 19:04:49,too localized,1,843,7,"Help needed on an SQL configuration problem. I have been banging my head with this one more the two weeks, and still don't know what the problem is ( I can't narrow it down). The problem is the following. I have a solution with 3 project in it all written in c# and I with LINQ. One project is the main web site, the other is the data layer (communication with the database) and the third one is a custom little CMS. The problem is the following: On a hosting provider when I publish the site it all works perfectly, but this site was needed to be hosted on the client server so I needed to do that. But the problem is that I also needed to configure the client server, because they don't have an Administrator employed (I know, I know ;) ). For the first time I some how managed, to set it up but a problem appear. My main web site is working just as it suppose to be - it reads (communicates with) the database, but My CMS is not. It shows the first log in page, but after that when I try to log in it throws the following error:
    A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.) 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

<pre><code>Exception Details: System.Data.SqlClient.SqlException: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.)

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 


[SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: TCP Provider, error: 0 - A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.)]
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +4846887
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) +194
   System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, SqlConnection owningObject) +4860189
   System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject) +90
   System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart) +342
   System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) +221
   System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance) +189
   System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) +185
   System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) +31
   System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) +433
   System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) +66
   System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +499
   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +65
   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +117
   System.Data.SqlClient.SqlConnection.Open() +122
   System.Data.Linq.SqlClient.SqlConnectionManager.UseConnection(IConnectionUser user) +44
   System.Data.Linq.SqlClient.SqlProvider.get_IsSqlCe() +45
   System.Data.Linq.SqlClient.SqlProvider.InitializeProviderMode() +20
   System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query) +57
   System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute(Expression expression) +23
   System.Linq.Queryable.Count(IQueryable`1 source) +240
   CMS.Security.UserProfile.LoginUser() in C:\Documents and Settings\Dimitar\Desktop\New Mepso Final 08_04\CMS\Classes\UserProfile.cs:132
   CMS.Default.Login1_Authenticate(Object sender, AuthenticateEventArgs e) in C:\Documents and Settings\Dimitar\Desktop\New Mepso Final 08_04\CMS\Default.aspx.cs:37
   System.Web.UI.WebControls.Login.OnAuthenticate(AuthenticateEventArgs e) +108
   System.Web.UI.WebControls.Login.AttemptLogin() +115
   System.Web.UI.WebControls.Login.OnBubbleEvent(Object source, EventArgs e) +101
   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +37
   System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e) +118
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +166
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1565

 </code></pre>

Maybe this is a dumb question, but I cannot find the root of the problem, let alone the solution. So far I have tried the following:

-setting time out on connection string to a higher value
-configuration and after that turning off server firewall
-checking the connection string over and over again (they are the same for all three projects and are saved in web.config)

**Important notes**: I have tried executing the project from VS2008 with a connection string to the same database and the results are the same. That's why I think the problem is the SQL Server 2005 and not the IIS7.

Any bit of information is more then welcomed. ",4
8015104,11/04/2011 20:04:09,1030368,11/04/2011 20:00:12,1,0,Convert Select to Update statement,"I have a select statement below:

        SELECT Tokens
        FROM TextTable
        WHERE (NOT (Tokens IN
        (SELECT leksem
        FROM multiwords)))


I want to see the result of this Select query in my table. So, how do I convert this to an Update statement? ",sql,select,update,,,11/12/2011 11:52:31,not a real question,1,76,5,"Convert Select to Update statement I have a select statement below:

        SELECT Tokens
        FROM TextTable
        WHERE (NOT (Tokens IN
        (SELECT leksem
        FROM multiwords)))


I want to see the result of this Select query in my table. So, how do I convert this to an Update statement? ",3
3041716,06/14/2010 23:49:54,5618,09/10/2008 14:56:27,3863,184,What is an example of relational data and what is an example of a document?,I am looking for examples of when to use a relational data base vs when to use a document database.  ,sql,nosql,,,,06/15/2010 13:55:19,not a real question,1,22,15,What is an example of relational data and what is an example of a document? I am looking for examples of when to use a relational data base vs when to use a document database.  ,2
1046668,06/25/2009 23:16:24,118754,06/07/2009 07:45:51,205,8,Database Programming Concepts,"So I've read a couple books on SQL and I've used SQL and created databases, but really nothing advanced, a couple tables, a couple joins, that sort of thing.

So now I am working on a project that is pretty big. The database is going to have multiple tables and we will be processing 40'000 to 80'000 rows of data daily.

Now I find myself lacking some basic SQL concepts, for instance:

I have a dataset with files and file details. The files are listed in one table and the file details are listed in another. We also have a build table and fourth table that joins the build table, file table and file details table together.

The problems are like, ""How do I process the files and have the correct file details be associated with files and associated with a build?

Even my university didn't cover this and now I feel I am very out my depth.

Lets take one more example. Lets take the File Table. In my application I have 40'000 files, I need to add files that don't already exist to the file table. Do I have to search for each individual entry and add if it does not exist and skip if it does?

So my real question is, where is a good place to read up on general concepts?",sql,design,concepts,,,05/01/2012 13:56:10,not constructive,1,218,3,"Database Programming Concepts So I've read a couple books on SQL and I've used SQL and created databases, but really nothing advanced, a couple tables, a couple joins, that sort of thing.

So now I am working on a project that is pretty big. The database is going to have multiple tables and we will be processing 40'000 to 80'000 rows of data daily.

Now I find myself lacking some basic SQL concepts, for instance:

I have a dataset with files and file details. The files are listed in one table and the file details are listed in another. We also have a build table and fourth table that joins the build table, file table and file details table together.

The problems are like, ""How do I process the files and have the correct file details be associated with files and associated with a build?

Even my university didn't cover this and now I feel I am very out my depth.

Lets take one more example. Lets take the File Table. In my application I have 40'000 files, I need to add files that don't already exist to the file table. Do I have to search for each individual entry and add if it does not exist and skip if it does?

So my real question is, where is a good place to read up on general concepts?",3
3390656,08/02/2010 18:29:38,248965,01/12/2010 14:38:03,23,1,VS/SQL Mgmt Studio question - how to stop VS from opening a new SMS for each .sql file,"In my Visual Studio project I have a folder containing a number of .sql files. I have set VS to open these files with SQL Management Studio by default. The problem is that a new instance of SMS is started each time a .sql file is opened. This is really annoying when doing a project-wide Find in VS, when VS opens every single .sql file - right now I have 109 instances of SMS open!!

On another PC I don't have this problem - if SMS is already open, each new file is opened in the existing instance.

I can't see a setting in VS to control this .... how do I stop it?",sql,visual-studio,,,,,open,0,112,18,"VS/SQL Mgmt Studio question - how to stop VS from opening a new SMS for each .sql file In my Visual Studio project I have a folder containing a number of .sql files. I have set VS to open these files with SQL Management Studio by default. The problem is that a new instance of SMS is started each time a .sql file is opened. This is really annoying when doing a project-wide Find in VS, when VS opens every single .sql file - right now I have 109 instances of SMS open!!

On another PC I don't have this problem - if SMS is already open, each new file is opened in the existing instance.

I can't see a setting in VS to control this .... how do I stop it?",2
2978439,06/04/2010 23:41:06,210863,11/14/2009 01:44:39,33,2,Visual foxpro DBF update using php,"I am using php to update some tables under VFP 9.0 using ADO COM.

I am able to select and update the DBF until i specify any <b>Where</b> clause.<br>
The moment i add a where clause to the query, it simply returns or updates 0 rows.

	$conn = new COM(""ADODB.Connection"");
	$conn->Open('Provider=VFPOLEDB.1;Data Source=""C:\\testDB.dbc"";'); 

	$query = ""UPDATE TABLE1 set COL1 = \""AA\"", COL2 = \""Updated value\"" "";
	$conn->Execute($query);

	$query = ""SELECT * FROM TABLE1 "";
	$rs = $conn->Execute($query) or die(""Error in query: $query. "" . $conn->ErrorMsg());
	while (!$rs->EOF) {
		echo "" Got COL1: "" . $rs->Fields(""COL1"") . "" :: COL2: "" . $rs->Fields(""COL2"") . "" id: "" . $rs->Fields(""ID"") . ""\n"";
		$rs->MoveNext();
	}


Result:

	 Got COL1: AA :: COL2: Updated value                  id: 0
	 Got COL1: AA :: COL2: Updated value                  id: 1
	 Got COL1: AA :: COL2: Updated value                  id: 2

Code 2: With Where clause

	$query = ""UPDATE TABLE1 set COL1 = \""BB\"", COL2 = \""NEW2\"" WHERE ID = 1"";
	$conn->Execute($query);
	$query = ""SELECT * FROM TABLE1 "";
	$rs = $conn->Execute($query) or die(""Error in query: $query. "" . $conn->ErrorMsg());
	while (!$rs->EOF) {
		echo "" Got COL1: "" . $rs->Fields(""COL1"") . "" :: COL2: "" . $rs->Fields(""COL2"") . "" id: "" . $rs->Fields(""ID"") . ""\n"";
		$rs->MoveNext();
	}

Result:

	 Got COL1: AA :: COL2: Updated value                  id: 0
	 Got COL1: AA :: COL2: Updated value                  id: 1
	 Got COL1: AA :: COL2: Updated value                  id: 2

The ID column is the key in the above table. <br/>
I am relatively new to VFP. I am not sure if this a Visual Foxpro setting or something else which prevents the updates or select if done selectively.",sql,update,dbf,visual-foxpro,,,open,0,350,6,"Visual foxpro DBF update using php I am using php to update some tables under VFP 9.0 using ADO COM.

I am able to select and update the DBF until i specify any <b>Where</b> clause.<br>
The moment i add a where clause to the query, it simply returns or updates 0 rows.

	$conn = new COM(""ADODB.Connection"");
	$conn->Open('Provider=VFPOLEDB.1;Data Source=""C:\\testDB.dbc"";'); 

	$query = ""UPDATE TABLE1 set COL1 = \""AA\"", COL2 = \""Updated value\"" "";
	$conn->Execute($query);

	$query = ""SELECT * FROM TABLE1 "";
	$rs = $conn->Execute($query) or die(""Error in query: $query. "" . $conn->ErrorMsg());
	while (!$rs->EOF) {
		echo "" Got COL1: "" . $rs->Fields(""COL1"") . "" :: COL2: "" . $rs->Fields(""COL2"") . "" id: "" . $rs->Fields(""ID"") . ""\n"";
		$rs->MoveNext();
	}


Result:

	 Got COL1: AA :: COL2: Updated value                  id: 0
	 Got COL1: AA :: COL2: Updated value                  id: 1
	 Got COL1: AA :: COL2: Updated value                  id: 2

Code 2: With Where clause

	$query = ""UPDATE TABLE1 set COL1 = \""BB\"", COL2 = \""NEW2\"" WHERE ID = 1"";
	$conn->Execute($query);
	$query = ""SELECT * FROM TABLE1 "";
	$rs = $conn->Execute($query) or die(""Error in query: $query. "" . $conn->ErrorMsg());
	while (!$rs->EOF) {
		echo "" Got COL1: "" . $rs->Fields(""COL1"") . "" :: COL2: "" . $rs->Fields(""COL2"") . "" id: "" . $rs->Fields(""ID"") . ""\n"";
		$rs->MoveNext();
	}

Result:

	 Got COL1: AA :: COL2: Updated value                  id: 0
	 Got COL1: AA :: COL2: Updated value                  id: 1
	 Got COL1: AA :: COL2: Updated value                  id: 2

The ID column is the key in the above table. <br/>
I am relatively new to VFP. I am not sure if this a Visual Foxpro setting or something else which prevents the updates or select if done selectively.",4
937797,06/02/2009 03:25:50,105135,05/12/2009 04:11:46,15,0,How do you do a query in Access with a fixed amount of columns,"I want to pull data with an MS Access crosstab query so I can bind it to a report. When I load the page I get a Run-time error'3637': Cannot use the crosstab of a non-fixed column as a subquery.

I would like a way to get back a fixed grid when I run the query and if the cell is null display a zero.",sql,ms-access,crosstab,,,,open,0,64,14,"How do you do a query in Access with a fixed amount of columns I want to pull data with an MS Access crosstab query so I can bind it to a report. When I load the page I get a Run-time error'3637': Cannot use the crosstab of a non-fixed column as a subquery.

I would like a way to get back a fixed grid when I run the query and if the cell is null display a zero.",3
3788552,09/24/2010 15:28:33,457460,09/24/2010 15:28:33,1,0,SQL interview question,"I got following question on an interview:
Given a table of natural numbers with some missing ones, provide output of two tables, beginning of number gap in first table
and ending in second.
Example:
 ____    ________
|    |   |   |   |
| 1  |   | 3 | 3 |
| 2  |   | 6 | 7 |
| 4  |   | 10| 12|
| 5  |   |___|___|
| 8  |
| 9  |
| 13 |
|____|",sql,interview-questions,,,,,open,0,91,3,"SQL interview question I got following question on an interview:
Given a table of natural numbers with some missing ones, provide output of two tables, beginning of number gap in first table
and ending in second.
Example:
 ____    ________
|    |   |   |   |
| 1  |   | 3 | 3 |
| 2  |   | 6 | 7 |
| 4  |   | 10| 12|
| 5  |   |___|___|
| 8  |
| 9  |
| 13 |
|____|",2
460316,01/20/2009 07:01:04,14663,09/17/2008 01:51:17,1907,90,Are database triggers evil?,"Are database triggers a bad idea?

In my experience they are evil, because they can result in surprising side effects, and are difficult to debug (especially when one trigger fires another).  Often developers do not even think of looking if there is a trigger.

On the other hand, it seems like if you have logic that must occur evertime a new `FOO` is created in the database then the most foolproof place to put it is an insert trigger on the FOO table.

The only time we're using triggers is for really simple things like setting the `ModifiedDate`.",sql,triggers,,,,01/27/2012 13:20:45,not constructive,1,96,4,"Are database triggers evil? Are database triggers a bad idea?

In my experience they are evil, because they can result in surprising side effects, and are difficult to debug (especially when one trigger fires another).  Often developers do not even think of looking if there is a trigger.

On the other hand, it seems like if you have logic that must occur evertime a new `FOO` is created in the database then the most foolproof place to put it is an insert trigger on the FOO table.

The only time we're using triggers is for really simple things like setting the `ModifiedDate`.",2
9605540,03/07/2012 16:38:27,1169594,01/25/2012 16:05:46,10,0,HOW TO CONVERT CASE STATEMENT IN SQL TO DERIVED COLUMN INTO SSIS,"
CASE 
		WHEN CHARINDEX('%', '{FixedARMRateReductionLimit}') > 0 THEN
			CAST(SUBSTRING('{FixedARMRateReductionLimit}', 0, CHARINDEX('%', '{FixedARMRateReductionLimit}')) as decimal)/100
		WHEN '{FixedARMRateReductionLimit}' = 'Weekly PMMS Rate' THEN
			PARAM_VAL_TXT
		ELSE
			.02
	END",sql,sql-server-2008,ssis,ssis-data-transformations,,03/08/2012 16:37:27,not a real question,1,18,12,"HOW TO CONVERT CASE STATEMENT IN SQL TO DERIVED COLUMN INTO SSIS 
CASE 
		WHEN CHARINDEX('%', '{FixedARMRateReductionLimit}') > 0 THEN
			CAST(SUBSTRING('{FixedARMRateReductionLimit}', 0, CHARINDEX('%', '{FixedARMRateReductionLimit}')) as decimal)/100
		WHEN '{FixedARMRateReductionLimit}' = 'Weekly PMMS Rate' THEN
			PARAM_VAL_TXT
		ELSE
			.02
	END",4
5724618,04/20/2011 01:32:07,716243,04/20/2011 01:10:48,1,0,What is the best way to store multiple data type into database,"I am designing a database using MSSQL server 2005 to store log values from different devices.
The datatype of the values can be boolean, int-32 or 64 bit-double


There will be a lookup table called channels:
        
ID(PK)      | int32

device_name | varchar(32)  

There will be a table called 'values' to store the value. So boolean and int-32, double values  will be casted to DECIMAL datatype. 

ID(foreign key to ID@channels)  | int32

logtime                         | DATETIME

value                           | DECIMAL


The reason I do that is the end user can select data using a simple select statement on one table, such as 
'select logtime,value from values where ID = 1' without knowing the datatype of the channel.

But this is waste of memory, since now I stored int32 and boolean to Decimal. I am new to database programming, I wonder if anyone know a better way to do this?









",sql,sql-server,database,types,mixed,,open,0,204,12,"What is the best way to store multiple data type into database I am designing a database using MSSQL server 2005 to store log values from different devices.
The datatype of the values can be boolean, int-32 or 64 bit-double


There will be a lookup table called channels:
        
ID(PK)      | int32

device_name | varchar(32)  

There will be a table called 'values' to store the value. So boolean and int-32, double values  will be casted to DECIMAL datatype. 

ID(foreign key to ID@channels)  | int32

logtime                         | DATETIME

value                           | DECIMAL


The reason I do that is the end user can select data using a simple select statement on one table, such as 
'select logtime,value from values where ID = 1' without knowing the datatype of the channel.

But this is waste of memory, since now I stored int32 and boolean to Decimal. I am new to database programming, I wonder if anyone know a better way to do this?









",5
11550092,07/18/2012 20:48:37,958163,09/22/2011 02:17:16,1,0,Sql server 2008 filestream maximum number of rows,"We are using **filestreams** in **Microsoft SQL Server 2008 (SP2) - 10.0.4000.0 (X64) and Windows server 2008** to store millions of files. Since there are millions of files all of them are grouped into 100 filegroups and inserted sequntially one after another filegroup. Now we have around 15K files in each filegroup and expected to grow to 20K soon. so we want to know is there any maximum limit of rows that a filegroup can have to give optimum performance or is there any maximum on the operating system side for optimum performace as we are storing or going to store around <20K files in single folder?

Any suggestion to the right resources will also be very helpful.

Thanks.",sql,filestream,filegroup,,,07/18/2012 21:40:45,off topic,1,117,8,"Sql server 2008 filestream maximum number of rows We are using **filestreams** in **Microsoft SQL Server 2008 (SP2) - 10.0.4000.0 (X64) and Windows server 2008** to store millions of files. Since there are millions of files all of them are grouped into 100 filegroups and inserted sequntially one after another filegroup. Now we have around 15K files in each filegroup and expected to grow to 20K soon. so we want to know is there any maximum limit of rows that a filegroup can have to give optimum performance or is there any maximum on the operating system side for optimum performace as we are storing or going to store around <20K files in single folder?

Any suggestion to the right resources will also be very helpful.

Thanks.",3
7028779,08/11/2011 15:40:00,890250,08/11/2011 15:40:00,1,0,How do you read XML Data in SQL Server 2005,I have a table which has XMLData column as TEXT. How can i read the data from this column,sql,xml,,,,08/11/2011 20:43:21,not a real question,1,19,10,How do you read XML Data in SQL Server 2005 I have a table which has XMLData column as TEXT. How can i read the data from this column,2
11488105,07/14/2012 23:13:17,1526227,07/14/2012 23:09:07,1,0,SQL Server 2005 first time login,"I just installed MS SQL Server 2005. I am trying to connect to Management studio but I do not remember instance name, user name and password. I have tried in registry but that does not work. Can any one help me with it",sql,,,,,07/15/2012 08:01:01,off topic,1,43,6,"SQL Server 2005 first time login I just installed MS SQL Server 2005. I am trying to connect to Management studio but I do not remember instance name, user name and password. I have tried in registry but that does not work. Can any one help me with it",1
4217866,11/18/2010 17:44:36,512496,11/18/2010 17:44:36,1,0,Appending Text to FOR XML SQL Select Statement,"I have three `Select` statements I want to join:  

Select 2 is a `FOR XML` Select to which I want to append Selects 1 & 3 (which simply display some text) as a kind of header/footer.  

All three Selects work as intended and form three parts of a nicely-formed podcast .xml, but I need them to end up in one result so I can eventually save it to an .xml file (which will be my next headache, I suppose).  

I have tried permutations of `+`, `UNION`, and `JOIN` that my inexperienced mind can come up with, but to no avail. 

**Select #1 (simply some text)**  

    Select  '<?xml version=''1.0''?>
    <rss xmlns:itunes=""http://www.itunes.com/dtds/podcast-1.0.dtd""  xmlns:atom=""http://www.w3.org/2005/Atom"" version=""2.0"">
        <channel>
          <atom:link href=""http://www.borntowin.net/podcast/borntowin.xml"" rel=""self"" type=""application/rss+xml"" />
      <itunes:image href=""http://www.borntowin.net/Portals/0/Images/Audio/podcast_logo.jpg""/>
      <link>http://www.borntowin.net/Audio.aspx</link>
    <title>Born to Win Podcast</title>
    <description>Born to Win''s Daily Radio Broadcast and Weekly Sermon</description>
    <language>en-us</language>
    <copyright>&#xA9; 2010</copyright>
          <itunes:subtitle>Making Life Work</itunes:subtitle>
          <itunes:owner>
            <itunes:name>Christian Educational Ministries</itunes:name>
            <itunes:email>webmaster@borntowin.net</itunes:email>
          </itunes:owner>
          <itunes:category text=""Religion &amp; Spirituality"">
            <itunes:category text=""Christianity"" />
          </itunes:category>
          <itunes:explicit>No</itunes:explicit>
          <ttl> 120 </ttl>'   

**Select #2 (my data)**  

    Select 
    (Select Cast(FieldValue as nvarchar(max)) from dbo.UserDefinedData where UserDefinedFieldId = 305 and UserDefinedRowId = item.UserDefinedRowId) as [title]
    ,(Select 'Today''s Program is ' + Cast(FieldValue as nvarchar(max)) from dbo.UserDefinedData where UserDefinedFieldId = 305 and UserDefinedRowId = item.UserDefinedRowId) as [description]  
    ,(Select Cast(Cast(FieldValue as nvarchar(max)) as DateTime) from dbo.UserDefinedData where UserDefinedFieldId = 306 and UserDefinedRowId = item.UserDefinedRowId) as [pubdate]
    ,(Select 'http://www.borntowin.net/Portals/0/AudioFiles/RadioArchives/' + Cast(FieldValue as nvarchar(max)) from dbo.UserDefinedData where UserDefinedFieldId = 308 and UserDefinedRowId = item.UserDefinedRowId) as [guid]
     From 
    dbo.UserDefinedRows item
     Where 
    ModuleId = 820
     and UserDefinedRowID in (select UserDefinedRowID from UserDefinedData where UserDefinedFieldID = 306 and Cast(Cast(FieldValue as nvarchar(max)) as DateTime) between '2010-Nov-11' and '2010-Nov-18') 
     Order By 
    [pubdate] DESC
    for XML AUTO,ELEMENTS

**Select #3 (more text)**  

    Select '</channel>
    </rss>'

(I am using MS SQLSMS 2008.)
(The complex nature of the second select statement is due to the fact that it is retrieving   data from a DotNetNuke ""User-Defined Table/Form & List"" which must first be ""flattened"".)


Any help would be appreciated, Thanks.



",sql,xml,rss,dotnetnuke,podcast,,open,0,527,8,"Appending Text to FOR XML SQL Select Statement I have three `Select` statements I want to join:  

Select 2 is a `FOR XML` Select to which I want to append Selects 1 & 3 (which simply display some text) as a kind of header/footer.  

All three Selects work as intended and form three parts of a nicely-formed podcast .xml, but I need them to end up in one result so I can eventually save it to an .xml file (which will be my next headache, I suppose).  

I have tried permutations of `+`, `UNION`, and `JOIN` that my inexperienced mind can come up with, but to no avail. 

**Select #1 (simply some text)**  

    Select  '<?xml version=''1.0''?>
    <rss xmlns:itunes=""http://www.itunes.com/dtds/podcast-1.0.dtd""  xmlns:atom=""http://www.w3.org/2005/Atom"" version=""2.0"">
        <channel>
          <atom:link href=""http://www.borntowin.net/podcast/borntowin.xml"" rel=""self"" type=""application/rss+xml"" />
      <itunes:image href=""http://www.borntowin.net/Portals/0/Images/Audio/podcast_logo.jpg""/>
      <link>http://www.borntowin.net/Audio.aspx</link>
    <title>Born to Win Podcast</title>
    <description>Born to Win''s Daily Radio Broadcast and Weekly Sermon</description>
    <language>en-us</language>
    <copyright>&#xA9; 2010</copyright>
          <itunes:subtitle>Making Life Work</itunes:subtitle>
          <itunes:owner>
            <itunes:name>Christian Educational Ministries</itunes:name>
            <itunes:email>webmaster@borntowin.net</itunes:email>
          </itunes:owner>
          <itunes:category text=""Religion &amp; Spirituality"">
            <itunes:category text=""Christianity"" />
          </itunes:category>
          <itunes:explicit>No</itunes:explicit>
          <ttl> 120 </ttl>'   

**Select #2 (my data)**  

    Select 
    (Select Cast(FieldValue as nvarchar(max)) from dbo.UserDefinedData where UserDefinedFieldId = 305 and UserDefinedRowId = item.UserDefinedRowId) as [title]
    ,(Select 'Today''s Program is ' + Cast(FieldValue as nvarchar(max)) from dbo.UserDefinedData where UserDefinedFieldId = 305 and UserDefinedRowId = item.UserDefinedRowId) as [description]  
    ,(Select Cast(Cast(FieldValue as nvarchar(max)) as DateTime) from dbo.UserDefinedData where UserDefinedFieldId = 306 and UserDefinedRowId = item.UserDefinedRowId) as [pubdate]
    ,(Select 'http://www.borntowin.net/Portals/0/AudioFiles/RadioArchives/' + Cast(FieldValue as nvarchar(max)) from dbo.UserDefinedData where UserDefinedFieldId = 308 and UserDefinedRowId = item.UserDefinedRowId) as [guid]
     From 
    dbo.UserDefinedRows item
     Where 
    ModuleId = 820
     and UserDefinedRowID in (select UserDefinedRowID from UserDefinedData where UserDefinedFieldID = 306 and Cast(Cast(FieldValue as nvarchar(max)) as DateTime) between '2010-Nov-11' and '2010-Nov-18') 
     Order By 
    [pubdate] DESC
    for XML AUTO,ELEMENTS

**Select #3 (more text)**  

    Select '</channel>
    </rss>'

(I am using MS SQLSMS 2008.)
(The complex nature of the second select statement is due to the fact that it is retrieving   data from a DotNetNuke ""User-Defined Table/Form & List"" which must first be ""flattened"".)


Any help would be appreciated, Thanks.



",5
4368819,12/06/2010 16:47:49,532590,12/06/2010 16:47:49,1,0,SQL Conditional Column Existence,"Can I somehow select a column if exists in a view, but ignore the column if it does not exist?

    SELECT
    	CASE
    		WHEN EXISTS(SELECT 1 FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'MyView' AND COLUMN_NAME = 'MyColumn')
    			THEN MyView.MyColumn
    		ELSE NULL
    	END AS [Sometimes]
    FROM
    	MyView

Right now, that returns a ""Msg 207 Invalid column name"" error.

Perhaps some option to ignore that error is possible?
",sql,conditional,exists,,,,open,0,86,4,"SQL Conditional Column Existence Can I somehow select a column if exists in a view, but ignore the column if it does not exist?

    SELECT
    	CASE
    		WHEN EXISTS(SELECT 1 FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'MyView' AND COLUMN_NAME = 'MyColumn')
    			THEN MyView.MyColumn
    		ELSE NULL
    	END AS [Sometimes]
    FROM
    	MyView

Right now, that returns a ""Msg 207 Invalid column name"" error.

Perhaps some option to ignore that error is possible?
",3
8981329,01/24/2012 02:22:50,1067943,11/27/2011 14:26:06,79,0,How to call a function from SQL stored procedure,"I have function that have been colled in stored procedure.
The function returns a table and have to fill another table.
Maybe this queistion might be seems a little naive but im a newer in T-SQL.
Thank you in advance.
",sql,stored-procedures,sql-function,,,,open,0,37,9,"How to call a function from SQL stored procedure I have function that have been colled in stored procedure.
The function returns a table and have to fill another table.
Maybe this queistion might be seems a little naive but im a newer in T-SQL.
Thank you in advance.
",3
7512745,09/22/2011 09:43:34,958798,09/22/2011 09:43:34,1,0,Newbie needs to multiple select of the same table,"I have a single table with people's info such as fname, lname, id, and their mother id and father id. The same table also contains information whether people are dead or alive. I'd like to bring up the information containing childs' fname and lname, as well as their parent's id, fname and lname, but only those records where parents are dead. So far I've done this, but it only selects children who are dead, not parents (status 5 is deceased). 

    select * from A1 where (IDFather IS NOT NULL and IDMother IS NOT NULL) and [Status]   = '5'


    Table sample below:
    ID Family Name Status IDFather IDMother
    001  Watson Jason  1    123      321
    002  Smith  Matt   5    333      111
    003  Smith  Mike   1    002      NULL
    004  Derulo Sam    5    NULL     NULL
    005  Pitt   Jenny  1    NULL     004

I tried this statement:

    select * from Table1 where [Status] = '5'
 I then wrote a select statement in C#

    select ID,Name,Family from Table1 where IDFather = ""value"" or IDMother = ""value""

At the end of the day I need the fname, lname of the child and fname and lname of their parents with parents id number.
Thanks for the help!
Jennifer",sql,sql-server,tsql,,,,open,0,284,9,"Newbie needs to multiple select of the same table I have a single table with people's info such as fname, lname, id, and their mother id and father id. The same table also contains information whether people are dead or alive. I'd like to bring up the information containing childs' fname and lname, as well as their parent's id, fname and lname, but only those records where parents are dead. So far I've done this, but it only selects children who are dead, not parents (status 5 is deceased). 

    select * from A1 where (IDFather IS NOT NULL and IDMother IS NOT NULL) and [Status]   = '5'


    Table sample below:
    ID Family Name Status IDFather IDMother
    001  Watson Jason  1    123      321
    002  Smith  Matt   5    333      111
    003  Smith  Mike   1    002      NULL
    004  Derulo Sam    5    NULL     NULL
    005  Pitt   Jenny  1    NULL     004

I tried this statement:

    select * from Table1 where [Status] = '5'
 I then wrote a select statement in C#

    select ID,Name,Family from Table1 where IDFather = ""value"" or IDMother = ""value""

At the end of the day I need the fname, lname of the child and fname and lname of their parents with parents id number.
Thanks for the help!
Jennifer",3
9914911,03/28/2012 20:10:40,1208233,02/14/2012 03:30:44,56,6,SQL LIMIT doesn work as excepted,"I always thought that <b>""LIMIT""</b> in query selects only between numbers i set.

Suppose, I have two colums to be selected with primary key - id. Have 90 rows.

`SELECT name, lastname FROM some_table WHERE id = '123' LIMIT 0, 30` - will select exacly 30 rows. ok, but `SELECT name, lastname FROM some_table WHERE id = '123' LIMIT 30, 60` will select more that 30 rows. Well, I am doing this for AJAX paginator using PHP+mysql. How can i do this right way?",sql,,,,,,open,0,82,6,"SQL LIMIT doesn work as excepted I always thought that <b>""LIMIT""</b> in query selects only between numbers i set.

Suppose, I have two colums to be selected with primary key - id. Have 90 rows.

`SELECT name, lastname FROM some_table WHERE id = '123' LIMIT 0, 30` - will select exacly 30 rows. ok, but `SELECT name, lastname FROM some_table WHERE id = '123' LIMIT 30, 60` will select more that 30 rows. Well, I am doing this for AJAX paginator using PHP+mysql. How can i do this right way?",1
3465489,08/12/2010 07:16:45,396608,07/20/2010 09:10:12,1,0,fastest way to search text value for words in SQL Server 2008 ,"I have a requirement to identify keywords stored in a table column in text passed to a stord procedure, at present I'm pasing the text in as rows in a table value, however as populating the table value is hideously slow, I'm going to scrap this approach. I looked at the full text search option, however based on my very limited understanding of this, specifically:-

1. The data has to already reside in a database table column.

2. I cannot see any obvious way of using freetext or contains such that the words / expressions you are searching for can be passed into this en mass from another database table.

Can someone please give me some ideas and suggestions here.",sql,sql-server-2008,server,,,,open,0,117,13,"fastest way to search text value for words in SQL Server 2008  I have a requirement to identify keywords stored in a table column in text passed to a stord procedure, at present I'm pasing the text in as rows in a table value, however as populating the table value is hideously slow, I'm going to scrap this approach. I looked at the full text search option, however based on my very limited understanding of this, specifically:-

1. The data has to already reside in a database table column.

2. I cannot see any obvious way of using freetext or contains such that the words / expressions you are searching for can be passed into this en mass from another database table.

Can someone please give me some ideas and suggestions here.",3
7662800,10/05/2011 14:20:55,941058,09/12/2011 17:32:29,38,1,How do you Select TOP x but still get a COUNT of the whole query?,"I'm writing a webpage to interactively filter results based on filter criteria as it is specified by the user.  I only want to return from SQL the TOP 20 rows but I want to know how many rows met the criteria (Count).  I want to be able to tell the user: ""here are the top 20 rows matching your criteria, and BTW, there were 2,000 additional rows I'm not showing here"".

I know I could simply run the query twice but EWWWW that's expensive and wasteful.  How can I achieve what I want without over taxing the database?",sql,,,,,,open,0,100,15,"How do you Select TOP x but still get a COUNT of the whole query? I'm writing a webpage to interactively filter results based on filter criteria as it is specified by the user.  I only want to return from SQL the TOP 20 rows but I want to know how many rows met the criteria (Count).  I want to be able to tell the user: ""here are the top 20 rows matching your criteria, and BTW, there were 2,000 additional rows I'm not showing here"".

I know I could simply run the query twice but EWWWW that's expensive and wasteful.  How can I achieve what I want without over taxing the database?",1
4751946,01/20/2011 20:01:56,444871,09/11/2010 00:51:27,19,0,MSSQL use left join to select a column from two tables as a single column,"i am trying to build a select query that will essentially left join two tables and display one column from each table as a single column.

the table structure is similar to:
table a:
id, data

table b:
id, tablea_id, data

i am trying to get a single column of a.data and b.data (with no dupes or nulls ideally).

when searching for a solution, perhaps my wording is bad, but i can't find any examples.

thanks for any help.

",sql,sql-server,join,left,,,open,0,71,15,"MSSQL use left join to select a column from two tables as a single column i am trying to build a select query that will essentially left join two tables and display one column from each table as a single column.

the table structure is similar to:
table a:
id, data

table b:
id, tablea_id, data

i am trying to get a single column of a.data and b.data (with no dupes or nulls ideally).

when searching for a solution, perhaps my wording is bad, but i can't find any examples.

thanks for any help.

",4
10802191,05/29/2012 15:28:41,1424049,05/29/2012 15:13:25,1,0,Using meteor with postgresql,"I want to use meteor to connect to our relational database (postgreslq). Is there any experience in connection meteor to other databases?

I guess we have to write our own connector to use the nice features of meteor with postgresql.


",sql,postgresql,meteor,,,,open,0,39,4,"Using meteor with postgresql I want to use meteor to connect to our relational database (postgreslq). Is there any experience in connection meteor to other databases?

I guess we have to write our own connector to use the nice features of meteor with postgresql.


",3
9084088,01/31/2012 17:28:47,1180805,01/31/2012 16:31:30,1,0,how to check if a key of a record is used in other tables az foreign key ( sql )?,"I have a table that its primary key ""ID"" field is used in many other table as foreign key.
so.. how can i realize that a record from this table ( for example first record ""ID = 1"" ) is used in other table ??
I don't want to select from all other tables to understand it cause tables are so many and relations either. I searched for a solution, there were no working solutions or I got it wrong. Please help. 
",sql,sql-server,sql-server-2008,,,,open,0,81,20,"how to check if a key of a record is used in other tables az foreign key ( sql )? I have a table that its primary key ""ID"" field is used in many other table as foreign key.
so.. how can i realize that a record from this table ( for example first record ""ID = 1"" ) is used in other table ??
I don't want to select from all other tables to understand it cause tables are so many and relations either. I searched for a solution, there were no working solutions or I got it wrong. Please help. 
",3
9663734,03/12/2012 08:24:24,196210,10/25/2009 15:26:47,197,5,Oracle: creating a query that gives a score to a record (using IF ELSE in a query),Should I use something like SUM(IF... sintax)?,sql,oracle,,,,03/12/2012 18:18:27,not a real question,1,7,17,Oracle: creating a query that gives a score to a record (using IF ELSE in a query) Should I use something like SUM(IF... sintax)?,2
6580190,07/05/2011 09:01:02,49886,12/29/2008 16:27:41,835,15,Looking for books on relational and non relational databases,"Since I'm currently dealing with existential questions about relational and non-relational databases

(see http://stackoverflow.com/questions/5984873/is-it-possible-to-implement-multi-version-concurrency-control-mvcc-on-top-of-mo, 

http://stackoverflow.com/questions/5438500/example-of-a-task-that-a-nosql-database-cant-handle-if-any 

http://stackoverflow.com/questions/5537779/multiple-tables-need-one-to-many-relationship
 )

I realize that I probably need to learn some theoretical stuff about databases in general, how they are implemented, common algorithms and theorems they use. 

For example I would like to learn what can I expect with databases with limited support of transactions like mongodb, if I can move the needed logic to the application layer, and what I should expect in term of performances. 

A perfect book should contain elements for answering those questions, for example by describing 2 phases commits (3-PC and more if they exists...), locks,  MVCC, relational and non-relational databases, and ideally things I cannot yet think about ;-)

I'm not afraid of mathematic formulas to fully understand things, but it would be better if ins and outs were written in plain text to get rapidly an overview of the subject (like in the Cormen book on algorithms for example). 

Thanks,",sql,database,books,nosql,theory,07/10/2011 12:00:18,not a real question,1,160,9,"Looking for books on relational and non relational databases Since I'm currently dealing with existential questions about relational and non-relational databases

(see http://stackoverflow.com/questions/5984873/is-it-possible-to-implement-multi-version-concurrency-control-mvcc-on-top-of-mo, 

http://stackoverflow.com/questions/5438500/example-of-a-task-that-a-nosql-database-cant-handle-if-any 

http://stackoverflow.com/questions/5537779/multiple-tables-need-one-to-many-relationship
 )

I realize that I probably need to learn some theoretical stuff about databases in general, how they are implemented, common algorithms and theorems they use. 

For example I would like to learn what can I expect with databases with limited support of transactions like mongodb, if I can move the needed logic to the application layer, and what I should expect in term of performances. 

A perfect book should contain elements for answering those questions, for example by describing 2 phases commits (3-PC and more if they exists...), locks,  MVCC, relational and non-relational databases, and ideally things I cannot yet think about ;-)

I'm not afraid of mathematic formulas to fully understand things, but it would be better if ins and outs were written in plain text to get rapidly an overview of the subject (like in the Cormen book on algorithms for example). 

Thanks,",5
4514320,12/22/2010 22:33:14,494199,11/02/2010 01:22:36,9,3,SQL 2005: How to use GROUP BY with a sub query,"The following very simple query 

    select distinct guid, browser_agent
    from tblMyGlossary
    where browser_agent is not null

provides the following results:

    guid         browser_agent
    367DE2B8-88A5-4DA9-ACBB-C0864493DC1F Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727)
    5DCB918E-DA56-4545-A4E3-D09B1B803422 Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727)
    998B8F37-2C9A-49EB-AA0B-CF88C4CC7BDF Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5
    A0DD3BCB-E8A9-4434-A869-C343FB21F993 Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727)

Ii want to be able to count the number of unique browser_agent strings, so I am performing the following query:

    select browser_agent, count(browser_agent) as 'count'
    from
    (
     select distinct guid, browser_agent
     from tblMyGlossary
     where browser_agent is not null
    )
    group by browser_agent
    order by 'count' desc;

Problem is SQL 2005 is complaining:

*Msg 156, Level 15, State 1, Line 8
Incorrect syntax near the keyword 'group'.*

Can anyone shed any light on how to resolve this please? I've run out of ideas.

Many thanks,

Mark

",sql,sql-server-2005,,,,,open,0,215,11,"SQL 2005: How to use GROUP BY with a sub query The following very simple query 

    select distinct guid, browser_agent
    from tblMyGlossary
    where browser_agent is not null

provides the following results:

    guid         browser_agent
    367DE2B8-88A5-4DA9-ACBB-C0864493DC1F Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727)
    5DCB918E-DA56-4545-A4E3-D09B1B803422 Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727)
    998B8F37-2C9A-49EB-AA0B-CF88C4CC7BDF Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5
    A0DD3BCB-E8A9-4434-A869-C343FB21F993 Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727)

Ii want to be able to count the number of unique browser_agent strings, so I am performing the following query:

    select browser_agent, count(browser_agent) as 'count'
    from
    (
     select distinct guid, browser_agent
     from tblMyGlossary
     where browser_agent is not null
    )
    group by browser_agent
    order by 'count' desc;

Problem is SQL 2005 is complaining:

*Msg 156, Level 15, State 1, Line 8
Incorrect syntax near the keyword 'group'.*

Can anyone shed any light on how to resolve this please? I've run out of ideas.

Many thanks,

Mark

",2
4745195,01/20/2011 09:07:53,582670,01/20/2011 08:46:04,1,0,Products pricing structure - modeling problem,"I need to model a rather complex pricing structure for some of our products.

Today we lookup the prices manually. Here's a picture with explanations of the ""matrix"" that we use today: [Sample model][1] (sorry for the link - but I'm not allowed to post images because I've just opened my account.)


Now I need to transfer this model to a RDBMS system (SQL Server 2008 R2). The entry point when looking up a price is the Category, then the yearly interval and finally the interval depending on how many products we're selling on this order. The result of the quesry should be two prices.

Do you have any suggestions on how to model this? I was thinking of modeling it as a matrix with a `RowNumber`, `CellNumber` and a `CellValue`. But then I need another table for describing what is contained in each cell (by referencing the row and cell numbers). If doing that, I could just include the prices in that description table. But that doesn't seem like the best solution.

Do you have any hints/solutions on how to model this problem the best way?


  [1]: http://i.stack.imgur.com/1lsvU.png",sql,sql-server-2008,data-modeling,,,,open,0,186,6,"Products pricing structure - modeling problem I need to model a rather complex pricing structure for some of our products.

Today we lookup the prices manually. Here's a picture with explanations of the ""matrix"" that we use today: [Sample model][1] (sorry for the link - but I'm not allowed to post images because I've just opened my account.)


Now I need to transfer this model to a RDBMS system (SQL Server 2008 R2). The entry point when looking up a price is the Category, then the yearly interval and finally the interval depending on how many products we're selling on this order. The result of the quesry should be two prices.

Do you have any suggestions on how to model this? I was thinking of modeling it as a matrix with a `RowNumber`, `CellNumber` and a `CellValue`. But then I need another table for describing what is contained in each cell (by referencing the row and cell numbers). If doing that, I could just include the prices in that description table. But that doesn't seem like the best solution.

Do you have any hints/solutions on how to model this problem the best way?


  [1]: http://i.stack.imgur.com/1lsvU.png",3
10509819,05/09/2012 04:23:50,1278121,03/19/2012 08:17:01,11,1,Convert SQL to HQL | Order By with LEFT(not join),"I am trying to order a result set based on partial order of a column using the following query:  

>select ID,NAME from person order by LEFT(NAME,2) desc  

How can I write an equivalent Hibernate Criteria/HQL?  

I have looked up in the Hibernate Reference manual, I am not able to find anything that relates to the LEFT sql-function.
I am working on DB2, hibernate version is 3.2.3.",sql,hibernate,order-by,,,,open,0,68,10,"Convert SQL to HQL | Order By with LEFT(not join) I am trying to order a result set based on partial order of a column using the following query:  

>select ID,NAME from person order by LEFT(NAME,2) desc  

How can I write an equivalent Hibernate Criteria/HQL?  

I have looked up in the Hibernate Reference manual, I am not able to find anything that relates to the LEFT sql-function.
I am working on DB2, hibernate version is 3.2.3.",3
3252431,07/15/2010 04:17:38,364843,06/11/2010 18:38:40,471,40,How does one pronounce COALESCE?,I've searched around the net.  I have never heard anyone say this aloud and would feel foolish saying it funny. I'm thinking ko - al - es,sql,,,,,07/15/2010 04:59:23,off topic,1,28,5,How does one pronounce COALESCE? I've searched around the net.  I have never heard anyone say this aloud and would feel foolish saying it funny. I'm thinking ko - al - es,1
6294837,06/09/2011 14:53:37,752684,05/13/2011 15:54:45,38,0,SQL Query wildcard,"Is there a way to do a SQL query with a wildcard or search for with contain.

Currently users can search my database for an address.  Using the LIKE command they can search for 123 Fake St.  But is there a way to perform a search using 123, and then have it display all the addresses that have 123 in them.  Example:  Search for 123  -> Results: 123 Fake St, 123 Spooner Ave, 123 Example Terrace.

Is there a way to perform a search like that?  My code for the current search function is below:  On the previous page the user enters an address they want to search for,  that value is stored in $street.

$sql = (""SELECT  sitestreet FROM  `PropertyInfo` WHERE  `sitestreet` LIKE  '$street' AND `user` LIKE '$user'"");
$result = mysql_query($sql);

Thanks!",sql,query,search,,,,open,0,140,3,"SQL Query wildcard Is there a way to do a SQL query with a wildcard or search for with contain.

Currently users can search my database for an address.  Using the LIKE command they can search for 123 Fake St.  But is there a way to perform a search using 123, and then have it display all the addresses that have 123 in them.  Example:  Search for 123  -> Results: 123 Fake St, 123 Spooner Ave, 123 Example Terrace.

Is there a way to perform a search like that?  My code for the current search function is below:  On the previous page the user enters an address they want to search for,  that value is stored in $street.

$sql = (""SELECT  sitestreet FROM  `PropertyInfo` WHERE  `sitestreet` LIKE  '$street' AND `user` LIKE '$user'"");
$result = mysql_query($sql);

Thanks!",3
2166690,01/30/2010 03:18:33,37181,11/13/2008 00:04:49,2323,83,SQLite Equivilant of PostgreSQL GREATEST() Function,"Postgres has a useful function called GREATEST (which returns the largest value of those passed to it, documented here: http://www.postgresql.org/docs/8.4/interactive/functions-conditional.html), is there any equivalent in SQLite? 

As a note, I only need it to work with 2 arguments.",sql,sqlite,postgresql,,,,open,0,38,6,"SQLite Equivilant of PostgreSQL GREATEST() Function Postgres has a useful function called GREATEST (which returns the largest value of those passed to it, documented here: http://www.postgresql.org/docs/8.4/interactive/functions-conditional.html), is there any equivalent in SQLite? 

As a note, I only need it to work with 2 arguments.",3
4085683,11/03/2010 09:34:09,454220,05/25/2010 16:33:08,34,0,Complicated SQL Queries,What is the most complicated database query you have ever executed? How much time did it take?,sql,query,,,,11/03/2010 09:48:17,not constructive,1,17,3,Complicated SQL Queries What is the most complicated database query you have ever executed? How much time did it take?,2
8074188,11/10/2011 02:05:20,82368,03/25/2009 04:27:50,1803,33,Books on optimizing and refactoring SQL stored procedures,"Can you please recommend resources to write efficient store procedures, refactor and optimize them?

Thank you.",sql,sql-server,stored-procedures,,,11/10/2011 06:49:50,not constructive,1,15,8,"Books on optimizing and refactoring SQL stored procedures Can you please recommend resources to write efficient store procedures, refactor and optimize them?

Thank you.",3
11178839,06/24/2012 15:51:05,584081,01/21/2011 06:59:32,397,1,SQL Server Configuration Manager 2012,"I have Installed Microsoft SQL Server 2012 Express , but I cant find SQL Server Services to run it , so I can connect to SQL server ![SQL Server Configuration Manager 2012][1] , how would I add it , so I can run it?


  [1]: http://i.stack.imgur.com/ioyHV.jpg",sql,sql-server-2012,,,,06/24/2012 16:44:34,off topic,1,47,5,"SQL Server Configuration Manager 2012 I have Installed Microsoft SQL Server 2012 Express , but I cant find SQL Server Services to run it , so I can connect to SQL server ![SQL Server Configuration Manager 2012][1] , how would I add it , so I can run it?


  [1]: http://i.stack.imgur.com/ioyHV.jpg",2
11543862,07/18/2012 14:35:36,854188,07/20/2011 14:50:30,1,0,Which edition of SQL Server express,"I am looking to learn SQL server - specifically T-SQL programming, writing stored procedures etc and getting familiar...

I had a look at the MS site to download SQL Server express, however it gives me the below choices. Can someone please advise which should be the correct option considering my learning goal ?



SQL Server Express with Tools (with LocalDB, Includes the database engine and SQL Server Management Studio Express)

SQL Server Management Studio Express (Tools only)

SQL Server Express LocalDB (MSI installer)

SQL Server Express with Advanced Services (contains the database engine, Express Tools, Reporting Services, and Full Text Search)

SQL Server Express (Containing only the database engine)

These are present on below site -

http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx


",sql,express,edition,,,07/19/2012 06:33:04,off topic,1,109,6,"Which edition of SQL Server express I am looking to learn SQL server - specifically T-SQL programming, writing stored procedures etc and getting familiar...

I had a look at the MS site to download SQL Server express, however it gives me the below choices. Can someone please advise which should be the correct option considering my learning goal ?



SQL Server Express with Tools (with LocalDB, Includes the database engine and SQL Server Management Studio Express)

SQL Server Management Studio Express (Tools only)

SQL Server Express LocalDB (MSI installer)

SQL Server Express with Advanced Services (contains the database engine, Express Tools, Reporting Services, and Full Text Search)

SQL Server Express (Containing only the database engine)

These are present on below site -

http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx


",3
11539949,07/18/2012 11:10:15,1312649,04/04/2012 10:58:24,1,1,Why return wouldn't work in this Dynamic Querry? What is it I am missing?,"   set @SQLQ0='if exists(select * from '+@INTERID+'..TESTTABLE where testid='''+rtrim(@testid)+''') begin return end'   
--print @SQLQ0 

exec(@SQLQ0)",sql,,,,,07/19/2012 11:39:53,not a real question,1,19,14,"Why return wouldn't work in this Dynamic Querry? What is it I am missing?    set @SQLQ0='if exists(select * from '+@INTERID+'..TESTTABLE where testid='''+rtrim(@testid)+''') begin return end'   
--print @SQLQ0 

exec(@SQLQ0)",1
3005662,06/09/2010 12:16:01,306028,03/31/2010 13:12:36,77,1,How to force a SQL-Server 2008 database to go Offline,"How do I force my Database to go Offline, in no regards to what or who is is allready using it?

I tried:

    ALTER DATABASE database-name SET OFFLINE;

But it's still hanging af 7min.

I want this because I need to test the senario.

If it's even possible?",sql,sql-server-2008,,,,,open,0,47,10,"How to force a SQL-Server 2008 database to go Offline How do I force my Database to go Offline, in no regards to what or who is is allready using it?

I tried:

    ALTER DATABASE database-name SET OFFLINE;

But it's still hanging af 7min.

I want this because I need to test the senario.

If it's even possible?",2
5258123,03/10/2011 10:07:44,466761,10/05/2010 11:36:44,684,49,SQL: Will setting IDENTITY_INSERT ON disable updating the table's identity table?,"All,

I'm currently working on a data migration project and for performance related issues, I want to predefine a set of identities rather then letting the tables generate them themselves.

I found it's not easy to add the `identity` property to a column, so I want to use `IDENTITY_INSERT ON` statement.

My question is: would this disable updates to the table's identity table (which is impacting performance), or do I need to truly remove the `identity` property of the colmun(s)?

Thanks in advance for your time&help!",sql,performance,identity-column,,,,open,0,82,11,"SQL: Will setting IDENTITY_INSERT ON disable updating the table's identity table? All,

I'm currently working on a data migration project and for performance related issues, I want to predefine a set of identities rather then letting the tables generate them themselves.

I found it's not easy to add the `identity` property to a column, so I want to use `IDENTITY_INSERT ON` statement.

My question is: would this disable updates to the table's identity table (which is impacting performance), or do I need to truly remove the `identity` property of the colmun(s)?

Thanks in advance for your time&help!",3
5652997,04/13/2011 17:13:12,663896,03/17/2011 07:52:14,26,1,Qt QSqlTableModel,"Please could you give me an advice. I am using QSqlTableModel class to access the database table and QTableView to view it. What signal of what instance should I handle to know about user move the cursor in QTableView?

I want to update the content of TableView B after the cursor moved in QTableView A (Table B have foreign keys to table A in database)

May be somewhat from this http://doc.trolltech.com/latest/qabstractitemmodel.html?

Thanks.",sql,qt,qtableview,,,,open,0,69,2,"Qt QSqlTableModel Please could you give me an advice. I am using QSqlTableModel class to access the database table and QTableView to view it. What signal of what instance should I handle to know about user move the cursor in QTableView?

I want to update the content of TableView B after the cursor moved in QTableView A (Table B have foreign keys to table A in database)

May be somewhat from this http://doc.trolltech.com/latest/qabstractitemmodel.html?

Thanks.",3
8225997,11/22/2011 11:24:26,1025915,11/02/2011 15:08:20,71,8,SSRS Management Studio SQL no record,"Is there a command similar to COALESCE that you can use when no record exists but when reporting is being brought through as a blank value.

I already have a COALESCE statement which is putting 0 in place of NULL and I now need to have 0 in the place of any blank values which remain.",sql,sql-server,,sql-management-studio,coalesce,11/22/2011 14:31:49,not a real question,1,55,6,"SSRS Management Studio SQL no record Is there a command similar to COALESCE that you can use when no record exists but when reporting is being brought through as a blank value.

I already have a COALESCE statement which is putting 0 in place of NULL and I now need to have 0 in the place of any blank values which remain.",4
6593024,07/06/2011 07:37:34,617619,02/15/2011 10:47:28,11,0,ASP.NET MVC SQL server error using godaddy,"I have an MVC 2 project where I have my own *.mdf file in the App_Data directory. My project works perfect. But when I uploaded it to my host, GoDaddy, it gave me an error.

error message:

Server Error in '/' Application.
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.Data.SqlClient.SqlException: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Please help. Thanks.",sql,asp.net-mvc-2,godaddy,.mdf,,07/07/2011 03:58:52,off topic,1,204,7,"ASP.NET MVC SQL server error using godaddy I have an MVC 2 project where I have my own *.mdf file in the App_Data directory. My project works perfect. But when I uploaded it to my host, GoDaddy, it gave me an error.

error message:

Server Error in '/' Application.
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.Data.SqlClient.SqlException: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Please help. Thanks.",4
7655376,10/05/2011 00:05:45,182954,10/02/2009 07:49:16,937,20,What are recent advances in relational databases?,"I'm wondering what are recent advances in relational database theory and related domains? I'm interested in new approaches, query languages (alternatives to SQL and/or extensions to it), products (proprietary and open source, though I'm much more interested in open source) and research projects developed in last years.",sql,database,relational-database,relational,relational-algebra,10/05/2011 01:06:03,off topic,1,47,7,"What are recent advances in relational databases? I'm wondering what are recent advances in relational database theory and related domains? I'm interested in new approaches, query languages (alternatives to SQL and/or extensions to it), products (proprietary and open source, though I'm much more interested in open source) and research projects developed in last years.",5
8083010,11/10/2011 16:38:52,962242,09/24/2011 03:57:02,6,0,Optimal SQL query,"I have a list of ids and need to retrieve each record by id. Our application uses hibernate as ORM framework. What is the optimal way of querying? Using hibernate's find(id) for each id or execute a sql query with where in clause passing list of ids.

Thanks
Bala",sql,hibernate,query-optimization,,,11/10/2011 20:56:48,not a real question,1,47,3,"Optimal SQL query I have a list of ids and need to retrieve each record by id. Our application uses hibernate as ORM framework. What is the optimal way of querying? Using hibernate's find(id) for each id or execute a sql query with where in clause passing list of ids.

Thanks
Bala",3
9970976,04/02/2012 04:39:22,567812,01/08/2011 06:27:25,180,6,"How to do ""GROUP BY"" mathematically?","I have a data structure of key value pairs and I want to implement ""GROUP BY"" value.
Both keys and values are strings.

So what I did was I gave every value(string) a unique ""prime number"", then for every key I stored the multiplication of all the prime numbers associated with different values that a particular key have.
So if key ""Anirudh"" has values ""x"",""y"",""z"" then I store the number M(Key) =  2*3*5 = 30 as well.
Later if I want to do group by a particular value ""x""(say) then I just iterate over all the keys, and divide the M(key) by the prime number associated with ""x"". I check if the remainder is 0. If it is zero then that particular ""key"" is a part of group by for valuer ""x"".

I know that this is the most weird way to do it. Some people sort the key value pairs(sorted by values). I could have also created another table(hash table) already grouped by ""values"". So I want to know a better method than mine (there must be many). In my method as the number of unique values for a particular key increases the product of prime number also increases (that too exponentially). 

Thanks in advance for helping me out.

",sql,database,group-by,grouping,key-value,,open,0,206,6,"How to do ""GROUP BY"" mathematically? I have a data structure of key value pairs and I want to implement ""GROUP BY"" value.
Both keys and values are strings.

So what I did was I gave every value(string) a unique ""prime number"", then for every key I stored the multiplication of all the prime numbers associated with different values that a particular key have.
So if key ""Anirudh"" has values ""x"",""y"",""z"" then I store the number M(Key) =  2*3*5 = 30 as well.
Later if I want to do group by a particular value ""x""(say) then I just iterate over all the keys, and divide the M(key) by the prime number associated with ""x"". I check if the remainder is 0. If it is zero then that particular ""key"" is a part of group by for valuer ""x"".

I know that this is the most weird way to do it. Some people sort the key value pairs(sorted by values). I could have also created another table(hash table) already grouped by ""values"". So I want to know a better method than mine (there must be many). In my method as the number of unique values for a particular key increases the product of prime number also increases (that too exponentially). 

Thanks in advance for helping me out.

",5
11317551,07/03/2012 19:09:09,49742,12/29/2008 05:29:51,4512,16,Joining tables based on values from other tables,"I have the following tables. I want to run a query but I think my beginner tsql level won't help here.. It probably also is a situation where I have a bad database design.

![tables][1]


  [1]: http://i.stack.imgur.com/Do2bg.gif

Basically I need to select all fields from tblPhotoGalleries. Also I need to create a seperate field named GalleryCategoryName.

GalleryCategoryName field will be the pCatName in tblPhotoGalleryCats.

If pCatName in tblPhotoGalleryCats = '0', then that would mean, ConnectedNewsCatID is something other than 0. In that case;

GalleryCategoryName will be the CategoryName field from tblNewsCategories where CategoryID = ConnectedNewsCatID

Any help would be appreciated.",sql,tsql,,,,,open,0,95,8,"Joining tables based on values from other tables I have the following tables. I want to run a query but I think my beginner tsql level won't help here.. It probably also is a situation where I have a bad database design.

![tables][1]


  [1]: http://i.stack.imgur.com/Do2bg.gif

Basically I need to select all fields from tblPhotoGalleries. Also I need to create a seperate field named GalleryCategoryName.

GalleryCategoryName field will be the pCatName in tblPhotoGalleryCats.

If pCatName in tblPhotoGalleryCats = '0', then that would mean, ConnectedNewsCatID is something other than 0. In that case;

GalleryCategoryName will be the CategoryName field from tblNewsCategories where CategoryID = ConnectedNewsCatID

Any help would be appreciated.",2
2865844,05/19/2010 13:24:00,344319,05/18/2010 17:46:45,16,0,The IMPORTANCE of Indexes on Tables in SQL,"I always knew proper indexes were important, but hadn't realized just HOW important until recently.
We purchased an off-the-shelf eCommerce solution and implemented it. The SQL server CPU utilization would skyrocket to 99% when we hit about 600 concurrent users. 
After some investigation, I found that the Users table was NOT indexed properly. I added a couple indexes, built them, and as soon as I did that I watched the CPU utilization DROP IMMEDIATELY to 10%.

I couldn't believe my eyes. At THAT second I realized just how important proper indexes truly are.

Anyone else experience an eye-opener like this?",sql,index,,,,05/19/2010 13:26:40,not a real question,1,97,8,"The IMPORTANCE of Indexes on Tables in SQL I always knew proper indexes were important, but hadn't realized just HOW important until recently.
We purchased an off-the-shelf eCommerce solution and implemented it. The SQL server CPU utilization would skyrocket to 99% when we hit about 600 concurrent users. 
After some investigation, I found that the Users table was NOT indexed properly. I added a couple indexes, built them, and as soon as I did that I watched the CPU utilization DROP IMMEDIATELY to 10%.

I couldn't believe my eyes. At THAT second I realized just how important proper indexes truly are.

Anyone else experience an eye-opener like this?",2
4763143,01/21/2011 19:51:56,507718,11/15/2010 00:16:37,11,0,"SQL opposite of ""IN""","I think I found the answer to my question, I'm just unsure of the syntax, I keep getting SQL errors.

Basically, I want to do the opposite of IN. Take this example:

SELECT * from users INNER JOIN tags ON tags.user_id = users.id WHERE tags.name IN ('tag1', 'tag2');

The above will return ANY users that have 'tag1' OR 'tag2'. I want users that have BOTH. They must have both tags to be returned. I'm assuming the keyword ALL should be used, but can't get it to work.

Thanks for your help.",sql,all,,,,,open,0,87,4,"SQL opposite of ""IN"" I think I found the answer to my question, I'm just unsure of the syntax, I keep getting SQL errors.

Basically, I want to do the opposite of IN. Take this example:

SELECT * from users INNER JOIN tags ON tags.user_id = users.id WHERE tags.name IN ('tag1', 'tag2');

The above will return ANY users that have 'tag1' OR 'tag2'. I want users that have BOTH. They must have both tags to be returned. I'm assuming the keyword ALL should be used, but can't get it to work.

Thanks for your help.",2
8807968,01/10/2012 17:50:49,1141459,01/10/2012 17:43:22,1,0,SQL. Calculation correlations of asset classes,"I have a database with 101 simulations for, lets say, 5 different asset classes returns.

 I need to write a query that will calculate the respective correlations between each of the 5 classes. Table will look something like this:

AssetClass_ID | Simulation | AssetClass_Value

Any ideas?  I am struggling to get even close.


(Depending on difficulty I may end up having to tell the end user to just download all the simulations and do the stats using inbuilt EXCEL functions, but I am unlikely to be popular for doing so)",sql,query,statistics,,,,open,0,88,6,"SQL. Calculation correlations of asset classes I have a database with 101 simulations for, lets say, 5 different asset classes returns.

 I need to write a query that will calculate the respective correlations between each of the 5 classes. Table will look something like this:

AssetClass_ID | Simulation | AssetClass_Value

Any ideas?  I am struggling to get even close.


(Depending on difficulty I may end up having to tell the end user to just download all the simulations and do the stats using inbuilt EXCEL functions, but I am unlikely to be popular for doing so)",3
8036229,11/07/2011 12:04:54,1033677,11/07/2011 11:56:22,1,0,sql combination,"I have a sql query which select the best combination of hours with the heighest weight, It uses a recursive CTE to do find all the combinations of hours as shown below

    Declare @EmpClasses table(Id int identity(1,1),ClassNum int,ClassWeight int,ClassHours int)
    Declare @HoursReq int;
    
    SET @HoursReq = 20;
    
    
        INSERT INTO @EmpClasses VALUES(1001,10,10),(1002,9,5),(1003,8,4),(1004,7,3),(1005,6,2),(1006,5,2),(1007,4,1);
        
        --INSERT INTO @EmpClasses VALUES(1001,2,2),(1002,2,2),(1003,2,2),(1004,2,2),(1005,2,2),(1006,2,2),(1007,2,2),(1008,2,2),(1009,2,2),(1010,2,2);
        --INSERT INTO @EmpClasses VALUES(1011,2,2),(1012,2,2),(1013,2,2),(1014,2,2),(1015,2,2),(1016,2,2),(1017,2,2),(1018,2,2),(1019,2,2),(1020,2,2);
        --INSERT INTO @EmpClasses VALUES(1021,2,2),(1022,2,2),(1023,2,2),(1024,2,2),(1025,2,2),(1026,2,2),(1027,2,2),(1028,2,2),(1029,2,2),(1030,2,2);
        
        
        WITH cte (Id,comIds,Total,TotalWeight)
        AS
        (
        SELECT Id
        		,Cast(ClassNum as varchar(max)) + ','
        		,ClassHours
        		,ClassWeight
        FROM @EmpClasses
        UNION ALL
        SELECT ec.Id
        		,cte.comIds + Cast(ec.ClassNum as varchar(max)) + ','
        		,cte.Total + ec.ClassHours
        		,cte.TotalWeight + ec.ClassWeight
        FROM @EmpClasses AS ec JOIN cte ON ec.Id < cte.Id
        )
        SELECT top(1)comids,Total,TotalWeight
        FROM cte 
        Where Total = @HoursReq 
        order by TotalWeight desc

However the problems lies, when the number of rows increases to iterate. It takes a very long time.
Note:- Please uncomment above lines to check for the issue


Any help regarding this will be greatly appreciated






",sql,permutation,,,,,open,0,360,2,"sql combination I have a sql query which select the best combination of hours with the heighest weight, It uses a recursive CTE to do find all the combinations of hours as shown below

    Declare @EmpClasses table(Id int identity(1,1),ClassNum int,ClassWeight int,ClassHours int)
    Declare @HoursReq int;
    
    SET @HoursReq = 20;
    
    
        INSERT INTO @EmpClasses VALUES(1001,10,10),(1002,9,5),(1003,8,4),(1004,7,3),(1005,6,2),(1006,5,2),(1007,4,1);
        
        --INSERT INTO @EmpClasses VALUES(1001,2,2),(1002,2,2),(1003,2,2),(1004,2,2),(1005,2,2),(1006,2,2),(1007,2,2),(1008,2,2),(1009,2,2),(1010,2,2);
        --INSERT INTO @EmpClasses VALUES(1011,2,2),(1012,2,2),(1013,2,2),(1014,2,2),(1015,2,2),(1016,2,2),(1017,2,2),(1018,2,2),(1019,2,2),(1020,2,2);
        --INSERT INTO @EmpClasses VALUES(1021,2,2),(1022,2,2),(1023,2,2),(1024,2,2),(1025,2,2),(1026,2,2),(1027,2,2),(1028,2,2),(1029,2,2),(1030,2,2);
        
        
        WITH cte (Id,comIds,Total,TotalWeight)
        AS
        (
        SELECT Id
        		,Cast(ClassNum as varchar(max)) + ','
        		,ClassHours
        		,ClassWeight
        FROM @EmpClasses
        UNION ALL
        SELECT ec.Id
        		,cte.comIds + Cast(ec.ClassNum as varchar(max)) + ','
        		,cte.Total + ec.ClassHours
        		,cte.TotalWeight + ec.ClassWeight
        FROM @EmpClasses AS ec JOIN cte ON ec.Id < cte.Id
        )
        SELECT top(1)comids,Total,TotalWeight
        FROM cte 
        Where Total = @HoursReq 
        order by TotalWeight desc

However the problems lies, when the number of rows increases to iterate. It takes a very long time.
Note:- Please uncomment above lines to check for the issue


Any help regarding this will be greatly appreciated






",2
8151312,11/16/2011 12:00:12,128071,06/24/2009 08:39:06,1419,0,Select Query for the same values,"Using SQL Server 2000

I Want to Check the colum value whether it is same or not

    Table1
    
    ID Value
    
    001 1000
    002 1000
    003 5000

From the above table, nothing display in the output, because values are differenct for each id.

If the values are same for all the id, then display otherwise nothing display.

How to make a select query.

Need Query Help

",sql,sql-server,,,,,open,0,83,6,"Select Query for the same values Using SQL Server 2000

I Want to Check the colum value whether it is same or not

    Table1
    
    ID Value
    
    001 1000
    002 1000
    003 5000

From the above table, nothing display in the output, because values are differenct for each id.

If the values are same for all the id, then display otherwise nothing display.

How to make a select query.

Need Query Help

",2
3957486,10/18/2010 08:18:10,198261,10/28/2009 16:26:01,55,0,Directed graph SQL,"I have the following data set, which represents nodes in a directed graph.

    FROM  TO
    ----------
    AT	TG
    CG	GT
    GA	AT
    GC	CA
    GC	CG
    GG	GC
    GT	TG
    TG	GA
    TG	GC
    TG	GG

Using this data set, I want to select all nodes which have relationship with a specific node. This is easy enough:
   

    -- Select all nodes with a relationship to 'AT'
    SELECT node_from, node_to 
    FROM node_relationships_v
    WHERE node_from = 'AT'
       OR node_to = 'AT';

    FROM  TO
    ----------
    AT	TG
    GA	AT

However, I want this to be recursive (i.e. a user enters a level of 2 and this returns nodes with a relationship to the specified node, and nodes with relationship to those nodes...):


    FROM  TO
    ----------
    AT	TG
    GA	AT
    GT	TG
    TG	GA
    TG	GC
    TG	GG

How do I achieve this using SQL in Oracle 11g?

There may be bidirectional relationships (if this is important).",sql,oracle11g,recursive-query,,,,open,0,228,3,"Directed graph SQL I have the following data set, which represents nodes in a directed graph.

    FROM  TO
    ----------
    AT	TG
    CG	GT
    GA	AT
    GC	CA
    GC	CG
    GG	GC
    GT	TG
    TG	GA
    TG	GC
    TG	GG

Using this data set, I want to select all nodes which have relationship with a specific node. This is easy enough:
   

    -- Select all nodes with a relationship to 'AT'
    SELECT node_from, node_to 
    FROM node_relationships_v
    WHERE node_from = 'AT'
       OR node_to = 'AT';

    FROM  TO
    ----------
    AT	TG
    GA	AT

However, I want this to be recursive (i.e. a user enters a level of 2 and this returns nodes with a relationship to the specified node, and nodes with relationship to those nodes...):


    FROM  TO
    ----------
    AT	TG
    GA	AT
    GT	TG
    TG	GA
    TG	GC
    TG	GG

How do I achieve this using SQL in Oracle 11g?

There may be bidirectional relationships (if this is important).",3
564755,02/19/2009 10:53:42,63235,02/06/2009 08:35:13,46,1,SQL Server Text type v.s. varchar data type,"I have variable length character and want to store in SQL Server (2005) database. I want to learn some best practices about how to choose TEXT SQL type or choose VARCHAR SQL type, pros and cons in performance/footprint/function.

thanks in advance,
George",sql,text,varchar,,,05/07/2012 18:21:04,not constructive,1,40,8,"SQL Server Text type v.s. varchar data type I have variable length character and want to store in SQL Server (2005) database. I want to learn some best practices about how to choose TEXT SQL type or choose VARCHAR SQL type, pros and cons in performance/footprint/function.

thanks in advance,
George",3
3524731,08/19/2010 17:57:55,161397,08/22/2009 21:49:55,158,0,Best practice for naming SQL table columns,"I will get involved in a big project and I would like to know which is, in your opinion, the best practice for naming SQL table columns. 

Lets say we have a products table. Which of the following naming will you prefer?

- id,
- name,
- description,
- photo,
- price

or 

- product_id,
- product_name,
- product_description,
- product_photo,
- product_price",sql,,,,,08/22/2010 09:13:10,not constructive,1,53,7,"Best practice for naming SQL table columns I will get involved in a big project and I would like to know which is, in your opinion, the best practice for naming SQL table columns. 

Lets say we have a products table. Which of the following naming will you prefer?

- id,
- name,
- description,
- photo,
- price

or 

- product_id,
- product_name,
- product_description,
- product_photo,
- product_price",1
8472457,12/12/2011 09:48:23,591801,01/27/2011 07:22:28,719,67,How can I group SQL Server geometry data by STWithin?,"I have two tables that I am storing geometries in.

    CREATE TABLE config.region
    (
        id int identity(1,1) PRIMARY KEY,
        polygon GEOMETRY NOT NULL
    )

    CREATE TABLE config.location
    (
        id int identity(1,1) PRIMARY KEY,
        position GEOMETRY
    )

The region table will hold rectangular polygons.  The location table will hold only points.

What I want to do is select all the regions and a COUNT of how many points are actually within each polygon.

I've come up with this query, that shows the polygon id, the location id and whether or not the location is in the polygon.  

    SELECT polygon.id as pid, config.location.id as lid, polygon,polygon.STContains(config.location.position) as within FROM config.polygon, config.location

How can I modify this to give counts instead of just a list of whether or not they are within each other?",sql,sql-server,geometry,spatial,,,open,0,179,10,"How can I group SQL Server geometry data by STWithin? I have two tables that I am storing geometries in.

    CREATE TABLE config.region
    (
        id int identity(1,1) PRIMARY KEY,
        polygon GEOMETRY NOT NULL
    )

    CREATE TABLE config.location
    (
        id int identity(1,1) PRIMARY KEY,
        position GEOMETRY
    )

The region table will hold rectangular polygons.  The location table will hold only points.

What I want to do is select all the regions and a COUNT of how many points are actually within each polygon.

I've come up with this query, that shows the polygon id, the location id and whether or not the location is in the polygon.  

    SELECT polygon.id as pid, config.location.id as lid, polygon,polygon.STContains(config.location.position) as within FROM config.polygon, config.location

How can I modify this to give counts instead of just a list of whether or not they are within each other?",4
6167011,05/29/2011 09:47:43,775001,05/29/2011 09:24:35,1,0,"""Exchange server"" data stored in Sql files.","We would like to store ALL incoming emails from Exchange server directly into a MSSQL data base. Any suggestions welcome, including commercial 3rd party software.

We have reasonable programming competence in Delphi, Visual Basic and C#

",sql,server,exchange,,,05/30/2011 18:03:32,off topic,1,35,7,"""Exchange server"" data stored in Sql files. We would like to store ALL incoming emails from Exchange server directly into a MSSQL data base. Any suggestions welcome, including commercial 3rd party software.

We have reasonable programming competence in Delphi, Visual Basic and C#

",3
5135379,02/27/2011 19:28:28,636759,02/27/2011 19:28:28,1,0,ORACLE PL/SQL FUNCTIONS,"You must also implement PL/SQL functions that compute and return the following:
1. age of a customer, based on date-of-birth and current date;

select trunc(months_between(sysdate, DATEOFBIRTH) / 12) as AGE
from customers_objtab;

2. duration of a phone call rounded up to the nearest minute;
3. the total cost of phone calls of a particular customer for a range of dates;
4. the total cost of phone calls of a particular customer this month (from the rst date
of the current month up to the current date).
Please note that the elements in bold should be the parameters of the functions, and
that phone call costs should be expressed in pounds and pence.

Im strugglign with these functions - any help would me much appreciated.

Here are tables:

drop table customerPhoneCall_objtab;
drop type customerPhoneCall_objtyp;
drop table customers_objtab;
drop type customers_objtyp;


create type customers_objtyp as object(
customer_id number(20),
firstName varchar2(30),
lastName varchar2(30),
dateOfBirth date,
age number(20),
address varchar2(50),
areaCode varchar2(10),
contactNum varchar2(20)
);
/

create table customers_objtab of customers_objtyp(primary key (areaCode, contactNum))
object identifier is primary key;
/
--drop table customerPhoneCall_objtab;
--drop type customerPhoneCall_objtyp;

create type customerPhoneCall_objtyp as object(--under customers_objtyp(
--member function chargePerMinute return varchar2(20), 
customerRef ref customers_objtyp,
startDate date,
startTime varchar2(20),
endDate date,
endTime varchar2(20),
charge varchar2(20),
areaCode varchar2(10),
contactNum varchar2(20)
)
;
/
create table customerPhoneCall_objtab of customerPhoneCall_objtyp
(primary key (areaCode, contactNum),
customerRef references customers_objtab)
object identifier is primary key
;
/
drop table premiumRate_objtab;
drop type premiumRate_objtyp;

create type premiumRate_objtyp as object(

areaCode varchar2(10),
contactNum varchar2(20),
customerName varchar2(20),
costPerMin varchar2(20)
);
/

create table premiumRate_objtab of premiumRate_objtyp(primary key (areaCode, contactNum))
object identifier is primary key;
/
",sql,oracle,,,,02/28/2011 02:51:56,not a real question,1,206,3,"ORACLE PL/SQL FUNCTIONS You must also implement PL/SQL functions that compute and return the following:
1. age of a customer, based on date-of-birth and current date;

select trunc(months_between(sysdate, DATEOFBIRTH) / 12) as AGE
from customers_objtab;

2. duration of a phone call rounded up to the nearest minute;
3. the total cost of phone calls of a particular customer for a range of dates;
4. the total cost of phone calls of a particular customer this month (from the rst date
of the current month up to the current date).
Please note that the elements in bold should be the parameters of the functions, and
that phone call costs should be expressed in pounds and pence.

Im strugglign with these functions - any help would me much appreciated.

Here are tables:

drop table customerPhoneCall_objtab;
drop type customerPhoneCall_objtyp;
drop table customers_objtab;
drop type customers_objtyp;


create type customers_objtyp as object(
customer_id number(20),
firstName varchar2(30),
lastName varchar2(30),
dateOfBirth date,
age number(20),
address varchar2(50),
areaCode varchar2(10),
contactNum varchar2(20)
);
/

create table customers_objtab of customers_objtyp(primary key (areaCode, contactNum))
object identifier is primary key;
/
--drop table customerPhoneCall_objtab;
--drop type customerPhoneCall_objtyp;

create type customerPhoneCall_objtyp as object(--under customers_objtyp(
--member function chargePerMinute return varchar2(20), 
customerRef ref customers_objtyp,
startDate date,
startTime varchar2(20),
endDate date,
endTime varchar2(20),
charge varchar2(20),
areaCode varchar2(10),
contactNum varchar2(20)
)
;
/
create table customerPhoneCall_objtab of customerPhoneCall_objtyp
(primary key (areaCode, contactNum),
customerRef references customers_objtab)
object identifier is primary key
;
/
drop table premiumRate_objtab;
drop type premiumRate_objtyp;

create type premiumRate_objtyp as object(

areaCode varchar2(10),
contactNum varchar2(20),
customerName varchar2(20),
costPerMin varchar2(20)
);
/

create table premiumRate_objtab of premiumRate_objtyp(primary key (areaCode, contactNum))
object identifier is primary key;
/
",2
5642691,04/12/2011 23:11:51,574814,01/13/2011 20:03:51,150,2,"Oracle - Unique values combinations from multiple columns, but returning other columns","I'm trying to figure out how to pull different data scenarios from my table for testing.  Assume my table has these three fields `FIELD1, FIELD2, FIELD3`.  If I want to find the various scenarios in my data I could simply do this

    select distinct FIELD1, FIELD2, FIELD3 from <table>

And this works.  The problem is I have a plethora of other fields I need data from as well, but it doesn't matter what that data is as long as it's associated with the resulting record.  So for example if the above query returned this as one of the results

    FIELD1	FIELD2	FIELD3
    ----------------------
    Y		Blue	31

I would want to see the other content fields (4 through 10 lets say).  Now wether those came from record number #30 or record #20000 (assuming those records contained those 3 returned values) it doesn't matter as long as all the fields were returned by said record.

Hope that makes sense and someone can help!
",sql,oracle,distinct,aggregate-functions,,,open,0,171,12,"Oracle - Unique values combinations from multiple columns, but returning other columns I'm trying to figure out how to pull different data scenarios from my table for testing.  Assume my table has these three fields `FIELD1, FIELD2, FIELD3`.  If I want to find the various scenarios in my data I could simply do this

    select distinct FIELD1, FIELD2, FIELD3 from <table>

And this works.  The problem is I have a plethora of other fields I need data from as well, but it doesn't matter what that data is as long as it's associated with the resulting record.  So for example if the above query returned this as one of the results

    FIELD1	FIELD2	FIELD3
    ----------------------
    Y		Blue	31

I would want to see the other content fields (4 through 10 lets say).  Now wether those came from record number #30 or record #20000 (assuming those records contained those 3 returned values) it doesn't matter as long as all the fields were returned by said record.

Hope that makes sense and someone can help!
",4
7771719,10/14/2011 18:07:21,973671,09/30/2011 18:55:40,26,0,"Database schema with categories, subcategories and products","I am looking for the best way to create clothing store database that has categories, subcategories and products.


        Categories: mens, womens, kids, home
        subcategories: tops, bottoms, shoes, accessories, art
        products: 10 different tops, 10 different bottoms, 10 different shoes, 10 different accessories and 10 different pieces of art for the home category. 


I wand to display categories on first page, subcategories on second page and then products on the third page based on the selected categories and subcategories, just like a online store.
products should only belong to one subcategory.

Thanks in advance.",sql,sql-server,database-design,database-schema,,10/14/2011 20:05:19,too localized,1,112,7,"Database schema with categories, subcategories and products I am looking for the best way to create clothing store database that has categories, subcategories and products.


        Categories: mens, womens, kids, home
        subcategories: tops, bottoms, shoes, accessories, art
        products: 10 different tops, 10 different bottoms, 10 different shoes, 10 different accessories and 10 different pieces of art for the home category. 


I wand to display categories on first page, subcategories on second page and then products on the third page based on the selected categories and subcategories, just like a online store.
products should only belong to one subcategory.

Thanks in advance.",4
2645281,04/15/2010 12:45:15,193605,10/21/2009 06:12:56,337,0,"SQL: column <> '%TEST%' does not work, why?","I do not understand why following code does not work?

SELECT [column1], [column2]
FROM table where Column1 <> ('%TEST%')
ORDER BY 1

I want to have all rows where Column1 does not contain %TEST%.

Thanks",sql,query,,,,,open,0,30,8,"SQL: column <> '%TEST%' does not work, why? I do not understand why following code does not work?

SELECT [column1], [column2]
FROM table where Column1 <> ('%TEST%')
ORDER BY 1

I want to have all rows where Column1 does not contain %TEST%.

Thanks",2
5539330,04/04/2011 13:40:00,691196,04/04/2011 13:40:00,1,0,DB Query no longer recognizes SQL parameters in existing application when debugging in VS2010,"I just started working with an application that I inherited from someone else and I'm having some issues. The application is written in C# and runs in VS2010 against the 3.5 framework. I can't run the application on my machine to debug because it will not recognize the way they referenced their parameters when writing their DB queries. 

For instance wherever they have a SQL or DB2 query it is written like this: 

using (SqlCommand command = new SqlCommand(""SELECT Field1 FROM Table1 WHERE FieldID=@FieldID"", SQLconnection))
                {
                    command.Parameters.AddWithValue(""FieldID"", 10000);
                    SqlDataReader reader = command.ExecuteReader();
...

If you will notice the ""parameters.AddWithValue(""FieldID"", 10000);"" statement does not include the ""@"" symbol from the original command text. When I run it on my machine I get an error message stating that the parameter ""FieldID"" could not be found.

I change this line: 

                    command.Parameters.AddWithValue(""FieldID"", 10000);

To this:

                    command.Parameters.AddWithValue(""@FieldID"", 10000);

And all is well... until it hits the next SQL call and bombs out with the same error. Obviously this must be a setting within visual studio, but I can't find anything about it on the internet. Half the examples for SQL parameter addition are written including the ""@"" and the other half do not include it. Most likely I just don't know what to search for. 

Last choice is to change every query over to use the ""@"" at the front of the parameter name, but this is the transportation and operations application used to manage the corporation's shipments and literally has thousands of parameters. Hard to explain the ROI on your project when the answer to the director's question ""How's progress?"" happens to be ""I've been hard at it for a week and I've almost started.""

Has anyone run into this problem, or do you know how to turn this setting off so it can resolve the parameter names without the ""@""?",sql,db2,query-parameters,,,,open,0,393,14,"DB Query no longer recognizes SQL parameters in existing application when debugging in VS2010 I just started working with an application that I inherited from someone else and I'm having some issues. The application is written in C# and runs in VS2010 against the 3.5 framework. I can't run the application on my machine to debug because it will not recognize the way they referenced their parameters when writing their DB queries. 

For instance wherever they have a SQL or DB2 query it is written like this: 

using (SqlCommand command = new SqlCommand(""SELECT Field1 FROM Table1 WHERE FieldID=@FieldID"", SQLconnection))
                {
                    command.Parameters.AddWithValue(""FieldID"", 10000);
                    SqlDataReader reader = command.ExecuteReader();
...

If you will notice the ""parameters.AddWithValue(""FieldID"", 10000);"" statement does not include the ""@"" symbol from the original command text. When I run it on my machine I get an error message stating that the parameter ""FieldID"" could not be found.

I change this line: 

                    command.Parameters.AddWithValue(""FieldID"", 10000);

To this:

                    command.Parameters.AddWithValue(""@FieldID"", 10000);

And all is well... until it hits the next SQL call and bombs out with the same error. Obviously this must be a setting within visual studio, but I can't find anything about it on the internet. Half the examples for SQL parameter addition are written including the ""@"" and the other half do not include it. Most likely I just don't know what to search for. 

Last choice is to change every query over to use the ""@"" at the front of the parameter name, but this is the transportation and operations application used to manage the corporation's shipments and literally has thousands of parameters. Hard to explain the ROI on your project when the answer to the director's question ""How's progress?"" happens to be ""I've been hard at it for a week and I've almost started.""

Has anyone run into this problem, or do you know how to turn this setting off so it can resolve the parameter names without the ""@""?",3
4876145,02/02/2011 15:17:32,516650,11/22/2010 20:55:45,1,0,"How does one catch the error message ""Error Converting data type varchar to decimal""","I have a stored procedure that performs an update with a try catch block. The column (discountPercentage) is set as a decimal data type. I want the stored procedure to catch if the user inserts the discountPercentage as anything other than a decimal, for example if they try to insert 45%. I'm  using the ERROR_MESSAGE function and for some reason it's not catching the error message. I still receive the error message that states ""Error converting data type varchar to decimal."" Here is my code so far:


alter procedure procUpdateFoodTitleConditionDiscount
(
	@foodTitleId int,
	@conditionId int,
	@discountPercentage decimal(4,2),
	@errorMessage varchar(100) output
)
as 
begin
	set @errorMessage = 'Discount updated'	
	
	begin try
		update Discount
		set discountPercentage = @discountPercentage
		where foodTitleId = @foodTitleId and conditionId = @conditionId
		
		if (@@ROWCOUNT = 0)
		begin
			set @errorMessage = 'Update not successful.'
		end
	end try
	
	begin catch
		if (ERROR_MESSAGE () like '%converting%')
		begin
			set @errorMessage = 'Please Insert Discount Percentage as a Decimal (ex 0.45)'
		end
	end catch
	
end;

declare @errorMessageValue varchar (100)
execute procUpdateFoodTitleConditionDiscount
	@foodTitleId = '104', 
	@conditionId = '4',
	@discountPercentage = '45%', 
	@errorMessage = @errorMessageValue output
print @errorMessageValue",sql,tsql,server,,,,open,0,154,14,"How does one catch the error message ""Error Converting data type varchar to decimal"" I have a stored procedure that performs an update with a try catch block. The column (discountPercentage) is set as a decimal data type. I want the stored procedure to catch if the user inserts the discountPercentage as anything other than a decimal, for example if they try to insert 45%. I'm  using the ERROR_MESSAGE function and for some reason it's not catching the error message. I still receive the error message that states ""Error converting data type varchar to decimal."" Here is my code so far:


alter procedure procUpdateFoodTitleConditionDiscount
(
	@foodTitleId int,
	@conditionId int,
	@discountPercentage decimal(4,2),
	@errorMessage varchar(100) output
)
as 
begin
	set @errorMessage = 'Discount updated'	
	
	begin try
		update Discount
		set discountPercentage = @discountPercentage
		where foodTitleId = @foodTitleId and conditionId = @conditionId
		
		if (@@ROWCOUNT = 0)
		begin
			set @errorMessage = 'Update not successful.'
		end
	end try
	
	begin catch
		if (ERROR_MESSAGE () like '%converting%')
		begin
			set @errorMessage = 'Please Insert Discount Percentage as a Decimal (ex 0.45)'
		end
	end catch
	
end;

declare @errorMessageValue varchar (100)
execute procUpdateFoodTitleConditionDiscount
	@foodTitleId = '104', 
	@conditionId = '4',
	@discountPercentage = '45%', 
	@errorMessage = @errorMessageValue output
print @errorMessageValue",3
6656183,07/11/2011 20:33:57,406143,07/22/2010 16:58:20,46,1,Create user in sql server 2008,"All,

 I have  sql server user in the database and for some reason, user is not able to  view the tables when connecting

here are the commands that i am using to create that user.  I do not want to make the user 'dbuser' the owner of the schema. 



create user dbuser for login dbuser'

--on the specific database, I am using these commands.

exec sp_addrolemember @rolename = 'db_datareader', @membername = 'dbuser'

exec sp_addrolemember @rolename = 'db_datawriter', @membername = 'dbuser'



grant select on schema :: [schema1] TO [dbuser]

grant insert on schema  :: [schema1] TO [dbuser]

grant update  on schema :: [schema1] TO [dbuser]
grant execute  on schema  :: [schema1] TO [dbuser]


grant select on schema :: [schema2] TO [dbuser]



grant insert on schema  :: [schema2] TO [dbuser]



grant update  on schema  :: [schema2] TO [dbuser]


grant execute  on schema  :: [schema2] TO [dbuser]



even though i am granting all insert and update tec access on the schema.. the user when logged in with 'dbuser' is not able to view the any of the tables from any of the schemasw. He just sees the systemtables tab whe the user tries to connect to the database.User needs to see all the tables under the schema1,schema2, schema3 


thanks

",sql,sql-server,permissions,user,,,open,0,205,6,"Create user in sql server 2008 All,

 I have  sql server user in the database and for some reason, user is not able to  view the tables when connecting

here are the commands that i am using to create that user.  I do not want to make the user 'dbuser' the owner of the schema. 



create user dbuser for login dbuser'

--on the specific database, I am using these commands.

exec sp_addrolemember @rolename = 'db_datareader', @membername = 'dbuser'

exec sp_addrolemember @rolename = 'db_datawriter', @membername = 'dbuser'



grant select on schema :: [schema1] TO [dbuser]

grant insert on schema  :: [schema1] TO [dbuser]

grant update  on schema :: [schema1] TO [dbuser]
grant execute  on schema  :: [schema1] TO [dbuser]


grant select on schema :: [schema2] TO [dbuser]



grant insert on schema  :: [schema2] TO [dbuser]



grant update  on schema  :: [schema2] TO [dbuser]


grant execute  on schema  :: [schema2] TO [dbuser]



even though i am granting all insert and update tec access on the schema.. the user when logged in with 'dbuser' is not able to view the any of the tables from any of the schemasw. He just sees the systemtables tab whe the user tries to connect to the database.User needs to see all the tables under the schema1,schema2, schema3 


thanks

",4
10910437,06/06/2012 08:10:20,1439177,06/06/2012 08:01:03,1,0,Value entered in the 'Other' field should not be present in the predefined list,"I have a dropdown field with the following options as an example:

1. Single
2. Married
3. Divorsed
4. Widowed
5. Other

Below this field I also have a field to capture 'Other'. I need to write a query to make sure that the value entered in the 'Other' field is not in the predefined list. Can anyone please help me.",sql,,,,,06/07/2012 00:26:03,not a real question,1,55,14,"Value entered in the 'Other' field should not be present in the predefined list I have a dropdown field with the following options as an example:

1. Single
2. Married
3. Divorsed
4. Widowed
5. Other

Below this field I also have a field to capture 'Other'. I need to write a query to make sure that the value entered in the 'Other' field is not in the predefined list. Can anyone please help me.",1
3334598,07/26/2010 12:03:58,185824,10/07/2009 18:07:14,962,57,How to select even non existent values,"I'm using SQL-Server 2005

I have two tables, Users and Orders. Each user can have many orders. Tables connected via userID. Orders has date column ( which is when order was made ). Users have registrationSite column ( which is who is the affiliate site behind user and all of his orders ).


I want to select sum of orders per day and site so **even if site haven't sold i will have 0 as sum value.**


this is current query which misses the highlighted part.

    select sum(orderSum)*40/100-0.17,count(*),
    registrationSite,
    dateadd(dd,datediff(dd,0,cu.date),0)
    from Users cu 
    inner join Orders cp 
    on cu.userID=cp.userID
    group by dateadd(dd,datediff(dd,0,cu.date),0),registrationSite
    order by dateadd(dd,datediff(dd,0,cu.date),0),registrationSite",sql,sql-server,tsql,,,,open,0,128,7,"How to select even non existent values I'm using SQL-Server 2005

I have two tables, Users and Orders. Each user can have many orders. Tables connected via userID. Orders has date column ( which is when order was made ). Users have registrationSite column ( which is who is the affiliate site behind user and all of his orders ).


I want to select sum of orders per day and site so **even if site haven't sold i will have 0 as sum value.**


this is current query which misses the highlighted part.

    select sum(orderSum)*40/100-0.17,count(*),
    registrationSite,
    dateadd(dd,datediff(dd,0,cu.date),0)
    from Users cu 
    inner join Orders cp 
    on cu.userID=cp.userID
    group by dateadd(dd,datediff(dd,0,cu.date),0),registrationSite
    order by dateadd(dd,datediff(dd,0,cu.date),0),registrationSite",3
4829700,01/28/2011 15:07:48,277480,02/20/2010 02:21:24,349,8,Displaying record count using VB.net and Oracle 10g DB,"I am trying to fetch my record count in my following query:

    myCommand = New OleDbCommand(""SELECT status, date, theTitle, 
                                 theMessage, date2, COUNT(*) over () as countNum 
    FROM Blah blah... 

    dr = myCommand.ExecuteReader()
    MessageBox.Show(dr(4))

But it just closes my program. If i comment that out then it populates just fine and doesn't close.

What could i do to correct this?

David",sql,vb.net,oracle,visual-studio-2010,oracle10g,,open,0,104,9,"Displaying record count using VB.net and Oracle 10g DB I am trying to fetch my record count in my following query:

    myCommand = New OleDbCommand(""SELECT status, date, theTitle, 
                                 theMessage, date2, COUNT(*) over () as countNum 
    FROM Blah blah... 

    dr = myCommand.ExecuteReader()
    MessageBox.Show(dr(4))

But it just closes my program. If i comment that out then it populates just fine and doesn't close.

What could i do to correct this?

David",5
4172644,11/13/2010 13:08:23,506697,11/13/2010 12:29:25,1,0,"hey guys im creating a stored procedure for search form in the asp.net im getting error, code is given below ","set ANSI_NULLS ON
set QUOTED_IDENTIFIER ON
go

ALTER PROCEDURE [dbo].[sp_searchcustomervendordetails] 
 @customervendortype varchar(30)=Null,
    @customervendorid   varchar(30)=Null,
    @customervendorname varchar(30)=Null,
    @state              varchar(30)=Null,
    @city               varchar(30)=Null
AS
BEGIN
 SET NOCOUNT ON;
--if @customervendortype is not null and len(@customervendortype)=0 set @customervendortype = null
--if @customervendorid is not null and len(@cuatomervendorid)=0 set @customervendorid = null
--if @customervendorname is not null and len(@customervendorname)=0 set @customervendorname = null
--if @city is not null and len(@city)=0 set @city = null
--if @state is not null and len(@state)=0 set @state = null

    -- Insert statements for procedure here
SELECT     CustomerVendorDetails.customervendorid AS CustomerVendorID,CustomerVendorAddressDetails.customervendorname, CustomerVendorAddressDetails.doorno, CustomerVendorAddressDetails.street, 
           CustomerVendorAddressDetails.city, CustomerVendorAddressDetails.state, CustomerVendorAddressDetails.country, 
           CustomerVendorAddressDetails.pincode,  CustomerVendorDetails.decidingauthority, 
           CustomerVendorDetails.landlineno1, CustomerVendorDetails.landlineno2, CustomerVendorDetails.faxno, ContactPersonDetails.contactno, 
           ContactPersonDetails.designation
FROM       CustomerVendorDetails INNER JOIN
           CustomerVendorAddressDetails ON CustomerVendorDetails.customervendorid = CustomerVendorAddressDetails.customervendorid INNER JOIN
           ContactPersonDetails ON CustomerVendorAddressDetails.customervendorid = ContactPersonDetails.customervendorid
WHERE      (@customervendortype is null or customervendortype like @customervendortype)
        or (@customervendorid is null or customervendorid like @customervendorid) 
        or (@customervendorname is null or customervendorname like @customervendorname)
        or (city is null or city like @city)
        or (state is null or state like @city)
END

im getting this error 
Msg 209, Level 16, State 1, Procedure sp_searchcustomervendordetails, Line 34
Ambiguous column name 'customervendorid'.
Msg 209, Level 16, State 1, Procedure sp_searchcustomervendordetails, Line 35
Ambiguous column name 'customervendorname'

can any help me please",sql,,,,,,open,0,331,21,"hey guys im creating a stored procedure for search form in the asp.net im getting error, code is given below  set ANSI_NULLS ON
set QUOTED_IDENTIFIER ON
go

ALTER PROCEDURE [dbo].[sp_searchcustomervendordetails] 
 @customervendortype varchar(30)=Null,
    @customervendorid   varchar(30)=Null,
    @customervendorname varchar(30)=Null,
    @state              varchar(30)=Null,
    @city               varchar(30)=Null
AS
BEGIN
 SET NOCOUNT ON;
--if @customervendortype is not null and len(@customervendortype)=0 set @customervendortype = null
--if @customervendorid is not null and len(@cuatomervendorid)=0 set @customervendorid = null
--if @customervendorname is not null and len(@customervendorname)=0 set @customervendorname = null
--if @city is not null and len(@city)=0 set @city = null
--if @state is not null and len(@state)=0 set @state = null

    -- Insert statements for procedure here
SELECT     CustomerVendorDetails.customervendorid AS CustomerVendorID,CustomerVendorAddressDetails.customervendorname, CustomerVendorAddressDetails.doorno, CustomerVendorAddressDetails.street, 
           CustomerVendorAddressDetails.city, CustomerVendorAddressDetails.state, CustomerVendorAddressDetails.country, 
           CustomerVendorAddressDetails.pincode,  CustomerVendorDetails.decidingauthority, 
           CustomerVendorDetails.landlineno1, CustomerVendorDetails.landlineno2, CustomerVendorDetails.faxno, ContactPersonDetails.contactno, 
           ContactPersonDetails.designation
FROM       CustomerVendorDetails INNER JOIN
           CustomerVendorAddressDetails ON CustomerVendorDetails.customervendorid = CustomerVendorAddressDetails.customervendorid INNER JOIN
           ContactPersonDetails ON CustomerVendorAddressDetails.customervendorid = ContactPersonDetails.customervendorid
WHERE      (@customervendortype is null or customervendortype like @customervendortype)
        or (@customervendorid is null or customervendorid like @customervendorid) 
        or (@customervendorname is null or customervendorname like @customervendorname)
        or (city is null or city like @city)
        or (state is null or state like @city)
END

im getting this error 
Msg 209, Level 16, State 1, Procedure sp_searchcustomervendordetails, Line 34
Ambiguous column name 'customervendorid'.
Msg 209, Level 16, State 1, Procedure sp_searchcustomervendordetails, Line 35
Ambiguous column name 'customervendorname'

can any help me please",1
10730177,05/24/2012 01:57:45,1337444,04/16/2012 23:11:15,1,0,SQL srever join unrelated tables,"i have two unrelaled table:

PEOPLE table:

    NAME | AGE
    ----------
    DAVE | 43
    ANNE | 25
    MIKE | 58

PLACES table:

    COUNTRY | TOWN
    ----------------
    USA     | WILMINGTON
    GER     | BERLIN
    POR     | LISBON
    JPN     | KYOTO

I want a Result like this:

    NAME | AGE | COUNTRY | TOWN
    -----------------------------
    ANNE |  25 | GER     | BERLIN
    DAVE |  43 | JPN     | KYOTO
    MIKE |  58 | POR     | LISBON
               | USA     | WILMINGTON
",sql,sql-server,tsql,sql-server-2005,,05/24/2012 11:21:04,not a real question,1,171,5,"SQL srever join unrelated tables i have two unrelaled table:

PEOPLE table:

    NAME | AGE
    ----------
    DAVE | 43
    ANNE | 25
    MIKE | 58

PLACES table:

    COUNTRY | TOWN
    ----------------
    USA     | WILMINGTON
    GER     | BERLIN
    POR     | LISBON
    JPN     | KYOTO

I want a Result like this:

    NAME | AGE | COUNTRY | TOWN
    -----------------------------
    ANNE |  25 | GER     | BERLIN
    DAVE |  43 | JPN     | KYOTO
    MIKE |  58 | POR     | LISBON
               | USA     | WILMINGTON
",4
6955717,08/05/2011 11:45:50,857766,07/22/2011 10:51:02,1,1,how to connect SQL and R.Net?,"I want to connect SQL database from R.Net .i am using R.Net from vb.net.
is it possible.If it possible how?.

sorry for my bad english.



",sql,r,connection,,,,open,0,23,6,"how to connect SQL and R.Net? I want to connect SQL database from R.Net .i am using R.Net from vb.net.
is it possible.If it possible how?.

sorry for my bad english.



",3
7648099,10/04/2011 12:46:26,509213,11/16/2010 07:48:26,97,4,Select values not in a certain range in a table,"I have a table with and id column. I have been given a list of 1000 IDs. I want to verify some data but when I select the table data using those ids only 990 results are returned. How can I find the 10 missing values from that range of data? This is what I'm doing at the moment:

    select * from mytable
    where theId in (1, 2, 3, 4...999, 1000)

Returns the 990 results. Can I do something like:

    select val from (1, 2, 3, 4...999, 1000) 
    where val not in (
    select * from mytable
    where theId in (1, 2, 3, 4...999, 1000)
    )",sql,,,,,,open,0,127,10,"Select values not in a certain range in a table I have a table with and id column. I have been given a list of 1000 IDs. I want to verify some data but when I select the table data using those ids only 990 results are returned. How can I find the 10 missing values from that range of data? This is what I'm doing at the moment:

    select * from mytable
    where theId in (1, 2, 3, 4...999, 1000)

Returns the 990 results. Can I do something like:

    select val from (1, 2, 3, 4...999, 1000) 
    where val not in (
    select * from mytable
    where theId in (1, 2, 3, 4...999, 1000)
    )",1
5019007,02/16/2011 16:19:55,471367,10/10/2010 06:24:58,112,10,Comparing two tables with SQL,"I need a query to produce a compare table between two tables.

Something like this: 

table_1:

    col1  |  col2  |  col3
     a    |   1    |   a_comment
     b    |   2    |   b_comment

table_2:

    col1  |  col2  |  col3
     a    |   3    |   a_comment
     c    |   4    |   c_comment

Query result:

    col1  |  table_1.col2  |  table_2.col2  |  col3
     a    |       1        |        3       |   a_comment
     b    |       2        |       NULL     |   b_comment
     c    |      NULL      |        4       |   c_comment

I tried to do it with FULL JOIN but it duplicates col1 and col3.

Thank you!",sql,,,,,,open,0,266,5,"Comparing two tables with SQL I need a query to produce a compare table between two tables.

Something like this: 

table_1:

    col1  |  col2  |  col3
     a    |   1    |   a_comment
     b    |   2    |   b_comment

table_2:

    col1  |  col2  |  col3
     a    |   3    |   a_comment
     c    |   4    |   c_comment

Query result:

    col1  |  table_1.col2  |  table_2.col2  |  col3
     a    |       1        |        3       |   a_comment
     b    |       2        |       NULL     |   b_comment
     c    |      NULL      |        4       |   c_comment

I tried to do it with FULL JOIN but it duplicates col1 and col3.

Thank you!",1
4656356,01/11/2011 09:59:35,571080,01/11/2011 09:59:35,1,0,Need help running automatic tasks on MS SQL,"We run a server hosted with Go-Daddy and use MS SQL 2005 Express. One of our customers needs to schedule an automatic SQL process overnight that takes the data from an ftp transfer that feed the csvs onto our server. We upgraded to MS SQL workgroup on go-daddy but the have told us that although we can select the SQL Agent option, the ability to edit this does not appear in the SSMS as Go Daddy tell me they only supply the Express version rather than the standard version with all of the SQL packages and the express version of SSMS does not support this auto scheduling.

Can anyone advise as to how we might be able to do this either through MS SQL itself (without having to dump the go-daddy version and pay $5000 for the software from MS; or alternatively a third party plugin that will do this?",sql,sql-server-2005,ftp,ms,,,open,0,149,8,"Need help running automatic tasks on MS SQL We run a server hosted with Go-Daddy and use MS SQL 2005 Express. One of our customers needs to schedule an automatic SQL process overnight that takes the data from an ftp transfer that feed the csvs onto our server. We upgraded to MS SQL workgroup on go-daddy but the have told us that although we can select the SQL Agent option, the ability to edit this does not appear in the SSMS as Go Daddy tell me they only supply the Express version rather than the standard version with all of the SQL packages and the express version of SSMS does not support this auto scheduling.

Can anyone advise as to how we might be able to do this either through MS SQL itself (without having to dump the go-daddy version and pay $5000 for the software from MS; or alternatively a third party plugin that will do this?",4
10845304,06/01/2012 06:13:19,1429149,05/31/2012 18:13:06,1,0,How to trace with SQL Server profiler,i am trying my hands on SQL server profiler i would like to know how to trace using SQL server profiler. any link with apprpiate GUI will be more then helpfull.,sql,sql-server,sql-server-profiler,,,06/04/2012 07:59:09,not a real question,1,31,7,How to trace with SQL Server profiler i am trying my hands on SQL server profiler i would like to know how to trace using SQL server profiler. any link with apprpiate GUI will be more then helpfull.,3
496244,01/30/2009 16:47:33,58348,01/23/2009 16:45:12,8,5,Conditional Join possible in SQL Server 2005?,"I need to write a select query that joins the tables based on a condition (in this case, based on a value in one of the columns). I would like to do something like this:


    SELECT *
      FROM TableA
           INNER JOIN TableB ON (TableA.Column1 = TableB.Column1 OR TableA.Column1 = 0) -- Does not work!",sql,sql-server,,,,,open,0,72,7,"Conditional Join possible in SQL Server 2005? I need to write a select query that joins the tables based on a condition (in this case, based on a value in one of the columns). I would like to do something like this:


    SELECT *
      FROM TableA
           INNER JOIN TableB ON (TableA.Column1 = TableB.Column1 OR TableA.Column1 = 0) -- Does not work!",2
11267804,06/29/2012 19:26:09,1384530,05/09/2012 12:06:39,43,1,"Creat, Drop and Insert a temp table in User defined fuction","Hello am tryig to crate a Function as per my requirement.  
So, when am creating or drop #tempTable.  
It is giving an error as ""invalid use of a side-effecting operator 'drop object' within a function""  
  
My Understanding is, we can't create, drop or insert operation on temptable in function is that correct?  

  
    GO  SET ANSI_NULLS ON
    GO SET QUOTED_IDENTIFIER ON
    GO  
    CREATE FUNCTION [dbo].[RT_ResultFunction]
    (
    	Id VARCHAR(4000)
    )
    RETURNS @RT_ResultFunction TABLE 
    (	
    	Id VARCHAR(20)
    	, Name varchar(20)
    	,Balance Int
    )
    AS
    BEGIN
    	
    	IF OBJECT_ID('tempdb..#tempTable') IS NOT NULL  
        DROP TABLE #tempTable
        SELECT Id,COUNT(Balance) 'Balance' FROM Table1
    			
    	INSERT 	@RT_ResultFunction 
    		SELECT T1.ID,T1,NAME,T2,Balance 
    		FROM    Table2, 
    		        #tempTable T2
    		WHERE T1.ID = T2.ID
    	
    	RETURN
    END
    
    GO


",sql,function,server,,,,open,0,241,11,"Creat, Drop and Insert a temp table in User defined fuction Hello am tryig to crate a Function as per my requirement.  
So, when am creating or drop #tempTable.  
It is giving an error as ""invalid use of a side-effecting operator 'drop object' within a function""  
  
My Understanding is, we can't create, drop or insert operation on temptable in function is that correct?  

  
    GO  SET ANSI_NULLS ON
    GO SET QUOTED_IDENTIFIER ON
    GO  
    CREATE FUNCTION [dbo].[RT_ResultFunction]
    (
    	Id VARCHAR(4000)
    )
    RETURNS @RT_ResultFunction TABLE 
    (	
    	Id VARCHAR(20)
    	, Name varchar(20)
    	,Balance Int
    )
    AS
    BEGIN
    	
    	IF OBJECT_ID('tempdb..#tempTable') IS NOT NULL  
        DROP TABLE #tempTable
        SELECT Id,COUNT(Balance) 'Balance' FROM Table1
    			
    	INSERT 	@RT_ResultFunction 
    		SELECT T1.ID,T1,NAME,T2,Balance 
    		FROM    Table2, 
    		        #tempTable T2
    		WHERE T1.ID = T2.ID
    	
    	RETURN
    END
    
    GO


",3
8324865,11/30/2011 11:02:46,936917,09/09/2011 14:06:04,16,0,interval 1 month equivalent and Microsoft Query stranges things,"In a SQL query I use actually ""INTERVAL 1 MONTH"" in order to get the before month.

In SQL, MYSQL this following query is working:
    
    SELECT ObjectDay_2011.objectType , Sum(ObjectDay_2011.nbObjects) as 'total'
    FROM DBStats.ObjectDay_2011
    WHERE (ObjectDay_2011.client='TOTO') 
    AND (month(ObjectDay_2011.date) = month(NOW() - INTERVAL 1 MONTH)) 
    GROUP BY ObjectDay_2011.objectType 
    ORDER BY Sum(ObjectDay_2011.nbObjects) DESC ;

But when I put it on 'Microsft Query', the tool remove my aliases!

So do you know why? 
And do you know if an equivalent of ""interval 1 month"" existe and do the same things?

Thanks !! :)",sql,date,,,,,open,0,110,9,"interval 1 month equivalent and Microsoft Query stranges things In a SQL query I use actually ""INTERVAL 1 MONTH"" in order to get the before month.

In SQL, MYSQL this following query is working:
    
    SELECT ObjectDay_2011.objectType , Sum(ObjectDay_2011.nbObjects) as 'total'
    FROM DBStats.ObjectDay_2011
    WHERE (ObjectDay_2011.client='TOTO') 
    AND (month(ObjectDay_2011.date) = month(NOW() - INTERVAL 1 MONTH)) 
    GROUP BY ObjectDay_2011.objectType 
    ORDER BY Sum(ObjectDay_2011.nbObjects) DESC ;

But when I put it on 'Microsft Query', the tool remove my aliases!

So do you know why? 
And do you know if an equivalent of ""interval 1 month"" existe and do the same things?

Thanks !! :)",2
8526546,12/15/2011 21:04:26,1100752,12/15/2011 20:55:38,1,0,PL/SQL declaring errors and invalid variables,"Composing a code which calculates the upper quartile of mother language in table candidates.(25% of values in data set are greater than upper quartile), 2) outputs the candidates, whose points in mother language are greater than calculated upper quartile.
Code:

    DECLARE
    
    TYPE kandtabelityyp IS TABLE OF kandidaadid%rowtype index by binary_integer;
    
    kandtabel kandtabelityyp;
    
    i binary_integer :=1;
    
    n binary_integer;
    
    
    
    BEGIN
    
    FOR kand IN (SELECT eesnimi,perenimi, emakeel FROM kandidaadid ORDER BY emakeel DESC)
    
    LOOP
    
    kandtabel(i).perenimi :=kand.perenimi;
    
    kandtabel(i).emakeel := kand.emakeel;
    
    i := i+1;
    
    END LOOP;
    
    n :=i-1;
    
    FOR i IN 1..n/4
    
    LOOP
    
    dbms_output.put_line (kandtabel(i).perenimi || ' ' ||kandtabel(i).emakeel);
    
    END LOOP;
    
    END;
    
    /

But i keep getting random errors:

    TYPE kandtabelityyp IS TABLE OF kandidaadid%rowtype index by binary_integer;
                                    *
    ERROR at line 2:
    ORA-06550: line 2, column 33:
    PLS-00201: identifier 'KANDIDAADID' must be declared
    ORA-06550: line 2, column 1:
    PL/SQL: Item ignored
    ORA-06550: line 8, column 52:
    PL/SQL: ORA-00942: table or view does not exist
    ORA-06550: line 8, column 14:
    PL/SQL: SQL Statement ignored
    ORA-06550: line 10, column 14:
    PLS-00487: Invalid reference to variable 'KANDIDAADID%ROWTYPE'
    ORA-06550: line 10, column 1:
    PL/SQL: Statement ignored
    ORA-06550: line 11, column 14:
    PLS-00487: Invalid reference to variable 'KANDIDAADID%ROWTYPE'
    ORA-06550: line 11, column 1:
    PL/SQL: Statement ignored
    ORA-06550: line 17, column 36:
    PLS-00487: Invalid reference to variable 'KANDIDAADID%ROWTYPE'
    ORA-06550: line 17, column 1:
    PL/SQL: Statement ignored

I think it is cause by a simple error somewhere but i cant seem to find it.",sql,oracle,plsql,,,12/16/2011 00:42:27,too localized,1,468,6,"PL/SQL declaring errors and invalid variables Composing a code which calculates the upper quartile of mother language in table candidates.(25% of values in data set are greater than upper quartile), 2) outputs the candidates, whose points in mother language are greater than calculated upper quartile.
Code:

    DECLARE
    
    TYPE kandtabelityyp IS TABLE OF kandidaadid%rowtype index by binary_integer;
    
    kandtabel kandtabelityyp;
    
    i binary_integer :=1;
    
    n binary_integer;
    
    
    
    BEGIN
    
    FOR kand IN (SELECT eesnimi,perenimi, emakeel FROM kandidaadid ORDER BY emakeel DESC)
    
    LOOP
    
    kandtabel(i).perenimi :=kand.perenimi;
    
    kandtabel(i).emakeel := kand.emakeel;
    
    i := i+1;
    
    END LOOP;
    
    n :=i-1;
    
    FOR i IN 1..n/4
    
    LOOP
    
    dbms_output.put_line (kandtabel(i).perenimi || ' ' ||kandtabel(i).emakeel);
    
    END LOOP;
    
    END;
    
    /

But i keep getting random errors:

    TYPE kandtabelityyp IS TABLE OF kandidaadid%rowtype index by binary_integer;
                                    *
    ERROR at line 2:
    ORA-06550: line 2, column 33:
    PLS-00201: identifier 'KANDIDAADID' must be declared
    ORA-06550: line 2, column 1:
    PL/SQL: Item ignored
    ORA-06550: line 8, column 52:
    PL/SQL: ORA-00942: table or view does not exist
    ORA-06550: line 8, column 14:
    PL/SQL: SQL Statement ignored
    ORA-06550: line 10, column 14:
    PLS-00487: Invalid reference to variable 'KANDIDAADID%ROWTYPE'
    ORA-06550: line 10, column 1:
    PL/SQL: Statement ignored
    ORA-06550: line 11, column 14:
    PLS-00487: Invalid reference to variable 'KANDIDAADID%ROWTYPE'
    ORA-06550: line 11, column 1:
    PL/SQL: Statement ignored
    ORA-06550: line 17, column 36:
    PLS-00487: Invalid reference to variable 'KANDIDAADID%ROWTYPE'
    ORA-06550: line 17, column 1:
    PL/SQL: Statement ignored

I think it is cause by a simple error somewhere but i cant seem to find it.",3
4533497,12/26/2010 10:30:51,554236,12/26/2010 10:30:51,1,0,ms sql server2000,"i need the info regarding the MS SQL Server 2000 software along with price list n the proceedure of purchaseing it...
",sql,server,sql-server-2000,ms,,12/26/2010 11:31:26,not a real question,1,21,3,"ms sql server2000 i need the info regarding the MS SQL Server 2000 software along with price list n the proceedure of purchaseing it...
",4
7985894,11/02/2011 19:01:18,733452,05/01/2011 16:18:22,5,0,merge two columns and sorting in SQL CE,"I have these two columns to be merged into Column3 and sorted like the way below (first element from column1 then second element from column2 and so on) by using SQLCE in C#.

     Column1   Column2
     -------   -------
      pear     banana
      apple    pineapple
       .         .
       .         .
       .         .

         Column3
         -------
           pear
           banana
           apple
           pineapple
           .
           .
           .",sql,database,merge,,,11/05/2011 18:00:09,not a real question,1,213,8,"merge two columns and sorting in SQL CE I have these two columns to be merged into Column3 and sorted like the way below (first element from column1 then second element from column2 and so on) by using SQLCE in C#.

     Column1   Column2
     -------   -------
      pear     banana
      apple    pineapple
       .         .
       .         .
       .         .

         Column3
         -------
           pear
           banana
           apple
           pineapple
           .
           .
           .",3
9411190,02/23/2012 10:29:15,75642,03/09/2009 14:09:11,20746,802,Why would one want to combine SQL and NoSQL data in a single web application,"What are the **pros** and **cons** of doing this?  
How does one decide what goes where?",sql,nosql,combinations,,,02/24/2012 16:40:29,not constructive,1,17,15,"Why would one want to combine SQL and NoSQL data in a single web application What are the **pros** and **cons** of doing this?  
How does one decide what goes where?",3
3033079,06/13/2010 16:55:41,270591,02/10/2010 20:18:35,869,41,Creating an appropriate index for a frequently used query in SQL Server,"In my application I have two queries which will be quite frequently used. The Where clauses of these queries are the following:

    WHERE FieldA = @P1 AND (FieldB = @P2 OR FieldC = @P2)

and

    WHERE FieldA = @P1 AND FieldB = @P2

`P1` and `P2` are parameters entered in the UI or coming from external datasources.

- FieldA is an `int` and highly on-unique, means: only two, three, four different values in a table with say 20000 rows
- FieldB is a `varchar(20)` and is ""almost"" unique, there will be only very few rows where FieldB might have the same value
- FieldC is a `varchar(15)` and also highly distinct, but not as much as FieldB
- FieldA and FieldB together are unique (but do not form my primary key, which is a simple auto-incrementing identity column with a clustered index)

I'm wondering now what's the best way to define an index to speed up specifically these two queries. Shall I define one index with...

    FieldB (or better FieldC here?)
    FieldC (or better FieldB here?)
    FieldA

... or better two indices:

    FieldB
    FieldA

and

    FieldC
    FieldA

Or are there even other and better options? What's the best way and why?

Thank you for suggestions in advance!
",sql,sql-server,database,sql-server-2008,indexing,,open,0,223,12,"Creating an appropriate index for a frequently used query in SQL Server In my application I have two queries which will be quite frequently used. The Where clauses of these queries are the following:

    WHERE FieldA = @P1 AND (FieldB = @P2 OR FieldC = @P2)

and

    WHERE FieldA = @P1 AND FieldB = @P2

`P1` and `P2` are parameters entered in the UI or coming from external datasources.

- FieldA is an `int` and highly on-unique, means: only two, three, four different values in a table with say 20000 rows
- FieldB is a `varchar(20)` and is ""almost"" unique, there will be only very few rows where FieldB might have the same value
- FieldC is a `varchar(15)` and also highly distinct, but not as much as FieldB
- FieldA and FieldB together are unique (but do not form my primary key, which is a simple auto-incrementing identity column with a clustered index)

I'm wondering now what's the best way to define an index to speed up specifically these two queries. Shall I define one index with...

    FieldB (or better FieldC here?)
    FieldC (or better FieldB here?)
    FieldA

... or better two indices:

    FieldB
    FieldA

and

    FieldC
    FieldA

Or are there even other and better options? What's the best way and why?

Thank you for suggestions in advance!
",5
8809414,01/10/2012 19:34:31,1078251,12/02/2011 21:13:30,69,1,Have a small database that imitates a banking account. How can I get all records for one user's account but not the other?,"For example, let's say John Doe has two banking accounts (55 and 714).  John Doe could have multiple records on each account.  How can I make it so that I retrieve all the records from one account but not the other?",sql,tsql,,,,01/16/2012 04:22:37,not a real question,1,43,23,"Have a small database that imitates a banking account. How can I get all records for one user's account but not the other? For example, let's say John Doe has two banking accounts (55 and 714).  John Doe could have multiple records on each account.  How can I make it so that I retrieve all the records from one account but not the other?",2
7228035,08/29/2011 08:53:24,790881,06/09/2011 12:17:03,83,12,How do I get SqlCommand ExecuteNonQuery result?,"In order to check if specific user is db_owner, i excute the following query:

    ""select is_rolemember('db_owner', '"" & p_userName & ""')""

using the `SqlCommand` `ExecuteNonQuery` method.

How do I get the query result?

Here is my code:

        Dim com As SqlCommand = New SqlCommand(sql, m_connection)               
        com.ExecuteNonQuery()

sql is the query, and m_connection is the connectionString.",sql,vb.net,sql-server-2008,,,,open,0,83,7,"How do I get SqlCommand ExecuteNonQuery result? In order to check if specific user is db_owner, i excute the following query:

    ""select is_rolemember('db_owner', '"" & p_userName & ""')""

using the `SqlCommand` `ExecuteNonQuery` method.

How do I get the query result?

Here is my code:

        Dim com As SqlCommand = New SqlCommand(sql, m_connection)               
        com.ExecuteNonQuery()

sql is the query, and m_connection is the connectionString.",3
11004101,06/12/2012 20:12:51,1449217,06/11/2012 14:49:48,3,0,How to Upsert data into database that already exists automatically,Is there any way to automatically update a table in a database that will be through a Teradata connection?,sql,teradata,upsert,,,06/14/2012 11:58:27,not a real question,1,19,10,How to Upsert data into database that already exists automatically Is there any way to automatically update a table in a database that will be through a Teradata connection?,3
6274773,06/08/2011 06:01:43,705288,04/13/2011 04:57:48,88,5,PL/SQL SELECT with multiple COUNT(DISTINCT xxx) - unexpected results,"I'm trying to put together a query for an Oracle 11g application and I've run into a problem.

I'll simplify the real scenario to make it easier to understand (and also to protect the client's data):

* Table A is the base table. It has a known identifier in it that I pass in to the query.
* For each entry in Table A there may be multiple entries in Table B. Table B contains a value that I am interested in.
* For each entry in Table B there may also be multiple entries in Table C. Table C contains another value I'm interested in.
* I also have an XML snippet containing a list of values that may or may not match up to some values in table C.
* The query does an outer join to the XML so that if there is a matching value it will return the value again, otherwise it is null.

What I want to do is get back the identifier I passed in, a count of the unique values in B and C, as well as a count of the non-null values from the XML part of the join.

My current query is:

    SELECT
        a.ID
      , COUNT(DISTINCT b.VAL) AS B_VAL
      , COUNT(DISTINCT c.VAL) AS C_VAL
      , COUNT(DISTINCT xml.VAL) AS XML_VAL
    FROM a, b, c,
      XMLTABLE('/field1/collection/value' passing my_xml_type
        COLUMNS VAL VARCHAR2(50) PATH '.') xml
    WHERE
          a.ID = b.SOME_ID
      AND b.OTHER_ID = c.OTHER_ID
      AND c.VAL = xml.VAL (+)

Now if you forget about the counting and just return rows, an example result set might look something like this:

    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      abc       123       123
    X      abc       456       null
    X      abc       789       789
    X      abc       789       789

**DESIRED:** Now when I want to do the distinct counts, I'd like it to return:

    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      1         3         2

**ACTUAL:** However, this is what I'm getting when I have them all as COUNT(DISTINCT ...):


    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      1         1         1

**ALTERNATIVE:** ...and if I take the DISTINCT out of the counts then I get:


    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      1         4         3

How come the DISTINCT seems to be operating only within a particular B_VAL, but taking it out causes it to operate across all the rows but not taking uniqueness into account?

Is there another way of doing this that doesn't involve having to replicate all the joins as a sub-query? Have I missed the point entirely?

(Please note, I'm not a DB developer at all, I've just been pulled in to help out, so sorry if this is an easy problem... I HAVE searched Google and browsed this site for answers before posting, though!)

Thanks.
",sql,oracle,plsql,count,distinct,,open,0,722,9,"PL/SQL SELECT with multiple COUNT(DISTINCT xxx) - unexpected results I'm trying to put together a query for an Oracle 11g application and I've run into a problem.

I'll simplify the real scenario to make it easier to understand (and also to protect the client's data):

* Table A is the base table. It has a known identifier in it that I pass in to the query.
* For each entry in Table A there may be multiple entries in Table B. Table B contains a value that I am interested in.
* For each entry in Table B there may also be multiple entries in Table C. Table C contains another value I'm interested in.
* I also have an XML snippet containing a list of values that may or may not match up to some values in table C.
* The query does an outer join to the XML so that if there is a matching value it will return the value again, otherwise it is null.

What I want to do is get back the identifier I passed in, a count of the unique values in B and C, as well as a count of the non-null values from the XML part of the join.

My current query is:

    SELECT
        a.ID
      , COUNT(DISTINCT b.VAL) AS B_VAL
      , COUNT(DISTINCT c.VAL) AS C_VAL
      , COUNT(DISTINCT xml.VAL) AS XML_VAL
    FROM a, b, c,
      XMLTABLE('/field1/collection/value' passing my_xml_type
        COLUMNS VAL VARCHAR2(50) PATH '.') xml
    WHERE
          a.ID = b.SOME_ID
      AND b.OTHER_ID = c.OTHER_ID
      AND c.VAL = xml.VAL (+)

Now if you forget about the counting and just return rows, an example result set might look something like this:

    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      abc       123       123
    X      abc       456       null
    X      abc       789       789
    X      abc       789       789

**DESIRED:** Now when I want to do the distinct counts, I'd like it to return:

    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      1         3         2

**ACTUAL:** However, this is what I'm getting when I have them all as COUNT(DISTINCT ...):


    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      1         1         1

**ALTERNATIVE:** ...and if I take the DISTINCT out of the counts then I get:


    ID     B_VAL     C_VAL     XML_VAL
    ---------------------------------------
    X      1         4         3

How come the DISTINCT seems to be operating only within a particular B_VAL, but taking it out causes it to operate across all the rows but not taking uniqueness into account?

Is there another way of doing this that doesn't involve having to replicate all the joins as a sub-query? Have I missed the point entirely?

(Please note, I'm not a DB developer at all, I've just been pulled in to help out, so sorry if this is an easy problem... I HAVE searched Google and browsed this site for answers before posting, though!)

Thanks.
",5
6585160,07/05/2011 15:28:07,829982,07/05/2011 15:13:54,1,0,I want to set negative numbers in a view to zero and any positive should remain the same,"select field1, field2, Field3,
case when exists
(select field1
from tbl1
where field < 0) then 0 else field1 end as Field2
from tbl1",sql,query,case,,,07/06/2011 01:30:58,not a real question,1,19,18,"I want to set negative numbers in a view to zero and any positive should remain the same select field1, field2, Field3,
case when exists
(select field1
from tbl1
where field < 0) then 0 else field1 end as Field2
from tbl1",3
1668395,11/03/2009 16:18:36,186641,10/08/2009 18:56:51,5,0,reset ms sql execution plan,I've looked all over for this command....what's the command to reset the sql server's execution plan?,sql,server,execution,plan,,,open,0,16,5,reset ms sql execution plan I've looked all over for this command....what's the command to reset the sql server's execution plan?,4
10362468,04/28/2012 09:58:58,1243095,03/01/2012 15:49:44,26,1,Using nolock in sql,"insert into table b select * from table a (nolock)  
where to use nolock the above one giving error as column nolco not found
my requirement is to insert tha data ffrom table a to table b but gettting frequent deadlocks.

",sql,,,,,04/30/2012 15:33:30,not a real question,1,41,4,"Using nolock in sql insert into table b select * from table a (nolock)  
where to use nolock the above one giving error as column nolco not found
my requirement is to insert tha data ffrom table a to table b but gettting frequent deadlocks.

",1
6743541,07/19/2011 07:19:00,226213,12/07/2009 08:55:27,340,12,Condition based on column in data,"There are two tables, the first contain data and the second meta data for the first based on category.

    table1 
    id, category1, category2, custom1, custom2, custom3...
    
    table2 
    category1, category2, denom, field

Example:

    table1
    AAAAA, Car, Compact, Red, Automatic, 150bhp
    
    table2
    Car, Compact, Color, custom1

The 'field' column in table2 points to which field in table1 we have meta data for.

Now what I am looking to do is to somehow use the value of the 'field' column in an sql as the column.


    select * from table1
    where table1.category1 = 'Car'
      and table1.category2 = 'Compact'
      and table1.category1 = table2.category1
      and table1.category2 = table2.category2
      and table2.denom = 'Color'
      and table1.(value of table2.field) = 'Red'

Is this possible to do in a single sql statement?
",sql,oracle,,,,,open,0,184,6,"Condition based on column in data There are two tables, the first contain data and the second meta data for the first based on category.

    table1 
    id, category1, category2, custom1, custom2, custom3...
    
    table2 
    category1, category2, denom, field

Example:

    table1
    AAAAA, Car, Compact, Red, Automatic, 150bhp
    
    table2
    Car, Compact, Color, custom1

The 'field' column in table2 points to which field in table1 we have meta data for.

Now what I am looking to do is to somehow use the value of the 'field' column in an sql as the column.


    select * from table1
    where table1.category1 = 'Car'
      and table1.category2 = 'Compact'
      and table1.category1 = table2.category1
      and table1.category2 = table2.category2
      and table2.denom = 'Color'
      and table1.(value of table2.field) = 'Red'

Is this possible to do in a single sql statement?
",2
1052149,06/27/2009 05:10:47,127880,06/23/2009 22:01:04,11,0,SqlConnection in .NET -- How can i best harness connection pooling?,"I read that .NET uses connection pooling. And, for example, if I instantiate a bunch of SqlConnection objects with the sam connection string, then internally .NET will know to use the same connection.

Is this correct? And, in a big web-based application, any tips on the best way to harness this ""power"" ?

Thanks.",sql,asp.net,sql-server,sql-server-2005,c#,,open,0,52,11,"SqlConnection in .NET -- How can i best harness connection pooling? I read that .NET uses connection pooling. And, for example, if I instantiate a bunch of SqlConnection objects with the sam connection string, then internally .NET will know to use the same connection.

Is this correct? And, in a big web-based application, any tips on the best way to harness this ""power"" ?

Thanks.",5
4524285,12/24/2010 04:53:46,59087,01/26/2009 19:01:48,4423,191,SQL to install a database program,"Is it possible to use [SQL][1] to install a database program?

If so, even in theory, how?

Thank you!

  [1]: http://en.wikipedia.org/wiki/SQL",sql,database,installer,,,12/24/2010 07:17:52,not a real question,1,20,6,"SQL to install a database program Is it possible to use [SQL][1] to install a database program?

If so, even in theory, how?

Thank you!

  [1]: http://en.wikipedia.org/wiki/SQL",3
6827408,07/26/2011 08:44:01,849753,07/18/2011 09:48:01,1,0,"if not CPU nor disk nor network, what is the bottleneck during query execution?","I work with SQL Server 2005 and wonder, if not CPU, disk or network, what are users waiting for when SQL Server is working. The strange thing is that system monitor shows that the 4 processors are at an average of 5%, the disk (demonstrated 50MB/s write) works with about 5-8 MB/s, but the execution (inserts and selects) take up to 10 minutes. I'd be happy to install additional hardware, but I don't see what device is the bottleneck and how do I measure its capacity and current workload.

Any advice would be appreciated.

Thanks

additional info: RAM is constantly at about 70% capacity and I am running windows xp.",sql,sql-server,windows,,,,open,0,107,14,"if not CPU nor disk nor network, what is the bottleneck during query execution? I work with SQL Server 2005 and wonder, if not CPU, disk or network, what are users waiting for when SQL Server is working. The strange thing is that system monitor shows that the 4 processors are at an average of 5%, the disk (demonstrated 50MB/s write) works with about 5-8 MB/s, but the execution (inserts and selects) take up to 10 minutes. I'd be happy to install additional hardware, but I don't see what device is the bottleneck and how do I measure its capacity and current workload.

Any advice would be appreciated.

Thanks

additional info: RAM is constantly at about 70% capacity and I am running windows xp.",3
197369,10/13/2008 12:18:23,18681,09/19/2008 09:24:14,704,56,Library of (Difficult) SQL scripts,"Does anyone know here I can find a library of common but difficult (out of the ordinary) SQL script examples. I am talking about those examples you cannot find in the documentation but do need very often to accomplish tasks such as finding duplicates etc.

It would be a big time saver to have something like that handy.",sql,example,scripting,library,,01/12/2012 13:38:01,not constructive,1,57,5,"Library of (Difficult) SQL scripts Does anyone know here I can find a library of common but difficult (out of the ordinary) SQL script examples. I am talking about those examples you cannot find in the documentation but do need very often to accomplish tasks such as finding duplicates etc.

It would be a big time saver to have something like that handy.",4
72166,09/16/2008 13:29:35,12178,09/16/2008 13:29:35,1,0,Penetration testing tools,"We have 100s of websites which were developed in asp, .net and java... and we are paying lot of money for an external agency to do a penetration testing for our sites to check for security loop holes. 
Are there any (good) software (paid or free) to do this? 

or.. are there any tehnical articles which can help me develop this tool. ",sql,security,injection,,,07/14/2012 01:59:58,not constructive,1,63,3,"Penetration testing tools We have 100s of websites which were developed in asp, .net and java... and we are paying lot of money for an external agency to do a penetration testing for our sites to check for security loop holes. 
Are there any (good) software (paid or free) to do this? 

or.. are there any tehnical articles which can help me develop this tool. ",3
2458066,03/16/2010 20:55:58,295153,03/16/2010 20:55:58,1,0,SQL query help - merge a value to all rows in a column,"I'm trying to migrate a site from a joomla system to a drupal. The problem is that drupal needs filename and sourcepath in the same row, but joomla only has filename. I'm looking for a way to add sourcepath before the filename in all the rows in that column.
I'm figuring it's the UPDATE statement that I should use, but I can't figure out how to construct the query.

There's a person with a similar problem here, but I don't find the answers in that thread helpful to my problem: http://www.daniweb.com/forums/showth...t+value&page=2

Any suggestions?",sql,query,update,merge,,,open,0,90,13,"SQL query help - merge a value to all rows in a column I'm trying to migrate a site from a joomla system to a drupal. The problem is that drupal needs filename and sourcepath in the same row, but joomla only has filename. I'm looking for a way to add sourcepath before the filename in all the rows in that column.
I'm figuring it's the UPDATE statement that I should use, but I can't figure out how to construct the query.

There's a person with a similar problem here, but I don't find the answers in that thread helpful to my problem: http://www.daniweb.com/forums/showth...t+value&page=2

Any suggestions?",4
7326337,09/06/2011 21:23:10,910825,08/24/2011 23:05:14,14,0,odd data scenario,"SQL (sorry for external link, it is not allowing me to write code here, anyone please update full question)[enter link description here][1]




thanks in advance


  [1]: http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=164968",sql,update,,,,09/26/2011 02:49:20,not a real question,1,27,3,"odd data scenario SQL (sorry for external link, it is not allowing me to write code here, anyone please update full question)[enter link description here][1]




thanks in advance


  [1]: http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=164968",2
6954014,08/05/2011 09:15:40,880245,08/05/2011 09:15:40,1,0,"Find biggest subset that sums to zero in excel or access(vba,sql or anything)","**I have a column of numbers in excel, with positives and negatives. It is an accounting book. I need to eliminate cells that sums to zero. It means I want to remove the subset, so the rest of element can not form any subset to sum to zero. I think this problem is to find the largest subset sum. By remove/eliminate, I mean to mark them in excel. 
For example: a set {1,-1,2,-2,3,-3,4,-4,5,-5,6,7,8,9}, I need a function that find subset {1,-1,2,-2,3,-3,4,-4,5,-5} and mark each element.**
",sql,excel,sum,access,subset,,open,0,85,13,"Find biggest subset that sums to zero in excel or access(vba,sql or anything) **I have a column of numbers in excel, with positives and negatives. It is an accounting book. I need to eliminate cells that sums to zero. It means I want to remove the subset, so the rest of element can not form any subset to sum to zero. I think this problem is to find the largest subset sum. By remove/eliminate, I mean to mark them in excel. 
For example: a set {1,-1,2,-2,3,-3,4,-4,5,-5,6,7,8,9}, I need a function that find subset {1,-1,2,-2,3,-3,4,-4,5,-5} and mark each element.**
",5
11654889,07/25/2012 16:59:25,578990,01/17/2011 19:48:14,370,21,LINQ Query performance - how to go about improving THIS query?,"I have written a module in my application that makes extensive use of Dynamic LINQ to produce linq/sql queries based on user interface selection.
Currently, the linq-sql translation is resulting in very unoptimised query results, so I am looking at ways to get LINQ to improve the SQL that it is producing.

The following is a typical scenario:

Firstly, the user interface controls are selected, resulting in a LINQ statement of:

`Company_contacts.Any(Cust_order_header.Any(Order_time >= @0))`

The table relations are as following : Companies 1-* Contacts 1-* Cust_order_header
The Cust_order_header contains the datetime field 'Order_time'.

Don't worry about @0 - that is a dynamic linq parameter that is passed in containing the datetime object.

The query translates to ""Give me all companies that have placed orders within the last (insert days based on datetime) days"".

 This results in a query that takes 5 minutes to complete, and kicks the hell out of the server.

The SQL it has created (which I have retrieved using `((ObjectQuery)groupQuery).ToTraceString())` is 


    SELECT *
    FROM [dbo].[Companies] AS [Extent1]
    WHERE  EXISTS (SELECT 
    	1 AS [C1]
    	FROM ( SELECT 
    		[Extent2].[Company_cont_key] AS [Company_cont_key]
    		FROM [dbo].[Company_contacts] AS [Extent2]
    		WHERE [Extent1].[Company_reference] = [Extent2].[Company_reference]
    	)  AS [Project1]
    	WHERE  EXISTS (SELECT 
    		1 AS [C1]
    		FROM [dbo].[Cust_order_header] AS [Extent3]
    		WHERE ([Project1].[Company_cont_key] = [Extent3].[Company_cont_key]) AND ([Extent3].[Order_time] >= convert(datetime, '2012-05-20 00:00:00.000', 121))
    	)
    )

Now, firstly - there are no joins in there, which leads me to think that the sql it is producing is significantly unoptimised.

AS, if I do to the following in SQL Management Studio manually:

    SELECT *
    FROM [dbo].[Companies] co
    join  [dbo].[Company_contacts] cc on co.Company_reference = cc.Company_reference
    join  [Cust_order_header] coh on coh.Company_cont_key = cc.Company_cont_key
    WHERE  [Order_time] >= convert(datetime, '2012-05-20 00:00:00.000', 121)

Then it's < 1s. 

So, I have spent 3 weeks putting together my Dynamic-LINQ based user controls/solution, getting rid of it isn't an option.

I'm wondering what the options are, or specifically how to go about configuring LINQ to do things a bit better. I'm even starting to wonder if its my dynamic LINQ extension code that is resulting in the unoptimised. (downloaded from [here][1])

Any help would be appreciated. Thanks.


  [1]: http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx",sql,performance,linq,,,07/25/2012 21:30:06,off topic,1,407,11,"LINQ Query performance - how to go about improving THIS query? I have written a module in my application that makes extensive use of Dynamic LINQ to produce linq/sql queries based on user interface selection.
Currently, the linq-sql translation is resulting in very unoptimised query results, so I am looking at ways to get LINQ to improve the SQL that it is producing.

The following is a typical scenario:

Firstly, the user interface controls are selected, resulting in a LINQ statement of:

`Company_contacts.Any(Cust_order_header.Any(Order_time >= @0))`

The table relations are as following : Companies 1-* Contacts 1-* Cust_order_header
The Cust_order_header contains the datetime field 'Order_time'.

Don't worry about @0 - that is a dynamic linq parameter that is passed in containing the datetime object.

The query translates to ""Give me all companies that have placed orders within the last (insert days based on datetime) days"".

 This results in a query that takes 5 minutes to complete, and kicks the hell out of the server.

The SQL it has created (which I have retrieved using `((ObjectQuery)groupQuery).ToTraceString())` is 


    SELECT *
    FROM [dbo].[Companies] AS [Extent1]
    WHERE  EXISTS (SELECT 
    	1 AS [C1]
    	FROM ( SELECT 
    		[Extent2].[Company_cont_key] AS [Company_cont_key]
    		FROM [dbo].[Company_contacts] AS [Extent2]
    		WHERE [Extent1].[Company_reference] = [Extent2].[Company_reference]
    	)  AS [Project1]
    	WHERE  EXISTS (SELECT 
    		1 AS [C1]
    		FROM [dbo].[Cust_order_header] AS [Extent3]
    		WHERE ([Project1].[Company_cont_key] = [Extent3].[Company_cont_key]) AND ([Extent3].[Order_time] >= convert(datetime, '2012-05-20 00:00:00.000', 121))
    	)
    )

Now, firstly - there are no joins in there, which leads me to think that the sql it is producing is significantly unoptimised.

AS, if I do to the following in SQL Management Studio manually:

    SELECT *
    FROM [dbo].[Companies] co
    join  [dbo].[Company_contacts] cc on co.Company_reference = cc.Company_reference
    join  [Cust_order_header] coh on coh.Company_cont_key = cc.Company_cont_key
    WHERE  [Order_time] >= convert(datetime, '2012-05-20 00:00:00.000', 121)

Then it's < 1s. 

So, I have spent 3 weeks putting together my Dynamic-LINQ based user controls/solution, getting rid of it isn't an option.

I'm wondering what the options are, or specifically how to go about configuring LINQ to do things a bit better. I'm even starting to wonder if its my dynamic LINQ extension code that is resulting in the unoptimised. (downloaded from [here][1])

Any help would be appreciated. Thanks.


  [1]: http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx",3
11296739,07/02/2012 15:32:15,1496452,07/02/2012 15:19:40,1,0,"Incorrect syntax near ',' ","    INSERT INTO [Temp].[dbo].[Student]
        ([Fname], [Lname], [Gender])
        VALUES 
        (N'Aname', N'Alname', N'Male')
        GO

This codes workes fine but when I try to add multiple values it gives me an error

   

    USE TEMP
    GO
   
    INSERT INTO [Temp].[dbo].[Student]
    ([Fname], [Lname], [Gender])
    VALUES 
    (N'Aname', N'Alname', N'Male'),
    (N'Bname', N'Blname', N'Male')
    GO

**Error: Incorrect syntax near ','.**

Thanks for help!
",sql,sql-server-2008,tsql,,,07/02/2012 17:43:55,too localized,1,114,5,"Incorrect syntax near ','      INSERT INTO [Temp].[dbo].[Student]
        ([Fname], [Lname], [Gender])
        VALUES 
        (N'Aname', N'Alname', N'Male')
        GO

This codes workes fine but when I try to add multiple values it gives me an error

   

    USE TEMP
    GO
   
    INSERT INTO [Temp].[dbo].[Student]
    ([Fname], [Lname], [Gender])
    VALUES 
    (N'Aname', N'Alname', N'Male'),
    (N'Bname', N'Blname', N'Male')
    GO

**Error: Incorrect syntax near ','.**

Thanks for help!
",3
809052,04/30/2009 21:00:47,30946,10/23/2008 19:56:12,1773,121,is it better to put more logic in your ON clause or should it only have the minimum necessary? ,"Given these two queries: 

    Select t1.id, t2.companyName 
    from table1 t1 
      INNER JOIN table2 t2 on t2.id = t1.fkId 
    WHERE t2.aField <> 'C' 

OR: 

    Select t1.id, t2.companyName 
    from table1 t1 
      INNER JOIN table2 t2 on t2.id = t1.fkId  and t2.aField <> 'C'

Is there a demonstrable difference between the two? Seems to me that the clause ""t2.aField <> 'C'"" will run on every row in t2 that meets the join criteria regardless. Am I incorrect? 

I searched for this but didn't find it. 

",sql,sql-server,,,,,open,0,115,20,"is it better to put more logic in your ON clause or should it only have the minimum necessary?  Given these two queries: 

    Select t1.id, t2.companyName 
    from table1 t1 
      INNER JOIN table2 t2 on t2.id = t1.fkId 
    WHERE t2.aField <> 'C' 

OR: 

    Select t1.id, t2.companyName 
    from table1 t1 
      INNER JOIN table2 t2 on t2.id = t1.fkId  and t2.aField <> 'C'

Is there a demonstrable difference between the two? Seems to me that the clause ""t2.aField <> 'C'"" will run on every row in t2 that meets the join criteria regardless. Am I incorrect? 

I searched for this but didn't find it. 

",2
11292896,07/02/2012 11:38:57,1495934,07/02/2012 11:30:33,1,0,SQL Matching Qurrey,"I have two tables:
table a

ida     valuea
1       a
2       b
3       c
1       d
1       e
2       f
table b
idb      valueb
1 
2

I make valueb as a combobox and need to source it from a qurrey that  select valuea if only ida = current idb  ",sql,,,,,07/02/2012 18:22:37,not a real question,1,85,3,"SQL Matching Qurrey I have two tables:
table a

ida     valuea
1       a
2       b
3       c
1       d
1       e
2       f
table b
idb      valueb
1 
2

I make valueb as a combobox and need to source it from a qurrey that  select valuea if only ida = current idb  ",1
4833049,01/28/2011 21:04:26,429909,08/24/2010 18:34:39,142,4,Use & in MSSQL UPDATE,"I am trying to run a query like

`UPDATE myTable SET Name='B&L' WHERE ID = 1;`

The problem is I am getting the following error:

`Unclosed quotation mark after the character string 'B'.`


My column is of type varChar and as you can see I am escaping the string with 'quotes'. How can I get the & symbol to insert?

Thanks.",sql,sql-server,,,,,open,0,56,5,"Use & in MSSQL UPDATE I am trying to run a query like

`UPDATE myTable SET Name='B&L' WHERE ID = 1;`

The problem is I am getting the following error:

`Unclosed quotation mark after the character string 'B'.`


My column is of type varChar and as you can see I am escaping the string with 'quotes'. How can I get the & symbol to insert?

Thanks.",2
7631582,10/03/2011 06:11:09,248521,01/12/2010 01:18:02,2553,37,SQL User Defined Java Function (Character conversion between CCSID 65535 and CCSID 1200 not valid),"I have been having a problem with an iSeries Function whereby it is not connverting data properly becuase my default user profice is using CCSID 65535.  I can change the job to CCSID 37 and everything works fine.

I want a solution whereby the user does not need to change their job properties.

The function is running a java application and looks like this

    CREATE FUNCTION mylib/re_Test2(input VARCHAR(500) CCSID 37,
                                  regex VARCHAR(500) CCSID 37)
    RETURNS INTEGER
    EXTERNAL NAME 'UDFs.re_Test'
    LANGUAGE Java
    PARAMETER STYLE Java
    FENCED
    NO SQL
    RETURNS NULL ON NULL INPUT
    SCRATCHPAD
    DETERMINISTIC

I tried it without using the CCSID 37 initially but found some posts suggesting that adding this would force any parameters to be converted to US English.  It does not seem to be working for me.

Any suggestions?

I tried runing from strsql and an RPGLE script but both don't work, however, from SQLSquirrel (an open source sql program that uses ODBC) it works.

",sql,ibm-midrange,,,,,open,0,218,15,"SQL User Defined Java Function (Character conversion between CCSID 65535 and CCSID 1200 not valid) I have been having a problem with an iSeries Function whereby it is not connverting data properly becuase my default user profice is using CCSID 65535.  I can change the job to CCSID 37 and everything works fine.

I want a solution whereby the user does not need to change their job properties.

The function is running a java application and looks like this

    CREATE FUNCTION mylib/re_Test2(input VARCHAR(500) CCSID 37,
                                  regex VARCHAR(500) CCSID 37)
    RETURNS INTEGER
    EXTERNAL NAME 'UDFs.re_Test'
    LANGUAGE Java
    PARAMETER STYLE Java
    FENCED
    NO SQL
    RETURNS NULL ON NULL INPUT
    SCRATCHPAD
    DETERMINISTIC

I tried it without using the CCSID 37 initially but found some posts suggesting that adding this would force any parameters to be converted to US English.  It does not seem to be working for me.

Any suggestions?

I tried runing from strsql and an RPGLE script but both don't work, however, from SQLSquirrel (an open source sql program that uses ODBC) it works.

",2
10154349,04/14/2012 14:28:34,685555,03/31/2011 10:47:22,91,2,"Return count using raw query, using Entity Framework and MVC","I am using Entity Framework in an MVC website

I am trying to get just the number of records using a raw query.

I am looking for something along these lines but any will be happy with any solution at all.

var sql = SELECT COUNT(*) FROM dbo.Articles WHERE (CategoryID = 3)

var total = _context.Database.SOMETHING(sql)

I realise that for such a simple scenario, a raw query is perhaps not the way to go but in reality, the sql string is MUCH more complicated so it is next to impossible for to use Linq to SQL.

Many Thanks",sql,mvc,entity-framework,,,,open,0,92,10,"Return count using raw query, using Entity Framework and MVC I am using Entity Framework in an MVC website

I am trying to get just the number of records using a raw query.

I am looking for something along these lines but any will be happy with any solution at all.

var sql = SELECT COUNT(*) FROM dbo.Articles WHERE (CategoryID = 3)

var total = _context.Database.SOMETHING(sql)

I realise that for such a simple scenario, a raw query is perhaps not the way to go but in reality, the sql string is MUCH more complicated so it is next to impossible for to use Linq to SQL.

Many Thanks",3
6037982,05/17/2011 22:38:31,742506,05/06/2011 21:48:31,6,0,DB2 date conversion,"I have 2 `INTEGER` columns like the following:

    Month      Year
    -----      -----
      5         2011

Is there any way to convert that to a single column `VARCHAR` like this: `May-2011`",sql,db2,,,,,open,0,57,3,"DB2 date conversion I have 2 `INTEGER` columns like the following:

    Month      Year
    -----      -----
      5         2011

Is there any way to convert that to a single column `VARCHAR` like this: `May-2011`",2
1568886,10/14/2009 20:44:56,146210,07/28/2009 07:48:43,17,0,MySQL Order by NULL join,"I'm trying to do an ORDER BY where I want any rows without an entry in the join table to appear at the bottom of the list and then organised by name. Simplified tables are:

users (id, name)
photos (id, filename, user_id)

So far I have:

    SELECT name FROM users 
    LEFT OUTER JOIN photos ON photos.user_id = users.id
    ORDER BY *ANSWER HERE*, name DESC

Many thanks.",sql,mysql,,,,,open,0,72,5,"MySQL Order by NULL join I'm trying to do an ORDER BY where I want any rows without an entry in the join table to appear at the bottom of the list and then organised by name. Simplified tables are:

users (id, name)
photos (id, filename, user_id)

So far I have:

    SELECT name FROM users 
    LEFT OUTER JOIN photos ON photos.user_id = users.id
    ORDER BY *ANSWER HERE*, name DESC

Many thanks.",2
8338172,12/01/2011 08:06:12,1074944,12/01/2011 07:46:34,1,0,unable to connect to the report server 2008 r2,"-

i can't to connect report server 

**PC config**
window 7, II7, sql sever 2008 R2

Reporting services configuration manager give error 

when i connect to the server give this error

**Unable to connect to the report server [ServerName]**",sql,sql-server,sql-server-2008,sql-server-2008-r2,,12/02/2011 04:00:48,off topic,1,35,9,"unable to connect to the report server 2008 r2 -

i can't to connect report server 

**PC config**
window 7, II7, sql sever 2008 R2

Reporting services configuration manager give error 

when i connect to the server give this error

**Unable to connect to the report server [ServerName]**",4
5698307,04/18/2011 03:45:27,593151,01/28/2011 01:45:29,2,1,Is SQL becoming obsolete?,"Interested in some opinions on whether SQL is becoming obsolete. At my place of work, ORMs (in particular, Doctrine) are growing more popular for our web dev projects, and early indications seem to be suggesting that it's capable of doing pretty much everything we need for these small to medium sized apps (haven't yet had any major reporting requirements though). Is this the future of data modelling for web dev projects? (Apologies in advance if this is not the forum for this type of question).",sql,orm,doctrine,,,04/18/2011 03:54:14,not constructive,1,85,4,"Is SQL becoming obsolete? Interested in some opinions on whether SQL is becoming obsolete. At my place of work, ORMs (in particular, Doctrine) are growing more popular for our web dev projects, and early indications seem to be suggesting that it's capable of doing pretty much everything we need for these small to medium sized apps (haven't yet had any major reporting requirements though). Is this the future of data modelling for web dev projects? (Apologies in advance if this is not the forum for this type of question).",3
8463370,12/11/2011 10:46:14,1092122,12/11/2011 10:31:25,1,0,where can I find sql logs of queries that were submitted by users?,"I am looking for specific sql query logs.
I am not talking about most common type of queries that were developed once and used repeatedly. In some systems users need to execute continuously changing queries as the desired analysis on the data changes over time, so do the queries.
Can anyone tell me where can I find such logs?
",sql,query,user,logging,,12/11/2011 14:01:53,not a real question,1,57,13,"where can I find sql logs of queries that were submitted by users? I am looking for specific sql query logs.
I am not talking about most common type of queries that were developed once and used repeatedly. In some systems users need to execute continuously changing queries as the desired analysis on the data changes over time, so do the queries.
Can anyone tell me where can I find such logs?
",4
4142486,11/10/2010 08:27:20,155035,08/12/2009 12:01:27,268,1,SQL: Using Case to select a field?,"Based on if one field in the database is equal to something i want to select the value of anohter field. I was thinking that i could use CASE THEN but i can't get it to return the value of a field.

Here is what i have tried so far:

    SELECT LastName, CASE FirstName WHEN 'Ian' THEN JobNo END
  FROM Employees

JobNo is the name of the field which i want to get the value from.",sql,,,,,,open,0,78,7,"SQL: Using Case to select a field? Based on if one field in the database is equal to something i want to select the value of anohter field. I was thinking that i could use CASE THEN but i can't get it to return the value of a field.

Here is what i have tried so far:

    SELECT LastName, CASE FirstName WHEN 'Ian' THEN JobNo END
  FROM Employees

JobNo is the name of the field which i want to get the value from.",1
3202208,07/08/2010 09:27:01,113047,05/27/2009 09:53:17,125,9,What is the correct strategy to normalize a database with articles and tags for the articles?,"I am building a system that stores articles and tags that categorize the article. Standard stuff, similar to how this website does it. Now my question is whether I should store the tags on a separate table that just contains tags and article ids or store the tags on an extra column in the articles table. My first instinct would be to normalize the database and have two tables. The problem is that the interface with which the user administers the tags is a simple text box with all tags separated by commas. So when the user commits his changes, in order to find out which tags where added, changed or subtracted, I would need to first query the database , compare the results with the new data on a tag basis and then process the changes accordingly. A process with a huge overhead, compared with simply updating the one filed in the one row of the articles table. How would you do it or is there a third option I havent considered? 

PD. I am stuck with a relational database for this project .
",sql,database,normalization,,,,open,0,185,16,"What is the correct strategy to normalize a database with articles and tags for the articles? I am building a system that stores articles and tags that categorize the article. Standard stuff, similar to how this website does it. Now my question is whether I should store the tags on a separate table that just contains tags and article ids or store the tags on an extra column in the articles table. My first instinct would be to normalize the database and have two tables. The problem is that the interface with which the user administers the tags is a simple text box with all tags separated by commas. So when the user commits his changes, in order to find out which tags where added, changed or subtracted, I would need to first query the database , compare the results with the new data on a tag basis and then process the changes accordingly. A process with a huge overhead, compared with simply updating the one filed in the one row of the articles table. How would you do it or is there a third option I havent considered? 

PD. I am stuck with a relational database for this project .
",3
9778471,03/19/2012 21:49:32,1009171,10/23/2011 03:27:05,36,1,spaces in SQL entries,"Is it bad practice to have spaces in between words in SQL entries?

Food Table

id    | name  |  descriptions

1   |    large pizza |  very large

or do you need underscores?",sql,database,,,,,open,0,39,4,"spaces in SQL entries Is it bad practice to have spaces in between words in SQL entries?

Food Table

id    | name  |  descriptions

1   |    large pizza |  very large

or do you need underscores?",2
9557529,03/04/2012 18:15:05,760946,05/19/2011 11:12:35,30,0,how to run this piece of sql code in oracle?,"I have this code in sql, it runs perfectly on sql server 2005. But when i run this code in isql plus, it gives error, what changes should I make to run it.

code is---

    DECLARE @stu_Name VARCHAR(50), @stu_Address VARCHAR(50)
    SELECT @stu_Name = g.stu_Name,@stu_Address= g.stu_address 
    FROM student as g
    WHERE unique_no = 's121' 
    INSERT INTO 
       dbo.student(stu_no, stu_name, dateofbirth,stu_unique_no, stu_name,stu_address)
    VALUES
         (13, 'John', '1990-12-12','s121', @stu_Name, @stu_Address);",sql,oracle,server,isql,plus,03/05/2012 08:20:39,not a real question,1,99,10,"how to run this piece of sql code in oracle? I have this code in sql, it runs perfectly on sql server 2005. But when i run this code in isql plus, it gives error, what changes should I make to run it.

code is---

    DECLARE @stu_Name VARCHAR(50), @stu_Address VARCHAR(50)
    SELECT @stu_Name = g.stu_Name,@stu_Address= g.stu_address 
    FROM student as g
    WHERE unique_no = 's121' 
    INSERT INTO 
       dbo.student(stu_no, stu_name, dateofbirth,stu_unique_no, stu_name,stu_address)
    VALUES
         (13, 'John', '1990-12-12','s121', @stu_Name, @stu_Address);",5
11546867,07/18/2012 17:18:50,1442579,06/07/2012 15:17:31,1,0,"SQL Server Bulk Insert with ""^M"" rowterminator","I have a flat file that ends each row with a ^M character. I have found that this is generated from dos/windows OS and is a visual representation of 0x0D. I am trying to do a bulk insert on the file into SQL Server 2008 but I can't find a way to define ^M in a way that the process will know it is the rowterminator. I have tried specifying it multiple ways but no success. Any ideas on how to import this file with the ""^M"" character as the rowterminator?",sql,import,bulk,,,,open,0,91,7,"SQL Server Bulk Insert with ""^M"" rowterminator I have a flat file that ends each row with a ^M character. I have found that this is generated from dos/windows OS and is a visual representation of 0x0D. I am trying to do a bulk insert on the file into SQL Server 2008 but I can't find a way to define ^M in a way that the process will know it is the rowterminator. I have tried specifying it multiple ways but no success. Any ideas on how to import this file with the ""^M"" character as the rowterminator?",3
7667199,10/05/2011 20:17:03,880642,08/05/2011 13:18:27,87,6,What are the major differences between SQL Server and Neteeza?,"I've recently been asked to join a team on which I'll be doing some Neteeza work. As part of my preperation for the move, I wanted to do some tutorials on Neteeza to get up-to-speed but couldn't find any good free ones online.

Is this because the SQL used in Neteeza is pretty standard? What are the major differences (without respect to hardware) between SQL Server and Neteeza? ",sql,sql-server,,,,10/05/2011 22:27:34,off topic,1,68,10,"What are the major differences between SQL Server and Neteeza? I've recently been asked to join a team on which I'll be doing some Neteeza work. As part of my preperation for the move, I wanted to do some tutorials on Neteeza to get up-to-speed but couldn't find any good free ones online.

Is this because the SQL used in Neteeza is pretty standard? What are the major differences (without respect to hardware) between SQL Server and Neteeza? ",2
4422528,12/12/2010 16:07:05,524269,11/29/2010 19:15:56,6,0,T-SQL Raiserror Losses Message If Includes Datetime Converted To Char(10),"Okay, so I am trying to raise an error in T-SQL (SQL-2000).  The base Sql code looks like this . . .

    declare @TmsString  char(10),
            @TmsLast    datetime,
            @UserMsg    varchar(500)
    
    select @TmsLast = getdate()
    
    select  @TmsString = ltrim(rtrim(convert(char(10), @TmsLast, 101)))
    select  @UserMsg = '*' + ltrim(rtrim(cast(@TmsString as char))) + '*'
    
    raiserror (@UserMsg, 12, 1)
    return

My Managed C++ Code in VS2008 to catch the raiserror looks like this . . .

    System::Void Sql_ExecuteQuery (SqlCommand ^ sqlCommand, DataSet ^ OutDS, String ^ TableName)
    {
       SqlConnection   ^ sqlConnect ;
       SqlDataAdapter  ^ sqlDA ;
    
       try
       {
          sqlDA = gcnew SqlDataAdapter () ;
    
          sqlConnect = gcnew SqlConnection (_ConnString) ;
          sqlConnect->Open () ;
    
          sqlCommand->Connection = sqlConnect ;
    
          sqlDA->SelectCommand = sqlCommand ;
          sqlDA->Fill (OutDS, TableName) ;
       }
       catch (Exception ^ excp)
       {
          throw gcnew Exception (excp->Message->ToString()) ;
       }
       finally
       {
          sqlConnect->Close () ;
       }
    }



Now, I have a breakpoint sest at the catch within the ""C++"" code.  If the raiserror message includes the datetime as a CHAR, the excp->Message is empty.  If I remove the datetime as a CHAR and just send a hardcoded raiserror message such as ""Error happens here"", then the excp->Message is complete and filled in with the raiserror message.

Has anybody else seen this type of activity?  What can I do on either side of this call . . . i.e., either on the SQL side or the C++ side to get this datetime string included in the raiserror message????

Please, help.  I am stuck!

THANK YOU !",sql,string,datetime,raiserror,,,open,0,473,10,"T-SQL Raiserror Losses Message If Includes Datetime Converted To Char(10) Okay, so I am trying to raise an error in T-SQL (SQL-2000).  The base Sql code looks like this . . .

    declare @TmsString  char(10),
            @TmsLast    datetime,
            @UserMsg    varchar(500)
    
    select @TmsLast = getdate()
    
    select  @TmsString = ltrim(rtrim(convert(char(10), @TmsLast, 101)))
    select  @UserMsg = '*' + ltrim(rtrim(cast(@TmsString as char))) + '*'
    
    raiserror (@UserMsg, 12, 1)
    return

My Managed C++ Code in VS2008 to catch the raiserror looks like this . . .

    System::Void Sql_ExecuteQuery (SqlCommand ^ sqlCommand, DataSet ^ OutDS, String ^ TableName)
    {
       SqlConnection   ^ sqlConnect ;
       SqlDataAdapter  ^ sqlDA ;
    
       try
       {
          sqlDA = gcnew SqlDataAdapter () ;
    
          sqlConnect = gcnew SqlConnection (_ConnString) ;
          sqlConnect->Open () ;
    
          sqlCommand->Connection = sqlConnect ;
    
          sqlDA->SelectCommand = sqlCommand ;
          sqlDA->Fill (OutDS, TableName) ;
       }
       catch (Exception ^ excp)
       {
          throw gcnew Exception (excp->Message->ToString()) ;
       }
       finally
       {
          sqlConnect->Close () ;
       }
    }



Now, I have a breakpoint sest at the catch within the ""C++"" code.  If the raiserror message includes the datetime as a CHAR, the excp->Message is empty.  If I remove the datetime as a CHAR and just send a hardcoded raiserror message such as ""Error happens here"", then the excp->Message is complete and filled in with the raiserror message.

Has anybody else seen this type of activity?  What can I do on either side of this call . . . i.e., either on the SQL side or the C++ side to get this datetime string included in the raiserror message????

Please, help.  I am stuck!

THANK YOU !",4
11717989,07/30/2012 08:42:25,1112246,12/22/2011 18:06:38,1,3,Is this wrapper safe from sql injection?,"I'm writing a db wrapper for a project where speed(for huge query) and safety is mostly concern.
I do not want to use ""prepare"" statement  
Does my code hold these requirements?   




         class db{
		// configuration
		public static $dbtype		= ""mysql""; /* mysql/sqlite */
		public static $dbhost 		= ""localhost"";
		public static $dbname		= ""test"";
		public static $dbuser		= ""root"";
		public static $dbpass		= ""root"";
		public static $dbpath		= ""./lib/database/db.sqlite"";
		public static $charset		= ""utf8"";
		public static $errorMode	= ""PDO::ERRMODE_EXCEPTION"";
		public static $logMode 		= 1;
		private static $pdo = null;	
		
		final private function __construct() {}
		final private function __clone() {}	

		public static function init(){
			switch(self::$dbtype){
			  case ""mysql"":
				$dsn = ""mysql:host="".self::$dbhost."";dbname="".self::$dbname;
				break;			
			  case ""sqlite"":
				$dsn = ""sqlite:"".self::$dbpath;
				break;			
			}
			if (self::$pdo === null){
				try{
					self::$pdo = new PDO($dsn, self::$dbuser, self::$dbpass);					
					self::$pdo->exec(""SET CHARACTER SET "".self::$charset);
					self::$pdo->setAttribute(PDO::ATTR_ERRMODE, self::$errorMode); 
					self::$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, true);
				    if(self::$dbtype!='sqlite'){
					   self::$pdo->setAttribute(PDO::ATTR_AUTOCOMMIT, false);
					}				
					self::$pdo->setAttribute(PDO::ATTR_PERSISTENT, true);
					self::$pdo->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, true);
				}catch (PDOException $e){
					die('Connection error : ' . $e->getMessage());;
				} 
			}			
			return self::$pdo;
		}
	
		/**
		 * @return PDOStatement
		 */
		
		public static function getAllRow($table, $clause=null){ /*  $result = db::getAllRow('table', $clause) */
			$table = self::quoted($table);		
			$query  = ""SELECT * FROM "" . $table . "" "" . $clause . "";"";
			$results = self::runAndResult($query);
			if($results){return $results;}else{self::error();};	
		} 
		
		/*--------------------Other methods here-----------------------*/
					
		/*-------------------------------------------*/
		
		protected function quoted($name) {
			$name = trim($name);
			$name = str_replace('`', '', $name);
				if (strpos($name, '.')) {
				  list($table_db, $table_table) = explode('.', $name, 2);
				  $name = ""`$table_db`.`$table_table`"";
				} else {
				  $name = ""`$name`"";
				}
			return $name;
		}
		
		protected function error($data=null) {			
			($data==null)? print_r (""Query error : "". self::$pdo->errorInfo()) : print_r ($data);
		}
		
		protected function runAndResult($query) { 
				return self::init()->query($query);
		}

		protected function runButResult($query) {
				return self::init()->exec($query);
		}
	}


	/** usage	
	******************  /*
		$results = db::getAllRow('test', 'WHERE id<100');
			foreach ($results as $row){
			  print $row['id'] ."" and "". $row['value'] . ""<br/>"";
			}
Please let me find the lack and advice me to fix.",sql,sql-injection,,,,07/30/2012 08:53:33,off topic,1,253,7,"Is this wrapper safe from sql injection? I'm writing a db wrapper for a project where speed(for huge query) and safety is mostly concern.
I do not want to use ""prepare"" statement  
Does my code hold these requirements?   




         class db{
		// configuration
		public static $dbtype		= ""mysql""; /* mysql/sqlite */
		public static $dbhost 		= ""localhost"";
		public static $dbname		= ""test"";
		public static $dbuser		= ""root"";
		public static $dbpass		= ""root"";
		public static $dbpath		= ""./lib/database/db.sqlite"";
		public static $charset		= ""utf8"";
		public static $errorMode	= ""PDO::ERRMODE_EXCEPTION"";
		public static $logMode 		= 1;
		private static $pdo = null;	
		
		final private function __construct() {}
		final private function __clone() {}	

		public static function init(){
			switch(self::$dbtype){
			  case ""mysql"":
				$dsn = ""mysql:host="".self::$dbhost."";dbname="".self::$dbname;
				break;			
			  case ""sqlite"":
				$dsn = ""sqlite:"".self::$dbpath;
				break;			
			}
			if (self::$pdo === null){
				try{
					self::$pdo = new PDO($dsn, self::$dbuser, self::$dbpass);					
					self::$pdo->exec(""SET CHARACTER SET "".self::$charset);
					self::$pdo->setAttribute(PDO::ATTR_ERRMODE, self::$errorMode); 
					self::$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, true);
				    if(self::$dbtype!='sqlite'){
					   self::$pdo->setAttribute(PDO::ATTR_AUTOCOMMIT, false);
					}				
					self::$pdo->setAttribute(PDO::ATTR_PERSISTENT, true);
					self::$pdo->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, true);
				}catch (PDOException $e){
					die('Connection error : ' . $e->getMessage());;
				} 
			}			
			return self::$pdo;
		}
	
		/**
		 * @return PDOStatement
		 */
		
		public static function getAllRow($table, $clause=null){ /*  $result = db::getAllRow('table', $clause) */
			$table = self::quoted($table);		
			$query  = ""SELECT * FROM "" . $table . "" "" . $clause . "";"";
			$results = self::runAndResult($query);
			if($results){return $results;}else{self::error();};	
		} 
		
		/*--------------------Other methods here-----------------------*/
					
		/*-------------------------------------------*/
		
		protected function quoted($name) {
			$name = trim($name);
			$name = str_replace('`', '', $name);
				if (strpos($name, '.')) {
				  list($table_db, $table_table) = explode('.', $name, 2);
				  $name = ""`$table_db`.`$table_table`"";
				} else {
				  $name = ""`$name`"";
				}
			return $name;
		}
		
		protected function error($data=null) {			
			($data==null)? print_r (""Query error : "". self::$pdo->errorInfo()) : print_r ($data);
		}
		
		protected function runAndResult($query) { 
				return self::init()->query($query);
		}

		protected function runButResult($query) {
				return self::init()->exec($query);
		}
	}


	/** usage	
	******************  /*
		$results = db::getAllRow('test', 'WHERE id<100');
			foreach ($results as $row){
			  print $row['id'] ."" and "". $row['value'] . ""<br/>"";
			}
Please let me find the lack and advice me to fix.",2
9080740,01/31/2012 13:58:03,1180464,01/31/2012 13:53:01,1,0,How do I connect an SQL database to Lotus Domino Designer?,"I am creating a Lotus Notes application which has to have dynamic combo boxes. The choices for the combo boxes need to be retrieved by selecting from a SQL database. 

I am new to Lotus Notes / Domino, I would love to know how to connect my SQL database for use in the domino designer. Thanks.",sql,sql-server-2005,lotus-notes,lotus-domino,lotusscript,,open,0,56,11,"How do I connect an SQL database to Lotus Domino Designer? I am creating a Lotus Notes application which has to have dynamic combo boxes. The choices for the combo boxes need to be retrieved by selecting from a SQL database. 

I am new to Lotus Notes / Domino, I would love to know how to connect my SQL database for use in the domino designer. Thanks.",5
6042767,05/18/2011 09:49:13,753454,05/14/2011 08:56:49,1,0,SQL Server CASE .. WHEN .. IN statement,"On SQL server 2005 I am trying to query this select statement 

    SELECT
        AlarmEventTransactionTableTable.TxnID,
		CASE AlarmEventTransactions.DeviceID
			WHEN DeviceID IN('7', '10', '62', '58', '60',
					 '46', '48', '50', '137', '139',
					 '142', '143', '164') THEN '01'
			WHEN DeviceID IN('8', '9', '63', '59', '61',
					 '47', '49', '51', '138', '140',
					 '141', '144', '165') THEN '02'
            ELSE 'NA' END AS clocking,
      
        AlarmEventTransactionTable.DateTimeOfTxn
     FROM
        multiMAXTxn.dbo.AlarmEventTransactionTable

It reyurn below Error 

     Msg 156, Level 15, State 1, Line 4 
     Incorrect syntax near the keyword 'IN'.

Please advise what it could be wrong 
",sql,sql-server-2005,case-when,,,,open,0,135,8,"SQL Server CASE .. WHEN .. IN statement On SQL server 2005 I am trying to query this select statement 

    SELECT
        AlarmEventTransactionTableTable.TxnID,
		CASE AlarmEventTransactions.DeviceID
			WHEN DeviceID IN('7', '10', '62', '58', '60',
					 '46', '48', '50', '137', '139',
					 '142', '143', '164') THEN '01'
			WHEN DeviceID IN('8', '9', '63', '59', '61',
					 '47', '49', '51', '138', '140',
					 '141', '144', '165') THEN '02'
            ELSE 'NA' END AS clocking,
      
        AlarmEventTransactionTable.DateTimeOfTxn
     FROM
        multiMAXTxn.dbo.AlarmEventTransactionTable

It reyurn below Error 

     Msg 156, Level 15, State 1, Line 4 
     Incorrect syntax near the keyword 'IN'.

Please advise what it could be wrong 
",3
2044467,01/11/2010 19:49:20,144842,07/25/2009 02:38:47,34,0,How to update two tables in one statement in SQL Server 2005?,"I want to update two tables in one go. How do i do that in SQL Server 2005?

    UPDATE Table1, Table2
    SET Table1.LastName = 'DR. XXXXXX' 
    ,Table2.WAprrs = 'start,stop'
    FROM Table1 T1, Table2 T2
    WHERE T1.id = T2.id
    and T1.id = '010008'",sql,sql-server,sql-server-2005,tsql,,,open,0,61,12,"How to update two tables in one statement in SQL Server 2005? I want to update two tables in one go. How do i do that in SQL Server 2005?

    UPDATE Table1, Table2
    SET Table1.LastName = 'DR. XXXXXX' 
    ,Table2.WAprrs = 'start,stop'
    FROM Table1 T1, Table2 T2
    WHERE T1.id = T2.id
    and T1.id = '010008'",4
9127679,02/03/2012 11:07:42,569654,01/10/2011 10:16:58,873,15,How to delete duplicate rows from sql server?,i have duplicate rows in several sql tables but the IDs are different. Is there  a query i can run to delete these rows?,sql,sql-server,,,,02/04/2012 01:39:16,not a real question,1,25,8,How to delete duplicate rows from sql server? i have duplicate rows in several sql tables but the IDs are different. Is there  a query i can run to delete these rows?,2
2940403,05/30/2010 21:26:32,66803,02/16/2009 04:11:07,1715,39,How is GUID pronounced?,"Is it pronounced ""Gewid"" or is it prononced ""G.U.I.D"" by spelling out the letters.  It seems inconsistently used.  What is the proper pronountiaton?  Same story goes for SQL.  It seems more people say ""S.Q.L."" than ""Sequel"".",sql,guid,programming-terms,,,05/30/2010 21:49:26,not constructive,1,40,4,"How is GUID pronounced? Is it pronounced ""Gewid"" or is it prononced ""G.U.I.D"" by spelling out the letters.  It seems inconsistently used.  What is the proper pronountiaton?  Same story goes for SQL.  It seems more people say ""S.Q.L."" than ""Sequel"".",3
5365148,03/19/2011 21:51:25,667721,03/19/2011 21:51:25,1,0,Need help with SQL,i want to choose all the LIKE values but not a specific one ,sql,,,,,03/21/2011 00:22:25,not a real question,1,14,4,Need help with SQL i want to choose all the LIKE values but not a specific one ,1
1202520,07/29/2009 19:32:24,147355,07/29/2009 19:28:36,1,0,find a reference to a table in dts packages,"I need to find a dts package that contains a specific table name...  My_Prod is the table name.

There are 200+ dts packages each with multiple object in them.

is there a sql command to find all instances of this table name?
",sql,server,dts,,,,open,0,41,9,"find a reference to a table in dts packages I need to find a dts package that contains a specific table name...  My_Prod is the table name.

There are 200+ dts packages each with multiple object in them.

is there a sql command to find all instances of this table name?
",3
8390858,12/05/2011 19:42:36,690936,04/04/2011 10:42:52,21,0,copying the old table - trigger in sql\plpgsql,"i have a trigger for a certain table in my database, 

    CREATE TRIGGER trig_trig
    AFTER DELETE OR UPDATE OR INSERT ON A 
    FOR EACH ROW
    EXECUTE PROCEDURE trig_func();

anyway.. i want to create a copy of the old table, and then run some tests on the difference between the 2.

to copy a table is easy , simply i do :

    CREATE OR REPLACE FUNCTION trig_func() RETURNS TRIGGER AS $$
    BEGIN

    CREATE TABLE temp as(SELECT * FROM A);
    DROP TABLE temp;
    return new;	
    END;
    $$ LANGUAGE plpgsql;

but i want to get the version before and after the change. this will simply give me one of them
i tried:

    CREATE TABLE temp as(SELECT * FROM OLD.A); 

or

    CREATE TABLE temp as(SELECT * FROM NEW.A);

but i just get an error.

does anyone know how to do it?

thanx.
matt
",sql,sql-server,table,sql-server-triggers,,,open,0,172,8,"copying the old table - trigger in sql\plpgsql i have a trigger for a certain table in my database, 

    CREATE TRIGGER trig_trig
    AFTER DELETE OR UPDATE OR INSERT ON A 
    FOR EACH ROW
    EXECUTE PROCEDURE trig_func();

anyway.. i want to create a copy of the old table, and then run some tests on the difference between the 2.

to copy a table is easy , simply i do :

    CREATE OR REPLACE FUNCTION trig_func() RETURNS TRIGGER AS $$
    BEGIN

    CREATE TABLE temp as(SELECT * FROM A);
    DROP TABLE temp;
    return new;	
    END;
    $$ LANGUAGE plpgsql;

but i want to get the version before and after the change. this will simply give me one of them
i tried:

    CREATE TABLE temp as(SELECT * FROM OLD.A); 

or

    CREATE TABLE temp as(SELECT * FROM NEW.A);

but i just get an error.

does anyone know how to do it?

thanx.
matt
",4
2847849,05/17/2010 09:20:21,6691,09/15/2008 12:29:38,431,27,sql: aggregate functions & string join / concatenation,"(I'm using postgres)

Are there any aggregate functions that work on strings?

I want to write a query along the lines of 

    select table1.name, join(' - ', unique(table2.horse)) as all_horses
    from table1 inner join table2 on table1.id = table2.fk
    group by table1.name


Given these 2 tables:

    | table1          |               | table2                    |
    | id (pk) | name  |               | id (pk) | horse   |  fk   |
    +---------+-------+               +---------+---------+-------+ 
    |       1 | john  |               |       1 | redrum  |     1 |
    |       2 | frank |               |       2 | chaser  |     1 |
                                      |       3 | cigar   |     2 |

The query should return:

    | name   |   all_horses      |
    +--------+-------------------+
    | john   |   redrum - chaser |
    | frank  |   cigar           |

Do functions that along the lines of `join` and `unique` exist in any DBs for strings?
   ",sql,aggregate,postgresql,string,,,open,0,387,8,"sql: aggregate functions & string join / concatenation (I'm using postgres)

Are there any aggregate functions that work on strings?

I want to write a query along the lines of 

    select table1.name, join(' - ', unique(table2.horse)) as all_horses
    from table1 inner join table2 on table1.id = table2.fk
    group by table1.name


Given these 2 tables:

    | table1          |               | table2                    |
    | id (pk) | name  |               | id (pk) | horse   |  fk   |
    +---------+-------+               +---------+---------+-------+ 
    |       1 | john  |               |       1 | redrum  |     1 |
    |       2 | frank |               |       2 | chaser  |     1 |
                                      |       3 | cigar   |     2 |

The query should return:

    | name   |   all_horses      |
    +--------+-------------------+
    | john   |   redrum - chaser |
    | frank  |   cigar           |

Do functions that along the lines of `join` and `unique` exist in any DBs for strings?
   ",4
745672,04/13/2009 22:47:26,73332,03/03/2009 18:01:10,3,2,Trigger based history,"What i am trying to do is find out which fields were updated and record the change to a different table.

DECLARE 
		@BillNo int,
		@column_name varchar(500)  

	SELECT @BillNo = BillNo FROM INSERTED
	DECLARE HistoryMonitorLoop CURSOR FOR
		SELECT	
			column_name 
		FROM 
			information_schema.columns
		WHERE 
			table_name = 'Shipment';
	OPEN HistoryMonitorLoop
	FETCH next FROM HistoryMonitorLoop INTO @column_name
	WHILE @@Fetch_status = 0
	BEGIN
		DECLARE
			@OldValue varchar(500),
			@NewValue varchar(500)
		SET @OldValue = (SELECT @column_name FROM Deleted);
		SET @NewValue = (SELECT @column_name FROM Inserted);
		IF(@OldValue != @NewValue)
		BEGIN
			DECLARE @Comment varchar(5000)
			SELECT @Comment = @column_name + ' Changed from ' + @OldValue + ' to ' + @NewValue
			EXEC ShipmentNote_Insert @BillNo=@BillNo,@CoordinatorID=1,@Comment=@Comment
		END
		FETCH next FROM HistoryMonitorLoop INTO @column_name
	END
	CLOSE HistoryMonitorLoop
	DEALLOCATE HistoryMonitorLoop",sql,triggers,update,,,,open,0,91,3,"Trigger based history What i am trying to do is find out which fields were updated and record the change to a different table.

DECLARE 
		@BillNo int,
		@column_name varchar(500)  

	SELECT @BillNo = BillNo FROM INSERTED
	DECLARE HistoryMonitorLoop CURSOR FOR
		SELECT	
			column_name 
		FROM 
			information_schema.columns
		WHERE 
			table_name = 'Shipment';
	OPEN HistoryMonitorLoop
	FETCH next FROM HistoryMonitorLoop INTO @column_name
	WHILE @@Fetch_status = 0
	BEGIN
		DECLARE
			@OldValue varchar(500),
			@NewValue varchar(500)
		SET @OldValue = (SELECT @column_name FROM Deleted);
		SET @NewValue = (SELECT @column_name FROM Inserted);
		IF(@OldValue != @NewValue)
		BEGIN
			DECLARE @Comment varchar(5000)
			SELECT @Comment = @column_name + ' Changed from ' + @OldValue + ' to ' + @NewValue
			EXEC ShipmentNote_Insert @BillNo=@BillNo,@CoordinatorID=1,@Comment=@Comment
		END
		FETCH next FROM HistoryMonitorLoop INTO @column_name
	END
	CLOSE HistoryMonitorLoop
	DEALLOCATE HistoryMonitorLoop",3
11650850,07/25/2012 13:29:46,1533628,07/18/2012 04:54:55,18,0,sql query phpmyadmin,"Database phplogin > users 

id                   int 11
username         varchar25
password         varchar25

Whats the code to add 2 users 1 named Admin and pass: 123 other named: acc2 pass: pass2",sql,phpmyadmin,,,,07/26/2012 01:14:52,too localized,1,60,3,"sql query phpmyadmin Database phplogin > users 

id                   int 11
username         varchar25
password         varchar25

Whats the code to add 2 users 1 named Admin and pass: 123 other named: acc2 pass: pass2",2
9741584,03/16/2012 17:10:35,1211465,02/15/2012 13:46:07,19,0,displaying reporting weeks,"I dont know how to loop through so that the query displays all the weeks from the reporting date?

The code determines the Mon - Sun week then should insert the values in a temp table to then query the weeks. I have hard coded the report_date and its hould display more than one record.

any ideas

    DECLARE @REPORT_DATE DATETIME, @WEEK_BEGINING VARCHAR(10)
    SELECT @REPORT_DATE = '2011-01-01T00:00:00'
    --SELECT @REPORT_DATE = GETDATE() -- should grab the date now.
    SELECT @WEEK_BEGINING = 'MONDAY'
    IF @WEEK_BEGINING = 'MONDAY'
    SET DATEFIRST 1
    ELSE IF @WEEK_BEGINING = 'TUESDAY'
    SET DATEFIRST 2
    ELSE IF @WEEK_BEGINING = 'WEDNESDAY'
    SET DATEFIRST 3
    ELSE IF @WEEK_BEGINING = 'THURSDAY'
    SET DATEFIRST 4
    ELSE IF @WEEK_BEGINING = 'FRIDAY'
    SET DATEFIRST 5
    ELSE IF @WEEK_BEGINING = 'SATURDAY'
    SET DATEFIRST 6
    ELSE IF @WEEK_BEGINING = 'SUNDAY'
    SET DATEFIRST 7
    DECLARE @WEEK_START_DATE DATETIME, @WEEK_END_DATE DATETIME
    --GET THE WEEK START DATE
    SELECT @WEEK_START_DATE = @REPORT_DATE - (DATEPART(DW, @REPORT_DATE) - 1)
    --GET THE WEEK END DATE
    SELECT @WEEK_END_DATE = @REPORT_DATE + (7 - DATEPART(DW, @REPORT_DATE))
    PRINT 'Week Start: ' + CONVERT(VARCHAR, @WEEK_START_DATE)
    PRINT 'Week End: ' + CONVERT(VARCHAR, @WEEK_END_DATE)
    
    CREATE TABLE #WeekList
    	(
    	month_date date
    	)
    
    
    DECLARE @Interval int = 1
    
    INSERT INTO #WeekList SELECT @WEEK_START_DATE
    	
    WHILE @Interval < 1
    	BEGIN
    	INSERT INTO #WeekList SELECT DATEADD(MONTH, - @Interval, @WEEK_START_DATE)
    	SET @Interval = @Interval + 1
    	END
    
    SELECT  
    --Create the month ID code:		
    
    @WEEK_START_DATE AS Start_Week, @WEEK_END_DATE AS End_Week
    
    
    FROM #WeekList
    ORDER BY Start_Week DESC
    
    DROP TABLE #WeekList",sql,sql-server,sql-server-2008,tsql,reporting,,open,0,406,3,"displaying reporting weeks I dont know how to loop through so that the query displays all the weeks from the reporting date?

The code determines the Mon - Sun week then should insert the values in a temp table to then query the weeks. I have hard coded the report_date and its hould display more than one record.

any ideas

    DECLARE @REPORT_DATE DATETIME, @WEEK_BEGINING VARCHAR(10)
    SELECT @REPORT_DATE = '2011-01-01T00:00:00'
    --SELECT @REPORT_DATE = GETDATE() -- should grab the date now.
    SELECT @WEEK_BEGINING = 'MONDAY'
    IF @WEEK_BEGINING = 'MONDAY'
    SET DATEFIRST 1
    ELSE IF @WEEK_BEGINING = 'TUESDAY'
    SET DATEFIRST 2
    ELSE IF @WEEK_BEGINING = 'WEDNESDAY'
    SET DATEFIRST 3
    ELSE IF @WEEK_BEGINING = 'THURSDAY'
    SET DATEFIRST 4
    ELSE IF @WEEK_BEGINING = 'FRIDAY'
    SET DATEFIRST 5
    ELSE IF @WEEK_BEGINING = 'SATURDAY'
    SET DATEFIRST 6
    ELSE IF @WEEK_BEGINING = 'SUNDAY'
    SET DATEFIRST 7
    DECLARE @WEEK_START_DATE DATETIME, @WEEK_END_DATE DATETIME
    --GET THE WEEK START DATE
    SELECT @WEEK_START_DATE = @REPORT_DATE - (DATEPART(DW, @REPORT_DATE) - 1)
    --GET THE WEEK END DATE
    SELECT @WEEK_END_DATE = @REPORT_DATE + (7 - DATEPART(DW, @REPORT_DATE))
    PRINT 'Week Start: ' + CONVERT(VARCHAR, @WEEK_START_DATE)
    PRINT 'Week End: ' + CONVERT(VARCHAR, @WEEK_END_DATE)
    
    CREATE TABLE #WeekList
    	(
    	month_date date
    	)
    
    
    DECLARE @Interval int = 1
    
    INSERT INTO #WeekList SELECT @WEEK_START_DATE
    	
    WHILE @Interval < 1
    	BEGIN
    	INSERT INTO #WeekList SELECT DATEADD(MONTH, - @Interval, @WEEK_START_DATE)
    	SET @Interval = @Interval + 1
    	END
    
    SELECT  
    --Create the month ID code:		
    
    @WEEK_START_DATE AS Start_Week, @WEEK_END_DATE AS End_Week
    
    
    FROM #WeekList
    ORDER BY Start_Week DESC
    
    DROP TABLE #WeekList",5
4637702,01/09/2011 04:34:18,568546,01/09/2011 04:19:27,1,0,what is the best design for this data base table,"i have a website which development using .net 4, MVC  Linq To SQL.

my question is to find a best solution to make the DB Normialzie with large amount of data expected.

My site have Table Tags (contain key word,id) & my site have 4 types of data related to this tags like(articles,resources,jobs,...).

The big question is:-
for the relation with tags what best solution for optimazaion & query speed?
1- make a table for each relation example(articlesToTags(ArticleID,TagID),jobsToTags(jobid,tagid))

2- put all in table like (tagsrelation(tagid,itemid,itemtype)).

I need your help. Please provide me with articles to help me in this design

consider that in future the site can conation new section relate to tag

Thanks",sql,asp.net-mvc,linq-to-sql,mvc,database-design,01/10/2011 01:44:40,not a real question,1,106,10,"what is the best design for this data base table i have a website which development using .net 4, MVC  Linq To SQL.

my question is to find a best solution to make the DB Normialzie with large amount of data expected.

My site have Table Tags (contain key word,id) & my site have 4 types of data related to this tags like(articles,resources,jobs,...).

The big question is:-
for the relation with tags what best solution for optimazaion & query speed?
1- make a table for each relation example(articlesToTags(ArticleID,TagID),jobsToTags(jobid,tagid))

2- put all in table like (tagsrelation(tagid,itemid,itemtype)).

I need your help. Please provide me with articles to help me in this design

consider that in future the site can conation new section relate to tag

Thanks",5
5996713,05/13/2011 19:18:58,334949,05/06/2010 23:45:32,75,9,sql like query slow if using declare parameter but fast if not,"SQL 2008:
This is slow (takes 1 1/2 minutes):
<pre>
declare @p1 varchar(50)
set @p1 = '976j%'
select * from invsearch_query where comparepnfwd like @p1
</pre>
This takes less than a second:
<pre>
select * from invsearch_query where comparepnfwd like '976j%'
</pre>

Why???",sql,sql-server-2008,query,like-operator,slowness,,open,0,32,12,"sql like query slow if using declare parameter but fast if not SQL 2008:
This is slow (takes 1 1/2 minutes):
<pre>
declare @p1 varchar(50)
set @p1 = '976j%'
select * from invsearch_query where comparepnfwd like @p1
</pre>
This takes less than a second:
<pre>
select * from invsearch_query where comparepnfwd like '976j%'
</pre>

Why???",5
9756997,03/18/2012 08:24:09,1276648,03/18/2012 07:49:23,1,0,Sql select statement with two foreign key taken from the same table,"create table A ( cityID int , cityname nvarchar(30) , primary key ( cityID))
create table b ( travelID int , fromcityID int , tocityID int , primary key (travelID) ,foreign key (fromcityID) references A (cityID),foreign key (tocityID) references A (cityID))

insert into A values(1,'amman');
insert into A values(2,'Irbid');

insert into B values(1,1,1)
insert into B values(2,1,2)
insert into B values(3,2,1)
insert into B values(4,2,2)

select travelID, a.cityname,a.cityname  from A, b where ????

the question what should i write in the select statement to view the cityname instead of its id's 
in sql 

thanks for you help",sql,,,,,03/18/2012 08:51:27,too localized,1,89,12,"Sql select statement with two foreign key taken from the same table create table A ( cityID int , cityname nvarchar(30) , primary key ( cityID))
create table b ( travelID int , fromcityID int , tocityID int , primary key (travelID) ,foreign key (fromcityID) references A (cityID),foreign key (tocityID) references A (cityID))

insert into A values(1,'amman');
insert into A values(2,'Irbid');

insert into B values(1,1,1)
insert into B values(2,1,2)
insert into B values(3,2,1)
insert into B values(4,2,2)

select travelID, a.cityname,a.cityname  from A, b where ????

the question what should i write in the select statement to view the cityname instead of its id's 
in sql 

thanks for you help",1
9000510,01/25/2012 09:42:52,1063555,11/24/2011 08:56:42,1,0,Sql 2000 to 2008,M having select queris  using  order by and column alias.We are planning to upgrade sql 2000 to 2008 . I think column alias are not supported in 2008. i have to write select quries that will work as expected in both sql 2000 and 2008.Please help me,sql,,,,,01/25/2012 18:23:15,not a real question,1,49,4,Sql 2000 to 2008 M having select queris  using  order by and column alias.We are planning to upgrade sql 2000 to 2008 . I think column alias are not supported in 2008. i have to write select quries that will work as expected in both sql 2000 and 2008.Please help me,1
2206546,02/05/2010 10:36:42,117352,06/04/2009 13:39:14,968,130,Optimize Select Query,"I am using SQL 2000, and I am running a simple select statement on a table containing about 30 million rows. The select query looks like:

    select col1, col2, col3 from Table1 where col4=@col4 and col5=@col5 and col6=@col6

The table has a clustered index in it (i.e. a primary key), but that is not being used as a where criteria. All the where criterias mentioned above have no indexed in them.

How can I optimize this query?

If I add indexes for each column in the where clause, would that make any difference?

**Edit:** This is probably one of the most common interview question :)",sql,query,optimization,discussion,,04/05/2012 15:01:53,not a real question,1,104,3,"Optimize Select Query I am using SQL 2000, and I am running a simple select statement on a table containing about 30 million rows. The select query looks like:

    select col1, col2, col3 from Table1 where col4=@col4 and col5=@col5 and col6=@col6

The table has a clustered index in it (i.e. a primary key), but that is not being used as a where criteria. All the where criterias mentioned above have no indexed in them.

How can I optimize this query?

If I add indexes for each column in the where clause, would that make any difference?

**Edit:** This is probably one of the most common interview question :)",4
2056938,01/13/2010 13:34:52,249840,01/13/2010 13:34:52,1,0,SQL isolate greatest values in a column,"I have the following output from a view:

    xfer_id  client_plt_id xfer_doc_no
    2255     80016616        KANORANJE1
    2270     80016616        ORANJECFC1
    2285     80016616        CFCFPT1
    2285     80016623        CFCFPT1
    2270     80016623        ORANCFC1
    2255     80016623        KANORANJE1
    2255     80016630        KANORANJE1
    2270     80016630        ORANCFC1
    2285     80016630        CFCFPT1

Where there is more than one client_plt_id with the same number I want to isolate the row with the highest xfer_id.

For client_plt_id = 80016616 that would be xfer_id = 2285 for example.

Any ideas on how I can do this?",sql,max,view,table,,,open,0,206,7,"SQL isolate greatest values in a column I have the following output from a view:

    xfer_id  client_plt_id xfer_doc_no
    2255     80016616        KANORANJE1
    2270     80016616        ORANJECFC1
    2285     80016616        CFCFPT1
    2285     80016623        CFCFPT1
    2270     80016623        ORANCFC1
    2255     80016623        KANORANJE1
    2255     80016630        KANORANJE1
    2270     80016630        ORANCFC1
    2285     80016630        CFCFPT1

Where there is more than one client_plt_id with the same number I want to isolate the row with the highest xfer_id.

For client_plt_id = 80016616 that would be xfer_id = 2285 for example.

Any ideas on how I can do this?",4
7690182,10/07/2011 16:33:11,971199,09/29/2011 13:10:51,1,0,Issue with the Noactivity for the dat range,"How to write a code,when there is no data it should dispaly @superproducttype (that means its a name)
I have a drop down list in my report with the name @superproducttype,its a multi select list

the issue that i had came across is that if i select a single @superproducttype in the pdf file the name of that @superproducttype is not dispalying,my requiremnet is that how to dispaly that name when there is no data 

i need a sql code for the NO ACTIVITY

can anyone please help me",sql,server,service,reporting,,10/10/2011 07:26:32,not a real question,1,86,8,"Issue with the Noactivity for the dat range How to write a code,when there is no data it should dispaly @superproducttype (that means its a name)
I have a drop down list in my report with the name @superproducttype,its a multi select list

the issue that i had came across is that if i select a single @superproducttype in the pdf file the name of that @superproducttype is not dispalying,my requiremnet is that how to dispaly that name when there is no data 

i need a sql code for the NO ACTIVITY

can anyone please help me",4
9681600,03/13/2012 09:43:45,400447,07/23/2010 16:15:44,329,11,Which is faster restoring a database or copying a database,"**Problem :** 

I have a database say **Original** in state s1 say at time t1. The data in the database gets modified because of some process say at time t2 and the database is in state s2 now. I have to compare if there are any changes introduced on all the tables because of this process.Basically compare s1 and s2(Use scripts).The database I am using is SQL Server 2008.

**Options :**

1. Create a back up of the database{I do have full back ups running every hour} when in **state s1** and use that to create another database say **COPY** . Write scripts to compare the copied database **COPY** with the database **Original** in state s2 when modified by process. 

2. Create a copy of the database **Original** into **Copy**, by detaching the database (means taking it offline), copy the mdf file, and then re-attach both the original and the copy.

**Doubt:** 

Which one is faster ? Should I create a COPY database from backUp or should I copy the mdf file and then do a re-Attach ?

Thanks.

",sql,sql-server-2008,,,,03/13/2012 13:05:59,off topic,1,175,10,"Which is faster restoring a database or copying a database **Problem :** 

I have a database say **Original** in state s1 say at time t1. The data in the database gets modified because of some process say at time t2 and the database is in state s2 now. I have to compare if there are any changes introduced on all the tables because of this process.Basically compare s1 and s2(Use scripts).The database I am using is SQL Server 2008.

**Options :**

1. Create a back up of the database{I do have full back ups running every hour} when in **state s1** and use that to create another database say **COPY** . Write scripts to compare the copied database **COPY** with the database **Original** in state s2 when modified by process. 

2. Create a copy of the database **Original** into **Copy**, by detaching the database (means taking it offline), copy the mdf file, and then re-attach both the original and the copy.

**Doubt:** 

Which one is faster ? Should I create a COPY database from backUp or should I copy the mdf file and then do a re-Attach ?

Thanks.

",2
10232503,04/19/2012 16:25:50,1016183,10/27/2011 09:20:54,410,21,SQL 2012 \ VS 2010 - SQL syntax highlighting for custom file extensions,"At work we have a variety of file extensions for our SQL code: `.PRC` for StoreProcedures, `.TAB` for table scripts etc etc.

In previous versions of SQL Server Management Studio I could set each extension to use SQL syntax  highlighting in the `Tools > Options > Text Editor > File Extension` menu.

But in 2012 the option for `""SQL Query Editor""` is gone:

![enter image description here][1]

Anyone know of a work around, I've tried some registry hacks to no avail)

  [1]: http://i.stack.imgur.com/nnP3a.png",sql,visual-studio-2010,syntax-highlighting,sql-server-2012,,,open,0,81,13,"SQL 2012 \ VS 2010 - SQL syntax highlighting for custom file extensions At work we have a variety of file extensions for our SQL code: `.PRC` for StoreProcedures, `.TAB` for table scripts etc etc.

In previous versions of SQL Server Management Studio I could set each extension to use SQL syntax  highlighting in the `Tools > Options > Text Editor > File Extension` menu.

But in 2012 the option for `""SQL Query Editor""` is gone:

![enter image description here][1]

Anyone know of a work around, I've tried some registry hacks to no avail)

  [1]: http://i.stack.imgur.com/nnP3a.png",4
1242355,08/07/2009 00:57:23,57325,01/21/2009 01:19:31,6,0,Best way to store large dataset in MSSQL Server?,"I have a dataset which contains a string key field and up to 50 keywords associated with that information. Once the data has been inserted into the database there will be very few writes (INSERTS) but mostly queries for one or more keywords.

I have read http://www.pui.ch/phred/archives/2005/06/tagsystems-performance-tests.html which is MySQL based and it seems 2NF appears to be a good method for implementing this, however I was wondering if anyone had experience with doing this with SQL Server 2008 and very large datasets.

I am likely to initially have 1 million key fields which could have up to 50 keywords each.

Would a structure of

    keyfield, keyword1, keyword2, ... , keyword50

be the best solution or two tables

    keyid
    keyfield
    | 1
    |
    | M
    keyid
    keyword



Be a better idea if my queries are mostly going to be looking for results that have one or more keywords?

Thanks in advance",sql,sql-server-2008,sql-server,data-structures,database,,open,0,169,9,"Best way to store large dataset in MSSQL Server? I have a dataset which contains a string key field and up to 50 keywords associated with that information. Once the data has been inserted into the database there will be very few writes (INSERTS) but mostly queries for one or more keywords.

I have read http://www.pui.ch/phred/archives/2005/06/tagsystems-performance-tests.html which is MySQL based and it seems 2NF appears to be a good method for implementing this, however I was wondering if anyone had experience with doing this with SQL Server 2008 and very large datasets.

I am likely to initially have 1 million key fields which could have up to 50 keywords each.

Would a structure of

    keyfield, keyword1, keyword2, ... , keyword50

be the best solution or two tables

    keyid
    keyfield
    | 1
    |
    | M
    keyid
    keyword



Be a better idea if my queries are mostly going to be looking for results that have one or more keywords?

Thanks in advance",5
3586736,08/27/2010 17:32:10,84685,03/30/2009 15:18:48,216,16,See SQL From EntityFramework with Collection-like Queries,"I do not have 'full' the version of MS SQL (SQL Express 2008) so I do not have the profiler tool. 

I want to see the SQL generated by my Entity Framework code, but all of the examples I find use the 

    var x = from u in table
            select u;

type of syntax; But most of my queries are more like ..

    var x = context.Users.Single(n => n.Name == ""Steven"");

type of syntax. What can I do to see the SQL generated, from this manner of coding? Any ideas?
",sql,entity-framework-4,,,,,open,0,106,7,"See SQL From EntityFramework with Collection-like Queries I do not have 'full' the version of MS SQL (SQL Express 2008) so I do not have the profiler tool. 

I want to see the SQL generated by my Entity Framework code, but all of the examples I find use the 

    var x = from u in table
            select u;

type of syntax; But most of my queries are more like ..

    var x = context.Users.Single(n => n.Name == ""Steven"");

type of syntax. What can I do to see the SQL generated, from this manner of coding? Any ideas?
",2
4127649,11/08/2010 20:14:39,250713,01/14/2010 13:03:16,160,8,Selection of test's last attempt from students,"I have a table with information from students and tests, every time a student takes a test a record is saved in this table, so I want to get the last attempt from the students of one test.

    | IdStudent | IdTest | Attempt|
    -------------------------------
    | 1         | 1      | 1      |
    -------------------------------
    | 2         | 1      | 1      |
    -------------------------------
    | 1         | 1      | 2      |
    -------------------------------
    | 2         | 2      | 1      |

Let's say if I select the test number 1 the records I want to get are the 2 and 3, if I select test 2 the record I want to get is 4, etc.

I hope the question is clear.
Thanks in advance for the help.
",sql,sql-server,tsql,,,,open,0,218,7,"Selection of test's last attempt from students I have a table with information from students and tests, every time a student takes a test a record is saved in this table, so I want to get the last attempt from the students of one test.

    | IdStudent | IdTest | Attempt|
    -------------------------------
    | 1         | 1      | 1      |
    -------------------------------
    | 2         | 1      | 1      |
    -------------------------------
    | 1         | 1      | 2      |
    -------------------------------
    | 2         | 2      | 1      |

Let's say if I select the test number 1 the records I want to get are the 2 and 3, if I select test 2 the record I want to get is 4, etc.

I hope the question is clear.
Thanks in advance for the help.
",3
8874016,01/15/2012 22:44:10,859762,07/23/2011 22:28:19,2388,156,What is the best practice for data conversion between applications,"I wonder if this might be a too subjective question for stackoverflow but ill give it a go anyway.


Is there a common/best practice for data migration between applications? Lets say I have Application A written in Java/J2EE and connected to a PostgreSQL database and Application B written in Ruby/Rails and connected to a MySQL database. I want to migrate my data from Application A to Application B, the table structure and thus the datamodel of A is completely different from B.

Also I have existing information in application B that I want to relate to the import of information from application A.

I tried writing a few fancy sql scripts but that goes nowhere fast. 

Is there maybe a best practice for this I wonder? I reckon this is a job done quite often by developers.  ",sql,data-migration,database-migration,,,05/10/2012 21:29:06,not constructive,1,136,10,"What is the best practice for data conversion between applications I wonder if this might be a too subjective question for stackoverflow but ill give it a go anyway.


Is there a common/best practice for data migration between applications? Lets say I have Application A written in Java/J2EE and connected to a PostgreSQL database and Application B written in Ruby/Rails and connected to a MySQL database. I want to migrate my data from Application A to Application B, the table structure and thus the datamodel of A is completely different from B.

Also I have existing information in application B that I want to relate to the import of information from application A.

I tried writing a few fancy sql scripts but that goes nowhere fast. 

Is there maybe a best practice for this I wonder? I reckon this is a job done quite often by developers.  ",3
6521997,06/29/2011 14:08:23,202241,11/04/2009 01:05:26,771,55,Join same table to multiple fields,"I have this SQL and i am trying to join a table of people's login names to a table of tasks that contains several user ids

      SELECT Task.TaskID
          ,Project.Project
          ,Task.Task
          ,Task.Description
          ,Task.OwnerLoginID //shown as Login.UserName
          ,Task.SubmitterID //shown as Login.UserName
          ,Task.IsVisible
      FROM Task
      INNER JOIN Project ON Task.ProjectID = Project.ProjectID
      /*
      INNER JOIN Login ON Task.SubmitterID = Login.LoginID
      INNER JOIN Login ON Task.OwnerLoginID = Login.LoginID
      */
      WHERE IsVisible = 1

i get an error in the commented out lines at the bottom where am i going wrong?",sql,inner-join,,,,,open,0,179,6,"Join same table to multiple fields I have this SQL and i am trying to join a table of people's login names to a table of tasks that contains several user ids

      SELECT Task.TaskID
          ,Project.Project
          ,Task.Task
          ,Task.Description
          ,Task.OwnerLoginID //shown as Login.UserName
          ,Task.SubmitterID //shown as Login.UserName
          ,Task.IsVisible
      FROM Task
      INNER JOIN Project ON Task.ProjectID = Project.ProjectID
      /*
      INNER JOIN Login ON Task.SubmitterID = Login.LoginID
      INNER JOIN Login ON Task.OwnerLoginID = Login.LoginID
      */
      WHERE IsVisible = 1

i get an error in the commented out lines at the bottom where am i going wrong?",2
7381417,09/11/2011 21:35:58,935636,09/08/2011 20:04:38,6,0,How can I import data into an SQL file from JSON?,I have a web scraper that will put all the data collected into JSON format and I want to import it into my SQL database.,sql,database,json,web-scraping,,09/11/2011 22:49:45,not a real question,1,25,11,How can I import data into an SQL file from JSON? I have a web scraper that will put all the data collected into JSON format and I want to import it into my SQL database.,4
7555008,09/26/2011 12:23:48,964380,09/26/2011 04:40:04,6,0,Connecting to One database Through Network,"i wanted to know how can i connect to a database which is in another system since me and my friends have touse the same database for the project 

we have used SQL Server Management Studio 2008 , it is not allowing me to connect to my friends system . how can i set or add user? ",sql,,,,,09/27/2011 03:39:05,not a real question,1,58,6,"Connecting to One database Through Network i wanted to know how can i connect to a database which is in another system since me and my friends have touse the same database for the project 

we have used SQL Server Management Studio 2008 , it is not allowing me to connect to my friends system . how can i set or add user? ",1
9191826,02/08/2012 10:48:42,861970,07/25/2011 16:23:38,11,2,"Combine two different select statements, one distinct the other not","I have two selects which are required to filter data.  They are not complicated:

    ""SELECT * FROM StevesTable t WHERE ""
    ""t.data1 = '%s' AND ""
    ""t.data2 = to_date('%s','DD/MM/YYYY');"",
    strdata1,
    dtDate.Format();

and 

    SELECT distinct data1 FROM anothertable ftt
    join table1 tab on tab.somedata = ftt.somedata
    where tab.somedata = 0
    and tab.someotherdata = 1

I would like to combine these two as I need to filter the returned dataset from the first select statement by the returned field in the second (ie if a record returned in the first set does not have a data1 value which is contained in the second returned set it is invalid).

I tried to union and intersect the selects but you need the same number of columns returned and that cannot happen as these are completely different tables.  When I tried to simply merge them together I found it difficult as the second select statement is a distinct select whereas the first is not.

I was wondering whether I had missed a trick somewhere for combining these sorts of selects?",sql,plsql,,,,,open,0,201,10,"Combine two different select statements, one distinct the other not I have two selects which are required to filter data.  They are not complicated:

    ""SELECT * FROM StevesTable t WHERE ""
    ""t.data1 = '%s' AND ""
    ""t.data2 = to_date('%s','DD/MM/YYYY');"",
    strdata1,
    dtDate.Format();

and 

    SELECT distinct data1 FROM anothertable ftt
    join table1 tab on tab.somedata = ftt.somedata
    where tab.somedata = 0
    and tab.someotherdata = 1

I would like to combine these two as I need to filter the returned dataset from the first select statement by the returned field in the second (ie if a record returned in the first set does not have a data1 value which is contained in the second returned set it is invalid).

I tried to union and intersect the selects but you need the same number of columns returned and that cannot happen as these are completely different tables.  When I tried to simply merge them together I found it difficult as the second select statement is a distinct select whereas the first is not.

I was wondering whether I had missed a trick somewhere for combining these sorts of selects?",2
