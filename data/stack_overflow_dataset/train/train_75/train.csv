PostId,PostCreationDate,OwnerUserId,OwnerCreationDate,ReputationAtPostCreation,OwnerUndeletedAnswerCountAtPostTime,Title,BodyMarkdown,Tag1,Tag2,Tag3,Tag4,Tag5,PostClosedDate,OpenStatus,OpenStatusInt,BodyLength,TitleLength,TitleConcatWithBody,NumberOfTags
8778083,01/08/2012 13:51:02,977497,10/03/2011 22:00:19,102,0,OptimisticLockException - Sql Server,"I am trying update a record in the database. 
It is raising OptimisticLockException. In my database I have four date fields (dZadOpenDateTime, dZadCloseDateTime,dCreatedDateTime,dChangedDateTime) show in this picture http://imageshack.us/photo/my-images/854/exception.jpg/ 

Can you give me some hint to solve this. 
",sql-server-2008,c#-4.0,optimistic-locking,,,,open,0,38,4,"OptimisticLockException - Sql Server I am trying update a record in the database. 
It is raising OptimisticLockException. In my database I have four date fields (dZadOpenDateTime, dZadCloseDateTime,dCreatedDateTime,dChangedDateTime) show in this picture http://imageshack.us/photo/my-images/854/exception.jpg/ 

Can you give me some hint to solve this. 
",3
11043981,06/15/2012 02:41:26,1457662,06/15/2012 02:33:56,1,0,Is there a function like isdate() for the data type datetime2 in sql server 2008?,"I know there is a function called isdate() to validate datetime columns, but it works only for the smalldatetime and datetime types.
The question is: is there a similar way to validate the new data type datetime2 in sql server 2008 and 2012?",sql-server-2008,tsql,sql-server-2012,datetime2,,,open,0,42,15,"Is there a function like isdate() for the data type datetime2 in sql server 2008? I know there is a function called isdate() to validate datetime columns, but it works only for the smalldatetime and datetime types.
The question is: is there a similar way to validate the new data type datetime2 in sql server 2008 and 2012?",4
6361748,06/15/2011 17:29:03,665094,03/17/2011 21:00:23,48,2,Sql Server 2008 Reporting Services: Using two dataset error,"Im building a report that's using two datasets. when I preview I find these types of errors...

 Error	19	[rsFieldReferenceAmbiguous] The Value expression for the text box ‘Textbox3’ refers directly to the field ‘PerZipCode’ without specifying a dataset aggregate.  When the report contains multiple datasets, field references outside of a data region must be contained within aggregate functions which specify a dataset scope.

What aggregate function is needed and where is there an option to set this?",sql-server-2008,aggregate-functions,reportingservices-2008,,,,open,0,75,9,"Sql Server 2008 Reporting Services: Using two dataset error Im building a report that's using two datasets. when I preview I find these types of errors...

 Error	19	[rsFieldReferenceAmbiguous] The Value expression for the text box ‘Textbox3’ refers directly to the field ‘PerZipCode’ without specifying a dataset aggregate.  When the report contains multiple datasets, field references outside of a data region must be contained within aggregate functions which specify a dataset scope.

What aggregate function is needed and where is there an option to set this?",3
7930133,10/28/2011 13:49:57,1018325,10/28/2011 12:41:56,1,0,Query to add next row's same column,"I need a query that can sum like this (previous row with current row)

    1  1
    2  3
    3  5
    4  7
    5  9

I want row1.MoneyPaid + row2.MoneyPaid, row2.MoneyPaid + row3.MoneyPaid,row3.MoneyPaid + row4.MoneyPaid",sql-server-2008,,,,,,open,0,53,7,"Query to add next row's same column I need a query that can sum like this (previous row with current row)

    1  1
    2  3
    3  5
    4  7
    5  9

I want row1.MoneyPaid + row2.MoneyPaid, row2.MoneyPaid + row3.MoneyPaid,row3.MoneyPaid + row4.MoneyPaid",1
583851,02/24/2009 22:12:59,28029,10/14/2008 21:16:22,32,9,Building a SSRS 2008 off an EDM,"Can someone please outline the process of building a SQL Server Reporting Services 2008 report based on a ADO.Net Entity Framework Entity Data Model?
If you know of any example, please point me to it.
Thank you!
",sql-server-2008,reporting-services,reporting,entity-framework,ado.net-entity-data-model,,open,0,35,7,"Building a SSRS 2008 off an EDM Can someone please outline the process of building a SQL Server Reporting Services 2008 report based on a ADO.Net Entity Framework Entity Data Model?
If you know of any example, please point me to it.
Thank you!
",5
2108154,01/21/2010 09:38:59,94334,04/22/2009 12:59:11,163,14,SQL Server connection string question,"I'm trying to connect to a named SQL instance on the server.
There is already default instance of SQL Server 2005 and a newly named one - SQL Server 2008. I'm using the ""Network library"" property to use TCP connection but for some reason, he try's to connect the default instance and omit an error about login error.

If I remove the network library propery the connection established as well without any error.

I'm using windows authntication and have all the permissions needed.

The problematic connection string:

***Data Source=ServerName\InstanceName,1433;network library=dbmssocn;Initial Catalog=MyDataBaseName;Integrated security=SSPI***

The working connection string:


***Data Source=ServerName\InstanceName;Initial Catalog=MyDataBaseName;Integrated security=SSPI***

I would like to understand why, please.
Thanks in advance,

Tamir",sql-server-2008,connection-string,network-library,,,01/21/2010 12:21:46,off topic,1,101,5,"SQL Server connection string question I'm trying to connect to a named SQL instance on the server.
There is already default instance of SQL Server 2005 and a newly named one - SQL Server 2008. I'm using the ""Network library"" property to use TCP connection but for some reason, he try's to connect the default instance and omit an error about login error.

If I remove the network library propery the connection established as well without any error.

I'm using windows authntication and have all the permissions needed.

The problematic connection string:

***Data Source=ServerName\InstanceName,1433;network library=dbmssocn;Initial Catalog=MyDataBaseName;Integrated security=SSPI***

The working connection string:


***Data Source=ServerName\InstanceName;Initial Catalog=MyDataBaseName;Integrated security=SSPI***

I would like to understand why, please.
Thanks in advance,

Tamir",3
9650069,03/10/2012 20:49:09,1261518,03/10/2012 20:40:23,1,0,Not getting Record Between two dates,"I want to get records from in between 2 dates
Here is the Query:

select 
	 distinct Convert(varchar(09), [DateTime], 103)

from 
	StudentAttendance_FK 

where 
	LecturerID = 5033 and 

	CourseID = 1004 and 

	SubjectID = 120 and 

	[DateTime] Between '3/8/2012' and '3/11/2012'

It not give any record in between these two dates.Any changes in this query?

thanks you

Ajay.",sql-server-2008,,,,,,open,0,51,6,"Not getting Record Between two dates I want to get records from in between 2 dates
Here is the Query:

select 
	 distinct Convert(varchar(09), [DateTime], 103)

from 
	StudentAttendance_FK 

where 
	LecturerID = 5033 and 

	CourseID = 1004 and 

	SubjectID = 120 and 

	[DateTime] Between '3/8/2012' and '3/11/2012'

It not give any record in between these two dates.Any changes in this query?

thanks you

Ajay.",1
3419287,08/05/2010 21:25:38,16241,09/17/2008 15:38:49,3242,104,Differences Between SQL Server 2008 and SQL Server 2008 R2 from a developer's POV,"I am setting up my development machine and I am wondering if I should install SQL Server 2008 R2 (for Developers) or SQL Server 2008 (for Developers) on my machine.

All of the databases that I work with are on SQL Server 2008 (not the R2).  So I am torn.  Should install what I am currently using?  or should I be a bit forward looking and use the R2 version?

Will the client tools from the R2 install connect ok to the non R2 servers?

I guess in general what I want to know is what are the differences between R2 and non-R2 from a developer's point of view? (I don't really care about back end stuff too much.)
",sql-server-2008,sql-server-2008-r2,,,,,open,0,119,14,"Differences Between SQL Server 2008 and SQL Server 2008 R2 from a developer's POV I am setting up my development machine and I am wondering if I should install SQL Server 2008 R2 (for Developers) or SQL Server 2008 (for Developers) on my machine.

All of the databases that I work with are on SQL Server 2008 (not the R2).  So I am torn.  Should install what I am currently using?  or should I be a bit forward looking and use the R2 version?

Will the client tools from the R2 install connect ok to the non R2 servers?

I guess in general what I want to know is what are the differences between R2 and non-R2 from a developer's point of view? (I don't really care about back end stuff too much.)
",2
9276613,02/14/2012 12:09:25,1138669,01/09/2012 12:37:19,6,0,Alternative for percentile_cont in sql server 2008,"> In Oracle it works well ......

>Query for oracle is As Follows

Select distinct channel_id, position_id,datamonth, percentile_cont(.9) within group (order by TRIM_PRE_ELIG_PAY) over (partition by channel_id, position_id, datamonth) as TRIM_PRE_ELIG_PAY_90th_PERC from Tablename

>But for SQL Server,getting error 

>Query for SQL server 2008
Select
distinct channel_id, position_id,datamonth, percentile_cont(.9) within group (order by TRIM_PRE_ELIG_PAY) over (partition by channel_id) as TRIM_PRE_ELIG_PAY_90th_PERC from table

**ERROR:Select could not be parsed correctly.Output could not be generated.

I got to know that it can work properly in sql server 2012 but need an alternative way in SQL Server 2008

Can anybody help...........",sql-server-2008,analytic-functions,,,,,open,0,88,7,"Alternative for percentile_cont in sql server 2008 > In Oracle it works well ......

>Query for oracle is As Follows

Select distinct channel_id, position_id,datamonth, percentile_cont(.9) within group (order by TRIM_PRE_ELIG_PAY) over (partition by channel_id, position_id, datamonth) as TRIM_PRE_ELIG_PAY_90th_PERC from Tablename

>But for SQL Server,getting error 

>Query for SQL server 2008
Select
distinct channel_id, position_id,datamonth, percentile_cont(.9) within group (order by TRIM_PRE_ELIG_PAY) over (partition by channel_id) as TRIM_PRE_ELIG_PAY_90th_PERC from table

**ERROR:Select could not be parsed correctly.Output could not be generated.

I got to know that it can work properly in sql server 2012 but need an alternative way in SQL Server 2008

Can anybody help...........",2
9438354,02/24/2012 21:32:15,747750,05/10/2011 23:00:00,78,0,SSRS:How to create report loke pivot table in ssrs 2008 r2,"I need to create  reoprt in ssrs like the pivot table in MS Excel.![enter image description here][1]


  [1]: http://i.stack.imgur.com/RqUKx.png

Above the screen shot of my requirement,I am very much confused this time .
Please provide some guidlines ,resources and links where i find the needfull help.",sql-server-2008,reporting-services,,,,02/26/2012 06:10:18,not a real question,1,46,11,"SSRS:How to create report loke pivot table in ssrs 2008 r2 I need to create  reoprt in ssrs like the pivot table in MS Excel.![enter image description here][1]


  [1]: http://i.stack.imgur.com/RqUKx.png

Above the screen shot of my requirement,I am very much confused this time .
Please provide some guidlines ,resources and links where i find the needfull help.",2
11383145,07/08/2012 12:27:25,1346705,04/20/2012 13:38:16,636,63,SQL2008 Service Broker tutorial -- cannot receive the message (exception in transmission_status),"I am learning how to use the Service Broker of the MS SQL 2008 R2.  When following the tutorial [Completing a Conversation in a Single Database][1].  Following the [Lesson 1][2], I have successfully created the message types, contract, the queues and services.  Following the [Lesson 2][3], I have probably sent the message.  However, when trying to receive the message, I get the NULL for the ReceivedRequestMsg instead of the sent content.

When looking at the `sys.transmission_queue`, the `transmission_status` for the message says:

> An exception occurred while enqueueing a message in the target queue. Error: 15517, State: 1. Cannot execute as the database principal because the principal ""dbo"" does not exist, this type of principal cannot be impersonated, or you do not have permission.

I have installed the SQL server using the Windows login like **Mycomp\Petr**.  I am using that login also for the lessons.

Can you guess what is the problem?  What should I check and or set to make it working?


  [1]: http://msdn.microsoft.com/en-us/library/bb839495%28v=sql.105%29
  [2]: http://msdn.microsoft.com/en-us/library/bb839488%28v=sql.105%29
  [3]: http://msdn.microsoft.com/en-us/library/bb839499%28v=sql.105%29",sql-server-2008,service-broker,,,,,open,0,174,12,"SQL2008 Service Broker tutorial -- cannot receive the message (exception in transmission_status) I am learning how to use the Service Broker of the MS SQL 2008 R2.  When following the tutorial [Completing a Conversation in a Single Database][1].  Following the [Lesson 1][2], I have successfully created the message types, contract, the queues and services.  Following the [Lesson 2][3], I have probably sent the message.  However, when trying to receive the message, I get the NULL for the ReceivedRequestMsg instead of the sent content.

When looking at the `sys.transmission_queue`, the `transmission_status` for the message says:

> An exception occurred while enqueueing a message in the target queue. Error: 15517, State: 1. Cannot execute as the database principal because the principal ""dbo"" does not exist, this type of principal cannot be impersonated, or you do not have permission.

I have installed the SQL server using the Windows login like **Mycomp\Petr**.  I am using that login also for the lessons.

Can you guess what is the problem?  What should I check and or set to make it working?


  [1]: http://msdn.microsoft.com/en-us/library/bb839495%28v=sql.105%29
  [2]: http://msdn.microsoft.com/en-us/library/bb839488%28v=sql.105%29
  [3]: http://msdn.microsoft.com/en-us/library/bb839499%28v=sql.105%29",2
5791710,04/26/2011 14:18:36,725505,04/26/2011 13:57:18,1,0,Import .txt file to SQL Server 2008.,"I want to import the text file to SQL Server 2008.
Obviously, the text file is like,

AA89ATOZ                MR        1  PMANUAL   >0    1    0    0    0    0    0    0    0    0    0    0    1.

The record has thousand records like this.
When I load the text file using excel, it will be set all texts in one row.
I have read some related answer, which is 

AA89ATOZ,MR,1,PMANUAL,>0,1,0,0,0,0,0,0,0,0,0,0,1.

If I can do make like above, how can I change it?
Does it have any function to split text on row?
Please let me know the answer.
Thanks.",sql-server-2008,,,,,,open,0,148,7,"Import .txt file to SQL Server 2008. I want to import the text file to SQL Server 2008.
Obviously, the text file is like,

AA89ATOZ                MR        1  PMANUAL   >0    1    0    0    0    0    0    0    0    0    0    0    1.

The record has thousand records like this.
When I load the text file using excel, it will be set all texts in one row.
I have read some related answer, which is 

AA89ATOZ,MR,1,PMANUAL,>0,1,0,0,0,0,0,0,0,0,0,0,1.

If I can do make like above, how can I change it?
Does it have any function to split text on row?
Please let me know the answer.
Thanks.",1
2556588,03/31/2010 21:25:53,231677,12/14/2009 22:18:58,130,171,Please help me with database connection types in Windows.,"Sorry for a badly-phrased question. I have a requirement coming from a non-technical person that I need to make sense of. I am basically told: ""Here use `'Driver={SQL Server};Server=SERVERNAME\INSTANCENAME;Database=DATABASENAME;Uid=UNAME;Pwd=PASSWORD;';` and here use `Server=SERVERNAME\INSTANCENAME;Database=DATABASENAME;Uid=UNAME;Pwd=PASSWORD;';`.

I am getting no additional help here.

While this seems to miraculously fix a bug, I want to understand what is it that I am changing, so I can leave a proper comment for the next developer, plus I can structure the code and name variables differently, depending on the meaning of the change.

The work revolves around ASP.net, reporting, SQL Server 2008.

Please give me some examples about when you would use one connection string over another. Feel free to edit the question if you can see a way to improve it.

When can you lose a `'Driver={SQL Server};`?

Thank you.

***EDIT:*** SQL Server 2008 is the target database, but other can be used ... or maybe will be used in the future.
",sql-server-2008,connection-string,,,,,open,0,150,9,"Please help me with database connection types in Windows. Sorry for a badly-phrased question. I have a requirement coming from a non-technical person that I need to make sense of. I am basically told: ""Here use `'Driver={SQL Server};Server=SERVERNAME\INSTANCENAME;Database=DATABASENAME;Uid=UNAME;Pwd=PASSWORD;';` and here use `Server=SERVERNAME\INSTANCENAME;Database=DATABASENAME;Uid=UNAME;Pwd=PASSWORD;';`.

I am getting no additional help here.

While this seems to miraculously fix a bug, I want to understand what is it that I am changing, so I can leave a proper comment for the next developer, plus I can structure the code and name variables differently, depending on the meaning of the change.

The work revolves around ASP.net, reporting, SQL Server 2008.

Please give me some examples about when you would use one connection string over another. Feel free to edit the question if you can see a way to improve it.

When can you lose a `'Driver={SQL Server};`?

Thank you.

***EDIT:*** SQL Server 2008 is the target database, but other can be used ... or maybe will be used in the future.
",2
11750012,07/31/2012 22:34:12,321605,04/20/2010 18:40:06,187,3,microsoft sql server 2008: copy database fails while trying to copy login,"I'm trying to copy a database from a server that lives in a unique domain, call it AMCO.

The destination server, which is on domain BCO, is running sql server agent, and as far as I can tell everything is set up properly there.


When I use the copy database feature of management studio, I can set everything up just fine. During the actual job execution however, this appears in the log:

    Started:  5:27:19 PM  Progress: 2012-07-31 17:27:20.04     Source: 
192_168_50_11_SQLSERVER2008_localhost_SQLSERVER2008_Transfer Objects Task      Task just started the execution.: 0% complete  End Progress  Error: 2012-07-31 17:27:27.34     Code: 0x00000000     Source: 192_168_50_11_SQLSERVER2008_localhost_SQLSERVER2008_Transfer Objects Task      Description: ERROR : errorCode=-1073548784 description=Executing the query ""CREATE LOGIN [AMCO\AMCOAdmin] FROM WINDOWS WITH DEFA..."" failed with the following error: ""Windows NT user or group 'AMCO\AMCOAdmin' not found. Check the name again."". Possible failure reasons: Problems with the query, ""ResultSet"" property not set correctly, parameters not set correctly, or connection not established correctly.   helpFile= helpContext=0 idofInterfaceWithError={C81DFC5A-3B22-4DA3-BD3B-10BF861A7F9C}




Why does this user need to be copied first? I am removing the option of ""copy logins"" from the additional data to copy, and yet this error still comes up.



",sql-server-2008,sql-management-studio,,,,08/01/2012 00:57:48,off topic,1,213,12,"microsoft sql server 2008: copy database fails while trying to copy login I'm trying to copy a database from a server that lives in a unique domain, call it AMCO.

The destination server, which is on domain BCO, is running sql server agent, and as far as I can tell everything is set up properly there.


When I use the copy database feature of management studio, I can set everything up just fine. During the actual job execution however, this appears in the log:

    Started:  5:27:19 PM  Progress: 2012-07-31 17:27:20.04     Source: 
192_168_50_11_SQLSERVER2008_localhost_SQLSERVER2008_Transfer Objects Task      Task just started the execution.: 0% complete  End Progress  Error: 2012-07-31 17:27:27.34     Code: 0x00000000     Source: 192_168_50_11_SQLSERVER2008_localhost_SQLSERVER2008_Transfer Objects Task      Description: ERROR : errorCode=-1073548784 description=Executing the query ""CREATE LOGIN [AMCO\AMCOAdmin] FROM WINDOWS WITH DEFA..."" failed with the following error: ""Windows NT user or group 'AMCO\AMCOAdmin' not found. Check the name again."". Possible failure reasons: Problems with the query, ""ResultSet"" property not set correctly, parameters not set correctly, or connection not established correctly.   helpFile= helpContext=0 idofInterfaceWithError={C81DFC5A-3B22-4DA3-BD3B-10BF861A7F9C}




Why does this user need to be copied first? I am removing the option of ""copy logins"" from the additional data to copy, and yet this error still comes up.



",2
6249889,06/06/2011 09:18:19,669448,03/21/2011 12:49:27,146,7,Calculating Subtotals from SQL Query,"I have a query which returns some rows. Its column names are like: Age, Gender, DOB etc.
What I have to do is, to check how many rows are coming from DB of which Age.

e.g. See the image:

![enter image description here][1]


  [1]: http://i.stack.imgur.com/gV9c6.png

See the age subtotal, it means my query is returning 54 rows of age 0, 1 row of age 1 and so on.

This table of subtotal must display only those ages that are returned by the query. For example there is no Age 2 as it was not returned by query.

How can I sort this issue, if anyone has idea please share. Any help would be highly appreciated.

Thanks in advance.",sql-server-2008,query,subtotal,,,,open,0,112,5,"Calculating Subtotals from SQL Query I have a query which returns some rows. Its column names are like: Age, Gender, DOB etc.
What I have to do is, to check how many rows are coming from DB of which Age.

e.g. See the image:

![enter image description here][1]


  [1]: http://i.stack.imgur.com/gV9c6.png

See the age subtotal, it means my query is returning 54 rows of age 0, 1 row of age 1 and so on.

This table of subtotal must display only those ages that are returned by the query. For example there is no Age 2 as it was not returned by query.

How can I sort this issue, if anyone has idea please share. Any help would be highly appreciated.

Thanks in advance.",3
7089315,08/17/2011 07:38:09,838313,07/11/2011 06:17:10,83,2,How can i perform below task?,"1)       Write a script for the following case.

Sample Input Table

    Id       Data
     
    1         A
     
    1         A
     
    1         A
     
    1         A
     
    2         B
     
    2          B
     
    3          C
     
    3          C
     
    3          C

 

 

 

 

 

 

    Estimated Output
    
    Id        Data
     
    1          A1
     
    1          A2
     
    1          A3
     
    1          A4
     
    2          B1
     
    2          B2
     
    3          C1
     
    3          C2
     
    3          C3

 

 Could any one help me solving the above.?
",sql-server-2008,,,,,08/17/2011 08:37:14,not a real question,1,400,6,"How can i perform below task? 1)       Write a script for the following case.

Sample Input Table

    Id       Data
     
    1         A
     
    1         A
     
    1         A
     
    1         A
     
    2         B
     
    2          B
     
    3          C
     
    3          C
     
    3          C

 

 

 

 

 

 

    Estimated Output
    
    Id        Data
     
    1          A1
     
    1          A2
     
    1          A3
     
    1          A4
     
    2          B1
     
    2          B2
     
    3          C1
     
    3          C2
     
    3          C3

 

 Could any one help me solving the above.?
",1
9788194,03/20/2012 13:54:20,857420,07/22/2011 06:52:10,6,0,SSRS 2008 Break the column in different pages,"I am creating a SSRS 2008 Report
       in my report i have 200 columns, it is difficult for visualizing purpose,
     is there any way in SSRS by which i can show 20 column per page with row hearer in each page.

ex..
       1  2  3  4  5  6  7  8  9  10  11  12  13  14 15 .....................     
 2010  5 4 8 7 6 
 2011    9 7 5 8 9 4     2  5
 2012  1 2 4 5 3 
 2013

can i break to show only 20 columns in first page & reamin 20 second page & show on with column heaer repeat in each page

Thankyou",sql-server-2008,reporting-services,ssrs-2008,ssrs-grouping,,,open,0,150,8,"SSRS 2008 Break the column in different pages I am creating a SSRS 2008 Report
       in my report i have 200 columns, it is difficult for visualizing purpose,
     is there any way in SSRS by which i can show 20 column per page with row hearer in each page.

ex..
       1  2  3  4  5  6  7  8  9  10  11  12  13  14 15 .....................     
 2010  5 4 8 7 6 
 2011    9 7 5 8 9 4     2  5
 2012  1 2 4 5 3 
 2013

can i break to show only 20 columns in first page & reamin 20 second page & show on with column heaer repeat in each page

Thankyou",4
6211695,06/02/2011 07:29:04,669448,03/21/2011 12:49:27,123,6,How to remove null rows from sql query result?,"I have a SQL query in which I am getting some records.
Query is:

        select c.Id, c.FirstName, dbo.GetClientStaffContacts(c.Id, '27,31') as Staff from Client c order by c.Id

Result is:
![enter image description here][1]


  [1]: http://i.stack.imgur.com/KyOzB.png

I want only those rows that are not having null values in column Staff.

Any help would be appreciated.
Thank you.",sql-server-2008,query,,,,,open,0,58,9,"How to remove null rows from sql query result? I have a SQL query in which I am getting some records.
Query is:

        select c.Id, c.FirstName, dbo.GetClientStaffContacts(c.Id, '27,31') as Staff from Client c order by c.Id

Result is:
![enter image description here][1]


  [1]: http://i.stack.imgur.com/KyOzB.png

I want only those rows that are not having null values in column Staff.

Any help would be appreciated.
Thank you.",2
1251799,08/09/2009 17:28:47,2424,08/22/2008 04:09:40,10951,567,How to determine what row contains a specific decimal is in a sql column,"Somewhere in the midst of thousands of records I have a decimal value in a sql column that has an odd value.

Specifically, it has a decimal place of .002.

The actual amount could be pretty much anything like 238.002 or 543.002 

So how can I write a query to find that?",sql-server-2008,,,,,,open,0,50,14,"How to determine what row contains a specific decimal is in a sql column Somewhere in the midst of thousands of records I have a decimal value in a sql column that has an odd value.

Specifically, it has a decimal place of .002.

The actual amount could be pretty much anything like 238.002 or 543.002 

So how can I write a query to find that?",1
10366512,04/28/2012 18:49:48,1188511,02/03/2012 21:50:23,8,0,APPFabric Caching or SQL server - Specific scenario,"I am having difficulties figuring out if APPFabric caching or SQL Server should be used in the context of our needs (considering the fact that we are currently using SQL server for most things).

We only need (for now) to cache small chunks of data (~16KB) each of them corresponding to the information associated to a particular request that was sent from one of the applicative server (outgoing request). 

Any of the applicative server can receive incoming request associated to the initial outgoing request, and for our needs we need to find back the original information associated with this outgoing request ... that's why we can't keep a local in memory cache in each applicative server, because we can't be sure the incoming request will arrive on the applicative server from which the outgoing request was sent.

HOWEVER we just basically need to persist the ~16kb piece of information only once (very rare possibilities of updates), and to be able to access it back from any applicative server, but to access it only one time in the vast majority of cases.
So basically most of the time it will be one write from an applicative server (caching) and later on, one read from same or another applicative server.

In this specific context, will there be any gain of going through an AppFabric cache cluster instead of directly going to the database (considering it will be a simple insert/select statement) ? 

Keeping in mind scalability, meaning that we should potentially be able to handle a big throughput (and growing) of put_data / get_data operations (> 10k /s ... and growing).

Thanks in advance for your answers.
",sql-server-2008,caching,appfabric,distributed-caching,,,open,0,270,8,"APPFabric Caching or SQL server - Specific scenario I am having difficulties figuring out if APPFabric caching or SQL Server should be used in the context of our needs (considering the fact that we are currently using SQL server for most things).

We only need (for now) to cache small chunks of data (~16KB) each of them corresponding to the information associated to a particular request that was sent from one of the applicative server (outgoing request). 

Any of the applicative server can receive incoming request associated to the initial outgoing request, and for our needs we need to find back the original information associated with this outgoing request ... that's why we can't keep a local in memory cache in each applicative server, because we can't be sure the incoming request will arrive on the applicative server from which the outgoing request was sent.

HOWEVER we just basically need to persist the ~16kb piece of information only once (very rare possibilities of updates), and to be able to access it back from any applicative server, but to access it only one time in the vast majority of cases.
So basically most of the time it will be one write from an applicative server (caching) and later on, one read from same or another applicative server.

In this specific context, will there be any gain of going through an AppFabric cache cluster instead of directly going to the database (considering it will be a simple insert/select statement) ? 

Keeping in mind scalability, meaning that we should potentially be able to handle a big throughput (and growing) of put_data / get_data operations (> 10k /s ... and growing).

Thanks in advance for your answers.
",4
6518120,06/29/2011 09:04:00,450143,09/17/2010 00:50:07,11,0,SQL Connection code,"Here's my code for a SQL connection. Not sure if I have handled all errors. Instead of Using should I just use Try Catch block?

<code>
using (SqlConnection con = new SqlConnection(GetSQLConnectionString()))
{

   string cmdStr = ""INSERT INTO table1....."";

   using (SqlCommand cmd = new SqlCommand(cmdStr, con))
   {

       //Store parameters with values to the collection
       cmd.Parameters.AddWithValue(""NAME"", NAME);
       cmd.Parameters.AddWithValue(""ID"",ID);

       try
       {
           con.Open();
           cmd.ExecuteNonQuery();

       }
       catch (Exception ex)
       {
           lblError.Text = ex.ToString();
       }

              if (con != null)
       con.Close();
    }
}
</code>",sql-server-2008,,,,,,open,0,185,3,"SQL Connection code Here's my code for a SQL connection. Not sure if I have handled all errors. Instead of Using should I just use Try Catch block?

<code>
using (SqlConnection con = new SqlConnection(GetSQLConnectionString()))
{

   string cmdStr = ""INSERT INTO table1....."";

   using (SqlCommand cmd = new SqlCommand(cmdStr, con))
   {

       //Store parameters with values to the collection
       cmd.Parameters.AddWithValue(""NAME"", NAME);
       cmd.Parameters.AddWithValue(""ID"",ID);

       try
       {
           con.Open();
           cmd.ExecuteNonQuery();

       }
       catch (Exception ex)
       {
           lblError.Text = ex.ToString();
       }

              if (con != null)
       con.Close();
    }
}
</code>",1
8477037,12/12/2011 15:56:45,147915,07/30/2009 15:48:14,1137,50,ColdBox vs CFWheels,"I am migrating a site built in Coldfusion (no framework) to a coldfusion framework. Right now it looks like a choice between ColdBox and CFWheels. 

The database is MS SQL.

I was wondering if anyone has migrated an existing site over to either of these frameworks and if they could recommend one framework over another?",sql-server-2008,coldfusion,,,,12/13/2011 18:36:12,not constructive,1,54,3,"ColdBox vs CFWheels I am migrating a site built in Coldfusion (no framework) to a coldfusion framework. Right now it looks like a choice between ColdBox and CFWheels. 

The database is MS SQL.

I was wondering if anyone has migrated an existing site over to either of these frameworks and if they could recommend one framework over another?",2
11507714,07/16/2012 15:41:33,1529366,07/16/2012 15:34:31,1,0,Identify views accessed more often than others in SQL Server 2008 R2,"There are some duplicate views in our SQL server database and we need to identify views accessed more often than others so we can retire the other duplicate views that are not accessed as often.

Thanks again for all your help in advance. ",sql-server-2008,,,,,07/19/2012 03:02:15,not a real question,1,43,12,"Identify views accessed more often than others in SQL Server 2008 R2 There are some duplicate views in our SQL server database and we need to identify views accessed more often than others so we can retire the other duplicate views that are not accessed as often.

Thanks again for all your help in advance. ",1
6095542,05/23/2011 09:51:19,543047,08/31/2010 07:00:53,687,97,how to query Datetime object by date?,"i want to query a table according to a particular date, but the problem is the datatype of that field is datetime 


    select  * from  Supplier  where modified_Date='2011-05-07 12:52:16.830' 
this query is returning result

but 

     select  * from  Supplier  where modified_Date='2011-05-07' 

there is no result",sql-server-2008,,,,,,open,0,59,7,"how to query Datetime object by date? i want to query a table according to a particular date, but the problem is the datatype of that field is datetime 


    select  * from  Supplier  where modified_Date='2011-05-07 12:52:16.830' 
this query is returning result

but 

     select  * from  Supplier  where modified_Date='2011-05-07' 

there is no result",1
6633532,07/09/2011 08:01:19,347790,05/22/2010 12:40:34,1728,48,Problem in Column and Row grouping in Sql server 2008 reporting,"I want to print my data in this format in sql server report

![enter image description here][1]

In the database query im fetching records like this

![enter image description here][2]

This query is simply fetching records. My question is can i print data in format i want with one single datasource? If yes then how?

  [1]: http://i.stack.imgur.com/PgM3P.png
  [2]: http://i.stack.imgur.com/0Zizj.png",sql-server-2008,reportingservices-2008,,,,,open,0,57,11,"Problem in Column and Row grouping in Sql server 2008 reporting I want to print my data in this format in sql server report

![enter image description here][1]

In the database query im fetching records like this

![enter image description here][2]

This query is simply fetching records. My question is can i print data in format i want with one single datasource? If yes then how?

  [1]: http://i.stack.imgur.com/PgM3P.png
  [2]: http://i.stack.imgur.com/0Zizj.png",2
11473094,07/13/2012 15:01:50,914373,08/26/2011 15:13:05,358,9,SSIS transfer SQL server objects task -> Foreign key constraint error,"I try to copy a database from 1 server to the other to build a staging environment. I do this with SSID. First I delete the existing database on my staging server, create a new and empty one and then I run the script. I copy everything. Most of my databases copy correctly except for 1 which gives me a Foreign Key constraint error. What can I do to fix this? I tried googling, but without any results.

 

       SSIS package ""XXXXXXXX.dtsx"" starting.
    Information: 0x4002F418 at MyDatabase, Transfer SQL Server Objects Task: There are no Logins to transfer.
    Error: 0xC002F325 at myDB, Transfer SQL Server Objects Task: Execution failed with the following error: ""ERROR : errorCode=-1073548784 description=Executing the query ""ALTER TABLE [dbo].[TemplatePropertyValue]  WITH CH..."" failed with the following error: ""The ALTER TABLE statement conflicted with the FOREIGN KEY constraint ""FK_VALUE1_Template"". The conflict occurred in database ""myDB"", table ""dbo.Template"", column 'Id'."". Possible failure reasons: Problems with the query, ""ResultSet"" property not set correctly, parameters not set correctly, or connection not established correctly.
     helpFile= helpContext=0 idofInterfaceWithError={C81DFC5A-3B22-4DA3-BD3B-10BF861A7F9C}"".
    Task failed: myDB
    SSIS package ""XXXXXXXXX.dtsx"" finished: Success.

",sql-server-2008,ssis,,,,07/16/2012 02:31:52,off topic,1,205,11,"SSIS transfer SQL server objects task -> Foreign key constraint error I try to copy a database from 1 server to the other to build a staging environment. I do this with SSID. First I delete the existing database on my staging server, create a new and empty one and then I run the script. I copy everything. Most of my databases copy correctly except for 1 which gives me a Foreign Key constraint error. What can I do to fix this? I tried googling, but without any results.

 

       SSIS package ""XXXXXXXX.dtsx"" starting.
    Information: 0x4002F418 at MyDatabase, Transfer SQL Server Objects Task: There are no Logins to transfer.
    Error: 0xC002F325 at myDB, Transfer SQL Server Objects Task: Execution failed with the following error: ""ERROR : errorCode=-1073548784 description=Executing the query ""ALTER TABLE [dbo].[TemplatePropertyValue]  WITH CH..."" failed with the following error: ""The ALTER TABLE statement conflicted with the FOREIGN KEY constraint ""FK_VALUE1_Template"". The conflict occurred in database ""myDB"", table ""dbo.Template"", column 'Id'."". Possible failure reasons: Problems with the query, ""ResultSet"" property not set correctly, parameters not set correctly, or connection not established correctly.
     helpFile= helpContext=0 idofInterfaceWithError={C81DFC5A-3B22-4DA3-BD3B-10BF861A7F9C}"".
    Task failed: myDB
    SSIS package ""XXXXXXXXX.dtsx"" finished: Success.

",2
3122877,06/26/2010 05:49:11,63235,02/06/2009 08:35:13,2838,1,SQL Server temp DB issue,"I am using SQL Server 2008 on Windows Server 2008. I find the temp DB mdf and temp ldf is very big (about 13G), and it is almost the same size of all other real application database files (mdf+ldf).

My questions,

1. What temp DB is used for?
2. Is it normal situation that temp DB is so big? If not, any ways to clean-up temp DB without impacting system performance and reliability?

thanks in advance,
George",sql-server-2008,windows-server,,,,,open,0,72,5,"SQL Server temp DB issue I am using SQL Server 2008 on Windows Server 2008. I find the temp DB mdf and temp ldf is very big (about 13G), and it is almost the same size of all other real application database files (mdf+ldf).

My questions,

1. What temp DB is used for?
2. Is it normal situation that temp DB is so big? If not, any ways to clean-up temp DB without impacting system performance and reliability?

thanks in advance,
George",2
2448057,03/15/2010 15:01:57,111843,05/24/2009 20:48:09,100,2,"Microsoft SQL Server 2008 Web Edition: is it suitable for ""closed"" websites?","Can **Microsoft SQL Server 2008 Web Edition** be used in **""closed"" websites**, which are hosted on the Internet, but require users to log in?

We are developing a web application for banks. This is a website for clients of the bank; it allows clients to log in and view information on their personal banking accounts, stock portfolios, etc.

Can this web app use SQL Server 2008 Web Edition?

Here is information on this edition of SQL Server:

http://www.microsoft.com/sqlserver/2008/en/us/web.aspx

It is said on this page that Web Edition can be used only on ""**public and Internet accessible** ... Web applications"". Technically, the web app we are developing is public and Internet accessible - although it requires authentication. Won't using Web Edition in our web app violate SQL Server license terms?

Thank you.",sql-server-2008,,,,,,open,0,125,12,"Microsoft SQL Server 2008 Web Edition: is it suitable for ""closed"" websites? Can **Microsoft SQL Server 2008 Web Edition** be used in **""closed"" websites**, which are hosted on the Internet, but require users to log in?

We are developing a web application for banks. This is a website for clients of the bank; it allows clients to log in and view information on their personal banking accounts, stock portfolios, etc.

Can this web app use SQL Server 2008 Web Edition?

Here is information on this edition of SQL Server:

http://www.microsoft.com/sqlserver/2008/en/us/web.aspx

It is said on this page that Web Edition can be used only on ""**public and Internet accessible** ... Web applications"". Technically, the web app we are developing is public and Internet accessible - although it requires authentication. Won't using Web Edition in our web app violate SQL Server license terms?

Thank you.",1
9381240,02/21/2012 16:29:27,1026096,11/02/2011 16:52:41,3,0,Identity Increment,"**I DeNormalized  2 tables into 1, by using the following statements** 

    Select Calls.*,Patient.*
    INTO Calls2
    From Calls,Patient

Now, i set one of the column as primary key but I cant get that primary key to have Identity Increment.
What should i do to do this?

Thanks in advance,
Madhu",sql-server-2008,auto-increment,,,,02/22/2012 16:13:46,not a real question,1,56,2,"Identity Increment **I DeNormalized  2 tables into 1, by using the following statements** 

    Select Calls.*,Patient.*
    INTO Calls2
    From Calls,Patient

Now, i set one of the column as primary key but I cant get that primary key to have Identity Increment.
What should i do to do this?

Thanks in advance,
Madhu",2
9728034,03/15/2012 20:55:50,1272530,03/15/2012 20:05:48,1,0,Connection pool connections consumed when in TransactionScope,"Can someone explain why we are experiencing a total consumption of the connection pool when performing queries inside TransactionScope resulting in


    System.InvalidOperationException: Timeout expired. The timeout period elapsed prior to obtaining a connection from the pool. This may have occurred because all pooled connections were in use and max pool size was reached.


I have reduced our problem to the following:


    
    SomeNonTransactionalCode()
    {
        // This code will execute with just one connection to the database
        // and complete without exception
        
       List<BusinessEntity> beList;

       for (int i = 0; i < 101; i++)
       {
           BusinessEntityRepository beRepo = new BusinessEntityRepository();
           beList = beRepo.ReadAll().ToList();
       }
    }


    SomeTransactionalCode()
    {
        // This code will cause the connections to the database to increment
        // with every iteration eventually timing out after 100 connections

        using (TransactionScope transactionScope = new TransactionScope())
        {
            List<BusinessEntity> beList;

            for (int i = 0; i < 101; i++)
            {
                BusinessEntityRepository beRepo = new BusinessEntityRepository();
                beList = beRepo.ReadAll().ToList();
            }

            transactionScope.Complete();
        }
    }


Surely this is not expected behaviour? I have read nothing that explains why this might be happening. I can only assume it is something to do with how we have implemented our repositories. Hopefully the following will give a good enough description of the implementation. 


    public class BusinessEntityRepository
    {
        private BusinessEntityDal Dal { get; set; }

        public BusinessEntityRepository()
        {
            this.Dal = new BusinessEntityDal ();
        }

        public IQueryable<BusinessEntity> ReadAll()
        {
            IQueryable<BusinessEntity> query = null;
            if (Dal != null)
            {
                query = Dal.ReadAll();
            }

            //-Return
            return query;
        }
    }

    public class BusinessEntityDal : BaseDal 
    {
        public IQueryable<BusinessEntity> ReadAll()
        {
            var result = from de in this.DC.BusinessEntityTable
                             select new BusinessEntity
                             {
                                 Property1 = Column1,
                                 Property2 = Column2,
                                 // etc... 
	                         };
            //-Return
            return (result);
        }
    }

    public abstract class BaseDal
    {
        protected OurDataContext DC;

        public BaseDal()
        {
            // create a DataContext
            this.DC = new OurDataContext();
        }
    }

    public class OurDataContext : System.Data.Linq.DataContext
    {       
        private static readonly string _cn = // some static connection string taken from web.config
        public OurDataContext()
            : base(OurDataContext._cn)
        {
        }
    }

Our connection string is fairly conventional and leaves the number of connections in the pool at the default 100 (hence the 101 iterations to test the issue in my code above). ",sql-server-2008,linq-to-sql,connection-pooling,transactionscope,,,open,0,1073,7,"Connection pool connections consumed when in TransactionScope Can someone explain why we are experiencing a total consumption of the connection pool when performing queries inside TransactionScope resulting in


    System.InvalidOperationException: Timeout expired. The timeout period elapsed prior to obtaining a connection from the pool. This may have occurred because all pooled connections were in use and max pool size was reached.


I have reduced our problem to the following:


    
    SomeNonTransactionalCode()
    {
        // This code will execute with just one connection to the database
        // and complete without exception
        
       List<BusinessEntity> beList;

       for (int i = 0; i < 101; i++)
       {
           BusinessEntityRepository beRepo = new BusinessEntityRepository();
           beList = beRepo.ReadAll().ToList();
       }
    }


    SomeTransactionalCode()
    {
        // This code will cause the connections to the database to increment
        // with every iteration eventually timing out after 100 connections

        using (TransactionScope transactionScope = new TransactionScope())
        {
            List<BusinessEntity> beList;

            for (int i = 0; i < 101; i++)
            {
                BusinessEntityRepository beRepo = new BusinessEntityRepository();
                beList = beRepo.ReadAll().ToList();
            }

            transactionScope.Complete();
        }
    }


Surely this is not expected behaviour? I have read nothing that explains why this might be happening. I can only assume it is something to do with how we have implemented our repositories. Hopefully the following will give a good enough description of the implementation. 


    public class BusinessEntityRepository
    {
        private BusinessEntityDal Dal { get; set; }

        public BusinessEntityRepository()
        {
            this.Dal = new BusinessEntityDal ();
        }

        public IQueryable<BusinessEntity> ReadAll()
        {
            IQueryable<BusinessEntity> query = null;
            if (Dal != null)
            {
                query = Dal.ReadAll();
            }

            //-Return
            return query;
        }
    }

    public class BusinessEntityDal : BaseDal 
    {
        public IQueryable<BusinessEntity> ReadAll()
        {
            var result = from de in this.DC.BusinessEntityTable
                             select new BusinessEntity
                             {
                                 Property1 = Column1,
                                 Property2 = Column2,
                                 // etc... 
	                         };
            //-Return
            return (result);
        }
    }

    public abstract class BaseDal
    {
        protected OurDataContext DC;

        public BaseDal()
        {
            // create a DataContext
            this.DC = new OurDataContext();
        }
    }

    public class OurDataContext : System.Data.Linq.DataContext
    {       
        private static readonly string _cn = // some static connection string taken from web.config
        public OurDataContext()
            : base(OurDataContext._cn)
        {
        }
    }

Our connection string is fairly conventional and leaves the number of connections in the pool at the default 100 (hence the 101 iterations to test the issue in my code above). ",4
5828952,04/29/2011 07:02:05,164315,08/27/2009 16:02:51,1062,55,Entity Framework expose several databases as a whole,"I have three databases with exactly the same schema (SAP Business One databases). In this databases I have an item masters table connected to a warehouse stock table via the item code. Can I have just one Entity framework model that has only one item master object and one warehouse stocks object which draws data from the 3 databases?
The items are the same in the three databases but they have different warehouse codes.
I don't know if I have made myself clear.",sql-server-2008,entity-framework-4,sap,,,,open,0,81,8,"Entity Framework expose several databases as a whole I have three databases with exactly the same schema (SAP Business One databases). In this databases I have an item masters table connected to a warehouse stock table via the item code. Can I have just one Entity framework model that has only one item master object and one warehouse stocks object which draws data from the 3 databases?
The items are the same in the three databases but they have different warehouse codes.
I don't know if I have made myself clear.",3
7703375,10/09/2011 12:05:59,986313,10/09/2011 11:52:34,1,0,Generate sequence number without duplication,"I need to generate a unique sequence number based on some criteria for the first time and then store it in DB and each time i select this generated number incremented by one till reaching to threshold then resetting the generated number.

I have already generated the number and stored it in DB, there is a stored procedure that calls this number and increments it by one then updates the stored value with the new value(after incrementing). The problem now is that may be 2 users call the same procedure in the same time then each one will select the same stored generated number and then incrementing it and update stored value with new one(assume updating is done sequentially without dead locking) and in this case the 2 users get the same number and breaks the rule of number is unique how can i avoid concurrent users from selecting (getting) the same number?",sql-server-2008,,,,,,open,0,152,5,"Generate sequence number without duplication I need to generate a unique sequence number based on some criteria for the first time and then store it in DB and each time i select this generated number incremented by one till reaching to threshold then resetting the generated number.

I have already generated the number and stored it in DB, there is a stored procedure that calls this number and increments it by one then updates the stored value with the new value(after incrementing). The problem now is that may be 2 users call the same procedure in the same time then each one will select the same stored generated number and then incrementing it and update stored value with new one(assume updating is done sequentially without dead locking) and in this case the 2 users get the same number and breaks the rule of number is unique how can i avoid concurrent users from selecting (getting) the same number?",1
10227407,04/19/2012 11:50:11,199619,10/30/2009 11:59:21,52,4,SQLServer 2008 - Return Value of stored procedure after catching an exception,"Given the following SP ...

CREATE PROCEDURE [dbo].[trytest1]
	
AS

	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT 'Testing 1'
	
	DECLARE @int1 INTEGER
	DECLARE @int2 INTEGER
	DECLARE @int3 INTEGER
	
	SET @int1 = 0
	SET @int2 = 0
	
		BEGIN TRY
			SELECT 'Testing 2'
		
			SET @int3 = @int1 / @int2
				
			SELECT 'Testing 3'
		END TRY
	    
		BEGIN CATCH
			SELECT 'Testing 4'
		END CATCH
	
	SET @int3 = @int1 + @int2
	SELECT 'Testing 5'
	
Executing this gives ...

Testing 1

Testing 2

Testing 4

Testing 5

Return Value -6

Catch catches divide by zero, but execution continues after catch block
Im curious why even though query executed successfully and
continued after the trycatch normally, the return value is -6. Will it stay -6 forever?

And, while I'm here, just curious, is it possible to continue execution in Try Block (ie select 'Testing 3')

Thanks",sql-server-2008,try-catch,return-value,,,,open,0,122,12,"SQLServer 2008 - Return Value of stored procedure after catching an exception Given the following SP ...

CREATE PROCEDURE [dbo].[trytest1]
	
AS

	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT 'Testing 1'
	
	DECLARE @int1 INTEGER
	DECLARE @int2 INTEGER
	DECLARE @int3 INTEGER
	
	SET @int1 = 0
	SET @int2 = 0
	
		BEGIN TRY
			SELECT 'Testing 2'
		
			SET @int3 = @int1 / @int2
				
			SELECT 'Testing 3'
		END TRY
	    
		BEGIN CATCH
			SELECT 'Testing 4'
		END CATCH
	
	SET @int3 = @int1 + @int2
	SELECT 'Testing 5'
	
Executing this gives ...

Testing 1

Testing 2

Testing 4

Testing 5

Return Value -6

Catch catches divide by zero, but execution continues after catch block
Im curious why even though query executed successfully and
continued after the trycatch normally, the return value is -6. Will it stay -6 forever?

And, while I'm here, just curious, is it possible to continue execution in Try Block (ie select 'Testing 3')

Thanks",3
11263556,06/29/2012 14:22:51,1458312,06/15/2012 09:34:14,6,0,Sql server 2008 connection couldn't be etablished,I have Sql server 2008 installed on my machine but no connection could be established. Where to find its password? Whether windows authentication or Sql server authentication should be followed for the same ?,sql-server-2008,,,,,06/29/2012 14:47:22,too localized,1,34,7,Sql server 2008 connection couldn't be etablished I have Sql server 2008 installed on my machine but no connection could be established. Where to find its password? Whether windows authentication or Sql server authentication should be followed for the same ?,1
11419194,07/10/2012 18:01:52,1514825,07/10/2012 12:52:51,1,0,SQL Server 2008 replication scenario,"First of all sorry about my english, and most importantly, my database ignorance, I'll do my best ;)

Until now, the scenario that I have is as follows:

- In a server under our LAN, we have a database in a SQL Server 2008 R2 instance that is replicating as a publisher in a transactional replication with a DB (SQL Server 2008 R2 too) subscriber under a client LAN, both of them communicating through internet without using any VPN

Today the world turned black... at least for me, I'm on the developer side and this kind of requirements makes me spend a lot of time to get little progress: **The client request us to setup a bidirectional transactional replication**.

I know the client dont want a bidi-trans-replication exactly, what they really want it's to interact with data that we have to see like they see ours via replication, and here it's where my doubts appears:

- Is there other solution to this scenario than bidi-trans-replication?, I read something about mixed replications, but I don't know if this is better or worst :S
- In case of bidi-trans-replication, do the client needs to keep open ports in order to mantain the bidi-trans-replication?, by now we distribute the snapshot via FTP, I understand that we have to keep ports 21 and 1433 opened, but, the client needs the 1433 port opened too?

Thanks all in advance!
",sql-server-2008,database-replication,,,,07/10/2012 19:47:08,off topic,1,227,5,"SQL Server 2008 replication scenario First of all sorry about my english, and most importantly, my database ignorance, I'll do my best ;)

Until now, the scenario that I have is as follows:

- In a server under our LAN, we have a database in a SQL Server 2008 R2 instance that is replicating as a publisher in a transactional replication with a DB (SQL Server 2008 R2 too) subscriber under a client LAN, both of them communicating through internet without using any VPN

Today the world turned black... at least for me, I'm on the developer side and this kind of requirements makes me spend a lot of time to get little progress: **The client request us to setup a bidirectional transactional replication**.

I know the client dont want a bidi-trans-replication exactly, what they really want it's to interact with data that we have to see like they see ours via replication, and here it's where my doubts appears:

- Is there other solution to this scenario than bidi-trans-replication?, I read something about mixed replications, but I don't know if this is better or worst :S
- In case of bidi-trans-replication, do the client needs to keep open ports in order to mantain the bidi-trans-replication?, by now we distribute the snapshot via FTP, I understand that we have to keep ports 21 and 1433 opened, but, the client needs the 1433 port opened too?

Thanks all in advance!
",2
7442675,09/16/2011 09:30:50,948496,09/16/2011 09:23:12,1,0,Problem in Sql server 2008 connection with JDBC,"Suggest driver for connecting SQL Server 2008 with jdbc and connection string.

Thanks.",sql-server-2008,jdbc,,,,09/16/2011 20:42:22,not a real question,1,12,8,"Problem in Sql server 2008 connection with JDBC Suggest driver for connecting SQL Server 2008 with jdbc and connection string.

Thanks.",2
10573854,05/13/2012 17:44:45,1226569,02/22/2012 18:18:09,1,0,changing datatype of dynamically generated columns,I have a temporary table in which the columns are dynamically generated using pivot.As I am using the pivot function the columns by themselves are of int datatype. the values for the columns are either 0 or 1. Now I want to update 1 with 'Y' and 0 with 'N'. but I am getting conversion error while doing so. please help.,sql-server-2008,,,,,,open,0,61,6,changing datatype of dynamically generated columns I have a temporary table in which the columns are dynamically generated using pivot.As I am using the pivot function the columns by themselves are of int datatype. the values for the columns are either 0 or 1. Now I want to update 1 with 'Y' and 0 with 'N'. but I am getting conversion error while doing so. please help.,1
10792389,05/29/2012 02:19:18,1160352,01/20/2012 09:56:16,62,3,How to create data connection and submitting between InfoPath 2010 and SQL Server 2008 (Live Server)?,"I was create an Infopath 2010 form from Databse Form Template. The database source that I used on a live server (need internet connection). I've done to create the form. But when I try to submit the entries from the form, I get error that says: 

> InfoPath cannot submit the form. An error occurred while the form was
> being submitted. InfoPath cannot connect to the data source. Access is
> denied. Access is denied.

I create this form based from this [tutorial][1] 


  [1]: http://www.bizsupportonline.net/infopath2010/connect-infopath-2010-sql-server-2008-table.htm

Can I submit the infopath form to SQL Server on live server directly? Thanks :)",sql-server-2008,database-connection,form-submit,infopath2010,,,open,0,99,16,"How to create data connection and submitting between InfoPath 2010 and SQL Server 2008 (Live Server)? I was create an Infopath 2010 form from Databse Form Template. The database source that I used on a live server (need internet connection). I've done to create the form. But when I try to submit the entries from the form, I get error that says: 

> InfoPath cannot submit the form. An error occurred while the form was
> being submitted. InfoPath cannot connect to the data source. Access is
> denied. Access is denied.

I create this form based from this [tutorial][1] 


  [1]: http://www.bizsupportonline.net/infopath2010/connect-infopath-2010-sql-server-2008-table.htm

Can I submit the infopath form to SQL Server on live server directly? Thanks :)",4
2052316,01/12/2010 20:58:07,230348,12/12/2009 16:42:24,3,5,Access dinied in SQL 2008 on image write,"I have create my code in order to write images in a remote sql server

All the details of accessing and writing are fine until now, including the system account
right now i'm in the command of:

    SqlFileStream = New SqlFileStream(filePathName, fileToken, FileAccess.Write)

and when i'm trying to execute it the Server returns the error 'Access denied'
I have try all the posible ( those which i know) combinations to overcome this error but nothing
Please give me the best assistance you may have

I've put a sniffer in my PC to lookup the packages between Server and my PC, so here what i got:
the first addres is the Server address and the second is my PC address.

*""10.93.1.29"",""10.93.1.10"",""SMB"",""Tree Connect AndX Request, Path: \\DEVELOPER\SQLEXPRESS ""  

""10.93.1.10"",""10.93.1.29"",""SMB"",""Tree Connect AndX Response""

""10.93.1.29"",""10.93.1.10"",""SMB"",""Trans2 Request, QUERY_PATH_INFO, Query File Basic Info, Path: \v1\RemoteDB\dbo\tPImages\tPImages_Image\DB6F1B11-2FAF-4326-8E44-FBA71DA94CEC\b8010a0f1aaf47c1888aab2e830dff43""

""10.93.1.10"",""10.93.1.29"",""SMB"",""Trans2 Response, QUERY_PATH_INFO, Error: STATUS_ACCESS_DENIED""

""10.93.1.29"",""10.93.1.10"",""SMB"",""NT Trans Request, NT CREATE""

""10.93.1.10"",""10.93.1.29"",""SMB"",""NT Trans Response, NT CREATE, FID: 0x0000, Error: STATUS_ACCESS_DENIED""*

I dare to say that this error comes from the Windows program when the SQL 2008 tries to write some DATA to the filies which creates on C:\sqlRemData\..... (but finally i'm not sure even for that)

PLEASE if anyone knows?",sql-server-2008,vb.net,stream,streaming,image,02/02/2010 19:26:49,off topic,1,188,8,"Access dinied in SQL 2008 on image write I have create my code in order to write images in a remote sql server

All the details of accessing and writing are fine until now, including the system account
right now i'm in the command of:

    SqlFileStream = New SqlFileStream(filePathName, fileToken, FileAccess.Write)

and when i'm trying to execute it the Server returns the error 'Access denied'
I have try all the posible ( those which i know) combinations to overcome this error but nothing
Please give me the best assistance you may have

I've put a sniffer in my PC to lookup the packages between Server and my PC, so here what i got:
the first addres is the Server address and the second is my PC address.

*""10.93.1.29"",""10.93.1.10"",""SMB"",""Tree Connect AndX Request, Path: \\DEVELOPER\SQLEXPRESS ""  

""10.93.1.10"",""10.93.1.29"",""SMB"",""Tree Connect AndX Response""

""10.93.1.29"",""10.93.1.10"",""SMB"",""Trans2 Request, QUERY_PATH_INFO, Query File Basic Info, Path: \v1\RemoteDB\dbo\tPImages\tPImages_Image\DB6F1B11-2FAF-4326-8E44-FBA71DA94CEC\b8010a0f1aaf47c1888aab2e830dff43""

""10.93.1.10"",""10.93.1.29"",""SMB"",""Trans2 Response, QUERY_PATH_INFO, Error: STATUS_ACCESS_DENIED""

""10.93.1.29"",""10.93.1.10"",""SMB"",""NT Trans Request, NT CREATE""

""10.93.1.10"",""10.93.1.29"",""SMB"",""NT Trans Response, NT CREATE, FID: 0x0000, Error: STATUS_ACCESS_DENIED""*

I dare to say that this error comes from the Windows program when the SQL 2008 tries to write some DATA to the filies which creates on C:\sqlRemData\..... (but finally i'm not sure even for that)

PLEASE if anyone knows?",5
9551015,03/04/2012 00:03:20,41348,11/27/2008 12:25:12,3021,103,"SQL Server Merge Replication fails with ""Initializing SQL Server Reconciler has failed. Try again.""","I'm trying to set up replication between a SQL Server 2008 R2 database and SQL Server CE 3.5. I have set up IIS 7 accordingly and get a nice ""Microsoft SQL Server Compact Server Agent"" when checking the publication URL (http://winserver2008/SQLReplication/sqlcesa35.dll).

However when I try http://winserver2008/SQLReplication/sqlcesa35.dll?diag I get the following:

![enter image description here][1]

When I try to connect to the publisher via a C# app I'm writing I get ""Initializing SQL Server Reconciler has failed. Try again"". i assume that means I need that 9.0 database reconciler? If so how do I install it?

On a side note this only happens when I try to connect via Integrated Windows Authentication. If I try via SQL Server authentication instead I just get an error about SQL Server missing or having an incorrect login/password.

  [1]: http://i.stack.imgur.com/6SJPJ.png",sql-server-2008,sql-server-ce,merge-replication,,,,open,0,132,14,"SQL Server Merge Replication fails with ""Initializing SQL Server Reconciler has failed. Try again."" I'm trying to set up replication between a SQL Server 2008 R2 database and SQL Server CE 3.5. I have set up IIS 7 accordingly and get a nice ""Microsoft SQL Server Compact Server Agent"" when checking the publication URL (http://winserver2008/SQLReplication/sqlcesa35.dll).

However when I try http://winserver2008/SQLReplication/sqlcesa35.dll?diag I get the following:

![enter image description here][1]

When I try to connect to the publisher via a C# app I'm writing I get ""Initializing SQL Server Reconciler has failed. Try again"". i assume that means I need that 9.0 database reconciler? If so how do I install it?

On a side note this only happens when I try to connect via Integrated Windows Authentication. If I try via SQL Server authentication instead I just get an error about SQL Server missing or having an incorrect login/password.

  [1]: http://i.stack.imgur.com/6SJPJ.png",3
11520179,07/17/2012 10:01:33,164002,08/26/2009 12:15:42,1261,13,Sql server Database? sql server 2008?,"How can i open my database online, can you give me any site which will open my database, my database is sql server 2008. ",sql-server-2008,,,,,07/17/2012 20:36:45,not constructive,1,25,6,"Sql server Database? sql server 2008? How can i open my database online, can you give me any site which will open my database, my database is sql server 2008. ",1
8731219,01/04/2012 17:29:48,109676,04/27/2009 18:56:57,1970,78,Does SQL 2008 R2 automatically install the .NET Framework by default?,"Does SQL 2008 R2 automatically install the .NET Framework by default? If so, which version?
",sql-server-2008,,,,,01/04/2012 19:48:24,off topic,1,15,11,"Does SQL 2008 R2 automatically install the .NET Framework by default? Does SQL 2008 R2 automatically install the .NET Framework by default? If so, which version?
",1
8242592,11/23/2011 12:59:33,252975,01/18/2010 06:58:11,16,4,Unable to Generate Script for 3 Views in SQL server management studio 2008,"I have a strange problem

When I create Object Script (script to drop and create Stored Procedures, Views, Functions) from Sql Server 2008 it misses 3 Views don't know why?

I am performing Following steps to create object script 

1) Open Sql Server 2008 Management Studio
2) Connect to server
3) Right click on selected database then click on Tasks -> Generate Script, then select database from list, click Next.
4) It gives options I am changing three options i.e. Include If Not Exists = true, Script Drop = true, Script Use Database = false and clicing Next button
4) Now selecting SP, Views and Functions and clicking Next,
5) clicking Select All for All the coming screens
6) Finally clicking Finish button.

Please let me know what I am missing , I have tried all the ways.

Thanks
",sql-server-2008,stored-procedures,ssms,ssms2008,,,open,0,129,13,"Unable to Generate Script for 3 Views in SQL server management studio 2008 I have a strange problem

When I create Object Script (script to drop and create Stored Procedures, Views, Functions) from Sql Server 2008 it misses 3 Views don't know why?

I am performing Following steps to create object script 

1) Open Sql Server 2008 Management Studio
2) Connect to server
3) Right click on selected database then click on Tasks -> Generate Script, then select database from list, click Next.
4) It gives options I am changing three options i.e. Include If Not Exists = true, Script Drop = true, Script Use Database = false and clicing Next button
4) Now selecting SP, Views and Functions and clicking Next,
5) clicking Select All for All the coming screens
6) Finally clicking Finish button.

Please let me know what I am missing , I have tried all the ways.

Thanks
",4
8525051,12/15/2011 18:46:37,1073943,11/30/2011 17:55:17,1,0,Update Top query,"I am working with some data on sql server. A table has 4 identical rows and doesn't have any primary key. I wish to update any one row of those 4 may be a top row.

Is it possible to do this? I tried doing that by manipulating update queries in lot many ways, but nothing works... 
",sql-server-2008,sql-update,,,,,open,0,57,3,"Update Top query I am working with some data on sql server. A table has 4 identical rows and doesn't have any primary key. I wish to update any one row of those 4 may be a top row.

Is it possible to do this? I tried doing that by manipulating update queries in lot many ways, but nothing works... 
",2
11642323,07/25/2012 03:36:53,1550331,07/25/2012 02:35:29,1,0,how to write the sql statement?,"![enter image description here][1]


IncidentReportid                  Interviewers                 MainInterviewer             
19 :irank/inric/iDesg/iunit/iremark:irank1/inric1/iDesg1/iunit1/iremark1:        inric	
20 :irank4/inric4/iDesg4/iunit4/iremark4:i rank5/i nric5/iDesg5/iunit5/iremark5: inric5
21 :irank7/inric7/iDesg7/iunit7/iremark7:irank8/inric8/iDesg8/iunit8/iremark8:   inric7
23 :irank9/inric9/iDesg9/iunit9/iremark9:irank6/inric6/iDesg6/iunit6/iremark6:   inric9
24 :RankOfAddison/aNRIC/aInstructor/aUnit/aRemark:RankOfNang/nNRIC/nInstructor/nUnit/nRemark:  aNRIC
I have the table above image and i wanna get the data as following.. The main thing is that i want to get the interviewer' name depend on the 'Main interviewer NRIC'. pls help me ...

IncidentReportid                Interviewers       MainInterviewer             
              
19                                irank            inric                 
20                                irank5	   inric5               
21                                irank7           inric7                 
23                                irank9           inric9                
24                                RankOfAddison     aNRIC                   ",sql-server-2008,,,,,07/25/2012 12:09:33,not a real question,1,447,6,"how to write the sql statement? ![enter image description here][1]


IncidentReportid                  Interviewers                 MainInterviewer             
19 :irank/inric/iDesg/iunit/iremark:irank1/inric1/iDesg1/iunit1/iremark1:        inric	
20 :irank4/inric4/iDesg4/iunit4/iremark4:i rank5/i nric5/iDesg5/iunit5/iremark5: inric5
21 :irank7/inric7/iDesg7/iunit7/iremark7:irank8/inric8/iDesg8/iunit8/iremark8:   inric7
23 :irank9/inric9/iDesg9/iunit9/iremark9:irank6/inric6/iDesg6/iunit6/iremark6:   inric9
24 :RankOfAddison/aNRIC/aInstructor/aUnit/aRemark:RankOfNang/nNRIC/nInstructor/nUnit/nRemark:  aNRIC
I have the table above image and i wanna get the data as following.. The main thing is that i want to get the interviewer' name depend on the 'Main interviewer NRIC'. pls help me ...

IncidentReportid                Interviewers       MainInterviewer             
              
19                                irank            inric                 
20                                irank5	   inric5               
21                                irank7           inric7                 
23                                irank9           inric9                
24                                RankOfAddison     aNRIC                   ",1
1995980,01/03/2010 19:25:12,230348,12/12/2009 16:42:24,5,4,Acces Dinied in SQL 2008 EXPRESS,"Well now at the end of my program i'm facing an access dinied 

    Dim sqlFile As SqlFileStream = New SqlFileStream(filePathName, fileToken, FileAccess.Write)

This is the last command in order to write the STREAM image in the table

This command returns me an 'Acces Denied' error no other comment

I have give in my account a Login relation which is Windows Login account which is a member of 

SQLServerMSSQLUser$developer$SQLEXPRESS  

account

Means that we have all the prmissions on the server (as a machine) 

even so i receive the 'Access Dinied' 

The Service account it is not the problem because we have solve it from the very start of this program 


anyone which can help me?
",sql-server-2008,visual-studio-2008,filestream,,,01/18/2010 17:37:39,off topic,1,115,6,"Acces Dinied in SQL 2008 EXPRESS Well now at the end of my program i'm facing an access dinied 

    Dim sqlFile As SqlFileStream = New SqlFileStream(filePathName, fileToken, FileAccess.Write)

This is the last command in order to write the STREAM image in the table

This command returns me an 'Acces Denied' error no other comment

I have give in my account a Login relation which is Windows Login account which is a member of 

SQLServerMSSQLUser$developer$SQLEXPRESS  

account

Means that we have all the prmissions on the server (as a machine) 

even so i receive the 'Access Dinied' 

The Service account it is not the problem because we have solve it from the very start of this program 


anyone which can help me?
",3
4997313,02/14/2011 21:10:42,56740,01/19/2009 16:35:52,936,32,What's a good tool to allow for detection and tracing of infrequent deadlocks on SQL Server?,We have an CRM 4 server which is being used in production with many SSIS jobs syncing data in it from external sources.  We also have a fairly large number of async workflows & sync plugins that run on our entities.  Every now and then we will get deadlocks even though we've put the read snapshot committed on in our SQL 2008.  Are there any tools we could point at our sql server and when deadlocks occur would give us as much information as possible about that processes and the query text those processing are running which caused the deadlocks?  ,sql-server-2008,,,,,,open,0,105,16,What's a good tool to allow for detection and tracing of infrequent deadlocks on SQL Server? We have an CRM 4 server which is being used in production with many SSIS jobs syncing data in it from external sources.  We also have a fairly large number of async workflows & sync plugins that run on our entities.  Every now and then we will get deadlocks even though we've put the read snapshot committed on in our SQL 2008.  Are there any tools we could point at our sql server and when deadlocks occur would give us as much information as possible about that processes and the query text those processing are running which caused the deadlocks?  ,1
6832258,07/26/2011 15:09:06,494901,11/02/2010 15:14:22,431,10,Best wiki software for IIS 7 & SQL Server 2008?,"I'm looking at setting up a Wiki for internal development documentation, we're an IIS 7 & SQL Server 2008 environment. What are the open source options for a Wiki for WIndows Servers? ",sql-server-2008,iis7,documentation,wiki,windows-server-2008-r2,07/26/2011 15:30:58,off topic,1,33,10,"Best wiki software for IIS 7 & SQL Server 2008? I'm looking at setting up a Wiki for internal development documentation, we're an IIS 7 & SQL Server 2008 environment. What are the open source options for a Wiki for WIndows Servers? ",5
2929065,05/28/2010 12:50:51,340183,05/13/2010 10:49:55,66,0,oracle 11g vs Sql Server 2008,"Which one better in performance and scalability ,Oracle 11g or SQL SERVER 2008 ",sql-server-2008,oracle11g,,,,05/28/2010 13:00:13,not constructive,1,14,6,"oracle 11g vs Sql Server 2008 Which one better in performance and scalability ,Oracle 11g or SQL SERVER 2008 ",2
8436264,12/08/2011 19:07:34,1088379,12/08/2011 19:01:25,1,0,Having one server maintain two other servers,"I have an unusual situation. I have 3 servers, 2 production that is mirrored and one web that i would like to setup to run all the backup jobs and maintenance for the production servers.

Simply put, I have Prod1 and Prod 2 that are mirrored and Web3 that i want to have do all the maintenance jobs of Prod1 and Prod2.

is there any way to have that done and what would be required to have it done?

Thanks in Advance",sql-server-2008,,,,,12/08/2011 20:43:09,off topic,1,79,7,"Having one server maintain two other servers I have an unusual situation. I have 3 servers, 2 production that is mirrored and one web that i would like to setup to run all the backup jobs and maintenance for the production servers.

Simply put, I have Prod1 and Prod 2 that are mirrored and Web3 that i want to have do all the maintenance jobs of Prod1 and Prod2.

is there any way to have that done and what would be required to have it done?

Thanks in Advance",1
8265762,11/25/2011 07:06:25,149769,08/03/2009 14:01:07,495,21,SQLServer Express 2008R2 installation on Windows Server 2008,"I have installed Windows Server 2008R2x64 under VMWare Workstation, to test installation of my application.  I then installed the .Net 4.0 distributables and then SQLServer Express 2008R2 Sp1 (SQLEXPRWT_x64_ENU.exe from http://www.microsoft.com/download/en/details.aspx?id=22973).  I accepted all defaults and including the default instance SQLExpress.

When I can start the management console, SQLEXpress is not available as an instance.

In Administrative Tools > Services, SQL Server is running, with instance SQLServer.  I have enabled the Agent and Browser services.

This is killing me as I need to install at a customer site on Monday...

Any ideas?",sql-server-2008,installation,windows-server-2008-r2,,,,open,0,91,8,"SQLServer Express 2008R2 installation on Windows Server 2008 I have installed Windows Server 2008R2x64 under VMWare Workstation, to test installation of my application.  I then installed the .Net 4.0 distributables and then SQLServer Express 2008R2 Sp1 (SQLEXPRWT_x64_ENU.exe from http://www.microsoft.com/download/en/details.aspx?id=22973).  I accepted all defaults and including the default instance SQLExpress.

When I can start the management console, SQLEXpress is not available as an instance.

In Administrative Tools > Services, SQL Server is running, with instance SQLServer.  I have enabled the Agent and Browser services.

This is killing me as I need to install at a customer site on Monday...

Any ideas?",3
9878848,03/26/2012 19:57:33,139618,07/16/2009 16:17:44,623,7,SQL Server 2008 Sum and Select Max Only?,"I am trying to understand how to do a Sum when I need to only use the Max/top values for a date period. This is kind of like http://stackoverflow.com/questions/7118170/sql-server-select-only-the-rows-with-maxdate but not exactly. Thanks for reading.





    declare @tbl Table ( tableid int , eventdate date,  valuec char(5) , valued int , recordedwhen datetime2(3) )
    insert into @tbl values ( 0 , '2012-03-22' , '11111' , 3 , '2012-03-23 17:21:01.083' )
    insert into @tbl values ( 1 , '2012-03-22' , '22222' , 3 , '2012-03-23 17:21:01.083' )
    insert into @tbl values ( 2 , '2012-03-22' , '22222' , 4 , '2012-03-23 18:21:01.083' )
    insert into @tbl values ( 3 , '2012-03-22' , '22222' , 5 , '2012-03-23 18:21:01.083' )
    
    select 
    		eventdate, valuec , sum(valued) as valuedSum , recordedwhen
    		from 
    		@tbl
    		group by eventdate, valuec, recordedwhen

I get three rows. But what I actually want is this:

    --   
    --   eventdate  valuec valuedSum   recordedwhen
    --   ---------- ------ ----------- ----------------------
    --   2012-03-22 11111  3           2012-03-23 17:21:01.08
    --   2012-03-22 22222  9           2012-03-23 18:21:01.08


I do not want the row where tableid=1 because that is part of an older batch of data.
The newer rows represent a later insert (all recordedwhen values with the same datetime are the same for a batch)

So if a new row was inserted like this:


    insert into @tbl values ( 4 , '2012-03-22' , '22222' , 6 , '2012-03-24 18:21:01.083' )

Then the data would should like this:

    --   eventdate  valuec valuedSum   recordedwhen
    --   ---------- ------ ----------- ----------------------
    --   2012-03-22 11111  3           2012-03-23 17:21:01.08
    --   2012-03-22 22222  6           2012-03-24 18:21:01.08

",sql-server-2008,max,row-number,,,,open,0,390,8,"SQL Server 2008 Sum and Select Max Only? I am trying to understand how to do a Sum when I need to only use the Max/top values for a date period. This is kind of like http://stackoverflow.com/questions/7118170/sql-server-select-only-the-rows-with-maxdate but not exactly. Thanks for reading.





    declare @tbl Table ( tableid int , eventdate date,  valuec char(5) , valued int , recordedwhen datetime2(3) )
    insert into @tbl values ( 0 , '2012-03-22' , '11111' , 3 , '2012-03-23 17:21:01.083' )
    insert into @tbl values ( 1 , '2012-03-22' , '22222' , 3 , '2012-03-23 17:21:01.083' )
    insert into @tbl values ( 2 , '2012-03-22' , '22222' , 4 , '2012-03-23 18:21:01.083' )
    insert into @tbl values ( 3 , '2012-03-22' , '22222' , 5 , '2012-03-23 18:21:01.083' )
    
    select 
    		eventdate, valuec , sum(valued) as valuedSum , recordedwhen
    		from 
    		@tbl
    		group by eventdate, valuec, recordedwhen

I get three rows. But what I actually want is this:

    --   
    --   eventdate  valuec valuedSum   recordedwhen
    --   ---------- ------ ----------- ----------------------
    --   2012-03-22 11111  3           2012-03-23 17:21:01.08
    --   2012-03-22 22222  9           2012-03-23 18:21:01.08


I do not want the row where tableid=1 because that is part of an older batch of data.
The newer rows represent a later insert (all recordedwhen values with the same datetime are the same for a batch)

So if a new row was inserted like this:


    insert into @tbl values ( 4 , '2012-03-22' , '22222' , 6 , '2012-03-24 18:21:01.083' )

Then the data would should like this:

    --   eventdate  valuec valuedSum   recordedwhen
    --   ---------- ------ ----------- ----------------------
    --   2012-03-22 11111  3           2012-03-23 17:21:01.08
    --   2012-03-22 22222  6           2012-03-24 18:21:01.08

",3
7423084,09/14/2011 21:16:34,941418,09/12/2011 21:43:49,311,17,What could cause SSMS to not parse SQL properly?,"This is the darndest thing I've ever seen.

I created a proc from a template that uses `SYSNAME` as the parameter types. All portions of the proc that took the name from the parameter are throwing errors. Here is a sample:

    IF EXISTS(select 1 from sysobjects where name=N'dbo.ms_lst_partner_break_types' and xtype='p')
    BEGIN
	PRINT 'DROP PROCEDURE dbo.ms_lst_partner_break_types'
	DROP PROCEDURE dbo.ms_lst_partner_break_types
    END

Here is the error:

`Msg 102, Level 15, State 1, Line 4
Incorrect syntax near '_partner_break_types'.`

The weirdest thing is that when I double click on `dbo.ms_lst_partner_break_types` SSMS highlights either `ms_lst` or `_partner_break_types` depending on where I click. Copy the script into Textpad and back, same problem. Remove `_partner_break_types` and suddenly it works.

Does anyone have any idea what gives?


",sql-server-2008,ssms,,,,09/14/2011 23:33:54,too localized,1,120,9,"What could cause SSMS to not parse SQL properly? This is the darndest thing I've ever seen.

I created a proc from a template that uses `SYSNAME` as the parameter types. All portions of the proc that took the name from the parameter are throwing errors. Here is a sample:

    IF EXISTS(select 1 from sysobjects where name=N'dbo.ms_lst_partner_break_types' and xtype='p')
    BEGIN
	PRINT 'DROP PROCEDURE dbo.ms_lst_partner_break_types'
	DROP PROCEDURE dbo.ms_lst_partner_break_types
    END

Here is the error:

`Msg 102, Level 15, State 1, Line 4
Incorrect syntax near '_partner_break_types'.`

The weirdest thing is that when I double click on `dbo.ms_lst_partner_break_types` SSMS highlights either `ms_lst` or `_partner_break_types` depending on where I click. Copy the script into Textpad and back, same problem. Remove `_partner_break_types` and suddenly it works.

Does anyone have any idea what gives?


",2
8584547,12/21/2011 02:53:01,422719,08/17/2010 10:14:11,101,1,"SQL Server 2008 New database, tables lost","I created a new database in SQL server 2008. Then I added tables by using a script
After I restart the SQL Server, the tables are lost.

What could be the issue?",sql-server-2008,,,,,12/21/2011 09:19:56,not a real question,1,30,7,"SQL Server 2008 New database, tables lost I created a new database in SQL server 2008. Then I added tables by using a script
After I restart the SQL Server, the tables are lost.

What could be the issue?",1
5846149,05/01/2011 03:04:25,339518,05/12/2010 16:20:26,111,3,"AES_256 same value to encrypt, different encryption results","I am just starting to work with native encryption in SQL Server, and I have observed something I am hoping someone here can shed some light on.

I'm using AES_256 encryption, and in reviewing the encrypted result, I have noticed that the same value in different rows will have a different encrypted result.  Here is a sample where I have encrypted an nvarchar(50) with a value of xxx and I get the follow encrypted result:

    xxx	0x008C6C289DE9BE42AA47EC9F2022DCC401000000657FCB75FD4C63F63249A0BCA716CB384E79B84E3D862EC41C6A4A491C64658A
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC4010000004BE3C369FFD523110CAA3A957FC4A7820F779ADB8882A0A33A53DF480FE797A8
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC40100000002288512DFB126BC6E17320217629365478B48691E62863B9A08E3772EFA7486
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC40100000076223FB6D568E210D6D07AA9BFEDB991D46EF64187F2A31AEF96A5F61FE722A3
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC401000000E90AFB7EBA5B445CCAD9E6CC94966DC66B86557F2CD5E3E1FB68F308FA5F2952

I've been searching around but have not found an answer yet.  Anybody know why this occurs?

Thanks.
",sql-server-2008,encryption,encryption-symmetric,aes,,,open,0,95,8,"AES_256 same value to encrypt, different encryption results I am just starting to work with native encryption in SQL Server, and I have observed something I am hoping someone here can shed some light on.

I'm using AES_256 encryption, and in reviewing the encrypted result, I have noticed that the same value in different rows will have a different encrypted result.  Here is a sample where I have encrypted an nvarchar(50) with a value of xxx and I get the follow encrypted result:

    xxx	0x008C6C289DE9BE42AA47EC9F2022DCC401000000657FCB75FD4C63F63249A0BCA716CB384E79B84E3D862EC41C6A4A491C64658A
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC4010000004BE3C369FFD523110CAA3A957FC4A7820F779ADB8882A0A33A53DF480FE797A8
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC40100000002288512DFB126BC6E17320217629365478B48691E62863B9A08E3772EFA7486
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC40100000076223FB6D568E210D6D07AA9BFEDB991D46EF64187F2A31AEF96A5F61FE722A3
xxx	0x008C6C289DE9BE42AA47EC9F2022DCC401000000E90AFB7EBA5B445CCAD9E6CC94966DC66B86557F2CD5E3E1FB68F308FA5F2952

I've been searching around but have not found an answer yet.  Anybody know why this occurs?

Thanks.
",4
7680409,10/06/2011 21:01:51,353442,05/29/2010 06:20:34,937,42,Create a new SQL Server which has a period in the name,"I apologize if this is a repost but I didn't find exactly what I needed.

I'm running SQL Server 2008 Developer edition on my machine. I've tried dropping my old server (which was the name of my machine) and adding my new one such that <code>select @@servername</code> returns the new name 'test.k5'. However, I can't connect to this inside the management studio. Is there something I'm missing?

Or is there a much better approach to doing this?",sql-server-2008,,,,,11/20/2011 01:07:37,off topic,1,75,12,"Create a new SQL Server which has a period in the name I apologize if this is a repost but I didn't find exactly what I needed.

I'm running SQL Server 2008 Developer edition on my machine. I've tried dropping my old server (which was the name of my machine) and adding my new one such that <code>select @@servername</code> returns the new name 'test.k5'. However, I can't connect to this inside the management studio. Is there something I'm missing?

Or is there a much better approach to doing this?",1
10092779,04/10/2012 16:35:20,917964,08/29/2011 14:06:23,18,0,connecting to sql server from classic asp,"I have a sql server 2008R2 express running in windows authentication mode. I created a login and a user for a database in sql server based on a windows account. I can connect to sql server database via(run as the user) SSMS and browse my database just fine. 

Now i am trying to connect via a 3rd party asp application 

set loginDB = Server.CreateObject(""ADODB.Connection"")

'For Windows Server 2008 / SQL 2008 users, please use the following line for the DB connection

loginDB.Open ""Provider=SQLNCLI10; Server=(local)\SQLServerName; Database=dbname;Uid=""myuser"" Pwd=""pwd""""

I am getting an error saying login failed for user myuser

Also the site is running on an app pool which i have set it to run as the windows user myuser.

Where am i going wrong???

Thanks.

",sql-server-2008,asp-classic,,,,,open,0,118,7,"connecting to sql server from classic asp I have a sql server 2008R2 express running in windows authentication mode. I created a login and a user for a database in sql server based on a windows account. I can connect to sql server database via(run as the user) SSMS and browse my database just fine. 

Now i am trying to connect via a 3rd party asp application 

set loginDB = Server.CreateObject(""ADODB.Connection"")

'For Windows Server 2008 / SQL 2008 users, please use the following line for the DB connection

loginDB.Open ""Provider=SQLNCLI10; Server=(local)\SQLServerName; Database=dbname;Uid=""myuser"" Pwd=""pwd""""

I am getting an error saying login failed for user myuser

Also the site is running on an app pool which i have set it to run as the windows user myuser.

Where am i going wrong???

Thanks.

",2
7799316,10/17/2011 20:40:37,999931,10/17/2011 20:31:23,1,0,SQL 2008 R2 Business Intelligence Issue,"I have installed SQL Server 2008 R2 64 bit. Integration Service in running. When I open and try to create a Integration Services Project, It gives me the following message - Microsoft Visual Studio is unable to load this document.
To Design Integration Services packages in Business Intelligence Development Studio(BIDS), BIDS has to be installed by one of these editions of SQL Server 2008 R2: Standard, Enterprise, Developer, or Evaluation. To install BIDS, run SQL Server Setup and select Business Intelligence Development Studio.

Has anyone experienced this issue? I googled a lot for solution but no luck.

Thanks in advance.

OS - Windows 2008 64-bit",sql-server-2008,,,,,10/17/2011 22:52:10,off topic,1,101,6,"SQL 2008 R2 Business Intelligence Issue I have installed SQL Server 2008 R2 64 bit. Integration Service in running. When I open and try to create a Integration Services Project, It gives me the following message - Microsoft Visual Studio is unable to load this document.
To Design Integration Services packages in Business Intelligence Development Studio(BIDS), BIDS has to be installed by one of these editions of SQL Server 2008 R2: Standard, Enterprise, Developer, or Evaluation. To install BIDS, run SQL Server Setup and select Business Intelligence Development Studio.

Has anyone experienced this issue? I googled a lot for solution but no luck.

Thanks in advance.

OS - Windows 2008 64-bit",1
11355457,07/06/2012 03:31:57,1338080,04/17/2012 07:20:29,1,0,SQL Server 2008 R2 Express Edition backup restore limits?,"i have a database (sql server 2008 standard) and the data stored is 100gb+. my question is, is it possible to restore the backup from my server to a test workstation (just in case something happens to my server, atleast i have a backup) with sql server 2008 r2 express edition installed? i am wondering if it is possible 'cause i know express editions have limitations. Thanks for any comments or advice.",sql-server-2008,,,,,07/07/2012 15:55:40,not a real question,1,72,9,"SQL Server 2008 R2 Express Edition backup restore limits? i have a database (sql server 2008 standard) and the data stored is 100gb+. my question is, is it possible to restore the backup from my server to a test workstation (just in case something happens to my server, atleast i have a backup) with sql server 2008 r2 express edition installed? i am wondering if it is possible 'cause i know express editions have limitations. Thanks for any comments or advice.",1
7663812,10/05/2011 15:31:21,980664,10/05/2011 15:18:36,1,0,How to drop and create a table with DB permissions?,"I am having to move a table from one DB to another.  Both databases have the same roles and permissions.   This table has CRUD rights ( INSERT, SELECT, UPDATE, DELETE ) permissions for 2 rolls and 6 users.

I can generate a script that drops my table and then creates it, but how do I generate a script that will also grant permission for the table I am dropping? 

( In fact, regardless of me dropping the table, how would one generate a script to reassign permissions on a table )

Of course I can manually create the INSERT, SELECT, UPDATE, DELETE script for each roll and each user, but there is not a snapper way to just saying...  Generate permission script for TableX?

NOTE:  This is not the first time I had to find the permissions on each table before either..

Any help would be great.",sql-server-2008,scripting,database-permissions,,,11/16/2011 10:09:16,off topic,1,148,10,"How to drop and create a table with DB permissions? I am having to move a table from one DB to another.  Both databases have the same roles and permissions.   This table has CRUD rights ( INSERT, SELECT, UPDATE, DELETE ) permissions for 2 rolls and 6 users.

I can generate a script that drops my table and then creates it, but how do I generate a script that will also grant permission for the table I am dropping? 

( In fact, regardless of me dropping the table, how would one generate a script to reassign permissions on a table )

Of course I can manually create the INSERT, SELECT, UPDATE, DELETE script for each roll and each user, but there is not a snapper way to just saying...  Generate permission script for TableX?

NOTE:  This is not the first time I had to find the permissions on each table before either..

Any help would be great.",3
6512133,06/28/2011 19:35:29,819850,06/28/2011 19:35:29,1,0,mssql in c# -- looking for a better way,"SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
	case-- Market
		WHEN Market < LiFo AND Market < Wgtd_Avg THEN Market
		WHEN LiFo < Wgtd_Avg THEN LiFo
		ELSE Wgtd_Avg
	end
 as LeastOfThree
FROM VF_CasINV_Cost
--WHERE Market > 0 and LiFo >0 and Wgtd_Avg > 0

SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
(
	case
		WHEN LiFo < Wgtd_Avg THEN LiFo
		ELSE Wgtd_Avg
	end
) as LeastOfThree
FROM VF_CasINV_Cost
WHERE LiFo >0 and Wgtd_Avg > 0 and (Market = 0)

SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
(
	case
		WHEN Wgtd_Avg < Market THEN Wgtd_Avg
		ELSE Market
	end
) as LeastOfThree
FROM VF_CasINV_Cost
WHERE Market >0 and Wgtd_Avg > 0 and (LiFo = 0)

SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
(
	case
		WHEN LiFo < Market THEN LiFo
		ELSE Market
	end
) as LeastOfThree
FROM VF_CasINV_Cost
WHERE Market > 0 and LiFo > 0 and Wgtd_Avg = 0-- and (LeastOfThree = 0)
",sql-server-2008,,,,,06/29/2011 11:53:37,not a real question,1,108,9,"mssql in c# -- looking for a better way SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
	case-- Market
		WHEN Market < LiFo AND Market < Wgtd_Avg THEN Market
		WHEN LiFo < Wgtd_Avg THEN LiFo
		ELSE Wgtd_Avg
	end
 as LeastOfThree
FROM VF_CasINV_Cost
--WHERE Market > 0 and LiFo >0 and Wgtd_Avg > 0

SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
(
	case
		WHEN LiFo < Wgtd_Avg THEN LiFo
		ELSE Wgtd_Avg
	end
) as LeastOfThree
FROM VF_CasINV_Cost
WHERE LiFo >0 and Wgtd_Avg > 0 and (Market = 0)

SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
(
	case
		WHEN Wgtd_Avg < Market THEN Wgtd_Avg
		ELSE Market
	end
) as LeastOfThree
FROM VF_CasINV_Cost
WHERE Market >0 and Wgtd_Avg > 0 and (LiFo = 0)

SELECT Market, LiFo, Wgtd_Avg, LeastOfThree,
(
	case
		WHEN LiFo < Market THEN LiFo
		ELSE Market
	end
) as LeastOfThree
FROM VF_CasINV_Cost
WHERE Market > 0 and LiFo > 0 and Wgtd_Avg = 0-- and (LeastOfThree = 0)
",1
10847934,06/01/2012 09:41:14,1428275,05/31/2012 11:32:19,6,0,Shortcut key to modify stored procedure in ssms,"In SQL Server Management Studio,  
Object Explorer Details where Stored Procedure Listing shows, 
I want here to press a shortcut key on any stored procedure to open its modify window.  ",sql-server-2008,,,,,06/02/2012 16:23:54,not a real question,1,33,8,"Shortcut key to modify stored procedure in ssms In SQL Server Management Studio,  
Object Explorer Details where Stored Procedure Listing shows, 
I want here to press a shortcut key on any stored procedure to open its modify window.  ",1
9704401,03/14/2012 14:57:17,1245733,03/02/2012 18:22:04,4,0,SSAS CUBE is getting processed endlessly,"Let me introduce my self  . I am Rajesh  working as BI Developer in a MNC . We are facing a problem during SSAS cube processing  .


The below is the brief  summary  about the problem  .

I am working on project , where we are running  SSAS  cube to populate the data in to cube . But the cube process  is not being completed even after  13 hours   . Normally the cube process would take  3 hours  but after new DB design the cube is taking  more than  13 hours . After 2 hours  the message that displayed   was as below 
“Finished  Building Aggregations  for <factname> “ , after this message was displayed I can’t see any activity in SQL Profiler
and it continued to display the same  message even after 13  hours .. No processing activity  is getting displayed in Profiler after getting that message . But the cube  is getting processed  endlessly . 
 
 I didn't get  enough info about this error over web. I also tried to increase the ""ThreadPool\Process\MaxThreads""   but it already  set 240 from 64 which is default . The below is the configuration of our sever .

1)OS :Windows Server 2008 R2 64 bit 
2)Ram : 32 GB  
3)Processor :Intel Xeon Cpu  with more than 15 processors 

we greatly  appreciate  your suggestions on this  .  Please spare a few minutes of your time in replying .

Thanks  a lot in advance  
",sql-server-2008,sql-server-2008-r2,ssas,ssas-2008,,03/15/2012 01:07:41,not a real question,1,273,6,"SSAS CUBE is getting processed endlessly Let me introduce my self  . I am Rajesh  working as BI Developer in a MNC . We are facing a problem during SSAS cube processing  .


The below is the brief  summary  about the problem  .

I am working on project , where we are running  SSAS  cube to populate the data in to cube . But the cube process  is not being completed even after  13 hours   . Normally the cube process would take  3 hours  but after new DB design the cube is taking  more than  13 hours . After 2 hours  the message that displayed   was as below 
“Finished  Building Aggregations  for <factname> “ , after this message was displayed I can’t see any activity in SQL Profiler
and it continued to display the same  message even after 13  hours .. No processing activity  is getting displayed in Profiler after getting that message . But the cube  is getting processed  endlessly . 
 
 I didn't get  enough info about this error over web. I also tried to increase the ""ThreadPool\Process\MaxThreads""   but it already  set 240 from 64 which is default . The below is the configuration of our sever .

1)OS :Windows Server 2008 R2 64 bit 
2)Ram : 32 GB  
3)Processor :Intel Xeon Cpu  with more than 15 processors 

we greatly  appreciate  your suggestions on this  .  Please spare a few minutes of your time in replying .

Thanks  a lot in advance  
",4
10447465,05/04/2012 10:56:00,225566,12/05/2009 22:01:35,573,8,Where to order a result set randomly - in database or in memory?,"Data source will contain approx. 5000 records. 
I know that it is possible to order data randomly with `orderby newid()`. But data to be sorted should be paged. That means page n can not contain records from previous pages (n-1, n-2 etc). Now I think I have 2 ways to go: ordering in database, or in memory (because 5000 records is small enough to hold it in in-memory cache).

For option 1 (sorting in db) I am not sure if it's possible because data should be paged. Is it possible if yes how? For option 2, are there any good algorithms (good is performant and ) to order data in memory ? How would you go in this scenario: ordering in memory or in database, why?",sql-server-2008,random,ordering,in-memory,,,open,0,125,13,"Where to order a result set randomly - in database or in memory? Data source will contain approx. 5000 records. 
I know that it is possible to order data randomly with `orderby newid()`. But data to be sorted should be paged. That means page n can not contain records from previous pages (n-1, n-2 etc). Now I think I have 2 ways to go: ordering in database, or in memory (because 5000 records is small enough to hold it in in-memory cache).

For option 1 (sorting in db) I am not sure if it's possible because data should be paged. Is it possible if yes how? For option 2, are there any good algorithms (good is performant and ) to order data in memory ? How would you go in this scenario: ordering in memory or in database, why?",4
8172017,11/17/2011 18:01:06,1040277,11/10/2011 17:41:23,6,0,How to use field value to determine join in Stored Procedure?,"I need to query a Counts table to see what type of user it is before I determine what table to join to in order to get the username.  Table options and user types are Staff or Student. I also need three other values from the Counts table. I don't need the user type in the output. Right now i have 3 different queries that return the info I need but I don't know how to put it all together in one Stored Procedure. By the way this is with a linked server. This is what I have individually that returns what I need:

    --For staff 
    Select * from OPENQUERY (PORTAL,
    'SELECT st.last AS ""Last Name"", st.first AS ""First Name"", ct.Document,ct.PageCount,
     ct.Date
    FROM printer_stats.Counts ct
	INNER JOIN dv.staff st on st.id = ct.UserID
    WHERE ct.UserType = ""Staff"" and
    ct.DATE >= ""2011-08-15"" and ct.DeviceID = 3859
    ORDER BY ct.Date, st.last, st.first')

    --For Student
    Select * from OPENQUERY (PORTAL,
    'SELECT stu.last_name AS ""Last Name"", stu.first_name AS ""First Name"", ct.Document, 
    ct.PageCount, ct.Date
    FROM printer_stats.Counts ct
	INNER JOIN dv.student stu on stu.username = ct.username
    WHERE ct.UserType = ""Student"" and
	ct.DATE >= ""2011-08-15"" and ct.DeviceID = 2478
    ORDER BY ct.Date, stu.last_name, stu.first_name')

    --For Guest
    Select * from OPENQUERY (PORTAL,
    'SELECT ""Guest"" AS ""Last Name"", ""Guest"" AS ""First Name"", ct.Document, ct.PageCount,
    ct.Date
    FROM printer_stats.Counts ct
    WHERE ct.UserType = ""Guest"" and
	ct.DATE >= ""2011-08-15"" and ct.DeviceID = 1198
    ORDER BY ct.DeviceID')
    
 I will be passing in the values for ""ct.Date >="" and the ""ct.DeviceID"" as parameters. Hard coded for testing. 
Not sure how to start... with a IF or a Case or how do I know the value of the UserType field in order to proceed?? since it is in the Where clause in these examples. 
 ",sql-server-2008,,,,,12/17/2011 01:51:41,not a real question,1,361,11,"How to use field value to determine join in Stored Procedure? I need to query a Counts table to see what type of user it is before I determine what table to join to in order to get the username.  Table options and user types are Staff or Student. I also need three other values from the Counts table. I don't need the user type in the output. Right now i have 3 different queries that return the info I need but I don't know how to put it all together in one Stored Procedure. By the way this is with a linked server. This is what I have individually that returns what I need:

    --For staff 
    Select * from OPENQUERY (PORTAL,
    'SELECT st.last AS ""Last Name"", st.first AS ""First Name"", ct.Document,ct.PageCount,
     ct.Date
    FROM printer_stats.Counts ct
	INNER JOIN dv.staff st on st.id = ct.UserID
    WHERE ct.UserType = ""Staff"" and
    ct.DATE >= ""2011-08-15"" and ct.DeviceID = 3859
    ORDER BY ct.Date, st.last, st.first')

    --For Student
    Select * from OPENQUERY (PORTAL,
    'SELECT stu.last_name AS ""Last Name"", stu.first_name AS ""First Name"", ct.Document, 
    ct.PageCount, ct.Date
    FROM printer_stats.Counts ct
	INNER JOIN dv.student stu on stu.username = ct.username
    WHERE ct.UserType = ""Student"" and
	ct.DATE >= ""2011-08-15"" and ct.DeviceID = 2478
    ORDER BY ct.Date, stu.last_name, stu.first_name')

    --For Guest
    Select * from OPENQUERY (PORTAL,
    'SELECT ""Guest"" AS ""Last Name"", ""Guest"" AS ""First Name"", ct.Document, ct.PageCount,
    ct.Date
    FROM printer_stats.Counts ct
    WHERE ct.UserType = ""Guest"" and
	ct.DATE >= ""2011-08-15"" and ct.DeviceID = 1198
    ORDER BY ct.DeviceID')
    
 I will be passing in the values for ""ct.Date >="" and the ""ct.DeviceID"" as parameters. Hard coded for testing. 
Not sure how to start... with a IF or a Case or how do I know the value of the UserType field in order to proceed?? since it is in the Where clause in these examples. 
 ",1
3166952,07/02/2010 15:11:17,316959,04/14/2010 21:17:19,421,11,How to return values from a dynamic sql stored procedure?,"I have a stored proc which basically executes a dynamic sql.I want to although use this stored proc in my entity framework 4...so when i try to create a complex type...it shows that the procedure returns no columns...so is there any way i can force this procedure to return my values and get the entity framework to get it...Here is contrived example of what I want to do-

    CREATE PROCEDURE sp_calculatesalary(@EmployeeId as int)
    begin
    declare dynsql as varachar(500)
    @dynsql='Select @Salary=Salary,@UserName=Username from employee where EmployeeId='+cast(@EmployeeId as varchar)+ ''
    exec(@dynsql)
    select @Salary,@UserName
end

But this does not work...Please help me out....I want to use basically a stored procedure executing dynamic sql in entity framework and get the returned values",sql-server-2008,stored-procedures,return-value,entity-framework-4,,,open,0,133,10,"How to return values from a dynamic sql stored procedure? I have a stored proc which basically executes a dynamic sql.I want to although use this stored proc in my entity framework 4...so when i try to create a complex type...it shows that the procedure returns no columns...so is there any way i can force this procedure to return my values and get the entity framework to get it...Here is contrived example of what I want to do-

    CREATE PROCEDURE sp_calculatesalary(@EmployeeId as int)
    begin
    declare dynsql as varachar(500)
    @dynsql='Select @Salary=Salary,@UserName=Username from employee where EmployeeId='+cast(@EmployeeId as varchar)+ ''
    exec(@dynsql)
    select @Salary,@UserName
end

But this does not work...Please help me out....I want to use basically a stored procedure executing dynamic sql in entity framework and get the returned values",4
962295,06/07/2009 16:56:11,48266,12/22/2008 04:34:32,535,33,Installing TFS 08 with SQL Server 2008,"I realize that this question has been asked and has been answered [here][1] but I am having problems with the slip stream approach and I'm hoping someone else has run into it. I've tried downloading the newest installation guide but the help file appears to be corrupt as it won't open any of the pages so I'm a bit in the dark here.

I rigorously followed the [TFS SP 1 slipstream installation instructions][2] but I am running into an error coded TF220059. The error explicitly states: 

> TF220059: An error occurred while the Setup program was querying the installation settings for Team Foundation Server. For more information about this error, see the installation logs. For more information about the installation logs, see ""Troubleshooting Installation for Team Foundation"" in the Team Foundation Installation Guide.

which has me confused because as far as I can tell, no one else ran into this while slipstreaming. The results from the error log can be found [here][3]. It's claiming that the accounts aren't specified but I created them as specified in [this TFS install guide][4]. It is a single server install so there is not a domain controller involved.

Any help would be **greatly** appreciated, I've been banging my head against the desk over this. Thanks!

  [1]: http://stackoverflow.com/questions/32597/installing-team-foundation-server/39208#39208
  [2]: http://www.woodwardweb.com/vsts/000444.html
  [3]: http://pastebin.com/m296fb909
  [4]: http://blogs.vertigosoftware.com/teamsystem/archive/2006/04/04/2512.aspx",sql-server-2008,tfs,,,,,open,0,220,7,"Installing TFS 08 with SQL Server 2008 I realize that this question has been asked and has been answered [here][1] but I am having problems with the slip stream approach and I'm hoping someone else has run into it. I've tried downloading the newest installation guide but the help file appears to be corrupt as it won't open any of the pages so I'm a bit in the dark here.

I rigorously followed the [TFS SP 1 slipstream installation instructions][2] but I am running into an error coded TF220059. The error explicitly states: 

> TF220059: An error occurred while the Setup program was querying the installation settings for Team Foundation Server. For more information about this error, see the installation logs. For more information about the installation logs, see ""Troubleshooting Installation for Team Foundation"" in the Team Foundation Installation Guide.

which has me confused because as far as I can tell, no one else ran into this while slipstreaming. The results from the error log can be found [here][3]. It's claiming that the accounts aren't specified but I created them as specified in [this TFS install guide][4]. It is a single server install so there is not a domain controller involved.

Any help would be **greatly** appreciated, I've been banging my head against the desk over this. Thanks!

  [1]: http://stackoverflow.com/questions/32597/installing-team-foundation-server/39208#39208
  [2]: http://www.woodwardweb.com/vsts/000444.html
  [3]: http://pastebin.com/m296fb909
  [4]: http://blogs.vertigosoftware.com/teamsystem/archive/2006/04/04/2512.aspx",2
1867905,12/08/2009 15:59:38,77775,03/13/2009 15:44:24,198,7,SQL 2008 geography & geometry - which to use?,"I'm creating a Google map mashup and am using SQL 2008.

I will have a large number of points on the earth and will want to perform various calculations on them in SQL - such as selecting all points contained within a particular polygone, or select all points within 10km of XY.

I have never used and SQL spatial features before. Should I use the `geography` or the `geometry` datatype for this?

",sql-server-2008,geospatial,geometry,geography,,,open,0,70,9,"SQL 2008 geography & geometry - which to use? I'm creating a Google map mashup and am using SQL 2008.

I will have a large number of points on the earth and will want to perform various calculations on them in SQL - such as selecting all points contained within a particular polygone, or select all points within 10km of XY.

I have never used and SQL spatial features before. Should I use the `geography` or the `geometry` datatype for this?

",4
11509248,07/16/2012 17:16:00,1529515,07/16/2012 16:38:12,1,1,"How to Insert a value multiple times in oracle database "" But ""?","Am facing this problem , i want to insert ""a Record to DataBase"" multiple times but the user who had to determined the number of the record to be saved  !!

For Example : 

in the Questioner many Forms Has the same Result on their Fields So the user should Enter it one time And Say how many forms he have , has the same Data ,,, to insert them to the database ",sql-server-2008,,,,,07/17/2012 17:29:50,not a real question,1,74,13,"How to Insert a value multiple times in oracle database "" But ""? Am facing this problem , i want to insert ""a Record to DataBase"" multiple times but the user who had to determined the number of the record to be saved  !!

For Example : 

in the Questioner many Forms Has the same Result on their Fields So the user should Enter it one time And Say how many forms he have , has the same Data ,,, to insert them to the database ",1
11456330,07/12/2012 16:25:31,1480322,06/25/2012 14:44:14,1,0,Active/Passive to Active/Active,"All i have is this one line information which was conveyed in a discussion between a Project Manager and a DBA. If you understand what they really mean would you please care to explain in layman terms on what does it mean and how to achieve ""Active/Active""?

--Statement made--
We currently have an ""Active/Passive"" setup which isn't efficiently making use of the hardware so we need to make it as ""Active/Active"".",sql-server-2008,,,,,07/12/2012 17:06:57,off topic,1,69,3,"Active/Passive to Active/Active All i have is this one line information which was conveyed in a discussion between a Project Manager and a DBA. If you understand what they really mean would you please care to explain in layman terms on what does it mean and how to achieve ""Active/Active""?

--Statement made--
We currently have an ""Active/Passive"" setup which isn't efficiently making use of the hardware so we need to make it as ""Active/Active"".",1
8700699,01/02/2012 12:16:55,422737,08/17/2010 10:37:37,13,0,MissingEndpointException: The attempt to connect to the report server failed.,"i get this error when i try connecting generating report 
MissingEndpointException: The attempt to connect to the report server failed.  Check your connection information and that the report server is a compatible version.",sql-server-2008,,,,,,open,0,34,10,"MissingEndpointException: The attempt to connect to the report server failed. i get this error when i try connecting generating report 
MissingEndpointException: The attempt to connect to the report server failed.  Check your connection information and that the report server is a compatible version.",1
10811441,05/30/2012 07:01:57,591559,01/27/2011 01:06:58,645,17,Using Stored procedure to insert data from selection,"I need to insert data into another table using stored procedure. The stored procedure might be something like :

use db;
CREATE PROCEDURE T.countnum
AS
Insert into T1 values(select count(*) from T.countTable)
go

But it isn't working I saw several example but not with selection. Any example?",sql-server-2008,sql-server-2005,,,,,open,0,41,8,"Using Stored procedure to insert data from selection I need to insert data into another table using stored procedure. The stored procedure might be something like :

use db;
CREATE PROCEDURE T.countnum
AS
Insert into T1 values(select count(*) from T.countTable)
go

But it isn't working I saw several example but not with selection. Any example?",2
6442146,06/22/2011 15:09:45,13064,09/16/2008 16:53:08,191,7,Comparing values of 2 tables and listing the rows that are different,"This question is in the same vein as [this question](http://stackoverflow.com/questions/4602083/sql-compare-data-from-two-tables/4604221#comment-7562192), but just slightly different.

I have 2 tables, TableA and TableB where TableB is really just a backup of TableA, the only real difference is that TableB has an ""ACTION"" column that indicates the action that had been taken in TableA. For now I am ignoring that column (although ideally I would want it appended to the final results, so please feel free to suggest on that too :D )

I want to compare the two tables and get the rows from each table that are different. I've used [Jeff's SQL Server Blog - The shortest, fastest, and easiest way to compare two tables in SQL Server: UNION !](http://weblogs.sqlteam.com/jeffs/archive/2004/11/10/2737.aspx) example to create a query, however, it returns only the rows from TableB that are different. 

What is the recommended approach?

*Note: the code is exactly like the example in the second link, so I won't post any of it here*",sql-server-2008,,,,,,open,0,157,12,"Comparing values of 2 tables and listing the rows that are different This question is in the same vein as [this question](http://stackoverflow.com/questions/4602083/sql-compare-data-from-two-tables/4604221#comment-7562192), but just slightly different.

I have 2 tables, TableA and TableB where TableB is really just a backup of TableA, the only real difference is that TableB has an ""ACTION"" column that indicates the action that had been taken in TableA. For now I am ignoring that column (although ideally I would want it appended to the final results, so please feel free to suggest on that too :D )

I want to compare the two tables and get the rows from each table that are different. I've used [Jeff's SQL Server Blog - The shortest, fastest, and easiest way to compare two tables in SQL Server: UNION !](http://weblogs.sqlteam.com/jeffs/archive/2004/11/10/2737.aspx) example to create a query, however, it returns only the rows from TableB that are different. 

What is the recommended approach?

*Note: the code is exactly like the example in the second link, so I won't post any of it here*",1
6954717,08/05/2011 10:11:29,838313,07/11/2011 06:17:10,56,2,Is their any difference between Sql server and Oracle,"As i know about Both Sqlserver and Oracle are Database Systems.
1. In case of Sql server, we can work with multiple databases at once.
 

Is their any other difference between oracle and sql server.",sql-server-2008,oracle10g,,,,08/05/2011 10:30:35,not constructive,1,34,9,"Is their any difference between Sql server and Oracle As i know about Both Sqlserver and Oracle are Database Systems.
1. In case of Sql server, we can work with multiple databases at once.
 

Is their any other difference between oracle and sql server.",2
8539204,12/16/2011 19:30:18,757483,05/17/2011 13:53:47,752,66,MS SQL - Converting 13 digit numeric to datetime,"How can I convert a 13 digit numeric like 1314637182953 to datetime in MS SQL? Both casting and converting directly give an arithmetic overflow error! Same result with the query below:


    select Convert(datetime, cast(START_DATE as varchar(8)), 112), 
    * from table

",sql-server-2008,,,,,,open,0,47,9,"MS SQL - Converting 13 digit numeric to datetime How can I convert a 13 digit numeric like 1314637182953 to datetime in MS SQL? Both casting and converting directly give an arithmetic overflow error! Same result with the query below:


    select Convert(datetime, cast(START_DATE as varchar(8)), 112), 
    * from table

",1
7152358,08/22/2011 19:13:48,577979,01/17/2011 02:06:29,111,10,Login in two website at the same time,"I've created 2 website.   
Both website have their own database. but there is a user table in both website that have exactly the same values. What I want to do is make something that can help when one of the user logged-in in website one it automatically login to website tow as well.  
Honesty I don't even know how to do it. I've tried to use extra page and login with session and javascript trick but most of the time its not working specially in IE.
By the way i'm using classic ASP and SQL 2008.

Any Idea?",sql-server-2008,asp,,,,,open,0,99,8,"Login in two website at the same time I've created 2 website.   
Both website have their own database. but there is a user table in both website that have exactly the same values. What I want to do is make something that can help when one of the user logged-in in website one it automatically login to website tow as well.  
Honesty I don't even know how to do it. I've tried to use extra page and login with session and javascript trick but most of the time its not working specially in IE.
By the way i'm using classic ASP and SQL 2008.

Any Idea?",2
10856167,06/01/2012 19:20:41,899055,08/17/2011 16:30:21,62,0,Performance Issues with DB Design and Heavy Data,"I asked the following question regarding DB Design and Performance issue in my application today.

http://stackoverflow.com/questions/10846340/db-design-and-data-retrieval-from-a-heavy-table/10846391#comment14126017_10846391

But, could not get much replies on that. I don't know, I may not have explained the question properly. Now, I have re-defined my question, hoping to get some suggestion from the experts.

I am facing performance issues while selecting data from a particular table. The business logic of the application is as following:
I have a number of import processes which result in creating pivot columns under their parent column names while showing them to the user. As the columns get pivoted, system takes time to convert rows into columns which results in slow performance.
The database tables related to this functionality are as following:
There can be N number of clients. CLT_Clients table stores client information.

There can be N number of projects associated to a client. PRJ_Projects table stores project information and a link to the client.

There can be N number of listings associated to a project. PRJ_Listings table stores listing information and a link to the project.

There can be N number of source entities associated to a listing. ST_Entities table stores source entity information and a link to the listing.

This source entity is the actual import that contains the InvestorID, position values, source date, active and formula status.

    The name of the import e.g. L1Entity1 is stored in ST_Entities table alongwith ID field i.e. EntityID
    InvestorID, Position, Source Date, Active and Formula values get stored in ST_Positions table 

Database Diagram
![DB Design][1]

Data need to be view as following:
![Data View][2]


With this design I’m able to handle N number of imports because the Position, Source Date, IsActive, Formula columns get Pivoted.

The problem that I’m facing with this design is that the system performs very slow when it has to select data for more than 10-12 source entities, and the requirement is to show about 150 source entities. Because data is not stored row wise and I need to show it column wise, hence dynamic queries are written to pivot these columns which takes long.

 

 **Ques 1:** Please comment/suggest on my current database design if it’s correct or need to be changed with the new design by taking 150 columns each for Position, Source Date, IsActive, Formula; In this new way data will already be stored in the way I need to retrieve in i.e. I’ll not have to pivot/unpivot it. But the downside is:

a) There are going to be more than 600 columns in this table?

b) There will be limit i.e. 150 on the source entities.

    
 **Ques 2:** If I need to stick to my current, what can be done to improve the performance?


  [1]: http://i.stack.imgur.com/IS9M9.jpg
  [2]: http://i.stack.imgur.com/MMIO9.jpg",sql-server-2008,database-design,query-optimization,database-performance,,,open,0,451,8,"Performance Issues with DB Design and Heavy Data I asked the following question regarding DB Design and Performance issue in my application today.

http://stackoverflow.com/questions/10846340/db-design-and-data-retrieval-from-a-heavy-table/10846391#comment14126017_10846391

But, could not get much replies on that. I don't know, I may not have explained the question properly. Now, I have re-defined my question, hoping to get some suggestion from the experts.

I am facing performance issues while selecting data from a particular table. The business logic of the application is as following:
I have a number of import processes which result in creating pivot columns under their parent column names while showing them to the user. As the columns get pivoted, system takes time to convert rows into columns which results in slow performance.
The database tables related to this functionality are as following:
There can be N number of clients. CLT_Clients table stores client information.

There can be N number of projects associated to a client. PRJ_Projects table stores project information and a link to the client.

There can be N number of listings associated to a project. PRJ_Listings table stores listing information and a link to the project.

There can be N number of source entities associated to a listing. ST_Entities table stores source entity information and a link to the listing.

This source entity is the actual import that contains the InvestorID, position values, source date, active and formula status.

    The name of the import e.g. L1Entity1 is stored in ST_Entities table alongwith ID field i.e. EntityID
    InvestorID, Position, Source Date, Active and Formula values get stored in ST_Positions table 

Database Diagram
![DB Design][1]

Data need to be view as following:
![Data View][2]


With this design I’m able to handle N number of imports because the Position, Source Date, IsActive, Formula columns get Pivoted.

The problem that I’m facing with this design is that the system performs very slow when it has to select data for more than 10-12 source entities, and the requirement is to show about 150 source entities. Because data is not stored row wise and I need to show it column wise, hence dynamic queries are written to pivot these columns which takes long.

 

 **Ques 1:** Please comment/suggest on my current database design if it’s correct or need to be changed with the new design by taking 150 columns each for Position, Source Date, IsActive, Formula; In this new way data will already be stored in the way I need to retrieve in i.e. I’ll not have to pivot/unpivot it. But the downside is:

a) There are going to be more than 600 columns in this table?

b) There will be limit i.e. 150 on the source entities.

    
 **Ques 2:** If I need to stick to my current, what can be done to improve the performance?


  [1]: http://i.stack.imgur.com/IS9M9.jpg
  [2]: http://i.stack.imgur.com/MMIO9.jpg",4
8105716,11/12/2011 16:20:11,974459,10/01/2011 12:24:25,5,0,Difference between MSSQL Professional and MSSQL EXPRESS,Hi may I know what the difference between  MSSQL Professional and MSSQL EXPRESS? I'm using them for web application written in .NET. Does the express edition allows concurrent access?,sql-server-2008,,,,,11/12/2011 17:55:03,not a real question,1,30,7,Difference between MSSQL Professional and MSSQL EXPRESS Hi may I know what the difference between  MSSQL Professional and MSSQL EXPRESS? I'm using them for web application written in .NET. Does the express edition allows concurrent access?,1
11027976,06/14/2012 06:43:06,1455169,06/14/2012 02:34:46,1,0,Creating tables - int in quotes?,"When I create a table and I am putting an int, is this ok:

insert into Employee_T
(Emp_Id)
values
(
'100' /*WILL THERE BE A PROBLEM IF I PUT IT LIKE THIS, IE WITH THE QUOTES*/? 
)",sql-server-2008,int,,,,,open,0,32,6,"Creating tables - int in quotes? When I create a table and I am putting an int, is this ok:

insert into Employee_T
(Emp_Id)
values
(
'100' /*WILL THERE BE A PROBLEM IF I PUT IT LIKE THIS, IE WITH THE QUOTES*/? 
)",2
8340081,12/01/2011 10:48:32,820737,06/29/2011 09:15:53,18,0,SQL2008 Stored Proc Running Concurrently causing delays,"I Have a problem where it seems that when running the same Stored Procedure at the same time from two different instances of the same application it is timing out, and wondered if there was anything I could do to resolve it? I believe the Problem is in the way sql2008 handles itself, locking records and executing the SPs...things I don't really know a whole lot about. The App uses ADODB.Command to execute the SP.

I have one VB6 exe, (App.exe), running on the one server multiple times. This app calls a Stored Proc on the database which returns the next sequence number for that App. This sequence number field is unique for the instance of the application - there is 1 Row in a table (tbl_SequenceNos) for each instance of the running application.

So for example
say we have running: App[a].exe and App[b].exe
tblSequenceNos looks like:

    iAppNo| iNextSequenceNo
      a   |     1234 
      b   |     4567

the Stored Procedure to get the next sequence number is relatively simple:

    CREATE PROEDURE GetNextSequenceNo (@AppNo varchar(1), @NextSequenceNo int output)
    AS
    BEGIN
        DECLARE @TempSequenceNo int

        SELECT  @NextSequenceNo = iNextSequenceNo FROM tblSequenceNos WHERE iAppNo = @AppNo
        
        @NextSequenceNo = @NextSequenceNo + 1

        UPDATE tblSequenceNos 
        SET iNextSequenceNo = @NextSequenceNo
        WHERE iAppNo = @AppNo

    END

When Both App[a].exe and App[b].exe try to run this procedure to get their NextSequenceNo value, they are hanging for about 30Secs (ADO timeout?).

Because Each app never looks at the each others row, I thought that this would work concurrently without specifing an special Locking. Is there something I am missing? I thought perhaps I need to specify to lock the row only, not the whole table or Page? - I do not know what sql2008 does by default.

Any help is greatly appreciated!
Thank you in advance
Andrew",sql-server-2008,stored-procedures,isolation-level,table-locking,database-locking,,open,0,375,7,"SQL2008 Stored Proc Running Concurrently causing delays I Have a problem where it seems that when running the same Stored Procedure at the same time from two different instances of the same application it is timing out, and wondered if there was anything I could do to resolve it? I believe the Problem is in the way sql2008 handles itself, locking records and executing the SPs...things I don't really know a whole lot about. The App uses ADODB.Command to execute the SP.

I have one VB6 exe, (App.exe), running on the one server multiple times. This app calls a Stored Proc on the database which returns the next sequence number for that App. This sequence number field is unique for the instance of the application - there is 1 Row in a table (tbl_SequenceNos) for each instance of the running application.

So for example
say we have running: App[a].exe and App[b].exe
tblSequenceNos looks like:

    iAppNo| iNextSequenceNo
      a   |     1234 
      b   |     4567

the Stored Procedure to get the next sequence number is relatively simple:

    CREATE PROEDURE GetNextSequenceNo (@AppNo varchar(1), @NextSequenceNo int output)
    AS
    BEGIN
        DECLARE @TempSequenceNo int

        SELECT  @NextSequenceNo = iNextSequenceNo FROM tblSequenceNos WHERE iAppNo = @AppNo
        
        @NextSequenceNo = @NextSequenceNo + 1

        UPDATE tblSequenceNos 
        SET iNextSequenceNo = @NextSequenceNo
        WHERE iAppNo = @AppNo

    END

When Both App[a].exe and App[b].exe try to run this procedure to get their NextSequenceNo value, they are hanging for about 30Secs (ADO timeout?).

Because Each app never looks at the each others row, I thought that this would work concurrently without specifing an special Locking. Is there something I am missing? I thought perhaps I need to specify to lock the row only, not the whole table or Page? - I do not know what sql2008 does by default.

Any help is greatly appreciated!
Thank you in advance
Andrew",5
9500345,02/29/2012 13:50:23,1240400,02/29/2012 13:43:39,1,0,sql upgrade 2008 -> 2008R2,"I am trying to upgrade my sql from 2008 to 2008R2. I have run the setup, selected upgrade from sql 2000, 2005 or 2008 and followed the install. My managment tools have been upgraded and show version 10.50.1617 but my sql server still shows version 10.0.5500. How do i update my server version?

Thanks in advance.",sql-server-2008,,,,,02/29/2012 14:08:54,off topic,1,55,5,"sql upgrade 2008 -> 2008R2 I am trying to upgrade my sql from 2008 to 2008R2. I have run the setup, selected upgrade from sql 2000, 2005 or 2008 and followed the install. My managment tools have been upgraded and show version 10.50.1617 but my sql server still shows version 10.0.5500. How do i update my server version?

Thanks in advance.",1
6923260,08/03/2011 07:52:12,743182,05/07/2011 16:02:35,21,0,work with database when sql service is stop,"    how can I work with sql server when sql service  stop?
   I sure that exist solution
    thanks for your help
",sql-server-2008,,,,,08/03/2011 08:03:46,not a real question,1,30,8,"work with database when sql service is stop     how can I work with sql server when sql service  stop?
   I sure that exist solution
    thanks for your help
",1
7930450,10/28/2011 14:17:55,830395,07/05/2011 20:15:56,3,0,Tomcat JNDI Connection with MS SqlServer 2008 R2 issue,"I'm not able to solve the problem, 'cause NO ERROR is shown!!!
no exception is thrown, no error in log file... NOTHING! it only does nothing!

context.xml:

    <Resource 	name=""jdbc/XXX""
    	auth=""Container""
    	type=""javax.sql.DataSource""
    	maxActive=""50""
    	maxIdle=""50""
    	maxWait=""20000""
    	username=""XX""
    	password=""XX""
    	driverClassName=""com.microsoft.sqlserver.jdbc.SQLServerDriver""
    	url=""jdbc:sqlserver://XXX.XXX.XXX.XXX:1433;databaseName=XXX""
    	removeAbandoned=""true""
    	removeAbandonedTimeout=""1800""
    />

web.xml:

    <resource-ref>
        <description>SQLSERVER Connection</description>
        <res-ref-name>jdbc/XXX</res-ref-name>
        <res-type>javax.sql.DataSource</res-type>
        <res-auth>Container</res-auth>
    </resource-ref>

import.java:

        try {			
        	Context initCtx = new InitialContext();
        	Context envCtx = (Context) initCtx.lookup(""java:comp/env"");
                log.info(""0"");
        	dsSqlServer = (DataSource) envCtx.lookup(""jdbc/XXX""); <---OK
                log.info(""1"");
                connSqlServer = dsSqlServer.getConnection(); <---THIS DOES NOTHING, ""2"" IS NEVER SHOWN IN LOG FILE!!!!!!
                log.info(""2"");
        ...
        } catch (Exception e) {
        	log.fatal(""SQLSERVER: Impossibile connettersi al database: "" + e);
        }


env. info:

Tomcat Version: Apache Tomcat/7.0.22<br>
JVM Version: 1.6.0_29-b11<br>
JVM Vendor: Sun Microsystems Inc.<br>
OS Name: Windows 7<br>
OS Version: 6.1<br>
OS Architecture: x86


please help me, I'm in trouble...


I've just notice that when I reload the App, in the logs\tomcat7-stderr log file, appears:

> 28-ott-2011 16.09.22 org.apache.catalina.core.StandardContext reload<br>
> INFO: Reloading Context with name [/prev] has started 28-ott-2011 16.09.22 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads<br>
> GRAVE: The web application [/prev] appears to have started a thread named [Timer-0] but has failed to stop it. This is very likely to create a memory leak. 28-ott-2011 16.09.22 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads<br>
> org.apache.catalina.core.StandardContext reload INFO: Reloading<br>
> Context with name [/prev] is completed

what the hell is that?!?
",sql-server-2008,tomcat,jndi,,,,open,0,381,9,"Tomcat JNDI Connection with MS SqlServer 2008 R2 issue I'm not able to solve the problem, 'cause NO ERROR is shown!!!
no exception is thrown, no error in log file... NOTHING! it only does nothing!

context.xml:

    <Resource 	name=""jdbc/XXX""
    	auth=""Container""
    	type=""javax.sql.DataSource""
    	maxActive=""50""
    	maxIdle=""50""
    	maxWait=""20000""
    	username=""XX""
    	password=""XX""
    	driverClassName=""com.microsoft.sqlserver.jdbc.SQLServerDriver""
    	url=""jdbc:sqlserver://XXX.XXX.XXX.XXX:1433;databaseName=XXX""
    	removeAbandoned=""true""
    	removeAbandonedTimeout=""1800""
    />

web.xml:

    <resource-ref>
        <description>SQLSERVER Connection</description>
        <res-ref-name>jdbc/XXX</res-ref-name>
        <res-type>javax.sql.DataSource</res-type>
        <res-auth>Container</res-auth>
    </resource-ref>

import.java:

        try {			
        	Context initCtx = new InitialContext();
        	Context envCtx = (Context) initCtx.lookup(""java:comp/env"");
                log.info(""0"");
        	dsSqlServer = (DataSource) envCtx.lookup(""jdbc/XXX""); <---OK
                log.info(""1"");
                connSqlServer = dsSqlServer.getConnection(); <---THIS DOES NOTHING, ""2"" IS NEVER SHOWN IN LOG FILE!!!!!!
                log.info(""2"");
        ...
        } catch (Exception e) {
        	log.fatal(""SQLSERVER: Impossibile connettersi al database: "" + e);
        }


env. info:

Tomcat Version: Apache Tomcat/7.0.22<br>
JVM Version: 1.6.0_29-b11<br>
JVM Vendor: Sun Microsystems Inc.<br>
OS Name: Windows 7<br>
OS Version: 6.1<br>
OS Architecture: x86


please help me, I'm in trouble...


I've just notice that when I reload the App, in the logs\tomcat7-stderr log file, appears:

> 28-ott-2011 16.09.22 org.apache.catalina.core.StandardContext reload<br>
> INFO: Reloading Context with name [/prev] has started 28-ott-2011 16.09.22 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads<br>
> GRAVE: The web application [/prev] appears to have started a thread named [Timer-0] but has failed to stop it. This is very likely to create a memory leak. 28-ott-2011 16.09.22 org.apache.catalina.loader.WebappClassLoader clearReferencesThreads<br>
> org.apache.catalina.core.StandardContext reload INFO: Reloading<br>
> Context with name [/prev] is completed

what the hell is that?!?
",3
2009089,01/05/2010 21:04:36,18217,09/18/2008 20:31:09,449,35,Is using the XML datatype as a DataTable acceptable?,"For some reason I feel like I'm going about this the painful way. 
I have an INSERT xml list. I'm using XML because I need to pass in more than one dynamic value. Since we're saving the event, I already have that ID. What I won't know is the Group or Room ID, so I'm using XML to essentially pass in a datatable.

Here is an example INSERT portion:

    IF @eventGroupTagRoomListInsert IS NOT NULL
        BEGIN
            INSERT INTO EventGroupTagRoomLink(EventID, RoomID, GroupTagID, IsDeleted, LastModifiedBy, SessionID)
                SELECT
                    @eventID AS EventID,
                    ParamValues.Id.query('RoomId').value('.', 'int') AS RoomID,
                    ParamValues.Id.query('GroupTagID').value('.', 'int') AS GroupTagID,
                    0 AS IsDeleted,
                    @lastModifiedBy  AS LastModifiedBy,
                    @sessionId AS SessionID
                FROM @eventGroupTagRoomListInsert.nodes('/Entities/entity') AS ParamValues(ID)
            IF @@ERROR <> 0 GOTO ERR_HANDLER
        END

Is there cleaner way to do this?
",sql-server-2008,design,tsql,,,,open,0,304,9,"Is using the XML datatype as a DataTable acceptable? For some reason I feel like I'm going about this the painful way. 
I have an INSERT xml list. I'm using XML because I need to pass in more than one dynamic value. Since we're saving the event, I already have that ID. What I won't know is the Group or Room ID, so I'm using XML to essentially pass in a datatable.

Here is an example INSERT portion:

    IF @eventGroupTagRoomListInsert IS NOT NULL
        BEGIN
            INSERT INTO EventGroupTagRoomLink(EventID, RoomID, GroupTagID, IsDeleted, LastModifiedBy, SessionID)
                SELECT
                    @eventID AS EventID,
                    ParamValues.Id.query('RoomId').value('.', 'int') AS RoomID,
                    ParamValues.Id.query('GroupTagID').value('.', 'int') AS GroupTagID,
                    0 AS IsDeleted,
                    @lastModifiedBy  AS LastModifiedBy,
                    @sessionId AS SessionID
                FROM @eventGroupTagRoomListInsert.nodes('/Entities/entity') AS ParamValues(ID)
            IF @@ERROR <> 0 GOTO ERR_HANDLER
        END

Is there cleaner way to do this?
",3
7864914,10/23/2011 07:28:12,970404,09/29/2011 05:11:08,32,0,how do find foreign key of a table sql server,"i get columns of a table in sql .
    
      select * from information_schema.columns where table_name = 'MyTable'

but **How do I find the foreign key columns**.",sql-server-2008,,,,,,open,0,34,10,"how do find foreign key of a table sql server i get columns of a table in sql .
    
      select * from information_schema.columns where table_name = 'MyTable'

but **How do I find the foreign key columns**.",1
8030170,11/06/2011 20:31:59,323698,04/22/2010 21:08:01,1588,49,What would be the easiest way to convert a SQL Server record into a JSON insert for MongoDB?,"I have a SQL Server table that I need to convert into a Mongo document. However the table has about 50 fields that I do not want to input one by one. Anyone know of a simpler way?

Thanks",sql-server-2008,mongodb,,,,11/08/2011 00:18:51,not a real question,1,38,18,"What would be the easiest way to convert a SQL Server record into a JSON insert for MongoDB? I have a SQL Server table that I need to convert into a Mongo document. However the table has about 50 fields that I do not want to input one by one. Anyone know of a simpler way?

Thanks",2
5833511,04/29/2011 14:40:53,730032,04/28/2011 20:09:23,8,0,SSIS: Remove Empty Row from outputbuffer,"I have an error on a data flow task.  

i have an ado.net source going to an async script component.

the problem comes at the very end of the insert from the script component to the destination where it 

tries to put the empty row it automatically puts in the output buffer in my table.

Is there a way to prevent this from happening/ how can i manipulate the output buffer so i can remove specific rows from it?",sql-server-2008,ssis,script-component,,,,open,0,78,6,"SSIS: Remove Empty Row from outputbuffer I have an error on a data flow task.  

i have an ado.net source going to an async script component.

the problem comes at the very end of the insert from the script component to the destination where it 

tries to put the empty row it automatically puts in the output buffer in my table.

Is there a way to prevent this from happening/ how can i manipulate the output buffer so i can remove specific rows from it?",3
10868343,06/03/2012 06:22:32,730580,04/29/2011 06:43:19,198,32,Can't login to sql server after windows password was changed,"After removing the password for the windows user account, I can't login to the sql server using the same usual password for the 'sa' account. Anyway I could fix this without having to go through reinstalling?",sql-server-2008,,,,,,open,0,36,10,"Can't login to sql server after windows password was changed After removing the password for the windows user account, I can't login to the sql server using the same usual password for the 'sa' account. Anyway I could fix this without having to go through reinstalling?",1
3833580,09/30/2010 18:18:25,431281,08/25/2010 22:47:34,49,0,error:failed retrieve data for this request.,"*Hi,I need to attach my database to SQL server 2008(I used it before without problem),but now when I want to attach db , sqlsrv sent me this error.
error:failed retrieve data for this request.
![alt text][1]
  [1]: http://i.stack.imgur.com/VSqre.jpg
Why do I have this problem and how can I solve it?* 
",sql-server-2008,,,,,,open,0,49,6,"error:failed retrieve data for this request. *Hi,I need to attach my database to SQL server 2008(I used it before without problem),but now when I want to attach db , sqlsrv sent me this error.
error:failed retrieve data for this request.
![alt text][1]
  [1]: http://i.stack.imgur.com/VSqre.jpg
Why do I have this problem and how can I solve it?* 
",1
11123685,06/20/2012 16:11:19,1469837,06/20/2012 16:04:59,1,0,SSIS query doesnt update in Execute Sql Task Editor but udpates in sql server management studio,"Here is the script:

    DECLARE @Filename varchar(10)
    SET @Filename = 'TubeSta_cycle_log.txt'
    
    UPDATE    Torque.LastUpdate
    SET       LastUpdated = getDate()
    WHERE     Station  = substring(@Filename,1,CHARINDEX('_', @FileName)-1)


The 'Execute SQL Task Editor' executes with NO errors but doesn't update the table.",sql-server-2008,query,update,ssis,,,open,0,68,16,"SSIS query doesnt update in Execute Sql Task Editor but udpates in sql server management studio Here is the script:

    DECLARE @Filename varchar(10)
    SET @Filename = 'TubeSta_cycle_log.txt'
    
    UPDATE    Torque.LastUpdate
    SET       LastUpdated = getDate()
    WHERE     Station  = substring(@Filename,1,CHARINDEX('_', @FileName)-1)


The 'Execute SQL Task Editor' executes with NO errors but doesn't update the table.",4
7915772,10/27/2011 12:23:41,313599,04/10/2010 19:14:19,48,1,What are the impacts of changing authentication on SQL Server?,"We are using SQL Server 2008 and the only thing that is using it is SharePoint at the moment. Accounting had purchased Sage Fixed Assets which requires Mixed Mode authentication on SQL Server and we are currently using Windows Authentication. I know very little about the internals of SQL Server and SharePoint. What if any impact would there be on SharePoint if I changed authentication?

Thanks,
Norm",sql-server-2008,sharepoint,,,,,open,0,65,10,"What are the impacts of changing authentication on SQL Server? We are using SQL Server 2008 and the only thing that is using it is SharePoint at the moment. Accounting had purchased Sage Fixed Assets which requires Mixed Mode authentication on SQL Server and we are currently using Windows Authentication. I know very little about the internals of SQL Server and SharePoint. What if any impact would there be on SharePoint if I changed authentication?

Thanks,
Norm",2
10342942,04/26/2012 23:44:03,1359932,04/26/2012 23:31:53,1,0,SQL Server 2008 slow vs. 2005 in getting Access 2003 data,"I am working with a phone application that dumps user data into an Access 2003 data.  I have been referencing the Access tables via SQL Server 2005 queries (e.g., select * from PHONEDATA...PhoneSystem as Phone) and so that I can combine the Access data with data in SQL Server.

Unfortunately, when we recently upgraded to SS 2008 all of my queries, that get data from the phone system access database tables, take about 3 times longer to run.

Any ideas on an approach to get better performance?  Thanks in advance.",sql-server-2008,ms-access,,,,04/27/2012 04:05:19,not constructive,1,90,11,"SQL Server 2008 slow vs. 2005 in getting Access 2003 data I am working with a phone application that dumps user data into an Access 2003 data.  I have been referencing the Access tables via SQL Server 2005 queries (e.g., select * from PHONEDATA...PhoneSystem as Phone) and so that I can combine the Access data with data in SQL Server.

Unfortunately, when we recently upgraded to SS 2008 all of my queries, that get data from the phone system access database tables, take about 3 times longer to run.

Any ideas on an approach to get better performance?  Thanks in advance.",2
8640976,12/27/2011 03:53:28,1117025,12/27/2011 03:36:48,1,0,How many ways to improve the ssrs report performance,Please Tell me improve the performance of the report which rules are follow,sql-server-2008,,,,,12/27/2011 04:36:20,not a real question,1,13,9,How many ways to improve the ssrs report performance Please Tell me improve the performance of the report which rules are follow,1
11472346,07/13/2012 14:18:57,1523797,07/13/2012 14:13:00,1,0,Unable to login to SQL Server 2008 through command line utility,"I have installed SQL Server 2008 Management Studio and am able to login to the database through this. I have also installed the SQL command utility. But, am unable to login through the command utility. I get the following error:

C:\Users\Administrator>sqlcmd
HResult 0x274D, Level 16, State 1
TCP Provider: No connection could be made because the target machine actively re
fused it.

Sqlcmd: Error: Microsoft SQL Server Native Client 10.0 : A network-related or in
stance-specific error has occurred while establishing a connection to SQL Server
. Server is not found or not accessible. Check if instance name is correct and i
f SQL Server is configured to allow remote connections. For more information see
 SQL Server Books Online..
Sqlcmd: Error: Microsoft SQL Server Native Client 10.0 : Login timeout expired.

I tried giving the server name, username and password explicitly using:

sqlcmd -S <hostname\databse instance> -U <user> -P <pwd>

this too doesn't help.

I need this command utility for my automation stuff. Please help me!",sql-server-2008,,,,,07/17/2012 04:37:16,off topic,1,153,11,"Unable to login to SQL Server 2008 through command line utility I have installed SQL Server 2008 Management Studio and am able to login to the database through this. I have also installed the SQL command utility. But, am unable to login through the command utility. I get the following error:

C:\Users\Administrator>sqlcmd
HResult 0x274D, Level 16, State 1
TCP Provider: No connection could be made because the target machine actively re
fused it.

Sqlcmd: Error: Microsoft SQL Server Native Client 10.0 : A network-related or in
stance-specific error has occurred while establishing a connection to SQL Server
. Server is not found or not accessible. Check if instance name is correct and i
f SQL Server is configured to allow remote connections. For more information see
 SQL Server Books Online..
Sqlcmd: Error: Microsoft SQL Server Native Client 10.0 : Login timeout expired.

I tried giving the server name, username and password explicitly using:

sqlcmd -S <hostname\databse instance> -U <user> -P <pwd>

this too doesn't help.

I need this command utility for my automation stuff. Please help me!",1
8419598,12/07/2011 17:19:26,41169,11/26/2008 21:37:35,323,14,SQL Server Service Broker - Missing Message,"I'm considering using service broker for a new project. My intention is for service broker to replicate inserts / updates from an OLTP database to a reporting database.

I've just started the tutorial at [msdn tutorial][1] but I've already hit a problem. I've created the required message types, queues and contract. When I run the script to post the 1st message that seems to work. However, if I right-click the target queue from SQLDBMS and view top 1000 rows then I can see that the queue is empty. When I run the script to ""Receive the request and send a reply"" I get two Null messages back?

Can anyone please help?

Thanks

Rob. 


  [1]: http://msdn.microsoft.com/en-us/library/bb839499.aspx",sql-server-2008,service-broker,,,,01/04/2012 17:51:47,too localized,1,113,7,"SQL Server Service Broker - Missing Message I'm considering using service broker for a new project. My intention is for service broker to replicate inserts / updates from an OLTP database to a reporting database.

I've just started the tutorial at [msdn tutorial][1] but I've already hit a problem. I've created the required message types, queues and contract. When I run the script to post the 1st message that seems to work. However, if I right-click the target queue from SQLDBMS and view top 1000 rows then I can see that the queue is empty. When I run the script to ""Receive the request and send a reply"" I get two Null messages back?

Can anyone please help?

Thanks

Rob. 


  [1]: http://msdn.microsoft.com/en-us/library/bb839499.aspx",2
11045940,06/15/2012 06:53:38,1004164,10/19/2011 22:53:08,168,5,how to find the biggest procedure in the database?,"Hi i am using SQL Server 2008 R2,
i have lots of procedures in the database. 
amongest those i want to find the biggest procedure in terms of rows ?
is it possible to find the procedure having the count as their number of rows in it.
please can somebody help me to get this.

Thanks! in adavanced.",sql-server-2008,sql-server-2005,sql-server-2008-r2,,,,open,0,54,9,"how to find the biggest procedure in the database? Hi i am using SQL Server 2008 R2,
i have lots of procedures in the database. 
amongest those i want to find the biggest procedure in terms of rows ?
is it possible to find the procedure having the count as their number of rows in it.
please can somebody help me to get this.

Thanks! in adavanced.",3
10370707,04/29/2012 08:16:22,1357907,04/26/2012 06:32:10,1,0,Comparing to date range with given date in sql server 2008,"I have a table named tblleaveApplication with empid, leaveStarddate, leaveEndDate, leavetype, remarks and so on. Now I want to find the employee who is on leave by leaveStarddate and leaveEndDate  by given today's date.
Please help in this regard.",sql-server-2008,,,,,04/29/2012 13:43:45,not a real question,1,39,11,"Comparing to date range with given date in sql server 2008 I have a table named tblleaveApplication with empid, leaveStarddate, leaveEndDate, leavetype, remarks and so on. Now I want to find the employee who is on leave by leaveStarddate and leaveEndDate  by given today's date.
Please help in this regard.",1
10739136,05/24/2012 14:08:41,141195,07/20/2009 06:20:01,53,3,Query required for my issue,"Hello Brilliant brain,

    I just need a sql server query for following scenario.

    ![enter image description here][1]  


  [1]: http://i.stack.imgur.com/hFq7z.png

  Need a query to get a single record of each vehicle type. 
  There are 4 record of Passenger Car, 2 records of Pickup Truck and a record of Multipurpose Vehicle (MPV).

so I want a single records of each type.

Thanks",sql-server-2008,,,,,05/25/2012 19:46:26,not a real question,1,70,5,"Query required for my issue Hello Brilliant brain,

    I just need a sql server query for following scenario.

    ![enter image description here][1]  


  [1]: http://i.stack.imgur.com/hFq7z.png

  Need a query to get a single record of each vehicle type. 
  There are 4 record of Passenger Car, 2 records of Pickup Truck and a record of Multipurpose Vehicle (MPV).

so I want a single records of each type.

Thanks",1
3584941,08/27/2010 14:06:21,123348,06/15/2009 20:46:01,240,4,Updating a SQL table with CSV data?,"I am trying to update one of my SQL tables with new columns in my source CSV file. The CSV records in this file are already in this SQL table, but this SQL table is lacking some of the new columns from this CSV file. 

I already added the new columns to my SQL table structure via ALTER TABLE. But now I just need to import the data from this CSV file into the new columns. How can I do this?  I am trying to use SSIS and SQL Server to accomplish this, but am pretty new to Excel.
",sql-server-2008,csv,ssis,,,,open,0,100,7,"Updating a SQL table with CSV data? I am trying to update one of my SQL tables with new columns in my source CSV file. The CSV records in this file are already in this SQL table, but this SQL table is lacking some of the new columns from this CSV file. 

I already added the new columns to my SQL table structure via ALTER TABLE. But now I just need to import the data from this CSV file into the new columns. How can I do this?  I am trying to use SSIS and SQL Server to accomplish this, but am pretty new to Excel.
",3
7413534,09/14/2011 08:41:45,779519,06/01/2011 13:49:34,15,1,SQL Replication & Restriced Access to the publisher,"I'm trying to set up SQL Replication on our server as the distributor and having a remote SQL Subscriber who is one of our clients.

It's working fine but I would like to restrict access to the user so they could see just the two tables I'm publishing for them. 

So far here's what I've done.

In the Publisher:
- Created a replicationtest user and tried to restrict the access to the database I'm publishing. (dbo.Members, dbo.Persons and dbo.uvw_MemberPublish)
- With both as a Server user and Database user it works but if I try to login remotely from the subscriber I can still see all database & tables. I want them to see only the database holding the tables mentioned above.
- If I remove the server user, then I can not connect remotely as a subscriber. I get login failed.

Is there a link or a step by step on how to restrict access to the subscriber? I just want them to see Database1, the two tables and the view mentioned before.

I've been googling around but couldn't find what I'm looking for.",sql-server-2008,database-permissions,transactional-replication,,,,open,0,178,8,"SQL Replication & Restriced Access to the publisher I'm trying to set up SQL Replication on our server as the distributor and having a remote SQL Subscriber who is one of our clients.

It's working fine but I would like to restrict access to the user so they could see just the two tables I'm publishing for them. 

So far here's what I've done.

In the Publisher:
- Created a replicationtest user and tried to restrict the access to the database I'm publishing. (dbo.Members, dbo.Persons and dbo.uvw_MemberPublish)
- With both as a Server user and Database user it works but if I try to login remotely from the subscriber I can still see all database & tables. I want them to see only the database holding the tables mentioned above.
- If I remove the server user, then I can not connect remotely as a subscriber. I get login failed.

Is there a link or a step by step on how to restrict access to the subscriber? I just want them to see Database1, the two tables and the view mentioned before.

I've been googling around but couldn't find what I'm looking for.",3
7253486,08/31/2011 06:46:12,642391,03/03/2011 04:55:25,131,8,Need help for Filtering the data in sql,"i have  a table that contain `s.no` `Id` and `Amount` and `accCode`.

      s.no-------------id--------------Amount--------accCode
       1----------------2---------------20-------------2.1
       2----------------1---------------30-------------2.1
       3--------------- 5---------------20-------------3.1
       4----------------1---------------30-------------2.1
       5----------------3---------------40-------------3.1
       6----------------2---------------20-------------2.1

i need all the record that have a common `Amount` and `accCode` and `id`. In this case i need to show the data of S.NO 2 and 4, and also 1 and 6   as they have  similar value. If Possible it would be better the `similar data come orderly`. Is this one  possible through Sql? Please give some hints i am stuck with this one.thaks in advance.",sql-server-2008,,,,,,open,0,132,8,"Need help for Filtering the data in sql i have  a table that contain `s.no` `Id` and `Amount` and `accCode`.

      s.no-------------id--------------Amount--------accCode
       1----------------2---------------20-------------2.1
       2----------------1---------------30-------------2.1
       3--------------- 5---------------20-------------3.1
       4----------------1---------------30-------------2.1
       5----------------3---------------40-------------3.1
       6----------------2---------------20-------------2.1

i need all the record that have a common `Amount` and `accCode` and `id`. In this case i need to show the data of S.NO 2 and 4, and also 1 and 6   as they have  similar value. If Possible it would be better the `similar data come orderly`. Is this one  possible through Sql? Please give some hints i am stuck with this one.thaks in advance.",1
11362221,07/06/2012 12:28:18,208486,11/11/2009 07:43:27,2893,157,Why does my ORDER BY sort the two tables sorted before the EXCEPT (slow) and not after? (fast)?,"**SQL server 2008 R2 query optimizer puzzle**

We have two tables, both containing 9 million rows. 70.000 rows are different, the others are the same.

This is fast, 13 seconds,

    select * from bigtable1
    except select * from similar_bigtable2

This sorts the output and is also fast, 13 seconds as well,

    select * into #q from bigtable1
    except select * from similar_bigtable2
    select * from #q order by sort_column

While this is enormously slow:

    ;with q as (
    	select * from bigtable1
    	except select * from similar_bigtable2
    )
    select * from q order by sort_column

And even a ""trick"" that I sometimes use to hint SQL Server that it needs to precalculate a certain part of the query before it moves on, doesn't work and results in slow query as well:

    ;with q as (
    	select top 100 percent * from bigtable1
    	except select * from similar_bigtable2
    )
    select * from q order by sort_column

Looking at the query plans the reason is not hard to find:

![Query plan][1]
![Query plan with ORDER BY][2]

SQL Server places two sorts of 9 million rows *before* the hashmatch, while I would prefer it to have added only one sort of 70.000 rows *after* the hashmatch.

So the question: how can I instruct the query optimizer to do that?

  [1]: http://i.stack.imgur.com/GJUUk.jpg
  [2]: http://i.stack.imgur.com/KRcuy.jpg",sql-server-2008,query-plans,,,,07/08/2012 09:17:31,off topic,1,257,18,"Why does my ORDER BY sort the two tables sorted before the EXCEPT (slow) and not after? (fast)? **SQL server 2008 R2 query optimizer puzzle**

We have two tables, both containing 9 million rows. 70.000 rows are different, the others are the same.

This is fast, 13 seconds,

    select * from bigtable1
    except select * from similar_bigtable2

This sorts the output and is also fast, 13 seconds as well,

    select * into #q from bigtable1
    except select * from similar_bigtable2
    select * from #q order by sort_column

While this is enormously slow:

    ;with q as (
    	select * from bigtable1
    	except select * from similar_bigtable2
    )
    select * from q order by sort_column

And even a ""trick"" that I sometimes use to hint SQL Server that it needs to precalculate a certain part of the query before it moves on, doesn't work and results in slow query as well:

    ;with q as (
    	select top 100 percent * from bigtable1
    	except select * from similar_bigtable2
    )
    select * from q order by sort_column

Looking at the query plans the reason is not hard to find:

![Query plan][1]
![Query plan with ORDER BY][2]

SQL Server places two sorts of 9 million rows *before* the hashmatch, while I would prefer it to have added only one sort of 70.000 rows *after* the hashmatch.

So the question: how can I instruct the query optimizer to do that?

  [1]: http://i.stack.imgur.com/GJUUk.jpg
  [2]: http://i.stack.imgur.com/KRcuy.jpg",2
8886353,01/16/2012 21:14:50,322518,04/21/2010 16:56:28,1509,74,Why does restore take a long time?,"Although, the database backup file is only 2GB the restore can take up to 15-20 minutes even on a very very fast machine.  When I backup similar sized backup files made from a different database, the restore finishes in 3 seconds.

What could be causing the restore to take so long?",sql-server-2008,restore,,,,01/17/2012 13:37:58,too localized,1,51,7,"Why does restore take a long time? Although, the database backup file is only 2GB the restore can take up to 15-20 minutes even on a very very fast machine.  When I backup similar sized backup files made from a different database, the restore finishes in 3 seconds.

What could be causing the restore to take so long?",2
7969338,11/01/2011 16:10:36,1024050,11/01/2011 15:58:31,1,0,SQL 2008 Query for members who meet multiple conditions,"I searched for this and found similar queries, but none that gave the specific results I am seeking.

I have a table of all phone numbers called. I need a list of ALL OrigNumber who dialed EACH of four different TermNumber. The problem I am having is that each call is a single record from and to one number.

I only need one {GROUP BY} instance of each OrigNumber that meets the condition.

Thanks!",sql-server-2008,query,,,,,open,0,71,9,"SQL 2008 Query for members who meet multiple conditions I searched for this and found similar queries, but none that gave the specific results I am seeking.

I have a table of all phone numbers called. I need a list of ALL OrigNumber who dialed EACH of four different TermNumber. The problem I am having is that each call is a single record from and to one number.

I only need one {GROUP BY} instance of each OrigNumber that meets the condition.

Thanks!",2
11518380,07/17/2012 08:06:03,1282657,03/21/2012 06:30:27,36,0,How to retriece data from different tables using store procedure?,"Hi guys i have some four tables three tables have primary key and the fourth table has all three foriegn keys..now i want to write a select procedure

    my tables look like this

              usertable                                       RoleTable
      -----------------------                        ---------------------------
       UserID|UserName|userEmail|Pwd|RoleID                RoleID|RoleName
         1   |Anil    |akanil@gma|123|1                       1   |Admin


           Projecttable                                    WorkAssignedTable
    -----------------------                       ---------------------------
    ProjectID|ProName|                                  WorkID|userId|ProjectID|RoleID
         1   |Anil                                            |



now i want to write a select store procedure for workassigned table where i have to get
[UserName],[UserMailId] from sertbale,[rolename] from role tbale,[ProjectName] from Projecttable can any one help in how to write a store Procedure for this

",sql-server-2008,stored-procedures,,,,07/17/2012 16:45:34,not a real question,1,388,10,"How to retriece data from different tables using store procedure? Hi guys i have some four tables three tables have primary key and the fourth table has all three foriegn keys..now i want to write a select procedure

    my tables look like this

              usertable                                       RoleTable
      -----------------------                        ---------------------------
       UserID|UserName|userEmail|Pwd|RoleID                RoleID|RoleName
         1   |Anil    |akanil@gma|123|1                       1   |Admin


           Projecttable                                    WorkAssignedTable
    -----------------------                       ---------------------------
    ProjectID|ProName|                                  WorkID|userId|ProjectID|RoleID
         1   |Anil                                            |



now i want to write a select store procedure for workassigned table where i have to get
[UserName],[UserMailId] from sertbale,[rolename] from role tbale,[ProjectName] from Projecttable can any one help in how to write a store Procedure for this

",2
7385403,09/12/2011 08:55:52,441343,09/07/2010 10:34:49,533,16,Code formatting visual studio and sql server,What is the equivalent of Ctrl + K + D (Visual Studio) in Sql Server Management Studio which is use to format the code ?,sql-server-2008,code-formatting,,,,,open,0,25,7,Code formatting visual studio and sql server What is the equivalent of Ctrl + K + D (Visual Studio) in Sql Server Management Studio which is use to format the code ?,2
11317276,07/03/2012 18:50:43,870291,07/30/2011 03:30:38,585,39,Sql Server Full Text Search - LastName FirstName searching prob,"I have a table with many fields out of which LastName and FirstName are two..

This table has around 2 million records..

So I thought of using Full text search.

Now my requirement is to search for a particular record with search criteria LastName and FirstName with combination of LastName and FirstName in the database table

    ..|Firstname    |Lastname     |..
    ------------------------------------------
      |george walker|bush         |
      |bill         |klinton      |

It should return the record if the combination of these two columns contains the extered search criteria

ie., `FirstName=bush` and `LastName=walker`  or<br>
`FirstName=goerge` and `LastName=walker` etc.

I cannot just use like

    SELECT * FROM TableName where CONTAINS((LastName,FirstName),@LastName)
             and CONTAINS((LastName,FirstName),@FirstName)

because searching criteria `FirstName` and `LastName` can be null(SQL SERVER 2008 raises Error) or can have more than one word in it

How to solve the problem in its simplest form?",sql-server-2008,tsql,full-text-search,,,,open,0,187,10,"Sql Server Full Text Search - LastName FirstName searching prob I have a table with many fields out of which LastName and FirstName are two..

This table has around 2 million records..

So I thought of using Full text search.

Now my requirement is to search for a particular record with search criteria LastName and FirstName with combination of LastName and FirstName in the database table

    ..|Firstname    |Lastname     |..
    ------------------------------------------
      |george walker|bush         |
      |bill         |klinton      |

It should return the record if the combination of these two columns contains the extered search criteria

ie., `FirstName=bush` and `LastName=walker`  or<br>
`FirstName=goerge` and `LastName=walker` etc.

I cannot just use like

    SELECT * FROM TableName where CONTAINS((LastName,FirstName),@LastName)
             and CONTAINS((LastName,FirstName),@FirstName)

because searching criteria `FirstName` and `LastName` can be null(SQL SERVER 2008 raises Error) or can have more than one word in it

How to solve the problem in its simplest form?",3
8792723,01/09/2012 17:41:46,671203,03/22/2011 12:46:39,377,11,Grouping data in MSSQL,"I have a stored procedure in which i would like to return a result set looking something like this:

    id | student | term1 | term2

The problem is that the data isn't stored like this in the db. So the query will genereate a result set looking somthing like this:

    id | student | termNo | termValue
    1  | lorem   | 1      | someValue
    2  | ipsum   | 2      | anotherValue

Is there any simple way to convert this. The result sets is large, so I don't want to make several queries which would be the obvious solution.

Hope this is understandable =)",sql-server-2008,,,,,,open,0,129,4,"Grouping data in MSSQL I have a stored procedure in which i would like to return a result set looking something like this:

    id | student | term1 | term2

The problem is that the data isn't stored like this in the db. So the query will genereate a result set looking somthing like this:

    id | student | termNo | termValue
    1  | lorem   | 1      | someValue
    2  | ipsum   | 2      | anotherValue

Is there any simple way to convert this. The result sets is large, so I don't want to make several queries which would be the obvious solution.

Hope this is understandable =)",1
10679282,05/21/2012 03:43:47,805594,06/19/2011 17:53:10,158,5,"SQL-Server Left join ""With"" table","I have a query that looks like this

	WITH CTE
	AS (SELECT
	ROW_NUMBER() OVER(PARTITION BY JobID ORDER BY JobID) AS RowNbr,JobsTagMap.JobID
	FROM JobsTagMap)
	SELECT*,STUFF
	((SELECT ',' +Title FROM Tags
	JOIN JobsTagMap ON Tags.TagID=JobsTagMap.TagID
	WHERE JobsTagMap.JobID=CTE.JobID
	FOR XML PATH(''))
	,1,1,'') AS Title
	FROM CTE
	WHERE CTE.RowNbr=1

Now, i want do something like this (above query referred to as 'my big query')

    SELECT * FROM Jobs LEFT JOIN ('my big query') q on Jobs.JobID=q.JobID

But when i do so, i get error 

    Incorrect syntax near the keyword 'with'. If this statement is a common table expression, an xmlnamespaces clause or a change tracking context clause, the previous statement must be terminated with a semicolon.

How im a supposed to join such a query?",sql-server-2008,,,,,,open,0,113,5,"SQL-Server Left join ""With"" table I have a query that looks like this

	WITH CTE
	AS (SELECT
	ROW_NUMBER() OVER(PARTITION BY JobID ORDER BY JobID) AS RowNbr,JobsTagMap.JobID
	FROM JobsTagMap)
	SELECT*,STUFF
	((SELECT ',' +Title FROM Tags
	JOIN JobsTagMap ON Tags.TagID=JobsTagMap.TagID
	WHERE JobsTagMap.JobID=CTE.JobID
	FOR XML PATH(''))
	,1,1,'') AS Title
	FROM CTE
	WHERE CTE.RowNbr=1

Now, i want do something like this (above query referred to as 'my big query')

    SELECT * FROM Jobs LEFT JOIN ('my big query') q on Jobs.JobID=q.JobID

But when i do so, i get error 

    Incorrect syntax near the keyword 'with'. If this statement is a common table expression, an xmlnamespaces clause or a change tracking context clause, the previous statement must be terminated with a semicolon.

How im a supposed to join such a query?",1
10497256,05/08/2012 10:56:11,1273547,03/16/2012 08:29:45,51,18,how can I make spport special charrecter on SQL server,"I have 5 fields on SQL Server 2008.

    id INT, name VARCHAR(100), user address Varchar(200),phone_number VARCHAR(20),email VARCHAR(50).


But I don't know why special charecter is not entered on the table.
Any suggestion?",sql-server-2008,,,,,,open,0,33,10,"how can I make spport special charrecter on SQL server I have 5 fields on SQL Server 2008.

    id INT, name VARCHAR(100), user address Varchar(200),phone_number VARCHAR(20),email VARCHAR(50).


But I don't know why special charecter is not entered on the table.
Any suggestion?",1
7409319,09/13/2011 22:27:19,927757,09/04/2011 16:53:32,3,0,How to make control move from inner loop to outer loop if a transaction fails,"Please I need to make my control move from my inner while loop to the outer while loop if an
update transaction on a table fails.
",sql-server-2008,,,,,,open,0,25,15,"How to make control move from inner loop to outer loop if a transaction fails Please I need to make my control move from my inner while loop to the outer while loop if an
update transaction on a table fails.
",1
11014585,06/13/2012 12:13:44,1440230,06/06/2012 16:00:38,6,0,TOOL/TRICK to import excel table into sql server 2008?,The purpose is to fill test data in an excel file and then dump all those values into SQL server 2008. How can I do the import easily and quickly ? Is there a simple/free tool for this,sql-server-2008,excel,import,tricks,,06/15/2012 14:50:37,off topic,1,38,9,TOOL/TRICK to import excel table into sql server 2008? The purpose is to fill test data in an excel file and then dump all those values into SQL server 2008. How can I do the import easily and quickly ? Is there a simple/free tool for this,4
3870463,10/06/2010 07:56:43,43907,12/06/2008 09:03:27,1908,0,Is there any script for Open/Close sql-server 2008 ?,"Is there any script (any batch file) for Open/Close sql-server 2008 ?

thank's in advance",sql-server-2008,,,,,10/06/2010 08:40:34,not a real question,1,14,9,"Is there any script for Open/Close sql-server 2008 ? Is there any script (any batch file) for Open/Close sql-server 2008 ?

thank's in advance",1
10636429,05/17/2012 13:13:38,1401054,05/17/2012 13:08:42,1,0,Update a column in a table,"I need to update a column in a table which is of int data type but the values from other table i used for updating is nvarchar.
wheather this is achieved if so please let me know.
",sql-server-2008,sql-server-2005,,,,,open,0,36,6,"Update a column in a table I need to update a column in a table which is of int data type but the values from other table i used for updating is nvarchar.
wheather this is achieved if so please let me know.
",2
9334387,02/17/2012 19:44:21,949512,09/16/2011 20:12:33,163,1,ReportViewer reportpath .rdlc from database,"I am saving physically .rdlc(xml) file in the database column. The column datatype is 'image'.  How can I read this column and dynamically set it to the ReportViewer control? Please let me know if there are any examples.

Thank you for any help.",sql-server-2008,reporting-services,ssrs-2008,reportviewer,,,open,0,43,5,"ReportViewer reportpath .rdlc from database I am saving physically .rdlc(xml) file in the database column. The column datatype is 'image'.  How can I read this column and dynamically set it to the ReportViewer control? Please let me know if there are any examples.

Thank you for any help.",4
7373767,09/10/2011 18:34:16,938478,09/10/2011 18:34:16,1,0,Why My C# program runs on my Pc but not in other computers?,"I used C# language in visual studio 2008 and some SQL server management databases in my program
but here in my computer the program runs well but in other Pcs it just can't be run :(
My databases use windows authentication ( not sql server authentication )and I just added them in my project 
I guess the problem is my databases but what should I do?
",sql-server-2008,c#-4.0,,,,09/10/2011 19:49:54,not a real question,1,64,13,"Why My C# program runs on my Pc but not in other computers? I used C# language in visual studio 2008 and some SQL server management databases in my program
but here in my computer the program runs well but in other Pcs it just can't be run :(
My databases use windows authentication ( not sql server authentication )and I just added them in my project 
I guess the problem is my databases but what should I do?
",2
6020136,05/16/2011 16:07:21,755952,05/16/2011 16:07:21,1,0,could not find stored proc,"I'm trying to run a stored proc on a 2008 sql server. I have created the one-line proc, dbo.sp_test_proc. 
I can run the proc via EXEC on the server, and it returns. 
However, when I try to run via ADO in an excel/vba, I get the error message 'could not find the stored procedure sp_test_proc. 
I can run sys schema stored procs via ADO, but not any dbo ones. I am in the role db_owner, and vba code is running under the same windows user that created the stored proc in server management studio. 
Anyone got any ideas? I am stumped.    



    Sub storedProcedure()
    'This sub-routine defines an ADOBD command to return variables to VBA from SQL Stored Procedures.
    'The ADODB command executes a Stored Procedure on the SQL Server (cmd.CommandText = [Stored Procedure Name])
    'Input requirements from the Stored procedure are declared as variants at the start of the sub-routine.

    Dim cnt As ADODB.connection
    Dim rst As ADODB.recordset
    Dim cmd As ADODB.Command
    Dim stCon As String         'SQL Connection string
    Dim stProcName As String    'Stored Procedure name

    'Declare variables for Stored Procedure
    Dim myVariable As Variant
    Dim myReturn As String

    'Set ADODB requirements
    Set cnt = New ADODB.connection
    Set rst = New ADODB.recordset
    Set cmd = New ADODB.Command

    'Define database connection string
    stCon = ""Provider=SQLOLEDB.1;""
    stCon = stCon + ""Data Source=myserver;""
    stCon = stCon + ""Initial Catalogue=Mmydb;""
    stCon = stCon + ""Integrated Security=SSPI;""
    stCon = stCon + ""Persist Security Info=True;""

    'Open database connection
    cnt.ConnectionString = stCon
    cnt.Open

    ' Defines the stored procedure commands
    stProcName = ""dbo.my_sp""                'Define name of Stored Procedure to execute.""
    'stProcName = ""sys.sp_stored_procedures""    'Define name of Stored Procedure to execute.
    cmd.CommandType = adCmdStoredProc           'Define the ADODB command
    cmd.ActiveConnection = cnt                  'Set the command connection string
    cmd.CommandText = stProcName                'Define Stored Procedure to run



    'Execute stored procedure and return to a recordset
    Set rst = cmd.Execute()
    'myReturn = rst.Fields(""procedure_name"").Value
    myReturn = rst.Fields(""mycolumn"").Value

    'Call Sub-Routine_That_Uses_The_Returned_Data
    MsgBox (myReturn)

    'Close database connection and clean up
    If CBool(rst.State And adStateOpen) = True Then rst.Close
    Set rst = Nothing
    
    If CBool(cnt.State And adStateOpen) = True Then cnt.Close
    Set cnt = Nothing
    
    End Sub
",sql-server-2008,excel-vba,ado,,,,open,0,561,5,"could not find stored proc I'm trying to run a stored proc on a 2008 sql server. I have created the one-line proc, dbo.sp_test_proc. 
I can run the proc via EXEC on the server, and it returns. 
However, when I try to run via ADO in an excel/vba, I get the error message 'could not find the stored procedure sp_test_proc. 
I can run sys schema stored procs via ADO, but not any dbo ones. I am in the role db_owner, and vba code is running under the same windows user that created the stored proc in server management studio. 
Anyone got any ideas? I am stumped.    



    Sub storedProcedure()
    'This sub-routine defines an ADOBD command to return variables to VBA from SQL Stored Procedures.
    'The ADODB command executes a Stored Procedure on the SQL Server (cmd.CommandText = [Stored Procedure Name])
    'Input requirements from the Stored procedure are declared as variants at the start of the sub-routine.

    Dim cnt As ADODB.connection
    Dim rst As ADODB.recordset
    Dim cmd As ADODB.Command
    Dim stCon As String         'SQL Connection string
    Dim stProcName As String    'Stored Procedure name

    'Declare variables for Stored Procedure
    Dim myVariable As Variant
    Dim myReturn As String

    'Set ADODB requirements
    Set cnt = New ADODB.connection
    Set rst = New ADODB.recordset
    Set cmd = New ADODB.Command

    'Define database connection string
    stCon = ""Provider=SQLOLEDB.1;""
    stCon = stCon + ""Data Source=myserver;""
    stCon = stCon + ""Initial Catalogue=Mmydb;""
    stCon = stCon + ""Integrated Security=SSPI;""
    stCon = stCon + ""Persist Security Info=True;""

    'Open database connection
    cnt.ConnectionString = stCon
    cnt.Open

    ' Defines the stored procedure commands
    stProcName = ""dbo.my_sp""                'Define name of Stored Procedure to execute.""
    'stProcName = ""sys.sp_stored_procedures""    'Define name of Stored Procedure to execute.
    cmd.CommandType = adCmdStoredProc           'Define the ADODB command
    cmd.ActiveConnection = cnt                  'Set the command connection string
    cmd.CommandText = stProcName                'Define Stored Procedure to run



    'Execute stored procedure and return to a recordset
    Set rst = cmd.Execute()
    'myReturn = rst.Fields(""procedure_name"").Value
    myReturn = rst.Fields(""mycolumn"").Value

    'Call Sub-Routine_That_Uses_The_Returned_Data
    MsgBox (myReturn)

    'Close database connection and clean up
    If CBool(rst.State And adStateOpen) = True Then rst.Close
    Set rst = Nothing
    
    If CBool(cnt.State And adStateOpen) = True Then cnt.Close
    Set cnt = Nothing
    
    End Sub
",3
5097544,02/23/2011 21:43:00,103897,05/08/2009 23:42:41,357,26,IIS 7 cannot log into Sql Server Database,"I have an IIS 7 application that uses a domain login. (basic settings, connect as)

The application would log in as the server name at first until I set the application in it's own application pool.

Now the application gets the read data from a gridview but when I attempt to get the detailsview with edit permission it fails.

I had the database set to accept the machine as a read/write (and this worked) but I can't use this solution being the application could move to a different machine and I want it to use a specific set of credentials.

Any idea how to solve this?",sql-server-2008,authentication,iis7,,,,open,0,102,8,"IIS 7 cannot log into Sql Server Database I have an IIS 7 application that uses a domain login. (basic settings, connect as)

The application would log in as the server name at first until I set the application in it's own application pool.

Now the application gets the read data from a gridview but when I attempt to get the detailsview with edit permission it fails.

I had the database set to accept the machine as a read/write (and this worked) but I can't use this solution being the application could move to a different machine and I want it to use a specific set of credentials.

Any idea how to solve this?",3
9030234,01/27/2012 07:35:18,1168445,01/25/2012 04:17:18,11,0,counts number of record with like in sqlserver,"I have a SQL server database. I want to count number of records thats their id started from 1112 .(id is string and its format in data base is nchar(7))
I have 20 records that their id is started from 1112 like ""1112000"",""1112001"",""1112002"",....
But when I write this query returns 0!.

    SELECT        COUNT(*) AS num
    FROM           table
    WHERE        (id LIKE '1112*')",sql-server-2008,,,,,,open,0,92,8,"counts number of record with like in sqlserver I have a SQL server database. I want to count number of records thats their id started from 1112 .(id is string and its format in data base is nchar(7))
I have 20 records that their id is started from 1112 like ""1112000"",""1112001"",""1112002"",....
But when I write this query returns 0!.

    SELECT        COUNT(*) AS num
    FROM           table
    WHERE        (id LIKE '1112*')",1
7695365,10/08/2011 07:16:10,974291,10/01/2011 08:29:28,27,2,MS SQL Server 2008 and VmWare Work Station,"I have my MS SQL Server 2008 installed on Windows 7 machine.
can I connect to the server from Windows XP SP3 using VMWare Work Station or this in incompatible.

the server is configured correctely :allow remote connexion, TCP/IP...

thank you.",sql-server-2008,remote-access,vmware-workstation,,,10/08/2011 16:12:21,off topic,1,38,8,"MS SQL Server 2008 and VmWare Work Station I have my MS SQL Server 2008 installed on Windows 7 machine.
can I connect to the server from Windows XP SP3 using VMWare Work Station or this in incompatible.

the server is configured correctely :allow remote connexion, TCP/IP...

thank you.",3
496967,01/30/2009 19:53:05,60784,01/30/2009 19:53:05,1,0,SQL Server 2008 Editions,What are different editions of SQL Server 2008 and how do they differ?,sql-server-2008,,,,,07/29/2012 21:43:37,not constructive,1,13,4,SQL Server 2008 Editions What are different editions of SQL Server 2008 and how do they differ?,1
5025203,02/17/2011 04:58:09,265519,02/03/2010 18:06:08,151,3,Get portion of a table and get 2 tables 1 being updated SQL Server,"I have a table like:

    id NameColumn 
    -------------
    1  var
    2  var2 
    3  var3
    4  var4
    5  var5
    ...  ...
    n  varn

Is there a Way I can get a portion of this table, say, the first 3, and get to tables (the second one in the field 'id' is updated) like:


TABLE1:

    id NameColumn 
    -------------
    1  var
    2  var2 
    3  var3


TABLE2:

    id NameColumn 
    -------------
    1  var4
    2  var5
    3  var6
    4  var7
    ...  ...
    n  varn
   
       

",sql-server-2008,,,,,,open,0,172,14,"Get portion of a table and get 2 tables 1 being updated SQL Server I have a table like:

    id NameColumn 
    -------------
    1  var
    2  var2 
    3  var3
    4  var4
    5  var5
    ...  ...
    n  varn

Is there a Way I can get a portion of this table, say, the first 3, and get to tables (the second one in the field 'id' is updated) like:


TABLE1:

    id NameColumn 
    -------------
    1  var
    2  var2 
    3  var3


TABLE2:

    id NameColumn 
    -------------
    1  var4
    2  var5
    3  var6
    4  var7
    ...  ...
    n  varn
   
       

",1
10305216,04/24/2012 20:04:36,654235,03/10/2011 20:12:18,67,7,"Import Excel Sheet to SQL Server, skip primary key violations","I would like to import an excel file to table in SQL server.  The table has 3 or 4 columns that combine to make a primary key.  I want to be able to run the import at any time, and if ever there is a conflict with the primary key, just simply don't import that row, but continue to import all the other rows.  

I created a *.dtsx file, which does the import fine, but dies the moment it finds a duplicate key. Is there a way to tell the *.dtsx file to continue if it finds a duplicate, and not just die?  I tried opening the *.dtsx file, but there aren't many options, when i right click the *.dtsx file and choose edit, Visual Studio opens up and appears to show me some way of editing the *.dtsx file, but i'm not familiar with it at all.  Any guidance is very appreciated!",sql-server-2008,excel,,,,,open,0,158,10,"Import Excel Sheet to SQL Server, skip primary key violations I would like to import an excel file to table in SQL server.  The table has 3 or 4 columns that combine to make a primary key.  I want to be able to run the import at any time, and if ever there is a conflict with the primary key, just simply don't import that row, but continue to import all the other rows.  

I created a *.dtsx file, which does the import fine, but dies the moment it finds a duplicate key. Is there a way to tell the *.dtsx file to continue if it finds a duplicate, and not just die?  I tried opening the *.dtsx file, but there aren't many options, when i right click the *.dtsx file and choose edit, Visual Studio opens up and appears to show me some way of editing the *.dtsx file, but i'm not familiar with it at all.  Any guidance is very appreciated!",2
7644247,10/04/2011 06:55:22,1155473,09/09/2011 06:51:13,50,1,Could any suggest me doing the below task.?,"I want to arrange the data in one standard format taking columns from three tables.
I am trying to automate the above.
Could any one suggest me the better way of doing the above operation.
1. Using Table valued MultiStatement function
2. Using Stored procedure.

Which could be a better idia to do.


Please do suggest me. I would like to pass column names as a parameter.",sql-server-2008,,,,,10/04/2011 07:09:22,not a real question,1,61,8,"Could any suggest me doing the below task.? I want to arrange the data in one standard format taking columns from three tables.
I am trying to automate the above.
Could any one suggest me the better way of doing the above operation.
1. Using Table valued MultiStatement function
2. Using Stored procedure.

Which could be a better idia to do.


Please do suggest me. I would like to pass column names as a parameter.",1
7360666,09/09/2011 11:00:50,414933,08/09/2010 10:04:17,362,19,How To Rounded to the biggest number In SQL SERVER 2008?,"how to round a number to the minimum number 


like if we have 49 it should be rounded to 45 not 50 !

and if we have 54 it should be rounded to 50.

    SELECT ROUND(49, -1)



thnaks and",sql-server-2008,,,,,,open,0,40,11,"How To Rounded to the biggest number In SQL SERVER 2008? how to round a number to the minimum number 


like if we have 49 it should be rounded to 45 not 50 !

and if we have 54 it should be rounded to 50.

    SELECT ROUND(49, -1)



thnaks and",1
8336019,12/01/2011 02:54:21,184773,10/06/2009 06:16:54,3410,39,Custom database scoring system,"Hi I need to implement a custom scoring system in my database design. My program is a system of tags. My site is a dating site filled with tags about a particular person. A person will search for potential dates by using tags only. Each tag is rated from 1 to 10 depending on the person rates themselves on a certain tag. Here is how it works:

Search query:
Search for a girlfriend or boyfriend

    Tag-------------------Rating
    Good-with-kids--------5
    athletic-figure-------9
    intelligence----------8
    cooking---------------10


In the query above, someone searched for all these tags and their ratings against my database that has a collection of tags where people have rated themselves on these tags.

**My problem:**
When i run the query i can match profiles that contain all the tags. If a user runs a search query I would like the system to capture users that did not match all tags. If a query did not match all tags it should be ranked lower.

Do you know of a good database layout to do this?",sql-server-2008,database-design,,,,12/01/2011 14:16:57,not a real question,1,180,4,"Custom database scoring system Hi I need to implement a custom scoring system in my database design. My program is a system of tags. My site is a dating site filled with tags about a particular person. A person will search for potential dates by using tags only. Each tag is rated from 1 to 10 depending on the person rates themselves on a certain tag. Here is how it works:

Search query:
Search for a girlfriend or boyfriend

    Tag-------------------Rating
    Good-with-kids--------5
    athletic-figure-------9
    intelligence----------8
    cooking---------------10


In the query above, someone searched for all these tags and their ratings against my database that has a collection of tags where people have rated themselves on these tags.

**My problem:**
When i run the query i can match profiles that contain all the tags. If a user runs a search query I would like the system to capture users that did not match all tags. If a query did not match all tags it should be ranked lower.

Do you know of a good database layout to do this?",2
7672343,10/06/2011 09:18:34,558174,12/30/2010 10:37:06,57,4,central subscriber replication in Sql Server 2008 R2,"We have regional office and some data in this office.We want to transfer data from each regional office everyday to central office .For this reason I need central subscriber topology.I implement central subscriber transactional replication but I have a problem ,with transactional replication, if a new regional office want to join these replication,its database must  be empty but when a new software is install on new regional office it fill new database with some rows and then when I setup transactional replication , it dosen't transfer these data to central server, so I think that a merge replication is required .But i searched and didn't find any useful help for implementing ""**central subscriber merge replication**""
.How can I implement ""**central subscriber merge replication**""?

",sql-server-2008,replication,merge-replication,,,01/12/2012 12:30:00,off topic,1,123,8,"central subscriber replication in Sql Server 2008 R2 We have regional office and some data in this office.We want to transfer data from each regional office everyday to central office .For this reason I need central subscriber topology.I implement central subscriber transactional replication but I have a problem ,with transactional replication, if a new regional office want to join these replication,its database must  be empty but when a new software is install on new regional office it fill new database with some rows and then when I setup transactional replication , it dosen't transfer these data to central server, so I think that a merge replication is required .But i searched and didn't find any useful help for implementing ""**central subscriber merge replication**""
.How can I implement ""**central subscriber merge replication**""?

",3
6691141,07/14/2011 09:33:51,370103,06/18/2010 08:20:04,1532,67,SQL Server Agent not running,"None of the SQL Jobs on my server are running. I've looked into this and got the message:

    SQLServerAgent is not currently running so it cannot be notified of this action

How can I get SQL Server Agent to start running on SQL Server 2008?",sql-server-2008,sql-server-agent,sql-job,,,07/14/2011 10:08:47,off topic,1,47,5,"SQL Server Agent not running None of the SQL Jobs on my server are running. I've looked into this and got the message:

    SQLServerAgent is not currently running so it cannot be notified of this action

How can I get SQL Server Agent to start running on SQL Server 2008?",3
10069603,04/09/2012 06:10:51,165309,08/29/2009 09:52:13,1696,37,how to connect sql server 2008 on vmware with local machine sql server 2008 client,I have windows7 professional edition machine. on which i settled up the VMware (windows server 2008) with the sql server 2008. Also I have set up the sql server 2008 client application. I want to access the sql server 2008 on vm database from the local machine sql server client machine. what should i need to do ? and what setting i need to configure?,sql-server-2008,database-connection,vmware,sqlclient,,04/25/2012 12:30:17,off topic,1,65,15,how to connect sql server 2008 on vmware with local machine sql server 2008 client I have windows7 professional edition machine. on which i settled up the VMware (windows server 2008) with the sql server 2008. Also I have set up the sql server 2008 client application. I want to access the sql server 2008 on vm database from the local machine sql server client machine. what should i need to do ? and what setting i need to configure?,4
9134388,02/03/2012 19:29:49,1188287,02/03/2012 19:16:18,1,0,SQL Select statement wont return char fields only numeric fields,"I have been racking my brain over this all day today.
I have the following ASP code that uses a Request.Querystring input from a dropdown box 
to launch a select statement. The querystrinch does show in the ?= URL but will only work on 
columns in the Microsoft SQL DB that are numeric. I cant lookup names or simple 3 character fields.



    CODE:
    If Request.QueryString(""m"") > 0 Then
	filterID = Request.QueryString(""m"")
	filterColmn = ""imDegree""
      Else filterID = 0
    End If

    If filterID > 0 Then
         SQlQuery = ""SELECT * FROM v_InternImport WHERE iID IN (SELECT iID FROM v_InternImport WHERE "" &   filterColmn & "" = "" & filterID & "")""
      End If
    End If

I understand that this select statement as a sub select stament in it but I cant even get a staight reuturn from my DB. The select statement references the same view that populates the main asp page that loads before and the shows fine? 
",sql-server-2008,select,asp-classic,textfield,,,open,0,190,10,"SQL Select statement wont return char fields only numeric fields I have been racking my brain over this all day today.
I have the following ASP code that uses a Request.Querystring input from a dropdown box 
to launch a select statement. The querystrinch does show in the ?= URL but will only work on 
columns in the Microsoft SQL DB that are numeric. I cant lookup names or simple 3 character fields.



    CODE:
    If Request.QueryString(""m"") > 0 Then
	filterID = Request.QueryString(""m"")
	filterColmn = ""imDegree""
      Else filterID = 0
    End If

    If filterID > 0 Then
         SQlQuery = ""SELECT * FROM v_InternImport WHERE iID IN (SELECT iID FROM v_InternImport WHERE "" &   filterColmn & "" = "" & filterID & "")""
      End If
    End If

I understand that this select statement as a sub select stament in it but I cant even get a staight reuturn from my DB. The select statement references the same view that populates the main asp page that loads before and the shows fine? 
",4
11123707,06/20/2012 16:12:45,1152734,01/16/2012 21:38:06,591,35,Accessing the event handler information outside SSIS,"Is there a way to access the event handler information apart from the log tables in SSIS? 
I dont know how to write .net scripts or codes and hence I would need some general direction on this. Thanks",sql-server-2008,event-handling,ssis,event-log,ssis-data-transformations,06/21/2012 16:23:07,not a real question,1,38,7,"Accessing the event handler information outside SSIS Is there a way to access the event handler information apart from the log tables in SSIS? 
I dont know how to write .net scripts or codes and hence I would need some general direction on this. Thanks",5
6785457,07/22/2011 03:50:41,30674,10/23/2008 06:54:58,9824,187,"How can I export some Blog posts from our Sql Server, to a file?","We have a simple website that contains (take your pick, for this example) blog posts / q & a questions / whatever. People upload text (single sentences to paragraphs .. including some white listed/approved html).

I need to export this data into .. a file? something .. so I can give it to someone else.

eg. sample schema

    Id INT
    Title VARCHAR(100)
    UniqueUrl VARCHAR(100)
    Content VARCHAR(MAX)
    ModifiedOn DATETIME
    PublishedOn DATETIME
    CreatedByUserId INTEGER

Is there any way I can export this data into a format that is simple to give to another person to import? I have no idea what they will import it into .. so i was guessing a csv or excel format might be sufficient. That said, one of the fields contains VARCHAR(MAX) which can have paragraphs of text.

Anyone have any suggestions?
",sql-server-2008,export,export-to-excel,,,,open,0,152,14,"How can I export some Blog posts from our Sql Server, to a file? We have a simple website that contains (take your pick, for this example) blog posts / q & a questions / whatever. People upload text (single sentences to paragraphs .. including some white listed/approved html).

I need to export this data into .. a file? something .. so I can give it to someone else.

eg. sample schema

    Id INT
    Title VARCHAR(100)
    UniqueUrl VARCHAR(100)
    Content VARCHAR(MAX)
    ModifiedOn DATETIME
    PublishedOn DATETIME
    CreatedByUserId INTEGER

Is there any way I can export this data into a format that is simple to give to another person to import? I have no idea what they will import it into .. so i was guessing a csv or excel format might be sufficient. That said, one of the fields contains VARCHAR(MAX) which can have paragraphs of text.

Anyone have any suggestions?
",3
2820783,05/12/2010 16:26:55,177534,09/23/2009 02:15:49,542,16,Performing Aggregate Functions on Multi-Million Row Tables,"I'm having some serious performance issues with a multi-million row table that I feel I should be able to get results from fairly quick. Here's a run down of what I have, how I'm querying it, and how long it's taking:

* I'm running SQL Server 2008 Standard, so Partitioning isn't currently an option

* I'm attempting to aggregate all views for all inventory for a specific account over the last 30 days.

* All views are stored in the following table:

<pre>
CREATE TABLE [dbo].[LogInvSearches_Daily](
	[ID] [bigint] IDENTITY(1,1) NOT NULL,
	[Inv_ID] [int] NOT NULL,
	[Site_ID] [int] NOT NULL,
	[LogCount] [int] NOT NULL,
	[LogDay] [smalldatetime] NOT NULL,
 CONSTRAINT [PK_LogInvSearches_Daily] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
</pre>

* This table has 132,000,000 records, and is over 4 gigs.

* A sample of 10 rows from the table:

<pre>
ID                   Inv_ID      Site_ID     LogCount    LogDay
-------------------- ----------- ----------- ----------- -----------------------
1                    486752      48          14          2009-07-21 00:00:00
2                    119314      51          16          2009-07-21 00:00:00
3                    313678      48          25          2009-07-21 00:00:00
4                    298863      0           1           2009-07-21 00:00:00
5                    119996      0           2           2009-07-21 00:00:00
6                    463777      534         7           2009-07-21 00:00:00
7                    339976      503         2           2009-07-21 00:00:00
8                    333501      570         4           2009-07-21 00:00:00
9                    453955      0           12          2009-07-21 00:00:00
10                   443291      0           4           2009-07-21 00:00:00

(10 row(s) affected)
</pre>

* I have the following index on LogInvSearches_Daily:

<pre>
/****** Object:  Index [IX_LogInvSearches_Daily_LogDay]    Script Date: 05/12/2010 11:08:22 ******/
CREATE NONCLUSTERED INDEX [IX_LogInvSearches_Daily_LogDay] ON [dbo].[LogInvSearches_Daily] 
(
	[LogDay] ASC
)
INCLUDE ( [Inv_ID],
[LogCount]) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
</pre>

* I need to pull inventory only from the Inventory for a specific account id. I have an index on the Inventory as well.

I'm using the following query to aggregate the data and give me the top 5 records. This query is currently taking 24 seconds to return the 5 rows:

<pre>
StmtText
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT TOP 5
	Sum(LogCount) AS Views
	, DENSE_RANK() OVER(ORDER BY Sum(LogCount) DESC, Inv_ID DESC) AS Rank
	, Inv_ID
FROM LogInvSearches_Daily D (NOLOCK)
WHERE 
	LogDay > DateAdd(d, -30, getdate())
	AND EXISTS(
		SELECT NULL FROM propertyControlCenter.dbo.Inventory (NOLOCK) WHERE Acct_ID = 18731 AND Inv_ID = D.Inv_ID
	)
GROUP BY Inv_ID


(1 row(s) affected)

StmtText
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  |--Top(TOP EXPRESSION:((5)))
       |--Sequence Project(DEFINE:([Expr1007]=dense_rank))
            |--Segment
                 |--Segment
                      |--Sort(ORDER BY:([Expr1006] DESC, [D].[Inv_ID] DESC))
                           |--Stream Aggregate(GROUP BY:([D].[Inv_ID]) DEFINE:([Expr1006]=SUM([LOALogs].[dbo].[LogInvSearches_Daily].[LogCount] as [D].[LogCount])))
                                |--Sort(ORDER BY:([D].[Inv_ID] ASC))
                                     |--Nested Loops(Inner Join, OUTER REFERENCES:([D].[Inv_ID]))
                                          |--Nested Loops(Inner Join, OUTER REFERENCES:([Expr1011], [Expr1012], [Expr1010]))
                                          |    |--Compute Scalar(DEFINE:(([Expr1011],[Expr1012],[Expr1010])=GetRangeWithMismatchedTypes(dateadd(day,(-30),getdate()),NULL,(6))))
                                          |    |    |--Constant Scan
                                          |    |--Index Seek(OBJECT:([LOALogs].[dbo].[LogInvSearches_Daily].[IX_LogInvSearches_Daily_LogDay] AS [D]), SEEK:([D].[LogDay] &gt; [Expr1011] AND [D].[LogDay] &lt; [Expr1012]) ORDERED FORWARD)
                                          |--Index Seek(OBJECT:([propertyControlCenter].[dbo].[Inventory].[IX_Inventory_Acct_ID]), SEEK:([propertyControlCenter].[dbo].[Inventory].[Acct_ID]=(18731) AND [propertyControlCenter].[dbo].[Inventory].[Inv_ID]=[LOA

(13 row(s) affected)
</pre>

I tried using a CTE to pick up the rows first and aggregate them, but that didn't run any faster, and gives me essentially the same execution plan.

<pre>

(1 row(s) affected)
StmtText
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--SET SHOWPLAN_TEXT ON;
WITH getSearches AS (
		SELECT
			LogCount
--			, DENSE_RANK() OVER(ORDER BY Sum(LogCount) DESC, Inv_ID DESC) AS Rank
			, D.Inv_ID
		FROM LogInvSearches_Daily D (NOLOCK)
			INNER JOIN propertyControlCenter.dbo.Inventory I (NOLOCK) ON Acct_ID = 18731 AND I.Inv_ID = D.Inv_ID
		WHERE 
			LogDay > DateAdd(d, -30, getdate())
--		GROUP BY Inv_ID
)

SELECT Sum(LogCount) AS Views, Inv_ID
FROM getSearches
GROUP BY Inv_ID


(1 row(s) affected)

StmtText
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  |--Stream Aggregate(GROUP BY:([D].[Inv_ID]) DEFINE:([Expr1004]=SUM([LOALogs].[dbo].[LogInvSearches_Daily].[LogCount] as [D].[LogCount])))
       |--Sort(ORDER BY:([D].[Inv_ID] ASC))
            |--Nested Loops(Inner Join, OUTER REFERENCES:([D].[Inv_ID]))
                 |--Nested Loops(Inner Join, OUTER REFERENCES:([Expr1008], [Expr1009], [Expr1007]))
                 |    |--Compute Scalar(DEFINE:(([Expr1008],[Expr1009],[Expr1007])=GetRangeWithMismatchedTypes(dateadd(day,(-30),getdate()),NULL,(6))))
                 |    |    |--Constant Scan
                 |    |--Index Seek(OBJECT:([LOALogs].[dbo].[LogInvSearches_Daily].[IX_LogInvSearches_Daily_LogDay] AS [D]), SEEK:([D].[LogDay] &gt; [Expr1008] AND [D].[LogDay] &lt; [Expr1009]) ORDERED FORWARD)
                 |--Index Seek(OBJECT:([propertyControlCenter].[dbo].[Inventory].[IX_Inventory_Acct_ID] AS [I]), SEEK:([I].[Acct_ID]=(18731) AND [I].[Inv_ID]=[LOALogs].[dbo].[LogInvSearches_Daily].[Inv_ID] as [D].[Inv_ID]) ORDERED FORWARD)

(8 row(s) affected)


(1 row(s) affected)
</pre>

So given that I'm getting good Index Seeks in my execution plan, what can I do to get this running faster?

Thanks,

Dan",sql-server-2008,aggregate-functions,large-data-volumes,,,,open,0,1499,7,"Performing Aggregate Functions on Multi-Million Row Tables I'm having some serious performance issues with a multi-million row table that I feel I should be able to get results from fairly quick. Here's a run down of what I have, how I'm querying it, and how long it's taking:

* I'm running SQL Server 2008 Standard, so Partitioning isn't currently an option

* I'm attempting to aggregate all views for all inventory for a specific account over the last 30 days.

* All views are stored in the following table:

<pre>
CREATE TABLE [dbo].[LogInvSearches_Daily](
	[ID] [bigint] IDENTITY(1,1) NOT NULL,
	[Inv_ID] [int] NOT NULL,
	[Site_ID] [int] NOT NULL,
	[LogCount] [int] NOT NULL,
	[LogDay] [smalldatetime] NOT NULL,
 CONSTRAINT [PK_LogInvSearches_Daily] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
</pre>

* This table has 132,000,000 records, and is over 4 gigs.

* A sample of 10 rows from the table:

<pre>
ID                   Inv_ID      Site_ID     LogCount    LogDay
-------------------- ----------- ----------- ----------- -----------------------
1                    486752      48          14          2009-07-21 00:00:00
2                    119314      51          16          2009-07-21 00:00:00
3                    313678      48          25          2009-07-21 00:00:00
4                    298863      0           1           2009-07-21 00:00:00
5                    119996      0           2           2009-07-21 00:00:00
6                    463777      534         7           2009-07-21 00:00:00
7                    339976      503         2           2009-07-21 00:00:00
8                    333501      570         4           2009-07-21 00:00:00
9                    453955      0           12          2009-07-21 00:00:00
10                   443291      0           4           2009-07-21 00:00:00

(10 row(s) affected)
</pre>

* I have the following index on LogInvSearches_Daily:

<pre>
/****** Object:  Index [IX_LogInvSearches_Daily_LogDay]    Script Date: 05/12/2010 11:08:22 ******/
CREATE NONCLUSTERED INDEX [IX_LogInvSearches_Daily_LogDay] ON [dbo].[LogInvSearches_Daily] 
(
	[LogDay] ASC
)
INCLUDE ( [Inv_ID],
[LogCount]) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
</pre>

* I need to pull inventory only from the Inventory for a specific account id. I have an index on the Inventory as well.

I'm using the following query to aggregate the data and give me the top 5 records. This query is currently taking 24 seconds to return the 5 rows:

<pre>
StmtText
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT TOP 5
	Sum(LogCount) AS Views
	, DENSE_RANK() OVER(ORDER BY Sum(LogCount) DESC, Inv_ID DESC) AS Rank
	, Inv_ID
FROM LogInvSearches_Daily D (NOLOCK)
WHERE 
	LogDay > DateAdd(d, -30, getdate())
	AND EXISTS(
		SELECT NULL FROM propertyControlCenter.dbo.Inventory (NOLOCK) WHERE Acct_ID = 18731 AND Inv_ID = D.Inv_ID
	)
GROUP BY Inv_ID


(1 row(s) affected)

StmtText
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  |--Top(TOP EXPRESSION:((5)))
       |--Sequence Project(DEFINE:([Expr1007]=dense_rank))
            |--Segment
                 |--Segment
                      |--Sort(ORDER BY:([Expr1006] DESC, [D].[Inv_ID] DESC))
                           |--Stream Aggregate(GROUP BY:([D].[Inv_ID]) DEFINE:([Expr1006]=SUM([LOALogs].[dbo].[LogInvSearches_Daily].[LogCount] as [D].[LogCount])))
                                |--Sort(ORDER BY:([D].[Inv_ID] ASC))
                                     |--Nested Loops(Inner Join, OUTER REFERENCES:([D].[Inv_ID]))
                                          |--Nested Loops(Inner Join, OUTER REFERENCES:([Expr1011], [Expr1012], [Expr1010]))
                                          |    |--Compute Scalar(DEFINE:(([Expr1011],[Expr1012],[Expr1010])=GetRangeWithMismatchedTypes(dateadd(day,(-30),getdate()),NULL,(6))))
                                          |    |    |--Constant Scan
                                          |    |--Index Seek(OBJECT:([LOALogs].[dbo].[LogInvSearches_Daily].[IX_LogInvSearches_Daily_LogDay] AS [D]), SEEK:([D].[LogDay] &gt; [Expr1011] AND [D].[LogDay] &lt; [Expr1012]) ORDERED FORWARD)
                                          |--Index Seek(OBJECT:([propertyControlCenter].[dbo].[Inventory].[IX_Inventory_Acct_ID]), SEEK:([propertyControlCenter].[dbo].[Inventory].[Acct_ID]=(18731) AND [propertyControlCenter].[dbo].[Inventory].[Inv_ID]=[LOA

(13 row(s) affected)
</pre>

I tried using a CTE to pick up the rows first and aggregate them, but that didn't run any faster, and gives me essentially the same execution plan.

<pre>

(1 row(s) affected)
StmtText
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--SET SHOWPLAN_TEXT ON;
WITH getSearches AS (
		SELECT
			LogCount
--			, DENSE_RANK() OVER(ORDER BY Sum(LogCount) DESC, Inv_ID DESC) AS Rank
			, D.Inv_ID
		FROM LogInvSearches_Daily D (NOLOCK)
			INNER JOIN propertyControlCenter.dbo.Inventory I (NOLOCK) ON Acct_ID = 18731 AND I.Inv_ID = D.Inv_ID
		WHERE 
			LogDay > DateAdd(d, -30, getdate())
--		GROUP BY Inv_ID
)

SELECT Sum(LogCount) AS Views, Inv_ID
FROM getSearches
GROUP BY Inv_ID


(1 row(s) affected)

StmtText
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  |--Stream Aggregate(GROUP BY:([D].[Inv_ID]) DEFINE:([Expr1004]=SUM([LOALogs].[dbo].[LogInvSearches_Daily].[LogCount] as [D].[LogCount])))
       |--Sort(ORDER BY:([D].[Inv_ID] ASC))
            |--Nested Loops(Inner Join, OUTER REFERENCES:([D].[Inv_ID]))
                 |--Nested Loops(Inner Join, OUTER REFERENCES:([Expr1008], [Expr1009], [Expr1007]))
                 |    |--Compute Scalar(DEFINE:(([Expr1008],[Expr1009],[Expr1007])=GetRangeWithMismatchedTypes(dateadd(day,(-30),getdate()),NULL,(6))))
                 |    |    |--Constant Scan
                 |    |--Index Seek(OBJECT:([LOALogs].[dbo].[LogInvSearches_Daily].[IX_LogInvSearches_Daily_LogDay] AS [D]), SEEK:([D].[LogDay] &gt; [Expr1008] AND [D].[LogDay] &lt; [Expr1009]) ORDERED FORWARD)
                 |--Index Seek(OBJECT:([propertyControlCenter].[dbo].[Inventory].[IX_Inventory_Acct_ID] AS [I]), SEEK:([I].[Acct_ID]=(18731) AND [I].[Inv_ID]=[LOALogs].[dbo].[LogInvSearches_Daily].[Inv_ID] as [D].[Inv_ID]) ORDERED FORWARD)

(8 row(s) affected)


(1 row(s) affected)
</pre>

So given that I'm getting good Index Seeks in my execution plan, what can I do to get this running faster?

Thanks,

Dan",3
11469635,07/13/2012 11:29:48,991096,10/12/2011 09:03:24,1,0,common language for any RDBMS technology,"we are looking for a common language for any RDBMS technology.means if i write q query in SQL SERVER that query have to work on any RDBMS like oracle ,mysql....please help me.",sql-server-2008,,,,,07/15/2012 00:37:01,not constructive,1,32,6,"common language for any RDBMS technology we are looking for a common language for any RDBMS technology.means if i write q query in SQL SERVER that query have to work on any RDBMS like oracle ,mysql....please help me.",1
11718372,07/30/2012 09:08:30,271907,02/12/2010 14:51:34,887,14,Sql Server 2008 mirroring status different for different logins,"We recently had some issues with the failover on a mirrored database: the login kept failing when the primary was down.

On connecting to the database in question with the the login that was failing (in order to check the password) I discovered the reason why. The failover database appeared to be stuck in the ""restoring..."" state rather than ""mirror/synchronised / restoring"" as expected.

However I found this slightly peculiar because the primary server was reporting that mirroring was working correctly. On logging in to the failover DB using an administrative account, it's status reported correctly as ""mirror/synchronised / restoring"".

I've never seen this before - that different accounts looking at the same database can report a different mirroring status. The lower-level access account we usually use behaves in all respects as though the failover DB is stuck in restoring - when you attempt to change permissions, for example, it reports that one of the DB's is inaccessible.

What's caused this curious state of affairs, and how can I fix it?

Cheers,
Matt",sql-server-2008,mirroring,,,,07/31/2012 12:17:17,off topic,1,167,9,"Sql Server 2008 mirroring status different for different logins We recently had some issues with the failover on a mirrored database: the login kept failing when the primary was down.

On connecting to the database in question with the the login that was failing (in order to check the password) I discovered the reason why. The failover database appeared to be stuck in the ""restoring..."" state rather than ""mirror/synchronised / restoring"" as expected.

However I found this slightly peculiar because the primary server was reporting that mirroring was working correctly. On logging in to the failover DB using an administrative account, it's status reported correctly as ""mirror/synchronised / restoring"".

I've never seen this before - that different accounts looking at the same database can report a different mirroring status. The lower-level access account we usually use behaves in all respects as though the failover DB is stuck in restoring - when you attempt to change permissions, for example, it reports that one of the DB's is inaccessible.

What's caused this curious state of affairs, and how can I fix it?

Cheers,
Matt",2
11242903,06/28/2012 10:42:38,1296176,03/27/2012 17:05:53,1,0,syscacheobjects is cleared randomly,"**Microsoft SQL Server Web Edition (64-bit)**

**Version 10.50.1600.1**

**SQL Server 2008 R2**

I have noticed that we are getting a lot of execution plan re-complilcations - first executions quite slow, subsequent calls very fast as you would expect.

However, periodically (after around 10 minutes or so), performances returns to that of the first query i.e. execution is slow again, then fast.

I have read many articles on what could cause this; I have changed auto update statistics to off as suggested.

What I have noticed is that syscacheobjects will build up nicely, with usecounts into the 1,000's - then suddenly the table will be empty, causing all the queries to recompile.

Does anyone know why the cache may be getting flushed like this?

Many thanks

Paul",sql-server-2008,sql-server-2008-r2,,,,06/28/2012 20:02:32,off topic,1,117,4,"syscacheobjects is cleared randomly **Microsoft SQL Server Web Edition (64-bit)**

**Version 10.50.1600.1**

**SQL Server 2008 R2**

I have noticed that we are getting a lot of execution plan re-complilcations - first executions quite slow, subsequent calls very fast as you would expect.

However, periodically (after around 10 minutes or so), performances returns to that of the first query i.e. execution is slow again, then fast.

I have read many articles on what could cause this; I have changed auto update statistics to off as suggested.

What I have noticed is that syscacheobjects will build up nicely, with usecounts into the 1,000's - then suddenly the table will be empty, causing all the queries to recompile.

Does anyone know why the cache may be getting flushed like this?

Many thanks

Paul",2
3051541,06/16/2010 07:59:01,111469,05/23/2009 09:59:06,1190,111,Sotred Procedure could not be found,"We use SQL server 2008 as our RDBMS and we have a database that has a different user rather than dbo as its owner.

The problem is in one machine a stored procedure can not run unless its owner is mentioned.

If we connect to our database using this user and try to execute the following :

    exec ourSP

we get a ""could not find ourSP"" error but this works fine:

    exec user.ourSP

Does anybody knows what can lead to such a strange behavior?",sql-server-2008,stored-procedures,owner,,,,open,0,86,6,"Sotred Procedure could not be found We use SQL server 2008 as our RDBMS and we have a database that has a different user rather than dbo as its owner.

The problem is in one machine a stored procedure can not run unless its owner is mentioned.

If we connect to our database using this user and try to execute the following :

    exec ourSP

we get a ""could not find ourSP"" error but this works fine:

    exec user.ourSP

Does anybody knows what can lead to such a strange behavior?",3
7352672,09/08/2011 18:20:40,935477,09/08/2011 18:20:40,1,0,Wrong cumulative count for dimension level,"I have a dimension hierarchy like this:  Year -> Month Name -> Date.

I'm trying to get a cumulative count of items, so I created a calculated measure using this expression: 

    SUM(null:[Dim Date].[Hierarchy], [Measures].[ParentCount])

It works great for the year level, but I don't understand why i'm getting wrong value for Month and Date.

I've post an image resuming the problem (Sorry I can't include it on the post because i'm a new user on stackoverflow)

http://i.imgur.com/TpPaH.jpg

Like I said, the count for the Year Level is good. What's wrong with the other one? SSAS/MDX is new to me.. I guess something is missing in my calculated measure, or maybe it's my hierarchy ..

Thanks!

",sql-server-2008,ssas,mdx,,,,open,0,114,6,"Wrong cumulative count for dimension level I have a dimension hierarchy like this:  Year -> Month Name -> Date.

I'm trying to get a cumulative count of items, so I created a calculated measure using this expression: 

    SUM(null:[Dim Date].[Hierarchy], [Measures].[ParentCount])

It works great for the year level, but I don't understand why i'm getting wrong value for Month and Date.

I've post an image resuming the problem (Sorry I can't include it on the post because i'm a new user on stackoverflow)

http://i.imgur.com/TpPaH.jpg

Like I said, the count for the Year Level is good. What's wrong with the other one? SSAS/MDX is new to me.. I guess something is missing in my calculated measure, or maybe it's my hierarchy ..

Thanks!

",3
8740699,01/05/2012 10:09:14,1131814,01/05/2012 10:00:28,1,0,how to calculation for hours and minutes in sql,"declare @stdt as datetime='5-jan-2012 9:30:00'
declare @enddt as datetime='10-jan-2012 12:00:00'
declare @Timediff int
select @Timediff=datediff(mi,@stdt,@enddt)
select @Timediff
select CAST(@Timediff / 1440 AS VARCHAR(12)) + ' day(s)  ' + CONVERT(CHAR(8), DATEADD(MINUTE, @Timediff % 1440, '00:00'), 108)AS Timediff

I think this will hell to all.
",sql-server-2008,,,,,01/05/2012 13:16:43,not a real question,1,38,9,"how to calculation for hours and minutes in sql declare @stdt as datetime='5-jan-2012 9:30:00'
declare @enddt as datetime='10-jan-2012 12:00:00'
declare @Timediff int
select @Timediff=datediff(mi,@stdt,@enddt)
select @Timediff
select CAST(@Timediff / 1440 AS VARCHAR(12)) + ' day(s)  ' + CONVERT(CHAR(8), DATEADD(MINUTE, @Timediff % 1440, '00:00'), 108)AS Timediff

I think this will hell to all.
",1
11225104,06/27/2012 11:23:30,199619,10/30/2009 11:59:21,72,4,"SQLSERVER 2008 tracking data changes, triggers","Some background.
I have a normal table, and an ""archive"" table. The archive table contains a record of every row the normal table has ever had, so we can trace row updates and deletes. The tables  are identical, except for archive table having a small number of extra fields (id, datetime, user,insert/update/delete ). The standard table contains one trigger on insert/update/delete. The trigger copies all new rows (insert or update) into archive table, and deleted rows (delete).

Some of the columns are nullable. In archive table, all the fields are nullable (apart from the 'archivy' ones.

The trigger has no begin try or end try. It has no transaction statements. Any unexpected exceptions knocks the who thing off immediately (reading around, expcetions in troggers abort a whoel batch I think).

The trigger contains statements like 'insert into archive.table (field1, field2, field3 etc ) select (field1,field2 etc)'
However, I'm concious of the fact that, if any new columns are added to the main table then error-free processing may continue even if the new field is not added into the archive table or the 'insert' statement. I'm not sure that using '*' is a good idea either (field positions, performance, etc)

I'm keen for an exception to occur if the columns between main and trigger do not match up.
I'm also keen for an exception to occur if any of the fields are missed in the 'insert into archive.table (field1, field2, field3 etc ) select (field1,field2 etc)'

I think possibly using an information schema might be useful here.

I also note that, in a trigger, a RAISERROR('blah blah',17,1) does NOT abort the entire batch/program/transaction immediately.

So, questions then - is this the best (or reasonable) way to track record inserts/updates/deletes?
Anyone know of a way to make triggers fail if any changes to columns occur?
And how to make raiserror abort the whole batch?

Thats not asking too much!
Thanks all.
",sql-server-2008,exception,triggers,,,,open,0,306,6,"SQLSERVER 2008 tracking data changes, triggers Some background.
I have a normal table, and an ""archive"" table. The archive table contains a record of every row the normal table has ever had, so we can trace row updates and deletes. The tables  are identical, except for archive table having a small number of extra fields (id, datetime, user,insert/update/delete ). The standard table contains one trigger on insert/update/delete. The trigger copies all new rows (insert or update) into archive table, and deleted rows (delete).

Some of the columns are nullable. In archive table, all the fields are nullable (apart from the 'archivy' ones.

The trigger has no begin try or end try. It has no transaction statements. Any unexpected exceptions knocks the who thing off immediately (reading around, expcetions in troggers abort a whoel batch I think).

The trigger contains statements like 'insert into archive.table (field1, field2, field3 etc ) select (field1,field2 etc)'
However, I'm concious of the fact that, if any new columns are added to the main table then error-free processing may continue even if the new field is not added into the archive table or the 'insert' statement. I'm not sure that using '*' is a good idea either (field positions, performance, etc)

I'm keen for an exception to occur if the columns between main and trigger do not match up.
I'm also keen for an exception to occur if any of the fields are missed in the 'insert into archive.table (field1, field2, field3 etc ) select (field1,field2 etc)'

I think possibly using an information schema might be useful here.

I also note that, in a trigger, a RAISERROR('blah blah',17,1) does NOT abort the entire batch/program/transaction immediately.

So, questions then - is this the best (or reasonable) way to track record inserts/updates/deletes?
Anyone know of a way to make triggers fail if any changes to columns occur?
And how to make raiserror abort the whole batch?

Thats not asking too much!
Thanks all.
",3
11376649,07/07/2012 16:16:09,1508943,07/07/2012 15:54:58,1,0,write a uery in Sql Serverf for this?,"I have to write a query in sql server from below table:

**Column-1**	**Column-2**	**Column-**3
  x	          Null   	  Null
 Null	           y     	  Null
 Null	         Null	          z


and my output will be:

**Columnname**
    x
    y
    z

Please send me the result as soon as possible.
Regard,
Niranjan",sql-server-2008,,,,,07/08/2012 01:38:03,not a real question,1,92,8,"write a uery in Sql Serverf for this? I have to write a query in sql server from below table:

**Column-1**	**Column-2**	**Column-**3
  x	          Null   	  Null
 Null	           y     	  Null
 Null	         Null	          z


and my output will be:

**Columnname**
    x
    y
    z

Please send me the result as soon as possible.
Regard,
Niranjan",1
11445667,07/12/2012 05:47:23,1519753,07/12/2012 05:34:38,1,0,Sum with group by in outer apply,"As below is my SQL script, i want SUM inv_QTY, but stack with join in group by, kindly advise, thank you.



select ROW_NUMBER()  OVER  (ORDER BY det.inv_id DESC) as RowNumber,

 sum.inv_date as Date,det.inv_id as INV_ID,

 sum.INV_TYPE as Type,

 sum.INV_LOCATION as Location,

 **SUM(sum.INV_QTY) - (sum.INV_USAGE * sum.RowNumber) as OnHandbalance,**

 sum.INV_USAGE as Demand,

 case when sum.INV_USAGE = 0 then 0 else

 cast(sum.INV_QTY / sum.INV_USAGE - sum.RowNumber as int) end as DSB, 

 sum.INV_USAGE * 7 as WeeklyUsage

  
  from OTH_INV_DETAILS det




  
  outer apply
  (
  
  select ROW_NUMBER() OVER(ORDER BY det.INV_ID DESC) as RowNumber, 

  date1.INV_DATE,a.inv_id ,a.INV_TYPE,a.INV_USAGE, b.inv_qty , b.INV_LOCATION

  
  from OTH_INV_DETAILS a join OTH_INV_QTY_LOC b on a.INV_ID = b.INV_ID 




outer apply
(
  select INV_DATE from OTH_INV_CAL



  )date1
  
 
    where 1=1


    and date1.INV_DATE >= '2012-07-10' and date1.INV_DATE <= '2012-12-31'


    and a.INV_ID= 'C5S-CLR-002'


    and b.INV_LOCATION= 'chem Store'
    
)sum





outer apply
(
select top 1 a.inv_id, a.inv_location ,  b.INV_USAGE, (sum.INV_QTY - b.INV_USAGE)  as a

from OTH_INV_QTY_LOC a


join OTH_INV_DETAILS b

on a.INV_ID = b.INV_ID




outer apply
(
  select INV_DATE from OTH_INV_CAL
)date1
 
 
where 1=1

and a.INV_ID = sum.INV_ID

and a.INV_LOCATION = sum.INV_LOCATION


and date1.inv_DATE < sum.INV_DATE

) countdata

where 1=1
and det.inv_id = sum.INV_ID





",sql-server-2008,,,,,07/13/2012 09:19:20,not a real question,1,209,7,"Sum with group by in outer apply As below is my SQL script, i want SUM inv_QTY, but stack with join in group by, kindly advise, thank you.



select ROW_NUMBER()  OVER  (ORDER BY det.inv_id DESC) as RowNumber,

 sum.inv_date as Date,det.inv_id as INV_ID,

 sum.INV_TYPE as Type,

 sum.INV_LOCATION as Location,

 **SUM(sum.INV_QTY) - (sum.INV_USAGE * sum.RowNumber) as OnHandbalance,**

 sum.INV_USAGE as Demand,

 case when sum.INV_USAGE = 0 then 0 else

 cast(sum.INV_QTY / sum.INV_USAGE - sum.RowNumber as int) end as DSB, 

 sum.INV_USAGE * 7 as WeeklyUsage

  
  from OTH_INV_DETAILS det




  
  outer apply
  (
  
  select ROW_NUMBER() OVER(ORDER BY det.INV_ID DESC) as RowNumber, 

  date1.INV_DATE,a.inv_id ,a.INV_TYPE,a.INV_USAGE, b.inv_qty , b.INV_LOCATION

  
  from OTH_INV_DETAILS a join OTH_INV_QTY_LOC b on a.INV_ID = b.INV_ID 




outer apply
(
  select INV_DATE from OTH_INV_CAL



  )date1
  
 
    where 1=1


    and date1.INV_DATE >= '2012-07-10' and date1.INV_DATE <= '2012-12-31'


    and a.INV_ID= 'C5S-CLR-002'


    and b.INV_LOCATION= 'chem Store'
    
)sum





outer apply
(
select top 1 a.inv_id, a.inv_location ,  b.INV_USAGE, (sum.INV_QTY - b.INV_USAGE)  as a

from OTH_INV_QTY_LOC a


join OTH_INV_DETAILS b

on a.INV_ID = b.INV_ID




outer apply
(
  select INV_DATE from OTH_INV_CAL
)date1
 
 
where 1=1

and a.INV_ID = sum.INV_ID

and a.INV_LOCATION = sum.INV_LOCATION


and date1.inv_DATE < sum.INV_DATE

) countdata

where 1=1
and det.inv_id = sum.INV_ID





",1
4389970,12/08/2010 16:45:14,2849,08/25/2008 14:24:20,3026,122,What is the most effecient way to pull thousands of records with hundreds of thousands of child records into class objects?,"I have a scenario where I need to pull approximately 7500 database records where each records has 6 child entity lists. Each of those child lists could be 0 to approximately 125 records.

My class structure kind of looks like this:

    public class Entity
    {
        public int ID { get; set;
        public string Name { get; set; }
        public ICollection<ChildEntity1> Children1 { get; set; }
        public ICollection<ChildEntity2> Children2 { get; set; }
        public ICollection<ChildEntity3> Children3 { get; set; }
        public ICollection<ChildEntity4> Children4 { get; set; }
        ... 2 more collections
    }

After I retrieve all of the Entities, I need to iterate over each one and perform some calculations, call some web services and other various things and ultimately export to a file.

What are the best strategies for retrieving this data from MS Sql Server 2008 using c# 4? Is a DataSet with DataAdapters the best way? ORM?

I want to stay away from select N+1 scenarios for obvious reasons.",sql-server-2008,c#-4.0,data-access,,,,open,0,215,21,"What is the most effecient way to pull thousands of records with hundreds of thousands of child records into class objects? I have a scenario where I need to pull approximately 7500 database records where each records has 6 child entity lists. Each of those child lists could be 0 to approximately 125 records.

My class structure kind of looks like this:

    public class Entity
    {
        public int ID { get; set;
        public string Name { get; set; }
        public ICollection<ChildEntity1> Children1 { get; set; }
        public ICollection<ChildEntity2> Children2 { get; set; }
        public ICollection<ChildEntity3> Children3 { get; set; }
        public ICollection<ChildEntity4> Children4 { get; set; }
        ... 2 more collections
    }

After I retrieve all of the Entities, I need to iterate over each one and perform some calculations, call some web services and other various things and ultimately export to a file.

What are the best strategies for retrieving this data from MS Sql Server 2008 using c# 4? Is a DataSet with DataAdapters the best way? ORM?

I want to stay away from select N+1 scenarios for obvious reasons.",3
