PostId,PostCreationDate,OwnerUserId,OwnerCreationDate,ReputationAtPostCreation,OwnerUndeletedAnswerCountAtPostTime,Title,BodyMarkdown,Tag1,Tag2,Tag3,Tag4,Tag5,PostClosedDate,OpenStatus,OpenStatusInt,BodyLength,TitleLength,TitleConcatWithBody,NumberOfTags
7962219,11/01/2011 03:39:43,1023003,11/01/2011 03:00:20,1,0,"MS SQL Server 2008 R2: Automation of setting options in SSMS (like Generate SET ANSI PADDING command, Auto Generate change scripts, etc)","I just want to install MSSQL 2008 R2 everything automatically.
I figured out ConfigurationFile.ini can be used for automatic installation.
But after that, when it comes to automation of setting options in SSMS like 'Generate SET ANSI PADDING command' and 'Auto generate change scripts', I couldn't find the registry or setting files related to those options. '[Application Data]/Sql Server Management Studio/Settings/CurrentSetting-[date].vssettings' contains some of all options but does not contain others like mentioned above.

To sum up:
**- What is the save location of SSMS options like 'Generate SET ANSI PADDING command' and 'Auto generate change scripts'?
- Is it impossible to automatically configure those options by just manipulating the registry or setting files?**

Help me plz.




",sql-server,sql-server-2008,configuration,ssms,ssms2008,,open,0,111,22,"MS SQL Server 2008 R2: Automation of setting options in SSMS (like Generate SET ANSI PADDING command, Auto Generate change scripts, etc) I just want to install MSSQL 2008 R2 everything automatically.
I figured out ConfigurationFile.ini can be used for automatic installation.
But after that, when it comes to automation of setting options in SSMS like 'Generate SET ANSI PADDING command' and 'Auto generate change scripts', I couldn't find the registry or setting files related to those options. '[Application Data]/Sql Server Management Studio/Settings/CurrentSetting-[date].vssettings' contains some of all options but does not contain others like mentioned above.

To sum up:
**- What is the save location of SSMS options like 'Generate SET ANSI PADDING command' and 'Auto generate change scripts'?
- Is it impossible to automatically configure those options by just manipulating the registry or setting files?**

Help me plz.




",5
11587794,07/20/2012 22:34:35,1541869,07/20/2012 22:01:57,1,0,"Combining Databases with the same tables, different data","I want to combine 5 Access 97 databases to a one big database (preferably SQL Server) that has the same tables but not sure if its the same schema. Has many to many relationships between its tables and need to maintain them. I just want to make sure that I would still be able to link each table to its original database. Each databases has exactly 11 tables with the same names. 
*** I am thinking of adding the database name(a number) to each ID from that database so if the IDs matches, they won't mix up.
*** I found that Access 2007 can migrate my 97 databases to SQLServer.",sql-server,database,ms-access,ms-access-2007,multiple-databases,07/22/2012 15:58:46,not a real question,1,109,8,"Combining Databases with the same tables, different data I want to combine 5 Access 97 databases to a one big database (preferably SQL Server) that has the same tables but not sure if its the same schema. Has many to many relationships between its tables and need to maintain them. I just want to make sure that I would still be able to link each table to its original database. Each databases has exactly 11 tables with the same names. 
*** I am thinking of adding the database name(a number) to each ID from that database so if the IDs matches, they won't mix up.
*** I found that Access 2007 can migrate my 97 databases to SQLServer.",5
7095242,08/17/2011 15:18:50,880242,08/05/2011 09:15:22,10,1,MDX query: How to compare year to date figures from the current year with year to date figures from the previous year?,"With the below MDX queries I am attempting to return a comparison of sales figures.

I want to compare YTD with LYTD, defined as follows:

YTD: 01 Jan this year (01/Jan/2011) until today (17/Aug/2011)

LYTD: 01 Jan last year (01/Jan/2010) until today's date last year (17/Aug/2010)

Both periods should contain the same number of days (give or take one day for leap years).

So far I have tried using the YTD() function to get this year's data but I have not had much success with wrapping the YTD() function in something to get it to return the same dates from last year. I have employed LAG(1) and ParallelPeriod (see both examples below):

    WITH
    MEMBER [Measures].[Sales YTD] AS
    	'SUM(YTD(),[Measures].[Sales])'
    MEMBER [Measures].[Sales LYTD] AS
    	'SUM((YTD(),[Measures].[Sales]).LAG(1))'
    SELECT
    	{[Sales YTD], [Sales LYTD]} ON COLUMNS
        ...

Or

    WITH
    MEMBER [Measures].[Sales YTD] AS
    	'SUM(YTD(),[Measures].[Sales])'
    MEMBER [Measures].[Sales LYTD] AS
    	'SUM(ParallelPeriod(YTD(),1),[Measures].[Sales])'
    SELECT
    	{[Sales YTD], [Sales LYTD]} ON COLUMNS
        ...

The resulting data when using either ParallelPeriod or LAG always returns a column of nulls for Last Year's sales:

    Customer    Sales YTD  Sales LYTD
    ABC Screws	    $1024		(Null)
    ABC Bolts	    $2392		(Null)
    ABC Nuts	    $3735		(Null)

Can anybody suggest changes to the query which will return the correct data, or perhaps offer an alternative strategy to using LAG or ParallelPeriod?",sql-server,query,ssas,mdx,,,open,0,281,22,"MDX query: How to compare year to date figures from the current year with year to date figures from the previous year? With the below MDX queries I am attempting to return a comparison of sales figures.

I want to compare YTD with LYTD, defined as follows:

YTD: 01 Jan this year (01/Jan/2011) until today (17/Aug/2011)

LYTD: 01 Jan last year (01/Jan/2010) until today's date last year (17/Aug/2010)

Both periods should contain the same number of days (give or take one day for leap years).

So far I have tried using the YTD() function to get this year's data but I have not had much success with wrapping the YTD() function in something to get it to return the same dates from last year. I have employed LAG(1) and ParallelPeriod (see both examples below):

    WITH
    MEMBER [Measures].[Sales YTD] AS
    	'SUM(YTD(),[Measures].[Sales])'
    MEMBER [Measures].[Sales LYTD] AS
    	'SUM((YTD(),[Measures].[Sales]).LAG(1))'
    SELECT
    	{[Sales YTD], [Sales LYTD]} ON COLUMNS
        ...

Or

    WITH
    MEMBER [Measures].[Sales YTD] AS
    	'SUM(YTD(),[Measures].[Sales])'
    MEMBER [Measures].[Sales LYTD] AS
    	'SUM(ParallelPeriod(YTD(),1),[Measures].[Sales])'
    SELECT
    	{[Sales YTD], [Sales LYTD]} ON COLUMNS
        ...

The resulting data when using either ParallelPeriod or LAG always returns a column of nulls for Last Year's sales:

    Customer    Sales YTD  Sales LYTD
    ABC Screws	    $1024		(Null)
    ABC Bolts	    $2392		(Null)
    ABC Nuts	    $3735		(Null)

Can anybody suggest changes to the query which will return the correct data, or perhaps offer an alternative strategy to using LAG or ParallelPeriod?",4
1060230,06/29/2009 20:08:16,21155,09/23/2008 14:37:57,443,23,Summarizing data by multiple columns,"My boss is asking me to code a report that has the following components:

* A pie chart of employee count by state
* A pie chart of employee count by age bracket (10 year brackets)
* A pie chart of employee length of service (5 year brackets)
* A pie chart of employee Male/Female breakdown
* A pie chart of employee count by salary band (computer generates brackets).

There may be others.

I know I can do this by writting 5 different sql statements. However it seems like this would generate 5 table scans for one report.

I could switch gears and do one table scan and analyse each record on the front end and increment counters and probably accomplish this with one-pass.

Which way would the collective wisdom at stackoverflow go on this?

Is there a way to accomplish this with the CUBE or ROLL UP clauses in T-SQL?

 

",sql-server,c#,,,,,open,0,142,5,"Summarizing data by multiple columns My boss is asking me to code a report that has the following components:

* A pie chart of employee count by state
* A pie chart of employee count by age bracket (10 year brackets)
* A pie chart of employee length of service (5 year brackets)
* A pie chart of employee Male/Female breakdown
* A pie chart of employee count by salary band (computer generates brackets).

There may be others.

I know I can do this by writting 5 different sql statements. However it seems like this would generate 5 table scans for one report.

I could switch gears and do one table scan and analyse each record on the front end and increment counters and probably accomplish this with one-pass.

Which way would the collective wisdom at stackoverflow go on this?

Is there a way to accomplish this with the CUBE or ROLL UP clauses in T-SQL?

 

",2
10892038,06/05/2012 05:26:52,1407421,05/21/2012 08:42:56,120,32,SQL Server Memory Management,"I Convert Data From OldDatabase and NewDatabase Use SSIS.

System Property is :

 1. Windows Server 2008 R2 Enterprise
 2. 16 GB Memory
 3. CPU 12 Core

When my convert started, CPU usage become about 3% - 10% and memory Usage become full.
when memory usage become full, my convert becom Slow.
How I can free memory usage after each package or each dataflow task in ssis execute.",sql-server,sql-server-2008,ssis,,,06/05/2012 13:00:08,off topic,1,64,4,"SQL Server Memory Management I Convert Data From OldDatabase and NewDatabase Use SSIS.

System Property is :

 1. Windows Server 2008 R2 Enterprise
 2. 16 GB Memory
 3. CPU 12 Core

When my convert started, CPU usage become about 3% - 10% and memory Usage become full.
when memory usage become full, my convert becom Slow.
How I can free memory usage after each package or each dataflow task in ssis execute.",3
11734693,07/31/2012 06:53:41,281839,02/26/2010 06:30:28,572,1,SQL Server 2012 installation failure An error occurred for a dependency of the feature causing the setup process for the feature to fail,"I am installing SQL Server 2012 Developer (from ISO image written on DVD), my machine has Windows 7 and it already has SQL Express and SQL 2008 R2 Express installed in it.

On running 2012 setup it goes fine from Setup Support Rules to Installation Progress. In  Installation Progress after some progress installation fails.


**Windows show the following components couldn't installed:**
Managment Tools Complete  Failed. Client Tools Connectivity Failed. Client Tools SDK Failed. Client Tools Backwards Compantibility Failed. Managment Tools Basic Failed. SQL Server Data Tools Failed. Reporting Services -Native Failed. Database Engine Services Failed. Data Quality Services Failed. full-Text and Semantic Extractins for Search Failed. SQL Server Replication Failed. Integration Services Failed. Analysis Services Failed. SQL Client Connectivity SDK Failed.


In detail for failure of every component it provide these details:

**Action required:**
Use the following information to resolve the error, and then try the setup process again.
**Feature failure reason:**
An error occurred for a dependency of the feature causing the setup process for the feature to fail.

In summary log file it provide the following details:

Overall summary:
  Final result:                  Failed: see details below
  Exit code (Decimal):           -2068643839
  Start time:                    2012-07-31 16:23:37
  End time:                      2012-07-31 16:33:32
  Requested action:              Install

Setup completed with required actions for features.
Troubleshooting information for those features:
  Next step for Adv_SSMS:        Use the following information to resolve the error, and then try the setup process again.
  Next step for Conn:            Use the following information to resolve the error, and then try the setup process again.
  Next step for SDK:             Use the following information to resolve the error, and then try the setup process again.
  Next step for BC:              Use the following information to resolve the error, and then try the setup process again.
  Next step for SSMS:            Use the following information to resolve the error, and then try the setup process again.
  Next step for BIDS:            Use the following information to resolve the error, and then try the setup process again.
  Next step for RS:              Use the following information to resolve the error, and then try the setup process again.
  Next step for SQLEngine:       Use the following information to resolve the error, and then try the setup process again.
  Next step for DQ:              Use the following information to resolve the error, and then try the setup process again.
  Next step for FullText:        Use the following information to resolve the error, and then try the setup process again.
  Next step for Replication:     Use the following information to resolve the error, and then try the setup process again.
  Next step for IS:              Use the following information to resolve the error, and then try the setup process again.
  Next step for AS:              Use the following information to resolve the error, and then try the setup process again.
  Next step for SNAC_SDK:        Use the following information to resolve the error, and then try the setup process again.


Machine Properties:
  Machine name:                  Haansi-PC
  Machine processor count:       4
  OS version:                    Windows 7
  OS service pack:               Service Pack 1
  OS region:                     United States
  OS language:                   English (United States)
  OS architecture:               x64
  Process architecture:          64 Bit
  OS clustered:                  No

Product features discovered:
  Product              Instance             Instance ID                    Feature                                  Language             Edition              Version         Clustered
  SQL Server 2005      SQLEXPRESS           MSSQL.1                        Database Engine Services                 1033                 Express Edition      9.4.5000        No        
  SQL Server 2005      SQLEXPRESS           MSSQL.1                        SQL Server Replication                   1033                 Express Edition      9.4.5000        No        
  SQL Server 2005      SQLEXPRESS           MSSQL.1                        SharedTools                              1033                 Express Edition      9.4.5000        No        
  SQL Server 2005                                                          Tools                                    1033                 Express Edition      9.4.5000        No        
  SQL Server 2005                                                          ToolsClient                              1033                 Express Edition      9.4.5000        No        
  SQL Server 2005                                                          ToolsClient\Connectivity                 1033                 Express Edition      9.4.5000        No        
  SQL Server 2008 R2   SQLSERVER08EXPR2     MSSQL10_50.SQLSERVER08EXPR2    Database Engine Services                 1033                 Express Edition      10.50.1617.0    No        
  SQL Server 2008 R2   SQLSERVER08EXPR2     MSSQL10_50.SQLSERVER08EXPR2    SQL Server Replication                   1033                 Express Edition      10.50.1617.0    No        
  SQL Server 2008 R2                                                       Management Tools - Basic                 1033                 Express Edition      10.50.1617.0    No        
  SQL Server 2012                                                          LocalDB                                  1033                 Express Edition      11.0.2318.0     No        
  SQL Server 2012                                                          Reporting Services - SharePoint                                                    11.0.2100.60    No        

Package properties:
  Description:                   Microsoft SQL Server 2012
  ProductName:                   SQL Server 2012
  Type:                          RTM
  Version:                       11
  SPLevel:                       0
  Installation location:         F:\x64\setup\
  Installation edition:          Developer

Product Update Status:
  None discovered.

User Input Settings:
  ACTION:                        Install
  ADDCURRENTUSERASSQLADMIN:      false
  AGTSVCACCOUNT:                 NT Service\SQLAgent$SS2012
  AGTSVCPASSWORD:                *****
  AGTSVCSTARTUPTYPE:             Manual
  ASBACKUPDIR:                   C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Backup
  ASCOLLATION:                   Latin1_General_CI_AS
  ASCONFIGDIR:                   C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Config
  ASDATADIR:                     C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Data
  ASLOGDIR:                      C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Log
  ASPROVIDERMSOLAP:              1
  ASSERVERMODE:                  TABULAR
  ASSVCACCOUNT:                  NT Service\MSOLAP$SS2012
  ASSVCPASSWORD:                 <empty>
  ASSVCSTARTUPTYPE:              Manual
  ASSYSADMINACCOUNTS:            PC\Haansi
  ASTEMPDIR:                     C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Temp
  BROWSERSVCSTARTUPTYPE:         Automatic
  CLTCTLRNAME:                   <empty>
  CLTRESULTDIR:                  <empty>
  CLTSTARTUPTYPE:                0
  CLTSVCACCOUNT:                 <empty>
  CLTSVCPASSWORD:                <empty>
  CLTWORKINGDIR:                 <empty>
  COMMFABRICENCRYPTION:          0
  COMMFABRICNETWORKLEVEL:        0
  COMMFABRICPORT:                0
  CONFIGURATIONFILE:             C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\Log\20120731_161013\ConfigurationFile.ini
  CTLRSTARTUPTYPE:               0
  CTLRSVCACCOUNT:                <empty>
  CTLRSVCPASSWORD:               <empty>
  CTLRUSERS:                     <empty>
  ENABLERANU:                    false
  ENU:                           true
  ERRORREPORTING:                false
  FEATURES:                      SQLENGINE, REPLICATION, FULLTEXT, DQ, AS, RS, BIDS, CONN, IS, BC, SDK, SSMS, ADV_SSMS, SNAC_SDK
  FILESTREAMLEVEL:               0
  FILESTREAMSHARENAME:           <empty>
  FTSVCACCOUNT:                  NT Service\MSSQLFDLauncher$SS2012
  FTSVCPASSWORD:                 <empty>
  HELP:                          false
  INDICATEPROGRESS:              false
  INSTALLSHAREDDIR:              C:\Program Files\Microsoft SQL Server\
  INSTALLSHAREDWOWDIR:           C:\Program Files (x86)\Microsoft SQL Server\
  INSTALLSQLDATADIR:             <empty>
  INSTANCEDIR:                   C:\Program Files\Microsoft SQL Server\
  INSTANCEID:                    SS2012
  INSTANCENAME:                  SS2012
  ISSVCACCOUNT:                  NT Service\MsDtsServer110
  ISSVCPASSWORD:                 <empty>
  ISSVCSTARTUPTYPE:              Automatic
  MATRIXCMBRICKCOMMPORT:         0
  MATRIXCMSERVERNAME:            <empty>
  MATRIXNAME:                    <empty>
  NPENABLED:                     0
  PID:                           *****
  QUIET:                         false
  QUIETSIMPLE:                   false
  ROLE:                          <empty>
  RSINSTALLMODE:                 DefaultNativeMode
  RSSHPINSTALLMODE:              DefaultSharePointMode
  RSSVCACCOUNT:                  NT Service\ReportServer$SS2012
  RSSVCPASSWORD:                 <empty>
  RSSVCSTARTUPTYPE:              Manual
  SAPWD:                         <empty>
  SECURITYMODE:                  <empty>
  SQLBACKUPDIR:                  <empty>
  SQLCOLLATION:                  SQL_Latin1_General_CP1_CI_AS
  SQLSVCACCOUNT:                 NT Service\MSSQL$SS2012
  SQLSVCPASSWORD:                <empty>
  SQLSVCSTARTUPTYPE:             Automatic
  SQLSYSADMINACCOUNTS:           Haansi-PC\Haansi
  SQLTEMPDBDIR:                  <empty>
  SQLTEMPDBLOGDIR:               <empty>
  SQLUSERDBDIR:                  <empty>
  SQLUSERDBLOGDIR:               <empty>
  SQMREPORTING:                  false
  TCPENABLED:                    0
  UIMODE:                        Normal
  UpdateEnabled:                 true
  UpdateSource:                  MU
  X86:                           false

  Configuration file:            C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\Log\20120731_161013\ConfigurationFile.ini

Detailed results:
  Feature:                       Management Tools - Complete
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Client Tools Connectivity
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Client Tools SDK
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Client Tools Backwards Compatibility
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Management Tools - Basic
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       SQL Server Data Tools
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Reporting Services - Native
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Database Engine Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Data Quality Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Full-Text and Semantic Extractions for Search
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       SQL Server Replication
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Integration Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Analysis Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       SQL Client Connectivity SDK
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred during the setup process of the feature.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

Rules with failures:

Global rules:

Scenario specific rules:

Rules report file:               C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\Log\20120731_161013\SystemConfigurationCheck_Report.htm

",sql-server,sql-server-2012,,,,08/01/2012 13:53:02,off topic,1,5868,23,"SQL Server 2012 installation failure An error occurred for a dependency of the feature causing the setup process for the feature to fail I am installing SQL Server 2012 Developer (from ISO image written on DVD), my machine has Windows 7 and it already has SQL Express and SQL 2008 R2 Express installed in it.

On running 2012 setup it goes fine from Setup Support Rules to Installation Progress. In  Installation Progress after some progress installation fails.


**Windows show the following components couldn't installed:**
Managment Tools Complete  Failed. Client Tools Connectivity Failed. Client Tools SDK Failed. Client Tools Backwards Compantibility Failed. Managment Tools Basic Failed. SQL Server Data Tools Failed. Reporting Services -Native Failed. Database Engine Services Failed. Data Quality Services Failed. full-Text and Semantic Extractins for Search Failed. SQL Server Replication Failed. Integration Services Failed. Analysis Services Failed. SQL Client Connectivity SDK Failed.


In detail for failure of every component it provide these details:

**Action required:**
Use the following information to resolve the error, and then try the setup process again.
**Feature failure reason:**
An error occurred for a dependency of the feature causing the setup process for the feature to fail.

In summary log file it provide the following details:

Overall summary:
  Final result:                  Failed: see details below
  Exit code (Decimal):           -2068643839
  Start time:                    2012-07-31 16:23:37
  End time:                      2012-07-31 16:33:32
  Requested action:              Install

Setup completed with required actions for features.
Troubleshooting information for those features:
  Next step for Adv_SSMS:        Use the following information to resolve the error, and then try the setup process again.
  Next step for Conn:            Use the following information to resolve the error, and then try the setup process again.
  Next step for SDK:             Use the following information to resolve the error, and then try the setup process again.
  Next step for BC:              Use the following information to resolve the error, and then try the setup process again.
  Next step for SSMS:            Use the following information to resolve the error, and then try the setup process again.
  Next step for BIDS:            Use the following information to resolve the error, and then try the setup process again.
  Next step for RS:              Use the following information to resolve the error, and then try the setup process again.
  Next step for SQLEngine:       Use the following information to resolve the error, and then try the setup process again.
  Next step for DQ:              Use the following information to resolve the error, and then try the setup process again.
  Next step for FullText:        Use the following information to resolve the error, and then try the setup process again.
  Next step for Replication:     Use the following information to resolve the error, and then try the setup process again.
  Next step for IS:              Use the following information to resolve the error, and then try the setup process again.
  Next step for AS:              Use the following information to resolve the error, and then try the setup process again.
  Next step for SNAC_SDK:        Use the following information to resolve the error, and then try the setup process again.


Machine Properties:
  Machine name:                  Haansi-PC
  Machine processor count:       4
  OS version:                    Windows 7
  OS service pack:               Service Pack 1
  OS region:                     United States
  OS language:                   English (United States)
  OS architecture:               x64
  Process architecture:          64 Bit
  OS clustered:                  No

Product features discovered:
  Product              Instance             Instance ID                    Feature                                  Language             Edition              Version         Clustered
  SQL Server 2005      SQLEXPRESS           MSSQL.1                        Database Engine Services                 1033                 Express Edition      9.4.5000        No        
  SQL Server 2005      SQLEXPRESS           MSSQL.1                        SQL Server Replication                   1033                 Express Edition      9.4.5000        No        
  SQL Server 2005      SQLEXPRESS           MSSQL.1                        SharedTools                              1033                 Express Edition      9.4.5000        No        
  SQL Server 2005                                                          Tools                                    1033                 Express Edition      9.4.5000        No        
  SQL Server 2005                                                          ToolsClient                              1033                 Express Edition      9.4.5000        No        
  SQL Server 2005                                                          ToolsClient\Connectivity                 1033                 Express Edition      9.4.5000        No        
  SQL Server 2008 R2   SQLSERVER08EXPR2     MSSQL10_50.SQLSERVER08EXPR2    Database Engine Services                 1033                 Express Edition      10.50.1617.0    No        
  SQL Server 2008 R2   SQLSERVER08EXPR2     MSSQL10_50.SQLSERVER08EXPR2    SQL Server Replication                   1033                 Express Edition      10.50.1617.0    No        
  SQL Server 2008 R2                                                       Management Tools - Basic                 1033                 Express Edition      10.50.1617.0    No        
  SQL Server 2012                                                          LocalDB                                  1033                 Express Edition      11.0.2318.0     No        
  SQL Server 2012                                                          Reporting Services - SharePoint                                                    11.0.2100.60    No        

Package properties:
  Description:                   Microsoft SQL Server 2012
  ProductName:                   SQL Server 2012
  Type:                          RTM
  Version:                       11
  SPLevel:                       0
  Installation location:         F:\x64\setup\
  Installation edition:          Developer

Product Update Status:
  None discovered.

User Input Settings:
  ACTION:                        Install
  ADDCURRENTUSERASSQLADMIN:      false
  AGTSVCACCOUNT:                 NT Service\SQLAgent$SS2012
  AGTSVCPASSWORD:                *****
  AGTSVCSTARTUPTYPE:             Manual
  ASBACKUPDIR:                   C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Backup
  ASCOLLATION:                   Latin1_General_CI_AS
  ASCONFIGDIR:                   C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Config
  ASDATADIR:                     C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Data
  ASLOGDIR:                      C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Log
  ASPROVIDERMSOLAP:              1
  ASSERVERMODE:                  TABULAR
  ASSVCACCOUNT:                  NT Service\MSOLAP$SS2012
  ASSVCPASSWORD:                 <empty>
  ASSVCSTARTUPTYPE:              Manual
  ASSYSADMINACCOUNTS:            PC\Haansi
  ASTEMPDIR:                     C:\Program Files\Microsoft SQL Server\MSAS11.SS2012\OLAP\Temp
  BROWSERSVCSTARTUPTYPE:         Automatic
  CLTCTLRNAME:                   <empty>
  CLTRESULTDIR:                  <empty>
  CLTSTARTUPTYPE:                0
  CLTSVCACCOUNT:                 <empty>
  CLTSVCPASSWORD:                <empty>
  CLTWORKINGDIR:                 <empty>
  COMMFABRICENCRYPTION:          0
  COMMFABRICNETWORKLEVEL:        0
  COMMFABRICPORT:                0
  CONFIGURATIONFILE:             C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\Log\20120731_161013\ConfigurationFile.ini
  CTLRSTARTUPTYPE:               0
  CTLRSVCACCOUNT:                <empty>
  CTLRSVCPASSWORD:               <empty>
  CTLRUSERS:                     <empty>
  ENABLERANU:                    false
  ENU:                           true
  ERRORREPORTING:                false
  FEATURES:                      SQLENGINE, REPLICATION, FULLTEXT, DQ, AS, RS, BIDS, CONN, IS, BC, SDK, SSMS, ADV_SSMS, SNAC_SDK
  FILESTREAMLEVEL:               0
  FILESTREAMSHARENAME:           <empty>
  FTSVCACCOUNT:                  NT Service\MSSQLFDLauncher$SS2012
  FTSVCPASSWORD:                 <empty>
  HELP:                          false
  INDICATEPROGRESS:              false
  INSTALLSHAREDDIR:              C:\Program Files\Microsoft SQL Server\
  INSTALLSHAREDWOWDIR:           C:\Program Files (x86)\Microsoft SQL Server\
  INSTALLSQLDATADIR:             <empty>
  INSTANCEDIR:                   C:\Program Files\Microsoft SQL Server\
  INSTANCEID:                    SS2012
  INSTANCENAME:                  SS2012
  ISSVCACCOUNT:                  NT Service\MsDtsServer110
  ISSVCPASSWORD:                 <empty>
  ISSVCSTARTUPTYPE:              Automatic
  MATRIXCMBRICKCOMMPORT:         0
  MATRIXCMSERVERNAME:            <empty>
  MATRIXNAME:                    <empty>
  NPENABLED:                     0
  PID:                           *****
  QUIET:                         false
  QUIETSIMPLE:                   false
  ROLE:                          <empty>
  RSINSTALLMODE:                 DefaultNativeMode
  RSSHPINSTALLMODE:              DefaultSharePointMode
  RSSVCACCOUNT:                  NT Service\ReportServer$SS2012
  RSSVCPASSWORD:                 <empty>
  RSSVCSTARTUPTYPE:              Manual
  SAPWD:                         <empty>
  SECURITYMODE:                  <empty>
  SQLBACKUPDIR:                  <empty>
  SQLCOLLATION:                  SQL_Latin1_General_CP1_CI_AS
  SQLSVCACCOUNT:                 NT Service\MSSQL$SS2012
  SQLSVCPASSWORD:                <empty>
  SQLSVCSTARTUPTYPE:             Automatic
  SQLSYSADMINACCOUNTS:           Haansi-PC\Haansi
  SQLTEMPDBDIR:                  <empty>
  SQLTEMPDBLOGDIR:               <empty>
  SQLUSERDBDIR:                  <empty>
  SQLUSERDBLOGDIR:               <empty>
  SQMREPORTING:                  false
  TCPENABLED:                    0
  UIMODE:                        Normal
  UpdateEnabled:                 true
  UpdateSource:                  MU
  X86:                           false

  Configuration file:            C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\Log\20120731_161013\ConfigurationFile.ini

Detailed results:
  Feature:                       Management Tools - Complete
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Client Tools Connectivity
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Client Tools SDK
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Client Tools Backwards Compatibility
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Management Tools - Basic
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       SQL Server Data Tools
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Reporting Services - Native
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Database Engine Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Data Quality Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Full-Text and Semantic Extractions for Search
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       SQL Server Replication
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Integration Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       Analysis Services
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred for a dependency of the feature causing the setup process for the feature to fail.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

  Feature:                       SQL Client Connectivity SDK
  Status:                        Failed: see logs for details
  Reason for failure:            An error occurred during the setup process of the feature.
  Next Step:                     Use the following information to resolve the error, and then try the setup process again.

Rules with failures:

Global rules:

Scenario specific rules:

Rules report file:               C:\Program Files\Microsoft SQL Server\110\Setup Bootstrap\Log\20120731_161013\SystemConfigurationCheck_Report.htm

",2
11081993,06/18/2012 11:36:30,343225,12/19/2009 16:51:21,68,8,Connecting Doctrine 2 to MSSQL For SYMFONY 2 On Linux,"I am trying to use Doctrine 2 (for Symfony 2) to connect to MSSQLServer from a linux machine.

I have installed pdo_dblib (PDO Driver for FreeTDS/Sybase DB-lib) and am able to connect to the db server via tsql on the command line and from the php cli also. Thus I know this is working.

In my Symfony/app/config/parameters.ini file I had specified database_driver=""pdo_sqlsrv"" as the database driver (as I read that this would be handled by db_lib) but when trying to run a create database command (using the command php app/console doctrine:database:create) I am getting the error:

""Could not create database for connection named <dbname> could not find driver""

I then changed the driver to database_driver=""pdo_dblib"" and I am now getting the error:

[Doctrine\DBAL\DBALException]                                                                                                                                                   
The given 'driver' pdo_dblib is unknown, Doctrine currently supports only the following drivers: pdo_mysql, pdo_sqlite, pdo_pgsql, pdo_oci, oci8, ibm_db2, pdo_ibm, pdo_sqlsrv 

So it seems that to connect to MSSQL my only option is pdo_sqlsrv, so I went to install this. however, I have just discovered here, http://php.net/manual/en/ref.pdo-sqlsrv.php, that ""The PDO_SQLSRV extension is only compatible with PHP running on Windows."".

Thus the driver supported by doctrine and those available to use on linux seem to be mutually exlusive.  From searching I haven't found any instances of this issue being solved thus far (One guy marked the issue as solved, but when I read the thread he had simply moved his dev env to a windows box... not exactly what I had in mind!).

Any help/pointers gratefully received, as time is of the essence!

Rob Ganly


",sql-server,linux,php5,symfony-2.0,doctrine2,,open,0,396,10,"Connecting Doctrine 2 to MSSQL For SYMFONY 2 On Linux I am trying to use Doctrine 2 (for Symfony 2) to connect to MSSQLServer from a linux machine.

I have installed pdo_dblib (PDO Driver for FreeTDS/Sybase DB-lib) and am able to connect to the db server via tsql on the command line and from the php cli also. Thus I know this is working.

In my Symfony/app/config/parameters.ini file I had specified database_driver=""pdo_sqlsrv"" as the database driver (as I read that this would be handled by db_lib) but when trying to run a create database command (using the command php app/console doctrine:database:create) I am getting the error:

""Could not create database for connection named <dbname> could not find driver""

I then changed the driver to database_driver=""pdo_dblib"" and I am now getting the error:

[Doctrine\DBAL\DBALException]                                                                                                                                                   
The given 'driver' pdo_dblib is unknown, Doctrine currently supports only the following drivers: pdo_mysql, pdo_sqlite, pdo_pgsql, pdo_oci, oci8, ibm_db2, pdo_ibm, pdo_sqlsrv 

So it seems that to connect to MSSQL my only option is pdo_sqlsrv, so I went to install this. however, I have just discovered here, http://php.net/manual/en/ref.pdo-sqlsrv.php, that ""The PDO_SQLSRV extension is only compatible with PHP running on Windows."".

Thus the driver supported by doctrine and those available to use on linux seem to be mutually exlusive.  From searching I haven't found any instances of this issue being solved thus far (One guy marked the issue as solved, but when I read the thread he had simply moved his dev env to a windows box... not exactly what I had in mind!).

Any help/pointers gratefully received, as time is of the essence!

Rob Ganly


",5
10693962,05/21/2012 23:31:44,590421,01/26/2011 10:27:46,422,3,Does perf counters on the primary machine reflect the values on the mirror for Sql Server?,Is it enough if we monitor the Database Mirroring RedoQueue KB performance object on the primary and not on the mirror? I find that the value is the same if collected on the primary or the mirror.,sql-server,sql-server-2008,perfmon,,,05/22/2012 12:13:56,not a real question,1,37,16,Does perf counters on the primary machine reflect the values on the mirror for Sql Server? Is it enough if we monitor the Database Mirroring RedoQueue KB performance object on the primary and not on the mirror? I find that the value is the same if collected on the primary or the mirror.,3
468448,01/22/2009 08:47:13,53262,01/09/2009 09:32:42,6,1,Swap two records excluding few coloums using Stored Procedure in SQl 2000/2005,"How to create a Stored procedure (SQL 2005/2000) to swap 2 records excluding few columns, it has to get ""table name"", ""record id (2 id)"" and ""column to exclude"" as a parameter.  Here columns are dynamic as we get 'table' as a parameter and number of columns may be more than 50.  

Here I believe, ""update [table name] set [field] = [value] ......""

type statements will be very lengthy as the number of columns will be more than 50 and it is a variant.    

Is there any simple way to Swap records in SQL 2005/2000?

",sql-server,,,,,,open,0,99,12,"Swap two records excluding few coloums using Stored Procedure in SQl 2000/2005 How to create a Stored procedure (SQL 2005/2000) to swap 2 records excluding few columns, it has to get ""table name"", ""record id (2 id)"" and ""column to exclude"" as a parameter.  Here columns are dynamic as we get 'table' as a parameter and number of columns may be more than 50.  

Here I believe, ""update [table name] set [field] = [value] ......""

type statements will be very lengthy as the number of columns will be more than 50 and it is a variant.    

Is there any simple way to Swap records in SQL 2005/2000?

",1
28360,08/26/2008 15:24:42,2894,08/25/2008 20:06:55,23,6,Moving SQL based reports to Data cubes,"I am about to migrate a bunch of seriously over-complex Reports (MS SQL report server over some horrible stored procedures) to something more BI based.  I was wondering if anybody had any pointers, gotchas, or general advice on the best way to do this.  Thanks.",sql-server,report,bi,,,09/11/2008 16:13:15,off topic,1,47,7,"Moving SQL based reports to Data cubes I am about to migrate a bunch of seriously over-complex Reports (MS SQL report server over some horrible stored procedures) to something more BI based.  I was wondering if anybody had any pointers, gotchas, or general advice on the best way to do this.  Thanks.",3
1399231,09/09/2009 11:54:12,131809,07/01/2009 16:03:48,157,15,Upgrading from SQL 2000 - 2008 - Log Shipping,"I'm in the process of upgrading from SQL 2000 - SQL 2008
Would it be possible (or feasable) to set up log shipping from Server A - that has the sql 2000 database on, to Server B - that has the SQL 2008 instance on

Or is there a better way of upgrading?

I need to obviously test my application using the new SQL 2008 instance....",sql-server,,,,,,open,0,63,9,"Upgrading from SQL 2000 - 2008 - Log Shipping I'm in the process of upgrading from SQL 2000 - SQL 2008
Would it be possible (or feasable) to set up log shipping from Server A - that has the sql 2000 database on, to Server B - that has the SQL 2008 instance on

Or is there a better way of upgrading?

I need to obviously test my application using the new SQL 2008 instance....",1
11546413,07/18/2012 16:48:54,1535451,07/18/2012 16:12:38,1,0,Looking for a page open timestamp,"I have an internal website that opens on a helpdesk phone call and submits data to SQL based on the user choices. In two of my SQL columns, “CallStart” and “CallFinish,” I would like to get the time the page was opened and the time the data was submitted. 

For the CallFinish column, I set the Default Value or Binding in SQL to (getdate()). This returns the date/time the data was submitted to the server. It is working exactly as I’d hoped.

Is it possible to also submit the date/time the page was opened? I have some javascript on the index.asp page that displays a page open timestamp, but is it possible to get that value and submit it to my CallStart column in SQL?

I’m using ASP VBScript with SQL Server 2008 R2.
",sql-server,asp-classic,vbscript,,,07/19/2012 11:40:34,not a real question,1,132,6,"Looking for a page open timestamp I have an internal website that opens on a helpdesk phone call and submits data to SQL based on the user choices. In two of my SQL columns, “CallStart” and “CallFinish,” I would like to get the time the page was opened and the time the data was submitted. 

For the CallFinish column, I set the Default Value or Binding in SQL to (getdate()). This returns the date/time the data was submitted to the server. It is working exactly as I’d hoped.

Is it possible to also submit the date/time the page was opened? I have some javascript on the index.asp page that displays a page open timestamp, but is it possible to get that value and submit it to my CallStart column in SQL?

I’m using ASP VBScript with SQL Server 2008 R2.
",3
6689221,07/14/2011 06:24:50,726445,04/27/2011 02:55:53,23,0,Increase SQL Query Performance,"I have two tables. In one table we enter all types of Models, each model got around 100 items. we have another table ..when particular item is sold, the the data ll be entered into that table. now i need to find like this

Date           Model    Total(WE BOUGHT)   Sold

2011-01-21      M34R            300         200
2011-01-21      M71S            250          22
 like this     


select  distinct CONVERT(varchar(10),x.Scantime,120) as ScanDate,x.ModelNumber,
(Select count(*) from micro_model z where z.ModelNumber=x.ModelNumber and CONVERT(varchar(10),z.scantime,101) = CONVERT(varchar(10),x.Scantime,101)) as Total,
(select COUNT(*) from micro_Model m inner join micro_model_sold y on m.IDNO=y.IDNO where CONVERT(varchar(10),m.scantime,101) =CONVERT(varchar(10),x.Scantime,101) and x.ModelNumber=m.ModelNumber) as Sold
 from micro_Model x 
 where CONVERT(varchar(10),x.scantime,101) between '01/01/2011' and '01/25/2011'

I am able to achieve tht from the above query.. but it is taking more than 2 mins to execute. pls suggest me how can i improve the performance.. I hv heard about pivot table, indexed view..but never done.. 

Thanks",sql-server,performance,query,,,,open,0,208,4,"Increase SQL Query Performance I have two tables. In one table we enter all types of Models, each model got around 100 items. we have another table ..when particular item is sold, the the data ll be entered into that table. now i need to find like this

Date           Model    Total(WE BOUGHT)   Sold

2011-01-21      M34R            300         200
2011-01-21      M71S            250          22
 like this     


select  distinct CONVERT(varchar(10),x.Scantime,120) as ScanDate,x.ModelNumber,
(Select count(*) from micro_model z where z.ModelNumber=x.ModelNumber and CONVERT(varchar(10),z.scantime,101) = CONVERT(varchar(10),x.Scantime,101)) as Total,
(select COUNT(*) from micro_Model m inner join micro_model_sold y on m.IDNO=y.IDNO where CONVERT(varchar(10),m.scantime,101) =CONVERT(varchar(10),x.Scantime,101) and x.ModelNumber=m.ModelNumber) as Sold
 from micro_Model x 
 where CONVERT(varchar(10),x.scantime,101) between '01/01/2011' and '01/25/2011'

I am able to achieve tht from the above query.. but it is taking more than 2 mins to execute. pls suggest me how can i improve the performance.. I hv heard about pivot table, indexed view..but never done.. 

Thanks",3
7768430,10/14/2011 13:36:00,223863,12/03/2009 13:52:10,1753,38,How do I get all the results not in a set?,Im joining two tables and I want to then join a third but I want to get the result of the records that dont join. Dont really know what to use to do this. Can I search for nulls that appear outside the join or something?,sql-server,tsql,,,,10/15/2011 07:49:45,not a real question,1,46,11,How do I get all the results not in a set? Im joining two tables and I want to then join a third but I want to get the result of the records that dont join. Dont really know what to use to do this. Can I search for nulls that appear outside the join or something?,2
8096354,11/11/2011 15:41:24,603127,02/04/2011 12:26:02,281,2,SQL Server Express R2 database size limitation?,"As you know, SQL Server 2008 R2 Express supports 10GB.

So What happens if I try to attach a file which's size is more than 10GB?

choices,

A- warn me before trying to attach and stop attaching.

B- attach 10gb of file and then warn me about ""can not attach anymore"". ",sql-server,sql-server-2008,sql-server-2008-r2,limitations,attach,11/12/2011 15:55:11,not a real question,1,48,7,"SQL Server Express R2 database size limitation? As you know, SQL Server 2008 R2 Express supports 10GB.

So What happens if I try to attach a file which's size is more than 10GB?

choices,

A- warn me before trying to attach and stop attaching.

B- attach 10gb of file and then warn me about ""can not attach anymore"". ",5
1257516,08/10/2009 22:12:15,425462,08/10/2009 22:08:24,1,0,Case statement in where clause w/an OR,"Apologies in advance since I feel like I'm probably forgetting/missing something obvious on this one.  Here goes; I'm using a case statement in my WHERE clause, the below works fine:

    WHERE r.[SomeCol] = @SomeColVal
    AND SomeOtherCol =  
    (
    CASE WHEN (@Year = 0 AND @Period = 0) THEN
    @SomeVal
    CASE WHEN...
    ...
    CASE ELSE
    @SomeVal
    END 

My ""issue"" is that I want to add an additional OR clause to my ELSE block..something like this:

    WHERE r.[SomeCol] = @SomeColVal
    AND SomeOtherCol =  
    (
    CASE WHEN (@Year = 0 AND @Period = 0) THEN
    @SomeVal
    CASE WHEN...
    ...
    CASE ELSE
    @SomeVal OR @SomeVal - 1
    END 

Naturally, this throws this error:
Incorrect syntax near the keyword 'OR'. within the ELSE statement

Hence my question...what is the correct/alternate logic I can use to accomplish this?  
Thank you in advance
",sql-server,where-clause,case-statement,,,,open,0,200,7,"Case statement in where clause w/an OR Apologies in advance since I feel like I'm probably forgetting/missing something obvious on this one.  Here goes; I'm using a case statement in my WHERE clause, the below works fine:

    WHERE r.[SomeCol] = @SomeColVal
    AND SomeOtherCol =  
    (
    CASE WHEN (@Year = 0 AND @Period = 0) THEN
    @SomeVal
    CASE WHEN...
    ...
    CASE ELSE
    @SomeVal
    END 

My ""issue"" is that I want to add an additional OR clause to my ELSE block..something like this:

    WHERE r.[SomeCol] = @SomeColVal
    AND SomeOtherCol =  
    (
    CASE WHEN (@Year = 0 AND @Period = 0) THEN
    @SomeVal
    CASE WHEN...
    ...
    CASE ELSE
    @SomeVal OR @SomeVal - 1
    END 

Naturally, this throws this error:
Incorrect syntax near the keyword 'OR'. within the ELSE statement

Hence my question...what is the correct/alternate logic I can use to accomplish this?  
Thank you in advance
",3
8066725,11/09/2011 14:48:27,637840,02/28/2011 14:38:12,65,5,Issue with SQL Server Linked Servers and MSDTC,"I´m having some problem while calling a remote stored procedure from a linked server in SQL Server.

I´m getting this error:

""Import of MSDTC transaction failed: Result Code = 0x8004d01f.""

I´ve already configured the MSDTC security settings, but I can´t get this transaction going.

Both OS are W2K3 R2, one side is an SQL2005, and the other is an SQL 2000

Do you have any idea of what might be going on?

Thanks you for your help.",sql-server,msdtc,,,,11/10/2011 08:24:34,off topic,1,71,8,"Issue with SQL Server Linked Servers and MSDTC I´m having some problem while calling a remote stored procedure from a linked server in SQL Server.

I´m getting this error:

""Import of MSDTC transaction failed: Result Code = 0x8004d01f.""

I´ve already configured the MSDTC security settings, but I can´t get this transaction going.

Both OS are W2K3 R2, one side is an SQL2005, and the other is an SQL 2000

Do you have any idea of what might be going on?

Thanks you for your help.",2
9540089,03/02/2012 20:43:49,368383,06/16/2010 15:07:56,55,0,List of Reports Currently Running on Reporting Services,"I'm looking for a SQL query to list all the running reports. ReportingServer.dbo.ExecutionLogStorage only seems to record it after it's finished. I could look at Master.dbo.SysProcesses, but then how can I tie that back to the ReprotingServer.dbo.Catalog to get the report name?

Thanks",sql-server,reporting-services,,,,,open,0,42,8,"List of Reports Currently Running on Reporting Services I'm looking for a SQL query to list all the running reports. ReportingServer.dbo.ExecutionLogStorage only seems to record it after it's finished. I could look at Master.dbo.SysProcesses, but then how can I tie that back to the ReprotingServer.dbo.Catalog to get the report name?

Thanks",2
3452,08/06/2008 14:25:17,437,08/05/2008 18:13:45,8,2,SQL Server Client for OSX,"What's a good SQL client for OSX that works with MS SQL Server? I don't really need a GUI, but it's nice to have for the color coding and result set grid. I'd be willing to pay up to $100.",sql-server,osx,,,,07/03/2012 13:47:17,not constructive,1,40,5,"SQL Server Client for OSX What's a good SQL client for OSX that works with MS SQL Server? I don't really need a GUI, but it's nice to have for the color coding and result set grid. I'd be willing to pay up to $100.",2
8110908,11/13/2011 10:20:02,1044044,11/13/2011 10:09:28,1,0,how can I connect program to database in another pc?,"I'm making a program with c# , 
and after finishing it I'll setup the program in more than one pc ,
I want to connect the program in all PCs to one database in another pc using sql server .
how can I do it ?

thanks in advance",sql-server,database,connect,pc,,,open,0,46,10,"how can I connect program to database in another pc? I'm making a program with c# , 
and after finishing it I'll setup the program in more than one pc ,
I want to connect the program in all PCs to one database in another pc using sql server .
how can I do it ?

thanks in advance",4
759734,04/17/2009 09:28:05,270,08/04/2008 10:21:45,2138,110,Import de-normalized relational data from Excel into SQL Server,"I need to import data from an Excel spreadsheet into SQL Server, but the data isn't in a relational/normalized format so the import wizard isn't going to cut it (as far as I know).

The data is in this format:

    Category    SubCategory     Name        Description
    
    Category#1  SubCategory#1   Product#1   Description#1
    Category#1  SubCategory#1   Product#2   Description#2
    Category#1  SubCategory#2   Product#3   Description#3
    Category#1  SubCategory#2   Product#4   Description#4
    Category#2  SubCategory#3   Product#5   Description#5

(apologies I'm lacking the inventiveness to come up with 'real' data at this time in the morning...)

Each row contains a unique product, but the cateogry structure is duplicated. I want to import this data into three tables:

    Category
    SubCategory
    Product
(I know SubCategory should really be contained within Category, DB was not my design)

I need a way to import unique rows based on the Category and then SubCategory columns, and then when importing the other columns into Product, obtain a reference to the SubCategory based on name.

Short of scripting this, is there any way to do it using the import wizard or some other tool?",sql-server,excel,import,,,,open,0,236,9,"Import de-normalized relational data from Excel into SQL Server I need to import data from an Excel spreadsheet into SQL Server, but the data isn't in a relational/normalized format so the import wizard isn't going to cut it (as far as I know).

The data is in this format:

    Category    SubCategory     Name        Description
    
    Category#1  SubCategory#1   Product#1   Description#1
    Category#1  SubCategory#1   Product#2   Description#2
    Category#1  SubCategory#2   Product#3   Description#3
    Category#1  SubCategory#2   Product#4   Description#4
    Category#2  SubCategory#3   Product#5   Description#5

(apologies I'm lacking the inventiveness to come up with 'real' data at this time in the morning...)

Each row contains a unique product, but the cateogry structure is duplicated. I want to import this data into three tables:

    Category
    SubCategory
    Product
(I know SubCategory should really be contained within Category, DB was not my design)

I need a way to import unique rows based on the Category and then SubCategory columns, and then when importing the other columns into Product, obtain a reference to the SubCategory based on name.

Short of scripting this, is there any way to do it using the import wizard or some other tool?",3
2698292,04/23/2010 12:06:05,225394,12/05/2009 13:09:32,289,27,"Usage of SP_OACreate, SP_OAMethod etc.. is a security risk ?","I am told that usage of SP_OACreate , SP_OAMethod in SQL Server 2000 is of a security risk.

I am using Strong Name in the  assembly and is stored in GAC  on the Sqlserver Machine.

What are the security implications/compromise ?  ",sql-server,tsql,,,,,open,0,43,10,"Usage of SP_OACreate, SP_OAMethod etc.. is a security risk ? I am told that usage of SP_OACreate , SP_OAMethod in SQL Server 2000 is of a security risk.

I am using Strong Name in the  assembly and is stored in GAC  on the Sqlserver Machine.

What are the security implications/compromise ?  ",2
5214744,03/07/2011 01:07:28,647460,03/07/2011 01:00:52,1,0,Database dump restore,"Does any body know what is restore of a dump in sql? I have restored full, differential and transactional backup. However I am not aware of this restore. I would really appreciate your help. The restore that I was requested to do looks like this-c:\backup\flasback.sls

Thank you,
",sql-server,,,,,03/07/2011 01:26:40,off topic,1,46,3,"Database dump restore Does any body know what is restore of a dump in sql? I have restored full, differential and transactional backup. However I am not aware of this restore. I would really appreciate your help. The restore that I was requested to do looks like this-c:\backup\flasback.sls

Thank you,
",1
7389962,09/12/2011 15:04:45,875955,08/03/2011 05:53:42,16,1,how to avoid deadlock while updating table with two different updates statements on same table in SQL server,"I am using update statement in script task of SSIS which updates particular row of table.This process happens in loop for multiple records. Sometimes it happens another application also fires update on same table for different record set. For this application m getting deadlock exception on lock. 
How can i avoid this situation? i want both update should work at same time as update record set are different.
Is the anything to lock only that row which is getting updated?

Regards,    
Solo  ",sql-server,sql-server-2005,server,s,,,open,0,85,18,"how to avoid deadlock while updating table with two different updates statements on same table in SQL server I am using update statement in script task of SSIS which updates particular row of table.This process happens in loop for multiple records. Sometimes it happens another application also fires update on same table for different record set. For this application m getting deadlock exception on lock. 
How can i avoid this situation? i want both update should work at same time as update record set are different.
Is the anything to lock only that row which is getting updated?

Regards,    
Solo  ",4
9802057,03/21/2012 09:49:11,231179,12/14/2009 10:50:21,613,17,Pivot data in SQL Server,"I need to create a report using SQL Server 2008R2 Stored procedure that will return the following shape of data:
![enter image description here][1]


My view in SQL Server is returning data like this:
![enter image description here][2]


The user will select start_date and end_date and that date range will be displayed in columns, i.e. if user selects Apr 1,2012 to Apr 7, 2012 then 7 days, Day1 to Day7 will be shown in columns. The left column will show the totals of ""ApplicationId"" field. 
Note that ""Assigned"", ""Processing"",.. are Status field.


  [1]: http://i.stack.imgur.com/aOeUt.jpg
  [2]: http://i.stack.imgur.com/DW96h.jpg",sql-server,pivot-table,,,,,open,0,94,5,"Pivot data in SQL Server I need to create a report using SQL Server 2008R2 Stored procedure that will return the following shape of data:
![enter image description here][1]


My view in SQL Server is returning data like this:
![enter image description here][2]


The user will select start_date and end_date and that date range will be displayed in columns, i.e. if user selects Apr 1,2012 to Apr 7, 2012 then 7 days, Day1 to Day7 will be shown in columns. The left column will show the totals of ""ApplicationId"" field. 
Note that ""Assigned"", ""Processing"",.. are Status field.


  [1]: http://i.stack.imgur.com/aOeUt.jpg
  [2]: http://i.stack.imgur.com/DW96h.jpg",2
6904210,08/01/2011 20:43:45,187094,10/09/2009 10:35:53,1,1,Executing remote stored procedure within sp_executesql,"I'm trying to get IDENT_CURRENT value on the linked server.  I've created a stored procedure sp_current_identity on the remote server that has output parameter. 

CREATE  PROCEDURE [dbo].[sp_current_identity] ( @strTableName nvarchar(255), @intRowId int OUTPUT )
AS
BEGIN
select IDENT_CURRENT(@strTableName)
END

After that I have created two synonyms:sp_current_identity and sometable.


I need to execute sp_current_identity using sp_executesql (I'm creating a custom DataAtapter to work with synonyms via LLBLGEN 3.1). Please see the following example:

declare @p4 int
set @p4=NULL
exec sp_executesql N'SET XACT_ABORT ON; INSERT INTO [db].[dbo].[sometable] ([FieldName], [TableName], [UserField]) VALUES (@p1, @p3, @p4) ;
exec dbo.sp_current_identity @p5, @p2 
;SET XACT_ABORT OFF',N'@p1 varchar(50),@p2 int output,@p3 varchar(50),@p4 varchar(50), @p5 varchar(200)',
@p1='test24',@p2=@p4 output,@p3='test24',@p4='test5',@p5='sometable'
select @p4


It works fine when  this code is executed on the remote server (where sp_current_identity is local stored procedure), but it causes an exception when the code is executed on the local server.
Here is the error:

Procedure or function 'sp_current_identity' expects parameter '@strTableName', which was not supplied.

Thanks for your help! 
",sql-server,stored-procedures,linked-server,remote-server,,,open,0,150,6,"Executing remote stored procedure within sp_executesql I'm trying to get IDENT_CURRENT value on the linked server.  I've created a stored procedure sp_current_identity on the remote server that has output parameter. 

CREATE  PROCEDURE [dbo].[sp_current_identity] ( @strTableName nvarchar(255), @intRowId int OUTPUT )
AS
BEGIN
select IDENT_CURRENT(@strTableName)
END

After that I have created two synonyms:sp_current_identity and sometable.


I need to execute sp_current_identity using sp_executesql (I'm creating a custom DataAtapter to work with synonyms via LLBLGEN 3.1). Please see the following example:

declare @p4 int
set @p4=NULL
exec sp_executesql N'SET XACT_ABORT ON; INSERT INTO [db].[dbo].[sometable] ([FieldName], [TableName], [UserField]) VALUES (@p1, @p3, @p4) ;
exec dbo.sp_current_identity @p5, @p2 
;SET XACT_ABORT OFF',N'@p1 varchar(50),@p2 int output,@p3 varchar(50),@p4 varchar(50), @p5 varchar(200)',
@p1='test24',@p2=@p4 output,@p3='test24',@p4='test5',@p5='sometable'
select @p4


It works fine when  this code is executed on the remote server (where sp_current_identity is local stored procedure), but it causes an exception when the code is executed on the local server.
Here is the error:

Procedure or function 'sp_current_identity' expects parameter '@strTableName', which was not supplied.

Thanks for your help! 
",4
10766689,05/26/2012 13:31:55,1400309,05/17/2012 06:37:45,1,1,How to make search on Time in sql server?,"I have two columns in table Start time and end time. I want to make search on the basis of time. I have saved the start time and end time in below format

    14:57:44

using `Convert(varchar(20),Getdate(),108)`

Please help me.",sql-server,search,datetime,,,,open,0,40,9,"How to make search on Time in sql server? I have two columns in table Start time and end time. I want to make search on the basis of time. I have saved the start time and end time in below format

    14:57:44

using `Convert(varchar(20),Getdate(),108)`

Please help me.",3
771048,04/21/2009 04:33:46,9425,09/15/2008 18:46:39,818,59,"Add ""Select top 1000"" command to toolbar in SSMS","I am using SQL server management studio (2008) quite a lot these days. If it had a ""Select top 1000"" command in the toolbar,(or a shortcut key) it would make my life a lot easier. Is there any way i can do it. I tried looking in the customize dialog, but cant find that command there.",sql-server,ssms,ssms2008,,,,open,0,56,9,"Add ""Select top 1000"" command to toolbar in SSMS I am using SQL server management studio (2008) quite a lot these days. If it had a ""Select top 1000"" command in the toolbar,(or a shortcut key) it would make my life a lot easier. Is there any way i can do it. I tried looking in the customize dialog, but cant find that command there.",3
1063498,06/30/2009 12:52:22,128182,06/24/2009 12:21:35,6,1,SQL Server 2008 Full-Text Search (FTS) extremely slow when more than one CONTAINSTABLE in query,"**Query 1:**

SELECT [...] FROM ContentItem CI WHERE 
(**EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table1**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id)) 
ORDER BY [...]

**Results:** super fast on SQL 2005 and SQL 2008


**Query 2:**

SELECT [...] FROM ContentItem CI WHERE 
(**EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table2**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id)) 
ORDER BY [...]

**Results:** super fast on SQL 2005 and SQL 2008



**Query 3:**

SELECT [...] FROM ContentItem CI WHERE 
(**EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table1**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id) 
**OR EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table2**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id)) 
ORDER BY [...]

**Results:** super fast on SQL 2005 (about a second), **but extremely slow (3 min+) on SQL 2008**

I'm aware of performance issues  with SQL 2008 FTS (even on stackoverflow), but haven't find any reasonable solution yet.",sql-server,sql-server-2008,full-text-search,,,,open,0,136,15,"SQL Server 2008 Full-Text Search (FTS) extremely slow when more than one CONTAINSTABLE in query **Query 1:**

SELECT [...] FROM ContentItem CI WHERE 
(**EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table1**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id)) 
ORDER BY [...]

**Results:** super fast on SQL 2005 and SQL 2008


**Query 2:**

SELECT [...] FROM ContentItem CI WHERE 
(**EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table2**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id)) 
ORDER BY [...]

**Results:** super fast on SQL 2005 and SQL 2008



**Query 3:**

SELECT [...] FROM ContentItem CI WHERE 
(**EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table1**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id) 
**OR EXISTS** (SELECT TOP 1 * FROM **CONTAINSTABLE**([**Table2**], *, '""[search_string]*""') FT 
WHERE FT.[Key] = CI.ContentItem_Id)) 
ORDER BY [...]

**Results:** super fast on SQL 2005 (about a second), **but extremely slow (3 min+) on SQL 2008**

I'm aware of performance issues  with SQL 2008 FTS (even on stackoverflow), but haven't find any reasonable solution yet.",3
11646011,07/25/2012 08:52:53,1108083,12/20/2011 14:54:00,17,0,Subtract and display in Percentile,"   I have data in sql server table like the following:


      Slno 	Revenue		Date		Loading
       1	8989898		10/07/12	Before Load
       2	2124124         10/07/12	After Load

   I want to subtract both the values and display the result as percentage say ""10%""

   Please help with a correct query to compute the following

   Thanks
",sql-server,tsql,,,,,open,0,77,5,"Subtract and display in Percentile    I have data in sql server table like the following:


      Slno 	Revenue		Date		Loading
       1	8989898		10/07/12	Before Load
       2	2124124         10/07/12	After Load

   I want to subtract both the values and display the result as percentage say ""10%""

   Please help with a correct query to compute the following

   Thanks
",2
6079628,05/21/2011 04:41:28,642525,03/03/2011 07:09:07,95,7,How to take Update MS SQL 2005 Data Base form Internet,"As I have MS SQL 2005 Installed on one PC.
Now i need to update entire Data Base at particular Time / or on Click of EXE.

How can in Do that.",sql-server,sql-server-2005,update,sql-server-express,auto-update,05/21/2011 07:18:03,not a real question,1,30,11,"How to take Update MS SQL 2005 Data Base form Internet As I have MS SQL 2005 Installed on one PC.
Now i need to update entire Data Base at particular Time / or on Click of EXE.

How can in Do that.",5
7526404,09/23/2011 08:45:49,393748,07/16/2010 10:57:15,102,12,Is it possible to find out the last backup location used for a transaction log file in SQL 2005 or higher,"We have a product which uses a database and whenever a major release is done one of the upgrade scripts used on the database calls one of our stored procedures whose job is to drop and then recreate the fulltext index thus ensure any changes (i.e. new columns that are indexed) in the new release get installed.

The problem is that if our client has set up the database to be full recovery mode then this will fail at the point at which it tries to recreate the fulltext index.

To ensure the upgrade instructions are as simple as possible I don't want the IT guy doing it to have to do anything other than run the set of scripts according to there filenames, (i.e. run 001 - xxx.sql, then run 002 xxx.sql etc...).

So the idea I thought to try was for the SP that drops/recreates to do the backup of the transaction log if the database is set to full recovery mode for them by backing up to the same location as the last transaction log backup was done. The problem is how do you find out the last location?

I've searched and found scripts that indicate the use of sys.sysdatabases and msdb..backupset but those tables don't seem to have the information I need.

Any ideas? Is it even possible?",sql-server,script,backup,transaction-log,,,open,0,217,21,"Is it possible to find out the last backup location used for a transaction log file in SQL 2005 or higher We have a product which uses a database and whenever a major release is done one of the upgrade scripts used on the database calls one of our stored procedures whose job is to drop and then recreate the fulltext index thus ensure any changes (i.e. new columns that are indexed) in the new release get installed.

The problem is that if our client has set up the database to be full recovery mode then this will fail at the point at which it tries to recreate the fulltext index.

To ensure the upgrade instructions are as simple as possible I don't want the IT guy doing it to have to do anything other than run the set of scripts according to there filenames, (i.e. run 001 - xxx.sql, then run 002 xxx.sql etc...).

So the idea I thought to try was for the SP that drops/recreates to do the backup of the transaction log if the database is set to full recovery mode for them by backing up to the same location as the last transaction log backup was done. The problem is how do you find out the last location?

I've searched and found scripts that indicate the use of sys.sysdatabases and msdb..backupset but those tables don't seem to have the information I need.

Any ideas? Is it even possible?",4
1154302,07/20/2009 15:38:12,5744,09/11/2008 08:15:22,3333,90,Checking sp_send_email permission before executing,"In my stored procedure, I send emails with sp\_send_email. My stored procedure will be run in different environments; some will have emailing enabled, some won't.

If I run sp\_send_email without it being enabled, I (quite rightly) get this error message

> SQL Server blocked access to procedure 'dbo.sp\_send_dbmail' of component 'Database Mail XPs' because this component is turned off as part of the security configuration for this server.

I want to check whether emailing is enabled first, so I can avoid the error by doing the following:

    IF @is_enabled
    BEGIN
        EXEC sp_send_email ...
    END

How do I correctly set @is\_enabled?
",sql-server,email,,,,,open,0,112,5,"Checking sp_send_email permission before executing In my stored procedure, I send emails with sp\_send_email. My stored procedure will be run in different environments; some will have emailing enabled, some won't.

If I run sp\_send_email without it being enabled, I (quite rightly) get this error message

> SQL Server blocked access to procedure 'dbo.sp\_send_dbmail' of component 'Database Mail XPs' because this component is turned off as part of the security configuration for this server.

I want to check whether emailing is enabled first, so I can avoid the error by doing the following:

    IF @is_enabled
    BEGIN
        EXEC sp_send_email ...
    END

How do I correctly set @is\_enabled?
",2
3535203,08/20/2010 22:04:46,287793,03/06/2010 15:53:59,208,4,How to create reports in Access via ADO When data is in SQL Server?,"I have an Access 2003 project in which all data is stored in SQL Server 2008. I am using ADO to view/update data via forms that are completely unbound. For example, a form has several textboxes and combo boxes on it. When the form is loaded I use ADO to make a call to a stored procedure on SQL SQL, it returns a recordset and I populate the controls, via VBA, with the data from the recordset. I like this approach because only the VBA is stored within Access. No data (well actually connection strings are stored in Access, but that is it!).

  My problem is what to do when it comes to reports. I want to create reports that are based off of views created within SQL Server, however I would like to avoid, if possible, static linking to the views directly from within Access. Is it possible to set the recordsource of a report dynamically at run-time to be the results of a SQL Server view? If it is, how does one go about designing the report id Access does not contain any data?

More info ... The reason I want to avoid linking to the view in Access is the environment in which the Access application could be run changes (Production, Development, Test). Currently whenever I make any calls to the database stored procedures, I look up the connection string (Active Directory based so no passwords are stored) in the only table that is stored in Access .

  Thanks for any assistance.",sql-server,ms-access,reporting,views,ado,,open,0,256,14,"How to create reports in Access via ADO When data is in SQL Server? I have an Access 2003 project in which all data is stored in SQL Server 2008. I am using ADO to view/update data via forms that are completely unbound. For example, a form has several textboxes and combo boxes on it. When the form is loaded I use ADO to make a call to a stored procedure on SQL SQL, it returns a recordset and I populate the controls, via VBA, with the data from the recordset. I like this approach because only the VBA is stored within Access. No data (well actually connection strings are stored in Access, but that is it!).

  My problem is what to do when it comes to reports. I want to create reports that are based off of views created within SQL Server, however I would like to avoid, if possible, static linking to the views directly from within Access. Is it possible to set the recordsource of a report dynamically at run-time to be the results of a SQL Server view? If it is, how does one go about designing the report id Access does not contain any data?

More info ... The reason I want to avoid linking to the view in Access is the environment in which the Access application could be run changes (Production, Development, Test). Currently whenever I make any calls to the database stored procedures, I look up the connection string (Active Directory based so no passwords are stored) in the only table that is stored in Access .

  Thanks for any assistance.",5
1877456,12/09/2009 22:45:35,189572,10/14/2009 03:42:37,3,0,SQL Server 2005->2008 upgrade: detach/attach vs. backup/restore?,"There was a [similar thread][1] on this earlier, but my question is specific to upgrading from SQL2005 to 2008: when upgrading in-place is not possible because the machine has to be re-imaged, which method is preferrable - detaching and re-attaching the db files, or backup/restore?

Detach/attach is obviously faster and accoding to msdn possible, but I wonder if anyone could share real life experiences? 

Thanks
Max



  [1]: http://stackoverflow.com/questions/610113/sql-server-backup-restore-v-s-detach-attach
",sql-server,sql-server-2005,sql-server-2008,,,,open,0,67,7,"SQL Server 2005->2008 upgrade: detach/attach vs. backup/restore? There was a [similar thread][1] on this earlier, but my question is specific to upgrading from SQL2005 to 2008: when upgrading in-place is not possible because the machine has to be re-imaged, which method is preferrable - detaching and re-attaching the db files, or backup/restore?

Detach/attach is obviously faster and accoding to msdn possible, but I wonder if anyone could share real life experiences? 

Thanks
Max



  [1]: http://stackoverflow.com/questions/610113/sql-server-backup-restore-v-s-detach-attach
",3
10162333,04/15/2012 13:11:22,1235904,02/27/2012 15:24:20,20,0,select under condition in sql,"my sql txt is

        SELECT Diw_Tb_Court.Fd_CourtCode,Diw_Tb_Court.Fd_CourtName + ' '+ Diw_Tb_CourtType.Fd_CourtType AS Court from  table one inner join table to etc.....

i want when he found Diw_Tb_CourtType.Fd_CourtType =null get  Diw_Tb_Court.Fd_CourtName as type but in sql server when he find  Diw_Tb_CourtType is null then result or court= null although Diw_Tb_Court.Fd_CourtName= 'damam'",sql-server,select,case,,,,open,0,58,5,"select under condition in sql my sql txt is

        SELECT Diw_Tb_Court.Fd_CourtCode,Diw_Tb_Court.Fd_CourtName + ' '+ Diw_Tb_CourtType.Fd_CourtType AS Court from  table one inner join table to etc.....

i want when he found Diw_Tb_CourtType.Fd_CourtType =null get  Diw_Tb_Court.Fd_CourtName as type but in sql server when he find  Diw_Tb_CourtType is null then result or court= null although Diw_Tb_Court.Fd_CourtName= 'damam'",3
3943463,10/15/2010 15:01:28,373418,06/22/2010 16:56:26,624,45,SS Analysis Services ( SSAS ) DB schema comparison tool?,"Does anyone know of a tool that compares SSAS databases?  Not their data, just schema and maybe partition definitions.",sql-server,ssas,,,,,open,0,20,10,"SS Analysis Services ( SSAS ) DB schema comparison tool? Does anyone know of a tool that compares SSAS databases?  Not their data, just schema and maybe partition definitions.",2
9454256,02/26/2012 15:19:42,859154,07/23/2011 09:23:42,8409,485,Get the the last ms before tomorrow in Sql Server?,"Im using the Between command in mssql server.

I need to find : 

        select * from MyTable where myDate
     between getdate() and [1ms before tomorrow  = 2012-02-26 :23:59:59:999]

*I DONT want [ 2012-02-27 :00:00:00:000] because future queries should use that value .*

*So i need 1 ms before tomorrow.*

However  - this is what ive tried but for some reason it refuse to give me the desire value !
and give me :  `2012-02-26 23:59:59.997` + unpredictable results!

Why is that ? What am i missing ?

I want to get `2012-02-26 :23:59:59:999` !





![enter image description here][1]


  [1]: http://i.stack.imgur.com/6BgGA.jpg",sql-server,sql-server-2005,datetime,,,,open,0,108,10,"Get the the last ms before tomorrow in Sql Server? Im using the Between command in mssql server.

I need to find : 

        select * from MyTable where myDate
     between getdate() and [1ms before tomorrow  = 2012-02-26 :23:59:59:999]

*I DONT want [ 2012-02-27 :00:00:00:000] because future queries should use that value .*

*So i need 1 ms before tomorrow.*

However  - this is what ive tried but for some reason it refuse to give me the desire value !
and give me :  `2012-02-26 23:59:59.997` + unpredictable results!

Why is that ? What am i missing ?

I want to get `2012-02-26 :23:59:59:999` !





![enter image description here][1]


  [1]: http://i.stack.imgur.com/6BgGA.jpg",3
4233286,11/20/2010 14:53:49,515609,11/03/2010 11:41:34,1,2,Construct the following relational database in Oracle 11g or MSSQL,"Construct the following relational database

Emp(eid,ename,age,salary)
Works for(eid,did,time)
Deptt(did,dname,manager_id,budget)

(i)List the names of each employee who works in both hardware deptt & software deptt.
(ii)List the names of each employee whose salary exceeds the budget of all the departments he or she works in.
(iii)Find the manager_id of managers who manage only departments with budgets>1,00,000",sql-server,oracle11g,,,,11/20/2010 23:43:02,not a real question,1,49,10,"Construct the following relational database in Oracle 11g or MSSQL Construct the following relational database

Emp(eid,ename,age,salary)
Works for(eid,did,time)
Deptt(did,dname,manager_id,budget)

(i)List the names of each employee who works in both hardware deptt & software deptt.
(ii)List the names of each employee whose salary exceeds the budget of all the departments he or she works in.
(iii)Find the manager_id of managers who manage only departments with budgets>1,00,000",2
1798547,11/25/2009 17:24:32,122677,06/14/2009 08:16:03,38,1,How upgrade varchar(8000)?,"i wand to upgrade my varchar(8000) to more data( i mean , i wand to increase 8000) what i will do for this?

Hoping ur support",sql-server,,,,,,open,0,25,3,"How upgrade varchar(8000)? i wand to upgrade my varchar(8000) to more data( i mean , i wand to increase 8000) what i will do for this?

Hoping ur support",1
2980084,06/05/2010 11:10:59,225394,12/05/2009 13:09:32,351,30,Capturing SQL STATISTICS TIME and IO,"Is there a way to capture STATISTICS IO and TIME within T-SQL for logging.
",sql-server,tsql,,,,,open,0,14,6,"Capturing SQL STATISTICS TIME and IO Is there a way to capture STATISTICS IO and TIME within T-SQL for logging.
",2
4153762,11/11/2010 11:09:55,415037,08/09/2010 11:55:28,167,1,SQL Server Database,"If I make an SQL server database, 

1) Do I need to install SQL server on client's machine too to use it in vb.net or we can use it just without it, as Access database can be used in vb.net.

2) I created a database with one table.  In BindingSource's Datasource section, when I make new connectin with this database, what datasource should be selected
Microsoft SQL Server or Microsoft SQL server database file?

I tried the second one, chose the file but when tested connection, it failed.

Please advise.
Thanks
Furqan",sql-server,,,,,,open,0,87,3,"SQL Server Database If I make an SQL server database, 

1) Do I need to install SQL server on client's machine too to use it in vb.net or we can use it just without it, as Access database can be used in vb.net.

2) I created a database with one table.  In BindingSource's Datasource section, when I make new connectin with this database, what datasource should be selected
Microsoft SQL Server or Microsoft SQL server database file?

I tried the second one, chose the file but when tested connection, it failed.

Please advise.
Thanks
Furqan",1
7663513,10/05/2011 15:08:48,504477,11/11/2010 12:11:08,20,3,How to install SQL Server 2008 R2 32 bit on 64 bit platform,"I would like to install `SQL Server 2008 R2` 32 bit edition on Windows 7 64 bit but I do not know the command line arguments that should be passed to `setup.exe` in order to achieve this. 

Please can anyone enlighten me?

*The reason why I need to do this is because I wish to use the `Visual Fox Pro OLE DB Provider` to create a linked server on my local development platform. This provider is apparently only supported by 32 bit applications which is why I now need to uninstall my current 64 bit version and go for 32 bit. If there is an alternative way to resolve this without having to perform the reinstall then I would also appreciate your knowledge!*",sql-server,windows-7,oledb,32bit-64bit,visual-foxpro,10/06/2011 08:47:48,off topic,1,122,13,"How to install SQL Server 2008 R2 32 bit on 64 bit platform I would like to install `SQL Server 2008 R2` 32 bit edition on Windows 7 64 bit but I do not know the command line arguments that should be passed to `setup.exe` in order to achieve this. 

Please can anyone enlighten me?

*The reason why I need to do this is because I wish to use the `Visual Fox Pro OLE DB Provider` to create a linked server on my local development platform. This provider is apparently only supported by 32 bit applications which is why I now need to uninstall my current 64 bit version and go for 32 bit. If there is an alternative way to resolve this without having to perform the reinstall then I would also appreciate your knowledge!*",5
9789340,03/20/2012 15:04:39,79129,03/17/2009 17:43:45,3387,111,Sql Server LIKE comparison with IN operator,"I want to perform a LIKE style comparison with an IN operator e.g.:

    select *
    from tbl1
    where tbl1.value_to_check in (select allowed_str from allowedvalues)

Where allowed values could contain the following allowed_str:

ab% (allow any string starting ab)
%ab (allow any string ending ab)

for example.  The above query obviously does not work in this way however is there a way of achieving this using Sql Server 2008?",sql-server,sql-server-2008,,,,,open,0,74,7,"Sql Server LIKE comparison with IN operator I want to perform a LIKE style comparison with an IN operator e.g.:

    select *
    from tbl1
    where tbl1.value_to_check in (select allowed_str from allowedvalues)

Where allowed values could contain the following allowed_str:

ab% (allow any string starting ab)
%ab (allow any string ending ab)

for example.  The above query obviously does not work in this way however is there a way of achieving this using Sql Server 2008?",2
4959885,02/10/2011 16:32:37,144486,07/24/2009 12:37:02,191,17,Why does sqlConnection.Close() not close the login?,"We have unit tests to test that our database install and uninstall features successfully work.
The unit tests use the **SqlClient.SqlConnection** class to check the database contents before, during and after.

Our problem is that after using SqlClient.SqlConnection, the **drop login** part of the uninstall fails because it claims that a user is currently logged in. Even though we have called SqlConnection.Close(), the login seems to be still open.

Our code looks a little like this: 

    InstallTables();  // function uses smo to create tables in a database.
    string connString = CreateLogin(""userName"", ""password"");  // create login with smo
    
    // Test the returned connection string connects to the database
    using (SqlConnection con = new SqlConnection(connString))
    {
        con.Open();
        //test code to read the DB version out of a table
        //Dispose calls con.Close() - I have also tried calling it explicitly
    }
    
    DropTables();  // uses smo to drop tables from the database
    DropLogin(""userName"", ""password"");   // uses smo to drop the login

The DropLogin fails with the following exception:
System.Data.SqlClient.SqlException: Could not drop login 'engageSecurity_unittest_129418264074692569' as the user is currently logged in.

If I remove all the SqlConnection code until after the DropLogin, then everything runs fine.

Does anyone know why the user is not logged out when I call SqlConnection.Close() ?

Is this something to do with connection pooling?",sql-server,database-connection,smo,,,,open,0,266,7,"Why does sqlConnection.Close() not close the login? We have unit tests to test that our database install and uninstall features successfully work.
The unit tests use the **SqlClient.SqlConnection** class to check the database contents before, during and after.

Our problem is that after using SqlClient.SqlConnection, the **drop login** part of the uninstall fails because it claims that a user is currently logged in. Even though we have called SqlConnection.Close(), the login seems to be still open.

Our code looks a little like this: 

    InstallTables();  // function uses smo to create tables in a database.
    string connString = CreateLogin(""userName"", ""password"");  // create login with smo
    
    // Test the returned connection string connects to the database
    using (SqlConnection con = new SqlConnection(connString))
    {
        con.Open();
        //test code to read the DB version out of a table
        //Dispose calls con.Close() - I have also tried calling it explicitly
    }
    
    DropTables();  // uses smo to drop tables from the database
    DropLogin(""userName"", ""password"");   // uses smo to drop the login

The DropLogin fails with the following exception:
System.Data.SqlClient.SqlException: Could not drop login 'engageSecurity_unittest_129418264074692569' as the user is currently logged in.

If I remove all the SqlConnection code until after the DropLogin, then everything runs fine.

Does anyone know why the user is not logged out when I call SqlConnection.Close() ?

Is this something to do with connection pooling?",3
11384781,07/08/2012 16:35:52,347635,05/22/2010 04:38:14,106,4,"Rebuilding Indexes, DB now 10x the size","I have an MS SQL Server database (2008 R2 SP1) that was about 15 gigs. It turns out maintenance hadn't been running in a while, so I created a maintenance plan to rebuild all the indexes, they were very fragmented. The job finished and the fragmentation is gone, but now the database is over 120 gigs! I understand that it would have used extra space to do all the rebuilds, but now that the job is done, I would think all that space would be free space, but the free space only shows as 3 gigs, so 117 gigs is being used even though the index rebuild job is finished. I'm very confused and could use some guidance, I have the get the db back to a reasonable size, we don't have the disk space for this.

Thanks in advance!",sql-server,sql-server-2008,sql-server-2008-r2,,,07/08/2012 22:39:13,off topic,1,139,7,"Rebuilding Indexes, DB now 10x the size I have an MS SQL Server database (2008 R2 SP1) that was about 15 gigs. It turns out maintenance hadn't been running in a while, so I created a maintenance plan to rebuild all the indexes, they were very fragmented. The job finished and the fragmentation is gone, but now the database is over 120 gigs! I understand that it would have used extra space to do all the rebuilds, but now that the job is done, I would think all that space would be free space, but the free space only shows as 3 gigs, so 117 gigs is being used even though the index rebuild job is finished. I'm very confused and could use some guidance, I have the get the db back to a reasonable size, we don't have the disk space for this.

Thanks in advance!",3
6144126,05/26/2011 19:41:31,262210,01/29/2010 22:51:28,11,0,How can a table scan return more rows than are in the table?,"I have a complex query on a database with bad statistics and fragmented indices.  What I'm puzzled by is that when I examine an actual query plan I get 54 M rows from a table scan on a table that has 23 K rows.  Much further up the query plan this table is joined against itself (only 260 K rows out of 23 K).  How is this possible?

Running some other queries or rebuilding indices and statistics makes this go away, I'm just trying to understand why this would happen.

I have reproduced this with SQL 2005 and SQL 2008 R2 on a restore of the same database.",sql-server,query-plans,,,,,open,0,109,13,"How can a table scan return more rows than are in the table? I have a complex query on a database with bad statistics and fragmented indices.  What I'm puzzled by is that when I examine an actual query plan I get 54 M rows from a table scan on a table that has 23 K rows.  Much further up the query plan this table is joined against itself (only 260 K rows out of 23 K).  How is this possible?

Running some other queries or rebuilding indices and statistics makes this go away, I'm just trying to understand why this would happen.

I have reproduced this with SQL 2005 and SQL 2008 R2 on a restore of the same database.",2
8847029,01/13/2012 07:02:32,767920,08/30/2009 07:49:27,955,17,Get days from current timestamp in sql query,"i have an table 

    ID		Timestamp
    1       2010-07-27 13:14:00.000
    2		2010-08-13 13:14:00.000
    3		2010-12-21 13:14:00.000

now i need to subtract the day from Timestamp column  with current getdate()
and get the days from it

Hope my Question is clear any help would be great

Thanks
Prince

",sql-server,,,,,,open,0,58,8,"Get days from current timestamp in sql query i have an table 

    ID		Timestamp
    1       2010-07-27 13:14:00.000
    2		2010-08-13 13:14:00.000
    3		2010-12-21 13:14:00.000

now i need to subtract the day from Timestamp column  with current getdate()
and get the days from it

Hope my Question is clear any help would be great

Thanks
Prince

",1
6597705,07/06/2011 14:02:20,129001,06/25/2009 18:14:27,2106,34,Does SQL Server 2008/R2 Database Engine Tuning Advisor give better recommendations than the one from SQL Server 2005?,"Does SQL Server 2008/R2 Database Engine Tuning Advisor give better recommendations than the one from SQL Server 2005?

I would like to get answers from users who used both and noticed a difference.",sql-server,sql-server-2005,sql-server-2008,query-optimization,sql-tuning,06/18/2012 03:22:38,off topic,1,32,18,"Does SQL Server 2008/R2 Database Engine Tuning Advisor give better recommendations than the one from SQL Server 2005? Does SQL Server 2008/R2 Database Engine Tuning Advisor give better recommendations than the one from SQL Server 2005?

I would like to get answers from users who used both and noticed a difference.",5
10084928,04/10/2012 07:39:45,342245,05/16/2010 06:51:23,62,1,which SQL Server Product I shall install?,"I want to Learn SSIS package in windows XP system, which edition of SQL Server shall I install?

  I have downloaded the SQL Server 2008R2, but failed installed, the error message saying:

 SQL Server 2008R2 setup100.exe and setuppatch.exe canot be run in this mode. if you are running setup100.exe,
start setup.exe instead....

Thanks,
Ling",sql-server,ssis,windows-xp,installation,,04/11/2012 14:36:17,not a real question,1,52,7,"which SQL Server Product I shall install? I want to Learn SSIS package in windows XP system, which edition of SQL Server shall I install?

  I have downloaded the SQL Server 2008R2, but failed installed, the error message saying:

 SQL Server 2008R2 setup100.exe and setuppatch.exe canot be run in this mode. if you are running setup100.exe,
start setup.exe instead....

Thanks,
Ling",4
1722741,11/12/2009 14:52:15,179882,09/27/2009 22:49:47,47,1,Defining a one-to-one relationship in SQL Server,"I need to define a one-to-one relationship, and can't seem to find the proper way of doing it in SQL Server.

Why a one-to-one relationship you ask? 

I am using WCF as a DAL (Linq) and I have a table containing a BLOB column. The BLOB hardly ever changes and it would be a waste of bandwidth to transfer it across every time a query is made.

I had a look at [this solution][1], and though it seems like a great idea, I can just see Linq having a little sissy fit when trying to implement this approach.

Any ideas?


  [1]: http://sqlserver-tips.blogspot.com/2006/10/implementing-one-to-one-relationship.html",sql-server,linq,,,,,open,0,100,7,"Defining a one-to-one relationship in SQL Server I need to define a one-to-one relationship, and can't seem to find the proper way of doing it in SQL Server.

Why a one-to-one relationship you ask? 

I am using WCF as a DAL (Linq) and I have a table containing a BLOB column. The BLOB hardly ever changes and it would be a waste of bandwidth to transfer it across every time a query is made.

I had a look at [this solution][1], and though it seems like a great idea, I can just see Linq having a little sissy fit when trying to implement this approach.

Any ideas?


  [1]: http://sqlserver-tips.blogspot.com/2006/10/implementing-one-to-one-relationship.html",2
11042367,06/14/2012 22:45:26,20848,09/23/2008 01:07:29,7258,198,What is a better alternative to Excel for loading data to a MSSQL database?,"I'm having a huge amount of trouble loading spreadsheets into a MS SQL database.

Currently, I'm using an SSIS package to load the data and I have had to make lots of adjustments to get the data to load:

* All numbers must be formatted as text (otherwise they don't load properly).  
* Sometimes numbers must be preceeded with single quote (') to get them to load.  
* If a column has a mix of number cells and text cells, the text cells must come first in the file (otherwise only numbers load and text comes in as NULL).  
* If a user changes a column name the file will not load.  
* If a user changes a tab name the file won't load.  
* If a user adds a new column (even at the end of a sheet) the file won't load.  
* Extra sheets in the file is not a problem, thankfully!  
* Dates seem sensitive whether or not they will load properly.  
* Scheduled SSIS jobs must be run as 32-bit even on 64-bit system.

I've been loading the data (usually 200,000-500,000 rows per file) into a table with all fields defined as nvarchar.  Then, when loaded I transfer that data in the next step of the SSIS package to the working table with typed data fields.

All of the requirements that I must put on the user for how to format the Excel file is really a pain.  We usually have to send the file back multiple times until all the formatting issues are correct before the file will load.  I'd like to eliminate this thrash.

I know I'm not the only one that is facing this type of problem.  So, I must ask...

What is a better alternative to Excel for loading data to a SQL database?

Or, am I going about this the wrong way?  Should I be using something other than SSIS to load Excel spreadsheets?",sql-server,excel,ssis,data-loading,,,open,0,329,14,"What is a better alternative to Excel for loading data to a MSSQL database? I'm having a huge amount of trouble loading spreadsheets into a MS SQL database.

Currently, I'm using an SSIS package to load the data and I have had to make lots of adjustments to get the data to load:

* All numbers must be formatted as text (otherwise they don't load properly).  
* Sometimes numbers must be preceeded with single quote (') to get them to load.  
* If a column has a mix of number cells and text cells, the text cells must come first in the file (otherwise only numbers load and text comes in as NULL).  
* If a user changes a column name the file will not load.  
* If a user changes a tab name the file won't load.  
* If a user adds a new column (even at the end of a sheet) the file won't load.  
* Extra sheets in the file is not a problem, thankfully!  
* Dates seem sensitive whether or not they will load properly.  
* Scheduled SSIS jobs must be run as 32-bit even on 64-bit system.

I've been loading the data (usually 200,000-500,000 rows per file) into a table with all fields defined as nvarchar.  Then, when loaded I transfer that data in the next step of the SSIS package to the working table with typed data fields.

All of the requirements that I must put on the user for how to format the Excel file is really a pain.  We usually have to send the file back multiple times until all the formatting issues are correct before the file will load.  I'd like to eliminate this thrash.

I know I'm not the only one that is facing this type of problem.  So, I must ask...

What is a better alternative to Excel for loading data to a SQL database?

Or, am I going about this the wrong way?  Should I be using something other than SSIS to load Excel spreadsheets?",4
7825561,10/19/2011 17:40:12,295096,03/16/2010 19:52:17,185,19,Any scripting language to interact with both WebServices & MS SQL Server?,"I'm trying to write a simple script to simplify some common tasks for our team. These tasks include calling simple web methods (.NET web services) and execute some simple queries against the database (MS SQL server).

For it to be useful, it should work with as less configuration steps as possible.

I've have already tried with python, but I've found the package requirements to make it connect to MS Sql Server are too complicated to install.

I've also used PowerShell, which seems to do the trick, but IMHO it's syntax is quite 'dirty'.

Any ideas?
",sql-server,web-services,scripting,,,10/19/2011 23:36:34,not constructive,1,91,12,"Any scripting language to interact with both WebServices & MS SQL Server? I'm trying to write a simple script to simplify some common tasks for our team. These tasks include calling simple web methods (.NET web services) and execute some simple queries against the database (MS SQL server).

For it to be useful, it should work with as less configuration steps as possible.

I've have already tried with python, but I've found the package requirements to make it connect to MS Sql Server are too complicated to install.

I've also used PowerShell, which seems to do the trick, but IMHO it's syntax is quite 'dirty'.

Any ideas?
",3
6418273,06/20/2011 22:22:35,265706,02/03/2010 22:06:04,350,21,SQL Server Proper Indefinite Article,"Help me with my documentation, please. 

Which is proper?

If you have a SQL Server... (*sequel* Server)

or

If you have an SQL Server... (*s-q-l* Server)

Thanks.",sql-server,documentation,,,,06/21/2011 09:02:09,off topic,1,23,5,"SQL Server Proper Indefinite Article Help me with my documentation, please. 

Which is proper?

If you have a SQL Server... (*sequel* Server)

or

If you have an SQL Server... (*s-q-l* Server)

Thanks.",2
2844295,05/16/2010 15:29:18,223755,12/03/2009 11:06:55,99,8,parameter in Stored Procedures.,"How many types of parameters are there in a stored procedures and what are they?
Thanks in advance.

And can we delete a table using view? I think yes but in what situation we can't delete it if there are no trigger associated with that table. I mean to say i need to delete a table which has no trigger associated with it using view, in which case i can't delete it?",sql-server,,,,,,open,0,70,4,"parameter in Stored Procedures. How many types of parameters are there in a stored procedures and what are they?
Thanks in advance.

And can we delete a table using view? I think yes but in what situation we can't delete it if there are no trigger associated with that table. I mean to say i need to delete a table which has no trigger associated with it using view, in which case i can't delete it?",1
539864,02/12/2009 03:17:47,8678,09/15/2008 16:34:57,88,8,any way to detect a TimeStamp column in a DataTable from SQL Server (fillSchema???),"When updating a datatable from a ""select * from sometable"", I am iterating the columns in the datatable to dynamically create an update or insert statement, based on datatable.rowstate and DataTable.PrimaryKey.

However, I can't seem to find any property that indicates whether a column is a TimeStamp in SQL Server and must therefore be ignored in the update statement!!!",sql-server,sql-server-2005,ado.net,visual-studio,,,open,0,58,14,"any way to detect a TimeStamp column in a DataTable from SQL Server (fillSchema???) When updating a datatable from a ""select * from sometable"", I am iterating the columns in the datatable to dynamically create an update or insert statement, based on datatable.rowstate and DataTable.PrimaryKey.

However, I can't seem to find any property that indicates whether a column is a TimeStamp in SQL Server and must therefore be ignored in the update statement!!!",4
9313792,02/16/2012 15:15:00,916535,08/28/2011 15:11:43,521,23,Simplest way to append data to a SQL Column,"I'm sure i can figure something out using `replace`, etc, but just wondering if there is anything out there that lets you simply append data to a column rather than how the common `Insert` function works?

Well I guess i can do `INSERT INTO TABLE (NAME) SELECT Name + @Name` right?",sql-server,sql-server-2008,tsql,,,02/18/2012 00:26:47,not constructive,1,50,9,"Simplest way to append data to a SQL Column I'm sure i can figure something out using `replace`, etc, but just wondering if there is anything out there that lets you simply append data to a column rather than how the common `Insert` function works?

Well I guess i can do `INSERT INTO TABLE (NAME) SELECT Name + @Name` right?",3
11257515,06/29/2012 07:07:54,1479146,06/25/2012 06:01:02,100,3,The server principal “DevMe” is not able to access the database “CallManager” under the current security context,"I am trying to remove/ drop a users permissions but i keep getting the following error:

   

    

>  The server principal “DevMe” is not able to access the database
> “CallManager” under the             current security context.

My Stored proc to do this looks as follows:

    USE [AuditIT]
    GO
    /****** Object:  StoredProcedure [dbo].[AdminDevUserDelete]    Script Date: 06/29/2012 08:54:27 ******/
    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    --alter table AdminLog add HostName varchar(128) NULL DEFAULT HOST_NAME()
    
    ALTER PROCEDURE [dbo].[AdminDevUserDelete]
    	@SQLLoginName varchar(50) 
    AS   
    
    DECLARE @DatabaseName varchar(1000)
    
    PRINT 'USE [master] DROP LOGIN [' + @SQLLoginName + ']'
    EXEC ('USE [master] DROP LOGIN [' + @SQLLoginName + ']')
    
    DECLARE CSDatabase CURSOR FOR 
    	SELECT
    		[Name]
    	FROM
    		[Master]..SysDatabases
    	--WHERE
    	--	--[sid] = 0x01
    	--	[Name] NOT IN ('ReportSRV.Support','HelpDeskFacilities','QuestSoftware')
    	ORDER BY
    		dbid DESC
    OPEN CSDatabase
    FETCH NEXT FROM CSDatabase INTO @DatabaseName
    WHILE @@FETCH_STATUS = 0
    BEGIN
    	EXEC ('SELECT [Name] FROM [' + @DatabaseName + ']..SysUsers WHERE [Name] = ''' + @SQLLoginName + '''')
    	IF @@RowCount > 0
    	BEGIN
    		PRINT 'USE [' + @DatabaseName + '] DROP USER [' + @SQLLoginName +']'
    		EXEC ('USE [' + @DatabaseName + '] DROP USER [' + @SQLLoginName +']')
    	END
    	FETCH NEXT FROM CSDatabase INTO @DatabaseName
    END
    CLOSE CSDatabase
    DEALLOCATE CSDatabase

**Could someone please explain how i could fix this problem?**
",sql-server,sql-server-2008,,,,,open,0,360,17,"The server principal “DevMe” is not able to access the database “CallManager” under the current security context I am trying to remove/ drop a users permissions but i keep getting the following error:

   

    

>  The server principal “DevMe” is not able to access the database
> “CallManager” under the             current security context.

My Stored proc to do this looks as follows:

    USE [AuditIT]
    GO
    /****** Object:  StoredProcedure [dbo].[AdminDevUserDelete]    Script Date: 06/29/2012 08:54:27 ******/
    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    --alter table AdminLog add HostName varchar(128) NULL DEFAULT HOST_NAME()
    
    ALTER PROCEDURE [dbo].[AdminDevUserDelete]
    	@SQLLoginName varchar(50) 
    AS   
    
    DECLARE @DatabaseName varchar(1000)
    
    PRINT 'USE [master] DROP LOGIN [' + @SQLLoginName + ']'
    EXEC ('USE [master] DROP LOGIN [' + @SQLLoginName + ']')
    
    DECLARE CSDatabase CURSOR FOR 
    	SELECT
    		[Name]
    	FROM
    		[Master]..SysDatabases
    	--WHERE
    	--	--[sid] = 0x01
    	--	[Name] NOT IN ('ReportSRV.Support','HelpDeskFacilities','QuestSoftware')
    	ORDER BY
    		dbid DESC
    OPEN CSDatabase
    FETCH NEXT FROM CSDatabase INTO @DatabaseName
    WHILE @@FETCH_STATUS = 0
    BEGIN
    	EXEC ('SELECT [Name] FROM [' + @DatabaseName + ']..SysUsers WHERE [Name] = ''' + @SQLLoginName + '''')
    	IF @@RowCount > 0
    	BEGIN
    		PRINT 'USE [' + @DatabaseName + '] DROP USER [' + @SQLLoginName +']'
    		EXEC ('USE [' + @DatabaseName + '] DROP USER [' + @SQLLoginName +']')
    	END
    	FETCH NEXT FROM CSDatabase INTO @DatabaseName
    END
    CLOSE CSDatabase
    DEALLOCATE CSDatabase

**Could someone please explain how i could fix this problem?**
",2
11549118,07/18/2012 19:46:35,1499112,07/03/2012 14:35:55,309,16,How does the Database decides which Index to execute,"DDL
---


    create table t
    (
    	id int,
    	id1 int
    )
    
    create index Example_Index
      On t(id,id1)
    
    create index Example1_Index
      On t(id1,id)

---

DML
---


    insert into t(id, id1)values(1, 100)
    insert into t(id, id1)values(1, 101)
    insert into t(id, id1)values(2, 103)
    insert into t(id, id1)values(1, 104)
    insert into t(id, id1)values(3, 105)
    insert into t(id, id1)values(1, 106)
    insert into t(id, id1)values(2, 107)
    insert into t(id, id1)values(3, 108)

---



Query - `select * from t Where id = 107`  -- Fires `Example_Index`

Query - `select * from t Where id1 = 107` -- Fires `Example1_Index`

Query - `select * from t`                 -- Fires `Example1_Index`


**Confusion** - How does the system decides to execute `Example1_Index`",sql-server,sql-server-2008,sql-server-2005,,,07/19/2012 17:58:23,off topic,1,181,9,"How does the Database decides which Index to execute DDL
---


    create table t
    (
    	id int,
    	id1 int
    )
    
    create index Example_Index
      On t(id,id1)
    
    create index Example1_Index
      On t(id1,id)

---

DML
---


    insert into t(id, id1)values(1, 100)
    insert into t(id, id1)values(1, 101)
    insert into t(id, id1)values(2, 103)
    insert into t(id, id1)values(1, 104)
    insert into t(id, id1)values(3, 105)
    insert into t(id, id1)values(1, 106)
    insert into t(id, id1)values(2, 107)
    insert into t(id, id1)values(3, 108)

---



Query - `select * from t Where id = 107`  -- Fires `Example_Index`

Query - `select * from t Where id1 = 107` -- Fires `Example1_Index`

Query - `select * from t`                 -- Fires `Example1_Index`


**Confusion** - How does the system decides to execute `Example1_Index`",3
6251468,06/06/2011 11:38:39,557022,12/29/2010 10:44:06,106,4,Same Fact Table Column; Records with Multiple Reasons,"

I am in a situation similar to the one below:

Think for instance we need to store customer sales in a fact table (under a data warehouse built with dimensional modelling). I have sales, discounts related to the sale, sales returns and cancellations to be stored. 

Do you think it would be advisable to store sales for a day to a customer in a particular product (when the day is the grain) as a positive value while the returns and discounts are stored as minuses? 

Also if a discount is enforced to a customer at a level other than the product (for instance brand), do you think it is alright to persist it with a key particularly assigned to the brand (product is the grain) while the product column being given an N/A, for the particular record?

Thanks in advance. ",sql-server,data-warehouse,business-intelligence,,,,open,0,139,8,"Same Fact Table Column; Records with Multiple Reasons 

I am in a situation similar to the one below:

Think for instance we need to store customer sales in a fact table (under a data warehouse built with dimensional modelling). I have sales, discounts related to the sale, sales returns and cancellations to be stored. 

Do you think it would be advisable to store sales for a day to a customer in a particular product (when the day is the grain) as a positive value while the returns and discounts are stored as minuses? 

Also if a discount is enforced to a customer at a level other than the product (for instance brand), do you think it is alright to persist it with a key particularly assigned to the brand (product is the grain) while the product column being given an N/A, for the particular record?

Thanks in advance. ",3
358586,12/11/2008 06:37:19,40474,11/25/2008 01:48:07,6,0,SQL SERVER 2008 upgrading not work,"I have done an upgrading with SQL Server 2008 on SQL Server 2005 using the upgrading wizard , once completed I found that the 2005 was still exist. I used the same instance that was in SQL Server 2005, but I can’t connect. And all data, which are stored on SQL Server 2005, are not found on SQL Server 2008 with the same instance. Do I need to import the data manually? Or did I miss any steps during the upgrading?",sql-server,sql,server,2008,,01/09/2012 13:36:24,off topic,1,81,6,"SQL SERVER 2008 upgrading not work I have done an upgrading with SQL Server 2008 on SQL Server 2005 using the upgrading wizard , once completed I found that the 2005 was still exist. I used the same instance that was in SQL Server 2005, but I can’t connect. And all data, which are stored on SQL Server 2005, are not found on SQL Server 2008 with the same instance. Do I need to import the data manually? Or did I miss any steps during the upgrading?",4
553515,02/16/2009 14:49:53,27535,10/13/2008 17:10:51,1819,147,NULL parameters in scalar UDFs on MSSQL,"The option ""RETURNS NULL ON NULL INPUT"" for a scalar UDF (see [CREATE FUNCTION][1]) stops the function body executing if the parameter is null and simply returns NULL.

That is, it short circuits.

Does anyone know how it handles multiple parameters?

It would be useful to short circuit a function call with multiple parameters, say if the first one is NULL at least.

When I have time, I'll use profiler to try and trace the udf calls.
I've searched but can't find anything.. more likely I may not have used the correct search terms.

In the meantime, does anyone have any ideas or experience?

Answers from the other RDBMS worlds are welcome too.. this is an ANSI setting and I saw results for DB2 and MySQL in my searches

Cheers
S


  [1]: http://msdn.microsoft.com/en-us/library/ms186755(SQL.90).aspx",sql-server,udf,short-circuiting,,,,open,0,125,7,"NULL parameters in scalar UDFs on MSSQL The option ""RETURNS NULL ON NULL INPUT"" for a scalar UDF (see [CREATE FUNCTION][1]) stops the function body executing if the parameter is null and simply returns NULL.

That is, it short circuits.

Does anyone know how it handles multiple parameters?

It would be useful to short circuit a function call with multiple parameters, say if the first one is NULL at least.

When I have time, I'll use profiler to try and trace the udf calls.
I've searched but can't find anything.. more likely I may not have used the correct search terms.

In the meantime, does anyone have any ideas or experience?

Answers from the other RDBMS worlds are welcome too.. this is an ANSI setting and I saw results for DB2 and MySQL in my searches

Cheers
S


  [1]: http://msdn.microsoft.com/en-us/library/ms186755(SQL.90).aspx",3
11286230,07/01/2012 22:52:48,1164164,01/23/2012 01:16:35,1,0,Adding sample database to SqlServer 2012,"I am trying to add AdventureWorks sample database to SqlServer 2012, but I get an error message **Msg 5133, Level 16, State 1, Line 1
Directory lookup for the file ""C:\Users\A\Documents\SQL Server Management Studio\Data\AdventureWorks2012_Data.mdf"" failed with the operating system error 5(Access is denied.).** 
Please help me.
Thank you.",sql-server,,,,,07/02/2012 09:45:13,off topic,1,46,6,"Adding sample database to SqlServer 2012 I am trying to add AdventureWorks sample database to SqlServer 2012, but I get an error message **Msg 5133, Level 16, State 1, Line 1
Directory lookup for the file ""C:\Users\A\Documents\SQL Server Management Studio\Data\AdventureWorks2012_Data.mdf"" failed with the operating system error 5(Access is denied.).** 
Please help me.
Thank you.",1
750224,04/15/2009 03:43:00,17510,09/18/2008 10:26:18,174,7,Update subset of data in sqlserver,"I have been given the following request.

Please give 7% of the current contacts registered to each of the sales associates to the new sales associate ('Peter').

What I decided to do was to get the total records for each sales associate and calculate 7% of the records.

For example 
David has 200
200/7%  = 14

    SELECT TOP 14 ContactAssociate
    FROM tb_Contact 
    WHERE tb_Contact.ContactAssociate = 'David' 
    ORDER BY NEWID()
   

Now, I can select the data but am struggling to update them;
I thought this would do it but no joy.

    UPDATE tb_Contact
    SET ContactAssociate = 'Peter'
    IN
    (
    SELECT TOP 14 ContactAssociate
    FROM tb_Contact 
    WHERE tb_Contact.ContactAssociate = 'David' 
    ORDER BY NEWID()
    )


Any ideas where, I'm going wrong?
Any help, much appreciated.

",sql-server,sql,,,,,open,0,161,6,"Update subset of data in sqlserver I have been given the following request.

Please give 7% of the current contacts registered to each of the sales associates to the new sales associate ('Peter').

What I decided to do was to get the total records for each sales associate and calculate 7% of the records.

For example 
David has 200
200/7%  = 14

    SELECT TOP 14 ContactAssociate
    FROM tb_Contact 
    WHERE tb_Contact.ContactAssociate = 'David' 
    ORDER BY NEWID()
   

Now, I can select the data but am struggling to update them;
I thought this would do it but no joy.

    UPDATE tb_Contact
    SET ContactAssociate = 'Peter'
    IN
    (
    SELECT TOP 14 ContactAssociate
    FROM tb_Contact 
    WHERE tb_Contact.ContactAssociate = 'David' 
    ORDER BY NEWID()
    )


Any ideas where, I'm going wrong?
Any help, much appreciated.

",2
7660501,10/05/2011 11:22:53,239588,12/28/2009 13:48:42,41,7,How to use GROUP BY with SELF JOIN?,"I have a person table which holds person and his manager at the same time.<br>I'm using SELF JOIN to select managers email but I get a lot of duplicates.<br><br>How can I use GROUP BY with my query

  	SELECT				P.prs_id AS 'Employee_id', M.prs_id AS 'Manager_id', M.prs_email AS 'Manager_email'
	FROM				qrd_prs_person AS P
	LEFT OUTER JOIN		qrd_prs_person AS M  
	ON					P.prs_manager_number = M.prs_number

> GROUP BY   M.prs_id

If I add this line at the end of my query to group by Manager_id, I receive this error  
        
> Column 'qrd_prs_person.prs_id' is invalid in the select list because
> it is not contained in either an aggregate function or the GROUP BY
> clause.

",sql-server,group-by,self-join,,,,open,0,113,8,"How to use GROUP BY with SELF JOIN? I have a person table which holds person and his manager at the same time.<br>I'm using SELF JOIN to select managers email but I get a lot of duplicates.<br><br>How can I use GROUP BY with my query

  	SELECT				P.prs_id AS 'Employee_id', M.prs_id AS 'Manager_id', M.prs_email AS 'Manager_email'
	FROM				qrd_prs_person AS P
	LEFT OUTER JOIN		qrd_prs_person AS M  
	ON					P.prs_manager_number = M.prs_number

> GROUP BY   M.prs_id

If I add this line at the end of my query to group by Manager_id, I receive this error  
        
> Column 'qrd_prs_person.prs_id' is invalid in the select list because
> it is not contained in either an aggregate function or the GROUP BY
> clause.

",3
4172539,11/13/2010 12:43:16,320126,03/10/2010 12:53:37,174,3,"folks, can anybody help me to convert Progress procedure to SQL server stored procedure","If yes, I can send the progress sp snippet , which needs to be converted.",sql-server,progress,,,,08/04/2011 12:30:38,not a real question,1,15,14,"folks, can anybody help me to convert Progress procedure to SQL server stored procedure If yes, I can send the progress sp snippet , which needs to be converted.",2
6778760,07/21/2011 15:38:17,617619,02/15/2011 10:47:28,13,0,Can anyone help me find a good host that supports MDF file?,"Can anyone help me find a good host that supports MDF file? I have a site that works perfectly in my desktop but when I uploaded it to Arvixe it wont work and I can't get a straight answer from them.
Please I need your help so bad. Thank you.",sql-server,.mdf,,,,07/21/2011 16:04:29,off topic,1,49,12,"Can anyone help me find a good host that supports MDF file? Can anyone help me find a good host that supports MDF file? I have a site that works perfectly in my desktop but when I uploaded it to Arvixe it wont work and I can't get a straight answer from them.
Please I need your help so bad. Thank you.",2
1926427,12/18/2009 05:16:44,125292,06/18/2009 18:14:48,113,13,Is latency or my VPN choking my Excel to SQL Server uploads?,"I am uploading data from Excel to SQL Server using the following structure:

    Private Sub ado_upload()
    
        Dim objConnection As New ADODB.Connection
        Dim objCommand As New ADODB.Command
        Dim strSQL As String
        Dim strDSN As String
        Dim intCounter As Integer
        
        strDSN = ""provider=SQLOLEDB;"" _
        & ""server=<server>;"" _
        & ""database=<database>;"" _
        & ""uid=<uid>;pwd=<pwd>;"" _
        & ""trusted_connection=false;""
        
        With objConnection
            .ConnectionString = strDSN
            .Open
        End With
        
        strSQL = ""SET NOCOUNT ON; "" _
        & ""INSERT INTO dbo.[table1] ( [col1] ) VALUES ( ? );""
        
        With objCommand
            
            .ActiveConnection = objConnection
            .CommandText = strSQL
            .Prepared = True
            .Parameters.Append .CreateParameter(""col1"", adInteger, adParamInput)
            
            For intCounter = 0 To 9
                .Parameters(""Col1"").Value = intCounter
                .Execute
            Next intCounter
        
        End With
    
    End Sub

The speed of the procedure depends on the geographic distance between the server and the computer running the procedure. On the server itself it is fast (300,000 inserts in under 10 minutes), on the other side of the country it is relatively slow (300,000 inserts could take hours). Remote uploads operate over a VPN.

I think network latency must be slowing the process down. Is there any way to get around network latency, or tweak the VPN to make the uploads faster?

Thanks!",sql-server,latency,vpn,ado,,,open,0,498,12,"Is latency or my VPN choking my Excel to SQL Server uploads? I am uploading data from Excel to SQL Server using the following structure:

    Private Sub ado_upload()
    
        Dim objConnection As New ADODB.Connection
        Dim objCommand As New ADODB.Command
        Dim strSQL As String
        Dim strDSN As String
        Dim intCounter As Integer
        
        strDSN = ""provider=SQLOLEDB;"" _
        & ""server=<server>;"" _
        & ""database=<database>;"" _
        & ""uid=<uid>;pwd=<pwd>;"" _
        & ""trusted_connection=false;""
        
        With objConnection
            .ConnectionString = strDSN
            .Open
        End With
        
        strSQL = ""SET NOCOUNT ON; "" _
        & ""INSERT INTO dbo.[table1] ( [col1] ) VALUES ( ? );""
        
        With objCommand
            
            .ActiveConnection = objConnection
            .CommandText = strSQL
            .Prepared = True
            .Parameters.Append .CreateParameter(""col1"", adInteger, adParamInput)
            
            For intCounter = 0 To 9
                .Parameters(""Col1"").Value = intCounter
                .Execute
            Next intCounter
        
        End With
    
    End Sub

The speed of the procedure depends on the geographic distance between the server and the computer running the procedure. On the server itself it is fast (300,000 inserts in under 10 minutes), on the other side of the country it is relatively slow (300,000 inserts could take hours). Remote uploads operate over a VPN.

I think network latency must be slowing the process down. Is there any way to get around network latency, or tweak the VPN to make the uploads faster?

Thanks!",4
2545547,03/30/2010 13:31:25,231518,12/14/2009 18:29:27,126,1,cross tab query,"I have a project table with the following columns

    ProjectID, ProjectDescription

and a list data table which has the following columns

    ProjectID ListType Date Memo

Every project has many list type entries in the ListType Table.

What I want to do is run a query which will return something like this

    ProjectID, ProjectDescription, ListType1, ListType1.date, Listtype1.Memo, ListType2, ListType2.date, ListType.Memo

Againg, Every Project is coonected to a number of list type data.
I am using Microsoft SQL 2000. so the Pivot keyword doesnot work",sql-server,sql,sql-server-2000,,,,open,0,87,3,"cross tab query I have a project table with the following columns

    ProjectID, ProjectDescription

and a list data table which has the following columns

    ProjectID ListType Date Memo

Every project has many list type entries in the ListType Table.

What I want to do is run a query which will return something like this

    ProjectID, ProjectDescription, ListType1, ListType1.date, Listtype1.Memo, ListType2, ListType2.date, ListType.Memo

Againg, Every Project is coonected to a number of list type data.
I am using Microsoft SQL 2000. so the Pivot keyword doesnot work",3
9067131,01/30/2012 16:24:27,95467,04/24/2009 12:42:58,494,27,What are the disadvantages of Postgresql over MSSQL?,"I have a DB server with one or more schematically equal databases running on MSSQL 2005. I want to migrate this server to Postgresql 8.4 (no migration to 9.x is possible due to some other reasoss). Every database has approximately 50 tables. Database tables are different, they have between 0 - couple of millions of records. There are some views defined in each DB which expose data from one or more tables. 
<BR>
Regarding security, there is only the master DB schema and only one user, so the simplest possible scenario. I do not expect any problems in terms of security due to the migration.
<BR>
What facts do I need to keep in mind if I want the migration to succeed? Are there any performance considerations? Any disadvantages of MSSQL over Postgresql?
<BR>
Since the target platform will be Windows 2008 server, I was thinking that MSSQL might be better optimized for Windows platfrom due to the fact that it supports only Win platforms and no linux/unix. Am I right?<BR>",sql-server,sql-server-2005,postgresql,,,01/30/2012 16:35:46,off topic,1,166,8,"What are the disadvantages of Postgresql over MSSQL? I have a DB server with one or more schematically equal databases running on MSSQL 2005. I want to migrate this server to Postgresql 8.4 (no migration to 9.x is possible due to some other reasoss). Every database has approximately 50 tables. Database tables are different, they have between 0 - couple of millions of records. There are some views defined in each DB which expose data from one or more tables. 
<BR>
Regarding security, there is only the master DB schema and only one user, so the simplest possible scenario. I do not expect any problems in terms of security due to the migration.
<BR>
What facts do I need to keep in mind if I want the migration to succeed? Are there any performance considerations? Any disadvantages of MSSQL over Postgresql?
<BR>
Since the target platform will be Windows 2008 server, I was thinking that MSSQL might be better optimized for Windows platfrom due to the fact that it supports only Win platforms and no linux/unix. Am I right?<BR>",3
4327026,12/01/2010 17:15:57,57159,01/20/2009 16:21:54,7418,400,How do I get “select for xml” to output to several files?,"Our customer is complaining that our export file is too long; they would like us to split the export into many files with no more than “n” records per file.  Is there a way of doing this with “select for xml”

(If this is too hard, I can always post process the single large file to split it up)
",sql-server,xml,tsql,forxml,,,open,0,59,12,"How do I get “select for xml” to output to several files? Our customer is complaining that our export file is too long; they would like us to split the export into many files with no more than “n” records per file.  Is there a way of doing this with “select for xml”

(If this is too hard, I can always post process the single large file to split it up)
",4
8267090,11/25/2011 09:36:22,327528,04/28/2010 06:13:59,948,6,Advantage to using SQL Server Reporting Services?,"What advantage is there to using SQL Server Reporting Services instead of just using normal reporting through the application ?

I can understand that the data is on the SQL Server so perhaps this is a good place to serve the report from but what are the actual advantages in practice and is it worth converting your app to use Reporting Services?",sql-server,reporting-services,,,,11/26/2011 02:24:40,not constructive,1,61,7,"Advantage to using SQL Server Reporting Services? What advantage is there to using SQL Server Reporting Services instead of just using normal reporting through the application ?

I can understand that the data is on the SQL Server so perhaps this is a good place to serve the report from but what are the actual advantages in practice and is it worth converting your app to use Reporting Services?",2
3859504,10/04/2010 22:04:20,80907,03/21/2009 17:38:36,1456,40,"SQL Server 2005 Management finds no database, 2008 won't install","In the past, I installed Visual Studio 2010. With that comes SQL Server.

Now I installed this: [https://www.microsoft.com/downloads/en/details.aspx?FamilyID=c243a5ae-4bd1-4e3d-94b8-5a0f62bf7796][1]
Microsoft SQL Server Management Studio Express

Now, upon starting, I get this screen: <br>
![alt text][2]

And it doesn't matter what Server name I enter, nothing works.


I've tried installing SQL Server 2008 Enterprise(I can get that via MSDNAA), but that fails totally, giving me this error:

> TITLE: Microsoft SQL Server 2008 Setup
> ------------------------------
> 
> The following error has occurred:
> 
> Unable to open Windows Installer file
> 'G:\x86\setup\sql_engine_core_inst_loc_msi\1033\sql_engine_core_inst_loc.msi'.
> 
> Windows Installer error message: The
> system cannot open the device or file
> specified. .
> 
> Click 'Retry' to retry the failed
> action, or click 'Cancel' to cancel
> this action and continue setup.
> 
> For help, click:
> [http://go.microsoft.com/fwlink?LinkID=20476&ProdName=Microsoft+SQL+Server&EvtSrc=setup.rll&EvtID=50000&ProdVer=10.0.2531.0&EvtType=0xC24842DB][3]
> 
> ------------------------------ BUTTONS:
> 
> &Retry Cancel
> ------------------------------


There is no help, I can click retry as much as I want, nothing changes. I went to the file itself, and Windows says I should check if it is a valid installer file.

And that's my story. I need to get this up and running, and it's all going against me. Can anyone help?


  [1]: https://www.microsoft.com/downloads/en/details.aspx?FamilyID=c243a5ae-4bd1-4e3d-94b8-5a0f62bf7796
  [2]: http://i.stack.imgur.com/oDde2.png
  [3]: http://go.microsoft.com/fwlink?LinkID=20476&ProdName=Microsoft+SQL+Server&EvtSrc=setup.rll&EvtID=50000&ProdVer=10.0.2531.0&EvtType=0xC24842DB",sql-server,,,,,,open,0,187,10,"SQL Server 2005 Management finds no database, 2008 won't install In the past, I installed Visual Studio 2010. With that comes SQL Server.

Now I installed this: [https://www.microsoft.com/downloads/en/details.aspx?FamilyID=c243a5ae-4bd1-4e3d-94b8-5a0f62bf7796][1]
Microsoft SQL Server Management Studio Express

Now, upon starting, I get this screen: <br>
![alt text][2]

And it doesn't matter what Server name I enter, nothing works.


I've tried installing SQL Server 2008 Enterprise(I can get that via MSDNAA), but that fails totally, giving me this error:

> TITLE: Microsoft SQL Server 2008 Setup
> ------------------------------
> 
> The following error has occurred:
> 
> Unable to open Windows Installer file
> 'G:\x86\setup\sql_engine_core_inst_loc_msi\1033\sql_engine_core_inst_loc.msi'.
> 
> Windows Installer error message: The
> system cannot open the device or file
> specified. .
> 
> Click 'Retry' to retry the failed
> action, or click 'Cancel' to cancel
> this action and continue setup.
> 
> For help, click:
> [http://go.microsoft.com/fwlink?LinkID=20476&ProdName=Microsoft+SQL+Server&EvtSrc=setup.rll&EvtID=50000&ProdVer=10.0.2531.0&EvtType=0xC24842DB][3]
> 
> ------------------------------ BUTTONS:
> 
> &Retry Cancel
> ------------------------------


There is no help, I can click retry as much as I want, nothing changes. I went to the file itself, and Windows says I should check if it is a valid installer file.

And that's my story. I need to get this up and running, and it's all going against me. Can anyone help?


  [1]: https://www.microsoft.com/downloads/en/details.aspx?FamilyID=c243a5ae-4bd1-4e3d-94b8-5a0f62bf7796
  [2]: http://i.stack.imgur.com/oDde2.png
  [3]: http://go.microsoft.com/fwlink?LinkID=20476&ProdName=Microsoft+SQL+Server&EvtSrc=setup.rll&EvtID=50000&ProdVer=10.0.2531.0&EvtType=0xC24842DB",1
3662437,09/07/2010 20:25:57,441805,05/11/2010 22:03:35,3,0,sql server mdf file database attachment,hello all i'm having a bear of a time getting visual studio 2010 (ultimate i think) to properly attach to my database.  it was moved from original spot to #MYAPP#/#MYAPP#.Web/App_Data/#MDF_FILE#.mdf.  I have three instances of sql server running on this machine.  i have tried to replace the old mdf file with my new one and cannot get the connectionstring right for it.  ,sql-server,visual-studio-2010,mdf,,,,open,0,67,6,sql server mdf file database attachment hello all i'm having a bear of a time getting visual studio 2010 (ultimate i think) to properly attach to my database.  it was moved from original spot to #MYAPP#/#MYAPP#.Web/App_Data/#MDF_FILE#.mdf.  I have three instances of sql server running on this machine.  i have tried to replace the old mdf file with my new one and cannot get the connectionstring right for it.  ,3
2413805,03/10/2010 01:03:44,269595,02/09/2010 15:38:29,211,13,Best books for SQL Server / database design.,"I have some really good books for SQL Server, like:

 - SQL Server 2008 Bible
 - Pro SQL Server 2008 - Relational Database Design and Implementation
 - SQL Server 2008 for Developers.

Can you suggest/recommend some other titles, that may address other topics perhaps, that you found truly useful?",sql-server,sql,databases,database-design,database,09/30/2011 12:26:03,not constructive,1,48,8,"Best books for SQL Server / database design. I have some really good books for SQL Server, like:

 - SQL Server 2008 Bible
 - Pro SQL Server 2008 - Relational Database Design and Implementation
 - SQL Server 2008 for Developers.

Can you suggest/recommend some other titles, that may address other topics perhaps, that you found truly useful?",5
6292217,06/09/2011 11:41:40,557022,12/29/2010 10:44:06,108,4,Data warehouse with unpivoted data,"I am building a data warehouse for the company's (which I am working for) core ERP application, for a particular client.

In the source database most of the dimension information in the data warehouse are stored in an unpivoted manner basically since the application is a product which is to be customized on the client's request.

For the current client I am working with, I can unpivot and extract the data. But my concern is, if we are going to reuse the data warehouse (with other customers too) then I think depending on the way they classify the fields the data warehouse model will not be able to adjust and further customization would require. 

Do let me know whether there is any competent mechanism to overcome this design issue.

Following is an example of the way the products are classified in the source database (this applies to most of the other master data classifications too),

-----------------------------------------------------------------------
Product Code	MasterClassification	MasterClassificationValue
-----------------------------------------------------------------------
AAA		Brand			AA
AAA		Category		A
-----------------------------------------------------------------------

Same set of data pivoted:

---------------------------------------------
ProductCode	Brand		Category
---------------------------------------------
AAA		AA		A
---------------------------------------------

Thanks in advance.
",sql-server,data-warehouse,business-intelligence,,,,open,0,159,5,"Data warehouse with unpivoted data I am building a data warehouse for the company's (which I am working for) core ERP application, for a particular client.

In the source database most of the dimension information in the data warehouse are stored in an unpivoted manner basically since the application is a product which is to be customized on the client's request.

For the current client I am working with, I can unpivot and extract the data. But my concern is, if we are going to reuse the data warehouse (with other customers too) then I think depending on the way they classify the fields the data warehouse model will not be able to adjust and further customization would require. 

Do let me know whether there is any competent mechanism to overcome this design issue.

Following is an example of the way the products are classified in the source database (this applies to most of the other master data classifications too),

-----------------------------------------------------------------------
Product Code	MasterClassification	MasterClassificationValue
-----------------------------------------------------------------------
AAA		Brand			AA
AAA		Category		A
-----------------------------------------------------------------------

Same set of data pivoted:

---------------------------------------------
ProductCode	Brand		Category
---------------------------------------------
AAA		AA		A
---------------------------------------------

Thanks in advance.
",3
6124713,05/25/2011 12:49:28,186,08/03/2008 06:30:23,568,25,Why is database access (MS SQL) slower on Windows 7?,"We use MS SQL Server 2000 to store results from our test equipment. We have installed our test software on Windows XP machines and do not have any problems with the time it takes to query from and write to the database.

When we recently installed a Windows 7 machine the database access appears to be taking 20 to 100 times as long. We connect to the SQL server using a COM interface passing a connection string that holds the server name, login ID and default database:

    Provider=SQLOLEDB.1;
    Persist Security Info=False;
    User ID={Login name};
    Initial Catalog={Database name};
    Data Source={Server name}

I have tried using a .net database interface but this does not provide any significant improvement in speed.

Is SQL Server database access from Windows 7 just much slower that Windows XP or is there any way to increase the performance of our code?",sql-server,windows-7,,,,,open,0,156,10,"Why is database access (MS SQL) slower on Windows 7? We use MS SQL Server 2000 to store results from our test equipment. We have installed our test software on Windows XP machines and do not have any problems with the time it takes to query from and write to the database.

When we recently installed a Windows 7 machine the database access appears to be taking 20 to 100 times as long. We connect to the SQL server using a COM interface passing a connection string that holds the server name, login ID and default database:

    Provider=SQLOLEDB.1;
    Persist Security Info=False;
    User ID={Login name};
    Initial Catalog={Database name};
    Data Source={Server name}

I have tried using a .net database interface but this does not provide any significant improvement in speed.

Is SQL Server database access from Windows 7 just much slower that Windows XP or is there any way to increase the performance of our code?",2
5074582,02/22/2011 05:58:41,627792,02/22/2011 05:58:41,1,0,mssql backup to external drive,"im running server 2003 and mssql. until recently, ive been able to backup to mapped drives or external hard drives. now, when i go to run backups, the only available drive is the local drive. ive gone through and registered the services with the proper domain privileged accounts and still the drives are a no show.

thoughts?",sql-server,backups,,,,10/01/2011 16:32:38,off topic,1,56,5,"mssql backup to external drive im running server 2003 and mssql. until recently, ive been able to backup to mapped drives or external hard drives. now, when i go to run backups, the only available drive is the local drive. ive gone through and registered the services with the proper domain privileged accounts and still the drives are a no show.

thoughts?",2
11329607,07/04/2012 12:57:14,683741,03/30/2011 10:28:43,321,15,Large SQL server advice,"Dealing with a quite large SQL Server database and encountering a few problems.  

The database is quite new and I've been importing data into the tables and it's making the whole server go quite slow.  The db is now 15GB and in 1 table for example it has just 4 columns, but 122 million rows and takes up 3.5GB.  Another table has about 35 columns with 3 million rows and takes up about 1.5GB.

Whenever I open one of the big tables, or start using it with my MVC3 application, it nearly cripples the server the the memory usage hits max and it starts running really slowly.  (Server spec: Pentium dual core E6300 2.8GHz, with 2GB ram, windows 2008, SQL Server 2005)

This is really the first dealings I've had with this amount of data so have been adding indexes to try and speed things up but once the memory hits the max level, I've had to restart the server in order for it to work at normal speed.

Anyway, I don't feel that 15GB is that big - surely 2GB ram could handle it?  I've not even finished adding the first round of data so it's going to get considerably bigger.

Does anyone have any advice for how it could be set up better and be more efficient.  All PK's and FK's have been set up and I've added indexes to the large table to see if that helps any but it's eventually started going slowly again. BTW, in the database properties, it says 'Space Available - 1596.96MB'  How do you increase that figure?

Thanks very much",sql-server,,,,,07/04/2012 20:04:18,off topic,1,270,4,"Large SQL server advice Dealing with a quite large SQL Server database and encountering a few problems.  

The database is quite new and I've been importing data into the tables and it's making the whole server go quite slow.  The db is now 15GB and in 1 table for example it has just 4 columns, but 122 million rows and takes up 3.5GB.  Another table has about 35 columns with 3 million rows and takes up about 1.5GB.

Whenever I open one of the big tables, or start using it with my MVC3 application, it nearly cripples the server the the memory usage hits max and it starts running really slowly.  (Server spec: Pentium dual core E6300 2.8GHz, with 2GB ram, windows 2008, SQL Server 2005)

This is really the first dealings I've had with this amount of data so have been adding indexes to try and speed things up but once the memory hits the max level, I've had to restart the server in order for it to work at normal speed.

Anyway, I don't feel that 15GB is that big - surely 2GB ram could handle it?  I've not even finished adding the first round of data so it's going to get considerably bigger.

Does anyone have any advice for how it could be set up better and be more efficient.  All PK's and FK's have been set up and I've added indexes to the large table to see if that helps any but it's eventually started going slowly again. BTW, in the database properties, it says 'Space Available - 1596.96MB'  How do you increase that figure?

Thanks very much",1
11346451,07/05/2012 14:29:21,704136,04/12/2011 13:11:18,22,0,How SqlDatareader object is called in SQL-Server,"Pls friends help me ..........

The mechanism behind the class SqlDatareader how the object is equated to  command.ExecuteReader();


SqlDataReader reader = command.ExecuteReader();

How this works, It may be a silly question, but pls help me",sql-server,,,,,07/05/2012 14:42:31,not a real question,1,33,7,"How SqlDatareader object is called in SQL-Server Pls friends help me ..........

The mechanism behind the class SqlDatareader how the object is equated to  command.ExecuteReader();


SqlDataReader reader = command.ExecuteReader();

How this works, It may be a silly question, but pls help me",1
1924624,12/17/2009 21:11:06,226897,12/08/2009 05:32:39,58,1,Improving performance on a view with a LOT of joins...,"I have a view that uses 11 outer joins and two inner joins to create the data.  This results in over 8 million rows.  When I do a count (*) on the table it takes about 5 minutes to run.  I'm at a loss as to how to improve the performance of this table.  Does anyone have any suggestions on where to begin?  There appear to be indexes on all of the columns that are joining (though some are composit, not sure if that makes a difference...)

Any help appreciated.",sql-server,join,left-join,performance,,07/16/2012 20:26:47,not constructive,1,94,10,"Improving performance on a view with a LOT of joins... I have a view that uses 11 outer joins and two inner joins to create the data.  This results in over 8 million rows.  When I do a count (*) on the table it takes about 5 minutes to run.  I'm at a loss as to how to improve the performance of this table.  Does anyone have any suggestions on where to begin?  There appear to be indexes on all of the columns that are joining (though some are composit, not sure if that makes a difference...)

Any help appreciated.",4
5409429,03/23/2011 17:45:24,667278,03/19/2011 12:06:40,12,0,sql stored procedures,"I have table called product review with columns productreviewid , productid ,shopperid, review , rating  I want to create the stored procedure for productreviewfetch  with input parameter productreview ID

Can ANy one pls help me out ",sql-server,,,,,03/23/2011 20:19:59,too localized,1,38,3,"sql stored procedures I have table called product review with columns productreviewid , productid ,shopperid, review , rating  I want to create the stored procedure for productreviewfetch  with input parameter productreview ID

Can ANy one pls help me out ",1
537145,02/11/2009 14:52:24,30099,10/21/2008 20:03:54,417,14,Is it a bad idea to use GUID's as primary key's in MS SQL,We have a system that uses UniqueIdentifier as the primary key of each of the tables. It has been brought to our attention that this is a bad idea. I have seen similar post on the subject but I am interested in any MS SQL performance and other potential problems I may encounter due to this decision.  ,sql-server,ms-sql,database,microsoft,,,open,0,59,14,Is it a bad idea to use GUID's as primary key's in MS SQL We have a system that uses UniqueIdentifier as the primary key of each of the tables. It has been brought to our attention that this is a bad idea. I have seen similar post on the subject but I am interested in any MS SQL performance and other potential problems I may encounter due to this decision.  ,4
10558998,05/11/2012 21:39:27,477526,10/15/2010 22:01:36,11,0,"Will this UPDATE update only the records I want, or all records?","This is a very simple question for you SQL folks out there.

I have a temp table (TMP_VALIDATION_DATA) in which I've stored the old and new values of some fields I wish to update in a production table (PROVIDER_SERVICE), plus the uuids of the records that need to be updated.

Is this Update statement going to update JUST the ProviderService recs whose uuids are in TMP_VALIDATION_TABLE?  Or will it update every record in ProviderService to the same value?:

    update PROVIDER_SERVICE
    set END_DATE = (
      select NewPvSvcEndDate 
      from TMP_VALIDATION_DATA T
      where T.PROVIDER_SERVICE_UUID = PROVIDER_SERVICE.PROVIDER_SERVICE_UUID 
    )
     
",sql-server,,,,,,open,0,124,12,"Will this UPDATE update only the records I want, or all records? This is a very simple question for you SQL folks out there.

I have a temp table (TMP_VALIDATION_DATA) in which I've stored the old and new values of some fields I wish to update in a production table (PROVIDER_SERVICE), plus the uuids of the records that need to be updated.

Is this Update statement going to update JUST the ProviderService recs whose uuids are in TMP_VALIDATION_TABLE?  Or will it update every record in ProviderService to the same value?:

    update PROVIDER_SERVICE
    set END_DATE = (
      select NewPvSvcEndDate 
      from TMP_VALIDATION_DATA T
      where T.PROVIDER_SERVICE_UUID = PROVIDER_SERVICE.PROVIDER_SERVICE_UUID 
    )
     
",1
1766836,11/19/2009 21:53:02,17324,09/18/2008 06:45:00,357,13,Method of simulating views on a SQL Server with read-only access?,"I'm trying to do quite a lot of querying against a Microsoft SQL Server that I only have read only access to.  My queries are needing to work with the data in very different structure from how the DB architecture is.  Since I only have read access, I can't create views, so I'm looking for a solution.
What I'm currently doing is using complex queries to return the results as I need them, but this is 4-5 table joins with subqueries.  It is rediculously slow and resource intensive.
I can see two solutions, but would love to hear about anything I might have missed:

 - Use some sort of ""proxy"" that caches the data, and creates views around it.  This would need some sort of method to determine the dirtiness of the data. (is there something like this?)
 - run my own SQL server, and mirror the data from the source SQL server every X minutes, and then load views on my SQL server.

Any other ideas?  or recommendations on these ideas?

Thanks!",sql-server,sql,c#,database,microsoft,,open,0,174,11,"Method of simulating views on a SQL Server with read-only access? I'm trying to do quite a lot of querying against a Microsoft SQL Server that I only have read only access to.  My queries are needing to work with the data in very different structure from how the DB architecture is.  Since I only have read access, I can't create views, so I'm looking for a solution.
What I'm currently doing is using complex queries to return the results as I need them, but this is 4-5 table joins with subqueries.  It is rediculously slow and resource intensive.
I can see two solutions, but would love to hear about anything I might have missed:

 - Use some sort of ""proxy"" that caches the data, and creates views around it.  This would need some sort of method to determine the dirtiness of the data. (is there something like this?)
 - run my own SQL server, and mirror the data from the source SQL server every X minutes, and then load views on my SQL server.

Any other ideas?  or recommendations on these ideas?

Thanks!",5
5097219,02/23/2011 21:15:27,5446,09/09/2008 16:05:23,648,21,Finding T-SQL code with literal strings for localization project,"Does anyone have experience with tools/techniques that would help identify T-SQL code with literal strings (that may require language translation for a localization project)?  Would love to leverage another's experience that may save me time developing my own tool or - god forbid - doing it manually.
",sql-server,tsql,localization,,,,open,0,48,9,"Finding T-SQL code with literal strings for localization project Does anyone have experience with tools/techniques that would help identify T-SQL code with literal strings (that may require language translation for a localization project)?  Would love to leverage another's experience that may save me time developing my own tool or - god forbid - doing it manually.
",3
3930983,10/14/2010 07:27:30,149206,08/02/2009 06:03:31,2481,157,MySQL's concat_ws function equivalent in MS SQL Server ?,"I was using MySQL's [concat_ws][1] function to get data from MySQL database and it was working perfectly. I discover this query through this [SO Question][2]. Now I have same case but this time database is **MS SQL Server**.


**Questioning Again for MS SQL Server:**

I have a table like this:

    id | roll_no | name
    ---------------------
     1 |   111   | Naveed
     2 |   222   | Adil
     3 |   333   | Ali 

  


**If I have data like this:**

`$fields = array( ""id"" , ""roll_no"" )` and  `$values = array( ""1,111"", ""2,222"" );`

It means I have to write a sql query to get records from table where (id != 1 and roll_no != 111) and (id != 2 and roll_no != 222). It means 3rd record will be fetched.

**If I have data like this:**

`$fields = array( ""id"" )` and  `$values = array( ""2"", ""3"" );`

It means I have to write a sql query to get records from table where (id != 2) and (id != 3). It means 1st record will be fetched.


**How to write a general single query to get data from table using above two data arrays ?** 

Thanks
 


  [1]: http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws
  [2]: http://stackoverflow.com/questions/3607956/a-general-single-sql-query",sql-server,query,,,,,open,0,227,9,"MySQL's concat_ws function equivalent in MS SQL Server ? I was using MySQL's [concat_ws][1] function to get data from MySQL database and it was working perfectly. I discover this query through this [SO Question][2]. Now I have same case but this time database is **MS SQL Server**.


**Questioning Again for MS SQL Server:**

I have a table like this:

    id | roll_no | name
    ---------------------
     1 |   111   | Naveed
     2 |   222   | Adil
     3 |   333   | Ali 

  


**If I have data like this:**

`$fields = array( ""id"" , ""roll_no"" )` and  `$values = array( ""1,111"", ""2,222"" );`

It means I have to write a sql query to get records from table where (id != 1 and roll_no != 111) and (id != 2 and roll_no != 222). It means 3rd record will be fetched.

**If I have data like this:**

`$fields = array( ""id"" )` and  `$values = array( ""2"", ""3"" );`

It means I have to write a sql query to get records from table where (id != 2) and (id != 3). It means 1st record will be fetched.


**How to write a general single query to get data from table using above two data arrays ?** 

Thanks
 


  [1]: http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws
  [2]: http://stackoverflow.com/questions/3607956/a-general-single-sql-query",2
10386844,04/30/2012 16:10:48,1366194,04/30/2012 15:57:55,1,0,Recommend a book - Visual Studio 2010 SQL Query With Parameters,"Just relearning Visual Studio 2010 & C#, started by rewriting a phone directory application which uses last name and optional first name and location to search a SQL Server 2008 database.  I was stumped by how to build the search query for a gridview control with a sqldatasource, but after searching here I followed suggestions to use parameters with a default value of % for the optional columns in the WHERE when building the SELECT query.

Tried that and it worked, but I don't understand how!

I've just finished reading Wrox' Beginning ASP.NET 4 in C# and VB but it didn't cover the above scenario so now I'm looking for something that does.  Can anyone suggest what I should read next, is the above more a SQL question so I need to look into SQL-Server/T-SQL, or is it a more advanced VS 2010 question?

Thanks.",sql-server,visual-studio-2010,,,,05/04/2012 09:54:46,off topic,1,144,11,"Recommend a book - Visual Studio 2010 SQL Query With Parameters Just relearning Visual Studio 2010 & C#, started by rewriting a phone directory application which uses last name and optional first name and location to search a SQL Server 2008 database.  I was stumped by how to build the search query for a gridview control with a sqldatasource, but after searching here I followed suggestions to use parameters with a default value of % for the optional columns in the WHERE when building the SELECT query.

Tried that and it worked, but I don't understand how!

I've just finished reading Wrox' Beginning ASP.NET 4 in C# and VB but it didn't cover the above scenario so now I'm looking for something that does.  Can anyone suggest what I should read next, is the above more a SQL question so I need to look into SQL-Server/T-SQL, or is it a more advanced VS 2010 question?

Thanks.",2
1561479,10/13/2009 16:45:29,50356,12/31/2008 00:27:18,1007,46,SQL Double-Outer Join??,"I have two tables A and B...   A and B can be joined by a common column.  A and B will have some rows that match on the join column.  But A has some rows that B doesn't have, and B has some rows that A doesn't have.  

A LEFT OUTER JOIN from A to B will give all rows in A, filling in NULLS for the B columns that couldn't be matched.  A RIGHT OUTER JOIN gives all rows in B, filling in NULLS for the A columns that couldn't be matched.

I would like to receive ALL rows from both A and B, while returning NULL for the A columns on rows that are only in B, and NULL for the B columns that are only in A.

I'm know I can do this with UNION along with 1 INNER + 1 LEFT + 1 RIGHT, but is there a single SELECT query that can achieve this?",sql-server,tsql,,,,,open,0,163,3,"SQL Double-Outer Join?? I have two tables A and B...   A and B can be joined by a common column.  A and B will have some rows that match on the join column.  But A has some rows that B doesn't have, and B has some rows that A doesn't have.  

A LEFT OUTER JOIN from A to B will give all rows in A, filling in NULLS for the B columns that couldn't be matched.  A RIGHT OUTER JOIN gives all rows in B, filling in NULLS for the A columns that couldn't be matched.

I would like to receive ALL rows from both A and B, while returning NULL for the A columns on rows that are only in B, and NULL for the B columns that are only in A.

I'm know I can do this with UNION along with 1 INNER + 1 LEFT + 1 RIGHT, but is there a single SELECT query that can achieve this?",2
11195037,06/25/2012 18:23:56,1342632,04/18/2012 22:33:00,519,51,Unable to restore from Snapshot,"I've successfully created a snapshot of database SCPT_Pandora named SCPT_Pandora_snap. When I try to restore SCPT_Pandora from this snapshot, I get an error (""'DATABASE_SHAPSHOT' is not a recognized Device Type option""). I've tried this on two servers (2005 & 2008 Enterprise editions) and received the same error on both.  Here's the code:

    IF EXISTS ( SELECT  name
            FROM    sys.databases
            WHERE   name = N'SCPT_Pandora_snap' ) 
    DROP DATABASE SCPT_Pandora_snap
    GO

    CREATE DATABASE SCPT_Pandora_snap ON

    (

        NAME = SCPT_Pandora,

        FILENAME = 'D:\SQL2008_data\SCPT_Pandora_snap.ss'

    ) AS SNAPSHOT OF SCPT_Pandora

    GO

    RESTORE DATABASE SCPT_Pandora FROM DATABASE_SHAPSHOT = 'SCPT_Pandora_snap';
    GO

Thanks!",sql-server,sql-server-2008,sql-server-2005,,,06/26/2012 12:29:29,too localized,1,164,5,"Unable to restore from Snapshot I've successfully created a snapshot of database SCPT_Pandora named SCPT_Pandora_snap. When I try to restore SCPT_Pandora from this snapshot, I get an error (""'DATABASE_SHAPSHOT' is not a recognized Device Type option""). I've tried this on two servers (2005 & 2008 Enterprise editions) and received the same error on both.  Here's the code:

    IF EXISTS ( SELECT  name
            FROM    sys.databases
            WHERE   name = N'SCPT_Pandora_snap' ) 
    DROP DATABASE SCPT_Pandora_snap
    GO

    CREATE DATABASE SCPT_Pandora_snap ON

    (

        NAME = SCPT_Pandora,

        FILENAME = 'D:\SQL2008_data\SCPT_Pandora_snap.ss'

    ) AS SNAPSHOT OF SCPT_Pandora

    GO

    RESTORE DATABASE SCPT_Pandora FROM DATABASE_SHAPSHOT = 'SCPT_Pandora_snap';
    GO

Thanks!",3
11737152,07/31/2012 09:35:02,1117570,12/27/2011 11:48:08,1,0,SQL SERVER 2008 Enterprise Edition Trial & full differenceses?,"we need to buy sql server 2008 enterprise edition but
it will take 1 month .
I install to server trial version because we need now.
 but i have 2 question

1- Is there any limitations trial betwwen full version
2- When i have licence key .I Will use directly and what i need else ? 
can we use directly full version ? Anything we need to do ? 


Thank you so much.",sql-server,,,,,07/31/2012 15:49:48,not a real question,1,69,9,"SQL SERVER 2008 Enterprise Edition Trial & full differenceses? we need to buy sql server 2008 enterprise edition but
it will take 1 month .
I install to server trial version because we need now.
 but i have 2 question

1- Is there any limitations trial betwwen full version
2- When i have licence key .I Will use directly and what i need else ? 
can we use directly full version ? Anything we need to do ? 


Thank you so much.",1
3695482,09/12/2010 15:53:45,182544,10/01/2009 14:51:15,263,16,SQL Server 2008 Stored Proc Performance where Column = NULL,"When I execute a certain stored procedure (which selects from a non-indexed view) with a non-null parameter, it's lightning fast at about 10ms.  When I execute it with a NULL parameter (resulting in a FKColumn = NULL query) it's much slower at about 1200ms.  

I've executed it with the actual execution plan and it appears the most costly portion of the query is a clustered index scan with the predicate IS NULL on the fk column in question - 59%!  The index covering this column is (AFAIK) good.

So what can I do to improve the performance here?  Change the fk column to NOT NULL and fill the nulls with a default value?",sql-server,,,,,,open,0,116,10,"SQL Server 2008 Stored Proc Performance where Column = NULL When I execute a certain stored procedure (which selects from a non-indexed view) with a non-null parameter, it's lightning fast at about 10ms.  When I execute it with a NULL parameter (resulting in a FKColumn = NULL query) it's much slower at about 1200ms.  

I've executed it with the actual execution plan and it appears the most costly portion of the query is a clustered index scan with the predicate IS NULL on the fk column in question - 59%!  The index covering this column is (AFAIK) good.

So what can I do to improve the performance here?  Change the fk column to NOT NULL and fill the nulls with a default value?",1
8266251,11/25/2011 08:11:30,423047,08/17/2010 15:48:45,9,0,Deadlock in Sqlserver,"I am getting this Deadlock exception when I am running the query in my application.

Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Transaction (Process ID 66) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction.

bphx.sdf.errLogger](ERROR): could not execute native bulk manipulation query DELETE FROM EXTRFILE 
     WHERE SUBSTRING(THEDATA,1,16) = :thedatastr
org.hibernate.exception.LockAcquisitionException: could not execute native bulk manipulation query",sql-server,,,,,11/25/2011 09:24:36,not a real question,1,66,3,"Deadlock in Sqlserver I am getting this Deadlock exception when I am running the query in my application.

Caused by: com.microsoft.sqlserver.jdbc.SQLServerException: Transaction (Process ID 66) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction.

bphx.sdf.errLogger](ERROR): could not execute native bulk manipulation query DELETE FROM EXTRFILE 
     WHERE SUBSTRING(THEDATA,1,16) = :thedatastr
org.hibernate.exception.LockAcquisitionException: could not execute native bulk manipulation query",1
303417,11/19/2008 21:25:21,3113,08/26/2008 17:56:39,43,6,What are the best practices in writing a sql stored procedure,"I found that SQL stored procedures are very interesting and useful. I have written stored procedures but i want to write well crafted, good performance tuned and concise SPs for any sort of requirement and also would love to learn about any tricks or good practices for stored procedures. How do i move from the beginner to the advanced stage in writing stored procedures?",sql-server,stored-procedures,,,,,open,0,64,11,"What are the best practices in writing a sql stored procedure I found that SQL stored procedures are very interesting and useful. I have written stored procedures but i want to write well crafted, good performance tuned and concise SPs for any sort of requirement and also would love to learn about any tricks or good practices for stored procedures. How do i move from the beginner to the advanced stage in writing stored procedures?",2
4299963,11/29/2010 00:22:09,400861,08/05/2009 20:06:53,2266,61,Proper structure of asp.net website and database in visual studio,"My main problem is where does database go?

The project will be on SVN and is developed using asp.net mvc repository pattern. Where do I put the sql server database (mdf file)? If I put it in app_data, then my other team mates can check out the source and database and run it with the database being deployed in the vs instance.

The problem with this method are: 

  1. I cannot use SQL Management Studio with this database.
  2. Most web hosts require me to deploy the database using their UI or SQL Management studio. Putting it in App Data will make no sense.
  3. Connection String has to be edited each time I'm moving from testing locally to testing on the web host.

If I create the database using SQL Management studio, my problems are:

  1. How do I keep this consistent with the source control (team mates have to re-script the db if the schema changes).
  2. Connection string again. (I'd like to automatically use the string when on production server).

Is there a solution to all my problems above? Maybe some form of patterns of tools that I am missing?",sql-server,asp.net-mvc,,,,,open,0,195,10,"Proper structure of asp.net website and database in visual studio My main problem is where does database go?

The project will be on SVN and is developed using asp.net mvc repository pattern. Where do I put the sql server database (mdf file)? If I put it in app_data, then my other team mates can check out the source and database and run it with the database being deployed in the vs instance.

The problem with this method are: 

  1. I cannot use SQL Management Studio with this database.
  2. Most web hosts require me to deploy the database using their UI or SQL Management studio. Putting it in App Data will make no sense.
  3. Connection String has to be edited each time I'm moving from testing locally to testing on the web host.

If I create the database using SQL Management studio, my problems are:

  1. How do I keep this consistent with the source control (team mates have to re-script the db if the schema changes).
  2. Connection string again. (I'd like to automatically use the string when on production server).

Is there a solution to all my problems above? Maybe some form of patterns of tools that I am missing?",2
3499948,08/17/2010 06:47:38,77004,11/22/2008 10:24:45,545,21,Is data copied when selecting into a temp table?,"I am wondering, when selecting rows and inserting them into a temp table, is the data actually copied or just referenced?

For example:

    SELECT * INTO #Temp FROM SomeTable

If the table is very large, is this going to be a costly operation?

From my tests it seems to execute about as fast as a simple SELECT, but I'd like a better insight about how it actually works.

Cheers.",sql-server,,,,,,open,0,68,9,"Is data copied when selecting into a temp table? I am wondering, when selecting rows and inserting them into a temp table, is the data actually copied or just referenced?

For example:

    SELECT * INTO #Temp FROM SomeTable

If the table is very large, is this going to be a costly operation?

From my tests it seems to execute about as fast as a simple SELECT, but I'd like a better insight about how it actually works.

Cheers.",1
801732,04/29/2009 10:15:52,76037,03/10/2009 08:33:53,626,48,Migrating DB: Keep relations constraints?,"At the risk of being called a fool, I am wondering what your thoughts are on maintaining relationship constraints within a MS SQL DB.

I am migrating a system into a .NET environment from ASP. This brings with it business objects and other tiered-coding techniques, which work to abstract the database from the user/API. The new application has a definite API above an Entity Framework DAL.

The application DB in the old database is large and the purpose of some of the tables will be changing to start containing binary data, in the form of files, etc. I'm keen to split these off into separate DBs to ease management at the client sites where disk space is at a premium.

Is there any value in retaining relationship constraints between tables?

Assumptions:

- Code is tested
- Where relations are important, execution is performed under a Transaction
- Access to the DB is via the API only, other access by third parties is unsupported.

Reasons to keep constraints:

- Enforces the data structure
- JOINs are faster?
- Query Plan assistance?

Reasons to remove constraints in new .NET version:

- One can assume that the API/BIZ logic would manage relations such as Parent/Child. 
- Reduces opportunity to hive off sections of the DB into other catalogs (the system is built using a Plug-in architecture, most tables may operate in isolation)
- Am I correct in believing that SQL has to do additional checks during INSERT on constraints, which may be unnecassary when an API above the DB is managing this?

I throw my question upon the community anyway in case I have missed something dumb or if this is just a nightmare waiting to happen ...

Many thanks,

Nathan",sql-server,constraints,,,,,open,0,271,5,"Migrating DB: Keep relations constraints? At the risk of being called a fool, I am wondering what your thoughts are on maintaining relationship constraints within a MS SQL DB.

I am migrating a system into a .NET environment from ASP. This brings with it business objects and other tiered-coding techniques, which work to abstract the database from the user/API. The new application has a definite API above an Entity Framework DAL.

The application DB in the old database is large and the purpose of some of the tables will be changing to start containing binary data, in the form of files, etc. I'm keen to split these off into separate DBs to ease management at the client sites where disk space is at a premium.

Is there any value in retaining relationship constraints between tables?

Assumptions:

- Code is tested
- Where relations are important, execution is performed under a Transaction
- Access to the DB is via the API only, other access by third parties is unsupported.

Reasons to keep constraints:

- Enforces the data structure
- JOINs are faster?
- Query Plan assistance?

Reasons to remove constraints in new .NET version:

- One can assume that the API/BIZ logic would manage relations such as Parent/Child. 
- Reduces opportunity to hive off sections of the DB into other catalogs (the system is built using a Plug-in architecture, most tables may operate in isolation)
- Am I correct in believing that SQL has to do additional checks during INSERT on constraints, which may be unnecassary when an API above the DB is managing this?

I throw my question upon the community anyway in case I have missed something dumb or if this is just a nightmare waiting to happen ...

Many thanks,

Nathan",2
8989699,01/24/2012 15:46:40,108977,05/18/2009 19:37:21,6019,364,Anybody using RAM drives to speed up unit testing databases?,"To unit test my stored procedures, I am running SQL Server 2008 R2 Dev Edition on my Windows 7 x64 workstation. 
I am creating a sandbox database off scripts; it is currently less than 40 MB. To speed up the fixture setup process, I was thinking of creating a RAM drive.

I hope someone did that before. Are there any gotchas/problems with this approach? How are you setting up your RAM drive?",sql-server,sql-server-2008,unit-testing,windows-7-x64,ramdrive,01/24/2012 19:18:06,off topic,1,71,10,"Anybody using RAM drives to speed up unit testing databases? To unit test my stored procedures, I am running SQL Server 2008 R2 Dev Edition on my Windows 7 x64 workstation. 
I am creating a sandbox database off scripts; it is currently less than 40 MB. To speed up the fixture setup process, I was thinking of creating a RAM drive.

I hope someone did that before. Are there any gotchas/problems with this approach? How are you setting up your RAM drive?",5
3598358,08/30/2010 06:34:13,434683,08/30/2010 06:34:13,1,0,Stored Procedure,"-I want to transfer data in a temporary table to EIM tables , for that i have to write a stored procedure",sql-server,,,,,08/30/2010 11:06:40,not a real question,1,22,2,"Stored Procedure -I want to transfer data in a temporary table to EIM tables , for that i have to write a stored procedure",1
2733634,04/28/2010 22:47:37,16050,09/17/2008 14:20:56,1945,21,"Should I use ""User Defined Functions"" in SQL server, or C#?  ","I have a fairly complicated mathematical function that I've been advised should be implemented as a User Defined Function in SQL Server so that it can be used efficiently from within a SQL query.  

The problem is that it **must** be very efficient as it may be executed thousands of times per second, and I subsequently heard that UDFs are very inefficient.

Someone suggested that I could implement the function in C# instead, and that this would be much more efficient.

What should I do?",sql-server,c#,.net,,,,open,0,84,13,"Should I use ""User Defined Functions"" in SQL server, or C#?   I have a fairly complicated mathematical function that I've been advised should be implemented as a User Defined Function in SQL Server so that it can be used efficiently from within a SQL query.  

The problem is that it **must** be very efficient as it may be executed thousands of times per second, and I subsequently heard that UDFs are very inefficient.

Someone suggested that I could implement the function in C# instead, and that this would be much more efficient.

What should I do?",3
7146233,08/22/2011 10:39:10,743182,05/07/2011 16:02:35,11,0,how to get confilict between records,"I have this table
ID    Start       End
---------------------
1      03:00     05:20
2      04:10     06:21
3      06:30     07:50
4      07:30     08:00
5      08:30     15:00

How to get records that they have confilict?
Thanks",sql-server,,,,,08/22/2011 11:02:03,not a real question,1,77,6,"how to get confilict between records I have this table
ID    Start       End
---------------------
1      03:00     05:20
2      04:10     06:21
3      06:30     07:50
4      07:30     08:00
5      08:30     15:00

How to get records that they have confilict?
Thanks",1
11052078,06/15/2012 13:58:49,1032218,11/06/2011 13:17:48,183,0,SQL Server factors that can contribute to high CPU usage,"
I am trying to figure out or enlist factors that contribute to persistent high CPU utilization related to SQL Server

Here are few that I came up with

a) Compilation or Frequent Recompilation of stored procs or queries

b) Poor performing queries that perform huge sort or ended up using Hash Join 

c) Parallelism (multiple threads are span so it can keep CPU busy)

d) Looping construct in T-SQL for e.g. WHILE Loop or use of CURSOR

e) Missing or inappropriate indexes that leads to table scan

What are other SQL server operations can lead for a high CPU use? 

",sql-server,sql-server-2008,sql-server-2005,,,06/17/2012 05:08:16,not constructive,1,95,10,"SQL Server factors that can contribute to high CPU usage 
I am trying to figure out or enlist factors that contribute to persistent high CPU utilization related to SQL Server

Here are few that I came up with

a) Compilation or Frequent Recompilation of stored procs or queries

b) Poor performing queries that perform huge sort or ended up using Hash Join 

c) Parallelism (multiple threads are span so it can keep CPU busy)

d) Looping construct in T-SQL for e.g. WHILE Loop or use of CURSOR

e) Missing or inappropriate indexes that leads to table scan

What are other SQL server operations can lead for a high CPU use? 

",3
9489705,02/28/2012 21:06:40,761713,05/19/2011 20:03:32,11,2,Missing BEGIN and END?,"I am pretty sure what is going on but wanted to get some ideas from my fellow SQL Server Travelers (actually it is fairly obvious what is going on but I think makes for an interesting discussion).

Riddle me this Batman... what is up with this?

    CREATE PROCEDURE ToBeDropped
    AS
    BEGIN
    PRINT 'Drop me!';
    END
    DROP PROCEDURE ToBeDropped;

What happens? My first thought was the procedure gets created then immediately dropped. Wrongo! And you probably thought the same unless you already knew this about issue from before... admit it!

In SSMS hit Ctrl-T to switch Query Results to Text. Then run the following (or you could script the new procedure ToBeDropped):

    SELECT m.[definition]
    FROM sys.sql_modules AS m INNER JOIN sys.objects AS obj
    ON m.object_id = obj.object_id
    WHERE obj.name = 'ToBeDropped';

Next run the procedure:

    EXECUTE ToBeDropped;

The rerun the above sys.sql_modules query or attempt to script the object. You can't because it no longer exists.

Hmmm... What's going on here? Clearly there is an implicit BEGIN and END to the while procedure, similar to the following:

    CREATE PROCEDURE ToBeDropped
    AS
    BEGIN
    BEGIN
    PRINT 'Drop me!';
    END
    DROP PROCEDURE ToBeDropped;
    END;

Which when formatted better looks like the following:

    CREATE PROCEDURE ToBeDropped
    AS
    BEGIN
        BEGIN
            PRINT 'Drop me!';
        END

        DROP PROCEDURE ToBeDropped;
    END ;

I am not a big fan of implicit behavior. I prefer being explicit. TSQL is moving in the direction of becoming more ""real"" - see the semicolon and all the CLR functionality now available or potentially available in TSQL. I would like to see a CREATE PROCEDURE body be required to have at least 1 BEGIN and END pair - heck make { be an alias/synonym for BEGIN and } an alias/synonym for END - and we would be one step closer to TSQL turning into C#.

Thoughts? Opinions? Thanks!",sql-server,,,,,02/29/2012 21:30:54,not constructive,1,395,4,"Missing BEGIN and END? I am pretty sure what is going on but wanted to get some ideas from my fellow SQL Server Travelers (actually it is fairly obvious what is going on but I think makes for an interesting discussion).

Riddle me this Batman... what is up with this?

    CREATE PROCEDURE ToBeDropped
    AS
    BEGIN
    PRINT 'Drop me!';
    END
    DROP PROCEDURE ToBeDropped;

What happens? My first thought was the procedure gets created then immediately dropped. Wrongo! And you probably thought the same unless you already knew this about issue from before... admit it!

In SSMS hit Ctrl-T to switch Query Results to Text. Then run the following (or you could script the new procedure ToBeDropped):

    SELECT m.[definition]
    FROM sys.sql_modules AS m INNER JOIN sys.objects AS obj
    ON m.object_id = obj.object_id
    WHERE obj.name = 'ToBeDropped';

Next run the procedure:

    EXECUTE ToBeDropped;

The rerun the above sys.sql_modules query or attempt to script the object. You can't because it no longer exists.

Hmmm... What's going on here? Clearly there is an implicit BEGIN and END to the while procedure, similar to the following:

    CREATE PROCEDURE ToBeDropped
    AS
    BEGIN
    BEGIN
    PRINT 'Drop me!';
    END
    DROP PROCEDURE ToBeDropped;
    END;

Which when formatted better looks like the following:

    CREATE PROCEDURE ToBeDropped
    AS
    BEGIN
        BEGIN
            PRINT 'Drop me!';
        END

        DROP PROCEDURE ToBeDropped;
    END ;

I am not a big fan of implicit behavior. I prefer being explicit. TSQL is moving in the direction of becoming more ""real"" - see the semicolon and all the CLR functionality now available or potentially available in TSQL. I would like to see a CREATE PROCEDURE body be required to have at least 1 BEGIN and END pair - heck make { be an alias/synonym for BEGIN and } an alias/synonym for END - and we would be one step closer to TSQL turning into C#.

Thoughts? Opinions? Thanks!",1
8663072,12/29/2011 01:18:58,103264,05/08/2009 01:16:16,2394,4,"Database design for Sharing ""Post""","I want user to view by recent Post in the order they were posted, but only if the user that created the post gave the user permission to view them. (Simular to facebook wall post, google+ etc).

Would this database design of ""Post_view""  be correct?

    USER
    Id
    Name
    ...
    

    POST
    Id
    Message
    CreatedByUserId
    Created_Time
    LastComment_Time 
    ...
    
    POST_COMMENT
    Id
    PostId
    Message
    CreatedByUserId
    Created_Time
    

    POST_VIEW
    Id
    PostId
    UserId
    ...",sql-server,facebook,database-design,social-networking,orcale,12/30/2011 07:00:17,not a real question,1,146,5,"Database design for Sharing ""Post"" I want user to view by recent Post in the order they were posted, but only if the user that created the post gave the user permission to view them. (Simular to facebook wall post, google+ etc).

Would this database design of ""Post_view""  be correct?

    USER
    Id
    Name
    ...
    

    POST
    Id
    Message
    CreatedByUserId
    Created_Time
    LastComment_Time 
    ...
    
    POST_COMMENT
    Id
    PostId
    Message
    CreatedByUserId
    Created_Time
    

    POST_VIEW
    Id
    PostId
    UserId
    ...",5
11025207,06/14/2012 00:22:04,1416345,05/25/2012 01:01:28,4,0,SQL Server - bulk insert column,"I need to insert csv file into sql server db.  The problem is I keep getting a

     Bulk load data conversion error (type mismatch or invalid character for
     the specified codepage)  error. this is repeated 10 times and 
     Msg 7399, Level 16, State 1, Line 1
    The OLE DB provider ""BULK"" for linked server ""(null)"" reported an error.
    The provider did not give any information about the error.
    Cannot fetch a row from OLE DB provider ""BULK"" for linked server ""(null)"".     

The specific column that errors is a bigint,primary key,no null field. I have made sure all 5000 records have a 4 digit number and there are no nulls.  I am tired of fighting this and simply want to insert the date and datavalue fields into this table --CSResult.  The problem is sql server simply errors out and I am thinking it wants values for ALL the fields.
IS there a way to insert data into the columns I want?
Any ideas.

         BULK INSERT [ACCUCHEK_1].[CsSchema].[CsResult] (
         FROM 'c:\june132012.csv'
         WITH
         (
         FIELDTERMINATOR = ',',
         ROWTERMINATOR = '\n'
         )
this is what the data looks like:

        3857,2011-05-19 04:00:00.000,Y,,82,N,N,,4,1,1,10,,1,,535/31706815
        3858,2011-05-19 02:23:00.000,Y,,128,N,N,,4,1,1,10,,1,,535/31706815
",sql-server,bulkinsert,,,,,open,0,285,6,"SQL Server - bulk insert column I need to insert csv file into sql server db.  The problem is I keep getting a

     Bulk load data conversion error (type mismatch or invalid character for
     the specified codepage)  error. this is repeated 10 times and 
     Msg 7399, Level 16, State 1, Line 1
    The OLE DB provider ""BULK"" for linked server ""(null)"" reported an error.
    The provider did not give any information about the error.
    Cannot fetch a row from OLE DB provider ""BULK"" for linked server ""(null)"".     

The specific column that errors is a bigint,primary key,no null field. I have made sure all 5000 records have a 4 digit number and there are no nulls.  I am tired of fighting this and simply want to insert the date and datavalue fields into this table --CSResult.  The problem is sql server simply errors out and I am thinking it wants values for ALL the fields.
IS there a way to insert data into the columns I want?
Any ideas.

         BULK INSERT [ACCUCHEK_1].[CsSchema].[CsResult] (
         FROM 'c:\june132012.csv'
         WITH
         (
         FIELDTERMINATOR = ',',
         ROWTERMINATOR = '\n'
         )
this is what the data looks like:

        3857,2011-05-19 04:00:00.000,Y,,82,N,N,,4,1,1,10,,1,,535/31706815
        3858,2011-05-19 02:23:00.000,Y,,128,N,N,,4,1,1,10,,1,,535/31706815
",2
11750465,07/31/2012 23:23:35,366797,01/23/2010 04:19:59,524,94,How easy is it to learn VBA if you're only familiar with procedural 4GL languages?,"20 years ago, I developed a Pawnshop Management application with Informix-SQL. Most of my users also have Microsoft Office 2003, '07 and '10. My app exports data to a text file which Excel and Word pick up. I would like to convert my ISQL-based app to Access 2010, so that I can have direct integration with Word and Excel via VBA, but I'm not familiar with VBA or object-oriented programming. I've been inside a 20 year ole time-capsule and only know procedural 4GL type programming languages. 

I acquired a book called ""Access 2010 Inside and Out"" from Microsoft Press, but the VBA part boggles my mind, so I need help!

I would like for the Access version of my app to retain, as much as possible, the same functionality and logic as my ISQL-based version in order to minimize the impact of having to retrain my users. Examples: I want to disable ""On-Focus"" on all data entry fields so that users are forced to follow the same tab order used in my ISQL app and not wander around the forms. This is how it works in my text-based forms. 

There are other features not available in the ISQL text-based interface that I would like to provide for my app and need to know if its possible to do in Access. The list of features is too long to describe here, so this would have to be carefullhy analyzed. Is there another forum or site for addressing these issues?

       ",sql-server,excel,vba,ms-access,ms-office,07/31/2012 23:54:05,not constructive,1,254,15,"How easy is it to learn VBA if you're only familiar with procedural 4GL languages? 20 years ago, I developed a Pawnshop Management application with Informix-SQL. Most of my users also have Microsoft Office 2003, '07 and '10. My app exports data to a text file which Excel and Word pick up. I would like to convert my ISQL-based app to Access 2010, so that I can have direct integration with Word and Excel via VBA, but I'm not familiar with VBA or object-oriented programming. I've been inside a 20 year ole time-capsule and only know procedural 4GL type programming languages. 

I acquired a book called ""Access 2010 Inside and Out"" from Microsoft Press, but the VBA part boggles my mind, so I need help!

I would like for the Access version of my app to retain, as much as possible, the same functionality and logic as my ISQL-based version in order to minimize the impact of having to retrain my users. Examples: I want to disable ""On-Focus"" on all data entry fields so that users are forced to follow the same tab order used in my ISQL app and not wander around the forms. This is how it works in my text-based forms. 

There are other features not available in the ISQL text-based interface that I would like to provide for my app and need to know if its possible to do in Access. The list of features is too long to describe here, so this would have to be carefullhy analyzed. Is there another forum or site for addressing these issues?

       ",5
6729668,07/18/2011 07:12:55,849343,07/18/2011 04:18:25,1,0,Legacy databases from Hell,"I'm a VFP developer that has just come of retirement to face a bunch of legacy apps from hell so any help/input would be much appreciated.

It's a total of 14 different business apps running a mix of Access/Mysql but mostly MSSQL databases with one thing in common. The databases are all in horrendous shape.

1. None of the tables have primary keys
2. There are exactly zero foreign keys/constraints
3. No candidate keys
4. No documentation, not even ""unofficial"" ER/Schema/Case diagrams
5. Sloppy field naming, CustomerID (char(10)) in the parent table, CustID (nchar(10)), TraderCode (varchar(10)), etc, in child tables spread across different databases. 
6. Weird implied relationships. AR.Invoice.CustCode referring to CustomerCode from GL.Customer when there's an existing unpopulated Customer table inside the AR database. Is the AR.Customer table used? If not, shouldn't it be deleted?
7. General tardiness. AR.Invoices and AR.INVOICE both exist in the same database. Since most of the other tables names are CamelCased, I expected AR.Invoices to be the table updated, turns out its AR.INVOICE instead.

Preliminary checking has revealed duplicated (and supposedly ""unique"") key values, like ""CustomerCode"" in the Customer table. 
Orphaned records in all sorts of transaction files. E.g. invoices missing customer codes because some random user decided that a particular customer was no longer in use and deleted it from the customer table.

And now its my job to get this all sorted...... /facepalm

After a few sleepness nights, I drew up the following plan:

1. Generate a simple data dict for the smallest app (4 databases, 100-ish tables). 
2. Get basic documention done, starting with field descriptions and moving on to the relationships. 
3. Once basic documentation is completed, start inserting simple constraint information (SellingPrice > 0, etc, etc) into the data dict.
4. Write some sorta script that will check the current data against the constraints for any inconsistencies. 
5. Write another script that will check the data for RI violations based on the data dict.
6. Decide what the heck we're gonna do with the inconsistencies......
7. Decide if we want to put the constraints/triggers into the database proper to make sure we don't get dirty data again, writing a script to get that done, etc, etc....
8. Keep telling myself to NOT bother with more complex business rules for now. Time pressure will be on getting the other apps sorted to the same level first but this is a two edged sword. I let this one drag on too long and ""later"" has a strange way of morphing into ""never""...

Worse of all, I can't quit, back out or say I don't care because the owner is my best friend of over 35 years....

Like I mentioned earlier, I stopped developing software 12 years ago and have basically lost touch with current changes/advances. Whatever knowledge I did have also did not extend to C# (which is what they are developing with) and MSSQL since VFP was pretty much was all I needed in those days.

Any input regarding my plan of acton would be much appreciated since I'm lost and more than a little overwhelmed at the moment. Any info on tools that might help or sites that I should read will also be very welcome. 

I'm also hoping that this ""plan of action"" might be of benefit to others that are in the same boat. 









",sql-server,database,legacy-database,data-dictionary,,07/18/2011 12:07:22,off topic,1,540,4,"Legacy databases from Hell I'm a VFP developer that has just come of retirement to face a bunch of legacy apps from hell so any help/input would be much appreciated.

It's a total of 14 different business apps running a mix of Access/Mysql but mostly MSSQL databases with one thing in common. The databases are all in horrendous shape.

1. None of the tables have primary keys
2. There are exactly zero foreign keys/constraints
3. No candidate keys
4. No documentation, not even ""unofficial"" ER/Schema/Case diagrams
5. Sloppy field naming, CustomerID (char(10)) in the parent table, CustID (nchar(10)), TraderCode (varchar(10)), etc, in child tables spread across different databases. 
6. Weird implied relationships. AR.Invoice.CustCode referring to CustomerCode from GL.Customer when there's an existing unpopulated Customer table inside the AR database. Is the AR.Customer table used? If not, shouldn't it be deleted?
7. General tardiness. AR.Invoices and AR.INVOICE both exist in the same database. Since most of the other tables names are CamelCased, I expected AR.Invoices to be the table updated, turns out its AR.INVOICE instead.

Preliminary checking has revealed duplicated (and supposedly ""unique"") key values, like ""CustomerCode"" in the Customer table. 
Orphaned records in all sorts of transaction files. E.g. invoices missing customer codes because some random user decided that a particular customer was no longer in use and deleted it from the customer table.

And now its my job to get this all sorted...... /facepalm

After a few sleepness nights, I drew up the following plan:

1. Generate a simple data dict for the smallest app (4 databases, 100-ish tables). 
2. Get basic documention done, starting with field descriptions and moving on to the relationships. 
3. Once basic documentation is completed, start inserting simple constraint information (SellingPrice > 0, etc, etc) into the data dict.
4. Write some sorta script that will check the current data against the constraints for any inconsistencies. 
5. Write another script that will check the data for RI violations based on the data dict.
6. Decide what the heck we're gonna do with the inconsistencies......
7. Decide if we want to put the constraints/triggers into the database proper to make sure we don't get dirty data again, writing a script to get that done, etc, etc....
8. Keep telling myself to NOT bother with more complex business rules for now. Time pressure will be on getting the other apps sorted to the same level first but this is a two edged sword. I let this one drag on too long and ""later"" has a strange way of morphing into ""never""...

Worse of all, I can't quit, back out or say I don't care because the owner is my best friend of over 35 years....

Like I mentioned earlier, I stopped developing software 12 years ago and have basically lost touch with current changes/advances. Whatever knowledge I did have also did not extend to C# (which is what they are developing with) and MSSQL since VFP was pretty much was all I needed in those days.

Any input regarding my plan of acton would be much appreciated since I'm lost and more than a little overwhelmed at the moment. Any info on tools that might help or sites that I should read will also be very welcome. 

I'm also hoping that this ""plan of action"" might be of benefit to others that are in the same boat. 









",4
1091708,07/07/2009 11:05:28,98389,04/30/2009 09:14:47,807,47,Scripting your database first versus building the database via MSSQLMS and then generating the script,"I had a (friendly but heated) argument with my lead developer the other day because our project has TSQL Scripts that I code directly into SQL files which I then run against the database. I find that when I do this, it's easy to work out the schema in advance without fiddly pointing and clicking and then there's no opportunity to forget to generate a script to put into source control as generating the script no longer becomes a chore you have to do after the fact, but is an implicit part of the process (and also leads to cleaner scripts without the extra crap that MSSQLMS inserts into the scripts it generates).

My lead developer insists that having to manually script it out is a pain in the arse and that he absolutely refuses to write his scripts by hand when there are perfectly good tools to do it without coding. I've noticed that the copying of his changes into the actual scripts tends to get delayed a bit as a result though.

What are your thoughts on the pros and/or cons of doing it one way vs the other? Am I being too rigid/old-school in my sticking to hand coding schema scripts or is he being too reliant on third party tools and losing something in the process?",sql-server,sql,,,,,open,0,218,15,"Scripting your database first versus building the database via MSSQLMS and then generating the script I had a (friendly but heated) argument with my lead developer the other day because our project has TSQL Scripts that I code directly into SQL files which I then run against the database. I find that when I do this, it's easy to work out the schema in advance without fiddly pointing and clicking and then there's no opportunity to forget to generate a script to put into source control as generating the script no longer becomes a chore you have to do after the fact, but is an implicit part of the process (and also leads to cleaner scripts without the extra crap that MSSQLMS inserts into the scripts it generates).

My lead developer insists that having to manually script it out is a pain in the arse and that he absolutely refuses to write his scripts by hand when there are perfectly good tools to do it without coding. I've noticed that the copying of his changes into the actual scripts tends to get delayed a bit as a result though.

What are your thoughts on the pros and/or cons of doing it one way vs the other? Am I being too rigid/old-school in my sticking to hand coding schema scripts or is he being too reliant on third party tools and losing something in the process?",2
3350004,07/28/2010 04:48:45,85952,04/02/2009 00:53:40,657,8,Split function in SSIS Expression ,"I got a column values as '035-7448-001-3854535'
In SSIS - Data Flow i need to split this into three different components as 

    **Col1                Col2                  Col3**
      035               7448-001               3854535

this can be done using script component.

Is there a way to deal with this in Derived Column Component

Thanks",sql-server,ssis,,,,,open,0,113,6,"Split function in SSIS Expression  I got a column values as '035-7448-001-3854535'
In SSIS - Data Flow i need to split this into three different components as 

    **Col1                Col2                  Col3**
      035               7448-001               3854535

this can be done using script component.

Is there a way to deal with this in Derived Column Component

Thanks",2
10268640,04/22/2012 14:11:06,1124928,01/01/2012 07:35:24,27,2,SQL Server 2008 integrated security,"Anybody please tell, from where I can download sqljdbc_auth.dll for a 32 bit OS.",sql-server,sql-server-2008,jdbc,,,,open,0,14,5,"SQL Server 2008 integrated security Anybody please tell, from where I can download sqljdbc_auth.dll for a 32 bit OS.",3
5259319,03/10/2011 12:00:30,562968,01/04/2011 18:24:18,1,0,wrap xml column values into outer for xml path query,"I want to wrap the xml from a column into an out for xml path query without
the column name as an element.


    declare @tab table (col xml)
    insert @tab
    select '<element/>'
    
    select  'val' AS ""@att"" , col
    from  @tab
    for xml path ('ROOT')

This gives 

    <ROOT att=""val"">
      <col>
        <element />
      </col>
    </ROOT>

but i want 

    <ROOT att=""val"">
    	<element />
    </ROOT>

All help most appreciated.

",sql-server,xml,sql-server-2005,tsql,sql-server-2008,,open,0,119,10,"wrap xml column values into outer for xml path query I want to wrap the xml from a column into an out for xml path query without
the column name as an element.


    declare @tab table (col xml)
    insert @tab
    select '<element/>'
    
    select  'val' AS ""@att"" , col
    from  @tab
    for xml path ('ROOT')

This gives 

    <ROOT att=""val"">
      <col>
        <element />
      </col>
    </ROOT>

but i want 

    <ROOT att=""val"">
    	<element />
    </ROOT>

All help most appreciated.

",5
295771,11/17/2008 15:01:38,1174,08/13/2008 10:17:21,195,11,Configure Hibernate to escape underscores in LIKE clause using SQL Server dialect,"I have a SQL SELECT query which has a LIKE clause containing an underscore, which should specifically look for an underscore, not treat it as a wildcard: 

    SELECT * FROM my_table WHERE name LIKE '_H9%';

I understand that I can change the actual clause to '[_]H9%' for this to work as I expect, but the problem is that this clause is being generated by Hibernate.

Is there a way to configure Hibernate to escape all underscores in all queries in this way?  Failing that, is there a way to configure SQL Server (2008 in my case) to _not_ treat underscores as wildcards?

",sql-server,sql,hibernate,java,,,open,0,105,12,"Configure Hibernate to escape underscores in LIKE clause using SQL Server dialect I have a SQL SELECT query which has a LIKE clause containing an underscore, which should specifically look for an underscore, not treat it as a wildcard: 

    SELECT * FROM my_table WHERE name LIKE '_H9%';

I understand that I can change the actual clause to '[_]H9%' for this to work as I expect, but the problem is that this clause is being generated by Hibernate.

Is there a way to configure Hibernate to escape all underscores in all queries in this way?  Failing that, is there a way to configure SQL Server (2008 in my case) to _not_ treat underscores as wildcards?

",4
5830229,04/29/2011 09:15:10,726631,04/27/2011 06:11:54,13,0,Copy Each Identity Of Inserted Records,"I have to table
first:<br /> 

    Table:     TBL#Sell
    
       SellId    ClientId    ProductId
                    1           3
                    3           5
                    4            6

second:<br />

  

     Table: TBL#Sell2
    
        SellId      ClientId       ProductId

Now I want to copy every record of first table to second one.
""SellId"" column in second table (Sell2.SellId) is Auto Increment (Identity).

for any insert the TBL#Sell2.SellId will set with new identity and i must store the identity in TBL#Sell1.SellId
Is it clear?
What is the solution? , plz.
**thanks**


",sql-server,sql-server-2005,,,,,open,0,207,6,"Copy Each Identity Of Inserted Records I have to table
first:<br /> 

    Table:     TBL#Sell
    
       SellId    ClientId    ProductId
                    1           3
                    3           5
                    4            6

second:<br />

  

     Table: TBL#Sell2
    
        SellId      ClientId       ProductId

Now I want to copy every record of first table to second one.
""SellId"" column in second table (Sell2.SellId) is Auto Increment (Identity).

for any insert the TBL#Sell2.SellId will set with new identity and i must store the identity in TBL#Sell1.SellId
Is it clear?
What is the solution? , plz.
**thanks**


",2
1186673,07/27/2009 06:18:54,70636,02/25/2009 01:43:48,33,2,Schema Comarison,"Can some body please, give me idea on how can I do a schema compare between the the build script in TFS and the database in the server for that build. 

Thanks",sql-server,,,,,,open,0,32,2,"Schema Comarison Can some body please, give me idea on how can I do a schema compare between the the build script in TFS and the database in the server for that build. 

Thanks",1
5396819,03/22/2011 19:38:17,226897,12/08/2009 05:32:39,9159,460,Possible to perform a bitwise operation on a 1000 bit number in SQL Server?,"Spawned by this question:

http://stackoverflow.com/questions/5396368/bitwise-and-in-sql-server/5396525#5396525

In response to the above question I suggested converting a varchar(1000)  that contained a binary number to it's integer equivalent and performing bitwise operations on it.  While this would be ok for much smaller binary numbers, it is too large to work with any method I am aware of.

Does anyone know of a way to do this in SQL Server?  Is it possible to apply bitwise operations to the binary datatype?",sql-server,sql-server-2008,binary,bitwise,,,open,0,77,14,"Possible to perform a bitwise operation on a 1000 bit number in SQL Server? Spawned by this question:

http://stackoverflow.com/questions/5396368/bitwise-and-in-sql-server/5396525#5396525

In response to the above question I suggested converting a varchar(1000)  that contained a binary number to it's integer equivalent and performing bitwise operations on it.  While this would be ok for much smaller binary numbers, it is too large to work with any method I am aware of.

Does anyone know of a way to do this in SQL Server?  Is it possible to apply bitwise operations to the binary datatype?",4
2783495,05/06/2010 18:33:55,18891,09/19/2008 14:20:24,677,34,SQL Server Index Naming Conventions,Is there some standard way to name indexes for SQL Server?  It seems that the primary key index is named PK_<tablename> and non-clustered indexes typically start with IX_<tablename>.  Are there any naming conventions beyond that for unique indexes?,sql-server,index,naming-conventions,,,06/02/2012 20:17:29,not constructive,1,40,5,SQL Server Index Naming Conventions Is there some standard way to name indexes for SQL Server?  It seems that the primary key index is named PK_<tablename> and non-clustered indexes typically start with IX_<tablename>.  Are there any naming conventions beyond that for unique indexes?,3
9617038,03/08/2012 11:36:46,56,08/01/2008 13:53:45,2885,36,Why doesn't this cascading nullify trigger work on SQL Server 2000,"I've got the tables A and B. Table B has a foreign key constraint refering to table B. But since SQL Server 2000 only supports cascading delete, and not nullify, I decided to fix this with a trigger.

The problem: the trigger below doesn't work:


    CREATE TRIGGER dbo.TR_A_B_CascadingNullify ON dbo.A
    FOR DELETE
    AS
    	UPDATE dbo.B
    	SET idA = NULL
    	WHERE idA IN (SELECT id FROM DELETED)
    ;

When deleting a row in A that isn't refered to, everything works. But when a refered to row is deleted, it fails on the foreign key constraint with the message `DELETE statement conflicted with COLUMN REFERENCE constraint 'FK_B_A'. The conflict occurred in database 'x', table 'B', column 'idA'.`

And finally, when setting the option `Enforce Foreign Key Constraint` to `No`, the trigger does work, and the column in table B is set to NULL.

What am I doing wrong?",sql-server,triggers,foreign-keys,sql-server-2000,,,open,0,163,11,"Why doesn't this cascading nullify trigger work on SQL Server 2000 I've got the tables A and B. Table B has a foreign key constraint refering to table B. But since SQL Server 2000 only supports cascading delete, and not nullify, I decided to fix this with a trigger.

The problem: the trigger below doesn't work:


    CREATE TRIGGER dbo.TR_A_B_CascadingNullify ON dbo.A
    FOR DELETE
    AS
    	UPDATE dbo.B
    	SET idA = NULL
    	WHERE idA IN (SELECT id FROM DELETED)
    ;

When deleting a row in A that isn't refered to, everything works. But when a refered to row is deleted, it fails on the foreign key constraint with the message `DELETE statement conflicted with COLUMN REFERENCE constraint 'FK_B_A'. The conflict occurred in database 'x', table 'B', column 'idA'.`

And finally, when setting the option `Enforce Foreign Key Constraint` to `No`, the trigger does work, and the column in table B is set to NULL.

What am I doing wrong?",4
10984241,06/11/2012 16:44:42,854739,07/20/2011 20:29:21,521,6,For Loop in SQL Server - is this the right logic?,"I'm trying to take transactional data and cleanse it to meet my analysis needs.  There are some limitations to how transactions are recorded into the database, and I am trying to get around those limitations.  

When a customer places an order with more than 1 product, the transactional database doesn't link the multiple products together.  Each product will have a unique sales ID, but there is no way to group multiple sales ID into 1 order.  Here is a sample:

    OrderID	  MultOrderID	CustomerID	SalesDate	SalesTime	ProductID	ProductCost	ShippingCost
    6082346	    	        7661X0A	    2012-06-12	959	        105	        99.99	    7.95
    6082347	  5809812YY6Y	T891002	    2012-06-12	1005	    222	        99.95	    7.95
    6082348	  5809812YY6Z	T891002	    2012-06-12	1005	    273	        22.95	    1.00
    6082349	  5809812YY71	T891002	    2012-06-12	1005	    285	        499.95	    1.00
    6082350	  5809812YY72	T891002	    2012-06-12	1005	    172	        49.95	    1.00
    6082351	  5809812YY73	T891002	    2012-06-12	1005	    105	        99.99	    7.95
    6082352	  5809812YY74	X637251	    2012-06-12	1010	    285	        499.95	    7.95
    6082353	  5809812YY75	X637251	    2012-06-12	1010	    30	        1024.99	    1.00
    6082354	    	        T512AT0	    2012-06-12	1017	    172	        49.95	    7.95

An additional limitation to this transaction system is that it can not ship more than 4 products together.  If the customer places an order for 5 products, 4 products are shipped together (and charged 1 shipping charge), the remaining product is shipped separately and charged another shipping charge (yes, the overall business wants to rebuild this entire legacy system....).  

What I am trying to determine is the number of products shipped per order, and the aggregate product costs and shipping costs.  

If you look at the last 4 characters of the MultOrderID, you'll see that it's sequential, YY6Y becomes YY6Z, then rolls over to YY71, YY72.  The logic is standardized - I know that if the CustomerID, SalesDate and SalesTime are the same, then I can pair off the products together.  What I don't know is HOW I can accomplish this.  

I believe the way to accomplish this is to break out the orders by CustomerID, SalesDate and SalesTime.  Then, I get a `for-loop`, or something like that to cycle through the individual entries.  Then, I look for the last 4 characters of the MultOrderID and say - If 1,2 and 3 are the same, and the 4th character is after the 4th character of the previous order, then pair it together, up to 4 orders.  If the orderID is the 5th to 8th order in the range, then that's shipment 2, etc.  

Can this be done in `SQL Server`?  If not in that, what should I write this in?  And is a `for-loop` what I should be using in this case?  
",sql-server,sql-server-2008,for-loop,while-loops,,,open,0,623,11,"For Loop in SQL Server - is this the right logic? I'm trying to take transactional data and cleanse it to meet my analysis needs.  There are some limitations to how transactions are recorded into the database, and I am trying to get around those limitations.  

When a customer places an order with more than 1 product, the transactional database doesn't link the multiple products together.  Each product will have a unique sales ID, but there is no way to group multiple sales ID into 1 order.  Here is a sample:

    OrderID	  MultOrderID	CustomerID	SalesDate	SalesTime	ProductID	ProductCost	ShippingCost
    6082346	    	        7661X0A	    2012-06-12	959	        105	        99.99	    7.95
    6082347	  5809812YY6Y	T891002	    2012-06-12	1005	    222	        99.95	    7.95
    6082348	  5809812YY6Z	T891002	    2012-06-12	1005	    273	        22.95	    1.00
    6082349	  5809812YY71	T891002	    2012-06-12	1005	    285	        499.95	    1.00
    6082350	  5809812YY72	T891002	    2012-06-12	1005	    172	        49.95	    1.00
    6082351	  5809812YY73	T891002	    2012-06-12	1005	    105	        99.99	    7.95
    6082352	  5809812YY74	X637251	    2012-06-12	1010	    285	        499.95	    7.95
    6082353	  5809812YY75	X637251	    2012-06-12	1010	    30	        1024.99	    1.00
    6082354	    	        T512AT0	    2012-06-12	1017	    172	        49.95	    7.95

An additional limitation to this transaction system is that it can not ship more than 4 products together.  If the customer places an order for 5 products, 4 products are shipped together (and charged 1 shipping charge), the remaining product is shipped separately and charged another shipping charge (yes, the overall business wants to rebuild this entire legacy system....).  

What I am trying to determine is the number of products shipped per order, and the aggregate product costs and shipping costs.  

If you look at the last 4 characters of the MultOrderID, you'll see that it's sequential, YY6Y becomes YY6Z, then rolls over to YY71, YY72.  The logic is standardized - I know that if the CustomerID, SalesDate and SalesTime are the same, then I can pair off the products together.  What I don't know is HOW I can accomplish this.  

I believe the way to accomplish this is to break out the orders by CustomerID, SalesDate and SalesTime.  Then, I get a `for-loop`, or something like that to cycle through the individual entries.  Then, I look for the last 4 characters of the MultOrderID and say - If 1,2 and 3 are the same, and the 4th character is after the 4th character of the previous order, then pair it together, up to 4 orders.  If the orderID is the 5th to 8th order in the range, then that's shipment 2, etc.  

Can this be done in `SQL Server`?  If not in that, what should I write this in?  And is a `for-loop` what I should be using in this case?  
",4
796791,04/28/2009 08:22:19,1385845,04/22/2009 12:09:10,1464,127,SQL Server - Synonyms Tips & Tricks?,"I've been doing a lot of DB refactoring lately and synonyms have come in incredibly useful. When I originally put in the synonyms I was thinking they would be very temporary while I refactor. Now I am thinking there might be some good reasons to keep some of these synonyms around.

 - Has anyone used them as full blow
   abstraction layer?
   
 - What are the performance costs?

 - Any gotchas with indexes?

 - Tips or Tricks?

My first question, so please be gentle. 

Thanks",sql-server,synonym,database-design,performance,,12/08/2011 01:11:04,not constructive,1,88,7,"SQL Server - Synonyms Tips & Tricks? I've been doing a lot of DB refactoring lately and synonyms have come in incredibly useful. When I originally put in the synonyms I was thinking they would be very temporary while I refactor. Now I am thinking there might be some good reasons to keep some of these synonyms around.

 - Has anyone used them as full blow
   abstraction layer?
   
 - What are the performance costs?

 - Any gotchas with indexes?

 - Tips or Tricks?

My first question, so please be gentle. 

Thanks",4
10977218,06/11/2012 09:12:57,441343,09/07/2010 10:34:49,1121,44,Partial backup in SQL Server,"For debugging purpose, oftenly I need to copy the entire database from live server to local server.

Is there any tools available in SQL Server 2005 so that I can synchorize only needed tables, or a number of records from a table.

I can connect to the server using SLQ Server Management Studio.",sql-server,sql-server-2005,backup,,,,open,0,51,5,"Partial backup in SQL Server For debugging purpose, oftenly I need to copy the entire database from live server to local server.

Is there any tools available in SQL Server 2005 so that I can synchorize only needed tables, or a number of records from a table.

I can connect to the server using SLQ Server Management Studio.",3
5260500,03/10/2011 13:51:13,281136,02/25/2010 10:30:32,35,3,Catch conditional parameters in mssql select trigger,"I want to know that,
When I write a select trigger (instead of select), how catch conditional parameters in this trigger? 

I am using MSSQL.
",sql-server,triggers,,,,,open,0,24,7,"Catch conditional parameters in mssql select trigger I want to know that,
When I write a select trigger (instead of select), how catch conditional parameters in this trigger? 

I am using MSSQL.
",2
921451,05/28/2009 15:21:56,33264,11/01/2008 02:18:32,946,89,Technological solutions for extremely long term data archiving?,"Are there any good technical solutions for extremely long term archiving of data, for example for 25 to 100 years?

Somehow I just don't have a lot of confidence that a SQL 2000 backup file will be usable in court cases or for historians in 25 to 100 years.

This is a customer requirement, not just speculation.

This is comparable to trying to trying to do something useful with a back up for ENIAC or reading Atari Writer wordprocesing files.  The hardware doesn't necessarily exist anymore, the storage media is likely corrupt, the professionals for using the technology probably don't exist anymore, etc.
",sql-server,archiving,,,,,open,0,101,8,"Technological solutions for extremely long term data archiving? Are there any good technical solutions for extremely long term archiving of data, for example for 25 to 100 years?

Somehow I just don't have a lot of confidence that a SQL 2000 backup file will be usable in court cases or for historians in 25 to 100 years.

This is a customer requirement, not just speculation.

This is comparable to trying to trying to do something useful with a back up for ENIAC or reading Atari Writer wordprocesing files.  The hardware doesn't necessarily exist anymore, the storage media is likely corrupt, the professionals for using the technology probably don't exist anymore, etc.
",2
561138,02/18/2009 14:00:49,67381,02/17/2009 13:58:00,11,0,How Can I add the 2D array in SQL server 2000 using c#,I want to add the 2-dimentional array in the sql server 2000 using c#. But the problem is that there is not array data type in sql. Kindly help me that how can I add the 2-dimentional array in sql server. Thanx for viewing my question...,sql-server,c#,,,,,open,0,46,13,How Can I add the 2D array in SQL server 2000 using c# I want to add the 2-dimentional array in the sql server 2000 using c#. But the problem is that there is not array data type in sql. Kindly help me that how can I add the 2-dimentional array in sql server. Thanx for viewing my question...,2
3856077,10/04/2010 14:15:16,332624,05/04/2010 17:17:06,433,13,Can you explain the use of sys.sp_addextendedproperty in the following code?,"What's going on in the following code after the View is created? Can you give me any thought or path to follow?

This code is taken from [here][1].


    /****** Object:  View [dbo].[vProductImages]    Script Date: 04/28/2008 16:59:05 ******/
    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    CREATE VIEW [dbo].[vProductImages]
    AS
    SELECT        dbo.Products_Images.ProductID, dbo.Images.ThumbUrl, dbo.Images.FullImageUrl
    FROM            dbo.Products_Images INNER JOIN
                             dbo.Images ON dbo.Products_Images.ImageID = dbo.Images.ImageID
    GO
    EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
    Begin DesignProperties = 
       Begin PaneConfigurations = 
          Begin PaneConfiguration = 0
             NumPanes = 4
             Configuration = ""(H (1[40] 4[20] 2[20] 3) )""
          End
          Begin PaneConfiguration = 1
             NumPanes = 3
             Configuration = ""(H (1 [50] 4 [25] 3))""
          End
          Begin PaneConfiguration = 2
             NumPanes = 3
             Configuration = ""(H (1 [50] 2 [25] 3))""
          End
          Begin PaneConfiguration = 3
             NumPanes = 3
             Configuration = ""(H (4 [30] 2 [40] 3))""
          End
          Begin PaneConfiguration = 4
             NumPanes = 2
             Configuration = ""(H (1 [56] 3))""
          End
          Begin PaneConfiguration = 5
             NumPanes = 2
             Configuration = ""(H (2 [66] 3))""
          End
          Begin PaneConfiguration = 6
             NumPanes = 2
             Configuration = ""(H (4 [50] 3))""
          End
          Begin PaneConfiguration = 7
             NumPanes = 1
             Configuration = ""(V (3))""
          End
          Begin PaneConfiguration = 8
             NumPanes = 3
             Configuration = ""(H (1[56] 4[18] 2) )""
          End
          Begin PaneConfiguration = 9
             NumPanes = 2
             Configuration = ""(H (1 [75] 4))""
          End
          Begin PaneConfiguration = 10
             NumPanes = 2
             Configuration = ""(H (1[66] 2) )""
          End
          Begin PaneConfiguration = 11
             NumPanes = 2
             Configuration = ""(H (4 [60] 2))""
          End
          Begin PaneConfiguration = 12
             NumPanes = 1
             Configuration = ""(H (1) )""
          End
          Begin PaneConfiguration = 13
             NumPanes = 1
             Configuration = ""(V (4))""
          End
          Begin PaneConfiguration = 14
             NumPanes = 1
             Configuration = ""(V (2))""
          End
          ActivePaneConfig = 0
       End
       Begin DiagramPane = 
          Begin Origin = 
             Top = 0
             Left = 0
          End
          Begin Tables = 
             Begin Table = ""Products_Images""
                Begin Extent = 
                   Top = 6
                   Left = 38
                   Bottom = 99
                   Right = 208
                End
                DisplayFlags = 280
                TopColumn = 0
             End
             Begin Table = ""Images""
                Begin Extent = 
                   Top = 6
                   Left = 246
                   Bottom = 116
                   Right = 416
                End
                DisplayFlags = 280
                TopColumn = 0
             End
          End
       End
       Begin SQLPane = 
       End
       Begin DataPane = 
          Begin ParameterDefaults = """"
          End
          Begin ColumnWidths = 9
             Width = 284
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
          End
       End
       Begin CriteriaPane = 
          Begin ColumnWidths = 11
             Column = 1440
             Alias = 900
             Table = 1170
             Output = 720
             Append = 1400
             NewValue = 1170
             SortType = 1350
             SortOrder = 1410
             GroupBy = 1350
             Filter = 1350
             Or = 1350
             Or = 1350
             Or = 1350
          End
       End
    End
    ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vProductImages'
    GO
    EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vProductImages'
    GO
    


  [1]: http://mvcsamples.codeplex.com/SourceControl/changeset/view/4733#111285",sql-server,tsql,sql-server-2008,extended-properties,,,open,0,1975,11,"Can you explain the use of sys.sp_addextendedproperty in the following code? What's going on in the following code after the View is created? Can you give me any thought or path to follow?

This code is taken from [here][1].


    /****** Object:  View [dbo].[vProductImages]    Script Date: 04/28/2008 16:59:05 ******/
    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    CREATE VIEW [dbo].[vProductImages]
    AS
    SELECT        dbo.Products_Images.ProductID, dbo.Images.ThumbUrl, dbo.Images.FullImageUrl
    FROM            dbo.Products_Images INNER JOIN
                             dbo.Images ON dbo.Products_Images.ImageID = dbo.Images.ImageID
    GO
    EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
    Begin DesignProperties = 
       Begin PaneConfigurations = 
          Begin PaneConfiguration = 0
             NumPanes = 4
             Configuration = ""(H (1[40] 4[20] 2[20] 3) )""
          End
          Begin PaneConfiguration = 1
             NumPanes = 3
             Configuration = ""(H (1 [50] 4 [25] 3))""
          End
          Begin PaneConfiguration = 2
             NumPanes = 3
             Configuration = ""(H (1 [50] 2 [25] 3))""
          End
          Begin PaneConfiguration = 3
             NumPanes = 3
             Configuration = ""(H (4 [30] 2 [40] 3))""
          End
          Begin PaneConfiguration = 4
             NumPanes = 2
             Configuration = ""(H (1 [56] 3))""
          End
          Begin PaneConfiguration = 5
             NumPanes = 2
             Configuration = ""(H (2 [66] 3))""
          End
          Begin PaneConfiguration = 6
             NumPanes = 2
             Configuration = ""(H (4 [50] 3))""
          End
          Begin PaneConfiguration = 7
             NumPanes = 1
             Configuration = ""(V (3))""
          End
          Begin PaneConfiguration = 8
             NumPanes = 3
             Configuration = ""(H (1[56] 4[18] 2) )""
          End
          Begin PaneConfiguration = 9
             NumPanes = 2
             Configuration = ""(H (1 [75] 4))""
          End
          Begin PaneConfiguration = 10
             NumPanes = 2
             Configuration = ""(H (1[66] 2) )""
          End
          Begin PaneConfiguration = 11
             NumPanes = 2
             Configuration = ""(H (4 [60] 2))""
          End
          Begin PaneConfiguration = 12
             NumPanes = 1
             Configuration = ""(H (1) )""
          End
          Begin PaneConfiguration = 13
             NumPanes = 1
             Configuration = ""(V (4))""
          End
          Begin PaneConfiguration = 14
             NumPanes = 1
             Configuration = ""(V (2))""
          End
          ActivePaneConfig = 0
       End
       Begin DiagramPane = 
          Begin Origin = 
             Top = 0
             Left = 0
          End
          Begin Tables = 
             Begin Table = ""Products_Images""
                Begin Extent = 
                   Top = 6
                   Left = 38
                   Bottom = 99
                   Right = 208
                End
                DisplayFlags = 280
                TopColumn = 0
             End
             Begin Table = ""Images""
                Begin Extent = 
                   Top = 6
                   Left = 246
                   Bottom = 116
                   Right = 416
                End
                DisplayFlags = 280
                TopColumn = 0
             End
          End
       End
       Begin SQLPane = 
       End
       Begin DataPane = 
          Begin ParameterDefaults = """"
          End
          Begin ColumnWidths = 9
             Width = 284
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
             Width = 1500
          End
       End
       Begin CriteriaPane = 
          Begin ColumnWidths = 11
             Column = 1440
             Alias = 900
             Table = 1170
             Output = 720
             Append = 1400
             NewValue = 1170
             SortType = 1350
             SortOrder = 1410
             GroupBy = 1350
             Filter = 1350
             Or = 1350
             Or = 1350
             Or = 1350
          End
       End
    End
    ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vProductImages'
    GO
    EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'vProductImages'
    GO
    


  [1]: http://mvcsamples.codeplex.com/SourceControl/changeset/view/4733#111285",4
1705759,11/10/2009 05:13:11,146857,07/29/2009 06:11:50,26,18,Get Last page no in a pager link like stackoverflow ,"Hai Guys,
   How to get last page no like stackoverflow.com pagination in Sql server 2005",sql-server,pagination,,,,,open,0,17,11,"Get Last page no in a pager link like stackoverflow  Hai Guys,
   How to get last page no like stackoverflow.com pagination in Sql server 2005",2
8853880,01/13/2012 16:31:18,712486,04/17/2011 20:20:09,104,5,How to change this Access TRANSFORM statement to Sql Server,"I need to convert this Access query to Sql Server but it looks like Transform and Pivot are not valid Sql Server functions. What is the equivalent function? Or would I have to rework the entire query all together? 

    TRANSFORM Sum([Rates by Quarter and Bedsize].[State CLABSI Rate]) AS [SumOfState CLABSI Rate]
    SELECT [Rates by Quarter and Bedsize].Bedsize
    FROM [Rates by Quarter and Bedsize]
    GROUP BY [Rates by Quarter and Bedsize].SizeCategory, [Rates by Quarter and Bedsize].Bedsize
    ORDER BY [Rates by Quarter and Bedsize].SizeCategory
    PIVOT [Rates by Quarter and Bedsize].SummaryYQ;",sql-server,tsql,ms-access,,,,open,0,107,10,"How to change this Access TRANSFORM statement to Sql Server I need to convert this Access query to Sql Server but it looks like Transform and Pivot are not valid Sql Server functions. What is the equivalent function? Or would I have to rework the entire query all together? 

    TRANSFORM Sum([Rates by Quarter and Bedsize].[State CLABSI Rate]) AS [SumOfState CLABSI Rate]
    SELECT [Rates by Quarter and Bedsize].Bedsize
    FROM [Rates by Quarter and Bedsize]
    GROUP BY [Rates by Quarter and Bedsize].SizeCategory, [Rates by Quarter and Bedsize].Bedsize
    ORDER BY [Rates by Quarter and Bedsize].SizeCategory
    PIVOT [Rates by Quarter and Bedsize].SummaryYQ;",3
10640265,05/17/2012 17:10:25,155992,08/13/2009 17:59:38,129,0,TSQL query for Week Comparison,"I have a table that has a TASK_START_DATE and TASK_FINISH_DATE Columns of type datetime

I need help with a query that returns all Tasks when the Task: (date = just the date - I think I can do a conversion to the date from datetime on SQL 2008R2, it works fine)
<br/>
<br/>- is within 2 weeks previous of the current date or two weeks after the current date.

Similarly I also need the records whose TaskEnd values are within 2 weeks previous or two weeks before

I've been trying things like which would get tasks where the start date is within the two previous weeks, but I have to do the same for TASK_FINISH_DATE and I think my and's and or's are all jumbled up, any help is appreciated.

    Convert(Date, TASK_START_DATE) <=  Convert(Date, DateAdd(ww, -2, GetDate())) 

Short version:
How do I correctly write a query that combines all records with the TASK_START_DATE and TASK_END_DATE within two weeks in the future or past, i.e.

    Select Task_ID, TASK_NAME, TASK_START_DATE, TASK_END_DATE
    where 
    ???",sql-server,query,tsql,,,,open,0,179,5,"TSQL query for Week Comparison I have a table that has a TASK_START_DATE and TASK_FINISH_DATE Columns of type datetime

I need help with a query that returns all Tasks when the Task: (date = just the date - I think I can do a conversion to the date from datetime on SQL 2008R2, it works fine)
<br/>
<br/>- is within 2 weeks previous of the current date or two weeks after the current date.

Similarly I also need the records whose TaskEnd values are within 2 weeks previous or two weeks before

I've been trying things like which would get tasks where the start date is within the two previous weeks, but I have to do the same for TASK_FINISH_DATE and I think my and's and or's are all jumbled up, any help is appreciated.

    Convert(Date, TASK_START_DATE) <=  Convert(Date, DateAdd(ww, -2, GetDate())) 

Short version:
How do I correctly write a query that combines all records with the TASK_START_DATE and TASK_END_DATE within two weeks in the future or past, i.e.

    Select Task_ID, TASK_NAME, TASK_START_DATE, TASK_END_DATE
    where 
    ???",3
7753380,10/13/2011 11:24:54,37381,11/13/2008 15:58:55,1043,60,Performance implications for using OPENQUERY in a view,"I am using an EasySoft ODBC driver to link a SQL Server 2008 R2 Express instance to Interbase and I am having some difficulty with getting metadata from the remote server. From looking about on the net the main sugestions all mention using OPENQUERY instead of the four part linked server syntax. 

E.G. My current (problematic) approach is...

    CREATE VIEW [LIVE].[vwPRDETS]
    AS
    
    SELECT *
    FROM [LBLIVE]...[PRDETS] WITH (NOLOCK)

But on some tables I get the error when calling the view...

> Msg 7353, Level 16, State 1, Line 1 The OLE DB provider ""MSDASQL"" for
> linked server ""LBLIVE"" supplied inconsistent metadata. An extra column
> was supplied during execution that was not found at compile time.

Also, some views I cannot even create because I get the following...

> Msg 7315, Level 16, State 1, Line 1 The OLE DB provider ""MSDASQL"" for
> linked server ""LBLIVE"" contains multiple tables that match the name
> """"SYSDBA"".""AUDIT_LBABKP"""".

Although there is only one of the tables mentioned.

The alternative approach from searching the net seems to be more like...

    SELECT *
    FROM OPENQUERY(<linked sevrer>, 'SELECT <column list> FROM MyTable')

So, my question is, if I use OPENQUERY in my view definition will SQL Server be able to optimise the resulting SQL being sent to Interbase? Or is there really not much difference between the two approaches?






",sql-server,odbc,linked-server,,,10/17/2011 16:06:05,off topic,1,236,8,"Performance implications for using OPENQUERY in a view I am using an EasySoft ODBC driver to link a SQL Server 2008 R2 Express instance to Interbase and I am having some difficulty with getting metadata from the remote server. From looking about on the net the main sugestions all mention using OPENQUERY instead of the four part linked server syntax. 

E.G. My current (problematic) approach is...

    CREATE VIEW [LIVE].[vwPRDETS]
    AS
    
    SELECT *
    FROM [LBLIVE]...[PRDETS] WITH (NOLOCK)

But on some tables I get the error when calling the view...

> Msg 7353, Level 16, State 1, Line 1 The OLE DB provider ""MSDASQL"" for
> linked server ""LBLIVE"" supplied inconsistent metadata. An extra column
> was supplied during execution that was not found at compile time.

Also, some views I cannot even create because I get the following...

> Msg 7315, Level 16, State 1, Line 1 The OLE DB provider ""MSDASQL"" for
> linked server ""LBLIVE"" contains multiple tables that match the name
> """"SYSDBA"".""AUDIT_LBABKP"""".

Although there is only one of the tables mentioned.

The alternative approach from searching the net seems to be more like...

    SELECT *
    FROM OPENQUERY(<linked sevrer>, 'SELECT <column list> FROM MyTable')

So, my question is, if I use OPENQUERY in my view definition will SQL Server be able to optimise the resulting SQL being sent to Interbase? Or is there really not much difference between the two approaches?






",3
681282,03/25/2009 12:08:11,209,08/03/2008 13:54:19,1259,54,"How come the message ""Table is marked for deletion"" keeps appearing?","Using SQL Server 2008 and I'm doing some schema construction in the Management Studio designer.

I created a table early in the process called ""Animal"", but then decided to delete shortly after. I deleted it via the tree view in Management Studio (right-click delete).

Now I'm late in the process, I would like to recreate the table ""Animal"" but with different fields.

The second time round with Animal gets created fine, but when I try to add the table to my diagram I get the message ""Table 'Animal' is marked for deletion, can't be added to the diagram or opened in the table designer"".

What's the deal? How can I use this table normally again and not suffer from older table naming conflicts?

Alternatively, if the table is marked for deletion, can I actually invoke deletion somehow? Then recreate another table with the same name.

This is a little annoying. Would appreciate any help.

",sql-server,database,microsoft,,,,open,0,148,11,"How come the message ""Table is marked for deletion"" keeps appearing? Using SQL Server 2008 and I'm doing some schema construction in the Management Studio designer.

I created a table early in the process called ""Animal"", but then decided to delete shortly after. I deleted it via the tree view in Management Studio (right-click delete).

Now I'm late in the process, I would like to recreate the table ""Animal"" but with different fields.

The second time round with Animal gets created fine, but when I try to add the table to my diagram I get the message ""Table 'Animal' is marked for deletion, can't be added to the diagram or opened in the table designer"".

What's the deal? How can I use this table normally again and not suffer from older table naming conflicts?

Alternatively, if the table is marked for deletion, can I actually invoke deletion somehow? Then recreate another table with the same name.

This is a little annoying. Would appreciate any help.

",3
11262340,06/29/2012 13:04:35,283422,03/01/2010 06:32:31,210,4,How to use SQL Server Procedure in Oracle,I have lot of procedures (more than 3000) created using SQL Server 2008.Now my client required oracle support.Whether same can be implement in Oracle or is there any other modification required.,sql-server,oracle,,,,07/02/2012 03:04:15,not a real question,1,31,8,How to use SQL Server Procedure in Oracle I have lot of procedures (more than 3000) created using SQL Server 2008.Now my client required oracle support.Whether same can be implement in Oracle or is there any other modification required.,2
11251532,06/28/2012 19:26:27,1489580,06/28/2012 19:20:59,1,0,SQL UNION without using the individual column names,"I want to take the union of two tables. They both have unequal number of columns and some of them are in common and some are not.

How would i take its union them without using the individual column names (inserting dummy columns in between). 

I have to query and take the union of couple of tables and would be testing on different databases, which would have different column names for the same table. 
Hence, i could not use the common way of addressing the individual column names and inserting dummy columns to get the union.

Thanks,
gokul.",sql-server,,,,,06/29/2012 03:09:05,too localized,1,95,8,"SQL UNION without using the individual column names I want to take the union of two tables. They both have unequal number of columns and some of them are in common and some are not.

How would i take its union them without using the individual column names (inserting dummy columns in between). 

I have to query and take the union of couple of tables and would be testing on different databases, which would have different column names for the same table. 
Hence, i could not use the common way of addressing the individual column names and inserting dummy columns to get the union.

Thanks,
gokul.",1
9298717,02/15/2012 18:01:36,395255,01/28/2010 09:25:14,885,26,Composite foreign key in SQL Server,"I have a table named Books which contains 3 columns.

    TableName: Books
    Columns: BookId (PK), BookName, Book_Publisher_XRef_Id (FK), IsInternal

I have 2 tables that contains publisher information

    TableName: InternalPublishers
    Columns: PublisherId (PK), PublisherName, ....

    TableName: ExternalPublishers
    Columns: PublisherId (PK), PublisherName, ....

I have a link table that contains information about which book belongs to which publisher. One book can have multple publishers.

    TableName: Books_Publishers_XRef
    Columns: Book_Publisher_XRef_Id (PK), PublisherId

If i want to create a Foreign Key constraint on PublisherId, i need to create sort of Composite Foreign Key constraint which i am not sure can be created.

So in this scenario, what is the best way to achieve FK on PublisherId in Books_Publishers_XRef table?

1) Break Books_Publishers_XRef table in 2 tables i.e. one for Internal Publishers and another one for External Publishers and have 2 columns in Books table for Books_Internal_Publishers_XRef and Books_External_Publishesr_XRef tables?

2) Dont create FK on Publisher_Id column and leave the design as it is?

3) Create composite FK by adding Publisher_Type_Id column in Books table and Books_Publishers_XRef table where if Publisher_Type_Id = 1, it belongs to Internal_Publishers table and Publisher_Type_Id = 2, it belongs to External_Publishers table ? (Not sure if this is possible)

4) Some other schema design?

Please advice.
",sql-server,database,sql-server-2005,database-design,table,,open,0,220,6,"Composite foreign key in SQL Server I have a table named Books which contains 3 columns.

    TableName: Books
    Columns: BookId (PK), BookName, Book_Publisher_XRef_Id (FK), IsInternal

I have 2 tables that contains publisher information

    TableName: InternalPublishers
    Columns: PublisherId (PK), PublisherName, ....

    TableName: ExternalPublishers
    Columns: PublisherId (PK), PublisherName, ....

I have a link table that contains information about which book belongs to which publisher. One book can have multple publishers.

    TableName: Books_Publishers_XRef
    Columns: Book_Publisher_XRef_Id (PK), PublisherId

If i want to create a Foreign Key constraint on PublisherId, i need to create sort of Composite Foreign Key constraint which i am not sure can be created.

So in this scenario, what is the best way to achieve FK on PublisherId in Books_Publishers_XRef table?

1) Break Books_Publishers_XRef table in 2 tables i.e. one for Internal Publishers and another one for External Publishers and have 2 columns in Books table for Books_Internal_Publishers_XRef and Books_External_Publishesr_XRef tables?

2) Dont create FK on Publisher_Id column and leave the design as it is?

3) Create composite FK by adding Publisher_Type_Id column in Books table and Books_Publishers_XRef table where if Publisher_Type_Id = 1, it belongs to Internal_Publishers table and Publisher_Type_Id = 2, it belongs to External_Publishers table ? (Not sure if this is possible)

4) Some other schema design?

Please advice.
",5
145185,09/28/2008 04:03:05,17648,09/18/2008 13:08:11,-13,3,Best way to store tags in a sql server table?,"What's the best way to store tags for a record? Just use a varchar field? What about when selecting rows that contains tag x? Use the like operator?

thanks!",sql-server,tags,,,,,open,0,28,10,"Best way to store tags in a sql server table? What's the best way to store tags for a record? Just use a varchar field? What about when selecting rows that contains tag x? Use the like operator?

thanks!",2
9862308,03/25/2012 17:25:33,1259236,03/09/2012 11:59:58,1,0,Find Version Of MsSql Without Convert or Select,"Do you know another clause for finding version of MsSql without Select or Convert ? for example : Select @@version    or Convert(int,Version()) do you know another way ? our professor ask this question for homework but i cant find any clause . 
Thanks in advance ",sql-server,,,,,03/26/2012 08:50:00,not a real question,1,49,8,"Find Version Of MsSql Without Convert or Select Do you know another clause for finding version of MsSql without Select or Convert ? for example : Select @@version    or Convert(int,Version()) do you know another way ? our professor ask this question for homework but i cant find any clause . 
Thanks in advance ",1
6375979,06/16/2011 17:21:20,801989,06/16/2011 17:21:20,1,0,How to iterate a string and add string to every position ?,"I need something like this in TSQL

    string myString = ""123"";
    for (int i = 0;  i < myString.Length; i++)
    {
       myString.Insert(""ABC"", i);
    }
    Output ""ABC1ABC2ABC3""



",sql-server,tsql,,,,,open,0,48,12,"How to iterate a string and add string to every position ? I need something like this in TSQL

    string myString = ""123"";
    for (int i = 0;  i < myString.Length; i++)
    {
       myString.Insert(""ABC"", i);
    }
    Output ""ABC1ABC2ABC3""



",2
5229879,03/08/2011 08:04:54,649458,03/08/2011 08:04:54,1,0,whats the problem with this query ?,"Please redit thisquery if there are any problemin that :

    SELECT [travel], [service], [travelid], [fro_m], [t_o], [dep], [arr], [booking_closed], [discount], [faresleeper], [rating], [seats], [s_no], [fare] = CASE WHEN @date >= Cast(Convert(varchar(20),s1from,101) as datetime AND @date >= Cast(Convert(varchar(20),s1to,101) as datetime THEN s1rate ELSE fare END FROM a1_volvo WHERE  ( fro_m = @fro_m ) AND ( t_o = @t_o ) ",sql-server,sql-server-2005,,,,,open,0,63,7,"whats the problem with this query ? Please redit thisquery if there are any problemin that :

    SELECT [travel], [service], [travelid], [fro_m], [t_o], [dep], [arr], [booking_closed], [discount], [faresleeper], [rating], [seats], [s_no], [fare] = CASE WHEN @date >= Cast(Convert(varchar(20),s1from,101) as datetime AND @date >= Cast(Convert(varchar(20),s1to,101) as datetime THEN s1rate ELSE fare END FROM a1_volvo WHERE  ( fro_m = @fro_m ) AND ( t_o = @t_o ) ",2
10694894,05/22/2012 02:02:23,605213,02/06/2011 11:33:21,194,28,Find all leaf node records in ms sqlserver,"How would I go about querying for only records that are ""only leaf nodes""
(ie. no children)?

I have tried a query like this:

    select *
    from TableA tt
    where tt.HierarchyId.GetDescendant(null, null) not in 
    (
    	Select 	t.HierarchyId
    	from TableA t
    )


But this still seemed to return some nodes that had children.

I am using the built-in hierarchyid data type (part of ms sqlserver)",sql-server,sql-server-2008,microsoft,,,,open,0,82,8,"Find all leaf node records in ms sqlserver How would I go about querying for only records that are ""only leaf nodes""
(ie. no children)?

I have tried a query like this:

    select *
    from TableA tt
    where tt.HierarchyId.GetDescendant(null, null) not in 
    (
    	Select 	t.HierarchyId
    	from TableA t
    )


But this still seemed to return some nodes that had children.

I am using the built-in hierarchyid data type (part of ms sqlserver)",3
10955083,06/08/2012 19:38:41,1445294,06/08/2012 19:27:36,1,0,SQL server injects personal data into SQL or Back Up file?,"When i make SQL query file or backup file etc, will MS SQL Server inject personal info, file/folder structure info , System Information of my computer in that files ?
If i forget to tell you some other kind of information, please tell me if sql inject it into my files.

Thanks very much. ",sql-server,privacy,,,,06/09/2012 11:59:38,off topic,1,53,11,"SQL server injects personal data into SQL or Back Up file? When i make SQL query file or backup file etc, will MS SQL Server inject personal info, file/folder structure info , System Information of my computer in that files ?
If i forget to tell you some other kind of information, please tell me if sql inject it into my files.

Thanks very much. ",2
4725373,01/18/2011 14:43:05,117899,06/05/2009 10:24:17,222,8,Turning back from update on MS Sql Server,"There is any code fro backing from update on MS Sql Server. I mean without Triggers and logs.

KR,

Çağın",sql-server,tsql,,,,,open,0,18,8,"Turning back from update on MS Sql Server There is any code fro backing from update on MS Sql Server. I mean without Triggers and logs.

KR,

Çağın",2
8543709,12/17/2011 09:04:15,966862,09/27/2011 10:55:24,1,0,not able to connect cake php with mssql tables having schema,"I can not Connect cake php with mssql tables with schema.

I have added schema that tables are in mssql and now my program is not able to read the tables. 

How can I solve this issue? How can I connect cake php with mssql tables having schema
",sql-server,cakephp,schema,database-schema,,12/18/2011 14:23:49,not a real question,1,47,11,"not able to connect cake php with mssql tables having schema I can not Connect cake php with mssql tables with schema.

I have added schema that tables are in mssql and now my program is not able to read the tables. 

How can I solve this issue? How can I connect cake php with mssql tables having schema
",4
11006106,06/12/2012 23:05:15,250849,01/14/2010 15:56:27,543,26,Custom filter control for SQL Server Reporting Services 2012,"I'm building report in SQL Server Reporting Services 2012 and one of the requirements is to have custom filter/report parameter. It looks like tabs and when you select for example tab1 (which represent some value to be filtered by) its shows report filtered by that value.

Something like this: 
Type A | Type B | Type C

And then Report Data Set filtered by clause ""and Type = @TypeParam"".

Is it possible to do using standard tools provided by SSRS or no? How to build this using custom application?

Thanks!",sql-server,reporting-services,reporting,,,06/18/2012 03:34:31,not constructive,1,86,9,"Custom filter control for SQL Server Reporting Services 2012 I'm building report in SQL Server Reporting Services 2012 and one of the requirements is to have custom filter/report parameter. It looks like tabs and when you select for example tab1 (which represent some value to be filtered by) its shows report filtered by that value.

Something like this: 
Type A | Type B | Type C

And then Report Data Set filtered by clause ""and Type = @TypeParam"".

Is it possible to do using standard tools provided by SSRS or no? How to build this using custom application?

Thanks!",3
11114998,06/20/2012 07:45:12,1387089,05/10/2012 12:32:05,6,0,Database insertion throught xslt script,"I have an xml response, which I want to store into the database (SQL Server 2008) through XSLT script. This is i m using in Asp.net/mvc3

Any idea please share

Thanks",sql-server,asp.net-mvc-3,xslt,,,06/20/2012 12:39:46,not a real question,1,29,5,"Database insertion throught xslt script I have an xml response, which I want to store into the database (SQL Server 2008) through XSLT script. This is i m using in Asp.net/mvc3

Any idea please share

Thanks",3
7309719,09/05/2011 14:54:34,192204,10/19/2009 03:57:14,695,5,Can you scale SQL Server to handle 100's of Terabytes?,"One of my colleagues told me the other day SQL Server wasn't designed to handle Terabytes of data.....that could possibly be true for SQL 2000 or any DB 10 years ago, but I don't believe that to be the case today.  How have others approached the situations where they need to store massive amounts of data (100 + Terabytes)? Growing one Single server is probably not the option, but I would think we could partition the data across many smaller servers and use views, etc to allow us to make one query call across the servers.  Any idea how concurrency, etc performs in a model like this where data is Horizontally Partitioned across servers?

Any suggestions / comments is greatly appreciated.

Thanks,

S",sql-server,sql-server-2008-r2,,,,09/05/2011 15:26:30,not constructive,1,122,10,"Can you scale SQL Server to handle 100's of Terabytes? One of my colleagues told me the other day SQL Server wasn't designed to handle Terabytes of data.....that could possibly be true for SQL 2000 or any DB 10 years ago, but I don't believe that to be the case today.  How have others approached the situations where they need to store massive amounts of data (100 + Terabytes)? Growing one Single server is probably not the option, but I would think we could partition the data across many smaller servers and use views, etc to allow us to make one query call across the servers.  Any idea how concurrency, etc performs in a model like this where data is Horizontally Partitioned across servers?

Any suggestions / comments is greatly appreciated.

Thanks,

S",2
4050639,10/29/2010 09:34:31,85584,04/01/2009 10:06:21,68,9,Sql sever fulltext search does not return all the results,"
I tried to use full text search for a table called ""Business"" in Sql sever 2008 here is the statement(the search term is in chinese)

    select * from Business biz where CONTAINS(biz.*,'家具')

And the I use like statement to do the same 

    select * from Business where Name like '%家具%'

The Fulltext searc returns 8 results and the like search returns 9 results which is what I expected. Does anyone know what might cause this?",sql-server,sql-server-2008,full-text-search,,,,open,0,80,10,"Sql sever fulltext search does not return all the results 
I tried to use full text search for a table called ""Business"" in Sql sever 2008 here is the statement(the search term is in chinese)

    select * from Business biz where CONTAINS(biz.*,'家具')

And the I use like statement to do the same 

    select * from Business where Name like '%家具%'

The Fulltext searc returns 8 results and the like search returns 9 results which is what I expected. Does anyone know what might cause this?",3
6574572,07/04/2011 17:43:33,140939,07/19/2009 11:32:11,390,30,Best proven ways to improve search performance,"We are working on a website like www.justdial.com .
Every State has Districts which have Cities which have Categories and subcategories.

Kindly suggest proven ways to improve performance.",sql-server,,,,,07/04/2011 19:21:01,not a real question,1,26,7,"Best proven ways to improve search performance We are working on a website like www.justdial.com .
Every State has Districts which have Cities which have Categories and subcategories.

Kindly suggest proven ways to improve performance.",1
654624,03/17/2009 15:02:05,79015,03/17/2009 13:36:45,1,0,Setting up a Windows Server 2008 / SQL Server 2008 cluster,"As I mention in a [related question][1] about colocation vs renting web servers, I am considering setting up a web server cluster using four Mac Minis (Intel Core Duo) and Windows Server 2008.  The website I'm developing is database-driven and uses ASP.Net MVC with Microsoft SQL Server 2008.  I am completely inexperienced with setting up a web server, so I am only aware of but unfamiliar with technologies like Network Load Balancing and Failover Clustering.

Can somebody recommend an ideal way to configure these 4 servers together or enumerate my best options?  For instance, should only one machine contain the SQL Server database, or should I create an SQL cluster on top of my Windows Server 2008 cluster.  I would like to have a balance between reliability and performance, and I'm not sure what such a balance would look like concretely.  


  [1]: http://stackoverflow.com/questions/654448/setting-up-a-windows-2008-server-colocation-or-rental",sql-server,windows-server-2008,clustering,,,07/07/2012 14:50:07,off topic,1,149,11,"Setting up a Windows Server 2008 / SQL Server 2008 cluster As I mention in a [related question][1] about colocation vs renting web servers, I am considering setting up a web server cluster using four Mac Minis (Intel Core Duo) and Windows Server 2008.  The website I'm developing is database-driven and uses ASP.Net MVC with Microsoft SQL Server 2008.  I am completely inexperienced with setting up a web server, so I am only aware of but unfamiliar with technologies like Network Load Balancing and Failover Clustering.

Can somebody recommend an ideal way to configure these 4 servers together or enumerate my best options?  For instance, should only one machine contain the SQL Server database, or should I create an SQL cluster on top of my Windows Server 2008 cluster.  I would like to have a balance between reliability and performance, and I'm not sure what such a balance would look like concretely.  


  [1]: http://stackoverflow.com/questions/654448/setting-up-a-windows-2008-server-colocation-or-rental",3
4131299,11/09/2010 07:21:00,351509,05/27/2010 01:07:42,47,1,Crystal Reports/Sql Server displaying days of the month and hours,"I am wanting to display Employees as rows and Days for a given month as columns. The data will be hours the employee was on call for each day.
Currently my EmployeeTime table holds a start date/time and a end date/date. Sample data would be:

    EmployeeID StartTime EndTime
    1, 01/07/2010 08:00, 02/07/2010 01:00
    1, 04/07/2010 08:00, 06/07/2010 01:00
    2, 01/07/2010 23:00, 02/07/2010 10:00

The report would display as:

    EmployeeID, 1, 2, 3, 4, 5, 6, 7.....
    1, 16, 1, 0, 16, 24, 1, 0
    2, 1, 10, 0, 0, 0, 0, 0

Not sure if I should have SQL Server doing the work or using some sort of cross tab in Crystal Reports.

Greatly appreciate any help",sql-server,crystal-reports,,,,,open,0,134,10,"Crystal Reports/Sql Server displaying days of the month and hours I am wanting to display Employees as rows and Days for a given month as columns. The data will be hours the employee was on call for each day.
Currently my EmployeeTime table holds a start date/time and a end date/date. Sample data would be:

    EmployeeID StartTime EndTime
    1, 01/07/2010 08:00, 02/07/2010 01:00
    1, 04/07/2010 08:00, 06/07/2010 01:00
    2, 01/07/2010 23:00, 02/07/2010 10:00

The report would display as:

    EmployeeID, 1, 2, 3, 4, 5, 6, 7.....
    1, 16, 1, 0, 16, 24, 1, 0
    2, 1, 10, 0, 0, 0, 0, 0

Not sure if I should have SQL Server doing the work or using some sort of cross tab in Crystal Reports.

Greatly appreciate any help",2
7075120,08/16/2011 07:56:44,703785,04/12/2011 09:44:39,3,0,Error in moving Backup file,"I have created a backup file by SQL query like this :
> BackUp [DBName] to disk=N'Backup path'.

now i want to move it to another folder.but i recieve this error:

> Cannot copy 'Backup file name':Access is denied.
> Make sure the disk is not full or write-protected 
> and that the file is not currently in use.

Note : i am sure that my disk is not full and not write-protected for my user.",sql-server,file,backup,,,11/16/2011 10:08:15,off topic,1,71,5,"Error in moving Backup file I have created a backup file by SQL query like this :
> BackUp [DBName] to disk=N'Backup path'.

now i want to move it to another folder.but i recieve this error:

> Cannot copy 'Backup file name':Access is denied.
> Make sure the disk is not full or write-protected 
> and that the file is not currently in use.

Note : i am sure that my disk is not full and not write-protected for my user.",3
785541,04/24/2009 11:57:29,95446,04/24/2009 11:57:29,1,0,SQL Server 2005 support for Oracle-style autonmous transaction,"Within a transaction is there a way to have data committed within it even though the transaction is rolled back? We're writing audit/logging information inside a transaction but we want to keep that information even though the transaction has to roll back.

We've see an [article][1] that tries to copy the Oracle way but what we're really looking for is some in-built SQL Server support (and was hoping for something like a 'not supported' option for a sproc or a 'suspend transaction' command.) Google searches have been a bit hopeless hence this post.


  [1]: http://www.c-sharpcorner.com/UploadFile/john_charles/SimulatingautonomoustransactionsinMicrosoftSQLServer10092008132945PM/SimulatingautonomoustransactionsinMicrosoftSQLServer.aspx",sql-server,transactions,,,,,open,0,95,8,"SQL Server 2005 support for Oracle-style autonmous transaction Within a transaction is there a way to have data committed within it even though the transaction is rolled back? We're writing audit/logging information inside a transaction but we want to keep that information even though the transaction has to roll back.

We've see an [article][1] that tries to copy the Oracle way but what we're really looking for is some in-built SQL Server support (and was hoping for something like a 'not supported' option for a sproc or a 'suspend transaction' command.) Google searches have been a bit hopeless hence this post.


  [1]: http://www.c-sharpcorner.com/UploadFile/john_charles/SimulatingautonomoustransactionsinMicrosoftSQLServer10092008132945PM/SimulatingautonomoustransactionsinMicrosoftSQLServer.aspx",2
11569748,07/19/2012 21:39:51,65214,02/11/2009 18:17:33,697,32,Service Broker: Queue Monitor is dropped after poison message,"I have searched everywhere and there isn't an answer online. There is one similar question but it's not exactly the same on stack overflow without an answer. 

When I setup event notification on a queue, it creates a queue monitor and if receiving a message from that queue causes a poison message the queue monitor disappears. It's not in ""RECEIVE"" or ""INACTIVE"" it's just drops. And after enabling the queue with `ALTER QUEUE somequeue WITH STATUS = ON;` the queue monitor does not re-appear and and I need to drop and recreate event notification in order to have event notification working again. 


So the question is, is that by design or not? And after I re-enable the queue after poison message is it a common practice to recreate event notifications. 

Thanks!",sql-server,sql-server-2008,service-broker,,,07/20/2012 01:50:51,off topic,1,131,9,"Service Broker: Queue Monitor is dropped after poison message I have searched everywhere and there isn't an answer online. There is one similar question but it's not exactly the same on stack overflow without an answer. 

When I setup event notification on a queue, it creates a queue monitor and if receiving a message from that queue causes a poison message the queue monitor disappears. It's not in ""RECEIVE"" or ""INACTIVE"" it's just drops. And after enabling the queue with `ALTER QUEUE somequeue WITH STATUS = ON;` the queue monitor does not re-appear and and I need to drop and recreate event notification in order to have event notification working again. 


So the question is, is that by design or not? And after I re-enable the queue after poison message is it a common practice to recreate event notifications. 

Thanks!",3
1802285,11/26/2009 08:27:41,122677,06/14/2009 08:16:03,38,1,How to incease transaction log manually in sql server 2005?,"in my sql 2005 , 10 MB of disk space will be allocated for transaction logs.

I wand to incease this 10MB to more ... Where is the option for increase this size manually in sql 2005?

hoping ur response,",sql-server,,,,,,open,0,38,10,"How to incease transaction log manually in sql server 2005? in my sql 2005 , 10 MB of disk space will be allocated for transaction logs.

I wand to incease this 10MB to more ... Where is the option for increase this size manually in sql 2005?

hoping ur response,",1
8559452,12/19/2011 09:43:38,329032,04/29/2010 15:10:39,11,0,MS SQL Server IDE which displays valid values (i.e. primary key values) in foreign key column when editing data,"I know that in 'PL SQL Developer IDE' (by AllRoundAutomations) whenever I try to enter a value in a table in the foreign key column, it shows a drop down with the primary key values from the referenced table. 
I can quickly pick one without querying the referencing primary key table, and this is awesome.
This makes editing table data a breeze.

I miss this 'feature' in any of the MS SQL Server IDE's (including Toad and Microsoft management console). 
Please tell me if this feature exist's in any of the mainstream IDE's you have used.

I understand this is a nicety of the IDE and in no way is a feature of the database itself. 

I appreciate any pointers... (perhaps to simulate this behavior on my own also)....thank you...",sql-server,ide,plsql,plsqldeveloper,,12/19/2011 13:48:55,off topic,1,127,19,"MS SQL Server IDE which displays valid values (i.e. primary key values) in foreign key column when editing data I know that in 'PL SQL Developer IDE' (by AllRoundAutomations) whenever I try to enter a value in a table in the foreign key column, it shows a drop down with the primary key values from the referenced table. 
I can quickly pick one without querying the referencing primary key table, and this is awesome.
This makes editing table data a breeze.

I miss this 'feature' in any of the MS SQL Server IDE's (including Toad and Microsoft management console). 
Please tell me if this feature exist's in any of the mainstream IDE's you have used.

I understand this is a nicety of the IDE and in no way is a feature of the database itself. 

I appreciate any pointers... (perhaps to simulate this behavior on my own also)....thank you...",4
6750603,07/19/2011 16:26:46,809152,06/21/2011 19:43:22,9,0,sqlexpress vs sql-server performance,"Working with single user.
The duration in sqlexpress is much much worse than sql-server. any idea?

Ps. same data. same machine.
Thank you",sql-server,sql-server-express,,,,07/19/2011 17:33:09,not a real question,1,20,4,"sqlexpress vs sql-server performance Working with single user.
The duration in sqlexpress is much much worse than sql-server. any idea?

Ps. same data. same machine.
Thank you",2
8837990,01/12/2012 15:51:56,651789,03/09/2011 15:05:27,229,17,VS2008: Generate change script for stored procedure,"I'm using Visual Studio 2008 and MS SQL Server 2005. When I alter a database table in the VS IDE, I have the option to **Generate Change Script...** which creates a change script in my database project. This script can then be ran to keep databases up to date with development.

When I modify a database stored procedure in the VS IDE, I see no similar option. Am I missing something? Is it an acceptable solution to simply copy the **ALTER PROCEDURE** text to a file in the **Change Scripts** directory?",sql-server,visual-studio,sql-server-2005,visual-studio-2008,,,open,0,90,7,"VS2008: Generate change script for stored procedure I'm using Visual Studio 2008 and MS SQL Server 2005. When I alter a database table in the VS IDE, I have the option to **Generate Change Script...** which creates a change script in my database project. This script can then be ran to keep databases up to date with development.

When I modify a database stored procedure in the VS IDE, I see no similar option. Am I missing something? Is it an acceptable solution to simply copy the **ALTER PROCEDURE** text to a file in the **Change Scripts** directory?",4
6315208,06/11/2011 09:45:58,230,08/03/2008 19:32:46,5388,64,Restoring a database on SQL Server 2008,"I am trying to restore a database using the Management Studio GUI, and I am getting the following error.

> The media family on device
> 'F:\xxx.bak' is incorrectly formed.
> SQL Server cannot process this media
> family. RESTORE HEADERONLY is
> terminating abnormally. (Microsoft SQL
> Server, Error: 3241)

I'm pretty certain this bak file has been used before to restore the database, but the `RESTORE` command was used. Iv looked at the [docs][1] but am find them a little terse.

Could anyone suggest what the sql might look like for me to successfully restore this db?


  [1]: http://msdn.microsoft.com/en-us/library/ms186858.aspx",sql-server,restore,,,,06/12/2011 23:16:16,off topic,1,94,7,"Restoring a database on SQL Server 2008 I am trying to restore a database using the Management Studio GUI, and I am getting the following error.

> The media family on device
> 'F:\xxx.bak' is incorrectly formed.
> SQL Server cannot process this media
> family. RESTORE HEADERONLY is
> terminating abnormally. (Microsoft SQL
> Server, Error: 3241)

I'm pretty certain this bak file has been used before to restore the database, but the `RESTORE` command was used. Iv looked at the [docs][1] but am find them a little terse.

Could anyone suggest what the sql might look like for me to successfully restore this db?


  [1]: http://msdn.microsoft.com/en-us/library/ms186858.aspx",2
520967,02/06/2009 16:21:45,12597,09/16/2008 14:53:25,875,53,"SQL Server: Database stuck in ""Restoring"" state","i backed up a data:

    BACKUP DATABASE MyDatabase
    TO DISK = 'MyDatabase.bak'
    WITH INIT --overwrite existing

And then tried to restore it:

    RESTORE DATABASE MyDatabase
       FROM DISK = 'MyDatabase.bak'
       WITH REPLACE --force restore over specified database

And now the database is stuck in the restoring state.

Some people have theorized that it's because there was no log file in the backup, and it needed to be rolled forward using:

    RESTORE DATABASE MyDatabase
    WITH RECOVERY 

Except that, of course, fails:

    Msg 4333, Level 16, State 1, Line 1
    The database cannot be recovered because the log was not restored.
    Msg 3013, Level 16, State 1, Line 1
    RESTORE DATABASE is terminating abnormally.


And exactly what you want in a catastrophic situation is a restore that won't work.


----------

The backup contains both a data and log file:

    RESTORE FILELISTONLY 
    FROM DISK = 'MyDatabase.bak'

    Logical Name    PhysicalName
    =============   ===============
    MyDatabase	  C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\MyDatabase.mdf
    MyDatabase_log  C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\MyDatabase_log.LDF",sql-server,restore,backup,,,,open,0,219,7,"SQL Server: Database stuck in ""Restoring"" state i backed up a data:

    BACKUP DATABASE MyDatabase
    TO DISK = 'MyDatabase.bak'
    WITH INIT --overwrite existing

And then tried to restore it:

    RESTORE DATABASE MyDatabase
       FROM DISK = 'MyDatabase.bak'
       WITH REPLACE --force restore over specified database

And now the database is stuck in the restoring state.

Some people have theorized that it's because there was no log file in the backup, and it needed to be rolled forward using:

    RESTORE DATABASE MyDatabase
    WITH RECOVERY 

Except that, of course, fails:

    Msg 4333, Level 16, State 1, Line 1
    The database cannot be recovered because the log was not restored.
    Msg 3013, Level 16, State 1, Line 1
    RESTORE DATABASE is terminating abnormally.


And exactly what you want in a catastrophic situation is a restore that won't work.


----------

The backup contains both a data and log file:

    RESTORE FILELISTONLY 
    FROM DISK = 'MyDatabase.bak'

    Logical Name    PhysicalName
    =============   ===============
    MyDatabase	  C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\MyDatabase.mdf
    MyDatabase_log  C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA\MyDatabase_log.LDF",3
3946360,10/15/2010 21:41:38,1284823,10/01/2009 15:31:47,191,2,Has Red Gate made any decision yet on if they will soon support GIT with Sql Source Control,Has Red Gate made any decision yet on if they will soon support GIT with Sql Source Control.  GIT is becoming the defacto source control standard and I would hate to have to support GIT and SVN in order to use this slick RG product,sql-server,redgate,,,,10/16/2010 01:39:55,off topic,1,46,18,Has Red Gate made any decision yet on if they will soon support GIT with Sql Source Control Has Red Gate made any decision yet on if they will soon support GIT with Sql Source Control.  GIT is becoming the defacto source control standard and I would hate to have to support GIT and SVN in order to use this slick RG product,2
4030328,10/27/2010 05:52:31,303726,03/28/2010 19:00:05,115,7,SQL Server 2005 - SSIS validation error server-side only,"I am deploying some integration services into a SQL Server 2005. On my computer, I don't have any validation error but I do on the server.

It comes from an OLE DB connection manager: ""Login failed for user 'username'"". Whereas I can fully run it on a client, the connection works perfectly.

This is a connection to the server itself.",sql-server,business-intelligence,dts,ssis,,,open,0,58,9,"SQL Server 2005 - SSIS validation error server-side only I am deploying some integration services into a SQL Server 2005. On my computer, I don't have any validation error but I do on the server.

It comes from an OLE DB connection manager: ""Login failed for user 'username'"". Whereas I can fully run it on a client, the connection works perfectly.

This is a connection to the server itself.",4
3675338,09/09/2010 09:28:38,106261,05/13/2009 12:31:38,232,26,"Sql server transaction log, dbcc not really useful, ldf file not accessible, don't want to install 3rd party software","I'm trying to track down why a db query got screwed in ms sql server (just the one time)

dbcc log(mydb,2) not filterable by date(?). And the ldf file I can't access directly without going through 2 layers of bureaucracy

Any suggestions welcomed ideas ?  Other than installing some 3rd party propriety log file viewer.
",sql-server,logging,transactions,,,,open,0,54,19,"Sql server transaction log, dbcc not really useful, ldf file not accessible, don't want to install 3rd party software I'm trying to track down why a db query got screwed in ms sql server (just the one time)

dbcc log(mydb,2) not filterable by date(?). And the ldf file I can't access directly without going through 2 layers of bureaucracy

Any suggestions welcomed ideas ?  Other than installing some 3rd party propriety log file viewer.
",3
11359426,07/06/2012 09:24:24,102719,05/07/2009 07:46:13,550,14,"SQL Server named instance - can connect remotely, but not locally","I have an instance of SQL Server on my machine.

Machine: Bert01
SQL Server instance: Bert2008

I connect to it using SSMS putting Bert01\Bert2008 in the Server name box, using sa and the <password>.

When I remote desktop to a server, open SSMS and use the connection details above, ie connecting back to my own dev machine, it works. SSMS connects, and I can see databases, browse them, and run queries.

When I open SSMS on my local machine, I get the following message :-

> Connect to Server Cannot connect to Bert01\Bert2008.
> 
> Additional information:
> 
> A network-related or instance-specific error occurred while
> establishing a connection to SQL Server. The server was not found or
> was not accessible. Verify that the instance name is correct and that
> SQL Server is configured to allow remote connections. (provider: TCP
> Provider, error: 0 - No connection could be made because the target
> machine actively refused it.) (Microsoft SQL Server, ErrorL 10061)

At the moment I have only tried connecting remotely, which works.

This has only happened late in the afternoon yesterday while I was debugging an app in VB6 (stop sniggering).

SQL Server @@Version running on my dev machine:-

Microsoft SQL Server 2008 R2 (RTM) - 10.50.1617.0 (Intel X86)   Apr 22 2011 11:57:00   Copyright (c) Microsoft Corporation  Express Edition with Advanced Services on Windows NT 5.1 <X86> (Build 2600: Service Pack 3) ",sql-server,sql-server-2008,,,,07/10/2012 19:22:11,off topic,1,226,11,"SQL Server named instance - can connect remotely, but not locally I have an instance of SQL Server on my machine.

Machine: Bert01
SQL Server instance: Bert2008

I connect to it using SSMS putting Bert01\Bert2008 in the Server name box, using sa and the <password>.

When I remote desktop to a server, open SSMS and use the connection details above, ie connecting back to my own dev machine, it works. SSMS connects, and I can see databases, browse them, and run queries.

When I open SSMS on my local machine, I get the following message :-

> Connect to Server Cannot connect to Bert01\Bert2008.
> 
> Additional information:
> 
> A network-related or instance-specific error occurred while
> establishing a connection to SQL Server. The server was not found or
> was not accessible. Verify that the instance name is correct and that
> SQL Server is configured to allow remote connections. (provider: TCP
> Provider, error: 0 - No connection could be made because the target
> machine actively refused it.) (Microsoft SQL Server, ErrorL 10061)

At the moment I have only tried connecting remotely, which works.

This has only happened late in the afternoon yesterday while I was debugging an app in VB6 (stop sniggering).

SQL Server @@Version running on my dev machine:-

Microsoft SQL Server 2008 R2 (RTM) - 10.50.1617.0 (Intel X86)   Apr 22 2011 11:57:00   Copyright (c) Microsoft Corporation  Express Edition with Advanced Services on Windows NT 5.1 <X86> (Build 2600: Service Pack 3) ",2
5098863,02/23/2011 23:57:52,631328,02/23/2011 23:41:15,1,0,Mongo DB with NOrm vs SQL Server 2008 R2 with linqToSQL in ASP.NET MVC 3,do you have any experience with mongo db and NOrm in asp.net mvc? i have read that mongo is faster than sql server 2008. I know that mongo is schema free and i can use the type List. Why do I have to continue to choose sql server? mongo db appear more fast and more flexible,sql-server,asp.net-mvc,linq-to-sql,mongodb,norm,02/24/2011 02:44:34,not constructive,1,56,15,Mongo DB with NOrm vs SQL Server 2008 R2 with linqToSQL in ASP.NET MVC 3 do you have any experience with mongo db and NOrm in asp.net mvc? i have read that mongo is faster than sql server 2008. I know that mongo is schema free and i can use the type List. Why do I have to continue to choose sql server? mongo db appear more fast and more flexible,5
11260491,06/29/2012 10:53:01,1472490,06/21/2012 14:53:53,1,0,Optimize insert and delete Operation large indexed mssql table,"Actually my problem is, I have table which is having 20 crore records,Every week i am going to delete around 50lac old records and inserting 40 to 50 new records into the table,then daily basis clients using my table extracting records based on some condition,

My requirement is how to optimize insert operation,Delete operation,and also select operation,
I created index also my table even though some of above operation taking to much time,

When insert,delete,select  records it took around 4 to 5 hours,  ",sql-server,,,,,06/29/2012 11:41:49,not a real question,1,83,9,"Optimize insert and delete Operation large indexed mssql table Actually my problem is, I have table which is having 20 crore records,Every week i am going to delete around 50lac old records and inserting 40 to 50 new records into the table,then daily basis clients using my table extracting records based on some condition,

My requirement is how to optimize insert operation,Delete operation,and also select operation,
I created index also my table even though some of above operation taking to much time,

When insert,delete,select  records it took around 4 to 5 hours,  ",1
1017177,06/19/2009 09:50:09,26414,10/09/2008 08:07:53,3858,178,SQL Server SELECT statements causing blocking,"We're using a SQL Server 2005 database (no row versioning) with a huge select statement, and we're seeing it block other statements from running (seen using `sp_who2`).  I didn't realise SELECT statements could cause blocking - is there anything I can do to mitigate this?",sql-server,blocking,performance,,,,open,0,46,6,"SQL Server SELECT statements causing blocking We're using a SQL Server 2005 database (no row versioning) with a huge select statement, and we're seeing it block other statements from running (seen using `sp_who2`).  I didn't realise SELECT statements could cause blocking - is there anything I can do to mitigate this?",3
11547407,07/18/2012 17:52:30,738999,05/05/2011 00:52:42,436,10,I need to run MSMQ message from stored procedure in SQL Server,What are my options in launching one single message to MSMQ from a storage procedure in SQL Server 2008?,sql-server,sql-server-2008,tsql,msmq,,07/18/2012 19:09:28,not a real question,1,19,12,I need to run MSMQ message from stored procedure in SQL Server What are my options in launching one single message to MSMQ from a storage procedure in SQL Server 2008?,4
6896812,08/01/2011 09:59:57,398713,07/22/2010 04:49:07,100,0,Homework - Getting DateTime in custom format in MS SQL,"How do I select a value from a `DateTime` column in the `DD-MM-YYYY HH:MI:SS` (HH is 24-hour) format?

P.S.: The return vale of the SELECT query can be any datatype.",sql-server,sql-server-2005,tsql,sql-server-2008,,,open,0,29,10,"Homework - Getting DateTime in custom format in MS SQL How do I select a value from a `DateTime` column in the `DD-MM-YYYY HH:MI:SS` (HH is 24-hour) format?

P.S.: The return vale of the SELECT query can be any datatype.",4
9484861,02/28/2012 15:35:20,136141,07/10/2009 08:41:48,4496,40,Is there any TSQL workbook with problems and answers?,"Is there any book that is ""problems and answers"" like structured to practice writing SQL queries for a given Db schemas?",sql-server,tsql,workbook,,,02/28/2012 16:13:47,off topic,1,21,9,"Is there any TSQL workbook with problems and answers? Is there any book that is ""problems and answers"" like structured to practice writing SQL queries for a given Db schemas?",3
8600847,12/22/2011 07:52:39,1111227,12/22/2011 07:21:25,1,0,Design custom field database with high degree of variety,"I'm designing a SaaS healthcare application to manage activities in multiple organizations. The admin of each organization is allowed to create custom fields for business concepts. 

Example: Patient of org X has attribute A and B while Patient of org Y has attribute M and N

After doing research, I find that there're a few considerable design approaches:

**Option 1**: have a BusinessObjectCustomField for each business table. Example for PatientCustomField

    
    OrgID,   CustomFieldID,   Value
    X,       A,               1
    X,       B,               2
    Y,       M,               3
    Y,       N,               4

**Option 2**: use a single table for each business object, but alter table when new custom field is added. As a result, num(column) ~ num(org) * num(average fields per org)

    PatientID    A      B      M      N
    1            1      2      NULL   NULL
    2            NULL   NULL   3      4

**Option 3**: use generic purpose columns to hold data. As a result, num(column) ~ max(fields per org)

    PatientID    Col1   Col2
    1            1      2
    2            3      4

**Option 4**: store custom data as XML

    PatientID    CustomField
    1            <custom><A>1</A><B>2</B></custom>
    2            <custom><M>3</M><N>4</N></custom>

My design priorities are:

 1. Good performance 
 2. Easy to code
 3. Space (since data will be a lot)

Which option should I choose? I know that MS SQL Server supports index for XML data, but does it provide equally good performance as relational indexing?

References:

 - http://stackoverflow.com/questions/1126783/what-are-design-patterns-to-support-custom-fields-in-an-application

 - http://stackoverflow.com/questions/2924027/db-design-to-store-custom-fields-for-a-table

 - http://stackoverflow.com/questions/1600811/implementing-and-indexing-user-defined-fields-in-an-sql-db",sql-server,xml,database,custom-attributes,,,open,0,467,9,"Design custom field database with high degree of variety I'm designing a SaaS healthcare application to manage activities in multiple organizations. The admin of each organization is allowed to create custom fields for business concepts. 

Example: Patient of org X has attribute A and B while Patient of org Y has attribute M and N

After doing research, I find that there're a few considerable design approaches:

**Option 1**: have a BusinessObjectCustomField for each business table. Example for PatientCustomField

    
    OrgID,   CustomFieldID,   Value
    X,       A,               1
    X,       B,               2
    Y,       M,               3
    Y,       N,               4

**Option 2**: use a single table for each business object, but alter table when new custom field is added. As a result, num(column) ~ num(org) * num(average fields per org)

    PatientID    A      B      M      N
    1            1      2      NULL   NULL
    2            NULL   NULL   3      4

**Option 3**: use generic purpose columns to hold data. As a result, num(column) ~ max(fields per org)

    PatientID    Col1   Col2
    1            1      2
    2            3      4

**Option 4**: store custom data as XML

    PatientID    CustomField
    1            <custom><A>1</A><B>2</B></custom>
    2            <custom><M>3</M><N>4</N></custom>

My design priorities are:

 1. Good performance 
 2. Easy to code
 3. Space (since data will be a lot)

Which option should I choose? I know that MS SQL Server supports index for XML data, but does it provide equally good performance as relational indexing?

References:

 - http://stackoverflow.com/questions/1126783/what-are-design-patterns-to-support-custom-fields-in-an-application

 - http://stackoverflow.com/questions/2924027/db-design-to-store-custom-fields-for-a-table

 - http://stackoverflow.com/questions/1600811/implementing-and-indexing-user-defined-fields-in-an-sql-db",4
11740321,07/31/2012 12:42:04,1001495,10/18/2011 15:37:10,132,1,Creating asymmetric key - key already exists error,"I am attempting to create a SQL server function using a .dll as well as create a login that can be mapped to the assembly that has external access. I am using SQL Server 2005.  This is what I am doing:

    USE master; 
    GO  
     
    CREATE ASYMMETRIC KEY myKeyName FROM EXECUTABLE FILE = 'path\to\file\sqlclr.dll'   
    CREATE LOGIN myKeyUser FROM ASYMMETRIC KEY myKeyName 
    GRANT EXTERNAL ACCESS ASSEMBLY TO myKeyUser ; 
    GO 

I am getting the error :  ""An asymmetric key with name 'myKeyName ' already exists or this asymmetric key already has been added to the database.""

No matter what I change my key name to I get this error. 
I've read that creating an asymmetric key from an assembly that has already been used to create a key on the database will result in this error however I'm not sure if this is the case as I have been getting this error since my first attempt at creating the key and login. 

If it is an issue with a key already existing that used my assembly how would I be able to find and remove it? Since the name could be different I would have to find it via the assembly used to create it wouldn't I? I'm not finding much out there about this error. Any advice about how to resolve this would be very much appreciated. Thanks!",sql-server,sql-server-2005,,,,,open,0,259,8,"Creating asymmetric key - key already exists error I am attempting to create a SQL server function using a .dll as well as create a login that can be mapped to the assembly that has external access. I am using SQL Server 2005.  This is what I am doing:

    USE master; 
    GO  
     
    CREATE ASYMMETRIC KEY myKeyName FROM EXECUTABLE FILE = 'path\to\file\sqlclr.dll'   
    CREATE LOGIN myKeyUser FROM ASYMMETRIC KEY myKeyName 
    GRANT EXTERNAL ACCESS ASSEMBLY TO myKeyUser ; 
    GO 

I am getting the error :  ""An asymmetric key with name 'myKeyName ' already exists or this asymmetric key already has been added to the database.""

No matter what I change my key name to I get this error. 
I've read that creating an asymmetric key from an assembly that has already been used to create a key on the database will result in this error however I'm not sure if this is the case as I have been getting this error since my first attempt at creating the key and login. 

If it is an issue with a key already existing that used my assembly how would I be able to find and remove it? Since the name could be different I would have to find it via the assembly used to create it wouldn't I? I'm not finding much out there about this error. Any advice about how to resolve this would be very much appreciated. Thanks!",2
6161287,05/28/2011 11:13:33,751826,05/13/2011 05:44:48,30,1,How to apply multiiple join on 4 tables using Storred procedure in asp.net,"On showbutton_click a grid view is displayed with shows all data in a grid.
please tell me on my procedure. Thanks in advance...

i have 4 table

Master_employee_Info
{ 
EmployeeCode   nvarchar(50),primary key
EmployeeName   nvarchar(100),
EmployeeDesig	int,foreign key
EmployeeDept	int,foreign key
EmployeeLoc	int,foreign key
EmployeePhone	nvarchar(50),
EmployeeEmail	nvarchar(50),
EmployeeMode	Bit
}
	
Designation_master
{
Desig_ID int, primary key
Designation nvarchar(50)
}

Location_Master
{
Loc_ID int, primary key
Location nvarchar(50)
}

Department_master
{
Dept_ID int, primary key
Deptartment nvarchar(50)
}


}

Create PROCEDURE [dbo].[sp_showDetail]

AS
BEGIN
SELECT 
Employee_Info.Employee_Code,
Employee_Info.Employee_Name,
Designation_Master.Designation,
Department_Master.Department,
Location_Master.Location,
Employee_Info.Employee_Phone,
Employee_Info.Employee_Email,
Employee_Info.Employee_Mode
from 
Employee_Info
INNER JOIN Designation_Master on Employee_Info.Employee_Designation=Designation_Master.Desig_ID AND
INNER JOIN Department_Master on Employee_Info.Employee_Department= Department_Master.Dept_ID AND
INNER JOIN Location_Master on Employee_Info.Employee_Location= Location_Master.Loc_ID ",sql-server,,,,,05/28/2011 15:01:53,not a real question,1,69,13,"How to apply multiiple join on 4 tables using Storred procedure in asp.net On showbutton_click a grid view is displayed with shows all data in a grid.
please tell me on my procedure. Thanks in advance...

i have 4 table

Master_employee_Info
{ 
EmployeeCode   nvarchar(50),primary key
EmployeeName   nvarchar(100),
EmployeeDesig	int,foreign key
EmployeeDept	int,foreign key
EmployeeLoc	int,foreign key
EmployeePhone	nvarchar(50),
EmployeeEmail	nvarchar(50),
EmployeeMode	Bit
}
	
Designation_master
{
Desig_ID int, primary key
Designation nvarchar(50)
}

Location_Master
{
Loc_ID int, primary key
Location nvarchar(50)
}

Department_master
{
Dept_ID int, primary key
Deptartment nvarchar(50)
}


}

Create PROCEDURE [dbo].[sp_showDetail]

AS
BEGIN
SELECT 
Employee_Info.Employee_Code,
Employee_Info.Employee_Name,
Designation_Master.Designation,
Department_Master.Department,
Location_Master.Location,
Employee_Info.Employee_Phone,
Employee_Info.Employee_Email,
Employee_Info.Employee_Mode
from 
Employee_Info
INNER JOIN Designation_Master on Employee_Info.Employee_Designation=Designation_Master.Desig_ID AND
INNER JOIN Department_Master on Employee_Info.Employee_Department= Department_Master.Dept_ID AND
INNER JOIN Location_Master on Employee_Info.Employee_Location= Location_Master.Loc_ID ",1
10841478,05/31/2012 21:22:13,88257,04/07/2009 18:57:14,61,7,can I use SSDT/BIDS/SSIS using SQL Server 2012 express?,"Ideally, I want to make SSDT/SSIS packages on my desktop PC that I can test and deploy to a production server environment.
On my PC I have:
Windows 7
Visual Studio 2008
Visual Studio 2010 (shell)
SQL Server Express 2012 (local dev copy of prod)
[supposedly] BIDS (Business Intelligence Development Studio) and SSDT (SQL SErver Data Tools) etc.

On my production server I have:
Windows Server 2008
SQL Server 2012
Visual Studio 2010 (shell)

I cannot load/run SSIS (SQL Server Integration Services) onto my machine because SQL Server express doesn't allow for it, as suggested by these articles:

http://support.microsoft.com/Default.aspx?id=963070

http://msdn.microsoft.com/en-us/library/cc645993.aspx#SSIS

And I am getting this error when trying to look at a ""package.dtsx"" file in VS:

> Microsoft Visual Studio is unable to load this document: To design
> Integration Services packages in SQL Server Data Tools (SSDT). SSDT
> has to be installed by one of these editions of SQL Server 2012:
> Standard. Enterprise. Developer, or Evaluation. To install SSDT, run
> SQL Server Setup and select SQL Server Data Tools.

When I run the SQL2012Express installer, it says SSDT is installed already.

Question #1: But why can't I just point a local VS2010/SSDT/SQL2012Express at my production SQL2012 environment? (Microsoft is getting their money legitimately!)

Question #2: I can get it to work on the production server, but isn't it bad form to develop on a production server? (and it complicates source control etc.)",sql-server,visual-studio-2010,ssis,sql-server-express,ssdt,,open,0,214,9,"can I use SSDT/BIDS/SSIS using SQL Server 2012 express? Ideally, I want to make SSDT/SSIS packages on my desktop PC that I can test and deploy to a production server environment.
On my PC I have:
Windows 7
Visual Studio 2008
Visual Studio 2010 (shell)
SQL Server Express 2012 (local dev copy of prod)
[supposedly] BIDS (Business Intelligence Development Studio) and SSDT (SQL SErver Data Tools) etc.

On my production server I have:
Windows Server 2008
SQL Server 2012
Visual Studio 2010 (shell)

I cannot load/run SSIS (SQL Server Integration Services) onto my machine because SQL Server express doesn't allow for it, as suggested by these articles:

http://support.microsoft.com/Default.aspx?id=963070

http://msdn.microsoft.com/en-us/library/cc645993.aspx#SSIS

And I am getting this error when trying to look at a ""package.dtsx"" file in VS:

> Microsoft Visual Studio is unable to load this document: To design
> Integration Services packages in SQL Server Data Tools (SSDT). SSDT
> has to be installed by one of these editions of SQL Server 2012:
> Standard. Enterprise. Developer, or Evaluation. To install SSDT, run
> SQL Server Setup and select SQL Server Data Tools.

When I run the SQL2012Express installer, it says SSDT is installed already.

Question #1: But why can't I just point a local VS2010/SSDT/SQL2012Express at my production SQL2012 environment? (Microsoft is getting their money legitimately!)

Question #2: I can get it to work on the production server, but isn't it bad form to develop on a production server? (and it complicates source control etc.)",5
7613149,09/30/2011 16:11:50,805622,06/19/2011 18:39:53,26,0,Is it possible to generate scripts from SQL 2008 to SQL 2008 express,"Is it possible to generate scripts from SQL server 2008 that can then be used in SQL express editions or is it not possible. I read it is not possible, but is there another way.",sql-server,sql-server-2008,,,,,open,0,35,13,"Is it possible to generate scripts from SQL 2008 to SQL 2008 express Is it possible to generate scripts from SQL server 2008 that can then be used in SQL express editions or is it not possible. I read it is not possible, but is there another way.",2
8835740,01/12/2012 13:21:16,1140663,01/10/2012 10:47:47,1,0,Use of Distinct & Order by in Sql Server 2008,"I wan to use distinct in a join query with order by. Distinct column and order by columns are different.
Please anyone suggest me the answer fast.......",sql-server,distinct,,,,01/12/2012 14:09:45,not a real question,1,26,10,"Use of Distinct & Order by in Sql Server 2008 I wan to use distinct in a join query with order by. Distinct column and order by columns are different.
Please anyone suggest me the answer fast.......",2
2321704,02/23/2010 21:05:19,115690,06/01/2009 23:08:37,237,8,Most useful SQL meta-queries,"I have a passion for *meta-queries*, by which I mean queries that answer questions *about* data rather than answering *with* data.

Before I get a lot of justified criticism, I do realize that the approach of meta-queries is not ideal, as eloquently described [here][1] for example. Nevertheless, I believe they do have their place. (So much so that I created a WinForms user control that supports parameterized meta-queries for SQL Server, Oracle, and MySql, and I describe extensively the design and use of this QueryPicker in a [three-part series][2] published on Simple-Talk.com.)

My motivation for using meta-queries:

 1. When I sit down with a new database and want to understand it, I probe with meta-queries. Most common are those that let me answer questions about fields and tables, such as ""What other tables have this 'xyz' field?"" or ""What tables have identity columns?"" or ""What are the keys for this table?""
 2. I regularly work with multiple database types (SQL Server, Oracle, MySql) and--practicing the great programming ideal of laziness--I do not want to have to look up or remember an arcane SQL recipe every time I need it. I want to point and click.

Sure there are other (better?) ways to get meta-information--*for a given database type*. SQL Server, particularly, provides SQL Server Management Studio. Oracle and MySql tools do not seem to provide the same usefulness. (I freely admit that I make this claim with my SQL-Server-leaning-view of the universe. :-) Even if they did, they would be be different--I want a uniform approach *across database types*.

---

So, finally, the question:
================
**What SQL Server, Oracle, or MySql meta-queries do *you* find useful?**

---

Summary Matrix
==========
This first view summarizes my collection thus far by *database type* (and, as I said, heavily weighted toward SQL Server).

<pre>
Query                            SQL Server    Oracle     MySql

DB Version                           yes        yes        yes
Databases with properties            yes                   yes
Databases with space usage           yes
National Language Support                       yes
Procedures and functions             yes                   yes
Primary keys                         yes                   yes
Primary to foreign keys              yes
Session Information/brief            yes
Session Information/details          yes
Session SET options                  yes
Users and Roles                      yes
Currently running statements         yes
Constraints                          yes
Indexes                              yes
Column info/brief                    yes        yes        yes
Column info/details                  yes        yes        yes
Object level details                 yes
Rows and space used                  yes
Row/column counts                    yes
Non-empty tables                     yes        yes        yes
Show table schema                    yes        yes
Seed/max values                      yes
</pre>

---

References By Database Type
==========

I have developed some of these meta-queries myself but many have come from community forums. This second view itemizes the source URLs where appropriate.


SQL Server
----------
<pre>
System Category
-----------------
    DB Version
    Databases with properties    http://www.mssqltips.com/tip.asp?tip=1033
    Databases with space usage   http://www.sqlservercentral.com/Forums/Topic261080-5-1.aspx
    Procedures and functions
    Primary keys                 http://databases.aspfaq.com/schema-tutorials/schema-how-do-i-show-all-the-primary-keys-in-a-database.html
    Primary to foreign keys      http://www.sqlservercentral.com/scripts/Miscellaneous/61481/
    Session Information/brief    http://www.sqlservercentral.com/blogs/glennberry/archive/2009/12/28/how-to-get-a-count-of-sql-connections-by-ip-address.aspx
    Session Information/details  http://www.mssqltips.com/tip.asp?tip=1817
    Session SET options
    Users and Roles              http://www.sqlservercentral.com/scripts/users/69379/
    Currently running statements http://www.sqlservercentral.com/articles/DMV/64425/
    Constraints
    Indexes                      http://www.sqlservercentral.com/scripts/Index+Management/63932/

Column Category
-----------------
    Column info/brief
    Column info/details

Table Category
-----------------
    Object level details
    Rows and space used          http://www.mssqltips.com/tip.asp?tip=1177
    Row/column counts
    Non-empty tables

DDL Category
-----------------
    Show table schema            http://www.sqlservercentral.com/scripts/Create+DDL+sql+statements/65863/

Data Category
-----------------
    Seed/max values
</pre>

Oracle
----------

<pre>
System Category
-----------------
    DB Version
    National Language Support

Column Category
-----------------
    Column info/brief
    Column info/details

Table Category
-----------------
    Non-empty tables

DDL Category
-----------------
    Show table schema
</pre>

MySql
----------

<pre>
System Category
-----------------
    DB Version
    Databases
    Procedures and functions
    Primary keys                 http://databases.aspfaq.com/schema-tutorials/schema-how-do-i-show-all-the-primary-keys-in-a-database.html

Column Category
-----------------
    Column info/brief
    Column info/details

DDL Category
-----------------
    Show table schema
</pre>


  [1]: http://www.sqlservercentral.com/blogs/chadmiller/archive/2010/02/16/the-t_2D00_sql-hammer.aspx
  [2]: http://www.simple-talk.com/dotnet/.net-tools/a-unified-approach-to-multi-database-query-templates/",sql-server,oracle,mysql,sql,query,,open,0,1239,4,"Most useful SQL meta-queries I have a passion for *meta-queries*, by which I mean queries that answer questions *about* data rather than answering *with* data.

Before I get a lot of justified criticism, I do realize that the approach of meta-queries is not ideal, as eloquently described [here][1] for example. Nevertheless, I believe they do have their place. (So much so that I created a WinForms user control that supports parameterized meta-queries for SQL Server, Oracle, and MySql, and I describe extensively the design and use of this QueryPicker in a [three-part series][2] published on Simple-Talk.com.)

My motivation for using meta-queries:

 1. When I sit down with a new database and want to understand it, I probe with meta-queries. Most common are those that let me answer questions about fields and tables, such as ""What other tables have this 'xyz' field?"" or ""What tables have identity columns?"" or ""What are the keys for this table?""
 2. I regularly work with multiple database types (SQL Server, Oracle, MySql) and--practicing the great programming ideal of laziness--I do not want to have to look up or remember an arcane SQL recipe every time I need it. I want to point and click.

Sure there are other (better?) ways to get meta-information--*for a given database type*. SQL Server, particularly, provides SQL Server Management Studio. Oracle and MySql tools do not seem to provide the same usefulness. (I freely admit that I make this claim with my SQL-Server-leaning-view of the universe. :-) Even if they did, they would be be different--I want a uniform approach *across database types*.

---

So, finally, the question:
================
**What SQL Server, Oracle, or MySql meta-queries do *you* find useful?**

---

Summary Matrix
==========
This first view summarizes my collection thus far by *database type* (and, as I said, heavily weighted toward SQL Server).

<pre>
Query                            SQL Server    Oracle     MySql

DB Version                           yes        yes        yes
Databases with properties            yes                   yes
Databases with space usage           yes
National Language Support                       yes
Procedures and functions             yes                   yes
Primary keys                         yes                   yes
Primary to foreign keys              yes
Session Information/brief            yes
Session Information/details          yes
Session SET options                  yes
Users and Roles                      yes
Currently running statements         yes
Constraints                          yes
Indexes                              yes
Column info/brief                    yes        yes        yes
Column info/details                  yes        yes        yes
Object level details                 yes
Rows and space used                  yes
Row/column counts                    yes
Non-empty tables                     yes        yes        yes
Show table schema                    yes        yes
Seed/max values                      yes
</pre>

---

References By Database Type
==========

I have developed some of these meta-queries myself but many have come from community forums. This second view itemizes the source URLs where appropriate.


SQL Server
----------
<pre>
System Category
-----------------
    DB Version
    Databases with properties    http://www.mssqltips.com/tip.asp?tip=1033
    Databases with space usage   http://www.sqlservercentral.com/Forums/Topic261080-5-1.aspx
    Procedures and functions
    Primary keys                 http://databases.aspfaq.com/schema-tutorials/schema-how-do-i-show-all-the-primary-keys-in-a-database.html
    Primary to foreign keys      http://www.sqlservercentral.com/scripts/Miscellaneous/61481/
    Session Information/brief    http://www.sqlservercentral.com/blogs/glennberry/archive/2009/12/28/how-to-get-a-count-of-sql-connections-by-ip-address.aspx
    Session Information/details  http://www.mssqltips.com/tip.asp?tip=1817
    Session SET options
    Users and Roles              http://www.sqlservercentral.com/scripts/users/69379/
    Currently running statements http://www.sqlservercentral.com/articles/DMV/64425/
    Constraints
    Indexes                      http://www.sqlservercentral.com/scripts/Index+Management/63932/

Column Category
-----------------
    Column info/brief
    Column info/details

Table Category
-----------------
    Object level details
    Rows and space used          http://www.mssqltips.com/tip.asp?tip=1177
    Row/column counts
    Non-empty tables

DDL Category
-----------------
    Show table schema            http://www.sqlservercentral.com/scripts/Create+DDL+sql+statements/65863/

Data Category
-----------------
    Seed/max values
</pre>

Oracle
----------

<pre>
System Category
-----------------
    DB Version
    National Language Support

Column Category
-----------------
    Column info/brief
    Column info/details

Table Category
-----------------
    Non-empty tables

DDL Category
-----------------
    Show table schema
</pre>

MySql
----------

<pre>
System Category
-----------------
    DB Version
    Databases
    Procedures and functions
    Primary keys                 http://databases.aspfaq.com/schema-tutorials/schema-how-do-i-show-all-the-primary-keys-in-a-database.html

Column Category
-----------------
    Column info/brief
    Column info/details

DDL Category
-----------------
    Show table schema
</pre>


  [1]: http://www.sqlservercentral.com/blogs/chadmiller/archive/2010/02/16/the-t_2D00_sql-hammer.aspx
  [2]: http://www.simple-talk.com/dotnet/.net-tools/a-unified-approach-to-multi-database-query-templates/",5
6827713,07/26/2011 09:07:53,255673,01/21/2010 10:21:16,31,1,stored procedure with multiple SELECT and report services,"I have a big trouble with report services. 
I need to use a stored procedure with 2 parameters (2 id).
If 1st parameter is filled then a SELECT is launched.
If 2nd parameter is filled then another SELECT is launched.

    CREATE Procedure apGetEvrPourRapport
    @id_exu int, @id_exd int
    AS
    BEGIN
      IF isnull(@id_exu, 0) > 0
    	print 'id_exu : ' + cast(@id_exu as nvarchar(16))
        BEGIN
    		EXEC apReport_Extrait_Lecture_Filtre @id_exu, null
        END
    -- Cas du document unique et document de travail
      IF isnull(@id_exd, 0) > 0
      	print 'id_exd : ' + cast(@id_exd as nvarchar(16))
        BEGIN
                   --EXEC another sp
        END
    END

In Data of Report Services, I retrieve the good SELECT when I filled the correct parameter in execution by the exclamation mark, but in Dataset View, I retrieve only the 2nd SELECT and so the preview fail :(

How to set Dataset to take in consideration this switch of SELECT ?

Thank you for helping.",sql-server,stored-procedures,reporting-services,,,,open,0,231,8,"stored procedure with multiple SELECT and report services I have a big trouble with report services. 
I need to use a stored procedure with 2 parameters (2 id).
If 1st parameter is filled then a SELECT is launched.
If 2nd parameter is filled then another SELECT is launched.

    CREATE Procedure apGetEvrPourRapport
    @id_exu int, @id_exd int
    AS
    BEGIN
      IF isnull(@id_exu, 0) > 0
    	print 'id_exu : ' + cast(@id_exu as nvarchar(16))
        BEGIN
    		EXEC apReport_Extrait_Lecture_Filtre @id_exu, null
        END
    -- Cas du document unique et document de travail
      IF isnull(@id_exd, 0) > 0
      	print 'id_exd : ' + cast(@id_exd as nvarchar(16))
        BEGIN
                   --EXEC another sp
        END
    END

In Data of Report Services, I retrieve the good SELECT when I filled the correct parameter in execution by the exclamation mark, but in Dataset View, I retrieve only the 2nd SELECT and so the preview fail :(

How to set Dataset to take in consideration this switch of SELECT ?

Thank you for helping.",3
8316275,11/29/2011 19:06:03,984463,10/07/2011 17:35:23,1,0,"Are there alternatives to Microsoft Access, like Hyperion?","Our office is using Microsoft Access to generate reports and to create front ends for updating/adding data to our SQL database.

Put another way; We use Access for creating a **Front End** for end users to

 - generate reports
 - update data in an SQL database

Recently we have discovered Hyperion Interactive Reporting Studio.  Our office loves it because it is fairly easy for end users to create queries and generate reports.  **However; it does not support modifying and inserting data.**

Is anyone out there aware of any tools like Hyperion that can be used for updating and adding data to our database or are we just stuck with Microsoft Access?

Thanks in advance!",sql-server,database,ms-access,reporting-services,hyperion,05/16/2012 16:50:59,not constructive,1,112,8,"Are there alternatives to Microsoft Access, like Hyperion? Our office is using Microsoft Access to generate reports and to create front ends for updating/adding data to our SQL database.

Put another way; We use Access for creating a **Front End** for end users to

 - generate reports
 - update data in an SQL database

Recently we have discovered Hyperion Interactive Reporting Studio.  Our office loves it because it is fairly easy for end users to create queries and generate reports.  **However; it does not support modifying and inserting data.**

Is anyone out there aware of any tools like Hyperion that can be used for updating and adding data to our database or are we just stuck with Microsoft Access?

Thanks in advance!",5
447122,01/15/2009 15:17:15,12260,09/16/2008 13:46:42,493,26,Can I have a foreign key referencing a column in a view in SQL Server?,"In SQL Server 2008 and given TableA(A_ID, A_Data), TableB(B_ID, B_Data), and ViewC(A_or_B_ID, A_or_B_Data), is it possible to define TableZ(A_or_B_ID, Z_Data) such that Z's A_or_B_ID column is constrained to the values found in ViewC?  Can this be done with a foreign key against the view?",sql-server,foreign-keys,view,,,,open,0,45,15,"Can I have a foreign key referencing a column in a view in SQL Server? In SQL Server 2008 and given TableA(A_ID, A_Data), TableB(B_ID, B_Data), and ViewC(A_or_B_ID, A_or_B_Data), is it possible to define TableZ(A_or_B_ID, Z_Data) such that Z's A_or_B_ID column is constrained to the values found in ViewC?  Can this be done with a foreign key against the view?",3
7644156,10/04/2011 06:45:01,222797,12/02/2009 10:02:31,679,17,Implementing 1 to 0 or 1 relation in sqlserver,"I'm using Entity framework 4.1 database first approach . I've used Legacy database . In my edmx file which create  entity classes based on tables on legacy database , there is a **1 to 0 or 1** association between some entities . 

although i explored the tables of database and relation between them i didn't find out how **1 to 0 or 1** relation have been implemented in database . ",sql-server,sql-server-2008,entity-framework-4.1,entity-relationship,relation,,open,0,72,9,"Implementing 1 to 0 or 1 relation in sqlserver I'm using Entity framework 4.1 database first approach . I've used Legacy database . In my edmx file which create  entity classes based on tables on legacy database , there is a **1 to 0 or 1** association between some entities . 

although i explored the tables of database and relation between them i didn't find out how **1 to 0 or 1** relation have been implemented in database . ",5
11241293,06/28/2012 09:03:25,1487953,06/28/2012 08:43:38,1,0,Dimension of time where seconds are more than 86400,"I want to make a time dimension in SQL server that shows the columns:

DimTimeKey: 1 up to 97201,
Seconds: 0 up to 97200,
Time: 00:00:00 up to max(seconds in time format),            
Hour: 0 up to 27.

I will really appreciate if someone could help me with the script.     

Best regards Helena.
",sql-server,,,,,06/28/2012 11:40:49,not a real question,1,63,9,"Dimension of time where seconds are more than 86400 I want to make a time dimension in SQL server that shows the columns:

DimTimeKey: 1 up to 97201,
Seconds: 0 up to 97200,
Time: 00:00:00 up to max(seconds in time format),            
Hour: 0 up to 27.

I will really appreciate if someone could help me with the script.     

Best regards Helena.
",1
984558,06/12/2009 01:00:12,95195,04/23/2009 21:10:22,51,3,What sort of audit information is stored by sql server when a CREATE TABLE or ALTER TABLE operation is performed?,"The inspiration for this question is a stored proc broke on me because it called another stored proc that inserted data in a table whose schema was completely altered.

The question is you have a table in a SQL Server database, and you don't know how it got there. You don't have any DDL triggers in place for custom audit information, and there is no record in your source control repository of the tables DDL. Using only SQL Server, what forensic data can you obtain about the table.

Myself, and whoever stumbles across this question in a similar situation, is not going to be helped by suggestions regarding version control and DDL triggers. Those are great go forward solutions, and there is plenty of info on this blog about those topics, if corporate politics allows us to implement those solutions. What I, and people in my situation really need is to be able to gather as many fragments of data as possible from SQL server, to combine with whatever other data we can come up with.",sql-server,ddl,audit,,,,open,0,174,20,"What sort of audit information is stored by sql server when a CREATE TABLE or ALTER TABLE operation is performed? The inspiration for this question is a stored proc broke on me because it called another stored proc that inserted data in a table whose schema was completely altered.

The question is you have a table in a SQL Server database, and you don't know how it got there. You don't have any DDL triggers in place for custom audit information, and there is no record in your source control repository of the tables DDL. Using only SQL Server, what forensic data can you obtain about the table.

Myself, and whoever stumbles across this question in a similar situation, is not going to be helped by suggestions regarding version control and DDL triggers. Those are great go forward solutions, and there is plenty of info on this blog about those topics, if corporate politics allows us to implement those solutions. What I, and people in my situation really need is to be able to gather as many fragments of data as possible from SQL server, to combine with whatever other data we can come up with.",3
8160476,11/17/2011 00:02:49,551863,12/23/2010 00:21:54,86,12,Locate upper case characters in SQL Server database field,"I need to locate rows in a database table that have a field with an upper case value. 

    E.g.: select * from Cust where Surname like 'UPPERCASE VALUES ONLY'

Any assistance would be appreciated.

AJ",sql-server,,,,,,open,0,37,9,"Locate upper case characters in SQL Server database field I need to locate rows in a database table that have a field with an upper case value. 

    E.g.: select * from Cust where Surname like 'UPPERCASE VALUES ONLY'

Any assistance would be appreciated.

AJ",1
9710346,03/14/2012 21:12:11,1047522,11/15/2011 11:59:20,3,0,"Business Intelligence tools for DB2 ,PostgreSQL vs sql server","I doing a school research project on business intelligence (BI) and wanted to decide on which dbms to use. I have read that both DB2, PostgreSQL and sql server have tools for BI. So my question is 

 1. Which dbms has more BI tools available?
 2. Which BI tools are open source? as i want them for research purpose.

Sorry if my question sounds vague. I am very new to BI.  ",sql-server,postgresql,db2,business-intelligence,,03/15/2012 17:33:32,not constructive,1,73,9,"Business Intelligence tools for DB2 ,PostgreSQL vs sql server I doing a school research project on business intelligence (BI) and wanted to decide on which dbms to use. I have read that both DB2, PostgreSQL and sql server have tools for BI. So my question is 

 1. Which dbms has more BI tools available?
 2. Which BI tools are open source? as i want them for research purpose.

Sorry if my question sounds vague. I am very new to BI.  ",4
11657488,07/25/2012 19:49:41,1543644,07/22/2012 07:18:01,13,0,MSSQL Query Update,"I have 2 tables. I need to update data the data on tableB, populate it with data from tableA.

But the problem is the design (note: I can't change the design because its a ready made system. I'll just have to deal with the fail).

Lets say tableA(2 columns) the data source is structured like so:

    ID | NAME
    1    dude
    2    dud
    3    bro
    4    broo
    5    killa
    6    whale
    --ID is an index and NAME is UNIQUE

Now tableB(6 columns) the destination (hard part for me):

    ID1 | NAME1 | ID2 | NAME2 | ID3 | NAME3
    1     dude    2     dud     3     bro
    4     broo    5     killa   6     whale
    --and so on until the end.

Now what I want to do is `UPDATE` the names on tableA to the names on tableB corresponding to there ID's.

Example:

    ID from TableA is 1
    Find ID=1 on TableB
    If ID=1 then UPDATE the next column to 'dude'

Example end of TableA is:

    ID | Name
    9997 sweet
    9998 jess
    9999 grape
    ---The END

Example end of TableB is:

    ID1 | NAME1 | ID2 | NAME2 | ID3 | NAME3
    9997  sweet1  9998  jess1   9999  grape1
    --The END

Please help me :) Thank you.

Note:

    All given table names and column names are for example purposes only.
    There are more columns in the tables, but they don't need to be changed/altered so I did not include an example of them.
    The reason for this is that the data on TableB has been changed and is not matching the correct data anymore.
    So I need to repopulate TableB with the correct data, and the only source for the correct data is TableA.

Regards,
XXXXX",sql-server,query,select,update,,,open,0,412,3,"MSSQL Query Update I have 2 tables. I need to update data the data on tableB, populate it with data from tableA.

But the problem is the design (note: I can't change the design because its a ready made system. I'll just have to deal with the fail).

Lets say tableA(2 columns) the data source is structured like so:

    ID | NAME
    1    dude
    2    dud
    3    bro
    4    broo
    5    killa
    6    whale
    --ID is an index and NAME is UNIQUE

Now tableB(6 columns) the destination (hard part for me):

    ID1 | NAME1 | ID2 | NAME2 | ID3 | NAME3
    1     dude    2     dud     3     bro
    4     broo    5     killa   6     whale
    --and so on until the end.

Now what I want to do is `UPDATE` the names on tableA to the names on tableB corresponding to there ID's.

Example:

    ID from TableA is 1
    Find ID=1 on TableB
    If ID=1 then UPDATE the next column to 'dude'

Example end of TableA is:

    ID | Name
    9997 sweet
    9998 jess
    9999 grape
    ---The END

Example end of TableB is:

    ID1 | NAME1 | ID2 | NAME2 | ID3 | NAME3
    9997  sweet1  9998  jess1   9999  grape1
    --The END

Please help me :) Thank you.

Note:

    All given table names and column names are for example purposes only.
    There are more columns in the tables, but they don't need to be changed/altered so I did not include an example of them.
    The reason for this is that the data on TableB has been changed and is not matching the correct data anymore.
    So I need to repopulate TableB with the correct data, and the only source for the correct data is TableA.

Regards,
XXXXX",4
485100,01/27/2009 20:32:29,55547,01/15/2009 18:28:03,21,2,How can I parse Serv-U FTP logs with SSIS?,"A while back I needed to parse a bunch of Serve-U FTP log files and store them in a database so people could report on them. I ended up developing a small C# app to do the following:

1. Look for all files in a dir that have not been loaded into the db (there is a table of previously loaded files). 

2. Open a file and load all the lines into a list. 

3. Loop through that list and use RegEx to identify the kind of row (CONNECT, LOGIN, DISCONNECT, UPLOAD, DOWNLOAD, etc), parse it into a specific kind of object corresponding to the kind of row and add that obj to another List.

4. Loop through each of the different object lists and write each one to the associated database table. 

5. Record that the file was successfully imported.

6. Wash, rinse, repeat.

It's ugly but it got the job done for the deadline we had.

The problem is that I'm in a DBA role and I'm not happy with running a compiled app as the solution to this problem.  I'd prefer something more open and more DBA-oriented.

I could rewrite this in PowerShell but I'd prefer to develop an SSIS package. I couldn't find a good way to split input based on RegEx within SSIS the first time around and I wasn't familiar enough with SSIS. I'm digging into SSIS more now but still not finding what I need. 

Does anybody have any suggestions about how I might approach a rewrite in SSIS?
",sql-server,ssis,,,,,open,0,251,9,"How can I parse Serv-U FTP logs with SSIS? A while back I needed to parse a bunch of Serve-U FTP log files and store them in a database so people could report on them. I ended up developing a small C# app to do the following:

1. Look for all files in a dir that have not been loaded into the db (there is a table of previously loaded files). 

2. Open a file and load all the lines into a list. 

3. Loop through that list and use RegEx to identify the kind of row (CONNECT, LOGIN, DISCONNECT, UPLOAD, DOWNLOAD, etc), parse it into a specific kind of object corresponding to the kind of row and add that obj to another List.

4. Loop through each of the different object lists and write each one to the associated database table. 

5. Record that the file was successfully imported.

6. Wash, rinse, repeat.

It's ugly but it got the job done for the deadline we had.

The problem is that I'm in a DBA role and I'm not happy with running a compiled app as the solution to this problem.  I'd prefer something more open and more DBA-oriented.

I could rewrite this in PowerShell but I'd prefer to develop an SSIS package. I couldn't find a good way to split input based on RegEx within SSIS the first time around and I wasn't familiar enough with SSIS. I'm digging into SSIS more now but still not finding what I need. 

Does anybody have any suggestions about how I might approach a rewrite in SSIS?
",2
2990387,06/07/2010 14:33:05,121968,06/12/2009 12:30:54,199,1,ADO.NET zombie transaction bug? How to ensure that commands will not be executed on implicit transaction?,"e.g. When deadlock occurs, following SQL commands are successfully executed, even if they have assigned SQL transaction that is after rollback. It seems, it is caused by a new implicit transaction that is created on SQL Server.

Someone could expect that ADO.NET would throw an exception that the commands are being executed on a zombie transaction. However, such exception is not thrown. (I think this is a bug in ASP.NET.) Moreover, because of zombie transaction the final `Dispose()` silently ignores the rollback. 

Any ideas, how can I ensure that nobody can execute commands on implicit transaction?
Or, how to check that transaction is zombie? I found that `Commit()` and `Rollback()` check for zombie transaction, however I can call them for a test:)

I also found that also reading IsolationLevel will do the check, but I am not sure whether simple calling `transaction.IsolationLevel.ToString();` will not be removed by a future optimizer. Or do you know any other safe way invoke a getter (without using reflection or IL emitting)?",sql-server,ado.net,transactions,implicit,zombie-process,,open,0,164,16,"ADO.NET zombie transaction bug? How to ensure that commands will not be executed on implicit transaction? e.g. When deadlock occurs, following SQL commands are successfully executed, even if they have assigned SQL transaction that is after rollback. It seems, it is caused by a new implicit transaction that is created on SQL Server.

Someone could expect that ADO.NET would throw an exception that the commands are being executed on a zombie transaction. However, such exception is not thrown. (I think this is a bug in ASP.NET.) Moreover, because of zombie transaction the final `Dispose()` silently ignores the rollback. 

Any ideas, how can I ensure that nobody can execute commands on implicit transaction?
Or, how to check that transaction is zombie? I found that `Commit()` and `Rollback()` check for zombie transaction, however I can call them for a test:)

I also found that also reading IsolationLevel will do the check, but I am not sure whether simple calling `transaction.IsolationLevel.ToString();` will not be removed by a future optimizer. Or do you know any other safe way invoke a getter (without using reflection or IL emitting)?",5
9020679,01/26/2012 15:40:25,7021,09/15/2008 13:01:34,5686,97,Why is my database so large?,"Of course you can't answer that question. But I hope someone can point me to a way/tool to analyse which parts of my database are allocating so much space.

So, what tools do you use to check where your SQL-Server databases are using all that expensive disk space?",sql-server,diskspace,,,,01/26/2012 21:41:46,off topic,1,47,6,"Why is my database so large? Of course you can't answer that question. But I hope someone can point me to a way/tool to analyse which parts of my database are allocating so much space.

So, what tools do you use to check where your SQL-Server databases are using all that expensive disk space?",2
7113271,08/18/2011 19:51:09,763246,05/20/2011 18:43:52,3215,152,Database Trigger Usage - Best Practices,"**Brief Background:**

I currently maintain a fifteen year old inventory management system. In an effort to provide real-time quantity on hand for both single items and kits (possibly nested down to the Nth level), inventory is allocated to orders on the fly when a page is requested (allocation priority is determined by date received and date expected). Depending on how many orders are in the system, and more specifically, how many of those orders contain nested kits, performance can be an issue.

**The Question(s):**

We're currently in the process of designing a new inventory management system using SOA principles. Instead of allocating the inventory on the fly, we would like an allocation table to be updated after every insert, update, and delete occurs that could affect the items allocation data. There is some debate as to whether the allocation table should be updated by triggers in the DB, or by the C# order service.

 - Which method would best adhere to SOA principles?
 - Which method would be more performant?
 - Is this the proper use of a trigger?
 - Is either method generally accepted by the community at large as the ""proper way to do things""?

Thanks in advance for your time!",sql-server,sql-server-2008,database-design,triggers,,,open,0,199,6,"Database Trigger Usage - Best Practices **Brief Background:**

I currently maintain a fifteen year old inventory management system. In an effort to provide real-time quantity on hand for both single items and kits (possibly nested down to the Nth level), inventory is allocated to orders on the fly when a page is requested (allocation priority is determined by date received and date expected). Depending on how many orders are in the system, and more specifically, how many of those orders contain nested kits, performance can be an issue.

**The Question(s):**

We're currently in the process of designing a new inventory management system using SOA principles. Instead of allocating the inventory on the fly, we would like an allocation table to be updated after every insert, update, and delete occurs that could affect the items allocation data. There is some debate as to whether the allocation table should be updated by triggers in the DB, or by the C# order service.

 - Which method would best adhere to SOA principles?
 - Which method would be more performant?
 - Is this the proper use of a trigger?
 - Is either method generally accepted by the community at large as the ""proper way to do things""?

Thanks in advance for your time!",4
5791764,04/26/2011 14:23:16,598516,02/01/2011 14:19:23,126,5,Column-name and/or table-name as parameters,"Given following snippet (MS SQL):

    DECLARE UpdateList CURSOR FOR
	SELECT MyColumn FROM MyTable
    OPEN UpdateList

Nothing fancy so far. Now I would like to declare two variables where I can write the column's and table's name into. Following, of course, wouldn't work. How can I achieve this?


    DECLARE @TableName nchar(20) = 'MyTable'
    DECLARE @ColumnName nchar(20) = 'MyColumn'
    DECLARE UpdateList CURSOR FOR
	SELECT @ColumnName FROM @TableName
    OPEN UpdateList

Thx for any tipps
sl3dg3",sql-server,tsql,,,,,open,0,85,5,"Column-name and/or table-name as parameters Given following snippet (MS SQL):

    DECLARE UpdateList CURSOR FOR
	SELECT MyColumn FROM MyTable
    OPEN UpdateList

Nothing fancy so far. Now I would like to declare two variables where I can write the column's and table's name into. Following, of course, wouldn't work. How can I achieve this?


    DECLARE @TableName nchar(20) = 'MyTable'
    DECLARE @ColumnName nchar(20) = 'MyColumn'
    DECLARE UpdateList CURSOR FOR
	SELECT @ColumnName FROM @TableName
    OPEN UpdateList

Thx for any tipps
sl3dg3",2
9148431,02/05/2012 10:16:24,298428,03/21/2010 12:43:28,48,3,What's the best datatype to store a facebook api access token in sql server?,"What's the best data type for storing a Facebook API Access token in SQL Server?

Thanks!
",sql-server,facebook,,,,02/06/2012 03:54:21,not a real question,1,15,14,"What's the best datatype to store a facebook api access token in sql server? What's the best data type for storing a Facebook API Access token in SQL Server?

Thanks!
",2
5094400,02/23/2011 17:19:23,73226,03/03/2009 13:40:52,37618,1564,Performance of Non Clustered Indexes on Heaps vs Clustered Indexes,"[This 2007 White Paper][1] compares the performance for individual select/insert/delete/update and range select statements on a table organized as a clustered index vs that on a table organized as a heap with a non clustered index on the same key columns as the CI table.

Generally the clustered index option performed better in the tests as there is only one structure to maintain and because there is no need for bookmark lookups.

One potentially interesting case not covered by the paper would have been a comparison between a non clustered index on a heap vs a non clustered index on a clustered index. In that instance I would have expected the heap might even perform better as once at the NCI leaf level SQL Server has a RID to follow directly rather than needing to traverse the clustered index. 

Is anyone aware of similar formal testing that has been carried out in this area and if so what were the results?


  [1]: http://technet.microsoft.com/en-gb/library/cc917672.aspx",sql-server,indexing,clustered-index,,,03/02/2012 15:49:39,off topic,1,162,10,"Performance of Non Clustered Indexes on Heaps vs Clustered Indexes [This 2007 White Paper][1] compares the performance for individual select/insert/delete/update and range select statements on a table organized as a clustered index vs that on a table organized as a heap with a non clustered index on the same key columns as the CI table.

Generally the clustered index option performed better in the tests as there is only one structure to maintain and because there is no need for bookmark lookups.

One potentially interesting case not covered by the paper would have been a comparison between a non clustered index on a heap vs a non clustered index on a clustered index. In that instance I would have expected the heap might even perform better as once at the NCI leaf level SQL Server has a RID to follow directly rather than needing to traverse the clustered index. 

Is anyone aware of similar formal testing that has been carried out in this area and if so what were the results?


  [1]: http://technet.microsoft.com/en-gb/library/cc917672.aspx",3
5611830,04/10/2011 12:51:14,198927,10/29/2009 14:01:04,1888,51,Fluent NHibernate Newbie: Row was updated or deleted by another transaction,"I'm in the early stages of building out a database with Fluent NHibernate. I implemented a unit-of-work pattern in ASP.NET MVC 3 to let NHibernate update my database schema for me. To insert/update my initial data, I have a `Database` controller with an `Update` action that tries to `SaveOrUpdate(...)` a `User` entity (the administrator user) into the `Users` table.

After manually deleting all user records via Visual Studio and re-running my `Update` action to repopulate the `Users` table, I receive the following `NHibernate.StaleObjectStateException` exception:

    Row was updated or deleted by another transaction (or unsaved-value mapping was
    incorrect): [Invoicer.Data.Entities.User#3105248d-ca91-4c64-bf8f-9ebb017943b7]
    
    Line 26: 		{
    Line 27: 			if (_transaction.IsActive)
    Line 28: 				_transaction.Commit();
    Line 29: 		}

Note: the saved or updated user ID is a Guid with the value above (3105...).

What am I doing wrong?",sql-server,asp.net-mvc-3,fluent-nhibernate,,,,open,0,150,11,"Fluent NHibernate Newbie: Row was updated or deleted by another transaction I'm in the early stages of building out a database with Fluent NHibernate. I implemented a unit-of-work pattern in ASP.NET MVC 3 to let NHibernate update my database schema for me. To insert/update my initial data, I have a `Database` controller with an `Update` action that tries to `SaveOrUpdate(...)` a `User` entity (the administrator user) into the `Users` table.

After manually deleting all user records via Visual Studio and re-running my `Update` action to repopulate the `Users` table, I receive the following `NHibernate.StaleObjectStateException` exception:

    Row was updated or deleted by another transaction (or unsaved-value mapping was
    incorrect): [Invoicer.Data.Entities.User#3105248d-ca91-4c64-bf8f-9ebb017943b7]
    
    Line 26: 		{
    Line 27: 			if (_transaction.IsActive)
    Line 28: 				_transaction.Commit();
    Line 29: 		}

Note: the saved or updated user ID is a Guid with the value above (3105...).

What am I doing wrong?",3
9014878,01/26/2012 07:05:48,415037,08/09/2010 11:55:28,615,9,Using SQL Server Database::: Attaching after installation,"My question is if user needs to attach the databases to the instance of server manually before being able to use the application?  
I have added the mdf file to my Setup project.  It installs and copies the file to application folder.  I donot know if the file needs to be attached or there is a way that application could do it automatically (attach to MyComputer\SQLExpress)

Thanks 
",sql-server,vb.net,,,,,open,0,70,7,"Using SQL Server Database::: Attaching after installation My question is if user needs to attach the databases to the instance of server manually before being able to use the application?  
I have added the mdf file to my Setup project.  It installs and copies the file to application folder.  I donot know if the file needs to be attached or there is a way that application could do it automatically (attach to MyComputer\SQLExpress)

Thanks 
",2
9051920,01/29/2012 08:32:15,1151462,01/16/2012 08:22:41,8,0,Add data present in cloumns?,"I Have a column here which is a simple example of my problem

    COLUMN1
    1
    2

How would i add the two numbers in COLUMN1",sql-server,sql-server-2008,,,,01/29/2012 13:42:15,not a real question,1,33,5,"Add data present in cloumns? I Have a column here which is a simple example of my problem

    COLUMN1
    1
    2

How would i add the two numbers in COLUMN1",2
8276463,11/26/2011 05:17:13,327528,04/28/2010 06:13:59,963,6,SQL Server Reporting Services with a single discrete application?,"Is there any point in using SSRS to host your reports if you are only going to have one application using your SQL Server?

I would have thought SSRS makes sense only if you are going host reports that are going to be consumed by several separate applications.",sql-server,ssrs-reports,,,,,open,0,47,9,"SQL Server Reporting Services with a single discrete application? Is there any point in using SSRS to host your reports if you are only going to have one application using your SQL Server?

I would have thought SSRS makes sense only if you are going host reports that are going to be consumed by several separate applications.",2
11215607,06/26/2012 20:42:35,99834,05/02/2009 12:01:45,8473,218,How to elimitate first and last result from a SQL Server query?,"Let's say you have a SQL query that is returning `n` results and you want to return only results from `1 to n-2` without first row (0) and last row (n-1).

How to obtain this in SQL Server?",sql-server,,,,,,open,0,37,12,"How to elimitate first and last result from a SQL Server query? Let's say you have a SQL query that is returning `n` results and you want to return only results from `1 to n-2` without first row (0) and last row (n-1).

How to obtain this in SQL Server?",1
11742192,07/31/2012 14:15:12,1001495,10/18/2011 15:37:10,132,1,CREATE ASSEMBLY - EXCEPTION_ACCESS_VIOLATION,"I am trying to create an assembly on my SQL Server 2005 server. Here is what I am using:

    CREATE ASSEMBLY [SQLCLRTest]
        AUTHORIZATION [dbo]
        FROM 'path\to\my\file.dll'
        WITH PERMISSION_SET = EXTERNAL_ACCESS;

I am getting this error as ouput:

    Msg 0, Level 11, State 0, Line 0
    A severe error occurred on the current command.  The results, if any, should be discarded.
    Msg 0, Level 20, State 0, Line 0
    A severe error occurred on the current command.  The results, if any, should be discarded.

When I look at my error logs I find the following in the stack trace:

    Exception Log -  EXCEPTION_ACCESS_VIOLATION

I've been Googling around and the only solution I have seen to this is to change the database owner, which is not an option for me. I'm thinking that I need to have some sort of permssions set for my user but I can't find exactly what I need. Could anyone give me some advice on how to handle this? It would be very much appreciated. Thanks! ",sql-server,sql-server-2005,,,,07/31/2012 14:59:33,off topic,1,209,4,"CREATE ASSEMBLY - EXCEPTION_ACCESS_VIOLATION I am trying to create an assembly on my SQL Server 2005 server. Here is what I am using:

    CREATE ASSEMBLY [SQLCLRTest]
        AUTHORIZATION [dbo]
        FROM 'path\to\my\file.dll'
        WITH PERMISSION_SET = EXTERNAL_ACCESS;

I am getting this error as ouput:

    Msg 0, Level 11, State 0, Line 0
    A severe error occurred on the current command.  The results, if any, should be discarded.
    Msg 0, Level 20, State 0, Line 0
    A severe error occurred on the current command.  The results, if any, should be discarded.

When I look at my error logs I find the following in the stack trace:

    Exception Log -  EXCEPTION_ACCESS_VIOLATION

I've been Googling around and the only solution I have seen to this is to change the database owner, which is not an option for me. I'm thinking that I need to have some sort of permssions set for my user but I can't find exactly what I need. Could anyone give me some advice on how to handle this? It would be very much appreciated. Thanks! ",2
9567537,03/05/2012 13:34:53,8479,09/15/2008 16:07:11,4959,116,"When you back up a database and scripts are running at the same time, at what point in time does the backup reflect?","If I run a SQL Server database backup via Management Studio and there are scripts running at the same time, does the backup reflect the point in time when the backup was started or when it ended? My db is about 10GB so the backup takes some time, meaning there's lots of things that could go on in the meantime.

I'm using SQL Server 2008 R2",sql-server,database,backup,sql-server-2008-r2,database-backups,03/06/2012 00:01:13,off topic,1,65,23,"When you back up a database and scripts are running at the same time, at what point in time does the backup reflect? If I run a SQL Server database backup via Management Studio and there are scripts running at the same time, does the backup reflect the point in time when the backup was started or when it ended? My db is about 10GB so the backup takes some time, meaning there's lots of things that could go on in the meantime.

I'm using SQL Server 2008 R2",5
11461608,07/12/2012 22:23:43,1229230,02/23/2012 19:49:14,13,0,Sql server database restore vs index rebuilds," In SQL Server  If DATABase Restore Time takes less time compare to Index Rebuilds OR Reorganize  . Can we  Choose Restore as a option for DE-fragmentation.
If its not a 24/7 database. 
 ",sql-server,,,,,07/12/2012 23:10:46,off topic,1,37,7,"Sql server database restore vs index rebuilds  In SQL Server  If DATABase Restore Time takes less time compare to Index Rebuilds OR Reorganize  . Can we  Choose Restore as a option for DE-fragmentation.
If its not a 24/7 database. 
 ",1
11483828,07/14/2012 12:41:08,1360733,04/27/2012 09:07:26,6,0,Optimizing real-time Database table in Microsoft SQL server 2008,"We are using a web interface to monitor our jobs state and its started and completed timestamps. We have >2lakh job instances running on each day for different job run-users. We maintain the state of all jobs executed in last 6months in a database table. Database server used in Microsoft sql server 2008. With the growing number of jobs or records in table, time taken for updating the records in a table is also going slower than before. 

We wanted to redesign our table and schema to update jobs state in real time scenario without causing any delay to job execution. We are thinking of splitting this single table to multiple tables for each user so that updating one user job state should not cause any delay in updating other user job state. To add a note here: the number of users is less than 25 but the number of jobs for each user is more than 50,000. Also, there is no dependency between each user jobs.

1. Will this table splitting be a better or an optimized way to get the table update or search faster?
2. Or Will row locking feature in microsoft sql sever solve this case?
3. Do we have any best optimized way to handle this case?
4. Will the index be the reason for slowness?

Table:
Job id [primary key] | Job name | started time | End time | status

We have 2 indexes: one based on job start and end time. Second index is only based on job name. 

Thanks.",sql-server,sql-server-2008,query,java-ee,database-design,07/15/2012 13:20:55,off topic,1,251,9,"Optimizing real-time Database table in Microsoft SQL server 2008 We are using a web interface to monitor our jobs state and its started and completed timestamps. We have >2lakh job instances running on each day for different job run-users. We maintain the state of all jobs executed in last 6months in a database table. Database server used in Microsoft sql server 2008. With the growing number of jobs or records in table, time taken for updating the records in a table is also going slower than before. 

We wanted to redesign our table and schema to update jobs state in real time scenario without causing any delay to job execution. We are thinking of splitting this single table to multiple tables for each user so that updating one user job state should not cause any delay in updating other user job state. To add a note here: the number of users is less than 25 but the number of jobs for each user is more than 50,000. Also, there is no dependency between each user jobs.

1. Will this table splitting be a better or an optimized way to get the table update or search faster?
2. Or Will row locking feature in microsoft sql sever solve this case?
3. Do we have any best optimized way to handle this case?
4. Will the index be the reason for slowness?

Table:
Job id [primary key] | Job name | started time | End time | status

We have 2 indexes: one based on job start and end time. Second index is only based on job name. 

Thanks.",5
2511502,03/24/2010 21:22:01,193200,10/20/2009 15:26:05,205,14,"SQL Server ""RESTORE FILELISTONLY"" Resultset","I'm trying to write an automated backup and restore T-SQL scripts. I've done BACKUP part but I'm struggling on RESTORE. 

When I run following statement on SS Management Studio;

    EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''')

I get a result set in a grid and also I can use 

    INSERT INTO <temp_table> 
    EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''')

to populate a temp table. However I get syntax error, when I try to select from that resultset. e.g

    SELECT * FROM  
    EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''')

The resultset metadata should be stored somewhere in SQL Server Dictionary. I found other band-aid formula to get my automated restore working, but if can get to the resultset, I would create more elegant solution. Also please note that resultset is different in 2008 than 2005. 

Thanks in advance...
",sql-server,database-restore,tsql,,,,open,0,150,5,"SQL Server ""RESTORE FILELISTONLY"" Resultset I'm trying to write an automated backup and restore T-SQL scripts. I've done BACKUP part but I'm struggling on RESTORE. 

When I run following statement on SS Management Studio;

    EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''')

I get a result set in a grid and also I can use 

    INSERT INTO <temp_table> 
    EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''')

to populate a temp table. However I get syntax error, when I try to select from that resultset. e.g

    SELECT * FROM  
    EXEC('RESTORE FILELISTONLY FROM DISK = ''C:\backup.bak''')

The resultset metadata should be stored somewhere in SQL Server Dictionary. I found other band-aid formula to get my automated restore working, but if can get to the resultset, I would create more elegant solution. Also please note that resultset is different in 2008 than 2005. 

Thanks in advance...
",3
9064931,01/30/2012 13:54:04,907699,08/23/2011 12:20:24,13,0,how to update a table in SQL Server using Integration Services?,"I'm trying to update a table in SQL Server with Integration Services, but I don't know how to do that

All I have is the set of data that need to be updated (with the same structure of the table that should be updated) 

Is there some object to do this??



",sql-server,ssis,,,,,open,0,50,11,"how to update a table in SQL Server using Integration Services? I'm trying to update a table in SQL Server with Integration Services, but I don't know how to do that

All I have is the set of data that need to be updated (with the same structure of the table that should be updated) 

Is there some object to do this??



",2
11282876,07/01/2012 14:44:28,1494358,07/01/2012 14:29:35,1,0,SQL 2005/2008 system timezone,"I work on a ship that has multiple MS SQL servers both 2005/2008. As the ship moves from area to area so does our timezone. Sometimes we can jump ahead one hour and then back again. My question is what is the best practice for this sort of situation, is it safe to change the system time so repeatedly? Should the DB be stopped before doing so? What sort of problems can arise? Any feedback appreciated.

Thanks, 
Kris",sql-server,sql-server-2005,sql-server-2008-r2,,,07/01/2012 18:08:56,off topic,1,77,4,"SQL 2005/2008 system timezone I work on a ship that has multiple MS SQL servers both 2005/2008. As the ship moves from area to area so does our timezone. Sometimes we can jump ahead one hour and then back again. My question is what is the best practice for this sort of situation, is it safe to change the system time so repeatedly? Should the DB be stopped before doing so? What sort of problems can arise? Any feedback appreciated.

Thanks, 
Kris",3
10274812,04/23/2012 04:32:37,1210654,02/15/2012 06:54:53,178,0,How to sort column by absolute value in SQL Server or Microsoft Access?,"The values in a column has both negative and positive integers. I want to sort the column by its **absolute** value. How do I do this preferably in Access or in SQL? Thanks.

",sql-server,ms-access,sorting,,,,open,0,33,13,"How to sort column by absolute value in SQL Server or Microsoft Access? The values in a column has both negative and positive integers. I want to sort the column by its **absolute** value. How do I do this preferably in Access or in SQL? Thanks.

",3
1456954,09/21/2009 21:22:39,14395,09/16/2008 23:42:17,584,40,UDF which auto-switches between text and base64 xml attributes,"My application serializes data into various XML attributes, and depending on data it might send it as text, or as base64. In the latter case, attribute name will be ""attribute-base64"". So, on SQL server side it is possible to use following convention to decode XML:

	declare @DataXml xml
	set @DataXml='<root v=""test data""/>' ;
	--or: set @DataXml='<root v-base64=""AgB0AGUAcwB0ACAAHwQSBCQEFw....""/>' ;
	SELECT ISNULL( 
		@DataXml.value('root[1]/@v', 'nvarchar(max)'), 
		CAST( @DataXml.value('xs:base64Binary(root[1]/@v-base64)', 
			'varbinary(max)') AS nvarchar(max) ) )

I'm trying to write a UDF, which will accept XML and attribute name as an input and will output a string. How do I generate XQuery? I tried doing this, but it doesn't work:

	CREATE FUNCTION dbo. udf_DataXmlValue 
	(
	    @DataXml xml,
	    @NodeName nvarchar(max),
	    @AttributeName nvarchar(max)
	)
	RETURNS nvarchar(max)
	AS
	BEGIN
	    DECLARE @result nvarchar(max) ;
		
	    DECLARE @xquery nvarchar(max) ;
	    SET @xquery = @NodeName + '[1]/' + @AttributeName;
	    SET @result = @DataXml.value('sql:variable(""@xquery"")', 'nvarchar(max)') ;
		
	    IF @result IS NULL
	    BEGIN
	    	... do base64 stuff ...
	    END
		
	    RETURN @result ;
	END
	GO

When called :

    SELECT dbo.udf_DataXmlValue( @xml, 'root', 'v' )

return result is not value, but 'root[1]/@v'... Apparently, SQL server understands sql:variable(""@xquery"") as an XML value, not as XQuery. Any ideas what do I need to do?",sql-server,xquery,sql,udf,,,open,0,218,9,"UDF which auto-switches between text and base64 xml attributes My application serializes data into various XML attributes, and depending on data it might send it as text, or as base64. In the latter case, attribute name will be ""attribute-base64"". So, on SQL server side it is possible to use following convention to decode XML:

	declare @DataXml xml
	set @DataXml='<root v=""test data""/>' ;
	--or: set @DataXml='<root v-base64=""AgB0AGUAcwB0ACAAHwQSBCQEFw....""/>' ;
	SELECT ISNULL( 
		@DataXml.value('root[1]/@v', 'nvarchar(max)'), 
		CAST( @DataXml.value('xs:base64Binary(root[1]/@v-base64)', 
			'varbinary(max)') AS nvarchar(max) ) )

I'm trying to write a UDF, which will accept XML and attribute name as an input and will output a string. How do I generate XQuery? I tried doing this, but it doesn't work:

	CREATE FUNCTION dbo. udf_DataXmlValue 
	(
	    @DataXml xml,
	    @NodeName nvarchar(max),
	    @AttributeName nvarchar(max)
	)
	RETURNS nvarchar(max)
	AS
	BEGIN
	    DECLARE @result nvarchar(max) ;
		
	    DECLARE @xquery nvarchar(max) ;
	    SET @xquery = @NodeName + '[1]/' + @AttributeName;
	    SET @result = @DataXml.value('sql:variable(""@xquery"")', 'nvarchar(max)') ;
		
	    IF @result IS NULL
	    BEGIN
	    	... do base64 stuff ...
	    END
		
	    RETURN @result ;
	END
	GO

When called :

    SELECT dbo.udf_DataXmlValue( @xml, 'root', 'v' )

return result is not value, but 'root[1]/@v'... Apparently, SQL server understands sql:variable(""@xquery"") as an XML value, not as XQuery. Any ideas what do I need to do?",4
7966865,11/01/2011 13:03:25,79379,03/18/2009 08:42:45,83,9,Tools to measure performance in ASP.net or C#,"Can you please guide me to a book, tool or article that would guide me on how to make an asp.net MVC 2 application that uses WCF to perform better?

I am interested in lower database query time.
How to render pages more quickly.
How to write controllers and action and what are the best practices in order to obtain an efficient application.

I use Asp.Net MVC 2 , NHibernate / Entity Framework, WCF 4.0 and JQuery.

Thanks",sql-server,wcf,asp.net-mvc-2,optimization,,11/02/2011 13:51:06,not constructive,1,73,8,"Tools to measure performance in ASP.net or C# Can you please guide me to a book, tool or article that would guide me on how to make an asp.net MVC 2 application that uses WCF to perform better?

I am interested in lower database query time.
How to render pages more quickly.
How to write controllers and action and what are the best practices in order to obtain an efficient application.

I use Asp.Net MVC 2 , NHibernate / Entity Framework, WCF 4.0 and JQuery.

Thanks",4
7616149,09/30/2011 21:12:41,189950,10/14/2009 15:24:51,14193,478,How to find foreign key dependencies of a specific row?,"If I have a table, TableA:

    Id
    1
    2
    3
    ...

And two other tables:

TableB:

    Id, TableAId
    1   1
    2   1

TableC:

    Id, TableAId
    1,  1
    2,  2

Where TableAId is a FK relationship with TableA.Id.

How do I determine that TableA, Id 1, has three rows pointing to it?  And that TableA, Id 2 has one row pointing to it?  And more specifically, how do I identify what those rows are? (their table name and Id)",sql-server,,,,,,open,0,114,10,"How to find foreign key dependencies of a specific row? If I have a table, TableA:

    Id
    1
    2
    3
    ...

And two other tables:

TableB:

    Id, TableAId
    1   1
    2   1

TableC:

    Id, TableAId
    1,  1
    2,  2

Where TableAId is a FK relationship with TableA.Id.

How do I determine that TableA, Id 1, has three rows pointing to it?  And that TableA, Id 2 has one row pointing to it?  And more specifically, how do I identify what those rows are? (their table name and Id)",1
3248712,07/14/2010 17:18:35,117700,06/04/2009 23:04:34,1718,5,how do i check under which username a script is run?,"i have this script:

    BACKUP DATABASE timeclockplus TO DISK = 'C:\Program Files\Microsoft SQL Server\MSSQL.2\MSSQL\Backup\backup.bak'

how do i know which username is executing it? the reason i ask is because i want to grant extra privelages to the current username so that instead of writing that backup folder i can write to a different folder",sql-server,database-backups,,,,,open,0,56,11,"how do i check under which username a script is run? i have this script:

    BACKUP DATABASE timeclockplus TO DISK = 'C:\Program Files\Microsoft SQL Server\MSSQL.2\MSSQL\Backup\backup.bak'

how do i know which username is executing it? the reason i ask is because i want to grant extra privelages to the current username so that instead of writing that backup folder i can write to a different folder",2
10902436,06/05/2012 18:01:29,1438023,06/05/2012 17:59:48,1,0,Maximum table comment length for Oracle and SQL Server,What is the maximum length for a table comment in Oracle and SQL Server? For MySQL this is 60 chars.,sql-server,oracle,,,,,open,0,20,9,Maximum table comment length for Oracle and SQL Server What is the maximum length for a table comment in Oracle and SQL Server? For MySQL this is 60 chars.,2
4226035,11/19/2010 14:40:19,513599,11/19/2010 14:40:19,1,0,Why does a query slow down drastically if in the WHERE clause a constant is replaced by a parameter (having the same value)?,"I have a recursive query which executes very fast if the WHERE clause contains a constant but becomes very slow if I replace the constant with a parameter having the same value.

Query #1 - with constant

    WITH
    Hierarchy (Id,	ParentId, Data, Depth)
    AS
    ( SELECT Id, ParentId, NULL AS Data, 0 AS Depth
    FROM Test
    UNION ALL
    SELECT h.Id, t.ParentId, COALESCE(h.Data, t.Data), Depth + 1 AS Depth
    	FROM
    		Hierarchy h
    		INNER JOIN Test t ON t.Id = h.ParentId
    )
    SELECT * FROM Hierarchy WHERE Id = 69

Query #2 - with parameter

    DECLARE @Id INT
    SELECT @Id = 69
    
    ;WITH
    Hierarchy (Id,	ParentId, Data, Depth)
    AS
    ( SELECT Id, ParentId, NULL AS Data, 0 AS Depth
    FROM Test
    UNION ALL
    SELECT h.Id, t.ParentId, COALESCE(h.Data, t.Data), Depth + 1 AS Depth
    	FROM
    		Hierarchy h
    		INNER JOIN Test t ON t.Id = h.ParentId
    )
    SELECT * FROM Hierarchy WHERE Id = @Id


In case of a table with 50000 rows the query with the constant runs for 10 milliseconds and the one with the parameter runs for 30 seconds (3000 times slower).

It is not an option to move the last WHERE clause to the anchor definition of the recursion, as I would like to use the query to create a view (without the last WHERE). The select from the view would have the WHERE clause (WHERE Id = @Id) - I need this because of Entity Framework, but that is another story.

Can anybody suggest a way to force query #2 (with the parameter) to use the same query plan as query #1 (with the constant)?

I already tried playing with indexes but that did not help.

If somebody would like I can post the table definition and some sample data as well.
I am using SQL 2008 R2.

Thank you for your help in advance!
",sql-server,,,,,,open,0,377,23,"Why does a query slow down drastically if in the WHERE clause a constant is replaced by a parameter (having the same value)? I have a recursive query which executes very fast if the WHERE clause contains a constant but becomes very slow if I replace the constant with a parameter having the same value.

Query #1 - with constant

    WITH
    Hierarchy (Id,	ParentId, Data, Depth)
    AS
    ( SELECT Id, ParentId, NULL AS Data, 0 AS Depth
    FROM Test
    UNION ALL
    SELECT h.Id, t.ParentId, COALESCE(h.Data, t.Data), Depth + 1 AS Depth
    	FROM
    		Hierarchy h
    		INNER JOIN Test t ON t.Id = h.ParentId
    )
    SELECT * FROM Hierarchy WHERE Id = 69

Query #2 - with parameter

    DECLARE @Id INT
    SELECT @Id = 69
    
    ;WITH
    Hierarchy (Id,	ParentId, Data, Depth)
    AS
    ( SELECT Id, ParentId, NULL AS Data, 0 AS Depth
    FROM Test
    UNION ALL
    SELECT h.Id, t.ParentId, COALESCE(h.Data, t.Data), Depth + 1 AS Depth
    	FROM
    		Hierarchy h
    		INNER JOIN Test t ON t.Id = h.ParentId
    )
    SELECT * FROM Hierarchy WHERE Id = @Id


In case of a table with 50000 rows the query with the constant runs for 10 milliseconds and the one with the parameter runs for 30 seconds (3000 times slower).

It is not an option to move the last WHERE clause to the anchor definition of the recursion, as I would like to use the query to create a view (without the last WHERE). The select from the view would have the WHERE clause (WHERE Id = @Id) - I need this because of Entity Framework, but that is another story.

Can anybody suggest a way to force query #2 (with the parameter) to use the same query plan as query #1 (with the constant)?

I already tried playing with indexes but that did not help.

If somebody would like I can post the table definition and some sample data as well.
I am using SQL 2008 R2.

Thank you for your help in advance!
",1
30374,08/27/2008 15:03:14,2894,08/25/2008 20:06:55,71,13,What is a good source for learning OLAP,"Are there any excellent sources (book, podcast, tribal folklore, etc) fo rgetting a grasp on using OLAP for data analysis in SQL Server (or just in generic terms that can be applied to SQL Server)?",sql-server,olap,,,,09/11/2008 16:09:12,off topic,1,35,8,"What is a good source for learning OLAP Are there any excellent sources (book, podcast, tribal folklore, etc) fo rgetting a grasp on using OLAP for data analysis in SQL Server (or just in generic terms that can be applied to SQL Server)?",2
9318694,02/16/2012 20:40:14,1004278,10/20/2011 00:53:10,514,5,"Oracle Apex ""Database Link"" - only for Oracle to Oracle or others as well?","Can I use the ""Database Link"" tool in Apex to connect to MS SQL Server? Or just other Oracle DBs?",sql-server,oracle-apex,,,,,open,0,20,14,"Oracle Apex ""Database Link"" - only for Oracle to Oracle or others as well? Can I use the ""Database Link"" tool in Apex to connect to MS SQL Server? Or just other Oracle DBs?",2
5357857,03/18/2011 21:10:46,637798,02/28/2011 14:09:12,8,0,TSQL (MSSQL) Sorting and paging with row_number,"I got problem which Iam unable to solve myself, probably because I got ""fixed"" perspective. So meaby someone would give me a hand on this.

So I got database (MSSQL) and app which fetches data and converst them into JSON. 
I wrote an SQL to order data by userid column (DESC) and take only first 10 rows. 
But it causes problem returning wrong results.

For example if I have following table:

          UserID
          ---
          User1
          User2
          User3
          ...
          User10
          ..
          User25

I want to to UserID to be DESC and get first ten results (then second ten results, etc). Simple saying Iam looking for MySQL LIMIT substitute in MSSQL

My query

    SELECT * FROM (SELECT  
                                    system_users_ranks.RankName,
                                    system_users.userid,
                                    system_users.UserName,
                                    system_users.Email, 
                                    system_users.LastIP, 
                                    system_users.LastLoginDate,
                                    row_number() OVER (ORDER BY system_users.userid) as myrownum
                                 FROM     
                                    system_users 
                                 INNER JOIN
                                    system_users_ranks 
                                 ON system_users.UserRank = system_users_ranks.rankid 
                            ) as dertbl  WHERE  myrownum BETWEEN @startval AND @endval ORDER BY userid DESC

I cant move ORDER BY to inner SELECT :(
Any ideas ? I would apprecieate any help",sql-server,tsql,,,,,open,0,696,7,"TSQL (MSSQL) Sorting and paging with row_number I got problem which Iam unable to solve myself, probably because I got ""fixed"" perspective. So meaby someone would give me a hand on this.

So I got database (MSSQL) and app which fetches data and converst them into JSON. 
I wrote an SQL to order data by userid column (DESC) and take only first 10 rows. 
But it causes problem returning wrong results.

For example if I have following table:

          UserID
          ---
          User1
          User2
          User3
          ...
          User10
          ..
          User25

I want to to UserID to be DESC and get first ten results (then second ten results, etc). Simple saying Iam looking for MySQL LIMIT substitute in MSSQL

My query

    SELECT * FROM (SELECT  
                                    system_users_ranks.RankName,
                                    system_users.userid,
                                    system_users.UserName,
                                    system_users.Email, 
                                    system_users.LastIP, 
                                    system_users.LastLoginDate,
                                    row_number() OVER (ORDER BY system_users.userid) as myrownum
                                 FROM     
                                    system_users 
                                 INNER JOIN
                                    system_users_ranks 
                                 ON system_users.UserRank = system_users_ranks.rankid 
                            ) as dertbl  WHERE  myrownum BETWEEN @startval AND @endval ORDER BY userid DESC

I cant move ORDER BY to inner SELECT :(
Any ideas ? I would apprecieate any help",2
7809971,10/18/2011 15:43:33,466419,10/05/2010 03:44:54,25,0,T-SQL group specific items at the top of return,"I'm pulling a list of employees from a db and they each have an office ID. I want to order by the office ID but want the current office of the user to appear at the top of the list and the rest to appear below in the order ascending order.

    Example:

    Name  Office
    Mike    1
    Alex    2
    John    6
    Steve   2
    Sarah   3

    If my office is office 2, I want those to appear at the top like so

    Name  Office
    Alex    2
    Steve   2
    Mike    1
    Sarah   3
    John    6

Is there a way to do this in some type of clause or would I have to create a temp table, do the first search on only the specific office ID and then add the rest to the table where its not the same as that ID. I feel like that's a complete hack and would prefer not to do that if not needed. 

Thanks!",sql-server,tsql,sql-server-2008,,,,open,0,226,9,"T-SQL group specific items at the top of return I'm pulling a list of employees from a db and they each have an office ID. I want to order by the office ID but want the current office of the user to appear at the top of the list and the rest to appear below in the order ascending order.

    Example:

    Name  Office
    Mike    1
    Alex    2
    John    6
    Steve   2
    Sarah   3

    If my office is office 2, I want those to appear at the top like so

    Name  Office
    Alex    2
    Steve   2
    Mike    1
    Sarah   3
    John    6

Is there a way to do this in some type of clause or would I have to create a temp table, do the first search on only the specific office ID and then add the rest to the table where its not the same as that ID. I feel like that's a complete hack and would prefer not to do that if not needed. 

Thanks!",3
8054152,11/08/2011 16:55:47,1025915,11/02/2011 15:08:20,47,4,SSRS BIDS 2008 R2 pie chart data labels overlapping,"![enter image description here][1]


  [1]: http://i.stack.imgur.com/HixWI.jpg

As seen in image, the data labels are overlapping and making the data difficult to read. Anybody know how to sort this?",sql-server,sql-server-2008,reporting-services,bids,pie-chart,,open,0,28,9,"SSRS BIDS 2008 R2 pie chart data labels overlapping ![enter image description here][1]


  [1]: http://i.stack.imgur.com/HixWI.jpg

As seen in image, the data labels are overlapping and making the data difficult to read. Anybody know how to sort this?",5
11441404,07/11/2012 21:00:43,83169,03/26/2009 15:01:21,416,17,Why would a SQL Server 2008 R2 database disable a table index when upgraded to SQL Server 2012,"I've restored a database backup in a new SQL Server 2012 server from a .bak made in SQL Server 2008 R2, and one of the tables has it's primary key index disabled. This doesn't happen when I restore to a 2008R2 server.

Is this a known problem in SQL Server 2012, or is there something I've missed?

I know that I can fix the problem with an index rebuild, I ask because it's surprising behavior, and want to know how to prevent it.",sql-server,backup,upgrade,,,07/11/2012 22:56:17,off topic,1,81,18,"Why would a SQL Server 2008 R2 database disable a table index when upgraded to SQL Server 2012 I've restored a database backup in a new SQL Server 2012 server from a .bak made in SQL Server 2008 R2, and one of the tables has it's primary key index disabled. This doesn't happen when I restore to a 2008R2 server.

Is this a known problem in SQL Server 2012, or is there something I've missed?

I know that I can fix the problem with an index rebuild, I ask because it's surprising behavior, and want to know how to prevent it.",3
7216216,08/27/2011 17:40:18,811785,06/23/2011 07:50:59,2240,213,How to manage saved login info in SSMS login dialog?,"SSMS (SQL Server Management Studio) has saved 3 login information on my computer. However, when I tell it to remeber the 4th login info, it simply won't remember anything next time.

![enter image description here][1]

This means that each and every time I want to connect using that Login, I should provide user name and password, and this really sucks.

Do you know how can we manage saved login information of the login Dialog?


  [1]: http://i.stack.imgur.com/yq7Wa.png",sql-server,ssms,,,,08/27/2011 23:09:10,off topic,1,74,10,"How to manage saved login info in SSMS login dialog? SSMS (SQL Server Management Studio) has saved 3 login information on my computer. However, when I tell it to remeber the 4th login info, it simply won't remember anything next time.

![enter image description here][1]

This means that each and every time I want to connect using that Login, I should provide user name and password, and this really sucks.

Do you know how can we manage saved login information of the login Dialog?


  [1]: http://i.stack.imgur.com/yq7Wa.png",2
11312142,07/03/2012 13:36:21,1271581,03/15/2012 13:04:04,3,0,using ADO.NET to select from multiple VFP tables,"I need to select from 2 VFP free tables on some different network locations.
I've managed to get both tables into a dataset as two DataTables and add a Relation for them.
Now I need to join them and the result to insert into a SQL server database.
Any ideas ?
Thank you",sql-server,ado.net,vfp,,,,open,0,49,8,"using ADO.NET to select from multiple VFP tables I need to select from 2 VFP free tables on some different network locations.
I've managed to get both tables into a dataset as two DataTables and add a Relation for them.
Now I need to join them and the result to insert into a SQL server database.
Any ideas ?
Thank you",3
1142296,07/17/2009 09:36:28,75500,03/09/2009 06:16:32,581,52,Performance consideration: Spread rows in multiple tables vs concentrate all rows in one table.,"## Performance consideration: Spread rows in multiple tables vs concentrate all rows in one table. ##

Hi.

I need to log information about about every step that goes on in the application in an SQL DB.
There are certain tables, I want the log should be related to:
Product - should log when a product has been created changed etc.
Order - same as above
Shipping - same
etc. etc. etc.


The data will be need to be retrieved often.

I have few ideas on how to do it:

 1. Have a log table that will contain columns for all these tables, then when I wanna represent data in the UI for a certain Product will do select * from Log where LogId = Product.ProductId.
I know that this might be funny to have many cols, but I have this feeling that performance will be better. In the other hand there will be a huge amount of rows in this table.
 2. Have many log tables for each log type (ProductLogs, OrderLogs etc.) I really don't like this idea since it's not consistent and have many tables with same structure doesn't make sense, but (?) it might be quicker when searching in a table that has a lower amount of rows (m i wrong?).
 3. According to statement no. 1, I could do a second many-2-many table that will have LogId, TableNameId and RowId cols, and will reference a log row to many table rows in the DB, than will have a UDF to retrieve data (e.g. log id 234 belongs to table Customer at CustomerId 345 and to Product table where productId = RowId); I think this is the nicest way to do it, but again, there might be a huge amount of rows, will it slow down the search? or this is how it should be done, whatcha say?...",sql-server,sql,performance,datastorage,,,open,0,301,14,"Performance consideration: Spread rows in multiple tables vs concentrate all rows in one table. ## Performance consideration: Spread rows in multiple tables vs concentrate all rows in one table. ##

Hi.

I need to log information about about every step that goes on in the application in an SQL DB.
There are certain tables, I want the log should be related to:
Product - should log when a product has been created changed etc.
Order - same as above
Shipping - same
etc. etc. etc.


The data will be need to be retrieved often.

I have few ideas on how to do it:

 1. Have a log table that will contain columns for all these tables, then when I wanna represent data in the UI for a certain Product will do select * from Log where LogId = Product.ProductId.
I know that this might be funny to have many cols, but I have this feeling that performance will be better. In the other hand there will be a huge amount of rows in this table.
 2. Have many log tables for each log type (ProductLogs, OrderLogs etc.) I really don't like this idea since it's not consistent and have many tables with same structure doesn't make sense, but (?) it might be quicker when searching in a table that has a lower amount of rows (m i wrong?).
 3. According to statement no. 1, I could do a second many-2-many table that will have LogId, TableNameId and RowId cols, and will reference a log row to many table rows in the DB, than will have a UDF to retrieve data (e.g. log id 234 belongs to table Customer at CustomerId 345 and to Product table where productId = RowId); I think this is the nicest way to do it, but again, there might be a huge amount of rows, will it slow down the search? or this is how it should be done, whatcha say?...",4
2112882,01/21/2010 21:03:23,113343,05/27/2009 18:43:14,10,2,Designing a conditional database relationship in MS SQL Server,"I have three basic types of entities: People, Businesses, and Assets.  Each Asset can be owned by one and only one Person or Business.  Each Person and Business can own from 0 to many Assets.  What would be the best practice for storing this type of conditional relationship in Microsoft SQL Server?

My initial plan is to have two nullable foreign keys in the Assets table, one for People and one for Businesses.  One of these values will be null, while the other will point to the owner.  The problem I see with this setup is that it requires application logic in order to be interpreted and enforced.  Is this really the best possible solution or are there other options?",sql-server,database-design,database,,,,open,0,125,9,"Designing a conditional database relationship in MS SQL Server I have three basic types of entities: People, Businesses, and Assets.  Each Asset can be owned by one and only one Person or Business.  Each Person and Business can own from 0 to many Assets.  What would be the best practice for storing this type of conditional relationship in Microsoft SQL Server?

My initial plan is to have two nullable foreign keys in the Assets table, one for People and one for Businesses.  One of these values will be null, while the other will point to the owner.  The problem I see with this setup is that it requires application logic in order to be interpreted and enforced.  Is this really the best possible solution or are there other options?",3
7024641,08/11/2011 10:57:26,244279,01/05/2010 21:45:08,109,8,sql server restore backup error,"when i try to restore a sql server 2008 r2 backup I got this error 

System.Data.SqlClient.SqlError: Cannot open backup device 'C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQLEXPRESS\MSSQL\Backup\erp_20118110.bak'. Operating system error 5(failed to retrieve text for this error. Reason: 15105). (Microsoft.SqlServer.Smo)


what is this mean ??",sql-server,sql-server-2008,,,,08/12/2011 14:42:13,off topic,1,41,5,"sql server restore backup error when i try to restore a sql server 2008 r2 backup I got this error 

System.Data.SqlClient.SqlError: Cannot open backup device 'C:\Program Files\Microsoft SQL Server\MSSQL10_50.SQLEXPRESS\MSSQL\Backup\erp_20118110.bak'. Operating system error 5(failed to retrieve text for this error. Reason: 15105). (Microsoft.SqlServer.Smo)


what is this mean ??",2
11717020,07/30/2012 07:25:20,100034,05/03/2009 00:14:58,82,0,MS SQL Database Backups,"I am looking to do regular backups of my MS SQL Server databases.

Is there any reason why I should not just backup just the MSSQL.10/DATA folder? I've got a great backup solution in place from Rackspace which does incremental change based backups. ",sql-server,backups,,,,08/01/2012 00:24:09,off topic,1,43,4,"MS SQL Database Backups I am looking to do regular backups of my MS SQL Server databases.

Is there any reason why I should not just backup just the MSSQL.10/DATA folder? I've got a great backup solution in place from Rackspace which does incremental change based backups. ",2
3174897,07/04/2010 13:59:02,383093,07/04/2010 13:30:48,1,0,SQL Server Exam ,"I have basic knowledge of SQL Server and interested to gain much more and for that I would like to give SQL server Certification exam, Can Anyone please Suggest me any good certification   
and exam ?? ",sql-server,,,,,07/04/2010 17:39:31,off topic,1,39,4,"SQL Server Exam  I have basic knowledge of SQL Server and interested to gain much more and for that I would like to give SQL server Certification exam, Can Anyone please Suggest me any good certification   
and exam ?? ",1
312576,11/23/2008 14:39:21,4639,09/04/2008 23:07:22,511,3,How to simply generate the CREATE SQL script for a table and data?,"So i'm used to PHPMySQL where if I want to transfer a table from one database to another, I:

- go to the table
- click ""export""
- CTRL-C
- go to the other database, insert SQL, CTRL-V

In MS SQL Server 2008 Express, I try:

- right-click, script table as, CREATE TO
    - but this only gives me the CREATE TABLE sql, not the INSERT INTO sql
- right-click, script table as, INSERT TO
    - this gives me INSERT TO sql but assumes that I am going to fill in the data (!)
- so I fire up the SQL Server 2008 Express Import/Export Data Wizard, but it doesn't seem to give me the simple CREATE/INSERT INTO script that I want either. :-(

So how can I get a simple SQL dump of a table in MS SQL Server 2008 Express, the kind that PHPMySQL gives me:

    -- phpMyAdmin SQL Dump
    -- version 2.11.9.2
    -- http://www.phpmyadmin.net
    --
    -- Host: localhost
    -- Generation Time: Nov 23, 2008 at 03:34 PM
    -- Server version: 5.0.67
    -- PHP Version: 5.2.6
    
    SET SQL_MODE=""NO_AUTO_VALUE_ON_ZERO"";
    
    --
    -- Database: `test`
    --
    
    -- --------------------------------------------------------
    
    --
    -- Table structure for table `members`
    --
    
    CREATE TABLE IF NOT EXISTS `members` (
      `id` int(11) NOT NULL auto_increment,
      `firstName` varchar(50) collate latin1_general_ci NOT NULL,
      `lastName` varchar(50) collate latin1_general_ci NOT NULL,
      `age` int(11) NOT NULL,
      PRIMARY KEY  (`id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci AUTO_INCREMENT=4 ;
    
    --
    -- Dumping data for table `members`
    --
    
    INSERT INTO `members` (`id`, `firstName`, `lastName`, `age`) VALUES
    (1, 'Jim', 'Taylor', 34),
    (2, 'John', 'McGregor', 23),
    (3, 'Alice', 'Anderson', 33);



",sql-server,,,,,,open,0,388,13,"How to simply generate the CREATE SQL script for a table and data? So i'm used to PHPMySQL where if I want to transfer a table from one database to another, I:

- go to the table
- click ""export""
- CTRL-C
- go to the other database, insert SQL, CTRL-V

In MS SQL Server 2008 Express, I try:

- right-click, script table as, CREATE TO
    - but this only gives me the CREATE TABLE sql, not the INSERT INTO sql
- right-click, script table as, INSERT TO
    - this gives me INSERT TO sql but assumes that I am going to fill in the data (!)
- so I fire up the SQL Server 2008 Express Import/Export Data Wizard, but it doesn't seem to give me the simple CREATE/INSERT INTO script that I want either. :-(

So how can I get a simple SQL dump of a table in MS SQL Server 2008 Express, the kind that PHPMySQL gives me:

    -- phpMyAdmin SQL Dump
    -- version 2.11.9.2
    -- http://www.phpmyadmin.net
    --
    -- Host: localhost
    -- Generation Time: Nov 23, 2008 at 03:34 PM
    -- Server version: 5.0.67
    -- PHP Version: 5.2.6
    
    SET SQL_MODE=""NO_AUTO_VALUE_ON_ZERO"";
    
    --
    -- Database: `test`
    --
    
    -- --------------------------------------------------------
    
    --
    -- Table structure for table `members`
    --
    
    CREATE TABLE IF NOT EXISTS `members` (
      `id` int(11) NOT NULL auto_increment,
      `firstName` varchar(50) collate latin1_general_ci NOT NULL,
      `lastName` varchar(50) collate latin1_general_ci NOT NULL,
      `age` int(11) NOT NULL,
      PRIMARY KEY  (`id`)
    ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci AUTO_INCREMENT=4 ;
    
    --
    -- Dumping data for table `members`
    --
    
    INSERT INTO `members` (`id`, `firstName`, `lastName`, `age`) VALUES
    (1, 'Jim', 'Taylor', 34),
    (2, 'John', 'McGregor', 23),
    (3, 'Alice', 'Anderson', 33);



",1
11202485,06/26/2012 07:22:26,1021306,10/31/2011 02:14:18,55,3,A better database design on SQL Server?,"In SQL Server, I have got to design a User table. It should have a UserID (int), a RoleID (int) and a UserName (nvarchar(255)).

A user can be assigned with a name but possibly multiple roles so a UserId may correspond to multiple RoleIDs. This makes it difficult to assign primary key to UserID as UserID may duplicate.

Is there any better design other than breaking it up into multiple tables?

Thanks

Cheers,
Alex

",sql-server,database-design,,,,,open,0,69,7,"A better database design on SQL Server? In SQL Server, I have got to design a User table. It should have a UserID (int), a RoleID (int) and a UserName (nvarchar(255)).

A user can be assigned with a name but possibly multiple roles so a UserId may correspond to multiple RoleIDs. This makes it difficult to assign primary key to UserID as UserID may duplicate.

Is there any better design other than breaking it up into multiple tables?

Thanks

Cheers,
Alex

",2
4991513,02/14/2011 11:15:56,244667,01/06/2010 11:46:28,118,10,Where do I download installer for MS SQL Server 2005 ODBC connectivity drivers?,"Okay I give up, where do I download an installer for the MS SQL Server 2005 ODBC driver that I can distribute to our users?",sql-server,sql-server-2005,windows-installer,,,02/16/2011 02:51:10,off topic,1,25,13,"Where do I download installer for MS SQL Server 2005 ODBC connectivity drivers? Okay I give up, where do I download an installer for the MS SQL Server 2005 ODBC driver that I can distribute to our users?",3
3996146,10/22/2010 11:00:31,41360,11/27/2008 12:59:33,13441,522,Is there a possible race condition in this UPDATE statement?,"I'm writing a synchronizer software which will take all changes in one DB and synchronize them to another DB. To this end I've added in my table `T` two columns:

    alter table T add LastUpdate rowversion, LastSync binary(8) not null default 0

Now I can easily select all rows that have changed since the last synchronization:

    select * from T where LastUpdate > LastSync

However after performing the synchronization I should make the two fields equal. But updating the row also updates the timestamp, so I must do this:

    update T set LastSync=@@DBTS+1 where ID=@syncedId


But I'm wondering - will this always work? What if I read the value of `@@DBTS` and then another user manages to insert/update a row somewhere before my row is committed? Is this risky code? And if yes - how could it be made better?",sql-server,update,timestamp,race-condition,rowversion,,open,0,146,10,"Is there a possible race condition in this UPDATE statement? I'm writing a synchronizer software which will take all changes in one DB and synchronize them to another DB. To this end I've added in my table `T` two columns:

    alter table T add LastUpdate rowversion, LastSync binary(8) not null default 0

Now I can easily select all rows that have changed since the last synchronization:

    select * from T where LastUpdate > LastSync

However after performing the synchronization I should make the two fields equal. But updating the row also updates the timestamp, so I must do this:

    update T set LastSync=@@DBTS+1 where ID=@syncedId


But I'm wondering - will this always work? What if I read the value of `@@DBTS` and then another user manages to insert/update a row somewhere before my row is committed? Is this risky code? And if yes - how could it be made better?",5
7571422,09/27/2011 15:08:51,177317,09/22/2009 18:02:58,1972,127,What is a suggested naming convention for SQL server code?,"How would you improve the layout of the following SQL code?

    declare @tree table (parent int not null, child int not null, contents int not null)
    
    insert into @tree
    select 0,1, 1
    union
    select 1,2, 2
    union
    select 2,3, 3
    union
    select 3,4, 4
    union
    select 2,5, 5
    ;
    
    with leaf_path as
    (
    	select parent, child, contents, cast(child as nvarchar(50)) as p
    		from @tree
    		where parent = 0
    	union all
    	select t.parent, t.child, t.contents,
    			cast(r.p + '-' + cast(t.contents as nvarchar(10)) as nvarchar(50)) as p
    		from @tree t
    			join leaf_path r
    				on t.parent = r.child
    )
    select distinct p from leaf_path r where not exists (select * from @tree where parent = r.child)

",sql-server,sql-server-2005,naming-conventions,code-formatting,,09/27/2011 18:42:51,off topic,1,196,10,"What is a suggested naming convention for SQL server code? How would you improve the layout of the following SQL code?

    declare @tree table (parent int not null, child int not null, contents int not null)
    
    insert into @tree
    select 0,1, 1
    union
    select 1,2, 2
    union
    select 2,3, 3
    union
    select 3,4, 4
    union
    select 2,5, 5
    ;
    
    with leaf_path as
    (
    	select parent, child, contents, cast(child as nvarchar(50)) as p
    		from @tree
    		where parent = 0
    	union all
    	select t.parent, t.child, t.contents,
    			cast(r.p + '-' + cast(t.contents as nvarchar(10)) as nvarchar(50)) as p
    		from @tree t
    			join leaf_path r
    				on t.parent = r.child
    )
    select distinct p from leaf_path r where not exists (select * from @tree where parent = r.child)

",4
3031514,06/13/2010 07:58:08,246392,01/08/2010 12:44:53,191,2,What goes between SQL Server and Client?,"This question is an updated version of a previous question I have asked on here. 

I am new to client-server model with SQL Server as the relational database. I have read that public access to SQL Server is not secure. If direct access to the database is not a good practice, then what kind of layer should be placed between the server and the client? Note that I have a <b>desktop application</b> that will serve as the client and a remote SQL Server database that will provide data to the client. The client will input their username and password in order to see their data. I have heard of terms like VPN, ISA, TMG, Terminal Services, proxy server, and so on. I need a fast and secure n-tier architecture.

P.S. I have heard of web services in front of the database. Can I use WCF to retrieve, update, insert data? Would it be a good approach in terms of security and performance?
",sql-server,client-server,n-tier-architecture,,,,open,0,161,7,"What goes between SQL Server and Client? This question is an updated version of a previous question I have asked on here. 

I am new to client-server model with SQL Server as the relational database. I have read that public access to SQL Server is not secure. If direct access to the database is not a good practice, then what kind of layer should be placed between the server and the client? Note that I have a <b>desktop application</b> that will serve as the client and a remote SQL Server database that will provide data to the client. The client will input their username and password in order to see their data. I have heard of terms like VPN, ISA, TMG, Terminal Services, proxy server, and so on. I need a fast and secure n-tier architecture.

P.S. I have heard of web services in front of the database. Can I use WCF to retrieve, update, insert data? Would it be a good approach in terms of security and performance?
",3
6303995,06/10/2011 08:44:55,479291,03/02/2010 10:24:51,615,36,what is a difference between Clustered Index and Unique Index?,"I am just learning about Indexing in SQL server but got confuse between Clustered and Unique index. if both are applied on a unique key column ex: PersonID. so what is difference between both.

Thanx.",sql-server,sql-server-2005,sql-server-2008,,,,open,0,34,10,"what is a difference between Clustered Index and Unique Index? I am just learning about Indexing in SQL server but got confuse between Clustered and Unique index. if both are applied on a unique key column ex: PersonID. so what is difference between both.

Thanx.",3
11405351,07/10/2012 01:12:56,1038429,11/09/2011 19:46:15,73,3,How to link multiple Name-Value pairs to individual fields in InfoPath 2010?,"I have 2 tables: Form and FormItem. The FormItem table has a FormItemID (PK), FormID (FK), Name, and Value. I'm using InfoPath 2010 with SQL Server 2008 R2 to create forms so the users can view/update the data. 

I want to design an InfoPath form and link each name/value pair to a specific, individual label/input control. How can I achieve this in InfoPath?",sql-server,infopath,infopath2010,name-value,,,open,0,63,12,"How to link multiple Name-Value pairs to individual fields in InfoPath 2010? I have 2 tables: Form and FormItem. The FormItem table has a FormItemID (PK), FormID (FK), Name, and Value. I'm using InfoPath 2010 with SQL Server 2008 R2 to create forms so the users can view/update the data. 

I want to design an InfoPath form and link each name/value pair to a specific, individual label/input control. How can I achieve this in InfoPath?",4
11085038,06/18/2012 14:32:13,1090112,12/09/2011 16:25:48,14,2,Problems whith sqlserver in functions nullif,"What´s the diference betwen **isnull** and **nullif** function in sqlserver ?

Tks",sql-server,,,,,06/18/2012 16:21:49,not a real question,1,11,6,"Problems whith sqlserver in functions nullif What´s the diference betwen **isnull** and **nullif** function in sqlserver ?

Tks",1
3893772,10/08/2010 19:37:46,318610,04/16/2010 15:06:24,71,2,What is the best platform for particular server-side development,"We are building the server side of some gaming platform where a great load of mobile devices (a.k.a - mobile phones for time being) connect to a server, send some small information each second (or even less) and receive some small response based on calculations.

The data has a DB back end (sql server for now).

We have implemented this using HTTP GET (with ASP.NET), but obviously it's not good or scalable for this need.

What would be the best approach for building this stack? (i.e - Windows/Linux, programming language, design patterns). It's very important that we could scale it up pretty easily.

Many thanks!",sql-server,mobile,,,,10/08/2010 23:18:00,not constructive,1,101,9,"What is the best platform for particular server-side development We are building the server side of some gaming platform where a great load of mobile devices (a.k.a - mobile phones for time being) connect to a server, send some small information each second (or even less) and receive some small response based on calculations.

The data has a DB back end (sql server for now).

We have implemented this using HTTP GET (with ASP.NET), but obviously it's not good or scalable for this need.

What would be the best approach for building this stack? (i.e - Windows/Linux, programming language, design patterns). It's very important that we could scale it up pretty easily.

Many thanks!",2
8291825,11/28/2011 05:23:15,511041,11/17/2010 16:44:22,159,1,Failover solution for SQL Server 2008 R2 Web Edition,"I need to create failover solution with two servers using Windows Web server 2008 R2 and SQL Server 2008 R2 Web Edition.

Log shipping that Web Edition supports  is not useful for me, because some data can be lost.

Is it possible to use shared disk and manually attach db to the stand by server if main server is down.

What kind of shared disk can I use?

Any solution?",sql-server,sql-server-2008,,,,11/28/2011 19:06:49,off topic,1,66,9,"Failover solution for SQL Server 2008 R2 Web Edition I need to create failover solution with two servers using Windows Web server 2008 R2 and SQL Server 2008 R2 Web Edition.

Log shipping that Web Edition supports  is not useful for me, because some data can be lost.

Is it possible to use shared disk and manually attach db to the stand by server if main server is down.

What kind of shared disk can I use?

Any solution?",2
1752548,11/17/2009 23:13:07,59160,01/26/2009 23:18:00,78,6,(Probably) Simple SQL Server cursor question,"I need to call two stored procedures in sequence via ODBC in PHP:

    #run stored procedure 1
    $query = ""Shipped_Not_Shipped_Rep "".$_GET['rep_id'];
    $result = odbc_exec($dbh, $query);
    odbc_result_all($result);
    
    #run stored procedure 2
    $query = ""Shipped_Not_Shipped_Account "".$_GET['account_id'];
    $result = odbc_exec($dbh, $query);
    odbc_result_all($result);

I'm getting this error in PHP after the second stored procedure call:

*Warning: odbc_exec() [function.odbc-exec]: SQL error: [unixODBC][FreeTDS][SQL Server]Invalid cursor state, SQL state 24000 in SQLExecDirect*

If I re-arrange the order I call the stored procedures, it is always the second that errors.  Is there a way to, idk, reset the cursor position between calls?  A little out of my element here.",sql-server,stored-procedures,cursor,odbc,php,,open,0,128,6,"(Probably) Simple SQL Server cursor question I need to call two stored procedures in sequence via ODBC in PHP:

    #run stored procedure 1
    $query = ""Shipped_Not_Shipped_Rep "".$_GET['rep_id'];
    $result = odbc_exec($dbh, $query);
    odbc_result_all($result);
    
    #run stored procedure 2
    $query = ""Shipped_Not_Shipped_Account "".$_GET['account_id'];
    $result = odbc_exec($dbh, $query);
    odbc_result_all($result);

I'm getting this error in PHP after the second stored procedure call:

*Warning: odbc_exec() [function.odbc-exec]: SQL error: [unixODBC][FreeTDS][SQL Server]Invalid cursor state, SQL state 24000 in SQLExecDirect*

If I re-arrange the order I call the stored procedures, it is always the second that errors.  Is there a way to, idk, reset the cursor position between calls?  A little out of my element here.",5
9523743,03/01/2012 20:42:14,1243678,03/01/2012 20:36:50,1,0,Update table row based on 3 OR conditions,"I have a table  that contains three user ID columns and an Active column

Table1
--------
userID1
userID2
userID3
Active


I want to set each row to be inactive (Active = 0) where given two UserIDs exist in the same row. Whats the fastest and most logical way to achieve this?

Thanks!",sql-server,,,,,,open,0,45,8,"Update table row based on 3 OR conditions I have a table  that contains three user ID columns and an Active column

Table1
--------
userID1
userID2
userID3
Active


I want to set each row to be inactive (Active = 0) where given two UserIDs exist in the same row. Whats the fastest and most logical way to achieve this?

Thanks!",1
11744880,07/31/2012 16:32:55,520260,11/25/2010 14:13:09,176,5,SQL Server 'Create Database' statement. How to inherit autogrowth settings?,"I am using SQL Server 2008 R2 and creating databases through continuous deployment.

In our system, the default 1Mb/10% autogrowth settings in SQL Server work badly with our data. Particularly as we have a legacy application that prevents us from changing the schema much. We would like the database settings to be configured at the instance level so we can change it for staged deployments.

I have read in several places that default settings for a new db are based on the settings for 'model', but it appears this only works by clicking new database in SQL Management studio UI and not from a script e.g. CREATE DATABASE [MyDb]. 

[msdn.microsoft.com/en-us/library/ms186388(v=sql.105).aspx][1] 

[sqlservercentral.com/Forums/Topic1065073-391-1.aspx][2] 

[http://stackoverflow.com/questions/8828557/possible-to-configure-database-autogrowth-settings-at-the-instance-level/8828604#comment15586568_8828604][3]

Has anyone actually got this to work with a create script? Is there another way I can set autogrowth per server instance?


  [1]: http://msdn.microsoft.com/en-us/library/ms186388%28v=sql.105%29.aspx
  [2]: http://sqlservercentral.com/Forums/Topic1065073-391-1.aspx
  [3]: http://stackoverflow.com/questions/8828557/possible-to-configure-database-autogrowth-settings-at-the-instance-level/8828604#comment15586568_8828604",sql-server,database,transaction-log,,,07/31/2012 17:11:54,off topic,1,140,10,"SQL Server 'Create Database' statement. How to inherit autogrowth settings? I am using SQL Server 2008 R2 and creating databases through continuous deployment.

In our system, the default 1Mb/10% autogrowth settings in SQL Server work badly with our data. Particularly as we have a legacy application that prevents us from changing the schema much. We would like the database settings to be configured at the instance level so we can change it for staged deployments.

I have read in several places that default settings for a new db are based on the settings for 'model', but it appears this only works by clicking new database in SQL Management studio UI and not from a script e.g. CREATE DATABASE [MyDb]. 

[msdn.microsoft.com/en-us/library/ms186388(v=sql.105).aspx][1] 

[sqlservercentral.com/Forums/Topic1065073-391-1.aspx][2] 

[http://stackoverflow.com/questions/8828557/possible-to-configure-database-autogrowth-settings-at-the-instance-level/8828604#comment15586568_8828604][3]

Has anyone actually got this to work with a create script? Is there another way I can set autogrowth per server instance?


  [1]: http://msdn.microsoft.com/en-us/library/ms186388%28v=sql.105%29.aspx
  [2]: http://sqlservercentral.com/Forums/Topic1065073-391-1.aspx
  [3]: http://stackoverflow.com/questions/8828557/possible-to-configure-database-autogrowth-settings-at-the-instance-level/8828604#comment15586568_8828604",3
3783250,09/23/2010 23:38:57,34504,11/05/2008 00:24:42,644,37,Need help locking my code for SQL Server,"We want to build into our software the capability to build SQL queries freehand (currently cannot do so with our software), but need to be able to lock it down so that users cannot make any changes, only select data from certain tables.  Are there any good guides for helping me to lock this down appropriately (ie, least permissions needed, suggested forbidden keywords, etc)?  Or do I just need to continue browsing the web and absorbing all of the SQL Server security tutorials (aimed at the system itself, rather than programming) I find?  Thanks.",sql-server,security,delphi,data-access,,,open,0,97,8,"Need help locking my code for SQL Server We want to build into our software the capability to build SQL queries freehand (currently cannot do so with our software), but need to be able to lock it down so that users cannot make any changes, only select data from certain tables.  Are there any good guides for helping me to lock this down appropriately (ie, least permissions needed, suggested forbidden keywords, etc)?  Or do I just need to continue browsing the web and absorbing all of the SQL Server security tutorials (aimed at the system itself, rather than programming) I find?  Thanks.",4
10172693,04/16/2012 10:49:06,623190,02/18/2011 13:21:20,82,10,How to check if a script is compatible with sql server 2000,"I wrote a lot of scripts for SQL Server 2005.
The task has changed. Now this work should be done for SQL Server 2000.
Which tool to use for cheking syntax of the scripts?
Can it be done with SSMS 2008?",sql-server,,,,,04/16/2012 19:18:33,not a real question,1,38,12,"How to check if a script is compatible with sql server 2000 I wrote a lot of scripts for SQL Server 2005.
The task has changed. Now this work should be done for SQL Server 2000.
Which tool to use for cheking syntax of the scripts?
Can it be done with SSMS 2008?",1
3687568,09/10/2010 19:08:54,213474,11/18/2009 04:30:28,8705,374,How can I tell if a long running query is stuck?,"I have a query that is taking a lot longer then usual, and I cannot tell if it is stuck.

The query is something like this:

    INSERT XXXXXX
    SELECT * FROM YYYYYY
    WHERE ZZZZZZZZ = 1

This will insert hundreds of millions of rows.  I have an index on ZZZZZZZZ.

There are no blocking sessions.  When I check sys.dm_exec_requests, it shows that the last wait type is **PAGEIOLATCH_SH**  I'm not sure what this means, except that it has something to do with I/O.

sys.dm_exec_sessions shows the status is RUNNING, but sp_who2 shows it as SUSPENDED.

I tried to see if the table is growing, but when I call sp_spaceused XXXXXX, I keep getting the same values.

What else can I do?
",sql-server,tsql,,,,,open,0,127,11,"How can I tell if a long running query is stuck? I have a query that is taking a lot longer then usual, and I cannot tell if it is stuck.

The query is something like this:

    INSERT XXXXXX
    SELECT * FROM YYYYYY
    WHERE ZZZZZZZZ = 1

This will insert hundreds of millions of rows.  I have an index on ZZZZZZZZ.

There are no blocking sessions.  When I check sys.dm_exec_requests, it shows that the last wait type is **PAGEIOLATCH_SH**  I'm not sure what this means, except that it has something to do with I/O.

sys.dm_exec_sessions shows the status is RUNNING, but sp_who2 shows it as SUSPENDED.

I tried to see if the table is growing, but when I call sp_spaceused XXXXXX, I keep getting the same values.

What else can I do?
",2
7353844,09/08/2011 20:09:13,935641,09/08/2011 20:09:13,1,0,How do i find this out?,"if i have the data for example :

ProductName     ServiceDate   Name   StockId   Fee

LG                1/10/2011    John   1         0 
Sony              2/20/2011    Mike   2         0 
LG                1/11/2011    John   1         0
Samsung           2/21/2011    Steve  3         0 
Toshiba           3/2/2011     Kelly  4         0 
LG                5/6/2011     Sean   1         0   

now imagine there are millions of records. how do i find out the people who bought product in the same month with same stockid? ",sql-server,,,,,,open,0,233,6,"How do i find this out? if i have the data for example :

ProductName     ServiceDate   Name   StockId   Fee

LG                1/10/2011    John   1         0 
Sony              2/20/2011    Mike   2         0 
LG                1/11/2011    John   1         0
Samsung           2/21/2011    Steve  3         0 
Toshiba           3/2/2011     Kelly  4         0 
LG                5/6/2011     Sean   1         0   

now imagine there are millions of records. how do i find out the people who bought product in the same month with same stockid? ",1
8537544,12/16/2011 17:01:12,76487,03/11/2009 04:36:23,670,16,Is there any benefit to an index when the column is only used for (hash) joining?,"Lets say that a column will only be used for joining. (i.e. I won't be ordering on the column, nor will a search for specific values in the column individually) ... the only thing that I will use the column for is joining to another table.

If the database supports Hash Joins (which from my understanding don't benefit from indexes) .. then wouldn't the addition of an index be completely redundant? (and wasteful) ?



",sql-server,oracle,join,index,,,open,0,73,16,"Is there any benefit to an index when the column is only used for (hash) joining? Lets say that a column will only be used for joining. (i.e. I won't be ordering on the column, nor will a search for specific values in the column individually) ... the only thing that I will use the column for is joining to another table.

If the database supports Hash Joins (which from my understanding don't benefit from indexes) .. then wouldn't the addition of an index be completely redundant? (and wasteful) ?



",4
11067383,06/16/2012 22:04:24,370401,06/18/2010 14:48:05,704,9,"If web application and SQL Server are on different machines on intranet, can Windows anthentication still be used?","If web application and SQL Server are on different machines(both running Windows) on intranet, can Windows anthentication still be used to access SQl Server or SQL authentication mode need to be used?",sql-server,,,,,,open,0,32,18,"If web application and SQL Server are on different machines on intranet, can Windows anthentication still be used? If web application and SQL Server are on different machines(both running Windows) on intranet, can Windows anthentication still be used to access SQl Server or SQL authentication mode need to be used?",1
9028468,01/27/2012 03:01:46,934116,09/08/2011 05:43:59,95,4,"Mutiple SELECTs against the same table, but with different ORDER BY","I'd like to fetch data from the same table, but ordered by 2 different fields, based on the value of a third field

i.e.

    SELECT * FROM MyTable
    WHERE Status = 0
    ORDER BY SortOrder
    
    UNION
    
    SELECT * FROM MyTable
    WHERE Status = 1
    ORDER BY ModifiedAt DESC

Of course, I can't have 2 ORDER BYs in a UNION, so wondering if there is a better (performance-wise) way without having to resort to 2 database queries - perhaps via a subquery of some sort?

",sql-server,select,union,,,,open,0,111,11,"Mutiple SELECTs against the same table, but with different ORDER BY I'd like to fetch data from the same table, but ordered by 2 different fields, based on the value of a third field

i.e.

    SELECT * FROM MyTable
    WHERE Status = 0
    ORDER BY SortOrder
    
    UNION
    
    SELECT * FROM MyTable
    WHERE Status = 1
    ORDER BY ModifiedAt DESC

Of course, I can't have 2 ORDER BYs in a UNION, so wondering if there is a better (performance-wise) way without having to resort to 2 database queries - perhaps via a subquery of some sort?

",3
2014814,01/06/2010 17:21:54,16012,09/17/2008 14:05:17,2152,49,SQL server queries are really slow only on first run,"Somewhat strange problem... when I start my .NET app for the first time after rebooting my machine, the SQL Server queries are really slow... when I pause the debugger, I notice that it's hanging on getting the response from the query.  This only happens when connecting to a remote SQL server (2008)... if I connect to one on my local machine, it's fine.  Also, if I restart the app, it works fast, even off the remote SQL server, and subsequent runs are also fine.  The only problem is when I connect to a remote SQL server for the first time after rebooting my machine.  What's more, I have even noticed this same exact behavior with a 3rd party app (also .NET) that also connects to a remote SQL server.

Another piece of info... this has only started hapenning since I upgraded my machine from XP to Win7 (64 bit).  Also, other developers on my team who upgraded to Win7 are seeing the same behavior (both with the app we're developing and the 3rd party .NET app).",sql-server,windows-7,windows-7-x64,.net,performance,,open,0,180,10,"SQL server queries are really slow only on first run Somewhat strange problem... when I start my .NET app for the first time after rebooting my machine, the SQL Server queries are really slow... when I pause the debugger, I notice that it's hanging on getting the response from the query.  This only happens when connecting to a remote SQL server (2008)... if I connect to one on my local machine, it's fine.  Also, if I restart the app, it works fast, even off the remote SQL server, and subsequent runs are also fine.  The only problem is when I connect to a remote SQL server for the first time after rebooting my machine.  What's more, I have even noticed this same exact behavior with a 3rd party app (also .NET) that also connects to a remote SQL server.

Another piece of info... this has only started hapenning since I upgraded my machine from XP to Win7 (64 bit).  Also, other developers on my team who upgraded to Win7 are seeing the same behavior (both with the app we're developing and the 3rd party .NET app).",5
3593870,08/29/2010 07:07:17,375799,06/25/2010 00:13:20,1171,47,SELECT / INSERT version of an UPSERT: is there a design pattern for high concurrency?,"I want to do the SELECT / INSERT version of an UPSERT. Below is a template of the existing code:

    // CREATE TABLE Table (RowID INT NOT NULL IDENTITY(1,1), RowValue VARCHAR(50))
    
    IF NOT EXISTS (SELECT * FROM Table WHERE RowValue = @VALUE)
    BEGIN
       INSERT Table VALUES (@Value)
       SELECT @id = SCOPEIDENTITY()
    END
    ELSE
       SELECT @id = RowID FROM Table WHERE RowValue = @VALUE)

The query will be called from many concurrent sessions. My performance tests show that it will consistently throw primary key violations under a specific load.

Is there a high-concurrency method for this query that will allow it to maintain performance while still avoiding the insertion of data that already exists? 






",sql-server,tsql,sql-server-2008,design-patterns,concurrency,,open,0,149,15,"SELECT / INSERT version of an UPSERT: is there a design pattern for high concurrency? I want to do the SELECT / INSERT version of an UPSERT. Below is a template of the existing code:

    // CREATE TABLE Table (RowID INT NOT NULL IDENTITY(1,1), RowValue VARCHAR(50))
    
    IF NOT EXISTS (SELECT * FROM Table WHERE RowValue = @VALUE)
    BEGIN
       INSERT Table VALUES (@Value)
       SELECT @id = SCOPEIDENTITY()
    END
    ELSE
       SELECT @id = RowID FROM Table WHERE RowValue = @VALUE)

The query will be called from many concurrent sessions. My performance tests show that it will consistently throw primary key violations under a specific load.

Is there a high-concurrency method for this query that will allow it to maintain performance while still avoiding the insertion of data that already exists? 






",5
5125140,02/26/2011 04:50:26,613929,02/12/2011 04:41:30,61,1,abstract actual login name from client users & provide them a username under that login to connect to sql server on server machine,"can i use a username to connect to sql server

like we have a login & password to connect to sql server.

so, i have made a winform Form1 with two textboxes in which the person will enter the login name & password which i would then pass to the connection string & then the application would connect to sql server.

now, i created a user 'USEROFLOGIN' under that login.

i want that USEROFLOGIN would connect to sql server. is this possible? i want this because i want to hide the login name from the person, because i want that he enters USEROFLOGIN in the textbox and password , & using that he connects to sql server. the password could be of that login or a new one associated with the USEROFLOGIN.

my application would run on 3 machines namely SERVER, C-1,C-2. used by USERS- ServerUser,C-1User,C-2User. all 3 are on LAN & with windows xp. All 3 would connect to sql server installed on SERVER. 

now, 'serveruser' will create logins L-1,L-2 for C-1user , C-2user, so that both of them can connect to sql database. but i want that 'serveruser' then creates usernames with new passwords under L-1, L-2. these usernames would be used by C-1user, C-2user to connect to sql server, to enter into a database,to create , edit, insert data in the database.  
instead of C-1user & C-2user entering L-1,L-2 in the textbox to connect to sql, they enter a username. 

is this possbile?

i want all this because if C-1user or C-2user installs sql server on their computer then they would be able to see the tables of my database. but if they are not knowing the ACTUAL LOGIN NAME, then they would not be even able to connect to sql server. thats why i want that the ACTUAL LOGIN NAME IS ABSTRACTED FROM THEM  & they know only the USERNAMES  under the ACTUAL LOGINS and they connect to sql server also with that USERNAMES & not with the ACTUAL LOGIN NAMES",sql-server,login,user,connection,,02/26/2011 06:18:28,not a real question,1,332,23,"abstract actual login name from client users & provide them a username under that login to connect to sql server on server machine can i use a username to connect to sql server

like we have a login & password to connect to sql server.

so, i have made a winform Form1 with two textboxes in which the person will enter the login name & password which i would then pass to the connection string & then the application would connect to sql server.

now, i created a user 'USEROFLOGIN' under that login.

i want that USEROFLOGIN would connect to sql server. is this possible? i want this because i want to hide the login name from the person, because i want that he enters USEROFLOGIN in the textbox and password , & using that he connects to sql server. the password could be of that login or a new one associated with the USEROFLOGIN.

my application would run on 3 machines namely SERVER, C-1,C-2. used by USERS- ServerUser,C-1User,C-2User. all 3 are on LAN & with windows xp. All 3 would connect to sql server installed on SERVER. 

now, 'serveruser' will create logins L-1,L-2 for C-1user , C-2user, so that both of them can connect to sql database. but i want that 'serveruser' then creates usernames with new passwords under L-1, L-2. these usernames would be used by C-1user, C-2user to connect to sql server, to enter into a database,to create , edit, insert data in the database.  
instead of C-1user & C-2user entering L-1,L-2 in the textbox to connect to sql, they enter a username. 

is this possbile?

i want all this because if C-1user or C-2user installs sql server on their computer then they would be able to see the tables of my database. but if they are not knowing the ACTUAL LOGIN NAME, then they would not be even able to connect to sql server. thats why i want that the ACTUAL LOGIN NAME IS ABSTRACTED FROM THEM  & they know only the USERNAMES  under the ACTUAL LOGINS and they connect to sql server also with that USERNAMES & not with the ACTUAL LOGIN NAMES",4
899460,05/22/2009 18:59:43,232444,05/20/2009 21:41:12,1,0,Getting the application executable name from T-SQL stored procedure,"From a stored procedure in SQL Server, is it possible to get the name of the executable (ie MyApp.exe) that owns the connection?  I know there is APP_NAME(), but that appears to just return whatever string was passed into the 'Application Name' parameter in the connection string.

If this is possible, how can it be done?  Thanks.",sql-server,storedprocedure,executable,,,,open,0,58,9,"Getting the application executable name from T-SQL stored procedure From a stored procedure in SQL Server, is it possible to get the name of the executable (ie MyApp.exe) that owns the connection?  I know there is APP_NAME(), but that appears to just return whatever string was passed into the 'Application Name' parameter in the connection string.

If this is possible, how can it be done?  Thanks.",3
1098356,07/08/2009 14:13:03,134969,07/08/2009 14:01:33,1,0,"T-SQL, zero sum for no match on join","I have two tables, one with all my Branches, and one with all my sales. The sales table also contains a Sales Rep ID, a Branch ID, a month and a year. 

I need a query that will return the sum of a specific rep's sales for a year, grouped by branch and month, and the query must return 0 if there has been no sales in a branch for that month. I have the following, which does not return 0 if there are no sales:

    SELECT
    	b.BranchName,
    	SUM(s.InvoiceAmount) AS 'Sales'
    FROM 
    	Branch b
    INNER JOIN
    	Sales s ON s.BranchID = b.BranchID
    WHERE
    	s.Year = 2008
    AND
    	s.SalesRepID= 11
    GROUP BY 
    	s.Month,
    	b.BranchName
    ORDER BY 
    	s.Month,
    	b.BranchName",sql-server,group-by,sum,zero,,,open,0,171,8,"T-SQL, zero sum for no match on join I have two tables, one with all my Branches, and one with all my sales. The sales table also contains a Sales Rep ID, a Branch ID, a month and a year. 

I need a query that will return the sum of a specific rep's sales for a year, grouped by branch and month, and the query must return 0 if there has been no sales in a branch for that month. I have the following, which does not return 0 if there are no sales:

    SELECT
    	b.BranchName,
    	SUM(s.InvoiceAmount) AS 'Sales'
    FROM 
    	Branch b
    INNER JOIN
    	Sales s ON s.BranchID = b.BranchID
    WHERE
    	s.Year = 2008
    AND
    	s.SalesRepID= 11
    GROUP BY 
    	s.Month,
    	b.BranchName
    ORDER BY 
    	s.Month,
    	b.BranchName",4
9320921,02/16/2012 23:51:31,1215064,02/16/2012 23:42:20,1,0,Is Reverse Engineering the SQL Server Transaction Log Legal?,"Using some publicly available blog posts and some work on my own, I believe I have reverse engineered the SQL Server transaction log enough to serve my purposes (CDC solution but the library can have many uses). Before I go any further though, I was wondering the legality of this approach. Questions:

 1. Can I legally open source my software? (my main goal)
 2. Can I legally sell my software commercially as a CDC solution without involving Microsoft? (my secondary goal)

I plan on contacting MS as well, but I wanted to know the legality of this kind of reverse engineering from the community.",sql-server,licensing,reverse-engineering,,,02/16/2012 23:55:34,off topic,1,103,9,"Is Reverse Engineering the SQL Server Transaction Log Legal? Using some publicly available blog posts and some work on my own, I believe I have reverse engineered the SQL Server transaction log enough to serve my purposes (CDC solution but the library can have many uses). Before I go any further though, I was wondering the legality of this approach. Questions:

 1. Can I legally open source my software? (my main goal)
 2. Can I legally sell my software commercially as a CDC solution without involving Microsoft? (my secondary goal)

I plan on contacting MS as well, but I wanted to know the legality of this kind of reverse engineering from the community.",3
619403,03/06/2009 16:18:46,70636,02/25/2009 01:43:48,16,0,CPU USAGE IN SQL BOX,"Is there a best number that a CPU usage be for a SQL BOX. I just want to make it clear that what is the preferable number. Please, suggest.

Thanks,
",sql-server,,,,,12/06/2011 17:58:19,not a real question,1,29,5,"CPU USAGE IN SQL BOX Is there a best number that a CPU usage be for a SQL BOX. I just want to make it clear that what is the preferable number. Please, suggest.

Thanks,
",1
4698704,01/15/2011 08:40:16,516512,11/22/2010 18:35:35,7,6,SQL LIKE Operator doesn't work with Asian Languages (SQL Server 2008),"I've faced with a problem never thought of ever. My problem seems too simple but I can't find a solution to it.
I have a sql server database column that is of type NVarchar and is filled with standard persian characters. when I'm trying to run a very simple query on it which incorporates the LIKE operator, the resultset becomes empty although I know the query term is present in the table. Here is the very smiple example query which doesn't act corectly:
SELECT * FROM T_Contacts WHERE C_ContactName LIKE '%ف%'

ف is a persian character and the ContactName coulmn contains multiple entries which contain that character.

Please tell me how should I rewrite the expression or what change should I apply. Note that my database's collation is SQL_Latin1_General_CP1_CI_AS.

Thank you very much
",sql-server,select,unicode,collation,nvarchar,,open,0,128,11,"SQL LIKE Operator doesn't work with Asian Languages (SQL Server 2008) I've faced with a problem never thought of ever. My problem seems too simple but I can't find a solution to it.
I have a sql server database column that is of type NVarchar and is filled with standard persian characters. when I'm trying to run a very simple query on it which incorporates the LIKE operator, the resultset becomes empty although I know the query term is present in the table. Here is the very smiple example query which doesn't act corectly:
SELECT * FROM T_Contacts WHERE C_ContactName LIKE '%ف%'

ف is a persian character and the ContactName coulmn contains multiple entries which contain that character.

Please tell me how should I rewrite the expression or what change should I apply. Note that my database's collation is SQL_Latin1_General_CP1_CI_AS.

Thank you very much
",5
5963655,05/11/2011 11:43:35,744929,05/09/2011 10:08:30,28,0,implementing cascading stored procedures in sqlserver2008,"How can I maintain transaction across cascading stored procedures?
I m using sqlserver 2008.",sql-server,,,,,,open,0,13,6,"implementing cascading stored procedures in sqlserver2008 How can I maintain transaction across cascading stored procedures?
I m using sqlserver 2008.",1
14031,08/18/2008 00:01:19,1680,08/17/2008 23:46:58,1,0,Database triggers,"In the past I've never been a fan of using triggers on database tables. To me they always represented some ""magic"" that was going to happen on the database side, far far away from the control of my application code. I also wanted to limit the amount of work the DB had to do, as it's generally a shared resource and I always assumed triggers could get to be expensive in high load scenarios.

That said, I have found a couple of instances where triggers have made sense to use (at least in my opinion they made sense). Recently though, I found myself in a situation where I sometimes might need to ""bypass"" the trigger. I felt really guilty about having to look for ways to do this, and I still think that a better database design would alleviate the need for this bypassing. Unfortunately this DB is used by mulitple applications, some of which are maintained by a very uncooperative development team who would scream about schema changes, so I was stuck.

What's the general consesus out there about triggers? Love em? Hate em? Think they serve a purpose in some scenarios? 
Do think that having a need to bypass a trigger means that you're ""doing it wrong""?",sql-server,triggers,database-design,,,,open,0,207,2,"Database triggers In the past I've never been a fan of using triggers on database tables. To me they always represented some ""magic"" that was going to happen on the database side, far far away from the control of my application code. I also wanted to limit the amount of work the DB had to do, as it's generally a shared resource and I always assumed triggers could get to be expensive in high load scenarios.

That said, I have found a couple of instances where triggers have made sense to use (at least in my opinion they made sense). Recently though, I found myself in a situation where I sometimes might need to ""bypass"" the trigger. I felt really guilty about having to look for ways to do this, and I still think that a better database design would alleviate the need for this bypassing. Unfortunately this DB is used by mulitple applications, some of which are maintained by a very uncooperative development team who would scream about schema changes, so I was stuck.

What's the general consesus out there about triggers? Love em? Hate em? Think they serve a purpose in some scenarios? 
Do think that having a need to bypass a trigger means that you're ""doing it wrong""?",3
3878603,10/07/2010 04:12:39,200449,11/01/2009 10:59:52,246,30,why is the engagement of  OLAP practically neglected?,"With astonishment observe that:   
1)
that no answer to question [Transactional And Reporting Databases - How?][1]
mentions SSAS databases from MS BI (Business Intelligence) platform:

  - SSAS (SQL Server Analysis Services) databases (OLAP, datawarehouses, datamarts) + DM (DataMining). 
  - SSRS - SQL Server Reporting Services
  - SSIS - SS Integration S

2)  
I was Java, ASP.NET/C# dev for many years  and couple years ago I had got a remote free-lance job in SSAS.   
I liked this area and tried to further specialize in it. 

I live in 1,000, 000 city with plenty of databases-oriented jobs. But nobody is hiring SSAS, MS BI (Business Intelligence) OLAP specialists.  In 2 my last full-time office job I I had even been hired for OLAP development but all ended in non-database-related  CRM/ERP maintenance routine. Mainly it was not even programming related.   

The conclusion from 1), 2), as well as internet job searching and freelance projects bids, is that even IT development shops neglect OLAP or lack any influx of such projects/customers and and I am to abandon the attempts specialize in OLAP and to  return back to my previous C#/ASP.NET development.     

Why is such situation with OLAP?  
Is it going to change?  
How one could manage to get into and continue specializing in OLAP/BI?  
Is my conclusion that specialization in OLAP is career dead-end wrong?   


  [1]: http://stackoverflow.com/questions/3872996/transactional-and-reporting-databases-how",sql-server,database-design,career-development,data-warehouse,olap,10/07/2010 08:16:45,not constructive,1,246,9,"why is the engagement of  OLAP practically neglected? With astonishment observe that:   
1)
that no answer to question [Transactional And Reporting Databases - How?][1]
mentions SSAS databases from MS BI (Business Intelligence) platform:

  - SSAS (SQL Server Analysis Services) databases (OLAP, datawarehouses, datamarts) + DM (DataMining). 
  - SSRS - SQL Server Reporting Services
  - SSIS - SS Integration S

2)  
I was Java, ASP.NET/C# dev for many years  and couple years ago I had got a remote free-lance job in SSAS.   
I liked this area and tried to further specialize in it. 

I live in 1,000, 000 city with plenty of databases-oriented jobs. But nobody is hiring SSAS, MS BI (Business Intelligence) OLAP specialists.  In 2 my last full-time office job I I had even been hired for OLAP development but all ended in non-database-related  CRM/ERP maintenance routine. Mainly it was not even programming related.   

The conclusion from 1), 2), as well as internet job searching and freelance projects bids, is that even IT development shops neglect OLAP or lack any influx of such projects/customers and and I am to abandon the attempts specialize in OLAP and to  return back to my previous C#/ASP.NET development.     

Why is such situation with OLAP?  
Is it going to change?  
How one could manage to get into and continue specializing in OLAP/BI?  
Is my conclusion that specialization in OLAP is career dead-end wrong?   


  [1]: http://stackoverflow.com/questions/3872996/transactional-and-reporting-databases-how",5
4222484,11/19/2010 05:59:46,359047,06/05/2010 05:50:22,32,1,tables in SQL Server,"In SQL Server, data is represented in terms of 
1. rows and columns
2. table.

what is the correct answer of the above question, choice 1 or 2.",sql-server,,,,,11/19/2010 06:12:26,not a real question,1,26,4,"tables in SQL Server In SQL Server, data is represented in terms of 
1. rows and columns
2. table.

what is the correct answer of the above question, choice 1 or 2.",1
11439926,07/11/2012 19:24:02,29519,10/20/2008 07:44:12,3585,90,what is the best way to copy a ms sql database from a remote server to local computer?,More specific my db is hosted at appharbor and I want to copy that db to my local sql express 2012 server. Up til now I have used management studio to export the data and later used the schema compare feature in vs 2012 but I guess there must be an easier way ,sql-server,,,,,07/11/2012 19:33:01,off topic,1,54,18,what is the best way to copy a ms sql database from a remote server to local computer? More specific my db is hosted at appharbor and I want to copy that db to my local sql express 2012 server. Up til now I have used management studio to export the data and later used the schema compare feature in vs 2012 but I guess there must be an easier way ,1
8964421,01/22/2012 20:29:23,12597,09/16/2008 14:53:25,18985,335,How to partition tables by date?,"How can i partition rows in SQL Server by date?

Bonus Chatter
-------------

In SQL Server it's relatively easy to partition tables by *year*, e.g.:

 - table `Orders_2000`
 - table `Orders_2001`
 - table `Orders_2002`
 - ...
 - table `Orders_2011`
 - table `Orders_2012`

You create a separate table for each year, making sure to include a `Year` column with a check constraint that matches the table:

    CREATE TABLE Transactions_1999 (Year int NOT NULL DEFAULT 1999, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_1999 ADD CONSTRAINT PK_Transactions1999 PRIMARY KEY CLUSTERED (Year, TransactionID)
    	ALTER TABLE Transactions_1999 ADD CONSTRAINT CK_Transactions1999_Year CHECK (Year = '1999')

    CREATE TABLE Transactions_2000 (Year int NOT NULL DEFAULT 2000, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2000 ADD CONSTRAINT PK_Transactions2000 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2000 ADD CONSTRAINT CK_Transactions2000_Year CHECK (Year = '2000')

    CREATE TABLE Transactions_2001 (Year int NOT NULL DEFAULT 2001, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2001 ADD CONSTRAINT PK_Transactions2001 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2001 ADD CONSTRAINT CK_Transactions2001_Year CHECK (Year = '2001')
    ...
    CREATE TABLE Transactions_2011 (year int NOT NULL DEFAULT 2011, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2011 ADD CONSTRAINT PK_Transactions2011 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2011 ADD CONSTRAINT CK_Transactions2011_Year CHECK (Year = '2011')

    CREATE TABLE Transactions_2012 (Year int NOT NULL DEFAULT 2012, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2012 ADD CONSTRAINT PK_Transactions2012 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2012 ADD CONSTRAINT CK_Transactions2012_Year CHECK (Year = '2012')

Then you can construct a `VIEW` that merges to tables together:

    CREATE VIEW Transactions AS
	SELECT * FROM Transactions_1999
	UNION ALL
	SELECT * FROM Transactions_2000
	UNION ALL
	SELECT * FROM Transactions_2001
	UNION ALL
	--...
	SELECT * FROM Transactions_2011
	UNION ALL
	SELECT * FROM Transactions_2012

And now you can query this `Transactions` view:

    SELECT * FROM Transactions
    WHERE (CustomerName LIKE 'boyd%')
    OR (CustomerName LIKE '% boyd%')

And data can be inserted into the view, and SQL Server will automatically put it in the table it's supposed to go in:

    INSERT INTO Transactions(Year, TransactionID, CustomerName)
    VALUES (2012, 378922384, 'Ian Boyd')


But that's not what i want
--------------------------

i want to partitions data into tables by ***age***. Rows with a `TransactionDate` older than 90 days should go into one table, and transactions with a `TransactionDate` newer than 90 days go into another table:

 - table `Transactions_olderThan90Days`
 - table `Transactions_newerThan90Days`

So says the SQL:

    CREATE TABLE Transactions_NewerThan90Days (
        TransactionDate datetime NOT NULL,
        TransactionID int NOT NULL,
        CustomeName varchar(50))


    CREATE TABLE Transactions_OlderThan90Days (
        TransactionDate datetime NOT NULL,
        TransactionID int NOT NULL,
        CustomeName varchar(50))

Is such a thing possible in SQL Server?

i realize this sounds impossible, since it means SQL Server having to move data constantly.",sql-server,sql-server-2000,sql-server-2008-r2,partitioning,,,open,0,554,6,"How to partition tables by date? How can i partition rows in SQL Server by date?

Bonus Chatter
-------------

In SQL Server it's relatively easy to partition tables by *year*, e.g.:

 - table `Orders_2000`
 - table `Orders_2001`
 - table `Orders_2002`
 - ...
 - table `Orders_2011`
 - table `Orders_2012`

You create a separate table for each year, making sure to include a `Year` column with a check constraint that matches the table:

    CREATE TABLE Transactions_1999 (Year int NOT NULL DEFAULT 1999, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_1999 ADD CONSTRAINT PK_Transactions1999 PRIMARY KEY CLUSTERED (Year, TransactionID)
    	ALTER TABLE Transactions_1999 ADD CONSTRAINT CK_Transactions1999_Year CHECK (Year = '1999')

    CREATE TABLE Transactions_2000 (Year int NOT NULL DEFAULT 2000, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2000 ADD CONSTRAINT PK_Transactions2000 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2000 ADD CONSTRAINT CK_Transactions2000_Year CHECK (Year = '2000')

    CREATE TABLE Transactions_2001 (Year int NOT NULL DEFAULT 2001, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2001 ADD CONSTRAINT PK_Transactions2001 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2001 ADD CONSTRAINT CK_Transactions2001_Year CHECK (Year = '2001')
    ...
    CREATE TABLE Transactions_2011 (year int NOT NULL DEFAULT 2011, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2011 ADD CONSTRAINT PK_Transactions2011 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2011 ADD CONSTRAINT CK_Transactions2011_Year CHECK (Year = '2011')

    CREATE TABLE Transactions_2012 (Year int NOT NULL DEFAULT 2012, TransactionID int NOT NULL, CustomerName varchar(50))
        ALTER TABLE Transactions_2012 ADD CONSTRAINT PK_Transactions2012 PRIMARY KEY (Year, TransactionID)
    	ALTER TABLE Transactions_2012 ADD CONSTRAINT CK_Transactions2012_Year CHECK (Year = '2012')

Then you can construct a `VIEW` that merges to tables together:

    CREATE VIEW Transactions AS
	SELECT * FROM Transactions_1999
	UNION ALL
	SELECT * FROM Transactions_2000
	UNION ALL
	SELECT * FROM Transactions_2001
	UNION ALL
	--...
	SELECT * FROM Transactions_2011
	UNION ALL
	SELECT * FROM Transactions_2012

And now you can query this `Transactions` view:

    SELECT * FROM Transactions
    WHERE (CustomerName LIKE 'boyd%')
    OR (CustomerName LIKE '% boyd%')

And data can be inserted into the view, and SQL Server will automatically put it in the table it's supposed to go in:

    INSERT INTO Transactions(Year, TransactionID, CustomerName)
    VALUES (2012, 378922384, 'Ian Boyd')


But that's not what i want
--------------------------

i want to partitions data into tables by ***age***. Rows with a `TransactionDate` older than 90 days should go into one table, and transactions with a `TransactionDate` newer than 90 days go into another table:

 - table `Transactions_olderThan90Days`
 - table `Transactions_newerThan90Days`

So says the SQL:

    CREATE TABLE Transactions_NewerThan90Days (
        TransactionDate datetime NOT NULL,
        TransactionID int NOT NULL,
        CustomeName varchar(50))


    CREATE TABLE Transactions_OlderThan90Days (
        TransactionDate datetime NOT NULL,
        TransactionID int NOT NULL,
        CustomeName varchar(50))

Is such a thing possible in SQL Server?

i realize this sounds impossible, since it means SQL Server having to move data constantly.",4
39188,09/02/2008 10:32:20,4021,09/01/2008 12:23:44,1,0,Repairing an MDF file,Can somebody in this forum recommend a tool/procedure to repair or recover a corrupt SQL Server 2000 database file?,sql-server,,,,,07/01/2012 13:12:34,not constructive,1,19,4,Repairing an MDF file Can somebody in this forum recommend a tool/procedure to repair or recover a corrupt SQL Server 2000 database file?,1
11473717,07/13/2012 15:36:58,1523946,07/13/2012 15:15:19,1,0,execution plan sqlserver,"I'm new in sqlserver and I want to tunning my first query.

In sqserver 20xx, what is the difference between ""display estimated execution plan""  and ""include actual execution plan"" ?


",sql-server,execution,plan,,,07/24/2012 02:46:12,off topic,1,30,3,"execution plan sqlserver I'm new in sqlserver and I want to tunning my first query.

In sqserver 20xx, what is the difference between ""display estimated execution plan""  and ""include actual execution plan"" ?


",3
9140876,02/04/2012 12:30:34,1189315,02/04/2012 12:18:53,1,0,recovering database in sql server 2005 and 2008,"How to recover database in sql server 2008,if i don't have any backup,I mean recover data from log file or any others techniques?",sql-server,backup,logfile,,,02/04/2012 13:59:54,off topic,1,23,8,"recovering database in sql server 2005 and 2008 How to recover database in sql server 2008,if i don't have any backup,I mean recover data from log file or any others techniques?",3
9637253,03/09/2012 16:08:52,770494,09/16/2010 22:20:01,524,11,Is there any free SQL database synchronization tool?,"For MS SQL Server, but if possible is there a one for popular db server?

Because I remember a year ago I was using one that was able to synchronize for MS SQL Server, MySQL and PGSQL.  But I totally forgot the name and it needed to paid.

",sql-server,database,database-schema,,,03/09/2012 19:11:38,not a real question,1,48,8,"Is there any free SQL database synchronization tool? For MS SQL Server, but if possible is there a one for popular db server?

Because I remember a year ago I was using one that was able to synchronize for MS SQL Server, MySQL and PGSQL.  But I totally forgot the name and it needed to paid.

",3
3500843,08/17/2010 08:59:19,422647,08/17/2010 08:59:19,1,0,store newsletter in sql server database - best practice?,"I'm looking for the best way of making an archive for newsletters to be stored in a SQL Server database. What would be the easiest way to do that? I was thinking I could store the newsletters as pdf:s, but what data type should I use in the database? Anything else I should have in mind?
Thankful for help!",sql-server,,,,,,open,0,58,9,"store newsletter in sql server database - best practice? I'm looking for the best way of making an archive for newsletters to be stored in a SQL Server database. What would be the easiest way to do that? I was thinking I could store the newsletters as pdf:s, but what data type should I use in the database? Anything else I should have in mind?
Thankful for help!",1
6095197,05/23/2011 09:16:54,57428,01/21/2009 08:23:46,55054,1480,How do SQL Azure and Azure Table Storage compare?,"Currently I have a prototype that runs in IIS on my local machine and uses SQL Server Express 2005 for storing data in three SQL tables. I run queries with transactions that employ up to two of those three tables.

Now I need to move my prototype to Windows Azure and can't decide which to choose - SQL Azure or Azure Table Storage.

How do they compare? How do I decide which to choose?",sql-server,database,azure,windows-azure-storage,azure-storage-tables,06/07/2012 23:11:24,not constructive,1,72,9,"How do SQL Azure and Azure Table Storage compare? Currently I have a prototype that runs in IIS on my local machine and uses SQL Server Express 2005 for storing data in three SQL tables. I run queries with transactions that employ up to two of those three tables.

Now I need to move my prototype to Windows Azure and can't decide which to choose - SQL Azure or Azure Table Storage.

How do they compare? How do I decide which to choose?",5
10055618,04/07/2012 15:13:34,1275717,03/17/2012 12:29:43,1,0,select max 10 values in sql server 2008,"i have table named product.It has two fields product_id,purchase_count.i want to get 10 product id who has highest download_count values.

",sql-server,sql-server-2008,,,,04/09/2012 06:16:49,not a real question,1,20,8,"select max 10 values in sql server 2008 i have table named product.It has two fields product_id,purchase_count.i want to get 10 product id who has highest download_count values.

",2
5408996,03/23/2011 17:08:09,46571,12/16/2008 08:32:48,2290,80,"Testing whether a SQL Server user exists, and whether their password is valid","I need create a SQL Server stored procedure that does the following:

1. Take an database user name and password as parameters.
2. If the user does not exist or the password is invalid, return an empty rowset.
3. Else, perform a query and return its result.

I don't know how do perform step 2. Any ideas?",sql-server,,,,,,open,0,53,13,"Testing whether a SQL Server user exists, and whether their password is valid I need create a SQL Server stored procedure that does the following:

1. Take an database user name and password as parameters.
2. If the user does not exist or the password is invalid, return an empty rowset.
3. Else, perform a query and return its result.

I don't know how do perform step 2. Any ideas?",1
7789857,10/17/2011 05:53:40,998553,10/17/2011 05:25:20,1,0,Adding two columns,"i have a table report like this

pipno demand principle interest balance=(demand-principle)
101     5000   500       100      4500
102     1000   750       100       250
103     2000   1500      100       500
104     1500   1000      100       500
101     5000   1500      100       4000// Here in demand field i want to add demand with old balance ie., 4500+5000=9500 because pipno 101 exists two times and also same if any pipno exists more than once we want to add the demand with existing balance. Plaese reply me as quick

sample o/p
pipno demand principle interest balance=(demand-principle)
101     5000   500       100      4500
102     1000   750       100       250
103     2000   1500      100       500
104     1500   1000      100       500
101     9500   1500      100       4000
102     1250   750       100       250
here 101 & 102 exists twice",sql-server,,,,,10/18/2011 08:59:25,not a real question,1,299,3,"Adding two columns i have a table report like this

pipno demand principle interest balance=(demand-principle)
101     5000   500       100      4500
102     1000   750       100       250
103     2000   1500      100       500
104     1500   1000      100       500
101     5000   1500      100       4000// Here in demand field i want to add demand with old balance ie., 4500+5000=9500 because pipno 101 exists two times and also same if any pipno exists more than once we want to add the demand with existing balance. Plaese reply me as quick

sample o/p
pipno demand principle interest balance=(demand-principle)
101     5000   500       100      4500
102     1000   750       100       250
103     2000   1500      100       500
104     1500   1000      100       500
101     9500   1500      100       4000
102     1250   750       100       250
here 101 & 102 exists twice",1
10444899,05/04/2012 07:56:25,579690,01/18/2011 09:35:45,756,19,SQL indexes on a large table: some large indexes or more smaller indexes?,"I have a table with +/- 80 million rows (partitioned).

The inserts are getting kinda slow (about 1-3 sec). 
The query plan says 68% of the insert is `clustered index insert`, but there are also some triggers on the table for every insert / update and delete. So its kinda hard to say what is really causing the time.

Anyways, we have some indexes on that table, some with 3-5 columns in it.

What I want to know is what is better, performance wise:
To have some indexes with multiple columns in it, or to have more smaller indexes with less columns? 

All tips and suggestions are welcome.
",sql-server,performance,sql-server-2008,indexing,,,open,0,104,13,"SQL indexes on a large table: some large indexes or more smaller indexes? I have a table with +/- 80 million rows (partitioned).

The inserts are getting kinda slow (about 1-3 sec). 
The query plan says 68% of the insert is `clustered index insert`, but there are also some triggers on the table for every insert / update and delete. So its kinda hard to say what is really causing the time.

Anyways, we have some indexes on that table, some with 3-5 columns in it.

What I want to know is what is better, performance wise:
To have some indexes with multiple columns in it, or to have more smaller indexes with less columns? 

All tips and suggestions are welcome.
",4
8068407,11/09/2011 16:46:10,203948,11/05/2009 18:36:57,391,2,Whats the best way to compare a tables data against another?,"Okay so I have 2 select statements:

    SELECT DISTINCT Email
    FROM         dbo.Customers
    WHERE     (Email IS NOT NULL) 
    AND (Email LIKE '%@%') 
    AND (RIGHT(Email, 4) IN ('.net', '.com', '.org')) 
    AND (Email NOT LIKE '%@UniformCity.com') 
    AND (Email NOT LIKE '%@LifeUniform.com') 
    AND (CHARINDEX('.',Email) <> 1)
    AND (RIGHT(RTRIM(Email), 1) <> '.') AND (LEFT(LTRIM(Email), 1) <> '@') 
    AND (Email not Like '%[`:;_*-,^[^]()+%\/=#-]%' escape '^') order by Email

AND 

    SELECT  replace(replace(
    replace(
    replace(EmailOptOut,'""','')
    , ',held','')
    , ',unsub','')
    , ',confirm','') 
    as CleanEmail
    FROM [LifeMail].[dbo].[EmailOptOuts]

I only want to select the emails from the Customers table, THAT ARE NOT in the EmailOptOuts table.  Whats the best way to achieve this?  I thought about using cursors and looping, but I'm sure you experts know a better way.  ",sql-server,sql-server-2008,tsql,,,,open,0,195,11,"Whats the best way to compare a tables data against another? Okay so I have 2 select statements:

    SELECT DISTINCT Email
    FROM         dbo.Customers
    WHERE     (Email IS NOT NULL) 
    AND (Email LIKE '%@%') 
    AND (RIGHT(Email, 4) IN ('.net', '.com', '.org')) 
    AND (Email NOT LIKE '%@UniformCity.com') 
    AND (Email NOT LIKE '%@LifeUniform.com') 
    AND (CHARINDEX('.',Email) <> 1)
    AND (RIGHT(RTRIM(Email), 1) <> '.') AND (LEFT(LTRIM(Email), 1) <> '@') 
    AND (Email not Like '%[`:;_*-,^[^]()+%\/=#-]%' escape '^') order by Email

AND 

    SELECT  replace(replace(
    replace(
    replace(EmailOptOut,'""','')
    , ',held','')
    , ',unsub','')
    , ',confirm','') 
    as CleanEmail
    FROM [LifeMail].[dbo].[EmailOptOuts]

I only want to select the emails from the Customers table, THAT ARE NOT in the EmailOptOuts table.  Whats the best way to achieve this?  I thought about using cursors and looping, but I'm sure you experts know a better way.  ",3
11261648,06/29/2012 12:18:48,1472490,06/21/2012 14:53:53,1,0,Maintain index on Mssql Table,"My problem is how do i maintain index on table,weekly we are deleting and inserting bulk amount of data from the table.Because drop and create index taking too long time..",sql-server,sql-server-2000,,,,06/29/2012 14:12:45,off topic,1,30,5,"Maintain index on Mssql Table My problem is how do i maintain index on table,weekly we are deleting and inserting bulk amount of data from the table.Because drop and create index taking too long time..",2
8697447,01/02/2012 04:38:38,709485,04/15/2011 08:50:30,1,0,SQL Server or ORACLE for handling large volume of data?,"Can somebody please advise me on the best database to use (SQL Server 2008, Oracle 11g) for handling large data loads? On an average, around 10k records will be inserted into the database. Since our data load is huge we are looking for the best in class database that can perform well under huge data loads and provide the best data warehousing support.

Thanks & Regards,
Girish
",sql-server,oracle,,,,01/02/2012 12:28:29,not constructive,1,65,10,"SQL Server or ORACLE for handling large volume of data? Can somebody please advise me on the best database to use (SQL Server 2008, Oracle 11g) for handling large data loads? On an average, around 10k records will be inserted into the database. Since our data load is huge we are looking for the best in class database that can perform well under huge data loads and provide the best data warehousing support.

Thanks & Regards,
Girish
",2
9210626,02/09/2012 12:13:45,1150851,01/15/2012 20:28:16,17,0,SQL Server 2008 R2 / 2 Processors Installation,"When I am installing SQL Server 2008 R2 on 2 CPU's machine, it is automatically sets up to run on the 2 CPU's, or I need to configure it manually?

How can I check it anyway?",sql-server,windows,hardware,,,02/10/2012 01:19:29,off topic,1,35,8,"SQL Server 2008 R2 / 2 Processors Installation When I am installing SQL Server 2008 R2 on 2 CPU's machine, it is automatically sets up to run on the 2 CPU's, or I need to configure it manually?

How can I check it anyway?",3
8349703,12/01/2011 23:12:57,85952,04/02/2009 00:53:40,1783,14,MSSQL 2012 Installation Error,"I been trying to install MSSQL 2012 on Windows 7 SP1 32 bit.

Logged in as Administrator and launched setup.  

Everything installs fine but SQL DB Services fails with following error while 

One or more command-line switches were invalid 

and current file which it was reading was : sql_config_repair_loc_wmi_provider_cpu32_1033

and in log its says:  The SQL server feature 'SQL_Engine_Core_Inst' is not in a supported state for repair, as it was never successfully configured.  Only from successful installations can be repaired.  To continue, remove the specified SQL Server feature.

",sql-server,sql-server-2012,,,,12/07/2011 12:12:24,off topic,1,90,4,"MSSQL 2012 Installation Error I been trying to install MSSQL 2012 on Windows 7 SP1 32 bit.

Logged in as Administrator and launched setup.  

Everything installs fine but SQL DB Services fails with following error while 

One or more command-line switches were invalid 

and current file which it was reading was : sql_config_repair_loc_wmi_provider_cpu32_1033

and in log its says:  The SQL server feature 'SQL_Engine_Core_Inst' is not in a supported state for repair, as it was never successfully configured.  Only from successful installations can be repaired.  To continue, remove the specified SQL Server feature.

",2
11727464,07/30/2012 18:33:01,728263,04/27/2011 23:08:43,1,0,"Msg 14027, Level 11, State 1, Procedure sp_MSrepl_addarticle [table] does not exist in the current database","Before setting up SQL Server snapshot replication, I backed up the database from ServerA and restored it to ServerB. Both servers are running SQL Server 2008 R2 SP1. 

In trying to setup snapshot replication from ServerA to ServerB using the GUI, I get the following error: ""Msg 14027, Level 11, State 1, Procedure sp_MSrepl_addarticle, Line 582 [dbo].[SYSCOLUMNS] does not exist in the current database.""  Yes, that is the name of the table and it is indeed a user table. I ran the setup from ServerA which is the Publisher. The collation is the same between the tables on both servers. If I remove that table as an article, the replication is setup just fine.

I've searched the web on this and I'm stumped. Any ideas?

Thanks!
Rebecca",sql-server,sql-server-2008-r2,replication,,,07/31/2012 19:07:03,off topic,1,125,16,"Msg 14027, Level 11, State 1, Procedure sp_MSrepl_addarticle [table] does not exist in the current database Before setting up SQL Server snapshot replication, I backed up the database from ServerA and restored it to ServerB. Both servers are running SQL Server 2008 R2 SP1. 

In trying to setup snapshot replication from ServerA to ServerB using the GUI, I get the following error: ""Msg 14027, Level 11, State 1, Procedure sp_MSrepl_addarticle, Line 582 [dbo].[SYSCOLUMNS] does not exist in the current database.""  Yes, that is the name of the table and it is indeed a user table. I ran the setup from ServerA which is the Publisher. The collation is the same between the tables on both servers. If I remove that table as an article, the replication is setup just fine.

I've searched the web on this and I'm stumped. Any ideas?

Thanks!
Rebecca",3
274846,11/08/2008 15:49:22,16794,09/17/2008 20:47:55,915,28,Should SQL Server be on the same machine as your IIS installation?,"I'm listening to podcast #19 and Joel and Jeff are arguing about running SQL Server on the same machine as your IIS installation. I have to say that it sounds like Jeff folded to Joel, but then again I am only guessing which one is which. ;)

What are the pros and cons of each? Which is better?

I typically run them separately (Joel's preference) but I can see Jeff's point where the two are closer to each other.",sql-server,iis,win2003,,,06/29/2012 14:54:51,off topic,1,77,12,"Should SQL Server be on the same machine as your IIS installation? I'm listening to podcast #19 and Joel and Jeff are arguing about running SQL Server on the same machine as your IIS installation. I have to say that it sounds like Jeff folded to Joel, but then again I am only guessing which one is which. ;)

What are the pros and cons of each? Which is better?

I typically run them separately (Joel's preference) but I can see Jeff's point where the two are closer to each other.",3
2858274,05/18/2010 14:41:41,1360,08/14/2008 18:11:31,685,34,Granting a SQL Server Login Access to a Database - SQL Server,"I want to grant access to a database for a SQL Server login. I know about sp_grantdbaccess, however it is deprecated. What can I use instead and how can I check if the login does not already have access to the database?",sql-server,database,login,,,,open,0,42,12,"Granting a SQL Server Login Access to a Database - SQL Server I want to grant access to a database for a SQL Server login. I know about sp_grantdbaccess, however it is deprecated. What can I use instead and how can I check if the login does not already have access to the database?",3
7400707,09/13/2011 10:54:57,844136,07/14/2011 08:34:55,24,0,SQL SERVER changing security contex inside of stored procedure,"Inside of some stored procedure I have to change security context to more powerful login.
I tried something like this:

    USE ProjectsDB
    EXECUTE AS login = 'sa'

    --SOME OPERATIONS

    REVERT;

but I get the following error message:

    Msg 15406, Level 16, State 1, Line 3
    Cannot execute as the server principal because the principal ""sa"" does not exist,
    this type of principal cannot be impersonated, or you do not have permission.


The 'sa' login exist with all needed permissions.
What may be the problem?

Ilan.
",sql-server,sql-server-2005,sql-server-2008,stored-procedures,,,open,0,101,9,"SQL SERVER changing security contex inside of stored procedure Inside of some stored procedure I have to change security context to more powerful login.
I tried something like this:

    USE ProjectsDB
    EXECUTE AS login = 'sa'

    --SOME OPERATIONS

    REVERT;

but I get the following error message:

    Msg 15406, Level 16, State 1, Line 3
    Cannot execute as the server principal because the principal ""sa"" does not exist,
    this type of principal cannot be impersonated, or you do not have permission.


The 'sa' login exist with all needed permissions.
What may be the problem?

Ilan.
",4
839386,05/08/2009 11:21:03,52420,01/07/2009 13:07:08,114,8,How can i left out join these #temp (default data) and another table?,"<p>i try to generate a table (look TABLE 1) with the query(below).</p>

<pre><code>CREATE TABLE #temp(
[VisitingCount] int,
[Time] nvarchar(50) )
DECLARE @DateNow DATETIME,@i int

SET @DateNow='00:00'
set @i=1;


	while(@i&#60;1440)
begin
    set @DateNow=DATEADD(minute, 1, @DateNow)
    insert into #temp ([VisitingCount], [Time]) values(0, right(left(convert(nvarchar, @DateNow, 121), 16), 5))
    set @i=@i+1
end


select Count(VisitingCount) as VisitingCount,[Time]      
from   
#temp as Alltimes
left outer join   
( SELECT Page,Date,[user],      
        dbo.fn_GetActivityLogArranger2(Date,'hour') as [Time]
        FROM scr_SecuristLog      
) scr_SecuristLog      
on Alltimes.[Time] = scr_SecuristLog.[Time]
where      
        Date between '2009-04-30' and '2009-05-02'      
and      
        [user] in      
(       select USERNAME      
        from scr_CustomerAuthorities      
        where customerID=Convert(varchar,4)      
        and ID=Convert(varchar,43)      
)      
group by [Time] order by [Time] asc
drop table #temp</code></pre>
<br><hr><br>
<p>i need this result(below). This codes about System entrance logs, 
but there is a break lunch between 12:30 and 13:30. 
So No entrance our system between 12:30 and 13:30. 
if you draw log Graghic. You can see ""M"" character because of breaklunch gap    </p>
<p><h3>My Dream TABLE 1 Result:<h3></p>
<table>
<tr><td>Count---------</td><td>Time---------</td></tr><br>
<tr><td>10------------</td><td>10:30</td></tr><br>
<tr><td>22------------</td><td>10:40</td></tr><br>
<tr><td>30------------</td><td>10:50</td></tr><br>
<tr><td>44------------</td><td>11:00</td></tr><br>
.<br>
.<br>
.<br>
.<br>
.<br>
<tr><td>0-------------</td><td>12:30</td></tr><br>
<tr><td>0-------------</td><td>12:40</td></tr><br>
<tr><td>0-------------</td><td>12:50</td></tr><br>
<tr><td>0-------------</td><td>13:00</td></tr><br>
.<br>
.<br>
.<br>
.<br>
.<br>
<tr><td>10-------------</td><td>16:00</td></tr><br>
<tr><td>21-------------</td><td>16:10</td></tr><br>
<tr><td>56-------------</td><td>16:20</td></tr><br>
<tr><td>46-------------</td><td>16:30</td></tr><br>
</table>
",sql-server,sql,sql-server-2005,tsql,,,open,0,278,13,"How can i left out join these #temp (default data) and another table? <p>i try to generate a table (look TABLE 1) with the query(below).</p>

<pre><code>CREATE TABLE #temp(
[VisitingCount] int,
[Time] nvarchar(50) )
DECLARE @DateNow DATETIME,@i int

SET @DateNow='00:00'
set @i=1;


	while(@i&#60;1440)
begin
    set @DateNow=DATEADD(minute, 1, @DateNow)
    insert into #temp ([VisitingCount], [Time]) values(0, right(left(convert(nvarchar, @DateNow, 121), 16), 5))
    set @i=@i+1
end


select Count(VisitingCount) as VisitingCount,[Time]      
from   
#temp as Alltimes
left outer join   
( SELECT Page,Date,[user],      
        dbo.fn_GetActivityLogArranger2(Date,'hour') as [Time]
        FROM scr_SecuristLog      
) scr_SecuristLog      
on Alltimes.[Time] = scr_SecuristLog.[Time]
where      
        Date between '2009-04-30' and '2009-05-02'      
and      
        [user] in      
(       select USERNAME      
        from scr_CustomerAuthorities      
        where customerID=Convert(varchar,4)      
        and ID=Convert(varchar,43)      
)      
group by [Time] order by [Time] asc
drop table #temp</code></pre>
<br><hr><br>
<p>i need this result(below). This codes about System entrance logs, 
but there is a break lunch between 12:30 and 13:30. 
So No entrance our system between 12:30 and 13:30. 
if you draw log Graghic. You can see ""M"" character because of breaklunch gap    </p>
<p><h3>My Dream TABLE 1 Result:<h3></p>
<table>
<tr><td>Count---------</td><td>Time---------</td></tr><br>
<tr><td>10------------</td><td>10:30</td></tr><br>
<tr><td>22------------</td><td>10:40</td></tr><br>
<tr><td>30------------</td><td>10:50</td></tr><br>
<tr><td>44------------</td><td>11:00</td></tr><br>
.<br>
.<br>
.<br>
.<br>
.<br>
<tr><td>0-------------</td><td>12:30</td></tr><br>
<tr><td>0-------------</td><td>12:40</td></tr><br>
<tr><td>0-------------</td><td>12:50</td></tr><br>
<tr><td>0-------------</td><td>13:00</td></tr><br>
.<br>
.<br>
.<br>
.<br>
.<br>
<tr><td>10-------------</td><td>16:00</td></tr><br>
<tr><td>21-------------</td><td>16:10</td></tr><br>
<tr><td>56-------------</td><td>16:20</td></tr><br>
<tr><td>46-------------</td><td>16:30</td></tr><br>
</table>
",4
5305232,03/14/2011 22:13:04,103264,05/08/2009 01:16:16,1663,4,What happens to the primary key Id? when it goes over the limit?,"If you add a new record, then delete the record, then add it again over and over,

in time, sooner or later, when you add a new record the integer primary key id, will eventually exceed 2 billion.

1) Now what happens? SQL Server will start the primary key id from 1 again? or -1?

2) What happens if it cycles 4 billion times, how does SQL Server know not to replace the previous data?




",sql-server,sql-server-2005,sql-server-2008,,,,open,0,72,13,"What happens to the primary key Id? when it goes over the limit? If you add a new record, then delete the record, then add it again over and over,

in time, sooner or later, when you add a new record the integer primary key id, will eventually exceed 2 billion.

1) Now what happens? SQL Server will start the primary key id from 1 again? or -1?

2) What happens if it cycles 4 billion times, how does SQL Server know not to replace the previous data?




",3
11509420,07/16/2012 17:28:57,659858,03/15/2011 02:19:08,186,11,Open Alternate Extension in 'Single Instance' of SQL Server,"I know how to add additional extensions to SQL server, to have them treated just like .sql files... But, when opening them, a new SQL server instance is created. 

I also see numerous issues posted about double clicking on .SQL files and getting them to open in the existing instance of SQL server. This already works for me. 

What doesn't work is the additional extensions I have added. I'm using .PRC. All of the fixes propose changing various registry settings, all which are related to the default .sql extension. 

I don't see see how any of these fixes can be applied to make other extensions work or if there is anything else I can do to solve this?",sql-server,sql-server-2008,,,,,open,0,118,9,"Open Alternate Extension in 'Single Instance' of SQL Server I know how to add additional extensions to SQL server, to have them treated just like .sql files... But, when opening them, a new SQL server instance is created. 

I also see numerous issues posted about double clicking on .SQL files and getting them to open in the existing instance of SQL server. This already works for me. 

What doesn't work is the additional extensions I have added. I'm using .PRC. All of the fixes propose changing various registry settings, all which are related to the default .sql extension. 

I don't see see how any of these fixes can be applied to make other extensions work or if there is anything else I can do to solve this?",2
2283772,02/17/2010 19:29:58,104291,05/10/2009 08:46:14,102,2,MS SQL Server distance search,"I have a Microsoft SQL Server database with a table of Locations. Each location has its address and latitude and longitude coordinates.

In my application, the user can input a zipcode and we return a list of close by locations.
This is my approach.
a) Using a zipcode DB I search the lat,lon for the zipcode (this is the center point).
b) I run a search like this 

    SELECT Position_ID, distance(pos_lon,pos_lat,zip_lon,zip_lat) dist 
    FROM Positions
    ORDER BY dist

""distance"" is a function that calculates the distance between two points.

The problem is that as my location DB increases the time to run these searches is starting to grow.

Is there a better approach?

Thanks in advance.
Gonso",sql-server,zipcode,distance,,,,open,0,118,5,"MS SQL Server distance search I have a Microsoft SQL Server database with a table of Locations. Each location has its address and latitude and longitude coordinates.

In my application, the user can input a zipcode and we return a list of close by locations.
This is my approach.
a) Using a zipcode DB I search the lat,lon for the zipcode (this is the center point).
b) I run a search like this 

    SELECT Position_ID, distance(pos_lon,pos_lat,zip_lon,zip_lat) dist 
    FROM Positions
    ORDER BY dist

""distance"" is a function that calculates the distance between two points.

The problem is that as my location DB increases the time to run these searches is starting to grow.

Is there a better approach?

Thanks in advance.
Gonso",3
5019957,02/16/2011 17:37:26,177333,09/22/2009 18:36:45,2154,115,Function columns cached,"It looks like `select *` in a UDF is dangerous.  Consider this script:

    create table TestTable (col1 int, col2 varchar(1))
    insert into TestTable values (123, 'a')
    go
    
    create function TestFunction
    (
    	@param1 bit
    )
    returns table
    as
    return
    (
    	select * from TestTable
    )
    go
    
    select * from TestFunction(0)
    
    alter table TestTable
    add col3 varchar(1)
    
    select * from TestFunction(0)
    
    drop function TestFunction
    drop table TestTable
    go

You will get two result sets, both with the same number of columns, even though I added `col3`.  If the table is recreated an an extra column is inserted in the middle, everything will shift one column over, showing the data under the wrong column name.  In other words, the columns will stay the same, but the data has an extra column.

I wasn't able to find any information about this, but it seems to me the only way to avoid this is to always specify your columns in a function.

So my question is, what exactly does a UDF cache?  It seems output columns are--anything else?  Also, any way to still use `select *` but prevent this problem?  Thanks.",sql-server,caching,udf,,,,open,0,272,3,"Function columns cached It looks like `select *` in a UDF is dangerous.  Consider this script:

    create table TestTable (col1 int, col2 varchar(1))
    insert into TestTable values (123, 'a')
    go
    
    create function TestFunction
    (
    	@param1 bit
    )
    returns table
    as
    return
    (
    	select * from TestTable
    )
    go
    
    select * from TestFunction(0)
    
    alter table TestTable
    add col3 varchar(1)
    
    select * from TestFunction(0)
    
    drop function TestFunction
    drop table TestTable
    go

You will get two result sets, both with the same number of columns, even though I added `col3`.  If the table is recreated an an extra column is inserted in the middle, everything will shift one column over, showing the data under the wrong column name.  In other words, the columns will stay the same, but the data has an extra column.

I wasn't able to find any information about this, but it seems to me the only way to avoid this is to always specify your columns in a function.

So my question is, what exactly does a UDF cache?  It seems output columns are--anything else?  Also, any way to still use `select *` but prevent this problem?  Thanks.",3
2583517,04/06/2010 08:28:03,116987,06/03/2009 23:50:52,302,18,Run all SQL files in a directory,"I have a number of .sql files which I have to run in order to apply changes made by other developers on an SQL Server 2005 database.
The files are named according to the following pattern:

    0001 - abc.sql
    0002 - abcef.sql
    0003 - abc.sql
    ...

Is there a way to run all of them in one go?
",sql-server,batch-processing,,,,,open,0,68,7,"Run all SQL files in a directory I have a number of .sql files which I have to run in order to apply changes made by other developers on an SQL Server 2005 database.
The files are named according to the following pattern:

    0001 - abc.sql
    0002 - abcef.sql
    0003 - abc.sql
    ...

Is there a way to run all of them in one go?
",2
11260016,06/29/2012 10:18:25,1234024,02/26/2012 16:08:48,6,0,how to build sql query,"I Have fired certain query in sql and i got result as 
 

catid       url  		count
 
928	   url1	      	        790

928	   url2	    	        790

928        url3         	790

928        url4         	790

928        url5         	790

928        url6         	790

928        url7         	790
 
4180	   url8	      	        800

4180	   url9	      	        800

4180       url10       	        800

4180       url11	      	800

4180       url12	      	800
 
2818	   url13	      	810

2818	   url14	      	810

2818       url15      	        810

2818       url16	      	810
 
4574	   url17       	        820

4574	   url18		820

4574	   url19		820

4574	   url20		820

4574	   url21		820
 
664	   url22		830

664	   url23		830

664	   url24		830

1898	   url22		830

1898	   url23		830

1898	   url24		830

1898	   url25		830

 
result cycle should be
 


1898	   url22		830

4574	   url17        	820

2818	   url13		810

4180	   url8		        800

928	   url1		        790

 
664	   url23		830

4574	   url18		820

2818	   url14		810

4180	   url9		        800

928	   url2		        790
 
664	   url24		830

4574	   url19	        820

2818       url15        	810

4180       url10        	800

928        url3         	790

 
1898	   url22		830

4574	   url20		820

2818       url16		810

4180       url11		800

928        url4         	790
 
1898	   url23		830

4574	   url21		820

4180       url12		800

928        url5         	790

 
1898	   url24		830

928        url6         	790

 
1898	   url25		830

928        url7         	790

 

 
how can get such cycle with above ordering
 
many thanks..",sql-server,,,,,06/29/2012 10:29:20,not a real question,1,590,5,"how to build sql query I Have fired certain query in sql and i got result as 
 

catid       url  		count
 
928	   url1	      	        790

928	   url2	    	        790

928        url3         	790

928        url4         	790

928        url5         	790

928        url6         	790

928        url7         	790
 
4180	   url8	      	        800

4180	   url9	      	        800

4180       url10       	        800

4180       url11	      	800

4180       url12	      	800
 
2818	   url13	      	810

2818	   url14	      	810

2818       url15      	        810

2818       url16	      	810
 
4574	   url17       	        820

4574	   url18		820

4574	   url19		820

4574	   url20		820

4574	   url21		820
 
664	   url22		830

664	   url23		830

664	   url24		830

1898	   url22		830

1898	   url23		830

1898	   url24		830

1898	   url25		830

 
result cycle should be
 


1898	   url22		830

4574	   url17        	820

2818	   url13		810

4180	   url8		        800

928	   url1		        790

 
664	   url23		830

4574	   url18		820

2818	   url14		810

4180	   url9		        800

928	   url2		        790
 
664	   url24		830

4574	   url19	        820

2818       url15        	810

4180       url10        	800

928        url3         	790

 
1898	   url22		830

4574	   url20		820

2818       url16		810

4180       url11		800

928        url4         	790
 
1898	   url23		830

4574	   url21		820

4180       url12		800

928        url5         	790

 
1898	   url24		830

928        url6         	790

 
1898	   url25		830

928        url7         	790

 

 
how can get such cycle with above ordering
 
many thanks..",1
2152881,01/28/2010 07:13:10,164002,08/26/2009 12:15:42,228,8,Getting error wile opening the database?,"in my system when i am opening the database i get this error like this :

Cannot connect to server\sql2005.

------------------------------
ADDITIONAL INFORMATION:

An error has occurred while establishing a connection to the server.  When connecting to SQL Server 2005, this failure may be caused by the fact that under the default settings SQL Server does not allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified) (Microsoft SQL Server, Error: -1)

For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=-1&LinkId=20476


can you help me.",sql-server,,,,,,open,0,79,6,"Getting error wile opening the database? in my system when i am opening the database i get this error like this :

Cannot connect to server\sql2005.

------------------------------
ADDITIONAL INFORMATION:

An error has occurred while establishing a connection to the server.  When connecting to SQL Server 2005, this failure may be caused by the fact that under the default settings SQL Server does not allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified) (Microsoft SQL Server, Error: -1)

For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=-1&LinkId=20476


can you help me.",1
10810199,05/30/2012 04:56:32,1220350,02/20/2012 06:16:50,308,3,How to insert retrieved rows into another table using ssis,"I have a table and it has 500 rows. I want to retrieve only 10 rows and i want to insert into another table using control flow only. Through data flow task we can use OLEDB source and OLEDB destination. But i want result in such a way that by using execute sql task and for each loop. Is it possible to do in that way? My Idea is, get the set of ten records and and by using foreach loop iterate to every row and insert into the table by using execute sql task. The destination table need to create on the fly. I tried with some approach but not moving towards. Please find the image file.![enter image description here][1]


  [1]: http://i.stack.imgur.com/W3sTd.png",sql-server,ssis,,,,,open,0,124,10,"How to insert retrieved rows into another table using ssis I have a table and it has 500 rows. I want to retrieve only 10 rows and i want to insert into another table using control flow only. Through data flow task we can use OLEDB source and OLEDB destination. But i want result in such a way that by using execute sql task and for each loop. Is it possible to do in that way? My Idea is, get the set of ten records and and by using foreach loop iterate to every row and insert into the table by using execute sql task. The destination table need to create on the fly. I tried with some approach but not moving towards. Please find the image file.![enter image description here][1]


  [1]: http://i.stack.imgur.com/W3sTd.png",2
9865480,03/26/2012 01:07:38,266457,02/04/2010 18:27:47,898,32,Reporting Services scatter chart origin/axis placement negative values,"Shown are two scatter charts on the same set of data, which contains some negative values. One is in Excel 2010 with the origin centered, the other is with Reporting Services. I would like the chart to display as in Excel. In SQL Server Reporting Services 2005-2012, is there any way to set the placement of the origin? 

Excel
![enter image description here][1]

SSRS
![enter image description here][2]


  [1]: http://i.stack.imgur.com/Tu3Nw.png
  [2]: http://i.stack.imgur.com/lslNJ.png",sql-server,reporting-services,,,,,open,0,71,8,"Reporting Services scatter chart origin/axis placement negative values Shown are two scatter charts on the same set of data, which contains some negative values. One is in Excel 2010 with the origin centered, the other is with Reporting Services. I would like the chart to display as in Excel. In SQL Server Reporting Services 2005-2012, is there any way to set the placement of the origin? 

Excel
![enter image description here][1]

SSRS
![enter image description here][2]


  [1]: http://i.stack.imgur.com/Tu3Nw.png
  [2]: http://i.stack.imgur.com/lslNJ.png",2
11637785,07/24/2012 19:16:35,648407,03/07/2011 15:50:26,35,3,Downgrading SQL Server 2012 to Lower Edition,"I have a Win2008 R2 server with an enterprise edition of SQL Server 2012 installed. Because my production server is going to be standard edition, is there a way to downgrade editions from enterprise to standard? I have databases and users already configured in the enterprise instance, and analysis and native reporting service installed and configured.

Is this downgrade possible, or am I looking at a total re-install? Is there anything special I would need to do with my databases other than detaching prior to un-install and then attaching in the standard instance?",sql-server,sql-server-2012,,,,07/24/2012 20:25:11,off topic,1,92,7,"Downgrading SQL Server 2012 to Lower Edition I have a Win2008 R2 server with an enterprise edition of SQL Server 2012 installed. Because my production server is going to be standard edition, is there a way to downgrade editions from enterprise to standard? I have databases and users already configured in the enterprise instance, and analysis and native reporting service installed and configured.

Is this downgrade possible, or am I looking at a total re-install? Is there anything special I would need to do with my databases other than detaching prior to un-install and then attaching in the standard instance?",2
1264541,08/12/2009 06:37:52,96915,04/28/2009 05:58:56,45,5,How do we can get date & time seperatly from a single datetime field in sqlserver,"I have few fields(empid,arrivaltime) in sqlserver. I want to get the query output as follows

    79    08/11/2009     3:21PM
    78    08/11/2009     3:19PM
    98    08/11/2009     9:02AM
    97    08/11/2009     9:00AM
    96    08/11/2009     8:56AM
    95    08/11/2009     8:53AM

please give me sql query for this.",sql-server,,,,,,open,0,99,16,"How do we can get date & time seperatly from a single datetime field in sqlserver I have few fields(empid,arrivaltime) in sqlserver. I want to get the query output as follows

    79    08/11/2009     3:21PM
    78    08/11/2009     3:19PM
    98    08/11/2009     9:02AM
    97    08/11/2009     9:00AM
    96    08/11/2009     8:56AM
    95    08/11/2009     8:53AM

please give me sql query for this.",1
11668040,07/26/2012 11:13:22,314291,04/12/2010 07:11:41,10091,572,Implications of using a Unique NonClustered Index with Covering Columns instead of a Primary Key,"We have a large table `[MyTable]` which currently has both a PK, and a UNIQUE Index on `[KeyColumn]` (which has additional covering columns), which seems redundant. The table is clustered by another column entirely.

So we have:

    ALTER TABLE [MyTable]
    	ADD CONSTRAINT [PK_MyTable] PRIMARY KEY NONCLUSTERED
    	([KeyColumn])
    GO

AND

    CREATE UNIQUE NONCLUSTERED INDEX [IX_MyTable_SomeIndex] 
    	ON [atlas].[GRN_HEADER] ([KeyColumn]) 
    	INCLUDE ([Column1], [Column2])
    GO

As far as I know, it is not possible to add covering indexes to a Primary Key, so I intend to:

 - Drop the Foreign Key Constraints reliant on the MyTable
 - Drop the Primary Key on MyTable entirely
 - Re-Add the foreign keys reliant on MyTable

The only implication I can think of is that we won’t get a key symbol on our ERD diagrams, and that the index density will be less because of the included columns.

I've read http://stackoverflow.com/questions/487314/primary-key-or-unique-index and am happy with the integrity and performance aspects of doing this.

My Question is : Is this approach flawed?",sql-server,sql-server-2008,,,,07/26/2012 13:45:31,off topic,1,183,15,"Implications of using a Unique NonClustered Index with Covering Columns instead of a Primary Key We have a large table `[MyTable]` which currently has both a PK, and a UNIQUE Index on `[KeyColumn]` (which has additional covering columns), which seems redundant. The table is clustered by another column entirely.

So we have:

    ALTER TABLE [MyTable]
    	ADD CONSTRAINT [PK_MyTable] PRIMARY KEY NONCLUSTERED
    	([KeyColumn])
    GO

AND

    CREATE UNIQUE NONCLUSTERED INDEX [IX_MyTable_SomeIndex] 
    	ON [atlas].[GRN_HEADER] ([KeyColumn]) 
    	INCLUDE ([Column1], [Column2])
    GO

As far as I know, it is not possible to add covering indexes to a Primary Key, so I intend to:

 - Drop the Foreign Key Constraints reliant on the MyTable
 - Drop the Primary Key on MyTable entirely
 - Re-Add the foreign keys reliant on MyTable

The only implication I can think of is that we won’t get a key symbol on our ERD diagrams, and that the index density will be less because of the included columns.

I've read http://stackoverflow.com/questions/487314/primary-key-or-unique-index and am happy with the integrity and performance aspects of doing this.

My Question is : Is this approach flawed?",2
7696936,10/08/2011 12:53:27,870291,07/30/2011 03:30:38,110,3,using login controls with sql server (not express),"I installed Visual Studio 2008 Professional(updated with SP1), then I uninstalled SQL server 2005 Express and installed SQL Server 2005 Standard. <br>

now I am not able to add 'SQL Server Database' to the project - it says 
    Connections to SQL Server files (*.mdf) require SQL Server Express 2005 to function properly.

Is it not compliant with SQL Server Standard version?

And Login Controls also not working-<br>
Web Administration Tool says 
    Unable to connect to SQL Server database

Also tried with aspnet_regsql command-line utility.. not working..(actually I dont know what is to be done after creating SQL server database through 'aspnet_regsql command-line utility')


Please Provide a solution for my problem before somebody Closes this question or marks for deletion  ;P :)",sql-server,visual-studio,forms-authentication,login-control,sqlmembershipprovider,,open,0,124,8,"using login controls with sql server (not express) I installed Visual Studio 2008 Professional(updated with SP1), then I uninstalled SQL server 2005 Express and installed SQL Server 2005 Standard. <br>

now I am not able to add 'SQL Server Database' to the project - it says 
    Connections to SQL Server files (*.mdf) require SQL Server Express 2005 to function properly.

Is it not compliant with SQL Server Standard version?

And Login Controls also not working-<br>
Web Administration Tool says 
    Unable to connect to SQL Server database

Also tried with aspnet_regsql command-line utility.. not working..(actually I dont know what is to be done after creating SQL server database through 'aspnet_regsql command-line utility')


Please Provide a solution for my problem before somebody Closes this question or marks for deletion  ;P :)",5
2951633,06/01/2010 16:46:04,355617,06/01/2010 16:14:01,1,0,How can I create a locationID type of column to denote what server created a row in SQL Server Merge Replication?,"I want to setup merge replication between two SQL Server 2008 Servers.  For the Primary Key’s, I’d like to use a composite key: an identity column plus a column that will denote which server the row was created on (locationID column). 

Any ideas on how to do this?  I’m  not sure if you could use a trigger or a function to insert a default value every time a row is entered, but I’ve read this method is possible – just can’t find detailed steps on how to exactly do it.
Thanks for any help or references you can provide!
",sql-server,replication,,,,,open,0,101,21,"How can I create a locationID type of column to denote what server created a row in SQL Server Merge Replication? I want to setup merge replication between two SQL Server 2008 Servers.  For the Primary Key’s, I’d like to use a composite key: an identity column plus a column that will denote which server the row was created on (locationID column). 

Any ideas on how to do this?  I’m  not sure if you could use a trigger or a function to insert a default value every time a row is entered, but I’ve read this method is possible – just can’t find detailed steps on how to exactly do it.
Thanks for any help or references you can provide!
",2
8484816,12/13/2011 05:38:57,501314,11/09/2010 00:30:38,26,0,Is it possible to use a DELETE statement in a trigger on MS SQL Server 2000 database?,"I have created a trigger with this script.
	

    DECLARE @JRNENTRY_INSERTED INTEGER, @BACHNUMB CHAR(15)
    	SELECT @JRNENTRY_INSERTED = INSERTED.JRNENTRY FROM INSERTED
    	SELECT @BACHNUMB = (SELECT DISTINCT BACHNUMB FROM GL10000 WHERE JRNENTRY = (SELECT INSERTED.JRNENTRY FROM INSERTED))
    	
    	-- CHECK IF JRNENTRY EXIST ON GL10000. IF YES DELETE IT FROM TABLE GL10000
    	IF EXISTS (SELECT JRNENTRY FROM GL10000 WHERE JRNENTRY = @JRNENTRY_INSERTED)
    	BEGIN
    		DELETE FROM SY00500
    		WHERE	BACHNUMB = @BACHNUMB
    		
    		DELETE FROM GL10000
    		WHERE	JRNENTRY = @JRNENTRY_INSERTED
    		
    		DELETE FROM GL10001
    		WHERE	JRNENTRY = @JRNENTRY_INSERTED
    		
    	END

In this script I have validated the record if it exist on the [GL10000] table and if yes, it would execute the DELETE statement inside of it.",sql-server,sql-server-2000,,,,12/13/2011 17:57:51,not a real question,1,159,17,"Is it possible to use a DELETE statement in a trigger on MS SQL Server 2000 database? I have created a trigger with this script.
	

    DECLARE @JRNENTRY_INSERTED INTEGER, @BACHNUMB CHAR(15)
    	SELECT @JRNENTRY_INSERTED = INSERTED.JRNENTRY FROM INSERTED
    	SELECT @BACHNUMB = (SELECT DISTINCT BACHNUMB FROM GL10000 WHERE JRNENTRY = (SELECT INSERTED.JRNENTRY FROM INSERTED))
    	
    	-- CHECK IF JRNENTRY EXIST ON GL10000. IF YES DELETE IT FROM TABLE GL10000
    	IF EXISTS (SELECT JRNENTRY FROM GL10000 WHERE JRNENTRY = @JRNENTRY_INSERTED)
    	BEGIN
    		DELETE FROM SY00500
    		WHERE	BACHNUMB = @BACHNUMB
    		
    		DELETE FROM GL10000
    		WHERE	JRNENTRY = @JRNENTRY_INSERTED
    		
    		DELETE FROM GL10001
    		WHERE	JRNENTRY = @JRNENTRY_INSERTED
    		
    	END

In this script I have validated the record if it exist on the [GL10000] table and if yes, it would execute the DELETE statement inside of it.",2
5815676,04/28/2011 08:19:19,445540,09/12/2010 11:19:00,658,24,Oracle ODBC driver on Solaris 10,"I want to install oracle ODBC driver on Solaris 10, for to connect from Oracle Database to SQL server database.

It appeared very difficult for me...

Can you help me?


Thank you very muck.",sql-server,oracle,odbc,driver,,04/28/2011 19:12:28,off topic,1,31,6,"Oracle ODBC driver on Solaris 10 I want to install oracle ODBC driver on Solaris 10, for to connect from Oracle Database to SQL server database.

It appeared very difficult for me...

Can you help me?


Thank you very muck.",4
3222119,07/11/2010 06:37:20,338292,05/11/2010 13:04:17,24,0,Need help on this SQL...,"Here is the question:

    +--------------+
    Ships          |
    +--------------+
    Duke of north  |
    ---------------+
    Prince of Wales|
    ---------------+
    Baltic         |
    ---------------+


I need to replace all characters between the first and the last spaces (excluding these spaces) by symbols of an asterisk (*). The number of asterisks must be equal to number of replaced characters.

for example: ""Duke of North"" must be replaced as ""Duke ** North"",
I managed to cut the ""of"" from ""Duke of North"" but am really stuck with the replacement part, can any one give me some ideas, am learning SQL in MS SQL Server 2005, please help.
I dont need the exact answer just give me some ideas, 



    select 
    case when charindex(' ',ship,(charindex(' ',ship,1))+1) > 0 
    	 then substring(ship,(charindex(' ',ship,1))+1,((charindex(' ',ship,(charindex(' ',ship,1))+1)) - (charindex(' ',ship,1))))
    end ""Replace""
    from 
    outcomes


This is not a homework question, am learning SQL.",sql-server,sql-server-2005,,,,,open,0,204,5,"Need help on this SQL... Here is the question:

    +--------------+
    Ships          |
    +--------------+
    Duke of north  |
    ---------------+
    Prince of Wales|
    ---------------+
    Baltic         |
    ---------------+


I need to replace all characters between the first and the last spaces (excluding these spaces) by symbols of an asterisk (*). The number of asterisks must be equal to number of replaced characters.

for example: ""Duke of North"" must be replaced as ""Duke ** North"",
I managed to cut the ""of"" from ""Duke of North"" but am really stuck with the replacement part, can any one give me some ideas, am learning SQL in MS SQL Server 2005, please help.
I dont need the exact answer just give me some ideas, 



    select 
    case when charindex(' ',ship,(charindex(' ',ship,1))+1) > 0 
    	 then substring(ship,(charindex(' ',ship,1))+1,((charindex(' ',ship,(charindex(' ',ship,1))+1)) - (charindex(' ',ship,1))))
    end ""Replace""
    from 
    outcomes


This is not a homework question, am learning SQL.",2
4675082,01/12/2011 23:07:54,296564,03/18/2010 13:56:26,169,1,capture flow of execution in SQL Server,"I am very new to Microsoft SQL server. I am wondering if it is possible to capture a trace of the sql query on a database executed from an external program while ignoring the actions caused by trigger.

I used SQL profiler and choose to capture the text content for the SP:StmtCompleted event. The result is very overwhelming and contains a lot of code that is specified in the trigger.


Thanks,
Derek",sql-server,sql-server-2008,sql-server-profiler,,,,open,0,69,7,"capture flow of execution in SQL Server I am very new to Microsoft SQL server. I am wondering if it is possible to capture a trace of the sql query on a database executed from an external program while ignoring the actions caused by trigger.

I used SQL profiler and choose to capture the text content for the SP:StmtCompleted event. The result is very overwhelming and contains a lot of code that is specified in the trigger.


Thanks,
Derek",3
6157685,05/27/2011 21:06:03,109288,05/19/2009 10:34:42,430,20,Unique identifier as primary key when syncing databases,"I have spent the best part of a day researching and testing different methods of syncing a SQL server database with CoreData on the Mac. I have tested both INT's and GUID's (sequential GUID's also) as my primary keys and although GUID's are by far the worst in terms of performance I can't see no other way of ensuring uniqueness across systems. 

Is using GUID's for primary keys the wrong way to go when syncing data between platforms? I find it hard to believe that companies use GUID's when syncing, but most articles I read on the subject seem to point to just that. If developers are using GUID's does anybody know how performance can be improved? I tried using a GUID as a primary key with a non clustered index and created a date field as my clustered index with no great performance improvement.

Any help would be much appreciated, especially if you have tackled a similar problem. ",sql-server,database-design,synchronisation,,,,open,0,159,8,"Unique identifier as primary key when syncing databases I have spent the best part of a day researching and testing different methods of syncing a SQL server database with CoreData on the Mac. I have tested both INT's and GUID's (sequential GUID's also) as my primary keys and although GUID's are by far the worst in terms of performance I can't see no other way of ensuring uniqueness across systems. 

Is using GUID's for primary keys the wrong way to go when syncing data between platforms? I find it hard to believe that companies use GUID's when syncing, but most articles I read on the subject seem to point to just that. If developers are using GUID's does anybody know how performance can be improved? I tried using a GUID as a primary key with a non clustered index and created a date field as my clustered index with no great performance improvement.

Any help would be much appreciated, especially if you have tackled a similar problem. ",3
1109653,07/10/2009 13:50:42,115305,06/01/2009 06:19:23,962,90,Comparing database structures: how to create an SQL patch?,"I have two SQL Server (2000) databases. Both are used for the same project, but different versions. Basically, the old database is from our TEST environment. The new database is from the DEVELOPMENT environment. We also have an ACCEPTANCE, PRODUCTION and MAINTENANCE environment and they all contain the same project. (It's our development street, moving versions from D to T to A to P and finally M.)

Now, the development database structure has changed. A few tables have been added, indices are added or removed, fields have changed in type and nullable fields have become non-nullable, things like that. The test database needs to be upgraded with the new structure but without any loss of data. Right now, I'm doing this with a lot of manual labor. I keep a list of structural changes and once everything is ready, I write an update script to patch the old test database.

But as a software engineer, I'm just lazy by design. So, is there some easy tool somewhere which will compare the two database structures and generate an update script by itself?

(Only to change the structure, btw. No data manipulation!)",sql-server,lazy,,,,,open,0,187,9,"Comparing database structures: how to create an SQL patch? I have two SQL Server (2000) databases. Both are used for the same project, but different versions. Basically, the old database is from our TEST environment. The new database is from the DEVELOPMENT environment. We also have an ACCEPTANCE, PRODUCTION and MAINTENANCE environment and they all contain the same project. (It's our development street, moving versions from D to T to A to P and finally M.)

Now, the development database structure has changed. A few tables have been added, indices are added or removed, fields have changed in type and nullable fields have become non-nullable, things like that. The test database needs to be upgraded with the new structure but without any loss of data. Right now, I'm doing this with a lot of manual labor. I keep a list of structural changes and once everything is ready, I write an update script to patch the old test database.

But as a software engineer, I'm just lazy by design. So, is there some easy tool somewhere which will compare the two database structures and generate an update script by itself?

(Only to change the structure, btw. No data manipulation!)",2
6767773,07/20/2011 20:02:02,793468,06/10/2011 22:29:53,31,0,Update/Insert data in database table,"I want to update ""Grade"" Column in ""StudentTable"" with a WHERE clause of ""StudentID"""". And if there is no ""StudentID"" found in ""StudentTable"" then I want to Insert the data instead.

How can I do this?",sql-server,,,,,07/20/2011 22:11:57,not a real question,1,35,5,"Update/Insert data in database table I want to update ""Grade"" Column in ""StudentTable"" with a WHERE clause of ""StudentID"""". And if there is no ""StudentID"" found in ""StudentTable"" then I want to Insert the data instead.

How can I do this?",1
9939519,03/30/2012 08:34:05,439686,09/04/2010 16:12:33,41,0,INSERT INTO SELECT - large amount of records,"I want to insert records into a TempTable. Something like this:

    insert into ##tempT
    SELECT * FROM MyTable 

MyTable contains a large amount of records so the ""insert into"" takes a long time. 

If I try to run:

    SELECT COUNT(*) FROM ##tempT

it returns always ""0"" until all records from ""MyTable"" are inserted by INSERT INTO command.

How can I get a progress count that advise me how many records are in ##tempT? 

I need to update a progress bar value while the SQL command is running.


Thank you.
",sql-server,tsql,insert,,,,open,0,95,8,"INSERT INTO SELECT - large amount of records I want to insert records into a TempTable. Something like this:

    insert into ##tempT
    SELECT * FROM MyTable 

MyTable contains a large amount of records so the ""insert into"" takes a long time. 

If I try to run:

    SELECT COUNT(*) FROM ##tempT

it returns always ""0"" until all records from ""MyTable"" are inserted by INSERT INTO command.

How can I get a progress count that advise me how many records are in ##tempT? 

I need to update a progress bar value while the SQL command is running.


Thank you.
",3
7689662,10/07/2011 15:47:39,979278,10/04/2011 20:45:29,15,0,Getting Table Information,"I am trying to get the table information give a table name so I wrote a query like this:

     SELECT so.name, sc.name, st.name, sc.length, CASE WHEN sc.status = 0x80 THEN 'Y' ELSE 'N' END AS IsIdent, ColOrder
       FROM Asdim.dbo.sysobjects so
       INNER JOIN Asdim.dbo.syscolumns sc
       ON so.id=  sc.id
       INNER JOIN Asdim.dbo.systypes st
       ON sc.xtype = st.xusertype
       WHERE so.Name = 'Admin'

The problem is that I have two tables with name 'Admin' but they have different schemas. So when I run this query: 

    SELECT * FROM Asdim.dbo.sysobjects WHERE name LIKE 'Admin'

 
I get two records since the table names are same. Is there a way that I caould filter out based on the schema name too?
",sql-server,tsql,sql-server-2008,sysobjects,,,open,0,158,3,"Getting Table Information I am trying to get the table information give a table name so I wrote a query like this:

     SELECT so.name, sc.name, st.name, sc.length, CASE WHEN sc.status = 0x80 THEN 'Y' ELSE 'N' END AS IsIdent, ColOrder
       FROM Asdim.dbo.sysobjects so
       INNER JOIN Asdim.dbo.syscolumns sc
       ON so.id=  sc.id
       INNER JOIN Asdim.dbo.systypes st
       ON sc.xtype = st.xusertype
       WHERE so.Name = 'Admin'

The problem is that I have two tables with name 'Admin' but they have different schemas. So when I run this query: 

    SELECT * FROM Asdim.dbo.sysobjects WHERE name LIKE 'Admin'

 
I get two records since the table names are same. Is there a way that I caould filter out based on the schema name too?
",4
11037226,06/14/2012 16:18:11,975632,10/02/2011 17:25:31,284,17,Query all Databases a User has Access to as Administrator,"I'm looking to query all databases mapped to a user, similar to Security > Logins > Properties > User Mapping.

For example, something similar to:

    SELECT name
    FROM sys.sysdatabases
    WHERE HAS_DBACCESS(name) = 1

But perform the query from an administrative user, as opposed to running the above query as the user itself. 

How would something like this be performed?

Thank you.",sql-server,query,user,,,,open,0,67,10,"Query all Databases a User has Access to as Administrator I'm looking to query all databases mapped to a user, similar to Security > Logins > Properties > User Mapping.

For example, something similar to:

    SELECT name
    FROM sys.sysdatabases
    WHERE HAS_DBACCESS(name) = 1

But perform the query from an administrative user, as opposed to running the above query as the user itself. 

How would something like this be performed?

Thank you.",3
1718763,11/11/2009 23:13:50,172617,09/12/2009 22:43:15,152,4,Scramble a column in SQL Server?,"We have a web app we'd like to demo to prospects, but our best way of doing so is with existing data, for a full experience.  Certainly, we don't want to do this with actual customer names or addresses, etc visible in the app.  Is there an easy way in SQL Server to randomize or scramble a varchar or text field?

None of these columns are keys in anyway, either primary or foreign.",sql-server,random,scramble,,,,open,0,74,6,"Scramble a column in SQL Server? We have a web app we'd like to demo to prospects, but our best way of doing so is with existing data, for a full experience.  Certainly, we don't want to do this with actual customer names or addresses, etc visible in the app.  Is there an easy way in SQL Server to randomize or scramble a varchar or text field?

None of these columns are keys in anyway, either primary or foreign.",3
9253732,02/12/2012 23:29:37,325727,04/26/2010 05:53:33,1827,117,Tool to run a scripted database schema compare in SQL Server?,"I can see there are multiple questions about database schema compare in SQL Server, but all of them look like they are GUI tools.  Is there something that can run a database schema in a scripted manner eg where you just have to pass in the names of the two databases?

eg If I have databases templatedb, db01, db02, db03, db04, etc where db01 .. dbN that are meant to have the same schema as templatedb, what tool will allow me to run something like

    compare db01, templatedb;
    compare db02, templatedb;
    compare db03, templatedb;
    compare db04, templatedb;

And get a report of differences at the end?  

",sql-server,tsql,script,schema,compare,02/14/2012 20:36:46,not constructive,1,119,11,"Tool to run a scripted database schema compare in SQL Server? I can see there are multiple questions about database schema compare in SQL Server, but all of them look like they are GUI tools.  Is there something that can run a database schema in a scripted manner eg where you just have to pass in the names of the two databases?

eg If I have databases templatedb, db01, db02, db03, db04, etc where db01 .. dbN that are meant to have the same schema as templatedb, what tool will allow me to run something like

    compare db01, templatedb;
    compare db02, templatedb;
    compare db03, templatedb;
    compare db04, templatedb;

And get a report of differences at the end?  

",5
3020130,06/11/2010 04:04:07,364192,06/11/2010 04:04:06,1,0,How to connect Visual Studio 2010 to sql server 2008,"I need to make a questionary(test) from users then write their answers in a database, I want to make a test on a web page. Please, if somebody   know please help me.",sql-server,,,,,06/11/2010 05:57:13,not a real question,1,34,10,"How to connect Visual Studio 2010 to sql server 2008 I need to make a questionary(test) from users then write their answers in a database, I want to make a test on a web page. Please, if somebody   know please help me.",1
5974209,05/12/2011 06:35:48,748504,05/11/2011 11:02:34,3,0,rectify Error in my Storred procedure,"I M FACING ERROR ON LINE47 ... WHAT IS ERROR AT ELSE
ALTER Procedure dbo.sp_Normal_Search

@title AS nvarchar(max),
@Description AS nvarchar(max),
@Keywords AS nvarchar(max),
@Chk_title AS BIT ,
@Chk_Description AS Bit ,
@Chk_Keywords AS BIT,
@RD_AND AS BIT,
@RD_OR AS BIT



AS
if @RD_AND = 1
Begin
	if @Chk_title = 1 
		Begin
		Select title from server_des where title Like '%'+ @title+'%'
		End
	if @Chk_Description=1
		Begin
		Select Description from server_des where Description  Like '%'+@Description+'%'
		End
	if @Chk_Keywords=1
		Begin
		Select Keywords from server_des where Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title = 1 AND @Chk_Description = 1
		Begin
		Select title, Description from server_des where title Like '%'+ @title+'%' AND  Description  Like '%'+@Description+'%'
		End
	if @Chk_Description=1 AND @Chk_Keywords=1
		Begin
		Select Description, Keywords from server_des where  Description  Like '%'+@Description+'%' AND  Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Chk_Keywords=1
		Begin
		Select title, Keywords from server_des where title Like '%'+@title+'%' AND Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Description=1 AND @title=1
		Begin
		Select title, Description, Keywords from server_des where title Like '%'+@title+'%'AND  Description Like '%'+@Description+'%' AND Keywords Like '%' +@Keywords+'%'
		End		
End
	**ELSE @RD_OR=0**
	Begin
	if @Chk_title = 1 
		Begin
		Select title from server_des where title Like '%'+ @title+'%'
		End
	if @Chk_Description=1
		Begin
		Select Description from server_des where Description  Like '%'+@Description+'%'
		End
	if @Chk_Keywords=1
		Begin
		Select Keywords from server_des where Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title = 1 AND @Chk_Description = 1
		Begin
		Select title, Description from server_des where title Like '%'+ @title+'%' AND  Description  Like '%'+@Description+'%'
		End
	if @Chk_Description=1 AND @Chk_Keywords=1
		Begin
		Select Description, Keywords from server_des where  Description  Like '%'+@Description+'%' AND  Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Chk_Keywords=1
		Begin
		Select title, Keywords from server_des where title Like '%'+@title+'%' AND Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Description=1 AND @title=1
		Begin
		Select title, Description, Keywords from server_des where title Like '%'+@title+'%'AND  Description Like '%'+@Description+'%' AND Keywords Like '%' +@Keywords+'%'
		End		
End
GO

Heading
=======",sql-server,,,,,05/12/2011 07:03:49,not a real question,1,250,6,"rectify Error in my Storred procedure I M FACING ERROR ON LINE47 ... WHAT IS ERROR AT ELSE
ALTER Procedure dbo.sp_Normal_Search

@title AS nvarchar(max),
@Description AS nvarchar(max),
@Keywords AS nvarchar(max),
@Chk_title AS BIT ,
@Chk_Description AS Bit ,
@Chk_Keywords AS BIT,
@RD_AND AS BIT,
@RD_OR AS BIT



AS
if @RD_AND = 1
Begin
	if @Chk_title = 1 
		Begin
		Select title from server_des where title Like '%'+ @title+'%'
		End
	if @Chk_Description=1
		Begin
		Select Description from server_des where Description  Like '%'+@Description+'%'
		End
	if @Chk_Keywords=1
		Begin
		Select Keywords from server_des where Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title = 1 AND @Chk_Description = 1
		Begin
		Select title, Description from server_des where title Like '%'+ @title+'%' AND  Description  Like '%'+@Description+'%'
		End
	if @Chk_Description=1 AND @Chk_Keywords=1
		Begin
		Select Description, Keywords from server_des where  Description  Like '%'+@Description+'%' AND  Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Chk_Keywords=1
		Begin
		Select title, Keywords from server_des where title Like '%'+@title+'%' AND Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Description=1 AND @title=1
		Begin
		Select title, Description, Keywords from server_des where title Like '%'+@title+'%'AND  Description Like '%'+@Description+'%' AND Keywords Like '%' +@Keywords+'%'
		End		
End
	**ELSE @RD_OR=0**
	Begin
	if @Chk_title = 1 
		Begin
		Select title from server_des where title Like '%'+ @title+'%'
		End
	if @Chk_Description=1
		Begin
		Select Description from server_des where Description  Like '%'+@Description+'%'
		End
	if @Chk_Keywords=1
		Begin
		Select Keywords from server_des where Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title = 1 AND @Chk_Description = 1
		Begin
		Select title, Description from server_des where title Like '%'+ @title+'%' AND  Description  Like '%'+@Description+'%'
		End
	if @Chk_Description=1 AND @Chk_Keywords=1
		Begin
		Select Description, Keywords from server_des where  Description  Like '%'+@Description+'%' AND  Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Chk_Keywords=1
		Begin
		Select title, Keywords from server_des where title Like '%'+@title+'%' AND Keywords Like '%'+@Keywords+'%'
		End
	if @Chk_title=1 AND @Description=1 AND @title=1
		Begin
		Select title, Description, Keywords from server_des where title Like '%'+@title+'%'AND  Description Like '%'+@Description+'%' AND Keywords Like '%' +@Keywords+'%'
		End		
End
GO

Heading
=======",1
9674372,03/12/2012 20:31:47,778219,05/31/2011 19:05:24,47,0,Best way to synchronize sql,"What is the best way to synchronize MS SQL table fields (not data), stored procedures, views and functions?
Thank you",sql-server,,,,,05/25/2012 19:06:58,not a real question,1,19,5,"Best way to synchronize sql What is the best way to synchronize MS SQL table fields (not data), stored procedures, views and functions?
Thank you",1
11219850,06/27/2012 05:19:07,1482974,06/26/2012 13:57:59,1,0,SQl server 2008 with (nolock),"What is use of  with(NOlock) in sql server ,withnolock is used to join the tables ?",sql-server,,,,,06/27/2012 11:44:54,not a real question,1,17,5,"SQl server 2008 with (nolock) What is use of  with(NOlock) in sql server ,withnolock is used to join the tables ?",1
7089342,08/17/2011 07:41:00,898155,08/17/2011 07:39:44,1,0,SQL Server Exams: MCTS 70-433 and MCTS 70-432 = MCITPRO?,"I have been told by a Microsoft instructor that passing two MCTS SQL server exams (70-432 - SQL Server 2008, Implementation and Maintainence and 70-433 SQL Server 2008, Database Development) leads to gaining the MCITPRO qualification. I can't find any evidence of this on the Microsoft Learning website but he seems very certain.

Can anyone confirm or deny this?

Many thanks.

Regards,
Brian",sql-server,mcts,microsoft-certifications,,,08/17/2011 08:37:25,off topic,1,59,10,"SQL Server Exams: MCTS 70-433 and MCTS 70-432 = MCITPRO? I have been told by a Microsoft instructor that passing two MCTS SQL server exams (70-432 - SQL Server 2008, Implementation and Maintainence and 70-433 SQL Server 2008, Database Development) leads to gaining the MCITPRO qualification. I can't find any evidence of this on the Microsoft Learning website but he seems very certain.

Can anyone confirm or deny this?

Many thanks.

Regards,
Brian",3
7968610,11/01/2011 15:15:27,46177,12/14/2008 19:07:55,162,4,SQL Server: fundamental design issue?,"
The director of the company I work for met another director of a software company at a party (this is not a joke !).  

The second director told my director that,

'he had spent a fortune abandoning SQL Server' because 'if several people were querying the same table in different ways the database locked up'.  Further, this is a 'known fundamental design issue with SQL Server where each query competes for maximum resources until SQL Server locks up after about 7 concurrent queries to the same table'.

Now I know a bit about SQL Server locking and IO and this is news to me.  AFAIK there is nothing *inherent* in the SQL Server architectur that causes such problems.  And SQL Server performs well in the TPC benchmarks, esp on price/performance.

Feel embarrassed asking but I have to be sure - is there any grain of truth to what he said ?





",sql-server,,,,,11/27/2011 00:08:55,not constructive,1,152,5,"SQL Server: fundamental design issue? 
The director of the company I work for met another director of a software company at a party (this is not a joke !).  

The second director told my director that,

'he had spent a fortune abandoning SQL Server' because 'if several people were querying the same table in different ways the database locked up'.  Further, this is a 'known fundamental design issue with SQL Server where each query competes for maximum resources until SQL Server locks up after about 7 concurrent queries to the same table'.

Now I know a bit about SQL Server locking and IO and this is news to me.  AFAIK there is nothing *inherent* in the SQL Server architectur that causes such problems.  And SQL Server performs well in the TPC benchmarks, esp on price/performance.

Feel embarrassed asking but I have to be sure - is there any grain of truth to what he said ?





",1
2776443,05/05/2010 20:12:14,48082,12/21/2008 03:44:34,20562,1013,SQL Server: ODBC Connection pooling / C API,"I want to clarify how to do connection pooling with SQL Server from C, using [ODBC][1]. I know this question is, like.... sooooo 1998, but... I've never done it in C, so... here goes: 

First I think I have to set the attribute to enable pooling: 

    rc = SQLSetEnvAttr( NULL,  // make process level cursor pooling
                        SQL_ATTR_CONNECTION_POOLING,
                        (SQLPOINTER)SQL_CP_ONE_PER_DRIVER,
                        SQL_IS_INTEGER);

Then allocate the HENV and set it for ODBC3.0:

    rc = SQLAllocHandle(SQL_HANDLE_ENV, NULL, &henv1);
    rc = SQLSetEnvAttr(henv1, SQL_ATTR_ODBC_VERSION, (void *)SQL_OV_ODBC3, 0);

----

**Questions**

<ol>
<li>Is it correct that I can use the HENV allocated above, in multiple concurrent threads within a single process, as I call SQLAllocHandle to allocate db connections (HDBC)? <br/><br/></li>

<li>When I want to use connection from the pool, is it correct that the typical sequence is: 
<br/><br/>
<ol>
<li>SQLAllocHandle to get connection handle (HDBC)</li>
<li>SQLDriverConnect/SQLConnect to connect on that handle</li>
<li>SQLExecute/SQLExecDirect + a series of SQLFetch, to use the connection</li>
<li>SQLDisconnect </li>
<li>SQLFreeConnect</li>
</ol>
<br/>
</li>

<li>Is there a significant latency benefit if I save the allocated HDBC handle, and re-use it across multiple SQLDriverConnect + SQLDisconnect calls?  In other words, I'd skip steps 2.1 and 2.5, for each use of the connection.   Or are steps 2.1 and 2.5 basically just malloc/free?  (in which case, I don't think I care). </li>

</ol>
 
----

In this particular scenario, the C app will likely be the only application accessing the SQL Server from this box. But it's going to run within a IIS environment, and that means it will be potentially multi-process and each process will be multi-threaded. 

I'll be getting and using that connection within the scope of a HTTP Request, so I'll want it to be as fast, efficient, and scalable as possible. 


  [1]: http://msdn.microsoft.com/en-us/library/ms714562(VS.85).aspx",sql-server,odbc,c,connection-pooling,,,open,0,356,8,"SQL Server: ODBC Connection pooling / C API I want to clarify how to do connection pooling with SQL Server from C, using [ODBC][1]. I know this question is, like.... sooooo 1998, but... I've never done it in C, so... here goes: 

First I think I have to set the attribute to enable pooling: 

    rc = SQLSetEnvAttr( NULL,  // make process level cursor pooling
                        SQL_ATTR_CONNECTION_POOLING,
                        (SQLPOINTER)SQL_CP_ONE_PER_DRIVER,
                        SQL_IS_INTEGER);

Then allocate the HENV and set it for ODBC3.0:

    rc = SQLAllocHandle(SQL_HANDLE_ENV, NULL, &henv1);
    rc = SQLSetEnvAttr(henv1, SQL_ATTR_ODBC_VERSION, (void *)SQL_OV_ODBC3, 0);

----

**Questions**

<ol>
<li>Is it correct that I can use the HENV allocated above, in multiple concurrent threads within a single process, as I call SQLAllocHandle to allocate db connections (HDBC)? <br/><br/></li>

<li>When I want to use connection from the pool, is it correct that the typical sequence is: 
<br/><br/>
<ol>
<li>SQLAllocHandle to get connection handle (HDBC)</li>
<li>SQLDriverConnect/SQLConnect to connect on that handle</li>
<li>SQLExecute/SQLExecDirect + a series of SQLFetch, to use the connection</li>
<li>SQLDisconnect </li>
<li>SQLFreeConnect</li>
</ol>
<br/>
</li>

<li>Is there a significant latency benefit if I save the allocated HDBC handle, and re-use it across multiple SQLDriverConnect + SQLDisconnect calls?  In other words, I'd skip steps 2.1 and 2.5, for each use of the connection.   Or are steps 2.1 and 2.5 basically just malloc/free?  (in which case, I don't think I care). </li>

</ol>
 
----

In this particular scenario, the C app will likely be the only application accessing the SQL Server from this box. But it's going to run within a IIS environment, and that means it will be potentially multi-process and each process will be multi-threaded. 

I'll be getting and using that connection within the scope of a HTTP Request, so I'll want it to be as fast, efficient, and scalable as possible. 


  [1]: http://msdn.microsoft.com/en-us/library/ms714562(VS.85).aspx",4
8198946,11/20/2011 02:11:32,109035,05/18/2009 21:44:38,15335,838,How can I make my SSIS process run faster?,"I have a an ETL process in SSIS 

In its oversimplified form, It takes in 17 Million rows, unpivots them to 408M, does some calculations and then aggregates it back to about 8M rows that are written to a brand new table every time (this table will then be moved into a partition).

It is running on an 8CPU, 32GB RAM box.  The SQL Server database is a different 8CPU, 32GB RAM box server. 

Here is the task manager graph from the SSIS server

![alt text][1]

Here is another graph showing the 8 individual CPUs

![alt text][2]

  [1]: http://img155.imageshack.us/img155/8453/resources01.jpg
  [2]: http://img219.imageshack.us/img219/2013/resources02.jpg

As you can see from these images, the memory usage slowly increases to about 25G as more and more rows are read and processed. However the CPU usage is constant around 40%.

The second graph shows that we are only using 4 (sometimes 5) CPUs out of 8.

I am trying to make the process run faster by using more CPU.

How do I go about making this process run faster?",sql-server,performance,ssis,sql-server-2008-r2,etl,11/21/2011 01:44:26,off topic,1,167,9,"How can I make my SSIS process run faster? I have a an ETL process in SSIS 

In its oversimplified form, It takes in 17 Million rows, unpivots them to 408M, does some calculations and then aggregates it back to about 8M rows that are written to a brand new table every time (this table will then be moved into a partition).

It is running on an 8CPU, 32GB RAM box.  The SQL Server database is a different 8CPU, 32GB RAM box server. 

Here is the task manager graph from the SSIS server

![alt text][1]

Here is another graph showing the 8 individual CPUs

![alt text][2]

  [1]: http://img155.imageshack.us/img155/8453/resources01.jpg
  [2]: http://img219.imageshack.us/img219/2013/resources02.jpg

As you can see from these images, the memory usage slowly increases to about 25G as more and more rows are read and processed. However the CPU usage is constant around 40%.

The second graph shows that we are only using 4 (sometimes 5) CPUs out of 8.

I am trying to make the process run faster by using more CPU.

How do I go about making this process run faster?",5
4580517,01/02/2011 21:06:45,320380,04/12/2010 12:03:07,43,3,Stop Stored Procedure Execution,"Lets say I have a stored procedure which has a simple IF case. If performed check meets the criteria i want to stop the procedure. How may I do that ? Thanks alot.

    IF EXISTS (<Preform your Check>)
    BEGIN
        // NEED TO STOP STORED PROCEDURE EXECUTION
    END
    ELSE
    BEGIN
        INSERT ()...
    END

",sql-server,stored-procedures,,,,,open,0,84,4,"Stop Stored Procedure Execution Lets say I have a stored procedure which has a simple IF case. If performed check meets the criteria i want to stop the procedure. How may I do that ? Thanks alot.

    IF EXISTS (<Preform your Check>)
    BEGIN
        // NEED TO STOP STORED PROCEDURE EXECUTION
    END
    ELSE
    BEGIN
        INSERT ()...
    END

",2
5181661,03/03/2011 13:59:28,643092,03/03/2011 13:52:30,1,0,"SQL 2008 , sQl 2005","i am working with a database name xyz , table name a ,b, c, d. my question is if in table a name field , table b  email field, table c phone number , change/update  i want to make table d field upload to 1. 
these tables has many fields, but i only want to change table d field when given three field change in three different table. ",sql-server,,,,,03/04/2011 09:26:00,not a real question,1,71,5,"SQL 2008 , sQl 2005 i am working with a database name xyz , table name a ,b, c, d. my question is if in table a name field , table b  email field, table c phone number , change/update  i want to make table d field upload to 1. 
these tables has many fields, but i only want to change table d field when given three field change in three different table. ",1
9819359,03/22/2012 09:21:36,75500,03/09/2009 06:16:32,10338,384,Store RichTextBox data in SQL Server?,"How do I store and retrieve data from SQL to be displayed in a `RichTextBox`?

Note: I prefer storing it in binary/XPS/RTF format.",sql-server,silverlight,richtextbox,,,,open,0,22,6,"Store RichTextBox data in SQL Server? How do I store and retrieve data from SQL to be displayed in a `RichTextBox`?

Note: I prefer storing it in binary/XPS/RTF format.",3
7963153,11/01/2011 06:28:11,1023156,11/01/2011 06:02:23,1,0,how to connect to sql server 2008 (R2) on same workgroup on intranet,"I am trying to connect to sql server R2 instance on same workgroup but I get 
(error: 26 - Error locating server/instance specified).

please Assume I have pc pc1 and pc2 with windows 7 
network connection pc1 - router - pc2
pc2 has my SQL SERVER 2008 R2 instance

I already followed this link
http://stackoverflow.com/questions/2486610/how-to-connect-to-sql-server-from-another-computer

I did 
 

 - allow remote connection on pc2
 - enable tcp/ip and set up 1433 port as per ""dyslexicanaboko"" suggested
   at above link
 - created inbound and outbound rules on pc2 for port 1433 to allow
   connection
 - i could successfully ping pc2's port 1433 from pc1 (using [tcping][1]
   utility)
 - i can browse shared folders of pc2 from pc1 (means my workgroup
   setting is fine)

however i still get error.

Am I still missing something? 
Does my pc2 needs to be logged in as administrator only in order for pc1 to connect? Or
Can a non admin user work on pc2 and I can still connect using pc1?

please be specific... thanks
 


  [1]: http://www.elifulkerson.com/projects/tcping.php",sql-server,connection,remote,workgroup,,11/14/2011 11:54:05,off topic,1,173,13,"how to connect to sql server 2008 (R2) on same workgroup on intranet I am trying to connect to sql server R2 instance on same workgroup but I get 
(error: 26 - Error locating server/instance specified).

please Assume I have pc pc1 and pc2 with windows 7 
network connection pc1 - router - pc2
pc2 has my SQL SERVER 2008 R2 instance

I already followed this link
http://stackoverflow.com/questions/2486610/how-to-connect-to-sql-server-from-another-computer

I did 
 

 - allow remote connection on pc2
 - enable tcp/ip and set up 1433 port as per ""dyslexicanaboko"" suggested
   at above link
 - created inbound and outbound rules on pc2 for port 1433 to allow
   connection
 - i could successfully ping pc2's port 1433 from pc1 (using [tcping][1]
   utility)
 - i can browse shared folders of pc2 from pc1 (means my workgroup
   setting is fine)

however i still get error.

Am I still missing something? 
Does my pc2 needs to be logged in as administrator only in order for pc1 to connect? Or
Can a non admin user work on pc2 and I can still connect using pc1?

please be specific... thanks
 


  [1]: http://www.elifulkerson.com/projects/tcping.php",4
2993323,06/07/2010 21:31:21,1818,08/18/2008 17:41:57,1108,33,Selecting data in clustered index order without ORDER BY,"I know there is no guarantee without an ORDER BY clause, but are there any techniques to tune SQL Server tables so they're *more likely* to return rows in clustered index order, without having to specify ORDER BY every single time I want to run a super-quick ad hoc query?  For example, would rebuilding my clustered index or updating statistics help?

I'm aware that I can't <em>count on</em> a query like:

    select *
    from AuditLog
    where UserId = 992

to return records in the order of the clustered index, so I would never build code into an application based on this assumption.  But for simple ad hoc queries, on almost all of my tables, the data consistently comes out in clustered index order, and I've gotten used to being able to expect the most recent results to be at the bottom.  Out of all the many tables we use, I've only noticed two ever giving me results in an unpredicted order.  This is really  just an annoyance, but it would be nice to be able to minimize it.

In case this is relevant because of page boundary issues or something like that, I should mention that one of the tables that has inconsistent ordering, the AuditLog table, is the longest table we have that has a clustered index on an identity column.  Also, this database has recently been moved from SQL 2005 to SQL 2008, and we've seen no noticeable change in this behavior.",sql-server,sql-server-2008,,,,,open,0,256,9,"Selecting data in clustered index order without ORDER BY I know there is no guarantee without an ORDER BY clause, but are there any techniques to tune SQL Server tables so they're *more likely* to return rows in clustered index order, without having to specify ORDER BY every single time I want to run a super-quick ad hoc query?  For example, would rebuilding my clustered index or updating statistics help?

I'm aware that I can't <em>count on</em> a query like:

    select *
    from AuditLog
    where UserId = 992

to return records in the order of the clustered index, so I would never build code into an application based on this assumption.  But for simple ad hoc queries, on almost all of my tables, the data consistently comes out in clustered index order, and I've gotten used to being able to expect the most recent results to be at the bottom.  Out of all the many tables we use, I've only noticed two ever giving me results in an unpredicted order.  This is really  just an annoyance, but it would be nice to be able to minimize it.

In case this is relevant because of page boundary issues or something like that, I should mention that one of the tables that has inconsistent ordering, the AuditLog table, is the longest table we have that has a clustered index on an identity column.  Also, this database has recently been moved from SQL 2005 to SQL 2008, and we've seen no noticeable change in this behavior.",2
5965166,05/11/2011 13:36:21,419733,08/13/2010 15:45:53,74,3,SQL Server Training Books and Videos,"I am just starting out in the world of SQL Server Database/Server administration, Due to a unexpected workload..

Can anyone suggest good, free training books or free training videos.

Which cover Profiler, Perfmon and other essential aspects of administering a server 

I have read the book by How to Become an Exceptional DBA by Brad M McGehee but that was more about a DBA as a person. (I do fit the profile but not the wage at the moment) 10 years. I will be there!

   

  ",sql-server,,,,,09/27/2011 14:56:17,not constructive,1,88,6,"SQL Server Training Books and Videos I am just starting out in the world of SQL Server Database/Server administration, Due to a unexpected workload..

Can anyone suggest good, free training books or free training videos.

Which cover Profiler, Perfmon and other essential aspects of administering a server 

I have read the book by How to Become an Exceptional DBA by Brad M McGehee but that was more about a DBA as a person. (I do fit the profile but not the wage at the moment) 10 years. I will be there!

   

  ",1
11619569,07/23/2012 19:57:57,1543644,07/22/2012 07:18:01,4,0,MSSQL Understanding Query Syntax - Collage,"I got this from an external source. I need help understanding.

	CREATE TABLE [dbo].[CHAR_INFOR] (
		[USER_KEY] [int] NOT NULL ,
		[USER_ID] [varchar] (16) COLLATE Thai_CI_AS NOT NULL ,
		[CHAR0_KEY] [int] NULL ,
		[CHARID0] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR1_KEY] [int] NULL ,
		[CHARID1] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR2_KEY] [int] NULL ,
		[CHARID2] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR3_KEY] [int] NULL ,
		[CHARID3] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR4_KEY] [int] NULL ,
		[CHARID4] [varchar] (16) COLLATE Thai_CI_AS NULL 
	) ON [PRIMARY]
	GO

What is the use of COLLATE? How does COLLATE affect this certain query? If COLLATE'd is the data also affected? or how the data is displayed affected?

What If I don't want COLLATE? Because I got this sql from Thailand where they use Thai configured computers and im not from Thailand, I have an English computer w/o any thai stuff installed. How do I reconstruct this? Please advice.

Thank you.",sql-server,query,syntax,collate,,07/24/2012 13:11:21,not constructive,1,139,6,"MSSQL Understanding Query Syntax - Collage I got this from an external source. I need help understanding.

	CREATE TABLE [dbo].[CHAR_INFOR] (
		[USER_KEY] [int] NOT NULL ,
		[USER_ID] [varchar] (16) COLLATE Thai_CI_AS NOT NULL ,
		[CHAR0_KEY] [int] NULL ,
		[CHARID0] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR1_KEY] [int] NULL ,
		[CHARID1] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR2_KEY] [int] NULL ,
		[CHARID2] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR3_KEY] [int] NULL ,
		[CHARID3] [varchar] (16) COLLATE Thai_CI_AS NULL ,
		[CHAR4_KEY] [int] NULL ,
		[CHARID4] [varchar] (16) COLLATE Thai_CI_AS NULL 
	) ON [PRIMARY]
	GO

What is the use of COLLATE? How does COLLATE affect this certain query? If COLLATE'd is the data also affected? or how the data is displayed affected?

What If I don't want COLLATE? Because I got this sql from Thailand where they use Thai configured computers and im not from Thailand, I have an English computer w/o any thai stuff installed. How do I reconstruct this? Please advice.

Thank you.",4
8334099,11/30/2011 22:45:37,456356,09/23/2010 15:28:14,1,0,Can't Clean the Results of a SQL Injection,"A website that I maintain, but didn't develop, was recently attacked through SQL Injection - we're currently working to plug the holes, however, I'm also in the process of cleaning up the database.  We've got several thousand records, each with 20-30 columns of data that had malicious code appended to the end.   

I've tried going through and doing a replace on the text for each column, but somehow it's not finding the offending data, and skipping right over it. 

1) How can they insert data that I can't search on?

2) How can I get it removed without having to touch each record individually?

I've tried going through the IIS logs to find my answers, but so far it's been a losing battle.

Additional information can be provided, but I want to keep things sparse due to current security concerns.",sql-server,sql-injection,,,,12/01/2011 00:08:17,too localized,1,140,8,"Can't Clean the Results of a SQL Injection A website that I maintain, but didn't develop, was recently attacked through SQL Injection - we're currently working to plug the holes, however, I'm also in the process of cleaning up the database.  We've got several thousand records, each with 20-30 columns of data that had malicious code appended to the end.   

I've tried going through and doing a replace on the text for each column, but somehow it's not finding the offending data, and skipping right over it. 

1) How can they insert data that I can't search on?

2) How can I get it removed without having to touch each record individually?

I've tried going through the IIS logs to find my answers, but so far it's been a losing battle.

Additional information can be provided, but I want to keep things sparse due to current security concerns.",2
11254560,06/29/2012 00:06:14,375799,06/25/2010 00:13:20,2393,86,How does SQL Server choose an index key for a foreign key reference?,"I am working with a legacy database that was imported from MS Access. There are about twenty tables with non-clustered, unique primary keys that were created during the MS Access > SQL Server upgrade. 

Many of these tables also have unique, non-clustered indexes that are duplicates of the primary key.

I am attempting to clean this up. 

But what I have found is after I recreate the primary keys as clustered indexes, and then try to rebuild the foreign key, the foreign key is referencing the old, duplicate index (which was unique). 

I know this because it won't let me drop the duplicate indexes.

I would think SQL Server would always choose a primary key if one existed. Does SQL Server have a method of choosing between a unique index and a primary key? Or is this a bug? 

To duplicate the problem (on SQL Server 2008 R2): 

    IF EXISTS (SELECT * FROM sys.tables WHERE name = 'Child') DROP TABLE Child
    GO
    IF EXISTS (SELECT * FROM sys.tables WHERE name = 'Parent') DROP TABLE Parent
    GO
    
    -- Create the parent table
    CREATE TABLE Parent (ParentID INT NOT NULL IDENTITY(1,1)) 
    
    -- Make the parent table a heap
    ALTER TABLE Parent ADD CONSTRAINT PK_Parent PRIMARY KEY NONCLUSTERED (ParentID) 
    
    -- Create the duplicate index on the parent table
    CREATE UNIQUE NONCLUSTERED INDEX IX_Parent ON Parent (ParentID) 
    
    -- Create the child table
    CREATE TABLE Child  (ChildID  INT NOT NULL IDENTITY(1,1), ParentID INT NOT NULL ) 
    
    -- Give the child table a normal PKey
    ALTER TABLE Child ADD CONSTRAINT PK_Child PRIMARY KEY CLUSTERED (ChildID) 
    
    -- Create a foreign key relationship with the Parent table on ParentID
    ALTER TABLE Child ADD CONSTRAINT FK_Child FOREIGN KEY (ParentID) 
    REFERENCES Parent (ParentID) ON DELETE CASCADE NOT FOR REPLICATION
    
    -- Try to clean this up
    -- Drop the foreign key constraint on the Child table
    ALTER TABLE Child DROP CONSTRAINT FK_Child
    
    -- Drop the primary key constraint on the Parent table
    ALTER TABLE Parent DROP CONSTRAINT PK_Parent
    
    -- Recreate the primary key on Parent as a clustered index
    ALTER TABLE Parent ADD CONSTRAINT PK_Parent PRIMARY KEY CLUSTERED (ParentID) 
    
    -- Recreate the foreign key in Child pointing to parent ID
    ALTER TABLE Child ADD CONSTRAINT FK_Child FOREIGN KEY (ParentID) 
    REFERENCES Parent (ParentID) ON DELETE CASCADE NOT FOR REPLICATION
    
    -- Try to drop the duplicate index on Parent 
    DROP INDEX IX_Parent ON Parent 

Error msg: 

> Msg 3723, Level 16, State 6, Line 36 An explicit DROP INDEX is not
> allowed on index 'Parent.IX_Parent'.  It is being used for FOREIGN KEY
> constraint enforcement.

",sql-server,index,foreign-keys,sql-server-2008-r2,primary-key,06/29/2012 16:38:36,off topic,1,563,13,"How does SQL Server choose an index key for a foreign key reference? I am working with a legacy database that was imported from MS Access. There are about twenty tables with non-clustered, unique primary keys that were created during the MS Access > SQL Server upgrade. 

Many of these tables also have unique, non-clustered indexes that are duplicates of the primary key.

I am attempting to clean this up. 

But what I have found is after I recreate the primary keys as clustered indexes, and then try to rebuild the foreign key, the foreign key is referencing the old, duplicate index (which was unique). 

I know this because it won't let me drop the duplicate indexes.

I would think SQL Server would always choose a primary key if one existed. Does SQL Server have a method of choosing between a unique index and a primary key? Or is this a bug? 

To duplicate the problem (on SQL Server 2008 R2): 

    IF EXISTS (SELECT * FROM sys.tables WHERE name = 'Child') DROP TABLE Child
    GO
    IF EXISTS (SELECT * FROM sys.tables WHERE name = 'Parent') DROP TABLE Parent
    GO
    
    -- Create the parent table
    CREATE TABLE Parent (ParentID INT NOT NULL IDENTITY(1,1)) 
    
    -- Make the parent table a heap
    ALTER TABLE Parent ADD CONSTRAINT PK_Parent PRIMARY KEY NONCLUSTERED (ParentID) 
    
    -- Create the duplicate index on the parent table
    CREATE UNIQUE NONCLUSTERED INDEX IX_Parent ON Parent (ParentID) 
    
    -- Create the child table
    CREATE TABLE Child  (ChildID  INT NOT NULL IDENTITY(1,1), ParentID INT NOT NULL ) 
    
    -- Give the child table a normal PKey
    ALTER TABLE Child ADD CONSTRAINT PK_Child PRIMARY KEY CLUSTERED (ChildID) 
    
    -- Create a foreign key relationship with the Parent table on ParentID
    ALTER TABLE Child ADD CONSTRAINT FK_Child FOREIGN KEY (ParentID) 
    REFERENCES Parent (ParentID) ON DELETE CASCADE NOT FOR REPLICATION
    
    -- Try to clean this up
    -- Drop the foreign key constraint on the Child table
    ALTER TABLE Child DROP CONSTRAINT FK_Child
    
    -- Drop the primary key constraint on the Parent table
    ALTER TABLE Parent DROP CONSTRAINT PK_Parent
    
    -- Recreate the primary key on Parent as a clustered index
    ALTER TABLE Parent ADD CONSTRAINT PK_Parent PRIMARY KEY CLUSTERED (ParentID) 
    
    -- Recreate the foreign key in Child pointing to parent ID
    ALTER TABLE Child ADD CONSTRAINT FK_Child FOREIGN KEY (ParentID) 
    REFERENCES Parent (ParentID) ON DELETE CASCADE NOT FOR REPLICATION
    
    -- Try to drop the duplicate index on Parent 
    DROP INDEX IX_Parent ON Parent 

Error msg: 

> Msg 3723, Level 16, State 6, Line 36 An explicit DROP INDEX is not
> allowed on index 'Parent.IX_Parent'.  It is being used for FOREIGN KEY
> constraint enforcement.

",5
4957615,02/10/2011 13:24:47,611416,02/10/2011 13:24:47,1,0,LinqToSQL existing database question,"


is it possible to use asp-mvc3 with linqtosql to support my existing database if yes, kindly direct me on how to sort it? :) 

i tried the asp mvc list tutorial and link my existing database into it by changing the
connection string and creating the pocos from the existing database tables but it didnt work
im thinking it must be my tables in plural form? e.g table-users 


thanks

",sql-server,mvc,asp,net,linq-to-sql,,open,0,67,4,"LinqToSQL existing database question 


is it possible to use asp-mvc3 with linqtosql to support my existing database if yes, kindly direct me on how to sort it? :) 

i tried the asp mvc list tutorial and link my existing database into it by changing the
connection string and creating the pocos from the existing database tables but it didnt work
im thinking it must be my tables in plural form? e.g table-users 


thanks

",5
8520941,12/15/2011 13:36:42,780955,06/02/2011 10:42:06,441,12,FIRST_VALUE() and LAST_VALUE() in Sqlserver,"I am reading Sql server book and i read FIRST_VALUE() and LAST_VALUE() this function.

But i have little bit of confusion for that.

Please explain it with Example if possible.

Thanks in advance",sql-server,,,,,12/16/2011 15:33:57,not a real question,1,30,5,"FIRST_VALUE() and LAST_VALUE() in Sqlserver I am reading Sql server book and i read FIRST_VALUE() and LAST_VALUE() this function.

But i have little bit of confusion for that.

Please explain it with Example if possible.

Thanks in advance",1
9948533,03/30/2012 18:28:27,734415,05/02/2011 12:17:14,101,0,SQL Server bulkinsert performance tunning,"I have database on SQL Server. Simple rec.model, diskspace allocated in-advance. Database is being populated with records via bulkinsert. Table, simple, clustered Pk on autoincrement filed. no updates, only inserts. Only certain amount of data is stored in 1 table, i.e. new tables are being created on regular basis. less than 50% of RAM used, average about 5-10% CPUs.

There is patter patter in SQL performance behavior which I don't understand. On test case with certain amount of data Server stores 3 tables spending about 10 sec per table, some where in the middle of 4 table it freezes for quite a while so 4 table takes 80-100 sec, next 3 table again 10 second and so on. Resource monitor shows increase in disk queue at that moment. To eliminate the disk internal buffering/performance issues I added interval between tables, so nothing happened and disk would have ""free"" time. That didn't help. Looks like SQL Server performs some sort internal optimization.

Any ideas how to make performance more ""flat""? Where to look what to read",sql-server,performance,bulkinsert,,,03/30/2012 20:58:19,off topic,1,173,5,"SQL Server bulkinsert performance tunning I have database on SQL Server. Simple rec.model, diskspace allocated in-advance. Database is being populated with records via bulkinsert. Table, simple, clustered Pk on autoincrement filed. no updates, only inserts. Only certain amount of data is stored in 1 table, i.e. new tables are being created on regular basis. less than 50% of RAM used, average about 5-10% CPUs.

There is patter patter in SQL performance behavior which I don't understand. On test case with certain amount of data Server stores 3 tables spending about 10 sec per table, some where in the middle of 4 table it freezes for quite a while so 4 table takes 80-100 sec, next 3 table again 10 second and so on. Resource monitor shows increase in disk queue at that moment. To eliminate the disk internal buffering/performance issues I added interval between tables, so nothing happened and disk would have ""free"" time. That didn't help. Looks like SQL Server performs some sort internal optimization.

Any ideas how to make performance more ""flat""? Where to look what to read",3
9306953,02/16/2012 07:07:46,15127,09/17/2008 06:20:18,1586,90,Trying to optimize a query that picks an 'approximate closest record',"I have a table that contains a lot of data, where we particularly care about the `date` field.  The reason for this is that the data volume just went up ~30x, and the old ways will fall apart soon. The query I hope you can help me optimize needs to:

 * take a list of dates (generated by a cte based table-valued function)
 * retrieve a single record for each of those dates
  * based on some definition of 'nearest'

For instance, the current table contains data in 5 second (+/- a little) intervals.  I need to sample that table and get the record that falls closest to a 30 second interval.  

What I have right now works just fine.  I'm simply curious if there is a way to optimize it more.  If I can do it in Linq To SQL, that would be neat too.  I am even interested in suggestions on indexes, given the amount of date values (~2 million rows min). 

    declare @st  datetime ; set @st  = '2012-01-31 05:05:00';
    declare @end datetime ; set @end = '2012-01-31 05:10:00';

    select distinct
        log.*   -- id, 
    from 
        dbo.fn_GenerateDateSteps(@st, @end, 30) as d
            inner join lotsOfLogData log on l.Id = (
                select top 1 e.[Id]
                from 
                    lotsOfLogData as log  -- contains data in 5 second intervals
                where
                    -- search for dates in a certain range
                    utcTime between DateAdd(s, -10, dt) AND DateAdd(s, 5, dt)
                order by
                    -- get the 'closest'. this can change a little, but will always 
                    -- be based on a difference between the date
                    abs(datediff(s, dt, UtcTime)) 
            )
    where
        log.stationId = 1000

The table structure of lotsOfLogData is below.  There are relatively few station IDs (maybe 50), but lots of records for each.  We know the station id when we query.
    
    create table ##lotsOfLogData (
        Id          bigint      identity(1,1) not null
    ,   StationId   int         not null
    ,   UtcTime     datetime    not null
        -- 20 other fields, used for other calculations
    )

**fn_GenerateDateSteps** returns a dataset like this, for the parameters given:
    
    [DT]
    2012-01-31 05:05:00.000
    2012-01-31 05:05:30.000
    2012-01-31 05:06:00.000
    2012-01-31 05:06:30.000  (and so on, every 30 seconds)


I have done this with a temporary table as well, in this manner, but that came out just a little bit more expensive.

    declare @dates table ( dt datetime, ClosestId bigint); 
    insert into @dates (dt) select dt from dbo.fn_GenerateDateSteps(@st, @end, 30)
    update @dates set closestId = ( -- same subquery as above )
    select * from lotsOfLogData inner join @dates on Id = ClosestId",sql-server,query,sql-server-2005,,,,open,0,757,11,"Trying to optimize a query that picks an 'approximate closest record' I have a table that contains a lot of data, where we particularly care about the `date` field.  The reason for this is that the data volume just went up ~30x, and the old ways will fall apart soon. The query I hope you can help me optimize needs to:

 * take a list of dates (generated by a cte based table-valued function)
 * retrieve a single record for each of those dates
  * based on some definition of 'nearest'

For instance, the current table contains data in 5 second (+/- a little) intervals.  I need to sample that table and get the record that falls closest to a 30 second interval.  

What I have right now works just fine.  I'm simply curious if there is a way to optimize it more.  If I can do it in Linq To SQL, that would be neat too.  I am even interested in suggestions on indexes, given the amount of date values (~2 million rows min). 

    declare @st  datetime ; set @st  = '2012-01-31 05:05:00';
    declare @end datetime ; set @end = '2012-01-31 05:10:00';

    select distinct
        log.*   -- id, 
    from 
        dbo.fn_GenerateDateSteps(@st, @end, 30) as d
            inner join lotsOfLogData log on l.Id = (
                select top 1 e.[Id]
                from 
                    lotsOfLogData as log  -- contains data in 5 second intervals
                where
                    -- search for dates in a certain range
                    utcTime between DateAdd(s, -10, dt) AND DateAdd(s, 5, dt)
                order by
                    -- get the 'closest'. this can change a little, but will always 
                    -- be based on a difference between the date
                    abs(datediff(s, dt, UtcTime)) 
            )
    where
        log.stationId = 1000

The table structure of lotsOfLogData is below.  There are relatively few station IDs (maybe 50), but lots of records for each.  We know the station id when we query.
    
    create table ##lotsOfLogData (
        Id          bigint      identity(1,1) not null
    ,   StationId   int         not null
    ,   UtcTime     datetime    not null
        -- 20 other fields, used for other calculations
    )

**fn_GenerateDateSteps** returns a dataset like this, for the parameters given:
    
    [DT]
    2012-01-31 05:05:00.000
    2012-01-31 05:05:30.000
    2012-01-31 05:06:00.000
    2012-01-31 05:06:30.000  (and so on, every 30 seconds)


I have done this with a temporary table as well, in this manner, but that came out just a little bit more expensive.

    declare @dates table ( dt datetime, ClosestId bigint); 
    insert into @dates (dt) select dt from dbo.fn_GenerateDateSteps(@st, @end, 30)
    update @dates set closestId = ( -- same subquery as above )
    select * from lotsOfLogData inner join @dates on Id = ClosestId",3
7074513,08/16/2011 06:47:57,896129,08/16/2011 06:47:57,1,0,number of row that repeated,"table `tbl1`

field `id,name`

id=1   name=a

id=1   name=a

id=1   name=w

id=1   name=f

id=2   name=c

id=2   name=a



how can get number of field repeated. id=1 ,name=a  ==>2












",sql-server,sql-server-2005,sql-server-2008,sql-server-2000,sql-server-express,,open,0,31,5,"number of row that repeated table `tbl1`

field `id,name`

id=1   name=a

id=1   name=a

id=1   name=w

id=1   name=f

id=2   name=c

id=2   name=a



how can get number of field repeated. id=1 ,name=a  ==>2












",5
4164587,11/12/2010 12:27:28,437759,09/02/2010 09:06:47,1274,103,What algorithms does SQL use?,"Ive always wondered this but never had the chance to research it.

What sort of algorithms are use in SQL? Naturally you search and compare for basic statements, what search algorithms? Sorting? and for other functions like Join's etc.",sql-server,algorithm,query,sql,,11/13/2010 00:59:12,not a real question,1,38,5,"What algorithms does SQL use? Ive always wondered this but never had the chance to research it.

What sort of algorithms are use in SQL? Naturally you search and compare for basic statements, what search algorithms? Sorting? and for other functions like Join's etc.",4
22792,08/22/2008 16:26:31,1463,08/15/2008 17:26:44,225,13,Is there an open source SQL Server DB compare tool?,"I'm working on an open source project that uses SQL Server 2005 as the data store. We need a DB compare tool to generate diff scripts to be able to upgrade a DB from one version to another.

Is there an open source or free SQL Server DB diff tool out there that generates a convert script?",sql-server,,,,,05/20/2012 15:24:30,not constructive,1,56,10,"Is there an open source SQL Server DB compare tool? I'm working on an open source project that uses SQL Server 2005 as the data store. We need a DB compare tool to generate diff scripts to be able to upgrade a DB from one version to another.

Is there an open source or free SQL Server DB diff tool out there that generates a convert script?",1
2088727,01/18/2010 19:43:27,240476,12/29/2009 21:07:38,8,0,SQL HAVING SUM GROUP BY,"Using MS SQL Server 2005. I am building an inventory/purchasing program and I’m at the point where I need the user to “check out” equipment. When he selects a product, I need to query which stock locations have the available Qty, and tell the user which location to walk to/ retrieve product.

Here is a query for a particular [StockLocation_Products].ProductID, with a particular assigned [ProductUsages].ProductUsageID.

    SELECT PROD.ProductID,
    PROD.ProductName,
    SL.Room,
    SL.StockSpace,
    SLPPU.ResvQty,
    PRDUSG.ProductUsage
    FROM [StockLocations] SL INNER JOIN
    [StockLocation_Products] SLP ON SL.StockLocationID = SLP.StockLocationID INNER JOIN
    [StockLocation_Product_ProductUsages] SLPPU 
      ON SLP.StockLocationID = SLPPU.StockLocationID AND SLP.ProductID = SLPPU.ProductID INNER JOIN
    [ProductUsages] PUSG ON SLPPU.ProductUsageID = PRDUSG.ProductUsageID INNER JOIN
    [Products] PROD ON SLPPU.ProductID = PROD.ProductID
    WHERE SLP.ProductID = 4 AND PRDUSG.ProductUsageID = 1

This query returns:

    ProductID ProductName			Room	StockSpace	ResvQty	ProductUsage
    ------------------------------------------------------------------------------------------------------------------------
    4	Addonics Pocket DVD+/-R/RW 	B700	5-D			12		MC Pool
    4	Addonics Pocket DVD+/-R/RW 	B700	6-B			10		MC Pool
    4	Addonics Pocket DVD+/-R/RW 	B700	6-C			21		MC Pool
    4	Addonics Pocket DVD+/-R/RW 	B700	6-D			20		MC Pool


I thought maybe I could use an additional HAVING clause to make this query return which combination of StockSpace(s) you’d need to visit to satisfy a request for some Qty. E.g.  User needs to pull 30 of Product (ID =4). 

But I don’t really understand how to use GROUP BY with HAVING SUM(), to achieve what I want.
I tried various things in my group by / having clause, but I just don’t get any results.

    GROUP BY PROD.ProductID,PROD.ProductName,SL.Room,SL.StockSpace,SLPPU.ResvQty,PUSG.ProductUsage
    HAVING SUM(ResvQty) >= 30;

I want results that show (at least one) combination of StockSpaces which sums up to 30, so I can tell the user “you can get 21 units from space ‘6-C’, and 9 units from ‘6-B’. There may be multiple combinations of rows that could sum() >= 30, but I need at least how to find one combination that does! Help!

",sql-server,having,group-by,sum,,,open,0,350,5,"SQL HAVING SUM GROUP BY Using MS SQL Server 2005. I am building an inventory/purchasing program and I’m at the point where I need the user to “check out” equipment. When he selects a product, I need to query which stock locations have the available Qty, and tell the user which location to walk to/ retrieve product.

Here is a query for a particular [StockLocation_Products].ProductID, with a particular assigned [ProductUsages].ProductUsageID.

    SELECT PROD.ProductID,
    PROD.ProductName,
    SL.Room,
    SL.StockSpace,
    SLPPU.ResvQty,
    PRDUSG.ProductUsage
    FROM [StockLocations] SL INNER JOIN
    [StockLocation_Products] SLP ON SL.StockLocationID = SLP.StockLocationID INNER JOIN
    [StockLocation_Product_ProductUsages] SLPPU 
      ON SLP.StockLocationID = SLPPU.StockLocationID AND SLP.ProductID = SLPPU.ProductID INNER JOIN
    [ProductUsages] PUSG ON SLPPU.ProductUsageID = PRDUSG.ProductUsageID INNER JOIN
    [Products] PROD ON SLPPU.ProductID = PROD.ProductID
    WHERE SLP.ProductID = 4 AND PRDUSG.ProductUsageID = 1

This query returns:

    ProductID ProductName			Room	StockSpace	ResvQty	ProductUsage
    ------------------------------------------------------------------------------------------------------------------------
    4	Addonics Pocket DVD+/-R/RW 	B700	5-D			12		MC Pool
    4	Addonics Pocket DVD+/-R/RW 	B700	6-B			10		MC Pool
    4	Addonics Pocket DVD+/-R/RW 	B700	6-C			21		MC Pool
    4	Addonics Pocket DVD+/-R/RW 	B700	6-D			20		MC Pool


I thought maybe I could use an additional HAVING clause to make this query return which combination of StockSpace(s) you’d need to visit to satisfy a request for some Qty. E.g.  User needs to pull 30 of Product (ID =4). 

But I don’t really understand how to use GROUP BY with HAVING SUM(), to achieve what I want.
I tried various things in my group by / having clause, but I just don’t get any results.

    GROUP BY PROD.ProductID,PROD.ProductName,SL.Room,SL.StockSpace,SLPPU.ResvQty,PUSG.ProductUsage
    HAVING SUM(ResvQty) >= 30;

I want results that show (at least one) combination of StockSpaces which sums up to 30, so I can tell the user “you can get 21 units from space ‘6-C’, and 9 units from ‘6-B’. There may be multiple combinations of rows that could sum() >= 30, but I need at least how to find one combination that does! Help!

",4
2163658,01/29/2010 17:13:18,47207,12/17/2008 21:03:31,774,45,If you use SQL Server Authentication (2005) are the login details sent in clear text over the wire?,Title says it all I think!,sql-server,security,,,,,open,0,6,18,If you use SQL Server Authentication (2005) are the login details sent in clear text over the wire? Title says it all I think!,2
8528472,12/16/2011 00:31:56,103203,05/07/2009 22:20:26,909,17,How can I retrieve SQL Stored Procedure Parameter's with SMO more efficently?,"I'm attempting to retrieve the DefaultValue of all the parameters in a StoredProcedure.  My application is build in C# .NET accessing a Microsoft SQL 2008 Database.

I use the SqlCommandBuilder.DeriveParameters to get most of the parameter information rather efficiently however it does not return the ""DefaultValue"" of a parameter so I've resorted to SMO to get that particular property.

Here's my current code :

            Server svr = new Server(new ServerConnection(new SqlConnection(ConfigurationManager.ConnectionStrings[""MyConnectionString""].ConnectionString)));
            StoredProcedure sp = svr.Databases[""MyDatabase""].StoredProcedures[""mySproc"", ""myScheme""];
            svr.SetDefaultInitFields(typeof(StoredProcedureParameter), ""Name"");
            svr.SetDefaultInitFields(typeof(StoredProcedureParameter), ""DefaultValue"");

            Dictionary<string, string> defaultValueLookup = new Dictionary<string, string>();
            foreach (StoredProcedureParameter parameter in sp.Parameters)
            {
                string defaultValue = parameter.DefaultValue;
                string parameterName = parameter.Name;
                defaultValueLookup.Add(parameterName, defaultValue);
            }

However, this is very slow even after I added the svr.SetDefaultInitFields optimization (which did make a significant improvement ~10x improvement).

Anybody got further optimization ideas?",sql-server,performance,smo,,,,open,0,259,12,"How can I retrieve SQL Stored Procedure Parameter's with SMO more efficently? I'm attempting to retrieve the DefaultValue of all the parameters in a StoredProcedure.  My application is build in C# .NET accessing a Microsoft SQL 2008 Database.

I use the SqlCommandBuilder.DeriveParameters to get most of the parameter information rather efficiently however it does not return the ""DefaultValue"" of a parameter so I've resorted to SMO to get that particular property.

Here's my current code :

            Server svr = new Server(new ServerConnection(new SqlConnection(ConfigurationManager.ConnectionStrings[""MyConnectionString""].ConnectionString)));
            StoredProcedure sp = svr.Databases[""MyDatabase""].StoredProcedures[""mySproc"", ""myScheme""];
            svr.SetDefaultInitFields(typeof(StoredProcedureParameter), ""Name"");
            svr.SetDefaultInitFields(typeof(StoredProcedureParameter), ""DefaultValue"");

            Dictionary<string, string> defaultValueLookup = new Dictionary<string, string>();
            foreach (StoredProcedureParameter parameter in sp.Parameters)
            {
                string defaultValue = parameter.DefaultValue;
                string parameterName = parameter.Name;
                defaultValueLookup.Add(parameterName, defaultValue);
            }

However, this is very slow even after I added the svr.SetDefaultInitFields optimization (which did make a significant improvement ~10x improvement).

Anybody got further optimization ideas?",3
5483546,03/30/2011 08:01:18,683426,03/30/2011 06:54:18,1,0,Why do only 2 apps on 1 PC fail to connect to my SQL Server? All else will connect.,"There are numerous relevant details here, so read carefully.

I'm helping a video rental store switch to a new POS (cash register) software. Their previous software came pre-installed on 3 PCs which were purchased from the software publisher. Computer #1 contains SQL Server which serves the POS software on all 3 computers. This was the old set-up. (This may or may not be relevant.)

The new software will be using a remote, offsite SQL Server. I've installed the new POS software on all 3 computers; they will simply point to a different SQL server than the previous software did.

Unfortunately, I cannot get the new software to connect to the new SQL Server from all 3 of the computers. On computer 1, which was previously the server for the old software, the new software fails to find the new server. Instantly, with no lag time whatsoever, the software simply reports that the target server could not be found. However, on that same computer, I have no trouble connecting to the new SQL Server using SQL Server Management Studio. Ping also has no trouble reaching the remote server. It's only the POS software that can't find/connect to the new SQL server.

On computers #2 and #3, the new POS software CAN connect successfully to my new SQL server. This tells me the POS software itself is probably not at fault. There's something else on Computer #1 stopping the connection from succeeding.

I disabled the McAfee firewall on computer #1 with no effect. The POS software still failed to connect. I checked the router settings for possible firewall issues there. Nothing. I disconnected the network cable from Computer #1 and connected it to my laptop where I was able to connect with no problem.

It's just this 1 application on this one computer that can't reach the remote SQL Server. Well actually, there is a companion app which has the same problem, but again, only on Computer #1. Since the companion app has the same problem I can't blame a corrupt installation. The companion app does not share installed components with the main app as it is a small standalone executable.

I've double-triple-quadruple-checked the server address, login, password, etc.

What could the problem possibly be? Besides the McAfee firewall software, is there somewhere else in the system that could be blocking this app from connecting to the remote SQL server? Some policy settings maybe? Since Computer #1 was designated as a server to the old POS system, could the software publishers have configured it with tighter security that is blocking the outbound connection from unknown 3rd party apps, but not from SQL Server Management Studio?

Is there maybe a network utility that can monitor a specific app's network connection attempts and identify where/why the connection is being blocked?

I'm not an expert at this stuff so if you reply, please be specific about where and how to fix the problem. Or at least some tips on how to diagnose it.",sql-server,,,,,11/30/2011 03:34:36,off topic,1,488,19,"Why do only 2 apps on 1 PC fail to connect to my SQL Server? All else will connect. There are numerous relevant details here, so read carefully.

I'm helping a video rental store switch to a new POS (cash register) software. Their previous software came pre-installed on 3 PCs which were purchased from the software publisher. Computer #1 contains SQL Server which serves the POS software on all 3 computers. This was the old set-up. (This may or may not be relevant.)

The new software will be using a remote, offsite SQL Server. I've installed the new POS software on all 3 computers; they will simply point to a different SQL server than the previous software did.

Unfortunately, I cannot get the new software to connect to the new SQL Server from all 3 of the computers. On computer 1, which was previously the server for the old software, the new software fails to find the new server. Instantly, with no lag time whatsoever, the software simply reports that the target server could not be found. However, on that same computer, I have no trouble connecting to the new SQL Server using SQL Server Management Studio. Ping also has no trouble reaching the remote server. It's only the POS software that can't find/connect to the new SQL server.

On computers #2 and #3, the new POS software CAN connect successfully to my new SQL server. This tells me the POS software itself is probably not at fault. There's something else on Computer #1 stopping the connection from succeeding.

I disabled the McAfee firewall on computer #1 with no effect. The POS software still failed to connect. I checked the router settings for possible firewall issues there. Nothing. I disconnected the network cable from Computer #1 and connected it to my laptop where I was able to connect with no problem.

It's just this 1 application on this one computer that can't reach the remote SQL Server. Well actually, there is a companion app which has the same problem, but again, only on Computer #1. Since the companion app has the same problem I can't blame a corrupt installation. The companion app does not share installed components with the main app as it is a small standalone executable.

I've double-triple-quadruple-checked the server address, login, password, etc.

What could the problem possibly be? Besides the McAfee firewall software, is there somewhere else in the system that could be blocking this app from connecting to the remote SQL server? Some policy settings maybe? Since Computer #1 was designated as a server to the old POS system, could the software publishers have configured it with tighter security that is blocking the outbound connection from unknown 3rd party apps, but not from SQL Server Management Studio?

Is there maybe a network utility that can monitor a specific app's network connection attempts and identify where/why the connection is being blocked?

I'm not an expert at this stuff so if you reply, please be specific about where and how to fix the problem. Or at least some tips on how to diagnose it.",1
5007315,02/15/2011 17:44:43,618245,02/15/2011 17:07:57,1,0,Analysis Services database works with ASP.NET Development Server but NOT IIS,"I have an ASP.NET application which needs to connect to Analysis Services database.
All components are on the same machine: 

 - Web application 
 - IIS
 - Visual Studio 2008
 - SQL Server 2008

My domain account (DOMAINNAME\MyWindowsUsername) is an administrator on the SQL Server and also in ""Administrators"" group on the local machine.

Web application uses Windows Authentication and identity impersonate=""true"".

My IIS Windows Authentication settings (I have also tried other combinations but no success...):

 - Extended Protection: Off
 - Enable Kernel-mode authentication: true
 - Enables Providers: NTLM

<br>
<br>

When I use web application on ASP.NET Development Server (deployed from Visual Studio) then everything works ok. My domain account and corresponding database roles are recognized correctly, and security is working as defined in database roles. 

But, when I deploy the same web application (without any changes in code) to IIS I get error (in browser):

**An error was encountered in the transport layer.
The peer prematurely closed the connection.**

<br>
<br>

In SQL Profiler (for IIS case when connection fails) I get only these two events:

**Audit Login**		MyWindowsUsername DOMAINNAME	
		
**Audit Logout**	MyWindowsUsername DOMAINNAME

It seems Analysis Services recognizes the impersonated account, but still the connection breaks.

I have noticed that ASP.NET Development Server runs under DOMAINNAME\MyWindowsUsername while IIS under LocalSystem (the default setting). I tried to play with the accounts, adding various system/network account as Analyis Services administrators (just to understand the logic behind this), but also with no success (always the same error).
",sql-server,iis,olap,analysis-services,asp.net-development-serv,,open,0,230,11,"Analysis Services database works with ASP.NET Development Server but NOT IIS I have an ASP.NET application which needs to connect to Analysis Services database.
All components are on the same machine: 

 - Web application 
 - IIS
 - Visual Studio 2008
 - SQL Server 2008

My domain account (DOMAINNAME\MyWindowsUsername) is an administrator on the SQL Server and also in ""Administrators"" group on the local machine.

Web application uses Windows Authentication and identity impersonate=""true"".

My IIS Windows Authentication settings (I have also tried other combinations but no success...):

 - Extended Protection: Off
 - Enable Kernel-mode authentication: true
 - Enables Providers: NTLM

<br>
<br>

When I use web application on ASP.NET Development Server (deployed from Visual Studio) then everything works ok. My domain account and corresponding database roles are recognized correctly, and security is working as defined in database roles. 

But, when I deploy the same web application (without any changes in code) to IIS I get error (in browser):

**An error was encountered in the transport layer.
The peer prematurely closed the connection.**

<br>
<br>

In SQL Profiler (for IIS case when connection fails) I get only these two events:

**Audit Login**		MyWindowsUsername DOMAINNAME	
		
**Audit Logout**	MyWindowsUsername DOMAINNAME

It seems Analysis Services recognizes the impersonated account, but still the connection breaks.

I have noticed that ASP.NET Development Server runs under DOMAINNAME\MyWindowsUsername while IIS under LocalSystem (the default setting). I tried to play with the accounts, adding various system/network account as Analyis Services administrators (just to understand the logic behind this), but also with no success (always the same error).
",5
6564034,07/03/2011 16:23:25,54009,01/11/2009 23:41:09,1472,19,deleting orphans from a table,"I am trying to clean up a table where there are quite a few orphaned items.

I am approaching this by checking to see if there is a relationship to another table by looking for null values.

    DELETE  FROM        table1 LEFT OUTER JOIN
                         table2 ON table1.ID = table2.ID
    WHERE     (table2.ID IS NULL)

I get an error that the left outer join is not valid.

I am looking for suggestions on other ways that I can delete these orphans from this broken relationship",sql-server,,,,,,open,0,121,5,"deleting orphans from a table I am trying to clean up a table where there are quite a few orphaned items.

I am approaching this by checking to see if there is a relationship to another table by looking for null values.

    DELETE  FROM        table1 LEFT OUTER JOIN
                         table2 ON table1.ID = table2.ID
    WHERE     (table2.ID IS NULL)

I get an error that the left outer join is not valid.

I am looking for suggestions on other ways that I can delete these orphans from this broken relationship",1
10267046,04/22/2012 10:09:02,478593,10/17/2010 15:18:36,1,0,Choosing SQL Server data types for maximum speed,"I'm designing a database that will need to be optimized for maximum speed.

All the database data is generated once from something I call an input database (which holds the data I'm editing, mainly some polylines, markers, etc for google maps).

So the database is not subject to editing, but it needs to hold as many data as it can for quickly displaying results to the user (routes across town, custom polylines, etc).

The question is: choosing smaller data types for example like smallint over int will improve performance or it will affect it? Space is not quite a problem, after some quick calculations, the database will not exceed 200mb, and there will not be tables with more than 100.000 rows (average will be around 5000).

I'm asking this because I read some articles around the internet and some say that smaller data types improve performance others say that it affects it because additional processing must be done. I'm aware that for smaller databases probably results are not noticeable, but I'm interested in every bit because I'm expecting many requests which will trigger a lot more queries.

The hosting environment is gonna be Windows Server 2008 R2 with SQL Server 2008 R2.",sql-server,database-design,types,sql-server-2008-r2,,,open,0,197,8,"Choosing SQL Server data types for maximum speed I'm designing a database that will need to be optimized for maximum speed.

All the database data is generated once from something I call an input database (which holds the data I'm editing, mainly some polylines, markers, etc for google maps).

So the database is not subject to editing, but it needs to hold as many data as it can for quickly displaying results to the user (routes across town, custom polylines, etc).

The question is: choosing smaller data types for example like smallint over int will improve performance or it will affect it? Space is not quite a problem, after some quick calculations, the database will not exceed 200mb, and there will not be tables with more than 100.000 rows (average will be around 5000).

I'm asking this because I read some articles around the internet and some say that smaller data types improve performance others say that it affects it because additional processing must be done. I'm aware that for smaller databases probably results are not noticeable, but I'm interested in every bit because I'm expecting many requests which will trigger a lot more queries.

The hosting environment is gonna be Windows Server 2008 R2 with SQL Server 2008 R2.",4
3269850,07/17/2010 01:35:45,248430,01/11/2010 22:14:18,509,1,SQL Server - what permission need to open for view a table schema in a linked server,"After creating a linked server on SSMS 2008, how should I see linked server table schema? Should I change any permission on remote SQL Server? Also, what commands can check those permissions for all accounts? Thanks.",sql-server,permissions,linked-server,,,,open,0,36,17,"SQL Server - what permission need to open for view a table schema in a linked server After creating a linked server on SSMS 2008, how should I see linked server table schema? Should I change any permission on remote SQL Server? Also, what commands can check those permissions for all accounts? Thanks.",3
7772178,10/14/2011 18:49:35,995985,10/14/2011 18:37:24,1,0,SQL Server extra line in email header,"I am using DatabaseMail to send email from SQL server 2005. I want to include additional info into header of those emails.
Is there a way to reach this?",sql-server,email,header,,,10/19/2011 22:50:33,not a real question,1,28,7,"SQL Server extra line in email header I am using DatabaseMail to send email from SQL server 2005. I want to include additional info into header of those emails.
Is there a way to reach this?",3
7400023,09/13/2011 10:02:23,940231,07/25/2011 07:07:19,7,0,Session state mode set to SQLSERVER serialization,I want to know the default mechanism of serialization while we store session in database.,sql-server,,,,,09/13/2011 10:47:49,not a real question,1,15,7,Session state mode set to SQLSERVER serialization I want to know the default mechanism of serialization while we store session in database.,1
6796134,07/22/2011 21:05:43,858664,07/22/2011 20:56:12,1,0,"sql-server, find sum of a column based on the unique records of another column?","I have 2 columns<br>
<b>
Rooms Hours<br></b>
1.111  3.3<br>
1.123  2.3<br>
1.111  3.3<br>

I want to find the sum of hours based on the Unique Rooms.<br>
Output:<br>
3.3 + 2.3 = 5.6 since 1.111 and 1.123 are Unique.<br>",sql-server,,,,,07/22/2011 21:47:32,not a real question,1,33,14,"sql-server, find sum of a column based on the unique records of another column? I have 2 columns<br>
<b>
Rooms Hours<br></b>
1.111  3.3<br>
1.123  2.3<br>
1.111  3.3<br>

I want to find the sum of hours based on the Unique Rooms.<br>
Output:<br>
3.3 + 2.3 = 5.6 since 1.111 and 1.123 are Unique.<br>",1
11546227,07/18/2012 16:38:26,1391466,05/12/2012 20:03:15,30,0,SQL Server Service seems stuck,"I'm running a stored procedure and it just doesn't finish. Here are a couple of things I have noticed:

* Normally, the procedure takes 20mins but now it's running for over an hour by now.
* Normally, the procedure uses several cores to process but now it's using just one. 
* Normally, the procedure shovels around 10+ MB/s ( sometimes 100+ ) but now it's not shoveling any data.

The stored procedure is suppose add some data to a big table ( that's done ), to calculate some mean values into a small table ( that's done ) and to calculate some standard deviations ( seems to stuck be here ).

What are the things I can do? Or what are the things I can investigate.

I'm the only user on the server ( it's a remote machine ). I'm running from inside the MS Management Studio. The version I'm running is SQL Server 2008 R2.

Thanks in advance,
Christian",sql-server,,,,,07/18/2012 17:54:26,off topic,1,153,5,"SQL Server Service seems stuck I'm running a stored procedure and it just doesn't finish. Here are a couple of things I have noticed:

* Normally, the procedure takes 20mins but now it's running for over an hour by now.
* Normally, the procedure uses several cores to process but now it's using just one. 
* Normally, the procedure shovels around 10+ MB/s ( sometimes 100+ ) but now it's not shoveling any data.

The stored procedure is suppose add some data to a big table ( that's done ), to calculate some mean values into a small table ( that's done ) and to calculate some standard deviations ( seems to stuck be here ).

What are the things I can do? Or what are the things I can investigate.

I'm the only user on the server ( it's a remote machine ). I'm running from inside the MS Management Studio. The version I'm running is SQL Server 2008 R2.

Thanks in advance,
Christian",1
4091715,11/03/2010 21:10:20,116645,06/03/2009 14:46:28,1216,78,"t-sql cursors : does ""fetch first from"" regenerate the contents of the cursor?","I have a block of someone else's code that does essentially this:

    declare X cursor static for select * from stuff
    open cursor X
    fetch next from X
    while @@fetch_status = 0
    begin
      do stuff
      fetch next from X
    end
    
    fetch first from X
    while @@fetch_status = 0
    begin
      do different stuff
      fetch next from X
    end

To get it out of the way, yes, I know cursors are bad / no longer in fashion / etc.  I didn't write it.  I just have to fix it.  Now to the question:

If the data behind the underlying cursor changes between the first loop and the second loop, could the second cursor loop see different data than the first cursor loop?  Or does the static qualifier prevent that?
",sql-server,cursor,,,,,open,0,183,13,"t-sql cursors : does ""fetch first from"" regenerate the contents of the cursor? I have a block of someone else's code that does essentially this:

    declare X cursor static for select * from stuff
    open cursor X
    fetch next from X
    while @@fetch_status = 0
    begin
      do stuff
      fetch next from X
    end
    
    fetch first from X
    while @@fetch_status = 0
    begin
      do different stuff
      fetch next from X
    end

To get it out of the way, yes, I know cursors are bad / no longer in fashion / etc.  I didn't write it.  I just have to fix it.  Now to the question:

If the data behind the underlying cursor changes between the first loop and the second loop, could the second cursor loop see different data than the first cursor loop?  Or does the static qualifier prevent that?
",2
8445040,12/09/2011 11:45:52,20553,09/22/2008 16:10:01,5061,166,How can you find out what has a Service Broker conversation locked?,"I have a service broker queue with one conversation that is not being processed by anything. However it is not returning anything when I run: 

    RECEIVE TOP(1000) * FROM dbo.QueueName

However if I run this:

    SELECT COUNT(*) FROM dbo.QueueName

I am getting a figure in the thousands. The figure is not changing either. I assume that some process has the Conversation Group locked but is not doing anything with it. How can I tell if this is the case and how can I tell which SPID has the lock?",sql-server,sql-server-2008-r2,service-broker,,,,open,0,94,12,"How can you find out what has a Service Broker conversation locked? I have a service broker queue with one conversation that is not being processed by anything. However it is not returning anything when I run: 

    RECEIVE TOP(1000) * FROM dbo.QueueName

However if I run this:

    SELECT COUNT(*) FROM dbo.QueueName

I am getting a figure in the thousands. The figure is not changing either. I assume that some process has the Conversation Group locked but is not doing anything with it. How can I tell if this is the case and how can I tell which SPID has the lock?",3
4445893,12/15/2010 01:17:35,67179,02/17/2009 01:43:10,592,11,Copy entire database contents (schema and data),"I need to copy the contents (tables, views, procs, DATA, etc.) of a SQL Server database and copy it to another SQL Server database.  I need to do this entirely in a script as I am not able to carry over files to the destination web server.  Using Microsoft SQL Server Management Studio, how can I accomplish this?  

*Note:  The database I am copying to will have the same name and be completely empty.*",sql-server,sql-server-2005,sql-server-2008,ssms,,,open,0,78,7,"Copy entire database contents (schema and data) I need to copy the contents (tables, views, procs, DATA, etc.) of a SQL Server database and copy it to another SQL Server database.  I need to do this entirely in a script as I am not able to carry over files to the destination web server.  Using Microsoft SQL Server Management Studio, how can I accomplish this?  

*Note:  The database I am copying to will have the same name and be completely empty.*",4
8087735,11/10/2011 23:14:09,287530,03/06/2010 00:16:07,895,27,MS SQL Server won't create Trigger on table I can query,"The command:

    select * from dbo.hmg_cahplots

returns 9250 rows. However, when I try to create a trigger, it fails with:

> Msg 8197, Level 16, State 6, Procedure LotUpdateTrigger_tdp, Line 1
> The object 'dbo.hmg_cahplots' does not exist or is invalid for this
> operation.

    CREATE TRIGGER dbo.LotUpdateTrigger_tdp ON dbo.hmg_cahplots FOR UPDATE, INSERT 
    AS
    BEGIN
    	update lot
    	set lot.hmg_planmodelname = model.hmg_modelname, lot.hmg_thermslotincentive = model.hmg_thermsincentive,
    		lot.hmg_thermslotincentive_base = model.hmg_thermsincentive_base, lot.hmg_kwlotincentive = model.hmg_kwincentive,
    	from hmg_cahplots as lot inner join i
    			on lot.hmg_cahplotsid = i.hmg_cahplotsid
             inner join hmg_pgecahp as proj 
    			on proj.hmg_pgecahpid = lot.hmg_pgecahplots
    		 left outer join hmg_pgecahpmodels as model 
    			on model.hmg_pgecahpmodelsid = lot.hmg_cahpplanstolotsid
    			and model.hmg_pgecahpplansid = lot.hmg_pgecahplots         
    END

I doubt this is very hard to solve. I assume I need to specify a namespace or something. However, I'm new to MS SQL Server and I don't have any idea how to start on this. Thanks -- Tim
",sql-server,triggers,,,,,open,0,206,11,"MS SQL Server won't create Trigger on table I can query The command:

    select * from dbo.hmg_cahplots

returns 9250 rows. However, when I try to create a trigger, it fails with:

> Msg 8197, Level 16, State 6, Procedure LotUpdateTrigger_tdp, Line 1
> The object 'dbo.hmg_cahplots' does not exist or is invalid for this
> operation.

    CREATE TRIGGER dbo.LotUpdateTrigger_tdp ON dbo.hmg_cahplots FOR UPDATE, INSERT 
    AS
    BEGIN
    	update lot
    	set lot.hmg_planmodelname = model.hmg_modelname, lot.hmg_thermslotincentive = model.hmg_thermsincentive,
    		lot.hmg_thermslotincentive_base = model.hmg_thermsincentive_base, lot.hmg_kwlotincentive = model.hmg_kwincentive,
    	from hmg_cahplots as lot inner join i
    			on lot.hmg_cahplotsid = i.hmg_cahplotsid
             inner join hmg_pgecahp as proj 
    			on proj.hmg_pgecahpid = lot.hmg_pgecahplots
    		 left outer join hmg_pgecahpmodels as model 
    			on model.hmg_pgecahpmodelsid = lot.hmg_cahpplanstolotsid
    			and model.hmg_pgecahpplansid = lot.hmg_pgecahplots         
    END

I doubt this is very hard to solve. I assume I need to specify a namespace or something. However, I'm new to MS SQL Server and I don't have any idea how to start on this. Thanks -- Tim
",2
531453,02/10/2009 08:16:22,32610,10/29/2008 23:00:35,1,0,Sql Server 2008 - Difference between collation types,"I'm installing a new SQL Server 2008 server and are having some problems getting any usable information regarding different collations. I have searched SQL Server BOL and google'ed for an answer but can't seem to be able to find any usable information.

1. What is the difference between the Windows Collation ""Finnish_Swedish_100"" and ""Finnish_Swedish""?

I suppose that the ""_100""-version is a updated collation in SQL Server 2008, but what things have changed from the older version if that is the case?

2. Is it usually a good thing to have Accent-sensitive enabled? I know that it depends on the task and all that, but is there any well-known pros and cons to be considered?

3. The ""Binary"" and ""Binary-code point"" parameters, in which cases should theese be enabled?
",sql-server,2008,collation,,,,open,0,124,8,"Sql Server 2008 - Difference between collation types I'm installing a new SQL Server 2008 server and are having some problems getting any usable information regarding different collations. I have searched SQL Server BOL and google'ed for an answer but can't seem to be able to find any usable information.

1. What is the difference between the Windows Collation ""Finnish_Swedish_100"" and ""Finnish_Swedish""?

I suppose that the ""_100""-version is a updated collation in SQL Server 2008, but what things have changed from the older version if that is the case?

2. Is it usually a good thing to have Accent-sensitive enabled? I know that it depends on the task and all that, but is there any well-known pros and cons to be considered?

3. The ""Binary"" and ""Binary-code point"" parameters, in which cases should theese be enabled?
",3
4569987,12/31/2010 12:03:51,277696,02/20/2010 15:45:16,692,4,Filter first then select page,"How to first filter the result based on params then to apply where-between?
Some thing like

    With Results as
    (
        Select colName,Title, Row_Number(Over...) as row from a table where colName=5
    )
    Select * from Results 
    where 
    row between @first and @last

But it does not works. I need to move my where colName=5 from with clause to outside then I got wrong data as It first get rows between @first n @last then search for colName=5.
Also I want count of Results.

Any idea?",sql-server,,,,,,open,0,107,5,"Filter first then select page How to first filter the result based on params then to apply where-between?
Some thing like

    With Results as
    (
        Select colName,Title, Row_Number(Over...) as row from a table where colName=5
    )
    Select * from Results 
    where 
    row between @first and @last

But it does not works. I need to move my where colName=5 from with clause to outside then I got wrong data as It first get rows between @first n @last then search for colName=5.
Also I want count of Results.

Any idea?",1
10916829,06/06/2012 14:58:30,1267304,03/13/2012 19:14:52,82,2,Nagios check all instances of MSSQL wuth check_mssql_health,How do I make Nagios check all instances of an MSSQL with `check_mssql_health`?,sql-server,nagios,,,,,open,0,13,8,Nagios check all instances of MSSQL wuth check_mssql_health How do I make Nagios check all instances of an MSSQL with `check_mssql_health`?,2
9102542,02/01/2012 20:09:45,877585,08/03/2011 22:59:15,10,2,give other sql administrors same access as sa,"How can I give all access rights to another user the same rights that sa user has in ms sql 2008.

There are scripts for some applications that seem to error with permission denied when a script is run against sql DB. thanks! ",sql-server,sql-server-2008,tsql,,,02/02/2012 14:49:15,off topic,1,43,8,"give other sql administrors same access as sa How can I give all access rights to another user the same rights that sa user has in ms sql 2008.

There are scripts for some applications that seem to error with permission denied when a script is run against sql DB. thanks! ",3
2363286,03/02/2010 13:14:57,191997,10/18/2009 12:36:17,1189,84,Is it possible that we pass a query to PIVOT as column list in SQL Server?,"As you know the `PIVOT` syntax is like below :

    FROM table_source
    PIVOT ( 
     aggregate_function ( value_column )
     FOR pivot_column
     IN ( <column_list>)
    ) table_alias

I want to know is it possible that we pass a query as `<column_list>` to `PIVOT`?",sql-server,pivot,,,,,open,0,62,16,"Is it possible that we pass a query to PIVOT as column list in SQL Server? As you know the `PIVOT` syntax is like below :

    FROM table_source
    PIVOT ( 
     aggregate_function ( value_column )
     FOR pivot_column
     IN ( <column_list>)
    ) table_alias

I want to know is it possible that we pass a query as `<column_list>` to `PIVOT`?",2
7412093,09/14/2011 06:25:18,559026,12/31/2010 06:04:07,603,52,MIgrate From MS SQL To Postgres With Hibernate,"We are having MS SQL 2008 as database with Hibernate.

Now we are planning to move on to Postgres.

I know that Postgres does not have auto increment feature for primary key column.

I heard about SERIAL data type or Sequences for each table and then using `nextval` with primary key.

MS SQL Database is large enough containing around 150 tables.

So, I want opinions and want to know that Should We go by create sequences or SERIAL will work.


Which one could be better option ? 
",sql-server,hibernate,postgresql,,,,open,0,82,8,"MIgrate From MS SQL To Postgres With Hibernate We are having MS SQL 2008 as database with Hibernate.

Now we are planning to move on to Postgres.

I know that Postgres does not have auto increment feature for primary key column.

I heard about SERIAL data type or Sequences for each table and then using `nextval` with primary key.

MS SQL Database is large enough containing around 150 tables.

So, I want opinions and want to know that Should We go by create sequences or SERIAL will work.


Which one could be better option ? 
",3
2906380,05/25/2010 16:09:45,109676,04/27/2009 18:56:57,982,47,Search Db Code Add-in for Visual Studio,"After 5 versions of Visual Studio I think I should be able to right mouse click on a Stored Procedure node of a database connection in the Server Explorer window and be able to search (at least) SQL Server code for the occurrence of a string.

I don't want to have to rely on running an Stored Procedure to search SYSCOMMENTS. I want a real a GUI tool that is integrated with Visual Studio.

Does anyone know of one, preferably free?",sql-server,visual-studio,,,,,open,0,79,7,"Search Db Code Add-in for Visual Studio After 5 versions of Visual Studio I think I should be able to right mouse click on a Stored Procedure node of a database connection in the Server Explorer window and be able to search (at least) SQL Server code for the occurrence of a string.

I don't want to have to rely on running an Stored Procedure to search SYSCOMMENTS. I want a real a GUI tool that is integrated with Visual Studio.

Does anyone know of one, preferably free?",2
9937986,03/30/2012 06:26:04,330475,05/01/2010 17:16:53,125,4,Database Design Concern,"We are in the process of designing Consumer Oriented Application. <br/>
We will be using Microsoft Sql Server 2008R2.<br/><br/>

Here are some of the constraints we've been given:<br/>
1. Single instance Multiple Tenant <br/>
2. The application would have around 10 modules (say finance, HR etc ) for first version but the new modules will keep on adding with every release, along with the some patches or bug fixes of the previous released modules.<br/>
3. Maintenance of multiple assets -  backups, version control and like<br/>
4. Promoting re-use as much as possible.<br/>
5. Advertising Module: This module will be common to all the tenants and will be controlled by our organization.<br/>
6. Social networking application common to all the tenants and will be controlled by our organization. The social networking application will also have many modules.How to plugin the social networking application to the Tenants once it will released (down the line in the future). <br/><br/>

All Suggestions, Comments are welcomed !!! <br/>

NB. I thought of suggesting the team going  with Single database with multiple Schema based on tenant. But i am not sure how the backup and restoring of tenant data can be achieved. <br/>Moreover how the tables of newly build Modules will be introduced on Production without effecting the tenant or shutting down the system for updates.<br/>
Regarding Advertising and Social Networking i am clue less.<br/>",sql-server,database-design,sql-server-2008-r2,database-schema,,03/30/2012 09:02:16,not a real question,1,220,3,"Database Design Concern We are in the process of designing Consumer Oriented Application. <br/>
We will be using Microsoft Sql Server 2008R2.<br/><br/>

Here are some of the constraints we've been given:<br/>
1. Single instance Multiple Tenant <br/>
2. The application would have around 10 modules (say finance, HR etc ) for first version but the new modules will keep on adding with every release, along with the some patches or bug fixes of the previous released modules.<br/>
3. Maintenance of multiple assets -  backups, version control and like<br/>
4. Promoting re-use as much as possible.<br/>
5. Advertising Module: This module will be common to all the tenants and will be controlled by our organization.<br/>
6. Social networking application common to all the tenants and will be controlled by our organization. The social networking application will also have many modules.How to plugin the social networking application to the Tenants once it will released (down the line in the future). <br/><br/>

All Suggestions, Comments are welcomed !!! <br/>

NB. I thought of suggesting the team going  with Single database with multiple Schema based on tenant. But i am not sure how the backup and restoring of tenant data can be achieved. <br/>Moreover how the tables of newly build Modules will be introduced on Production without effecting the tenant or shutting down the system for updates.<br/>
Regarding Advertising and Social Networking i am clue less.<br/>",4
6742405,07/19/2011 04:48:06,851254,07/19/2011 04:48:06,1,0,MS SQL server developer edition in production,What is the restriction for running developer version in lets say production environment? Since developer version of MSSQL 08 is enterprise. I wanna know what  happens if i wanna test the developer edition for production use for a week? can anyone shed some light? how can M$ tell a developer edition is being used in production? because I call my machine development or production or whatever I want. May be there is a limitation that i don't know. Shed some light?,sql-server,database,licensing,development-environment,production,07/20/2011 03:07:16,off topic,1,82,7,MS SQL server developer edition in production What is the restriction for running developer version in lets say production environment? Since developer version of MSSQL 08 is enterprise. I wanna know what  happens if i wanna test the developer edition for production use for a week? can anyone shed some light? how can M$ tell a developer edition is being used in production? because I call my machine development or production or whatever I want. May be there is a limitation that i don't know. Shed some light?,5
2026134,01/08/2010 07:39:49,201387,11/03/2009 03:56:34,130,9,please tell me how to create update query for such a problem,"i have two tables:
 
    1.
    CREATE TABLE [dbo].[HotelSourceMap](
	[hotelsourcemapid] [bigint] IDENTITY(1,1) NOT NULL,
	[dspartnerid] [bigint] NOT NULL,
	[dshotelid] [bigint] NOT NULL,	
	[countrycode] [varchar](5) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[countryid] [bigint] NULL)

    2.
    CREATE TABLE [dbo].[country](
	[countryId] [smallint] IDENTITY(1,1) NOT NULL,
	[countryName] [varchar](50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[countryCode] [varchar](2) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL)

situation is like this:
i want to update countryid in HotelSourceMap table from country.countryid .
where hotelsourcemap.countrycode = country.countrycode


some thing like this:

    UPDATE HotelSourceMap
    SET
	HotelSourceMap.countryid =country.countryId  
    WHERE
    HotelSourceMap.countrycode = country.countryCode

",sql-server,update,,,,,open,0,96,12,"please tell me how to create update query for such a problem i have two tables:
 
    1.
    CREATE TABLE [dbo].[HotelSourceMap](
	[hotelsourcemapid] [bigint] IDENTITY(1,1) NOT NULL,
	[dspartnerid] [bigint] NOT NULL,
	[dshotelid] [bigint] NOT NULL,	
	[countrycode] [varchar](5) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[countryid] [bigint] NULL)

    2.
    CREATE TABLE [dbo].[country](
	[countryId] [smallint] IDENTITY(1,1) NOT NULL,
	[countryName] [varchar](50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[countryCode] [varchar](2) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL)

situation is like this:
i want to update countryid in HotelSourceMap table from country.countryid .
where hotelsourcemap.countrycode = country.countrycode


some thing like this:

    UPDATE HotelSourceMap
    SET
	HotelSourceMap.countryid =country.countryId  
    WHERE
    HotelSourceMap.countrycode = country.countryCode

",2
9846148,03/23/2012 20:32:26,1080891,12/05/2011 04:19:46,40,1,Pivot Multiple Rows,"I have a table similar to the following:

    id    key    str_val    date_val      num_val
    1     A      a
    1     B      b
    1     C                 2012-01-01
    1     D                               1
    2     A      c
    2     E      d
    2     C                 2012-01-02
    2     D                                2

I need it to look like:

    id    A      B      C             D       E
    1     a      b      2012-01-01    1
    2     c             2012-01-02    2       d

Basically, each key needs to become it's own column

I tried and failed to use the PIVOT command usefully, and I'm currently trying to accomplish this with a case statement. i.e.

    select
        id,
        case key
            when 'A'
            then str_val
        end as A,
        case key
            when 'C'
            then date_val
        end as C
        --etc.
    from test_table
However I can't figure out how to combine the table rows after this runs. I'm suck with:

    id    A      B      C             D       E
    1     a
    1            b
    1                   2012-01-01
    1                                 1
Any thoughts or input that could help me out? Thanks in advance.",sql-server,sql-server-2005,,,,,open,0,622,3,"Pivot Multiple Rows I have a table similar to the following:

    id    key    str_val    date_val      num_val
    1     A      a
    1     B      b
    1     C                 2012-01-01
    1     D                               1
    2     A      c
    2     E      d
    2     C                 2012-01-02
    2     D                                2

I need it to look like:

    id    A      B      C             D       E
    1     a      b      2012-01-01    1
    2     c             2012-01-02    2       d

Basically, each key needs to become it's own column

I tried and failed to use the PIVOT command usefully, and I'm currently trying to accomplish this with a case statement. i.e.

    select
        id,
        case key
            when 'A'
            then str_val
        end as A,
        case key
            when 'C'
            then date_val
        end as C
        --etc.
    from test_table
However I can't figure out how to combine the table rows after this runs. I'm suck with:

    id    A      B      C             D       E
    1     a
    1            b
    1                   2012-01-01
    1                                 1
Any thoughts or input that could help me out? Thanks in advance.",2
1588042,10/19/2009 10:55:41,192370,10/19/2009 10:55:41,1,0,How to set default null value in to a date field in sql server 2000?,"How to set deafult null value in to a date field in the table,if the parameter containing the date value is null?",sql-server,2000,,,,,open,0,22,15,"How to set default null value in to a date field in sql server 2000? How to set deafult null value in to a date field in the table,if the parameter containing the date value is null?",2
11436991,07/11/2012 16:18:07,14395,09/16/2008 23:42:17,2141,71,"I run sp_who on the database, and there is a ""TASK MANAGER"" process. What is it?","I have a sporadic problem, when upgrading SQL Server in a single-user mode, some other application somehow logs into the database and kicks my process out.

Last time when that happened, I ran sp_who, and I could see that a process that took control of the database is ""TASK MANAGER"".

Anyone could tell me what is this process, what is it's purpose, and how in the world it could get into a database, which is in single-user mode, and there is an active connection?",sql-server,sql-server-2008,,,,07/11/2012 21:54:38,off topic,1,82,16,"I run sp_who on the database, and there is a ""TASK MANAGER"" process. What is it? I have a sporadic problem, when upgrading SQL Server in a single-user mode, some other application somehow logs into the database and kicks my process out.

Last time when that happened, I ran sp_who, and I could see that a process that took control of the database is ""TASK MANAGER"".

Anyone could tell me what is this process, what is it's purpose, and how in the world it could get into a database, which is in single-user mode, and there is an active connection?",2
11447350,07/12/2012 07:54:12,1494292,07/01/2012 13:22:12,8,0,avoid generating duplicating random number from the Sql,"as per the module requirement file name length to be as 8 chars, for that to implement first 4 char DDMM and remaining 4 char trying to fetch the random numbers from the database by using function and view, the same what i am using in database i have pasted below:

FUNCTION:

    CREATE FUNCTION [dbo].[GenerateRandomNumbersLetters]
    (
        @NumberOfCharacters TINYINT
    )
    RETURNS VARCHAR(32)
    AS
    BEGIN
        RETURN 
        (
            SELECT LEFT(REPLACE([NewID], '-', ''), @NumberOfCharacters)
            FROM dbo.RetrieveNewID
        );
    END

VIEW:



    CREATE VIEW [dbo].[RetrieveNewID]
    AS
        SELECT [NewID] = NEWID();

MY query:

    select  SUBSTRING( replace(convert (varchar(10),getdate(),3),'/',''),1,4)+ dbo.GenerateRandomNumbersLetters(4) as FileNamerandomNUM


EX: 0907CCE7

For every record it will provide random number, but in one scenario recently the random generate duplicates,how can i avoid such scenarios also,kindly advice ",sql-server,sql-server-2008,,,,,open,0,203,8,"avoid generating duplicating random number from the Sql as per the module requirement file name length to be as 8 chars, for that to implement first 4 char DDMM and remaining 4 char trying to fetch the random numbers from the database by using function and view, the same what i am using in database i have pasted below:

FUNCTION:

    CREATE FUNCTION [dbo].[GenerateRandomNumbersLetters]
    (
        @NumberOfCharacters TINYINT
    )
    RETURNS VARCHAR(32)
    AS
    BEGIN
        RETURN 
        (
            SELECT LEFT(REPLACE([NewID], '-', ''), @NumberOfCharacters)
            FROM dbo.RetrieveNewID
        );
    END

VIEW:



    CREATE VIEW [dbo].[RetrieveNewID]
    AS
        SELECT [NewID] = NEWID();

MY query:

    select  SUBSTRING( replace(convert (varchar(10),getdate(),3),'/',''),1,4)+ dbo.GenerateRandomNumbersLetters(4) as FileNamerandomNUM


EX: 0907CCE7

For every record it will provide random number, but in one scenario recently the random generate duplicates,how can i avoid such scenarios also,kindly advice ",2
11254298,06/28/2012 23:30:48,1450981,06/12/2012 10:37:27,1,0,SQL Server Setup failure,"i uninstall sql server 2008 r2 and then install it but now when install it i receive a error:


TITLE: SQL Server Setup failure.
------------------------------

SQL Server Setup has encountered the following error:

MsiGetProductInfo failed to retrieve ProductVersion for package with Product Code = '{A2122A9C-A699-4365-ADF8-68FEAC125D61}'. Error code: 1605..

------------------------------
BUTTONS:

OK
------------------------------
",sql-server,sql-server-2008,,,,06/29/2012 18:05:34,off topic,1,44,4,"SQL Server Setup failure i uninstall sql server 2008 r2 and then install it but now when install it i receive a error:


TITLE: SQL Server Setup failure.
------------------------------

SQL Server Setup has encountered the following error:

MsiGetProductInfo failed to retrieve ProductVersion for package with Product Code = '{A2122A9C-A699-4365-ADF8-68FEAC125D61}'. Error code: 1605..

------------------------------
BUTTONS:

OK
------------------------------
",2
2304955,02/21/2010 05:45:07,246211,01/08/2010 07:37:01,99,1,SQL Server: Top 10 salespeople per week - and previous rankings,"    select * 
    from 
    ( 
         select year, 
                week,  
                salesperson,
                count(*) as transactions,  
                rank() over(partition by week order by count(*) desc) as ranking 
         from sales
         where year = '2010',               
         group by year,  
                  week, 
                  salesperson  
     
    ) temp 
    where ranking <= 10

The query returns a list of the top 10 salespeople (in terms of # of transactions) for each week of the year. 

How can I go about adding columns to my results for:

 1. Previous week's ranking for that
    salesperson 
 2. Total weeks in the Top 10 this year
 3. Consecutive weeks in the Top 10 (starting at week 1)
 4. Consecutive weeks in the Top 10 (starting in previous year, if possible)

Can you give any general advice on how to go about these sorts of problems?

PS: Using SQL server 2008

",sql-server,sql-server-2008,ranking,,,,open,0,309,11,"SQL Server: Top 10 salespeople per week - and previous rankings     select * 
    from 
    ( 
         select year, 
                week,  
                salesperson,
                count(*) as transactions,  
                rank() over(partition by week order by count(*) desc) as ranking 
         from sales
         where year = '2010',               
         group by year,  
                  week, 
                  salesperson  
     
    ) temp 
    where ranking <= 10

The query returns a list of the top 10 salespeople (in terms of # of transactions) for each week of the year. 

How can I go about adding columns to my results for:

 1. Previous week's ranking for that
    salesperson 
 2. Total weeks in the Top 10 this year
 3. Consecutive weeks in the Top 10 (starting at week 1)
 4. Consecutive weeks in the Top 10 (starting in previous year, if possible)

Can you give any general advice on how to go about these sorts of problems?

PS: Using SQL server 2008

",3
10940444,06/07/2012 21:56:30,159145,08/19/2009 10:32:19,855,37,SQL Server - Nested query takes 40 minutes to run,"I have a very large web forum application (about 20 million posts since 2001) running from a SQL Server 2012 database. The data files are about 40GB in size.

I added indexes to the tables for appropriate fields, however this query (which reveals the date range of posts in each forum) takes about 40 minutes to run:

    SELECT
	T2.ForumId,
	Forums.Title,
	T2.ForumThreads,
	T2.ForumPosts,
	T2.ForumStart,
	T2.ForumStop

    FROM
	Forums
	INNER JOIN (

	SELECT
		Min(ThreadStart) As ForumStart,
		Max(ThreadStop) As ForumStop,
		Count(*) As ForumThreads,
		Sum(ThreadPosts) As ForumPosts,
		Threads.ForumId
	FROM
		Threads
		INNER JOIN (

			SELECT
				Min(Posts.DateTime) As ThreadStart,
				Max(Posts.DateTime) As ThreadStop,
				Count(*) As ThreadPosts,
				Posts.ThreadId
			FROM
				Posts
			GROUP BY
				Posts.ThreadId

		) As P2 ON Threads.ThreadId = P2.ThreadId

	GROUP BY
		Threads.ForumId

) AS T2 ON T2.ForumId = Forums.ForumId

How could I speed it up?",sql-server,tsql,select,,,,open,0,101,10,"SQL Server - Nested query takes 40 minutes to run I have a very large web forum application (about 20 million posts since 2001) running from a SQL Server 2012 database. The data files are about 40GB in size.

I added indexes to the tables for appropriate fields, however this query (which reveals the date range of posts in each forum) takes about 40 minutes to run:

    SELECT
	T2.ForumId,
	Forums.Title,
	T2.ForumThreads,
	T2.ForumPosts,
	T2.ForumStart,
	T2.ForumStop

    FROM
	Forums
	INNER JOIN (

	SELECT
		Min(ThreadStart) As ForumStart,
		Max(ThreadStop) As ForumStop,
		Count(*) As ForumThreads,
		Sum(ThreadPosts) As ForumPosts,
		Threads.ForumId
	FROM
		Threads
		INNER JOIN (

			SELECT
				Min(Posts.DateTime) As ThreadStart,
				Max(Posts.DateTime) As ThreadStop,
				Count(*) As ThreadPosts,
				Posts.ThreadId
			FROM
				Posts
			GROUP BY
				Posts.ThreadId

		) As P2 ON Threads.ThreadId = P2.ThreadId

	GROUP BY
		Threads.ForumId

) AS T2 ON T2.ForumId = Forums.ForumId

How could I speed it up?",3
4453157,12/15/2010 17:48:35,321744,04/20/2010 21:47:36,21,1,Excel Front end to Sql Server,"Im working on a Line of Business web application that has a bunch of Excel lovers as its user base. It got me thinking that maybe it would be better to just allow the users to use the tool that they love rather than re-building the current web app that they dont love.
My question is, what would be the ""best"" way to go about putting an excel front end on a Sql Server db? 

any thoughts/opinions are appreciated.
Thanks
Alex
",sql-server,excel,,,,,open,0,78,6,"Excel Front end to Sql Server Im working on a Line of Business web application that has a bunch of Excel lovers as its user base. It got me thinking that maybe it would be better to just allow the users to use the tool that they love rather than re-building the current web app that they dont love.
My question is, what would be the ""best"" way to go about putting an excel front end on a Sql Server db? 

any thoughts/opinions are appreciated.
Thanks
Alex
",2
4358720,12/05/2010 12:17:19,418198,08/12/2010 09:06:38,197,12,ms-sql regular expressions kleene star,"is there a regular expression operator that can do what clean star did?

http://en.wikipedia.org/wiki/Kleene_star

i know i could write 'jdslf[a-f]%' however i wish for an expretion such as 
'jdslf[[a-f]*]'",sql-server,regex,,,,,open,0,27,5,"ms-sql regular expressions kleene star is there a regular expression operator that can do what clean star did?

http://en.wikipedia.org/wiki/Kleene_star

i know i could write 'jdslf[a-f]%' however i wish for an expretion such as 
'jdslf[[a-f]*]'",2
1618154,10/24/2009 14:31:56,115783,06/02/2009 05:32:47,16,0,data storage limitation issue,"I face one problem, one column is i have taken as numeric(38,0)

Data stored in this column is going out of range, means it is reach it's storage limitation. i have tried with also bigint , but facing same problem.i can not take it as varchar because i have to use in another calculation so at that time i must need to convert it from varchar to bigint ot numeric(38,0).

So, is there any solution to store high range value.",sql-server,sql,sql-server-2005,tsql,database,,open,0,78,4,"data storage limitation issue I face one problem, one column is i have taken as numeric(38,0)

Data stored in this column is going out of range, means it is reach it's storage limitation. i have tried with also bigint , but facing same problem.i can not take it as varchar because i have to use in another calculation so at that time i must need to convert it from varchar to bigint ot numeric(38,0).

So, is there any solution to store high range value.",5
5100054,02/24/2011 03:28:13,407688,07/31/2010 22:13:25,56,1,Retrieving data from MS SQL,What is the best way to retrieve last chunk of data from MS SQL ? Is it good to cache data ?,sql-server,database,,,,02/24/2011 19:56:28,not a real question,1,22,5,Retrieving data from MS SQL What is the best way to retrieve last chunk of data from MS SQL ? Is it good to cache data ?,2
6561516,07/03/2011 06:43:34,403395,07/27/2010 12:48:41,1,0,"Is there some documents for mdf, ndfn ldf file format?","Is there some documents for mdf, ndfn ldf file format?
Here the three different file types are belonged to SQL server.
I search the document on internet for a long time, but the result is disappointed. Hope someone can help me!",sql-server,file-format,.mdf,ldf,,07/04/2011 14:03:36,not a real question,1,39,10,"Is there some documents for mdf, ndfn ldf file format? Is there some documents for mdf, ndfn ldf file format?
Here the three different file types are belonged to SQL server.
I search the document on internet for a long time, but the result is disappointed. Hope someone can help me!",4
5376063,03/21/2011 09:59:15,267174,02/05/2010 15:13:19,1503,67,SQL Server Performance with a large table,"I'm looking for some advice for a table structure in sql.

Basically I will have a table with about 30 columns of strings, ints and decimals. A service will be writing to this table about 500 times a day. Each record in the table can either be 'inactive' or 'active'. This table will constantly grow and at any one time there will be about 100 'active' records that need to be returned. 

While the table is small the performance to return the 'active' records is responsive. My concern comes 12-18 months down the line when the table is much larger or even later when there will be millions of records in the table. 

Is it better to maintain two tables one for 'active' records and one for 'inactive' records from a performance view or will creating a index on the active column solve any potential performance issues?",sql-server,database,sql-server-2005,database-design,table-design,,open,0,146,7,"SQL Server Performance with a large table I'm looking for some advice for a table structure in sql.

Basically I will have a table with about 30 columns of strings, ints and decimals. A service will be writing to this table about 500 times a day. Each record in the table can either be 'inactive' or 'active'. This table will constantly grow and at any one time there will be about 100 'active' records that need to be returned. 

While the table is small the performance to return the 'active' records is responsive. My concern comes 12-18 months down the line when the table is much larger or even later when there will be millions of records in the table. 

Is it better to maintain two tables one for 'active' records and one for 'inactive' records from a performance view or will creating a index on the active column solve any potential performance issues?",5
6282501,06/08/2011 17:04:36,374198,06/23/2010 12:04:53,4353,251,SQL 2008 R2: Trigger causing a deadlock?,"I'm running into a deadlock after I added a trigger. There is a `UserBalanceHistory` table which has one row for each transaction and an `Amount` column. A trigger was added to sum the `Amount` column and place the result in the related `User` table, `Balance` column.

    CREATE TABLE [User]
    (
    	ID INT IDENTITY,
    	Balance MONEY,
    	CONSTRAINT PK_User PRIMARY KEY (ID)
    );
    
    CREATE TABLE UserBalanceHistory
    (
    	ID INT IDENTITY,
    	UserID INT NOT NULL,
    	Amount MONEY NOT NULL,
    	CONSTRAINT PK_UserBalanceHistory PRIMARY KEY (ID),
    	CONSTRAINT FK_UserBalanceHistory_User FOREIGN KEY (UserID) REFERENCES [User] (ID)
    );
    
    CREATE TRIGGER TR_UserBalanceHistory_1 ON UserBalanceHistory AFTER INSERT, UPDATE, DELETE AS
    BEGIN
    	DECLARE @UserID INT;
    
    	SELECT TOP 1 @UserID = u.UserID
    	FROM
    	(
    			SELECT UserID FROM inserted
    		UNION
    			SELECT UserID FROM deleted
    	) u;
    
    	EXEC dbo.UpdateUserBalance @UserID;
    END;
    
    CREATE PROCEDURE UpdateUserBalance
    	@UserID INT
    AS
    BEGIN
    	DECLARE @Balance MONEY;
    	
    	SET @Balance = (SELECT SUM(Amount) FROM UserBalanceHistory WHERE UserID = @UserID);
    
    	UPDATE [User]
    	SET Balance = ISNULL(@Balance, 0)
    	WHERE ID = @UserID;
    END;

I've also turned on `READ_COMMITTED_SNAPSHOT`:

    ALTER DATABASE MyDatabase SET READ_COMMITTED_SNAPSHOT ON;

I have a parallel process running which is creating `UserBalanceHistory` entries, apparently if it is working on the same `User` at the same time, the deadlock occurs. Suggestions?",sql-server,sql-server-2008,triggers,deadlock,database-deadlocks,,open,0,336,7,"SQL 2008 R2: Trigger causing a deadlock? I'm running into a deadlock after I added a trigger. There is a `UserBalanceHistory` table which has one row for each transaction and an `Amount` column. A trigger was added to sum the `Amount` column and place the result in the related `User` table, `Balance` column.

    CREATE TABLE [User]
    (
    	ID INT IDENTITY,
    	Balance MONEY,
    	CONSTRAINT PK_User PRIMARY KEY (ID)
    );
    
    CREATE TABLE UserBalanceHistory
    (
    	ID INT IDENTITY,
    	UserID INT NOT NULL,
    	Amount MONEY NOT NULL,
    	CONSTRAINT PK_UserBalanceHistory PRIMARY KEY (ID),
    	CONSTRAINT FK_UserBalanceHistory_User FOREIGN KEY (UserID) REFERENCES [User] (ID)
    );
    
    CREATE TRIGGER TR_UserBalanceHistory_1 ON UserBalanceHistory AFTER INSERT, UPDATE, DELETE AS
    BEGIN
    	DECLARE @UserID INT;
    
    	SELECT TOP 1 @UserID = u.UserID
    	FROM
    	(
    			SELECT UserID FROM inserted
    		UNION
    			SELECT UserID FROM deleted
    	) u;
    
    	EXEC dbo.UpdateUserBalance @UserID;
    END;
    
    CREATE PROCEDURE UpdateUserBalance
    	@UserID INT
    AS
    BEGIN
    	DECLARE @Balance MONEY;
    	
    	SET @Balance = (SELECT SUM(Amount) FROM UserBalanceHistory WHERE UserID = @UserID);
    
    	UPDATE [User]
    	SET Balance = ISNULL(@Balance, 0)
    	WHERE ID = @UserID;
    END;

I've also turned on `READ_COMMITTED_SNAPSHOT`:

    ALTER DATABASE MyDatabase SET READ_COMMITTED_SNAPSHOT ON;

I have a parallel process running which is creating `UserBalanceHistory` entries, apparently if it is working on the same `User` at the same time, the deadlock occurs. Suggestions?",5
11326801,07/04/2012 10:02:17,1239827,02/29/2012 09:18:01,13,0,How we can get two rows before and  after for a given id in a table?,"I have a table with 10 rows 

    id  values
     1    a
     2    b
     3    c
     4    d
     5    e
     6    f
     7    g
     8    h
     9    i
     10   j

I want to get two rows before and two rows after for @id = 5.

How can get?  

",sql-server,,,,,,open,0,121,17,"How we can get two rows before and  after for a given id in a table? I have a table with 10 rows 

    id  values
     1    a
     2    b
     3    c
     4    d
     5    e
     6    f
     7    g
     8    h
     9    i
     10   j

I want to get two rows before and two rows after for @id = 5.

How can get?  

",1
8824688,01/11/2012 18:33:46,482591,10/21/2010 05:48:52,899,25,SQL Bulk Copy with Excel to SQL Server but with data modifications,"I am reading up on `SQLBulkCopy` and would like to use it to import thousands of rows from an Excel document to SQL Server.  I keep reading articles that do it directly without modifying the data. I need to do some modifications and validations on the data in the Excel document before doing the `SQLBulkCopy`.  Is it possible to do this?  I would assume from the overloads I can modify the data and create a large `DataTable`, and import that `DataTable` with `WriteToServer`.",sql-server,excel,sqlbulkcopy,,,,open,0,86,12,"SQL Bulk Copy with Excel to SQL Server but with data modifications I am reading up on `SQLBulkCopy` and would like to use it to import thousands of rows from an Excel document to SQL Server.  I keep reading articles that do it directly without modifying the data. I need to do some modifications and validations on the data in the Excel document before doing the `SQLBulkCopy`.  Is it possible to do this?  I would assume from the overloads I can modify the data and create a large `DataTable`, and import that `DataTable` with `WriteToServer`.",3
6470386,06/24/2011 15:51:18,620720,02/17/2011 03:46:13,115,0,Installing SQL 2008,"![enter image description here][1]SQL 2008 : en_sql_server_2008_developer_x86_x64_ia64_dvd_x14-88839

I am installing SQL 2008 on my Computer which has Windows XP Professional Edition.

I am following this website for installing ..

http://blog.sqlauthority.com/2008/06/12/sql-server-2008-step-by-step-installation-guide-with-images/

But i am facing an error on Report Service which blocks my installation process ? How should i fix that issue !! 


  [1]: http://i.stack.imgur.com/QrHBF.jpg",sql-server,sql-server-2008,,,,06/24/2011 20:19:48,off topic,1,52,3,"Installing SQL 2008 ![enter image description here][1]SQL 2008 : en_sql_server_2008_developer_x86_x64_ia64_dvd_x14-88839

I am installing SQL 2008 on my Computer which has Windows XP Professional Edition.

I am following this website for installing ..

http://blog.sqlauthority.com/2008/06/12/sql-server-2008-step-by-step-installation-guide-with-images/

But i am facing an error on Report Service which blocks my installation process ? How should i fix that issue !! 


  [1]: http://i.stack.imgur.com/QrHBF.jpg",2
8168674,11/17/2011 14:23:34,1051965,11/17/2011 14:13:10,1,0,SSRS - Mutiple Columns with Row Group in Reports,"Example:<br/>
SubTitle1 : SubTitle2<br/>
Question1 : Question1 <br/>
Question2 : Question2 <br/>
<br/>
Is it possible in SSRS. Please help this.",sql-server,,,,,01/21/2012 03:46:35,not a real question,1,16,9,"SSRS - Mutiple Columns with Row Group in Reports Example:<br/>
SubTitle1 : SubTitle2<br/>
Question1 : Question1 <br/>
Question2 : Question2 <br/>
<br/>
Is it possible in SSRS. Please help this.",1
3558500,08/24/2010 16:07:20,357849,06/03/2010 19:29:39,152,3,MS SQL Server 2005: What Happens If LDF-file are lost ?,"If I put my MS SQL Log file on another drive and the drive crashes.

What happens to my MS SQL Database, will it create a new log file or how do I correct it?",sql-server,sql-server-2005,,,,,open,0,34,11,"MS SQL Server 2005: What Happens If LDF-file are lost ? If I put my MS SQL Log file on another drive and the drive crashes.

What happens to my MS SQL Database, will it create a new log file or how do I correct it?",2
9288712,02/15/2012 06:13:16,1203490,02/11/2012 07:41:05,4,2,Display integer value in minimum 2 digit before decimal in sql server,"I need to display int value in minimum 2 digit before decimal in sql server.
Is it possible than how pls rply?",sql-server,,,,,,open,0,21,12,"Display integer value in minimum 2 digit before decimal in sql server I need to display int value in minimum 2 digit before decimal in sql server.
Is it possible than how pls rply?",1
1344212,08/27/2009 23:04:17,140735,07/18/2009 18:13:59,3,0,Database Desing and Normalization issue,"I have a huge access mdb file which contains a single table with 20-30 columns and over 50000 rows and 
i have some thing like this

columns:

id desc name phone email fax ab bc zxy sd country state zip .....
1  a     ab  12     fff   12  w 2  3   2    d     sd     233
2   d    ab  12     fff   12  s 2  3  1     d     sd       233

here i have some column values related to adresses repeating is there a way to normalize the above table so that we can remove duplicates or repeating data.

Thanks in advance.
",sql-server,database-design,,,,,open,0,148,5,"Database Desing and Normalization issue I have a huge access mdb file which contains a single table with 20-30 columns and over 50000 rows and 
i have some thing like this

columns:

id desc name phone email fax ab bc zxy sd country state zip .....
1  a     ab  12     fff   12  w 2  3   2    d     sd     233
2   d    ab  12     fff   12  s 2  3  1     d     sd       233

here i have some column values related to adresses repeating is there a way to normalize the above table so that we can remove duplicates or repeating data.

Thanks in advance.
",2
2068945,01/15/2010 01:53:09,77546,03/13/2009 04:31:07,2205,88,Is this an effective and efficient SQL Query or is there a better way?,"We have a passwords table which references a user table.  Records never get deleted from the password table so if a user changes their password, a new entry with a more recent `Created` date gets inserted.

The hash of the password is salted with various things, most importantly the created date of the actual record.

In a stored procedure, I'm retrieving variables so I can do a hash for comparison.  I really just want to store the most recent password hash for a user along with the record's created date:

    DECLARE @ExistingPassword as varchar(200)
    DECLARE @LastChanged as DateTime

    SELECT Top 1
        @ExistingPassword = p.PasswordHash,
        @LastChanged = p.Created, 
    FROM Password as p
    WHERE p.UserId = @UserId
    ORDER BY p.Created DESC

Is this a reasonably efficient way of getting the most recent password hash and its created date?  Is there a better way to do it?",sql-server,query,performance,stored-procedures,,,open,0,177,14,"Is this an effective and efficient SQL Query or is there a better way? We have a passwords table which references a user table.  Records never get deleted from the password table so if a user changes their password, a new entry with a more recent `Created` date gets inserted.

The hash of the password is salted with various things, most importantly the created date of the actual record.

In a stored procedure, I'm retrieving variables so I can do a hash for comparison.  I really just want to store the most recent password hash for a user along with the record's created date:

    DECLARE @ExistingPassword as varchar(200)
    DECLARE @LastChanged as DateTime

    SELECT Top 1
        @ExistingPassword = p.PasswordHash,
        @LastChanged = p.Created, 
    FROM Password as p
    WHERE p.UserId = @UserId
    ORDER BY p.Created DESC

Is this a reasonably efficient way of getting the most recent password hash and its created date?  Is there a better way to do it?",4
4927638,02/07/2011 22:55:19,91825,04/16/2009 20:22:05,244,2,Should dev be admin on there computer ?,"In a corporate environment, should developerhave admin rights on there computer ?  Why ?

Technological environment : Windows 7 + Visual Studio 2008 + 2010 + Sql Server

Thanks,

Patrick",sql-server,visual-studio,admin,,,02/07/2011 23:18:17,off topic,1,28,8,"Should dev be admin on there computer ? In a corporate environment, should developerhave admin rights on there computer ?  Why ?

Technological environment : Windows 7 + Visual Studio 2008 + 2010 + Sql Server

Thanks,

Patrick",3
6022523,05/16/2011 19:47:48,296446,03/18/2010 11:26:32,759,32,Recommendation for a server side language (+ IDEs and Tools),"* I want to create a server that queries another web service every 5 mins and stores the result in SQL database.  

 * I also want web functions exposed that run queries against the database.  

 * Im not expecting a huge amount of trafic and the code should not be too complex. It a small side project.

I do not know much abou servers, I have a little experience with .NET and MS SQL server, however I want something free (or al least cheap!)

What language should I use and what IDE's and tools might I find useful?

",sql-server,web-services,,,,05/16/2011 20:05:29,not constructive,1,100,10,"Recommendation for a server side language (+ IDEs and Tools) * I want to create a server that queries another web service every 5 mins and stores the result in SQL database.  

 * I also want web functions exposed that run queries against the database.  

 * Im not expecting a huge amount of trafic and the code should not be too complex. It a small side project.

I do not know much abou servers, I have a little experience with .NET and MS SQL server, however I want something free (or al least cheap!)

What language should I use and what IDE's and tools might I find useful?

",2
7092230,08/17/2011 11:43:16,898514,08/17/2011 11:25:15,1,0,Update a table row with XML (MSSQL),"**Hi all, i have a xml file below generated using** 

> SELECT * FROM case WHERE ticketNo=@ticketNo FOR XML RAW,
> ELEMENTS

    <row>
      <ticketNo>1</ticketNo>
      <caller>name</caller>
      <category>3</category>
      <service>4</service>
      <workgroup>5</workgroup>
    </row>

**And i Update my table using this query with the same with some value changed**

    UPDATE case
        set caller = xmldoc.caller
        set category = xml.category
        from OpenXml(@idoc, '/row')
        with (ticketNo VARCHAR(50)'./ticketNo', 
              caller VARCHAR(50) './caller', 
              category VARCHAR(50) './category') xmldoc
        where dbo.tb_itsc_case.ticketNo = xmldoc.ticketNo

**Is it possible to update the table without specifying the individual column?**",sql-server,xml,database,,,,open,0,177,7,"Update a table row with XML (MSSQL) **Hi all, i have a xml file below generated using** 

> SELECT * FROM case WHERE ticketNo=@ticketNo FOR XML RAW,
> ELEMENTS

    <row>
      <ticketNo>1</ticketNo>
      <caller>name</caller>
      <category>3</category>
      <service>4</service>
      <workgroup>5</workgroup>
    </row>

**And i Update my table using this query with the same with some value changed**

    UPDATE case
        set caller = xmldoc.caller
        set category = xml.category
        from OpenXml(@idoc, '/row')
        with (ticketNo VARCHAR(50)'./ticketNo', 
              caller VARCHAR(50) './caller', 
              category VARCHAR(50) './category') xmldoc
        where dbo.tb_itsc_case.ticketNo = xmldoc.ticketNo

**Is it possible to update the table without specifying the individual column?**",3
11620841,07/23/2012 21:31:38,1032218,11/06/2011 13:17:48,181,0,SQL Server Workspace Memory,"Does Workspace memory (part of buffer pool) is limited for only Hash Join, Sort etc. only?

If I have a query that does use a nested loop join (wihtout a sort or hash), would it not use workspace memory?

Where would worktable for a simple query that return 100 rows will be created? in Tempdb..


",sql-server,sql-server-2008,,,,07/24/2012 02:02:46,off topic,1,53,4,"SQL Server Workspace Memory Does Workspace memory (part of buffer pool) is limited for only Hash Join, Sort etc. only?

If I have a query that does use a nested loop join (wihtout a sort or hash), would it not use workspace memory?

Where would worktable for a simple query that return 100 rows will be created? in Tempdb..


",2
9384045,02/21/2012 19:42:23,1224202,02/21/2012 19:33:25,1,0,Export SQL Server Database Diagram via Automated Process,"I am looking for a way to automatically export a viewable version of a Database Diagram in SQL Server 2008.  I understand that you can right-click a diagram, select 'Copy Diagram to Clipboard', and then paste into another application (Visio, Word, etc.)

Basically, I am looking for a means to automate this process via a SQL Server Job or some other automated process.

",sql-server,sql-server-2008,database-diagram,,,,open,0,63,8,"Export SQL Server Database Diagram via Automated Process I am looking for a way to automatically export a viewable version of a Database Diagram in SQL Server 2008.  I understand that you can right-click a diagram, select 'Copy Diagram to Clipboard', and then paste into another application (Visio, Word, etc.)

Basically, I am looking for a means to automate this process via a SQL Server Job or some other automated process.

",3
11423408,07/10/2012 23:20:47,1516201,07/10/2012 22:44:11,1,0,Archiving Folders," Using SQLServer2008 I need to build a table to save the information archiving folders and the user can add an unlimited number of folders and can delete or change the location of folders, each folder inside there is an unlimited number of files, Can anyone help me please?",sql-server,database,sql-server-2008,database-design,,07/11/2012 05:57:26,not a real question,1,49,2,"Archiving Folders  Using SQLServer2008 I need to build a table to save the information archiving folders and the user can add an unlimited number of folders and can delete or change the location of folders, each folder inside there is an unlimited number of files, Can anyone help me please?",4
923020,05/28/2009 20:35:51,91172,04/15/2009 16:06:32,81,1,SQL Server,can anyone share their experience with SQL Server DTS?,sql-server,,,,,05/28/2009 20:38:14,not a real question,1,9,2,SQL Server can anyone share their experience with SQL Server DTS?,1
5022495,02/16/2011 21:43:35,381082,07/01/2010 12:33:24,115,11,Which SQL Server message is spelled correctly?,"Which SQL Server 2008 message is spelled correctly?

![enter image description here][1]


  [1]: http://i.stack.imgur.com/iW3yM.jpg",sql-server,ssms,spelling,,,02/16/2011 21:48:22,off topic,1,14,7,"Which SQL Server message is spelled correctly? Which SQL Server 2008 message is spelled correctly?

![enter image description here][1]


  [1]: http://i.stack.imgur.com/iW3yM.jpg",3
883998,05/19/2009 17:12:32,5113,09/07/2008 23:46:50,1062,35,How to determine which table of a multitable view are updatable?,"This question applies to MS SQL Server 2000.

I have the following view:

    CREATE VIEW dbo.MyView
    AS
    SELECT     dbo.Foo.Id, dbo.Foo.ForeignId, dbo.Foo.column1, dbo.Foo.column2,
               dbo.Foo.column3, dbo.Bar.column1, dbo.Bar.column2, dbo.Bar.column3
    FROM       dbo.Bar INNER JOIN
                      dbo.Foo ON dbo.Bar.Id = dbo.Foo.ForeignId

When I update this view, (using VB.NET OleDbDataAdapters), I can update columns of Foo, but not columns of Bar.  My investigation into this tells me that in a multitable view like this that MS SQL server only allows you to update one of the tables.  So my question is, how does SQL server determine which table can be updated?

Is there a way to predict which of the tables can be updated or a way to control which one?  What if I wanted Bar to be the updateable table instead of Foo?",sql-server,database,vb.net,,,,open,0,184,11,"How to determine which table of a multitable view are updatable? This question applies to MS SQL Server 2000.

I have the following view:

    CREATE VIEW dbo.MyView
    AS
    SELECT     dbo.Foo.Id, dbo.Foo.ForeignId, dbo.Foo.column1, dbo.Foo.column2,
               dbo.Foo.column3, dbo.Bar.column1, dbo.Bar.column2, dbo.Bar.column3
    FROM       dbo.Bar INNER JOIN
                      dbo.Foo ON dbo.Bar.Id = dbo.Foo.ForeignId

When I update this view, (using VB.NET OleDbDataAdapters), I can update columns of Foo, but not columns of Bar.  My investigation into this tells me that in a multitable view like this that MS SQL server only allows you to update one of the tables.  So my question is, how does SQL server determine which table can be updated?

Is there a way to predict which of the tables can be updated or a way to control which one?  What if I wanted Bar to be the updateable table instead of Foo?",3
3299905,07/21/2010 13:46:59,334849,05/06/2010 20:59:11,642,34,Differences between Excel and SQL sorting,"Programs used:

> SQL Server 2000, Excel 2003

We have a table in our database called Samples.  Using the following query...

    SELECT [Sample], [Flag] FROM Samples
    ORDER BY [Sample]

... we get the following results:

     Sample	   Flag
    ----------   ----
    12-ABC-345      1
    123-45-AB       0
    679-ADC-12      1

When the user has the same data in an Excel spreadsheet, and sorts by the Sample column, they get the following sort order:

     Sample	   Flag
    ----------   ----
    123-45-AB       0
    12-ABC-345      1
    679-ADC-12      1

Out of curiosity, why is there a discrepancy between the sort in SQL and Excel (other than, ""because it's Microsoft"").  

Is there a way in SQL to sort on the Sample column in the same method as the Excel method, or vice versa?",sql-server,excel,sorting,,,,open,0,196,6,"Differences between Excel and SQL sorting Programs used:

> SQL Server 2000, Excel 2003

We have a table in our database called Samples.  Using the following query...

    SELECT [Sample], [Flag] FROM Samples
    ORDER BY [Sample]

... we get the following results:

     Sample	   Flag
    ----------   ----
    12-ABC-345      1
    123-45-AB       0
    679-ADC-12      1

When the user has the same data in an Excel spreadsheet, and sorts by the Sample column, they get the following sort order:

     Sample	   Flag
    ----------   ----
    123-45-AB       0
    12-ABC-345      1
    679-ADC-12      1

Out of curiosity, why is there a discrepancy between the sort in SQL and Excel (other than, ""because it's Microsoft"").  

Is there a way in SQL to sort on the Sample column in the same method as the Excel method, or vice versa?",3
4507509,12/22/2010 08:47:28,376083,06/25/2010 09:02:27,427,4,How to view transaction logs in sql server 2008,"I need to view the transaction logs of a database on sql server 2008 in order to find a delete transaction and hopefully roll it back.

Unfortunately I have no clue where to start, and I'm finding it difficult to determine which are **good** articles on google. 

Can anyone point me in the right direction? 

Thanks",sql-server,transaction-log,,,,,open,0,55,9,"How to view transaction logs in sql server 2008 I need to view the transaction logs of a database on sql server 2008 in order to find a delete transaction and hopefully roll it back.

Unfortunately I have no clue where to start, and I'm finding it difficult to determine which are **good** articles on google. 

Can anyone point me in the right direction? 

Thanks",2
9342595,02/18/2012 15:51:36,875695,03/23/2011 03:17:13,147,2,"SQL Server 2008, can I refer to a temporary table in a select statement within a udf?","I'm trying to run a select query on a temporary table within a udf. I can't find documentation stating this isn't allowed, yet the below stored procedure won't compile when I change `tblDailyPricingAndVol` to `#dailyPricingAndVolBySymbol` (my temporary table of course. The temp table is created at a higher level (in a stored procedure before the stored procedure that uses this function) if that affects anything... thanks in advance.

    ALTER FUNCTION dbo.PricingVolDataAvailableToDateProvided
    	(@Ticker nchar(10),
    	 @StartDate DATE,
    	 @NumberOfDaysBack int)
    	RETURNS nchar(5)
    AS
    	BEGIN
    
    	DECLARE @Result nchar(5)
    	DECLARE @RecordCount int
    
    	SET @RecordCount = (SELECT COUNT(TradeDate) AS Expr1
            FROM (SELECT TOP (100) PERCENT TradeDate
               FROM tblDailyPricingAndVol WHERE (Symbol = @Ticker) AND (TradeDate IN
                     (SELECT TOP (@NumberOfDaysBack) CAST(TradingDate AS DATE) AS Expr1
                      FROM tblTradingDays
                      WHERE (TradingDate <= @StartDate)
                      ORDER BY TradingDate DESC))
                      ORDER BY TradeDate DESC) AS TempTable)
    
    	IF @RecordCount = @NumberOfDaysBack
    		SET @Result = 'True'
    	ELSE
    		SET @Result = 'False'
    
    	RETURN @Result
    
    	END",sql-server,sql-server-2008,temporary-tables,,,,open,0,348,17,"SQL Server 2008, can I refer to a temporary table in a select statement within a udf? I'm trying to run a select query on a temporary table within a udf. I can't find documentation stating this isn't allowed, yet the below stored procedure won't compile when I change `tblDailyPricingAndVol` to `#dailyPricingAndVolBySymbol` (my temporary table of course. The temp table is created at a higher level (in a stored procedure before the stored procedure that uses this function) if that affects anything... thanks in advance.

    ALTER FUNCTION dbo.PricingVolDataAvailableToDateProvided
    	(@Ticker nchar(10),
    	 @StartDate DATE,
    	 @NumberOfDaysBack int)
    	RETURNS nchar(5)
    AS
    	BEGIN
    
    	DECLARE @Result nchar(5)
    	DECLARE @RecordCount int
    
    	SET @RecordCount = (SELECT COUNT(TradeDate) AS Expr1
            FROM (SELECT TOP (100) PERCENT TradeDate
               FROM tblDailyPricingAndVol WHERE (Symbol = @Ticker) AND (TradeDate IN
                     (SELECT TOP (@NumberOfDaysBack) CAST(TradingDate AS DATE) AS Expr1
                      FROM tblTradingDays
                      WHERE (TradingDate <= @StartDate)
                      ORDER BY TradingDate DESC))
                      ORDER BY TradeDate DESC) AS TempTable)
    
    	IF @RecordCount = @NumberOfDaysBack
    		SET @Result = 'True'
    	ELSE
    		SET @Result = 'False'
    
    	RETURN @Result
    
    	END",3
3190162,07/06/2010 20:55:36,67505,02/17/2009 18:30:08,408,37,sql connection timeout,"i have my server written with structure map and fluent nhibernate,
when i run my server from my pc and direct him to the db on another server i get a sqlexception that tells me that the timeout expired

this is the message :
Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.

the line in code that marked on debug  is 

 _transaction = _session.BeginTransaction();

any suggetions?
the db is mssql 2008",sql-server,fluent-nhibernate,,,,,open,0,78,3,"sql connection timeout i have my server written with structure map and fluent nhibernate,
when i run my server from my pc and direct him to the db on another server i get a sqlexception that tells me that the timeout expired

this is the message :
Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.

the line in code that marked on debug  is 

 _transaction = _session.BeginTransaction();

any suggetions?
the db is mssql 2008",2
1793656,11/24/2009 23:22:04,156222,08/14/2009 03:13:21,3,2,Help me with my SQL project (please).,"For this grading period, my CS teacher left us a open-choice project involving SQL and Delphi/VB. 

I ended up with the assignment of designing and building a program that allowed the users to, through a GUI in Delphi/VB, insert and read hurricane data pulled from a database (latest SQL Server, by the way). However, there are a few catches. 

Three tables are required: Hurricanes, Hurricane_History, and Category

The Category table is not meant to be modified, and it contains the columns 'Min. Speed', 'Max. Speed', and 'Category'. The idea is that a hurricane with a rotational speed of X falls into category Y if X is within the minimum and maximum speed of category Y. 

The Hurricane table is meant to be modified by the end-user, through the Delphi/VB gui. It contains the following columns: 'Name', 'Day', 'Time', 'Rotational_Speed', 'Movement_Speed', 'Latitude', 'Longitude', and 'Photo'. 

Then there is the Hurricane_History table, which contains 'Name', 'Category', 'Starting_DateTime', 'Ending_DateTime', 'Starting Latitude', 'Starting Longitude', 'Ending Latitude', 'Ending Longitude'. This table is not meant to be directly modified, but rather automatically populated through SQL (I figure using SQL triggers and stored procedures). 

What the program should end up doing is the following: The user opens the visual app, and enters in information for a certain hurricane. Since only the table Hurricanes is meant to be modified, the user would insert the Name, Day, Time, Current Rotational Speed, Current Movement speed, current latitude, current longitude, and, optionally, a picture. 

If the user enters a hurricane that does not exist yet, then it would create a new hurricane with the corresponding data in the Hurricane_History table. If he enters data for a hurricane that already exists, then the data for that hurricane should be updated, and stored into the corresponding Hurricane_History row. Furthermore, the current category of the hurricane should be automatically populated with SQL using the data that was stored in the Category table. 

So far, I have the three tables, the columns, the Delphi GUI, the connections (between Delphi and SQL Server), etc. 

What I'm having a real hard time with is the SQL Triggers and Stored procedures needed to generate the data in the Hurricane_History table. Here's my algorithm, the first one for populating the category, and the second one for populating the data of the Hurricane_History table:

    create trigger determine_category on Hurricanes for insert, update as
      *when a value is inserted into Hurricanes.Rotational_Speed, match it with the corresponding row in the      Categories table, and insert the corresponding category into the Category column of the hurricane's Hurricane_History row.* 

    create trigger populate_data on Hurricanes for insert, update as
      *if Hurricane.name exists, perform an update instead of an insert for using Hurricanes.Day as Hurricanes_History.Ending_Day, Hurricanes.Latitude and Hurricane.Longitude as Hurricanes_History.Ending_Latitude and Hurricanes_History.Ending_Longitude, and the Category using the determine_category trigger.*
    
       *if Hurricane.name does not exist, create a record in Hurricanes_History using the data from the newly inserted Hurricane record, and populating the Category using the determine_category trigger*

What I need help with is translating my thoughts and ideas into SQL code, so I was wondering if anyone might want to help me throughout this. 

Thanks a bunch!",sql-server,sql,,,,,open,0,549,7,"Help me with my SQL project (please). For this grading period, my CS teacher left us a open-choice project involving SQL and Delphi/VB. 

I ended up with the assignment of designing and building a program that allowed the users to, through a GUI in Delphi/VB, insert and read hurricane data pulled from a database (latest SQL Server, by the way). However, there are a few catches. 

Three tables are required: Hurricanes, Hurricane_History, and Category

The Category table is not meant to be modified, and it contains the columns 'Min. Speed', 'Max. Speed', and 'Category'. The idea is that a hurricane with a rotational speed of X falls into category Y if X is within the minimum and maximum speed of category Y. 

The Hurricane table is meant to be modified by the end-user, through the Delphi/VB gui. It contains the following columns: 'Name', 'Day', 'Time', 'Rotational_Speed', 'Movement_Speed', 'Latitude', 'Longitude', and 'Photo'. 

Then there is the Hurricane_History table, which contains 'Name', 'Category', 'Starting_DateTime', 'Ending_DateTime', 'Starting Latitude', 'Starting Longitude', 'Ending Latitude', 'Ending Longitude'. This table is not meant to be directly modified, but rather automatically populated through SQL (I figure using SQL triggers and stored procedures). 

What the program should end up doing is the following: The user opens the visual app, and enters in information for a certain hurricane. Since only the table Hurricanes is meant to be modified, the user would insert the Name, Day, Time, Current Rotational Speed, Current Movement speed, current latitude, current longitude, and, optionally, a picture. 

If the user enters a hurricane that does not exist yet, then it would create a new hurricane with the corresponding data in the Hurricane_History table. If he enters data for a hurricane that already exists, then the data for that hurricane should be updated, and stored into the corresponding Hurricane_History row. Furthermore, the current category of the hurricane should be automatically populated with SQL using the data that was stored in the Category table. 

So far, I have the three tables, the columns, the Delphi GUI, the connections (between Delphi and SQL Server), etc. 

What I'm having a real hard time with is the SQL Triggers and Stored procedures needed to generate the data in the Hurricane_History table. Here's my algorithm, the first one for populating the category, and the second one for populating the data of the Hurricane_History table:

    create trigger determine_category on Hurricanes for insert, update as
      *when a value is inserted into Hurricanes.Rotational_Speed, match it with the corresponding row in the      Categories table, and insert the corresponding category into the Category column of the hurricane's Hurricane_History row.* 

    create trigger populate_data on Hurricanes for insert, update as
      *if Hurricane.name exists, perform an update instead of an insert for using Hurricanes.Day as Hurricanes_History.Ending_Day, Hurricanes.Latitude and Hurricane.Longitude as Hurricanes_History.Ending_Latitude and Hurricanes_History.Ending_Longitude, and the Category using the determine_category trigger.*
    
       *if Hurricane.name does not exist, create a record in Hurricanes_History using the data from the newly inserted Hurricane record, and populating the Category using the determine_category trigger*

What I need help with is translating my thoughts and ideas into SQL code, so I was wondering if anyone might want to help me throughout this. 

Thanks a bunch!",2
3660734,09/07/2010 16:46:07,140110,07/17/2009 11:54:59,381,27,Create a table from CSV columns in SQL Server without using a cursor,"Given a table:

    |Name    | Hobbies                |
    -----------------------------------
    |Joe	 | Eating,Running,Golf    |
    |Dafydd  | Swimming,Coding,Gaming |

I would like to split these rows out to get:

    |Name    | Hobby     |
    ----------------------
    |Joe	 | Eating    |
    |Joe	 | Running   |
    |Joe     | Golf      |
    |Dafydd  | Swimming  |
    |Dafydd  | Coding    |
    |Dafydd  | Gaming    |

I have completed this below (example is ready to run in SSMS), buy my solution uses a cursor which I think is ugly. Is there a better way of doing this? I am on SQL Server 2008 R2 if there is anything new which will help me.

Thanks

    if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[Split]') and xtype in (N'FN', N'IF', N'TF')) drop function [dbo].Split
    go
    CREATE FUNCTION dbo.Split (@sep char(1), @s varchar(512))
    RETURNS table
    AS
    RETURN (
        WITH Pieces(pn, start, stop) AS (
          SELECT 1, 1, CHARINDEX(@sep, @s)
          UNION ALL
          SELECT pn + 1, stop + 1, CHARINDEX(@sep, @s, stop + 1)
          FROM Pieces
          WHERE stop > 0
        )
        SELECT pn,
          SUBSTRING(@s, start, CASE WHEN stop > 0 THEN stop-start ELSE 512 END) AS s
        FROM Pieces
      )
    
    
    go
    
    declare @inputtable table (
    	name varchar(200) not null,
    	hobbies varchar(200) not null
    )
    
    declare @outputtable table (
    	name varchar(200) not null,
    	hobby varchar(200) not null
    )
    
    insert into @inputtable values('Joe', 'Eating,Running,Golf')
    insert into @inputtable values('Dafydd', 'Swimming,Coding,Gaming')
    
    select * from @inputtable
    
    declare inputcursor cursor for
    select name, hobbies
    from @inputtable
    
    open inputcursor
    
    declare @name varchar(255), @hobbiescsv varchar(255)
    fetch next from inputcursor into @name, @hobbiescsv
    while(@@FETCH_STATUS <> -1) begin
    	
    	insert into @outputtable
    	select @name, splithobbies.s
    	from dbo.split(',', @hobbiescsv) splithobbies
    	
    	fetch next from inputcursor into @name, @hobbiescsv	
    end
    close inputcursor
    deallocate inputcursor
    
    select * from @outputtable",sql-server,tsql,cursor,,,,open,0,600,13,"Create a table from CSV columns in SQL Server without using a cursor Given a table:

    |Name    | Hobbies                |
    -----------------------------------
    |Joe	 | Eating,Running,Golf    |
    |Dafydd  | Swimming,Coding,Gaming |

I would like to split these rows out to get:

    |Name    | Hobby     |
    ----------------------
    |Joe	 | Eating    |
    |Joe	 | Running   |
    |Joe     | Golf      |
    |Dafydd  | Swimming  |
    |Dafydd  | Coding    |
    |Dafydd  | Gaming    |

I have completed this below (example is ready to run in SSMS), buy my solution uses a cursor which I think is ugly. Is there a better way of doing this? I am on SQL Server 2008 R2 if there is anything new which will help me.

Thanks

    if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[Split]') and xtype in (N'FN', N'IF', N'TF')) drop function [dbo].Split
    go
    CREATE FUNCTION dbo.Split (@sep char(1), @s varchar(512))
    RETURNS table
    AS
    RETURN (
        WITH Pieces(pn, start, stop) AS (
          SELECT 1, 1, CHARINDEX(@sep, @s)
          UNION ALL
          SELECT pn + 1, stop + 1, CHARINDEX(@sep, @s, stop + 1)
          FROM Pieces
          WHERE stop > 0
        )
        SELECT pn,
          SUBSTRING(@s, start, CASE WHEN stop > 0 THEN stop-start ELSE 512 END) AS s
        FROM Pieces
      )
    
    
    go
    
    declare @inputtable table (
    	name varchar(200) not null,
    	hobbies varchar(200) not null
    )
    
    declare @outputtable table (
    	name varchar(200) not null,
    	hobby varchar(200) not null
    )
    
    insert into @inputtable values('Joe', 'Eating,Running,Golf')
    insert into @inputtable values('Dafydd', 'Swimming,Coding,Gaming')
    
    select * from @inputtable
    
    declare inputcursor cursor for
    select name, hobbies
    from @inputtable
    
    open inputcursor
    
    declare @name varchar(255), @hobbiescsv varchar(255)
    fetch next from inputcursor into @name, @hobbiescsv
    while(@@FETCH_STATUS <> -1) begin
    	
    	insert into @outputtable
    	select @name, splithobbies.s
    	from dbo.split(',', @hobbiescsv) splithobbies
    	
    	fetch next from inputcursor into @name, @hobbiescsv	
    end
    close inputcursor
    deallocate inputcursor
    
    select * from @outputtable",3
4161976,11/12/2010 05:47:01,264586,02/02/2010 17:46:20,161,8,SQL Server Undocumented Stored Procedures  and functions ,"Hi guys i found there are lots of advance featured store procedures in sql server which is not document by the online books. i found them from googling.  here are some of them if you have others please share them with me .

Undocumented Stored Procedures in SQL Server

    sp_checknames
    sp_columns_rowset
    sp_enumoledbdatasources
    sp_fixindex
    sp_gettypestring
    sp_ms_marksystemobject
    sp_msaddguidcolumn
    sp_msaddguidindex
    sp_msaddlogin_implicit_ntlogin
    sp_msadduser_implicit_ntlogin
    sp_mscheck_uid_owns_anything
    sp_msdbuseraccess
    sp_msdbuserpriv
    sp_msdependencies
    sp_msdrop_object
    sp_msforeachdb
    sp_msforeachtable
    sp_msget_qualified_name
    sp_msgettools_path
    sp_msgetversion
    sp_msguidtostr
    sp_mshelpcolumns
    sp_mshelpindex
    sp_mshelptype
    sp_msindexspace
    sp_msis_pk_col
    sp_mskilldb
    sp_msloginmappings
    sp_mstablekeys
    sp_mstablerefs
    sp_mstablespace
    sp_msunc_to_drive
    sp_msuniquecolname
    sp_msuniquename
    sp_msuniqueobjectname
    sp_msuniquetempname
    sp_tempdbspace
    sp_who2
    xp_delete_file
    xp_dirtree
    xp_enum_oledb_providers
    xp_enumcodepages
    xp_enumdsn
    xp_enumerrorlogs
    xp_enumgroups
    xp_fileexist
    xp_fixeddrives
    xp_get_mapi_default_profile
    xp_get_mapi_profiles
    xp_getnetname
    xp_qv
    xp_readerrorlog
    xp_regaddmultistring
    xp_regdeletekey
    xp_regdeletevalue
    xp_regenumvalues
    xp_regread
    xp_regremovemultistring
    xp_regwrite
    xp_subdirs
    xp_varbintohexstr

sp_MSforeachtable can be used to loop through all the tables in your databases. Here are some common usages of this useful stored procedure

    Display the size of all tables in a database
    EXEC sp_MSforeachtable @command1=""EXEC sp_spaceused '?'""
    
    
        Display Number of Rows in all Tables in a database
        
        EXEC sp_MSforeachtable 'SELECT ''?'', Count(*) as NumberOfRows FROM ?'
    
        Rebuild all indexes of all tables in a database
        
        EXEC sp_MSforeachtable @command1=""print '?' DBCC DBREINDEX ('?', ' ', 80)""
    GO
    
    
    
    Note: DBCC DBREINDEX has been deprecated in SQL 2005. Microsoft says ""This feature will be removed in a future version of Microsoft SQL Server. Avoid using this feature in new development work, and plan to modify applications that currently use this feature. Use ALTER INDEX instead.""
    
    Disable all constraints of all tables in a database
    
    
    USE YOURDBNAME
    
    EXEC sp_MSforeachtable @command1=""ALTER TABLE ? NOCHECK CONSTRAINT ALL""
    
    
    
    Disable all Triggers of all tables in a database
    
    
    USE YOURDBNAME
    
    EXEC sp_MSforeachtable 'ALTER TABLE ? DISABLE TRIGGER ALL'
    
    
    
    Delete all data from all tables in your database
    
    
    -- disable referential integrity
    
    EXEC sp_MSForEachTable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'
    
    GO
    
     
    
    EXEC sp_MSForEachTable '
    
     IF OBJECTPROPERTY(object_id(''?''), ''TableHasForeignRef'') = 1
    
      DELETE FROM ?
    
     else
    
      TRUNCATE TABLE ?
    
    '
    
    GO
    
     
    
    -- enable referential integrity again
    
    EXEC sp_MSForEachTable 'ALTER TABLE ? CHECK CONSTRAINT ALL'
    
    GO
    
    
    
    To RESEED all table to 0, use this script
    EXEC sp_MSForEachTable '
    IF OBJECTPROPERTY(object_id(''?''), ''TableHasIdentity'') = 1
    DBCC CHECKIDENT (''?'', RESEED, 0)
    GO

guys share your knowledge at one place so lots of developers gain bani fits from this..



",sql-server,,,,,11/14/2010 12:55:52,not a real question,1,842,9,"SQL Server Undocumented Stored Procedures  and functions  Hi guys i found there are lots of advance featured store procedures in sql server which is not document by the online books. i found them from googling.  here are some of them if you have others please share them with me .

Undocumented Stored Procedures in SQL Server

    sp_checknames
    sp_columns_rowset
    sp_enumoledbdatasources
    sp_fixindex
    sp_gettypestring
    sp_ms_marksystemobject
    sp_msaddguidcolumn
    sp_msaddguidindex
    sp_msaddlogin_implicit_ntlogin
    sp_msadduser_implicit_ntlogin
    sp_mscheck_uid_owns_anything
    sp_msdbuseraccess
    sp_msdbuserpriv
    sp_msdependencies
    sp_msdrop_object
    sp_msforeachdb
    sp_msforeachtable
    sp_msget_qualified_name
    sp_msgettools_path
    sp_msgetversion
    sp_msguidtostr
    sp_mshelpcolumns
    sp_mshelpindex
    sp_mshelptype
    sp_msindexspace
    sp_msis_pk_col
    sp_mskilldb
    sp_msloginmappings
    sp_mstablekeys
    sp_mstablerefs
    sp_mstablespace
    sp_msunc_to_drive
    sp_msuniquecolname
    sp_msuniquename
    sp_msuniqueobjectname
    sp_msuniquetempname
    sp_tempdbspace
    sp_who2
    xp_delete_file
    xp_dirtree
    xp_enum_oledb_providers
    xp_enumcodepages
    xp_enumdsn
    xp_enumerrorlogs
    xp_enumgroups
    xp_fileexist
    xp_fixeddrives
    xp_get_mapi_default_profile
    xp_get_mapi_profiles
    xp_getnetname
    xp_qv
    xp_readerrorlog
    xp_regaddmultistring
    xp_regdeletekey
    xp_regdeletevalue
    xp_regenumvalues
    xp_regread
    xp_regremovemultistring
    xp_regwrite
    xp_subdirs
    xp_varbintohexstr

sp_MSforeachtable can be used to loop through all the tables in your databases. Here are some common usages of this useful stored procedure

    Display the size of all tables in a database
    EXEC sp_MSforeachtable @command1=""EXEC sp_spaceused '?'""
    
    
        Display Number of Rows in all Tables in a database
        
        EXEC sp_MSforeachtable 'SELECT ''?'', Count(*) as NumberOfRows FROM ?'
    
        Rebuild all indexes of all tables in a database
        
        EXEC sp_MSforeachtable @command1=""print '?' DBCC DBREINDEX ('?', ' ', 80)""
    GO
    
    
    
    Note: DBCC DBREINDEX has been deprecated in SQL 2005. Microsoft says ""This feature will be removed in a future version of Microsoft SQL Server. Avoid using this feature in new development work, and plan to modify applications that currently use this feature. Use ALTER INDEX instead.""
    
    Disable all constraints of all tables in a database
    
    
    USE YOURDBNAME
    
    EXEC sp_MSforeachtable @command1=""ALTER TABLE ? NOCHECK CONSTRAINT ALL""
    
    
    
    Disable all Triggers of all tables in a database
    
    
    USE YOURDBNAME
    
    EXEC sp_MSforeachtable 'ALTER TABLE ? DISABLE TRIGGER ALL'
    
    
    
    Delete all data from all tables in your database
    
    
    -- disable referential integrity
    
    EXEC sp_MSForEachTable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'
    
    GO
    
     
    
    EXEC sp_MSForEachTable '
    
     IF OBJECTPROPERTY(object_id(''?''), ''TableHasForeignRef'') = 1
    
      DELETE FROM ?
    
     else
    
      TRUNCATE TABLE ?
    
    '
    
    GO
    
     
    
    -- enable referential integrity again
    
    EXEC sp_MSForEachTable 'ALTER TABLE ? CHECK CONSTRAINT ALL'
    
    GO
    
    
    
    To RESEED all table to 0, use this script
    EXEC sp_MSForEachTable '
    IF OBJECTPROPERTY(object_id(''?''), ''TableHasIdentity'') = 1
    DBCC CHECKIDENT (''?'', RESEED, 0)
    GO

guys share your knowledge at one place so lots of developers gain bani fits from this..



",1
757857,04/16/2009 20:11:30,18255,09/18/2008 21:09:06,8065,514,How to build RUNAS functionality into a (C#/.NET/WinForms) program?,"Our workstations are not members of the domain our SQL Server is on.  (They're not actually on a domain at all - don't ask).

When we use SSMS or anything to connect to the SQL Server, we use RUNAS with DOMAIN\user.  Then we type in the password and it launches the program.  (RUNAS does not allow you to include the password in the batch file).

So I've got a .NET WinForms app which needs a SQL connection, and the users have to launch it by running a batch file which has the RUNAS command-line and then it launches the EXE.

If the user accidentally launches the EXE directly, it cannot connect to SQL Server.

Right-clicking on the app and using the ""Run As..."" option doesn't work (presumably because the workstation doesn't really know about the domain).

I'm looking for a way for the application to do the RUNAS functionality internally before it starts anything significant.",sql-server,runas,.net,security,authentication,,open,0,153,9,"How to build RUNAS functionality into a (C#/.NET/WinForms) program? Our workstations are not members of the domain our SQL Server is on.  (They're not actually on a domain at all - don't ask).

When we use SSMS or anything to connect to the SQL Server, we use RUNAS with DOMAIN\user.  Then we type in the password and it launches the program.  (RUNAS does not allow you to include the password in the batch file).

So I've got a .NET WinForms app which needs a SQL connection, and the users have to launch it by running a batch file which has the RUNAS command-line and then it launches the EXE.

If the user accidentally launches the EXE directly, it cannot connect to SQL Server.

Right-clicking on the app and using the ""Run As..."" option doesn't work (presumably because the workstation doesn't really know about the domain).

I'm looking for a way for the application to do the RUNAS functionality internally before it starts anything significant.",5
4225388,11/19/2010 13:22:26,514103,11/16/2010 19:20:39,6,0,How big is a website that can run on MS SQL Server Expresss perfectly?,"I have seen this comparison: http://www.microsoft.com/sqlserver/2008/en/us/editions-compare.aspx 

And I would like to know how big a website is that can run on SQL Server Express taking into acount that it allows only 1 CPU and its memory utilization  is 1 GB?",sql-server,,,,,11/19/2010 16:20:39,not a real question,1,41,14,"How big is a website that can run on MS SQL Server Expresss perfectly? I have seen this comparison: http://www.microsoft.com/sqlserver/2008/en/us/editions-compare.aspx 

And I would like to know how big a website is that can run on SQL Server Express taking into acount that it allows only 1 CPU and its memory utilization  is 1 GB?",1
11087989,06/18/2012 17:29:21,545517,12/17/2010 00:58:03,1732,83,convert xml string in a sql table to dynamic columns in the output result set of join to another table,"I have two tables (using table variables for illustration. You can run these directly in management studio) that are related by the Id column. 

Items in the first table has some standard set of columns and the second table has some extended parameter data for the same record. I'm storing the extended set as xml as it is dynamic in all aspects (different per product or new values being added etc).

I'm able to join these two tables and flatten out the column list as you can see in the example below. But my query requires to have the dynamic columns be defined beforehand. I would like to have this truly dynamic in the sense that if I were to add a new column in the @xml table, it should automatically come out as column6. Any pointers?

    declare @standard table
    (
       Id INT,
       Column1 varchar(10),
       Column2 varchar(10),
       Column3 varchar(10)
    )
    
    declare @extended table
    (
    	Id INT,
    	column1 xml
    )
    
    insert into @standard values (1,'11', '12', '13')
    insert into @standard values (2,'21', '22', '23')
    
    insert into @extended values (1,'<FieldSet><Field><id>1</id><column4>1x</column4><column5>4x</column5></Field></FieldSet>')
    insert into @extended values (2,'<FieldSet><Field><id>2</id><column4>2x</column4><column5>5x</column5></Field></FieldSet>')
    
    select s.column1, s.column2,
    
    ( 
    	SELECT Item2.value('(column4)[1]', 'varchar(50)')
    	FROM 
        e.column1.nodes('/FieldSet') AS T(Item)
    	CROSS APPLY e.column1.nodes('/FieldSet/Field') AS T2(Item2)
        
     ) column4,
     
     ( 
    	SELECT Item2.value('(column5)[1]', 'varchar(50)')
    	FROM 
        e.column1.nodes('/FieldSet') AS T(Item)
    	CROSS APPLY e.column1.nodes('/FieldSet/Field') AS T2(Item2)
    	
     ) column5 
     
    from @extended e
    join @standard s on s.Id = e.Id

",sql-server,xml,sql-server-2008,,,,open,0,388,20,"convert xml string in a sql table to dynamic columns in the output result set of join to another table I have two tables (using table variables for illustration. You can run these directly in management studio) that are related by the Id column. 

Items in the first table has some standard set of columns and the second table has some extended parameter data for the same record. I'm storing the extended set as xml as it is dynamic in all aspects (different per product or new values being added etc).

I'm able to join these two tables and flatten out the column list as you can see in the example below. But my query requires to have the dynamic columns be defined beforehand. I would like to have this truly dynamic in the sense that if I were to add a new column in the @xml table, it should automatically come out as column6. Any pointers?

    declare @standard table
    (
       Id INT,
       Column1 varchar(10),
       Column2 varchar(10),
       Column3 varchar(10)
    )
    
    declare @extended table
    (
    	Id INT,
    	column1 xml
    )
    
    insert into @standard values (1,'11', '12', '13')
    insert into @standard values (2,'21', '22', '23')
    
    insert into @extended values (1,'<FieldSet><Field><id>1</id><column4>1x</column4><column5>4x</column5></Field></FieldSet>')
    insert into @extended values (2,'<FieldSet><Field><id>2</id><column4>2x</column4><column5>5x</column5></Field></FieldSet>')
    
    select s.column1, s.column2,
    
    ( 
    	SELECT Item2.value('(column4)[1]', 'varchar(50)')
    	FROM 
        e.column1.nodes('/FieldSet') AS T(Item)
    	CROSS APPLY e.column1.nodes('/FieldSet/Field') AS T2(Item2)
        
     ) column4,
     
     ( 
    	SELECT Item2.value('(column5)[1]', 'varchar(50)')
    	FROM 
        e.column1.nodes('/FieldSet') AS T(Item)
    	CROSS APPLY e.column1.nodes('/FieldSet/Field') AS T2(Item2)
    	
     ) column5 
     
    from @extended e
    join @standard s on s.Id = e.Id

",3
1745230,11/16/2009 22:21:15,212434,11/16/2009 22:21:15,1,0,MSSQL - How many users do I *really* need?,"I'm setting up an application, and I'm looking into purchasing a license for MSSQL. My question is pretty simple (though may have a complicated answer...)

How many users accounts do I *really* need, for SQL Server?

The way I see it, I'd give one master administration account, maybe 2 or 3 user accounts, and then one application-based account.

My application will likely have about 30-40 users, with the rare possibility of having 4-5 people being simultaneous users. But as I see it, I'd set up a BLL with the 30-40 accounts - and the BLL would have the SQL account, that all 30 accounts would use to query the DB through...

I'm just wondering what people's take on this is. Is that the way to go, or do I have the wrong idea of architecture here?

Thanks in advance!",sql-server,user-accounts,useraccount,architecture,,,open,0,134,9,"MSSQL - How many users do I *really* need? I'm setting up an application, and I'm looking into purchasing a license for MSSQL. My question is pretty simple (though may have a complicated answer...)

How many users accounts do I *really* need, for SQL Server?

The way I see it, I'd give one master administration account, maybe 2 or 3 user accounts, and then one application-based account.

My application will likely have about 30-40 users, with the rare possibility of having 4-5 people being simultaneous users. But as I see it, I'd set up a BLL with the 30-40 accounts - and the BLL would have the SQL account, that all 30 accounts would use to query the DB through...

I'm just wondering what people's take on this is. Is that the way to go, or do I have the wrong idea of architecture here?

Thanks in advance!",4
11390627,07/09/2012 07:24:07,1155598,01/18/2012 06:50:12,11,1,Import Data from Odata to sql server database,"I have a service URL of Odata now i want to import the data to my sql server.
Please tell me how to do this , i am beginner so please write detailed explanation.",sql-server,url,import,odata,,07/10/2012 04:24:58,not constructive,1,33,8,"Import Data from Odata to sql server database I have a service URL of Odata now i want to import the data to my sql server.
Please tell me how to do this , i am beginner so please write detailed explanation.",4
9327368,02/17/2012 11:25:33,806549,06/20/2011 11:38:10,857,47,Is it possible to read data in another sessions temporary table?,"We're maintaining (and occasionally debugging) a large in-house system. The system has 20+ databases, and a number of servers interfacing to other systems, processing data, etc. Not all is in-house developed - ie. we don't always have access to source code.

At one place, we can see the system creating a #temp table - and then, in the next step, failing due to a data-error. We can see the existence of the #temp table in Management Studio - it exists in `tempdb --> Temporary Tables` as something like 

`#MyStuff________________________________________________________________________________________________________000000A65029`

Obviously, the context menu here doesn't offer the full functionality (with Create table, select top 1000, etc.) - but only `Reports`and `Refresh`.

I can find the table in `sys.objects`, `sys.tables` and even it's column definition in `sys.columns`.

The question is: Is it in any way possible to access the data in the table? We can break execution so as to ensure that the table stays in scope, so the table vanishing shouldn't be an issue. This is not something that is to be done regularly or in code - it's more or less a one-shot deal. (I hope).",sql-server,sql-server-2008-r2,,,,,open,0,183,11,"Is it possible to read data in another sessions temporary table? We're maintaining (and occasionally debugging) a large in-house system. The system has 20+ databases, and a number of servers interfacing to other systems, processing data, etc. Not all is in-house developed - ie. we don't always have access to source code.

At one place, we can see the system creating a #temp table - and then, in the next step, failing due to a data-error. We can see the existence of the #temp table in Management Studio - it exists in `tempdb --> Temporary Tables` as something like 

`#MyStuff________________________________________________________________________________________________________000000A65029`

Obviously, the context menu here doesn't offer the full functionality (with Create table, select top 1000, etc.) - but only `Reports`and `Refresh`.

I can find the table in `sys.objects`, `sys.tables` and even it's column definition in `sys.columns`.

The question is: Is it in any way possible to access the data in the table? We can break execution so as to ensure that the table stays in scope, so the table vanishing shouldn't be an issue. This is not something that is to be done regularly or in code - it's more or less a one-shot deal. (I hope).",2
4807763,01/26/2011 17:28:53,64334,02/09/2009 21:08:32,3493,74,Need to change sql server database name in MS Access with Linked Tables,"I used the SSMA to migrate data from an access database to sql server, while still using the user interface in the access database.

Now, I need to rename that sql server database, but I'm not sure how to update the Access file to use the renamed database.

",sql-server,database,ms-access,,,,open,0,47,13,"Need to change sql server database name in MS Access with Linked Tables I used the SSMA to migrate data from an access database to sql server, while still using the user interface in the access database.

Now, I need to rename that sql server database, but I'm not sure how to update the Access file to use the renamed database.

",3
7903268,10/26/2011 13:27:49,22194,09/25/2008 14:22:55,4226,187,sp_ddopen - What is this doing?,"Captured this in SQL Profiler, being sent from a 3rd party app. What is it doing?


    declare @p1 int
    set @p1=180150003
    declare @p3 int
    set @p3=8
    declare @p4 int
    set @p4=1
    declare @p5 int
    set @p5=34
    exec sp_ddopen @p1 output,N'sp_sproc_columns',@p3 output,@p4 output,@p5 output,N'some_stored_procedure_name',NULL,NULL,NULL
    select @p1, @p3, @p4, @p5

",sql-server,sql-server-2005,stored-procedures,,,,open,0,78,6,"sp_ddopen - What is this doing? Captured this in SQL Profiler, being sent from a 3rd party app. What is it doing?


    declare @p1 int
    set @p1=180150003
    declare @p3 int
    set @p3=8
    declare @p4 int
    set @p4=1
    declare @p5 int
    set @p5=34
    exec sp_ddopen @p1 output,N'sp_sproc_columns',@p3 output,@p4 output,@p5 output,N'some_stored_procedure_name',NULL,NULL,NULL
    select @p1, @p3, @p4, @p5

",3
111318,09/21/2008 16:10:00,12514,09/16/2008 14:37:52,1,2,How to convert legacy Interbase DB to SQL Server?,I have an Interbase DB. How can I convert it to SQL Server?,sql-server,db,interbase,,,,open,0,13,9,How to convert legacy Interbase DB to SQL Server? I have an Interbase DB. How can I convert it to SQL Server?,3
3043154,06/15/2010 07:06:48,366979,06/15/2010 07:06:48,1,0,Combining multiple condition in single case statement in Sql Server,"According to the following description i have to frame a case ...End statement in Sql server ,help me to frame a complex case..End statement to fulfil the following condition.

if PAT_ENT.SCR_DT is not null and PAT_ENTRY.ELIGIBILITY is null then display display 'Favor'

if PAT_ENT.SCR_DT is not null and PAT_ENTRY.EL is equal to No, display 'Error'

if PAT_ENTRY.EL is Yes and DS.DES is equal to null or OFF, display 'Active'

if DS.DES is equal to N, display 'Early Term'

if DS.DES is equal to Y, display 'Complete'

Thanks in advance.


",sql-server,sql-server-2005,,,,,open,0,83,10,"Combining multiple condition in single case statement in Sql Server According to the following description i have to frame a case ...End statement in Sql server ,help me to frame a complex case..End statement to fulfil the following condition.

if PAT_ENT.SCR_DT is not null and PAT_ENTRY.ELIGIBILITY is null then display display 'Favor'

if PAT_ENT.SCR_DT is not null and PAT_ENTRY.EL is equal to No, display 'Error'

if PAT_ENTRY.EL is Yes and DS.DES is equal to null or OFF, display 'Active'

if DS.DES is equal to N, display 'Early Term'

if DS.DES is equal to Y, display 'Complete'

Thanks in advance.


",2
11190726,06/25/2012 13:59:02,1194599,02/07/2012 12:13:25,4,0,Deploy sql server R2 database and C# application,How can I deploy sql server R2 database and C# application which can be installed on a computer,sql-server,c#-2.0,,,,06/25/2012 20:55:51,not a real question,1,18,8,Deploy sql server R2 database and C# application How can I deploy sql server R2 database and C# application which can be installed on a computer,2
10652217,05/18/2012 11:56:23,672018,03/22/2011 21:26:26,449,6,"Why it's possible to connect to SQL server database from Windown Mobile, but not from WP7?","I'd like to connect directly from my wp7 phone to a SQL server database. It seems to be impossible according to [this][1].

However it seems to be possible to do so from a WM phone. According to [this][2]

Why is WP7 so limited comparing to much older WM?

  [1]: http://stackoverflow.com/questions/4380862/connecting-to-a-sql-server-from-windows-phone-7
  [2]: http://highoncoding.com/Articles/551_How_to_Access_SQL_Server_2005_from_the_Windows_Mobile_Devices.aspx",sql-server,windows-phone-7,windows-mobile,,,05/18/2012 12:57:16,not constructive,1,52,16,"Why it's possible to connect to SQL server database from Windown Mobile, but not from WP7? I'd like to connect directly from my wp7 phone to a SQL server database. It seems to be impossible according to [this][1].

However it seems to be possible to do so from a WM phone. According to [this][2]

Why is WP7 so limited comparing to much older WM?

  [1]: http://stackoverflow.com/questions/4380862/connecting-to-a-sql-server-from-windows-phone-7
  [2]: http://highoncoding.com/Articles/551_How_to_Access_SQL_Server_2005_from_the_Windows_Mobile_Devices.aspx",3
11016940,06/13/2012 14:23:24,1152692,01/16/2012 21:13:06,3,0,filling in table from function return sql server,"I have a table such as:

<table>
<tr>
<TD>PK_ID</TD>  <TD>LOCATION_ID</TD>   <TD>LOCATION_TEXT</TD><BR>
<TD>1</TD>     <TD>21</TD>         <TD>NULL</TD><BR>
<TD>2</TD>     <TD>44</TD>         <TD>NULL</TD><BR>
<TD>3</TD>     <TD>26</TD>         <TD>NULL</TD><BR>
 

etc (sorry dont know how to format here)


I have a function that returns the LOCATION_TEXT from the LOCATION_ID. I am trying to do something like:<BR>

update mytable set locationText = (select dbo.fcGetLocationText (LOCATION_ID) from mytable) 
<BR>

I am getting the Subquery returned more than 1 value error, which I kind of understand, but I dont know how else to do this... how can I update the LOCATION_TEXT column without a cursor or while loop?


",sql-server,tsql,,,,,open,0,125,8,"filling in table from function return sql server I have a table such as:

<table>
<tr>
<TD>PK_ID</TD>  <TD>LOCATION_ID</TD>   <TD>LOCATION_TEXT</TD><BR>
<TD>1</TD>     <TD>21</TD>         <TD>NULL</TD><BR>
<TD>2</TD>     <TD>44</TD>         <TD>NULL</TD><BR>
<TD>3</TD>     <TD>26</TD>         <TD>NULL</TD><BR>
 

etc (sorry dont know how to format here)


I have a function that returns the LOCATION_TEXT from the LOCATION_ID. I am trying to do something like:<BR>

update mytable set locationText = (select dbo.fcGetLocationText (LOCATION_ID) from mytable) 
<BR>

I am getting the Subquery returned more than 1 value error, which I kind of understand, but I dont know how else to do this... how can I update the LOCATION_TEXT column without a cursor or while loop?


",2
4603091,01/05/2011 10:35:23,340628,05/13/2010 19:45:23,3618,128,Converting Text to varchar(MAX),"I'm working currently on a SQL Server project that has been built for SQL Server 2000. In some tables of this project, the `Text` Datatype was used. Because have to do some bigger changes on this database(s), it would be a good occasion to change these fields to `VARCHAR(MAX)`. All SQL Servers are now 2005 and 2008.

Are there any problems to be expected when I change all the `Text` datatypes to `VARCHAR(MAX)` or are all features that are supported by the `Text` datatype also supported by `VARHCHAR(MAX)`.

As an additional information, the data from the database is queried mostly from a .net application, besides this, also excel, access and some statistical tools access the database directly via odbc/ole-db.


",sql-server,sql-server-2005,ado.net,,,,open,0,117,4,"Converting Text to varchar(MAX) I'm working currently on a SQL Server project that has been built for SQL Server 2000. In some tables of this project, the `Text` Datatype was used. Because have to do some bigger changes on this database(s), it would be a good occasion to change these fields to `VARCHAR(MAX)`. All SQL Servers are now 2005 and 2008.

Are there any problems to be expected when I change all the `Text` datatypes to `VARCHAR(MAX)` or are all features that are supported by the `Text` datatype also supported by `VARHCHAR(MAX)`.

As an additional information, the data from the database is queried mostly from a .net application, besides this, also excel, access and some statistical tools access the database directly via odbc/ole-db.


",3
9514692,03/01/2012 10:39:45,80530,03/20/2009 15:22:13,3277,102,Parameterize then Replay trc files SQL Server 2008,"I've recorded using the SQLServer Profiler a trace file to be replayed (trc file).
I'm following the instructions from this [article][1] to stress my server.

I have to manipulate this file to parameterize and randomize part of it. 

What is the best way to do that ? I was unable to find an API to parse my trace file and modify it.... The solution I'm considering is to export the trace as a T-Sql file and modify the script.

thanks 

 


  [1]: http://www.sql-server-performance.com/2005/stress-test-part3/",sql-server,sql-server-2008,tsql,sqlprofiler,,03/01/2012 16:47:16,off topic,1,82,8,"Parameterize then Replay trc files SQL Server 2008 I've recorded using the SQLServer Profiler a trace file to be replayed (trc file).
I'm following the instructions from this [article][1] to stress my server.

I have to manipulate this file to parameterize and randomize part of it. 

What is the best way to do that ? I was unable to find an API to parse my trace file and modify it.... The solution I'm considering is to export the trace as a T-Sql file and modify the script.

thanks 

 


  [1]: http://www.sql-server-performance.com/2005/stress-test-part3/",4
7404070,09/13/2011 15:02:14,571536,12/04/2010 02:04:44,942,37,SQL FullText Near+Or,"Is there a way to make a SQL FullText query ranked based on **BOTH 'OR' and 'NEAR'**?  
e.g: (in descending order of rank)

`foo ""ornear"" bar` should give:

 1. foo bar xxxx
 2. foo xxxxxxx bar 
 3. foo xxxxx
 4. bar xxxxxx

`foo or bar` gives me

 1. foo bar xxxx, foo xxxxx bar, foo xxxxx (same rank)
 2. bar xxxx

while `foo near bar` gives me

 1. foo bar xxxxxx
 2. foo xxxxxx bar",sql-server,full-text-search,,,,,open,0,74,3,"SQL FullText Near+Or Is there a way to make a SQL FullText query ranked based on **BOTH 'OR' and 'NEAR'**?  
e.g: (in descending order of rank)

`foo ""ornear"" bar` should give:

 1. foo bar xxxx
 2. foo xxxxxxx bar 
 3. foo xxxxx
 4. bar xxxxxx

`foo or bar` gives me

 1. foo bar xxxx, foo xxxxx bar, foo xxxxx (same rank)
 2. bar xxxx

while `foo near bar` gives me

 1. foo bar xxxxxx
 2. foo xxxxxx bar",2
3672644,09/08/2010 23:21:21,22093,09/25/2008 10:49:10,955,15,SQL Server Fulltext Search contains phrase problem,"I have a problem with SQL Server 2008 full text search I have the following query

    SELECT *
    FROM cigars
    WHERE CONTAINS(cigars.*, @Search )

@Search is a value that is passed in through a stored procedure. But, thats not the problem.

What is is if someone searches for say 'Punch' it works fine and I get all cigars that match.

Where the problem lays is if they search for 'Punch Cigar' I get this error.

**Syntax error near 'Cigar' in the full-text search condition 'Punch Cigar'.**

Any idea on how I can get it to allow for it to search for that phrase?

",sql-server,full-text-search,,,,,open,0,107,7,"SQL Server Fulltext Search contains phrase problem I have a problem with SQL Server 2008 full text search I have the following query

    SELECT *
    FROM cigars
    WHERE CONTAINS(cigars.*, @Search )

@Search is a value that is passed in through a stored procedure. But, thats not the problem.

What is is if someone searches for say 'Punch' it works fine and I get all cigars that match.

Where the problem lays is if they search for 'Punch Cigar' I get this error.

**Syntax error near 'Cigar' in the full-text search condition 'Punch Cigar'.**

Any idea on how I can get it to allow for it to search for that phrase?

",2
7548303,09/25/2011 20:15:23,330604,05/01/2010 23:33:50,521,32,Running a query using ADODB Connection randomly takes a long time to execute,"I have come across an issue that seems to be somehow connected to a web server configuration, and resulting in queries randomly taking a long time to execute. The application is created using old plain Classic ASP and ADODB Connection is used.

The scenario goes as follows:

- there is a single connection opened in a script at the beginning of processing each HTTP request
- this connection is used to execute a query against a SQL Server, that resides on a separate box. conn.Execute is used. Connection is NOT closed afterwards
- there are usually a few to a few dozens of conn.Execute in a single ASP page

All has been working well until recently, when some of the conn.Execute started to take much longer to execute, totally on random. 

- the difference is e.g. 15ms normal execution time vs. 2000ms long execution time
- on the SQL Server side, Profiler does not show longer query execution times, so there must be something blocking the conn.Execute request

When a proper practice of closing a connection after each conn.Execute has been implemented, the issue goes away. However, as I have stated before, all has been working flawlessly until recently. This web app is a fairly large one and rewriting it to close and reopen connections properly will take some time. And I need a short-term solution. 

My guess is that it could have something to do with the connection pool size, however this is not ADO.NET, therefore I am not sure, whether a connection pool issue should be taken into the consideration at all. On the SQL Server side, there is no limit on the number of concurrent connections to the server.

I need some hints. Brainstorming possible ideas.",sql-server,asp-classic,adodb,,,,open,0,281,13,"Running a query using ADODB Connection randomly takes a long time to execute I have come across an issue that seems to be somehow connected to a web server configuration, and resulting in queries randomly taking a long time to execute. The application is created using old plain Classic ASP and ADODB Connection is used.

The scenario goes as follows:

- there is a single connection opened in a script at the beginning of processing each HTTP request
- this connection is used to execute a query against a SQL Server, that resides on a separate box. conn.Execute is used. Connection is NOT closed afterwards
- there are usually a few to a few dozens of conn.Execute in a single ASP page

All has been working well until recently, when some of the conn.Execute started to take much longer to execute, totally on random. 

- the difference is e.g. 15ms normal execution time vs. 2000ms long execution time
- on the SQL Server side, Profiler does not show longer query execution times, so there must be something blocking the conn.Execute request

When a proper practice of closing a connection after each conn.Execute has been implemented, the issue goes away. However, as I have stated before, all has been working flawlessly until recently. This web app is a fairly large one and rewriting it to close and reopen connections properly will take some time. And I need a short-term solution. 

My guess is that it could have something to do with the connection pool size, however this is not ADO.NET, therefore I am not sure, whether a connection pool issue should be taken into the consideration at all. On the SQL Server side, there is no limit on the number of concurrent connections to the server.

I need some hints. Brainstorming possible ideas.",3
9786437,03/20/2012 12:07:54,1211231,02/15/2012 11:47:20,1,0,Alias name is same as column name,"In sql server 2008 alias name is same as column name so am getting error The column  was specified multiple times.I cn't change the alias name the application breaks
this is the query.
]The column 'published' was specified multiple times for '_myResults'.SQL=SELECT TOP 20 * FROM (SELECT a.id, a.menutype, a.title, a.alias, a.note, a.path, a.link, a.type, a.parent_id, a.level, a.published, a.component_id, a.ordering, a.checked_out, a.checked_out_time, a.browserNav, a.access, a.img, a.template_style_id, a.params, a.lft, a.rgt, a.home, a.language, a.client_id,CASE a.type WHEN N'component' THEN a.published+2*(e.enabled-1) WHEN N'url' THEN a.published+2 WHEN N'alias' THEN a.published+4 WHEN N'separator' THEN a.published+6 END AS published,l.title AS language_title, l.image as image,u.name AS editor,c.element AS componentname,ag.title AS access_level,e.name AS name ,ROW_NUMBER() OVER (ORDER BY a.lft asc) AS RowNumber FROM [ax_menu] AS a LEFT JOIN [ax_languages] AS l ON l.lang_code = a.language LEFT JOIN [ax_users] AS u ON u.id = a.checked_out LEFT JOIN [ax_extensions] AS c ON c.extension_id = a.component_id LEFT JOIN ax_viewlevels AS ag ON ag.id = a.access LEFT JOIN ax_extensions AS e ON e.extension_id = a.component_id WHERE a.id > 1 AND a.client_id = 0 AND (a.published IN (0, 1)) AND a.menutype = N'aboutjoomla' ) _myResults WHERE RowNumber > 0",sql-server,,,,,03/21/2012 14:06:51,not a real question,1,184,7,"Alias name is same as column name In sql server 2008 alias name is same as column name so am getting error The column  was specified multiple times.I cn't change the alias name the application breaks
this is the query.
]The column 'published' was specified multiple times for '_myResults'.SQL=SELECT TOP 20 * FROM (SELECT a.id, a.menutype, a.title, a.alias, a.note, a.path, a.link, a.type, a.parent_id, a.level, a.published, a.component_id, a.ordering, a.checked_out, a.checked_out_time, a.browserNav, a.access, a.img, a.template_style_id, a.params, a.lft, a.rgt, a.home, a.language, a.client_id,CASE a.type WHEN N'component' THEN a.published+2*(e.enabled-1) WHEN N'url' THEN a.published+2 WHEN N'alias' THEN a.published+4 WHEN N'separator' THEN a.published+6 END AS published,l.title AS language_title, l.image as image,u.name AS editor,c.element AS componentname,ag.title AS access_level,e.name AS name ,ROW_NUMBER() OVER (ORDER BY a.lft asc) AS RowNumber FROM [ax_menu] AS a LEFT JOIN [ax_languages] AS l ON l.lang_code = a.language LEFT JOIN [ax_users] AS u ON u.id = a.checked_out LEFT JOIN [ax_extensions] AS c ON c.extension_id = a.component_id LEFT JOIN ax_viewlevels AS ag ON ag.id = a.access LEFT JOIN ax_extensions AS e ON e.extension_id = a.component_id WHERE a.id > 1 AND a.client_id = 0 AND (a.published IN (0, 1)) AND a.menutype = N'aboutjoomla' ) _myResults WHERE RowNumber > 0",1
3193886,07/07/2010 10:29:13,127488,06/23/2009 10:32:10,250,12,Need help with a SQL query selecting date ranges from a table of period quarters,"I have a table called Periods that looks like this

PeriodID | PeriodYear | PeriodQuarter

7 | 2009 | 1

8 | 2009 | 2

9 | 2009 | 3

10 | 2009 | 4

11 | 2010 | 1

12 | 2010 | 2


Each row in the table represents 1 of the 4 quarters of the year (like 3-monthly school terms). E.g. The first row represents Period 1 of 2009 (i.e. the date range 1 Jan 2009 - 31 March 2009.

Now I need to write a query that selects rows/periods from the above table, where the period occurs between 2 date ranges, as per the following pseudocode.

    select *
    from Periods
    where Period is between @startDate and @endDate

I'm stuck and can't figure out how to do it. Please help. This applies to T-SQL (MS SQL Server 2000/2005)",sql-server,tsql,date,ranges,period,,open,0,140,15,"Need help with a SQL query selecting date ranges from a table of period quarters I have a table called Periods that looks like this

PeriodID | PeriodYear | PeriodQuarter

7 | 2009 | 1

8 | 2009 | 2

9 | 2009 | 3

10 | 2009 | 4

11 | 2010 | 1

12 | 2010 | 2


Each row in the table represents 1 of the 4 quarters of the year (like 3-monthly school terms). E.g. The first row represents Period 1 of 2009 (i.e. the date range 1 Jan 2009 - 31 March 2009.

Now I need to write a query that selects rows/periods from the above table, where the period occurs between 2 date ranges, as per the following pseudocode.

    select *
    from Periods
    where Period is between @startDate and @endDate

I'm stuck and can't figure out how to do it. Please help. This applies to T-SQL (MS SQL Server 2000/2005)",5
4403076,12/09/2010 21:01:44,4964,09/07/2008 03:07:41,571,5,TSQL to transform Address into a Mailing Address - SQL Server 2005,"I would like to transform an Address (Line1, Line2, Line3, City, State, ZIP) into a Mailing Address (Addr1, Addr2, Addr3, Addr4) that has no blank lines and the City, State and ZIP are concatenated together on one line.  Having a function do this would be very nice.

i.e.  
Line1=  
Line2=123 Somewhere  
Line3=  
City=Detroit  
State=MI  
Zip=48000  

The resulting Mailing Address  

Addr1=123 Somewhere  
Addr2=Detroit MI 48000  
Addr3=  
Addr4=  
",sql-server,sql-server-2005,tsql,,,,open,0,79,12,"TSQL to transform Address into a Mailing Address - SQL Server 2005 I would like to transform an Address (Line1, Line2, Line3, City, State, ZIP) into a Mailing Address (Addr1, Addr2, Addr3, Addr4) that has no blank lines and the City, State and ZIP are concatenated together on one line.  Having a function do this would be very nice.

i.e.  
Line1=  
Line2=123 Somewhere  
Line3=  
City=Detroit  
State=MI  
Zip=48000  

The resulting Mailing Address  

Addr1=123 Somewhere  
Addr2=Detroit MI 48000  
Addr3=  
Addr4=  
",3
3499698,08/17/2010 06:00:46,381878,07/02/2010 08:55:26,33,1,Synching two table in MS SQL,"Hi I have two database servers ( 2 different machine, but on same network).
I have one table in Database_1 and same table in Database_2.

Only Table in DB_1 will be updated by user, table in DB_2 will be used by other user for read only.

I want to program something which can copy the updated record from table in DB_1 to DB_2. I want to make it event based, something like whenever someone insert a record in Table@DB_1, I will get the same the record in Table@DB_2.

Can someone suggest me something?

",sql-server,database,,,,,open,0,89,6,"Synching two table in MS SQL Hi I have two database servers ( 2 different machine, but on same network).
I have one table in Database_1 and same table in Database_2.

Only Table in DB_1 will be updated by user, table in DB_2 will be used by other user for read only.

I want to program something which can copy the updated record from table in DB_1 to DB_2. I want to make it event based, something like whenever someone insert a record in Table@DB_1, I will get the same the record in Table@DB_2.

Can someone suggest me something?

",2
8396888,12/06/2011 08:08:49,990635,10/12/2011 02:40:49,100,3,Cannot establish connection to SQL Server,"I am trying to access SQL DB that is located on my computer from an application that is located on a server (has IIS7).  
I set the ConnectionString in the WebConfig with the IP of my computer and I always get this error:  

> A network-related or instance-specific error occurred while
> establishing a connection to SQL Server. The server was not found or
> was not accessible. Verify that the instance name is correct and that
> SQL Server is configured to allow remote connections. (provider: Named
> Pipes Provider, error: 40 - Could not open a connection to SQL Server)  

I wanted to enable remote connections as it was mentioned in the error. These are the things that I tried in order to make it work:  

 1. Made sure that ""Allow remote connections"" to this server is checked in the properties window of my server
 2. Enabled TCP/IP in the SQL Server Configuration Manager
 3. Right clicking on the TCP/IP and in ""Properties"" set the port to 80 and removed the ""0"" in the Dynamic Ports
 4. Created a new rule in the Windows Firewall to allow the connection from port 80
 5. Added sqlservr.exe from the MSSQL/Binn folder to ""Allow a program through Windows Firewall""
 6. Restarted the service

  
None of it helped. What else can I do?
",sql-server,sql-server-2008,iis,iis7,remote-connection,,open,0,223,6,"Cannot establish connection to SQL Server I am trying to access SQL DB that is located on my computer from an application that is located on a server (has IIS7).  
I set the ConnectionString in the WebConfig with the IP of my computer and I always get this error:  

> A network-related or instance-specific error occurred while
> establishing a connection to SQL Server. The server was not found or
> was not accessible. Verify that the instance name is correct and that
> SQL Server is configured to allow remote connections. (provider: Named
> Pipes Provider, error: 40 - Could not open a connection to SQL Server)  

I wanted to enable remote connections as it was mentioned in the error. These are the things that I tried in order to make it work:  

 1. Made sure that ""Allow remote connections"" to this server is checked in the properties window of my server
 2. Enabled TCP/IP in the SQL Server Configuration Manager
 3. Right clicking on the TCP/IP and in ""Properties"" set the port to 80 and removed the ""0"" in the Dynamic Ports
 4. Created a new rule in the Windows Firewall to allow the connection from port 80
 5. Added sqlservr.exe from the MSSQL/Binn folder to ""Allow a program through Windows Firewall""
 6. Restarted the service

  
None of it helped. What else can I do?
",5
1407878,09/10/2009 21:36:20,143218,07/22/2009 21:05:16,49,1,SQL Server 2005 Cursors,what are some of the cases that will cause a SQL Server 2005 cursor to deallocate prematurely?,sql-server,cursor,database,,,,open,0,17,4,SQL Server 2005 Cursors what are some of the cases that will cause a SQL Server 2005 cursor to deallocate prematurely?,3
7156428,08/23/2011 04:56:00,851441,07/19/2011 07:15:56,1,0,Updates tables without using trigger,"Can anyone tell me:

In SQL I want to insert data in two tables the same data,
You have to insert data in table1 only and data in other table(Table2) will be updated automatically.. from table1.
Condition apply: Without using triggers..",sql-server,sql-server-2008,,,,01/21/2012 13:49:23,too localized,1,38,5,"Updates tables without using trigger Can anyone tell me:

In SQL I want to insert data in two tables the same data,
You have to insert data in table1 only and data in other table(Table2) will be updated automatically.. from table1.
Condition apply: Without using triggers..",2
11399551,07/09/2012 16:46:54,1357627,04/26/2012 02:46:00,1,0,restore sql 2012 backup to sql 2008 database?,"is there a way to restore sql 2012 database backup to sql 2008? I tried to attach file, it does not work. ",sql-server,sql-server-2008,,,,07/09/2012 17:00:43,off topic,1,23,8,"restore sql 2012 backup to sql 2008 database? is there a way to restore sql 2012 database backup to sql 2008? I tried to attach file, it does not work. ",2
9818465,03/22/2012 08:07:28,508127,11/15/2010 10:28:18,1667,3,Sql server transaction and select statement,"i often saw many people use select statement with in transaction. i often use insert/update/delete only in transaction. i just do not understand that what is the utility of putting select statement inside transaction.

i got one answer that....Select inside the transaction can see changes made by other previous Insert/Update/delete statements in that transaction, A Select statement outside the transaction cannot.

above statement is it true or not ?

is this is the only reason that people put select statement inside transaction. please discuss all the reason in detail if possible. thanks",sql-server,,,,,,open,0,89,6,"Sql server transaction and select statement i often saw many people use select statement with in transaction. i often use insert/update/delete only in transaction. i just do not understand that what is the utility of putting select statement inside transaction.

i got one answer that....Select inside the transaction can see changes made by other previous Insert/Update/delete statements in that transaction, A Select statement outside the transaction cannot.

above statement is it true or not ?

is this is the only reason that people put select statement inside transaction. please discuss all the reason in detail if possible. thanks",1
7026457,08/11/2011 13:11:00,809051,06/21/2011 18:32:38,8,1,Mssql/Perl DBI performance woes,"Im writing an application that does a lot of large inserts to a remote mssql server with Perl DBI.  Not sure if it will be 05 or 08 sql server yet, but I've timed it in both so far and performance is similar.  Basically, there are a large number of rows that need to be inserted are turning out to be the bottleneck by far.  I have tried multi-row inserts in 08 ( and the sub-select UNION ALL trick in 05), changing whether the inserts are fired off during a previous fetch or after, using execut_array() on single-row inserts, all these with/without binding params.

    Psuedocode:
    
    select data query
    while fetchrow {
      do lots of calculations
      construct insert
      1) do inserts here
    }
    2) or do inserts here

The activity monitor on the sql server averages the multi-row inserts at 70ms a piece.  The queries themselves have been limited to 58ish rows a piece because there are 36 fields on the insert, and it easily hits the 2100 parameter limit.

Is there anything obvious I am overlooking?  Any other method I could try to improve the times?  Ignoring issues like latency or hardware, I feel like there has to be another improvement to my Perl workflow or the queries themselves.  (I was looking into sql server bcp, bulk inserts, etc).

Thanks for any advice",sql-server,perl,sql-server-2005,sql-server-2008,dbi,,open,0,261,4,"Mssql/Perl DBI performance woes Im writing an application that does a lot of large inserts to a remote mssql server with Perl DBI.  Not sure if it will be 05 or 08 sql server yet, but I've timed it in both so far and performance is similar.  Basically, there are a large number of rows that need to be inserted are turning out to be the bottleneck by far.  I have tried multi-row inserts in 08 ( and the sub-select UNION ALL trick in 05), changing whether the inserts are fired off during a previous fetch or after, using execut_array() on single-row inserts, all these with/without binding params.

    Psuedocode:
    
    select data query
    while fetchrow {
      do lots of calculations
      construct insert
      1) do inserts here
    }
    2) or do inserts here

The activity monitor on the sql server averages the multi-row inserts at 70ms a piece.  The queries themselves have been limited to 58ish rows a piece because there are 36 fields on the insert, and it easily hits the 2100 parameter limit.

Is there anything obvious I am overlooking?  Any other method I could try to improve the times?  Ignoring issues like latency or hardware, I feel like there has to be another improvement to my Perl workflow or the queries themselves.  (I was looking into sql server bcp, bulk inserts, etc).

Thanks for any advice",5
10400755,05/01/2012 16:22:15,462631,09/30/2010 08:35:47,754,29,"how do i truncate a field and append ""..."" to it?","I'm trying to figure out a select statement that will truncate a field value to 100 characters and add ... to the end of it so like:

HundredLetterSentence becomes HundredLetter Sen... or something like that. Here is the select statement from my stored procedure. I'm kinda stuck from here. The Select TOP(1) Description is where I want to do the truncation.

    SELECT   [TI].[TicketID], CAST([TI].[Subject] AS VARCHAR(100)) [Subject], [TA].[DueDate], CAST((SELECT TOP(1) SUBSTRING(Description, 0, 100) FROM Comment WHERE TicketID = [TI].[TicketID] ORDER BY CommentDate DESC) AS VARCHAR(100)) AS [Description]
    	FROM     [dbo].[Ticket] [TI]
    			 INNER JOIN [dbo].[Task] [TA] ON [TI].[TicketID] = [TA].[TicketID]
    			 INNER JOIN [dbo].[Task_Status] [TS] ON [TA].[StatusID] = [TS].[StatusID]
    	WHERE    [TI].[IsDeleted] = 0 AND
    			 [TS].[IsDeleted] = 0 AND
    			 [TS].[Status] = 'Open' AND
                 [TI].[AssigneeView] IS NULL AND
    			 [TI].[AssignedTo] = @AssignedTo",sql-server,tsql,,,,,open,0,179,11,"how do i truncate a field and append ""..."" to it? I'm trying to figure out a select statement that will truncate a field value to 100 characters and add ... to the end of it so like:

HundredLetterSentence becomes HundredLetter Sen... or something like that. Here is the select statement from my stored procedure. I'm kinda stuck from here. The Select TOP(1) Description is where I want to do the truncation.

    SELECT   [TI].[TicketID], CAST([TI].[Subject] AS VARCHAR(100)) [Subject], [TA].[DueDate], CAST((SELECT TOP(1) SUBSTRING(Description, 0, 100) FROM Comment WHERE TicketID = [TI].[TicketID] ORDER BY CommentDate DESC) AS VARCHAR(100)) AS [Description]
    	FROM     [dbo].[Ticket] [TI]
    			 INNER JOIN [dbo].[Task] [TA] ON [TI].[TicketID] = [TA].[TicketID]
    			 INNER JOIN [dbo].[Task_Status] [TS] ON [TA].[StatusID] = [TS].[StatusID]
    	WHERE    [TI].[IsDeleted] = 0 AND
    			 [TS].[IsDeleted] = 0 AND
    			 [TS].[Status] = 'Open' AND
                 [TI].[AssigneeView] IS NULL AND
    			 [TI].[AssignedTo] = @AssignedTo",2
10972674,06/10/2012 22:00:04,1447001,06/10/2012 05:45:41,7,0,SQL Server 2008 - Cannot insert due to 'conflict with the FK constraint',"My query is given below:

    insert into Orders
    values
    ('20012', /*order num, pk*/
    '6-10-2012', /*date, i wrote it in a different format, is that okay ?*/
    '1000000012'/*customer id, fk*/
    )

The error:

    The INSERT statement conflicted with the FOREIGN KEY constraint  
    ""FK_Orders_Customers"".   
    The conflict occurred in database ""MyDB"", table ""dbo.Customers"", column 'cust_id'.
    The statement has been terminated.

Why do i get this error ? How can i insert some dummy values into this table ?
",sql-server,foreign-keys,conflict,insert-into,,,open,0,108,13,"SQL Server 2008 - Cannot insert due to 'conflict with the FK constraint' My query is given below:

    insert into Orders
    values
    ('20012', /*order num, pk*/
    '6-10-2012', /*date, i wrote it in a different format, is that okay ?*/
    '1000000012'/*customer id, fk*/
    )

The error:

    The INSERT statement conflicted with the FOREIGN KEY constraint  
    ""FK_Orders_Customers"".   
    The conflict occurred in database ""MyDB"", table ""dbo.Customers"", column 'cust_id'.
    The statement has been terminated.

Why do i get this error ? How can i insert some dummy values into this table ?
",4
4307612,11/29/2010 20:09:33,352157,04/28/2010 15:30:52,474,23,I need sql certifications explained,"ok so i am royally confused about the certifications Microsoft has out for SQL server.

from what i can gather from reading their site as well as others is there are various levels of tests (like in university) they have level 100 series tests, 200, 300... up to about 4oo for the new master of sql server level.

i wanted to knock a few out since i am doing daily SQL work now i figure i can get on the job practice and learning where i fall short.

where do i start?
what test and test details do i need to know to take + pass each exam?
what order should i take them in?

hints about what should be my 1st sql exam, 2nd exam... would really be great.

thanks all!!!
",sql-server,exam,,,,11/30/2010 10:36:13,off topic,1,125,5,"I need sql certifications explained ok so i am royally confused about the certifications Microsoft has out for SQL server.

from what i can gather from reading their site as well as others is there are various levels of tests (like in university) they have level 100 series tests, 200, 300... up to about 4oo for the new master of sql server level.

i wanted to knock a few out since i am doing daily SQL work now i figure i can get on the job practice and learning where i fall short.

where do i start?
what test and test details do i need to know to take + pass each exam?
what order should i take them in?

hints about what should be my 1st sql exam, 2nd exam... would really be great.

thanks all!!!
",2
8795169,01/09/2012 21:02:16,909170,08/24/2011 08:07:51,1,1,Export Data id failed after success,"For some reason, the id is not anymore primary and incrementing after exporting the data to another database. 
What is the solutions and i cant edit it by hand, it is a quite big database.",sql-server,data,export,bugs,,01/10/2012 09:06:26,not a real question,1,35,6,"Export Data id failed after success For some reason, the id is not anymore primary and incrementing after exporting the data to another database. 
What is the solutions and i cant edit it by hand, it is a quite big database.",4
8285743,11/27/2011 13:02:40,740144,05/05/2011 14:29:07,45,0,Database schema learning tools?,"There are quite often the situations when you enter a new development team to start 
working with them on the project which has been developing for many years.

I was just wondering how a new employee may approach to the new environment to learn 
the system as fast as it is possible.

Let's focus on the database part of the common 3 tier application solution.
I was just wondering if there are refactoring tools, which (based on tables relations) can
create for me groups of tables self connected. I could just then examine each group, their relations and the content. 

I know there are database refactoring tools, but try to imagine huge database. You select all tables, the program draws tables, relations and you have a big mess on the screen (even if you layout the project)

I imagine that database schema create a huge tree, with 1 or more roots. I think that starting with leaf elements(without any child), going up the tree, would be an ideal solution. But it is just a thought off the top of my head.

What do think about it? How do you approach to such task?

Thanks

",sql-server,database-design,,,,11/27/2011 16:15:42,not constructive,1,187,4,"Database schema learning tools? There are quite often the situations when you enter a new development team to start 
working with them on the project which has been developing for many years.

I was just wondering how a new employee may approach to the new environment to learn 
the system as fast as it is possible.

Let's focus on the database part of the common 3 tier application solution.
I was just wondering if there are refactoring tools, which (based on tables relations) can
create for me groups of tables self connected. I could just then examine each group, their relations and the content. 

I know there are database refactoring tools, but try to imagine huge database. You select all tables, the program draws tables, relations and you have a big mess on the screen (even if you layout the project)

I imagine that database schema create a huge tree, with 1 or more roots. I think that starting with leaf elements(without any child), going up the tree, would be an ideal solution. But it is just a thought off the top of my head.

What do think about it? How do you approach to such task?

Thanks

",2
6465522,06/24/2011 08:53:08,653622,03/10/2011 13:33:09,450,4,what is the default concurrency control that sql server 2005 uses?,"I'm getting conflicting answers for this question. I get an answer that SQL Server 2005 uses pessimistic concurrency control as default [here][1], but this answer gets refuted [here][2] (see the second reponse) that SQL Server does not have any default concurrency control and it merely gives the mechanisms to implement either an optimistic or pessimistic concurrency control. Whom should i believe and can some one substantiate their answer with an authoritative source. 
 
Thanks in anticipation.


  [1]: http://stackoverflow.com/questions/6459198/default-concurrency-control-for-sql-server-2005
  [2]: http://stackoverflow.com/questions/6459433/which-concurrency-control-is-more-efficient-pessimistic-or-optimistic-concurrency",sql-server,concurrency,,,,,open,0,82,11,"what is the default concurrency control that sql server 2005 uses? I'm getting conflicting answers for this question. I get an answer that SQL Server 2005 uses pessimistic concurrency control as default [here][1], but this answer gets refuted [here][2] (see the second reponse) that SQL Server does not have any default concurrency control and it merely gives the mechanisms to implement either an optimistic or pessimistic concurrency control. Whom should i believe and can some one substantiate their answer with an authoritative source. 
 
Thanks in anticipation.


  [1]: http://stackoverflow.com/questions/6459198/default-concurrency-control-for-sql-server-2005
  [2]: http://stackoverflow.com/questions/6459433/which-concurrency-control-is-more-efficient-pessimistic-or-optimistic-concurrency",2
2216630,02/07/2010 10:07:34,157247,08/16/2009 11:00:22,6473,253,How can I get the # of rows affected by a statement using ADO with JavaScript?,"I'm using [ADO][1] in a JScript (Microsoft JavaScript dialect) Windows Scripting Host script to update a SQL Server table. I'd like to get the number of rows affected by the update in the script, but JavaScript doesn't have pass-by-reference and so I can't do the usual thing where I receive the records affected from the [`Command#Execute`][2] function's *RecordsAffected* argument. So I'm looking for the best way to get that info.

For reasons not related directly to this query, I want to avoid using a stored procedure for this although I realize that that *would* work (I'd just return `@@rowcount` out of the SP). I'm trying to find a reliable but simple non-SP means of doing it.

I looked around and found this syntax for the statement:

    UPDATE MyTable
    SET MyColumn = (blah blah blah)
    WHERE (blah blah blah) ;
    SELECT @@rowcount as 'RowsAffected'

...which sends me back a one-row `ResultSet` containing the count. That does seem to work, and in my limited testing seems to work correctly (I don't get the wrong count when other operations are also happening, etc.), but it seems...kludgy for some reason.

Is that the best way to do it, given the perhaps-unreasonable constraints I've listed? Cross-platform solutions are not required (welcome, though, as always), it can be Microsoft SQL Server-specific (2005+).

Thanks in advance.


  [1]: http://msdn.microsoft.com/en-us/library/ms675532(VS.85).aspx
  [2]: http://msdn.microsoft.com/en-us/library/ms681559(VS.85).aspx",sql-server,ado,,,,,open,0,232,16,"How can I get the # of rows affected by a statement using ADO with JavaScript? I'm using [ADO][1] in a JScript (Microsoft JavaScript dialect) Windows Scripting Host script to update a SQL Server table. I'd like to get the number of rows affected by the update in the script, but JavaScript doesn't have pass-by-reference and so I can't do the usual thing where I receive the records affected from the [`Command#Execute`][2] function's *RecordsAffected* argument. So I'm looking for the best way to get that info.

For reasons not related directly to this query, I want to avoid using a stored procedure for this although I realize that that *would* work (I'd just return `@@rowcount` out of the SP). I'm trying to find a reliable but simple non-SP means of doing it.

I looked around and found this syntax for the statement:

    UPDATE MyTable
    SET MyColumn = (blah blah blah)
    WHERE (blah blah blah) ;
    SELECT @@rowcount as 'RowsAffected'

...which sends me back a one-row `ResultSet` containing the count. That does seem to work, and in my limited testing seems to work correctly (I don't get the wrong count when other operations are also happening, etc.), but it seems...kludgy for some reason.

Is that the best way to do it, given the perhaps-unreasonable constraints I've listed? Cross-platform solutions are not required (welcome, though, as always), it can be Microsoft SQL Server-specific (2005+).

Thanks in advance.


  [1]: http://msdn.microsoft.com/en-us/library/ms675532(VS.85).aspx
  [2]: http://msdn.microsoft.com/en-us/library/ms681559(VS.85).aspx",2
8327141,11/30/2011 14:03:57,954351,09/20/2011 08:50:42,1,0,Select statement in trigger sql server,"How to select inserted row first column value in after insert trigger?
I have a table i created a trigger for after insert i want to get inserted row first column value in that trigger.",sql-server,,,,,11/30/2011 21:01:11,not a real question,1,34,6,"Select statement in trigger sql server How to select inserted row first column value in after insert trigger?
I have a table i created a trigger for after insert i want to get inserted row first column value in that trigger.",1
3625588,09/02/2010 09:01:50,193655,10/21/2009 08:29:52,394,6,Tool for finding the database bottlenecks in sql server,"I would like a tool that monitors sql server while I test my application. THe applicatino will of course run different queries.

From the tool I would like an output like:
- this query was slow because index is missing on this field

and this kind of info.

But I'd like to have a way to highlight crucial data, there can be for example 100 index missing, but 99 of them would improve the performance of 0.05%, while one of those would give a 6000% benefit on a query. So Highlighting hot spots is important too.

Also a commercial product (with full features - no limited - trial) is desired.",sql-server,profiling,,,,,open,0,105,9,"Tool for finding the database bottlenecks in sql server I would like a tool that monitors sql server while I test my application. THe applicatino will of course run different queries.

From the tool I would like an output like:
- this query was slow because index is missing on this field

and this kind of info.

But I'd like to have a way to highlight crucial data, there can be for example 100 index missing, but 99 of them would improve the performance of 0.05%, while one of those would give a 6000% benefit on a query. So Highlighting hot spots is important too.

Also a commercial product (with full features - no limited - trial) is desired.",2
6009682,05/15/2011 16:28:05,754637,05/15/2011 16:25:48,1,0,"copie d""une table vers une autre base","Salut,

Je veux faire une copie des tables a partir d’une base de donnée (sqlserver) vers une autre base (sqlCompact) quelque table une copie du structure du table seulement et d’autres table avec les donnée existante dans la table.
J’ai trouvé la requête 
SELECT * 
INTO NewTable
FROM old_table
WHERE 1 = 2*

Mais elle fonctionne seulement si la base existe dans le meme server !!",sql-server,database,,,,05/15/2011 16:47:34,too localized,1,61,7,"copie d""une table vers une autre base Salut,

Je veux faire une copie des tables a partir d’une base de donnée (sqlserver) vers une autre base (sqlCompact) quelque table une copie du structure du table seulement et d’autres table avec les donnée existante dans la table.
J’ai trouvé la requête 
SELECT * 
INTO NewTable
FROM old_table
WHERE 1 = 2*

Mais elle fonctionne seulement si la base existe dans le meme server !!",2
11620334,07/23/2012 20:52:31,1546943,07/23/2012 20:50:56,1,0,signalr on appharbor dont work,"Request path

/signalr/send?transport=serverSentEvents&connectionId=6b4bba11-ed23-4a04-bd72-90788c9758f2

Commit id

c3198b651813231f615d2cd4b1badbcedce67311

Message

An unhandled exception has occurred.

Exceptions

[NullReferenceException: Object reference not set to an instance of an object.]
   at SignalR.Hubs.HubDispatcher.OnReceivedAsync(IRequest request, String connectionId, String data)
   at SignalR.PersistentConnection.<>c__DisplayClass6.<ProcessRequestAsync>b__4(String data)
   at SignalR.Transports.ForeverTransport.ProcessSendRequest()
   at SignalR.Transports.ForeverTransport.ProcessRequestCore(ITransportConnection connection)
   at SignalR.Transports.ForeverTransport.ProcessRequest(ITransportConnection connection)
   at SignalR.PersistentConnection.ProcessRequestAsync(HostContext context)
   at SignalR.Hubs.HubDispatcher.ProcessRequestAsync(HostContext context)
   at SignalR.Hosting.AspNet.AspNetHandler.ProcessRequestAsync(HttpContextBase context)
   at SignalR.Hosting.AspNet.HttpTaskAsyncHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)",sql-server,asp.net-mvc,signalr,appharbor,,07/24/2012 03:41:41,not a real question,1,80,5,"signalr on appharbor dont work Request path

/signalr/send?transport=serverSentEvents&connectionId=6b4bba11-ed23-4a04-bd72-90788c9758f2

Commit id

c3198b651813231f615d2cd4b1badbcedce67311

Message

An unhandled exception has occurred.

Exceptions

[NullReferenceException: Object reference not set to an instance of an object.]
   at SignalR.Hubs.HubDispatcher.OnReceivedAsync(IRequest request, String connectionId, String data)
   at SignalR.PersistentConnection.<>c__DisplayClass6.<ProcessRequestAsync>b__4(String data)
   at SignalR.Transports.ForeverTransport.ProcessSendRequest()
   at SignalR.Transports.ForeverTransport.ProcessRequestCore(ITransportConnection connection)
   at SignalR.Transports.ForeverTransport.ProcessRequest(ITransportConnection connection)
   at SignalR.PersistentConnection.ProcessRequestAsync(HostContext context)
   at SignalR.Hubs.HubDispatcher.ProcessRequestAsync(HostContext context)
   at SignalR.Hosting.AspNet.AspNetHandler.ProcessRequestAsync(HttpContextBase context)
   at SignalR.Hosting.AspNet.HttpTaskAsyncHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)",4
7890125,10/25/2011 13:37:19,237521,12/23/2009 10:51:46,348,29,Connect Sharepoint 2010 (external content type) to MSSQL Linked Server,"I can't seem to connect to my linked server database from within the external content type definition screen in Microsoft Sharepoint 2010.

When I access my Linked Server from with SQL Server Management Studio, it works fine:

    SELECT * FROM MyLinkedServer.MyCatalog.MyDatabase.MyTable

returns all the records just fine.

But in Sharepoint I choose ""External Content Type"", i create one; On the next screen I click ""External system, click here to detect external datasources .."" (or something similiar).
- Add connect/datasource
  * Datasourcetype: SQL server
  * Databaseserver: MySQLServerIP\InstanceName (ex. 192.168.1.2\SQLEXPRESS)
  * Databasename: MyLinkedServer.MyCatalog.MyDatabase (ex. AS400.COMPANY1.ERPSYS)
  * Name (optional): <Empty>
  * Select 'Connect using the user-id (first option)'
- OK.

ERROR:
> Cannot connect to the LobSystem (external system) Cannot open database
> ""AS400.COMPANY1.ERPSYS requested by the login. The login failed. Login
> failed for user 'MYDOMAIN\me'.

I use the same user for SQL Management studio and Sharepoint. I should have permission to access the Linked Server. I've set the specific credentials for the Linked Server for MYDOMAIN\me.

Any ideas?",sql-server,sharepoint2010,sharepoint-designer,sql-server-2008-express,,,open,0,164,10,"Connect Sharepoint 2010 (external content type) to MSSQL Linked Server I can't seem to connect to my linked server database from within the external content type definition screen in Microsoft Sharepoint 2010.

When I access my Linked Server from with SQL Server Management Studio, it works fine:

    SELECT * FROM MyLinkedServer.MyCatalog.MyDatabase.MyTable

returns all the records just fine.

But in Sharepoint I choose ""External Content Type"", i create one; On the next screen I click ""External system, click here to detect external datasources .."" (or something similiar).
- Add connect/datasource
  * Datasourcetype: SQL server
  * Databaseserver: MySQLServerIP\InstanceName (ex. 192.168.1.2\SQLEXPRESS)
  * Databasename: MyLinkedServer.MyCatalog.MyDatabase (ex. AS400.COMPANY1.ERPSYS)
  * Name (optional): <Empty>
  * Select 'Connect using the user-id (first option)'
- OK.

ERROR:
> Cannot connect to the LobSystem (external system) Cannot open database
> ""AS400.COMPANY1.ERPSYS requested by the login. The login failed. Login
> failed for user 'MYDOMAIN\me'.

I use the same user for SQL Management studio and Sharepoint. I should have permission to access the Linked Server. I've set the specific credentials for the Linked Server for MYDOMAIN\me.

Any ideas?",4
4472628,12/17/2010 16:32:56,177694,09/23/2009 09:45:11,266,22,Invalid Object Name - SQL server 2005,"when executing the following stored procedure i get Invalid Object Name dbo.Approved. The object dbo.Approved does exist, so presumably this is something to do with the way i pass the table name in as the parameter?

   

 
 


`ALTER PROCEDURE [dbo].[sp_Updater]
 
 @tableName as nvarchar(100)
AS
 BEGIN
 
EXEC('

UPDATE T1
SET T1.NPTid = dbo.Locations.NPT_ID
FROM '  + '[' + @tableName +  '] As T1
INNER JOIN dbo.Locations  ON T1.Where_Committed = dbo.Locations.Location_Name
')

END`",sql-server,stored-procedures,,,,,open,0,71,7,"Invalid Object Name - SQL server 2005 when executing the following stored procedure i get Invalid Object Name dbo.Approved. The object dbo.Approved does exist, so presumably this is something to do with the way i pass the table name in as the parameter?

   

 
 


`ALTER PROCEDURE [dbo].[sp_Updater]
 
 @tableName as nvarchar(100)
AS
 BEGIN
 
EXEC('

UPDATE T1
SET T1.NPTid = dbo.Locations.NPT_ID
FROM '  + '[' + @tableName +  '] As T1
INNER JOIN dbo.Locations  ON T1.Where_Committed = dbo.Locations.Location_Name
')

END`",2
5356621,03/18/2011 19:00:47,497999,11/05/2010 04:31:38,6,0,"mssql, I need to set a varchar = every field in a row, delineated by a character","I have a table that has 4 rows, the first to ID them, and the other 3 to store data.

E.G.

    ID ROW1 ROW2 ROW3
    1  AB   EF   NG  
    2  CD   GH   OU
    3       JK
    4       LH

I have three variables, let's say, @return1, @return2, and @return3, and I want to set them equal to every value in rows 1, 2, and 3, delineating the values by ';'.

E.G.

    [some code here that I'm having trouble figuring out, this is what I need help with

Produces this result:

    @return1 = AB; CD;
    @return2 = EF; GH; JK; LH;
    @return3 = NG; OU;

Thanks so much for looking! I'm sure there is an easy and elegant way to loop through each row and accomplish this, I'm just having a bit of a time figuring out the right way to do this.

If anyone could point me in the right direction about how to do this select, or how to loop through these, that would be excellent!",sql-server,stored-procedures,,,,,open,0,210,17,"mssql, I need to set a varchar = every field in a row, delineated by a character I have a table that has 4 rows, the first to ID them, and the other 3 to store data.

E.G.

    ID ROW1 ROW2 ROW3
    1  AB   EF   NG  
    2  CD   GH   OU
    3       JK
    4       LH

I have three variables, let's say, @return1, @return2, and @return3, and I want to set them equal to every value in rows 1, 2, and 3, delineating the values by ';'.

E.G.

    [some code here that I'm having trouble figuring out, this is what I need help with

Produces this result:

    @return1 = AB; CD;
    @return2 = EF; GH; JK; LH;
    @return3 = NG; OU;

Thanks so much for looking! I'm sure there is an easy and elegant way to loop through each row and accomplish this, I'm just having a bit of a time figuring out the right way to do this.

If anyone could point me in the right direction about how to do this select, or how to loop through these, that would be excellent!",2
914627,05/27/2009 08:38:01,335036,10/06/2008 18:02:50,404,12,Scheduled Task or Service for Routine Database Job in C#?,"I've got a web server and a database server, and I'd like to run a job that uses an existing C# DLL to access the database and perform some calculations.

Is the simplest method to create a console app in C# and schedule it on the web server (app server) to run against the DB server?

I see SSIS as an option, but I don't know that well, so I thought a console app scheduled as a task would be best.

What do you think? ",sql-server,clr,task,scheduled,csharp,,open,0,83,10,"Scheduled Task or Service for Routine Database Job in C#? I've got a web server and a database server, and I'd like to run a job that uses an existing C# DLL to access the database and perform some calculations.

Is the simplest method to create a console app in C# and schedule it on the web server (app server) to run against the DB server?

I see SSIS as an option, but I don't know that well, so I thought a console app scheduled as a task would be best.

What do you think? ",5
6181930,05/31/2011 00:52:44,192727,10/19/2009 22:25:42,364,9,Backing up a sql server database with files on local disk,"I am working on a .NET based file centralizing system which keeps all the files in a folder on the local hard drive and all the file metadata in a SQL server 2008 database. 

I am wondering what is the best way to implement backup/restore functionality for the system? Does Sql server 2008 have any feature out-of-box that I can use?

Thanks,",sql-server,,,,,05/31/2011 12:20:19,off topic,1,61,11,"Backing up a sql server database with files on local disk I am working on a .NET based file centralizing system which keeps all the files in a folder on the local hard drive and all the file metadata in a SQL server 2008 database. 

I am wondering what is the best way to implement backup/restore functionality for the system? Does Sql server 2008 have any feature out-of-box that I can use?

Thanks,",1
873924,05/17/2009 04:48:21,108318,05/17/2009 04:37:11,1,0,Can't connect to MSSQL Server 2005,"I just installed MSSQL Server 2005 on my machine and now I am trying to connect to it via SQuirrel SQL, but I am unfortunately running into problems.

When installing MSSQL Server 2005 I chose mixed mode for authentication and I have set up a new user account with which I am trying to connect. I also have installed the Microsoft MSSQL Server JDBC Driver and I have successfully used SQuirrel SQL to connect to a remote server before. 

Currently I am trying to connect to my database by specifying 

jdbc:sqlserver://localhost:1433

for the URL and selecting Microsoft MSSQL Server JDBC Driver.

After entering my username and password I am getting the following error:

test: The TCP/IP connection to the host  has failed. 
java.net.ConnectException: Connection refused: connect

with the following stack trace:

com.microsoft.sqlserver.jdbc.SQLServerException: The TCP/IP connection to the host  has failed. java.net.ConnectException: Connection refused: connect
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(Unknown Source)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(Unknown Source)
	at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(Unknown Source)
	at net.sourceforge.squirrel_sql.fw.sql.SQLDriverManager.getConnection(SQLDriverManager.java:133)
	at net.sourceforge.squirrel_sql.client.mainframe.action.OpenConnectionCommand.execute(OpenConnectionCommand.java:97)
	at net.sourceforge.squirrel_sql.client.mainframe.action.ConnectToAliasCommand$SheetHandler.run(ConnectToAliasCommand.java:279)
	at net.sourceforge.squirrel_sql.fw.util.TaskExecuter.run(TaskExecuter.java:82)
	at java.lang.Thread.run(Unknown Source)

One last thing, I have checked to make sure TCP/IP connections and named pipes are enabled in the SQL Server Configuration Manager.

If anyone has any thoughts on my problem I would be very grateful to hear them. Thanks.",sql-server,sql,database,connection,,,open,0,189,6,"Can't connect to MSSQL Server 2005 I just installed MSSQL Server 2005 on my machine and now I am trying to connect to it via SQuirrel SQL, but I am unfortunately running into problems.

When installing MSSQL Server 2005 I chose mixed mode for authentication and I have set up a new user account with which I am trying to connect. I also have installed the Microsoft MSSQL Server JDBC Driver and I have successfully used SQuirrel SQL to connect to a remote server before. 

Currently I am trying to connect to my database by specifying 

jdbc:sqlserver://localhost:1433

for the URL and selecting Microsoft MSSQL Server JDBC Driver.

After entering my username and password I am getting the following error:

test: The TCP/IP connection to the host  has failed. 
java.net.ConnectException: Connection refused: connect

with the following stack trace:

com.microsoft.sqlserver.jdbc.SQLServerException: The TCP/IP connection to the host  has failed. java.net.ConnectException: Connection refused: connect
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(Unknown Source)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.connect(Unknown Source)
	at com.microsoft.sqlserver.jdbc.SQLServerDriver.connect(Unknown Source)
	at net.sourceforge.squirrel_sql.fw.sql.SQLDriverManager.getConnection(SQLDriverManager.java:133)
	at net.sourceforge.squirrel_sql.client.mainframe.action.OpenConnectionCommand.execute(OpenConnectionCommand.java:97)
	at net.sourceforge.squirrel_sql.client.mainframe.action.ConnectToAliasCommand$SheetHandler.run(ConnectToAliasCommand.java:279)
	at net.sourceforge.squirrel_sql.fw.util.TaskExecuter.run(TaskExecuter.java:82)
	at java.lang.Thread.run(Unknown Source)

One last thing, I have checked to make sure TCP/IP connections and named pipes are enabled in the SQL Server Configuration Manager.

If anyone has any thoughts on my problem I would be very grateful to hear them. Thanks.",4
11741211,07/31/2012 13:27:33,389200,07/12/2010 05:12:35,723,6,SQL Server Stored Procedure solution,"I have stored procedure which return me two columns Start and end dates. what will be stored procedure to convert into distinct   dates list which include all of the dates in between as well. 


    Examples of Events:
          StartDate          EndDate    
    •	1/2/2012 6:00   -   1/2/2012 9:00 
    •	1/2/2012 11:00  -   1/2/2012 19:00  
    •	1/1/2012 11:00  -   1/5/2012 19:00  
    •	1/7/2012 11:00  -   1/8/2012 19:00  
    •	1/11/2012 11:00 -   1/11/2012 19:00  
        
    Result:
        •	1/1/2012 
        •	1/2/2012 
        •	1/3/2012 
        •	1/4/2012 
        •	1/5/2012 
        •	1/7/2012 
        •	1/8/2012 
        •	1/11/2012 

",sql-server,stored-procedures,,,,07/31/2012 14:19:55,not a real question,1,215,5,"SQL Server Stored Procedure solution I have stored procedure which return me two columns Start and end dates. what will be stored procedure to convert into distinct   dates list which include all of the dates in between as well. 


    Examples of Events:
          StartDate          EndDate    
    •	1/2/2012 6:00   -   1/2/2012 9:00 
    •	1/2/2012 11:00  -   1/2/2012 19:00  
    •	1/1/2012 11:00  -   1/5/2012 19:00  
    •	1/7/2012 11:00  -   1/8/2012 19:00  
    •	1/11/2012 11:00 -   1/11/2012 19:00  
        
    Result:
        •	1/1/2012 
        •	1/2/2012 
        •	1/3/2012 
        •	1/4/2012 
        •	1/5/2012 
        •	1/7/2012 
        •	1/8/2012 
        •	1/11/2012 

",2
7154742,08/22/2011 23:23:54,61305,02/01/2009 23:01:11,9435,442,How do I get date/time information from a TIMESTAMP column?,"It seems that the TIMESTAMP information is encrypted in some way, where the date/time data is somehow encoded in binary. I just want to discover all the rows that were modified today.",sql-server,sql-server-2008,,,,,open,0,32,10,"How do I get date/time information from a TIMESTAMP column? It seems that the TIMESTAMP information is encrypted in some way, where the date/time data is somehow encoded in binary. I just want to discover all the rows that were modified today.",2
7831714,10/20/2011 05:57:53,888181,08/10/2011 15:11:17,55,5,TABLES With Same Column Name,"I have 10 tables and each table have 10 columns with similar Name so is there anyway to write   

   SELECT query so that i do not have to repeatedly write column name?  ",sql-server,,,,,11/13/2011 12:16:47,not a real question,1,39,5,"TABLES With Same Column Name I have 10 tables and each table have 10 columns with similar Name so is there anyway to write   

   SELECT query so that i do not have to repeatedly write column name?  ",1
9728568,03/15/2012 21:37:20,226376,12/07/2009 13:46:52,840,18,Cannot create assembly on SQL Server from CLR dll,"In SQL Server 2008R2, I am trying to create a basic CLR User Defined Function.  My C# code is:

    using Microsoft.SqlServer.Server;

    namespace TestClrStoredProc {
        public static class ClrClass1 {

            [SqlFunction]
            public static int TestFn1() {
                return 42;
            }
        }
    }

It is being compiled as a Class Library under the .NET 4.0 framework.

executing `select * from sys.dm_clr_properties` results in:

    name       value
    ---------- ------------------------------------------------
    directory  C:\Windows\Microsoft.NET\Framework\v4.0.30319\ 
    version    v4.0.30319 
    state      CLR is initialized

I have executed:

    sp_configure 'show advanced options', 1;
    GO
    RECONFIGURE;
    GO
    sp_configure 'clr enabled', 1;
    GO
    RECONFIGURE;
    GO

and it is set to ""1"".

Whenever I execute:

    create assembly TestAssembly1 
    from 'B:\TestApplication\TestClrStoredProc\bin\Debug\TestClrStoredProc.dll'

I get:

**Failed to create AppDomain ""MyDatabaseName.dbo[ddl].1"". 
Method's type signature is not Interop compatible.**

Any ideas what the problem could be?

Thanks for any help.",sql-server,sql-server-2008,tsql,clr,,,open,0,255,9,"Cannot create assembly on SQL Server from CLR dll In SQL Server 2008R2, I am trying to create a basic CLR User Defined Function.  My C# code is:

    using Microsoft.SqlServer.Server;

    namespace TestClrStoredProc {
        public static class ClrClass1 {

            [SqlFunction]
            public static int TestFn1() {
                return 42;
            }
        }
    }

It is being compiled as a Class Library under the .NET 4.0 framework.

executing `select * from sys.dm_clr_properties` results in:

    name       value
    ---------- ------------------------------------------------
    directory  C:\Windows\Microsoft.NET\Framework\v4.0.30319\ 
    version    v4.0.30319 
    state      CLR is initialized

I have executed:

    sp_configure 'show advanced options', 1;
    GO
    RECONFIGURE;
    GO
    sp_configure 'clr enabled', 1;
    GO
    RECONFIGURE;
    GO

and it is set to ""1"".

Whenever I execute:

    create assembly TestAssembly1 
    from 'B:\TestApplication\TestClrStoredProc\bin\Debug\TestClrStoredProc.dll'

I get:

**Failed to create AppDomain ""MyDatabaseName.dbo[ddl].1"". 
Method's type signature is not Interop compatible.**

Any ideas what the problem could be?

Thanks for any help.",4
9629770,03/09/2012 06:17:39,1097802,12/14/2011 12:42:06,3,0,"Sql Where, order by, having and groupby query","Can i have an example ""SELECT"" query which consist of all where, orderby, having and groupby clauses....

the explanation will be helpful.",sql-server,,,,,03/09/2012 06:30:33,not a real question,1,21,8,"Sql Where, order by, having and groupby query Can i have an example ""SELECT"" query which consist of all where, orderby, having and groupby clauses....

the explanation will be helpful.",1
7431582,09/15/2011 13:22:56,589131,01/25/2011 14:27:10,631,42,SQL Server Agent Job Notify multiple operators on failure,"I have a Job setup in SQL Server 2008 which sends a notification email to <b>one</b> operator when the job fails.  

<b>Question: Is it possible to setup a notification email being sent to multiple operators for that specific job?</b>  

I believe a possible workaround for this is to create lots of alerts for the database for each given severity but I was hoping that there was a more concise way to do this. If I were to go this route, what severity errors would likely be triggered from a failed job? (I don't think I would require all 25 for something like that)  

",sql-server,sql-server-2008,alert,sql-server-agent,,,open,0,107,9,"SQL Server Agent Job Notify multiple operators on failure I have a Job setup in SQL Server 2008 which sends a notification email to <b>one</b> operator when the job fails.  

<b>Question: Is it possible to setup a notification email being sent to multiple operators for that specific job?</b>  

I believe a possible workaround for this is to create lots of alerts for the database for each given severity but I was hoping that there was a more concise way to do this. If I were to go this route, what severity errors would likely be triggered from a failed job? (I don't think I would require all 25 for something like that)  

",4
2516462,03/25/2010 14:47:41,1096640,09/08/2008 13:10:56,537,20,SQL Server database backup: Network Service file access,"When trying to run the following database backup command from my code I get an ""Operating system error 5(Access is denied.)"" error. This is because the log on account for the SQL Server Windows Service is 'Network Service' and that does not have access to right to this folder.

    BACKUP DATABASE [AE3DB] TO DISK = 'c:\AE3\backup\AE3DB.bak'

My question is, from my code how would I go about figuring out where on the C drive 'Network Service' is allowed to right the backup to?

NOTE: This is a distributed application so I cannot easily change the log on for the SQL Server Windows Service to the 'Local System' account that would be able to right to that folder.",sql-server,backup,,,,,open,0,118,8,"SQL Server database backup: Network Service file access When trying to run the following database backup command from my code I get an ""Operating system error 5(Access is denied.)"" error. This is because the log on account for the SQL Server Windows Service is 'Network Service' and that does not have access to right to this folder.

    BACKUP DATABASE [AE3DB] TO DISK = 'c:\AE3\backup\AE3DB.bak'

My question is, from my code how would I go about figuring out where on the C drive 'Network Service' is allowed to right the backup to?

NOTE: This is a distributed application so I cannot easily change the log on for the SQL Server Windows Service to the 'Local System' account that would be able to right to that folder.",2
6129792,05/25/2011 19:30:46,220997,11/29/2009 21:46:23,404,17,Can I use TSQL to query an OLAP database or is MDX required?,"I'm reading a little into data warehouses and OLAP DBs and it's a little unclear if I have to learn MDX to be able to query OLAP databases. Secondly, is SSMS the tool used for querying?

SQL Server 2008 R2 (SSAS 2008)",sql-server,ssas,,,,,open,0,41,13,"Can I use TSQL to query an OLAP database or is MDX required? I'm reading a little into data warehouses and OLAP DBs and it's a little unclear if I have to learn MDX to be able to query OLAP databases. Secondly, is SSMS the tool used for querying?

SQL Server 2008 R2 (SSAS 2008)",2
46439,09/05/2008 18:06:46,300,08/04/2008 13:38:16,1,0,"SQL Server unused, but allocated table space","I have ms sql databases that grow very large. Upon examination I find that there is a bunch of unused space in certain tables. I don't do many physical deletes, so I don't think that its just deleted records. DBCC SHRINK doesn't make the file smaller. But, if I dump the table to a new, empty database, the size goes down about 80%. Instead of the 7gb I have in this table in the current database, I end up with about 1.5gb in the fresh database. Its as if sql server is allocating too much memory. Anyone encountered this before? I'd like to be able to shrink the table by removing unused allocated space without having to create a whole new database.

tia
Don",sql-server,,,,,01/31/2012 19:44:52,too localized,1,122,7,"SQL Server unused, but allocated table space I have ms sql databases that grow very large. Upon examination I find that there is a bunch of unused space in certain tables. I don't do many physical deletes, so I don't think that its just deleted records. DBCC SHRINK doesn't make the file smaller. But, if I dump the table to a new, empty database, the size goes down about 80%. Instead of the 7gb I have in this table in the current database, I end up with about 1.5gb in the fresh database. Its as if sql server is allocating too much memory. Anyone encountered this before? I'd like to be able to shrink the table by removing unused allocated space without having to create a whole new database.

tia
Don",1
11722446,07/30/2012 13:19:57,1067807,11/27/2011 11:43:22,11,0,Merge replication fails on executing query,"My merge replication was working fine this morning. Since an hour or 2 ago, my synchronisation status windows keeps showing this message:

Thread id 3108 will wait for 15 second(s) before retrying the query on Publisher 'MSI-SQL-MAS01'.


Can anyone tell me what's going on? The database is 500Gb in size and it's also pretty heavily used. However, the replication must work, we need to keep the database at the subscriber in sync.

Also this is what I see after a minute or so:

A query executing on Publisher 'MSI-SQL-MAS01' failed because the connection was chosen as the victim in a deadlock. Please rerun the merge process if you still see this error after internal retries by the merge process.

Like I just said, the replication was working fine this morning. I also restarted the merge agent like the error suggested but with no results.

I also tried 

update sysmergepublications set [generation_leveling_threshold] = 0


at both subscriber and publisher database but no luck it seems.. only getting the following error sometimes too:

The merge process is retrying a failed operation made to article 'xx' - Reason: 'The merge process was unable to synchronize the row.'.

Thanks in advance.",sql-server,merge,replication,,,07/30/2012 13:25:50,off topic,1,188,6,"Merge replication fails on executing query My merge replication was working fine this morning. Since an hour or 2 ago, my synchronisation status windows keeps showing this message:

Thread id 3108 will wait for 15 second(s) before retrying the query on Publisher 'MSI-SQL-MAS01'.


Can anyone tell me what's going on? The database is 500Gb in size and it's also pretty heavily used. However, the replication must work, we need to keep the database at the subscriber in sync.

Also this is what I see after a minute or so:

A query executing on Publisher 'MSI-SQL-MAS01' failed because the connection was chosen as the victim in a deadlock. Please rerun the merge process if you still see this error after internal retries by the merge process.

Like I just said, the replication was working fine this morning. I also restarted the merge agent like the error suggested but with no results.

I also tried 

update sysmergepublications set [generation_leveling_threshold] = 0


at both subscriber and publisher database but no luck it seems.. only getting the following error sometimes too:

The merge process is retrying a failed operation made to article 'xx' - Reason: 'The merge process was unable to synchronize the row.'.

Thanks in advance.",3
8267750,11/25/2011 10:33:14,1025915,11/02/2011 15:08:20,92,9,SSRS BIDS 2008 Expression for YEAR part of current system date,"Does anyone know what the expression is to take the YEAR only from the current date in SSRS BIDS 2008. I need this as I have a table grouped on multiple years and I want to FILL the current year in green and leave the rest white.

I am going to use the following expresssion (minus the current year part)

=iif(Fields!Date_year.Value=""_____________"",""SeaGreen"",""White"")

Can anyone help me with this?",sql-server,reporting-services,expression,bids,,,open,0,64,11,"SSRS BIDS 2008 Expression for YEAR part of current system date Does anyone know what the expression is to take the YEAR only from the current date in SSRS BIDS 2008. I need this as I have a table grouped on multiple years and I want to FILL the current year in green and leave the rest white.

I am going to use the following expresssion (minus the current year part)

=iif(Fields!Date_year.Value=""_____________"",""SeaGreen"",""White"")

Can anyone help me with this?",4
2675968,04/20/2010 14:35:17,321185,04/20/2010 10:22:53,1,0,SQL: How can i update a value on a column only if that value is null?,"I have an SQL question which may be basic to some but is confusing me. Here is an example of column names for a table 'Person':
PersonalID, FirstName, LastName, Car, HairColour, FavDrink, FavFood

Let's say that I input the row:
121312, Rayna, Pieterson, BMW123d, Brown, NULL, NULL

Now I want to update the values for this person, but only if the new value is not null, Update:
121312, Rayna, Pieterson, NULL, Blonde, Fanta, NULL

The new row needs to be:
121312, Rayna, Pieterson, BMW123d, Blonde, Fanta, NULL

So I was thinking something along the lines of:
Update Person(PersonalID, FirstName, LastName, Car, HairColour, FavDrink, FavFood) set Car = @Car (where @Car is not null), HairColour = @HairColour (where @HairColour...)... etc.

My only concern is that I can't group all the conditions at the end of the query because it will require all the values to have the same condition. Can't i do something like Update HairColour if @HairColour is not Null",sql-server,mysql,where-clause,update,sql,,open,0,150,16,"SQL: How can i update a value on a column only if that value is null? I have an SQL question which may be basic to some but is confusing me. Here is an example of column names for a table 'Person':
PersonalID, FirstName, LastName, Car, HairColour, FavDrink, FavFood

Let's say that I input the row:
121312, Rayna, Pieterson, BMW123d, Brown, NULL, NULL

Now I want to update the values for this person, but only if the new value is not null, Update:
121312, Rayna, Pieterson, NULL, Blonde, Fanta, NULL

The new row needs to be:
121312, Rayna, Pieterson, BMW123d, Blonde, Fanta, NULL

So I was thinking something along the lines of:
Update Person(PersonalID, FirstName, LastName, Car, HairColour, FavDrink, FavFood) set Car = @Car (where @Car is not null), HairColour = @HairColour (where @HairColour...)... etc.

My only concern is that I can't group all the conditions at the end of the query because it will require all the values to have the same condition. Can't i do something like Update HairColour if @HairColour is not Null",5
8347030,12/01/2011 19:20:17,465175,10/03/2010 13:28:28,1,0,I'm sending a HTML attachment from SQL Server DB Mail. Why does it have the incorrect MIME type?,"When using SQL Server DB Mail to attach an HTML file to a message, the attachment is sent with the incorrect MIME type.  When I attach the file inside Outlook, the MIME type is correct.  Here is the MIME info from Outlook:

    ------_=_NextPart_001_01CCB05C.5F8D1025
    Content-Type: text/html;
    	name=""saved-notepad.html""
    Content-Transfer-Encoding: base64
    Content-Description: saved-notepad.html
    Content-Disposition: attachment;
    	filename=""saved-notepad.html""

Here is the MIME info from SQL Server Database Mail:

    ----boundary_0_132058e8-434b-4ff3-8429-dcd78429bd18
    Content-Type: application/octet-stream; name=saved-notepad.html
    Content-Transfer-Encoding: base64

The files are sent through the same SMTP server.

Why does this happen and what can I do to fix it?  Here is my code:

    EXEC msdb.dbo.sp_send_dbmail
    @profile_name = 'Profile Name',
    @recipients = 'xxxxxxxx@efaxsend.com',
    @blind_copy_recipients= 'xxxxxxx@gmail.com',
    @file_attachments = @HTMLFullPath,
    @subject = 'Estimate Reminder',
    @body = '',
    @body_format = 'html'

You may be wondering why my HTML is an attachment and not in the body of the email.  It's because eFax only support file attachments.",sql-server,sql-server-2005,tsql,mime-types,dbmail,12/02/2011 01:09:43,off topic,1,197,18,"I'm sending a HTML attachment from SQL Server DB Mail. Why does it have the incorrect MIME type? When using SQL Server DB Mail to attach an HTML file to a message, the attachment is sent with the incorrect MIME type.  When I attach the file inside Outlook, the MIME type is correct.  Here is the MIME info from Outlook:

    ------_=_NextPart_001_01CCB05C.5F8D1025
    Content-Type: text/html;
    	name=""saved-notepad.html""
    Content-Transfer-Encoding: base64
    Content-Description: saved-notepad.html
    Content-Disposition: attachment;
    	filename=""saved-notepad.html""

Here is the MIME info from SQL Server Database Mail:

    ----boundary_0_132058e8-434b-4ff3-8429-dcd78429bd18
    Content-Type: application/octet-stream; name=saved-notepad.html
    Content-Transfer-Encoding: base64

The files are sent through the same SMTP server.

Why does this happen and what can I do to fix it?  Here is my code:

    EXEC msdb.dbo.sp_send_dbmail
    @profile_name = 'Profile Name',
    @recipients = 'xxxxxxxx@efaxsend.com',
    @blind_copy_recipients= 'xxxxxxx@gmail.com',
    @file_attachments = @HTMLFullPath,
    @subject = 'Estimate Reminder',
    @body = '',
    @body_format = 'html'

You may be wondering why my HTML is an attachment and not in the body of the email.  It's because eFax only support file attachments.",5
1559354,10/13/2009 10:22:37,5096,09/07/2008 20:25:12,495,31,Adding a new stored procedure to an existing Visual Studio 2008 database project,"I have imported an existing SQL Server 2008 database to a Visual Studio 2008 database project, to version control database objects and perform database code migration. This works fine and I can build and deploy to dev, test, staging, live etc.

Now I want to add a new stored procedure (with a grant statement) to the existing database project and cannot see an ideal way to do this? I can either: -

1. Create the stored procedure in the development database, reverse engineer a script, and “import script” to my Visual Studio project.
2. Create the stored procedure directly in my Visual Studio project, but the grant statement raises an error there, so I will have to manually edit the xml in the “Database.sqlpermissions” script.
3. Create the stored procedure directly in my Visual Studio project. Then add the GRANT statement to the “Script.PostDeployment.sql” file. But now my permissions are spread across two files “Database.sqlpermissions” and “Script.PostDeployment.sql”.

What is the preferred way to add a new stored procedure with a grant statement to an existing Visual Studio 2008 database project?",sql-server,sql-server-2008,visual-studio,visual-studio-2008,visual-studio-2008-db,,open,0,175,13,"Adding a new stored procedure to an existing Visual Studio 2008 database project I have imported an existing SQL Server 2008 database to a Visual Studio 2008 database project, to version control database objects and perform database code migration. This works fine and I can build and deploy to dev, test, staging, live etc.

Now I want to add a new stored procedure (with a grant statement) to the existing database project and cannot see an ideal way to do this? I can either: -

1. Create the stored procedure in the development database, reverse engineer a script, and “import script” to my Visual Studio project.
2. Create the stored procedure directly in my Visual Studio project, but the grant statement raises an error there, so I will have to manually edit the xml in the “Database.sqlpermissions” script.
3. Create the stored procedure directly in my Visual Studio project. Then add the GRANT statement to the “Script.PostDeployment.sql” file. But now my permissions are spread across two files “Database.sqlpermissions” and “Script.PostDeployment.sql”.

What is the preferred way to add a new stored procedure with a grant statement to an existing Visual Studio 2008 database project?",5
5088536,02/23/2011 08:30:11,574348,01/13/2011 14:22:49,23,0,How to execute a dynamically created sql statement,"I wish to drop all the constraints of tables I have.
Since this is not possible in SQL Server, I've created a script (based on something found online) that is creating dynamically the drop statements as a result of a Select:

    SELECT 'ALTER TABLE ' + TABLE_SCHEMA + '.[' + TABLE_NAME + '] DROP CONSTRAINT [' + CONSTRAINT_NAME + ']'
        FROM information_schema.table_constraints
        WHERE CONSTRAINT_TYPE = 'FOREIGN KEY'
        AND TABLE_NAME LIKE 'Old_%''

This done, I can't find how to parse it and execute that in a loop.

My attempt is to create a cursor like this, but I have no clue then to make it executing each line:

    DECLARE @AlterTables nvarchar(2000)
    SET @AlterTables = 'DECLARE Dyn_cursor CURSOR
    FOR SELECT ''ALTER TABLE '' + TABLE_SCHEMA + ''.['' + TABLE_NAME + ''] DROP CONSTRAINT ['' + CONSTRAINT_NAME + '']''
    FROM information_schema.table_constraints
    WHERE CONSTRAINT_TYPE = ''FOREIGN KEY''
    AND TABLE_NAME LIKE ''Old_%'''
    Exec(@AlterTables)
    
    Open Dyn_Cursor 
    	FETCH NEXT FROM Dyn_Cursor INTO @name   
    	WHILE @@FETCH_STATUS = 0   
    BEGIN 
    END
    
    Close Dyn_cursor
    Deallocate Dyn_cursor

Thank you in advance to whom would have a solution for that!

cheers

J.
",sql-server,dynamic,cursor,,,,open,0,256,8,"How to execute a dynamically created sql statement I wish to drop all the constraints of tables I have.
Since this is not possible in SQL Server, I've created a script (based on something found online) that is creating dynamically the drop statements as a result of a Select:

    SELECT 'ALTER TABLE ' + TABLE_SCHEMA + '.[' + TABLE_NAME + '] DROP CONSTRAINT [' + CONSTRAINT_NAME + ']'
        FROM information_schema.table_constraints
        WHERE CONSTRAINT_TYPE = 'FOREIGN KEY'
        AND TABLE_NAME LIKE 'Old_%''

This done, I can't find how to parse it and execute that in a loop.

My attempt is to create a cursor like this, but I have no clue then to make it executing each line:

    DECLARE @AlterTables nvarchar(2000)
    SET @AlterTables = 'DECLARE Dyn_cursor CURSOR
    FOR SELECT ''ALTER TABLE '' + TABLE_SCHEMA + ''.['' + TABLE_NAME + ''] DROP CONSTRAINT ['' + CONSTRAINT_NAME + '']''
    FROM information_schema.table_constraints
    WHERE CONSTRAINT_TYPE = ''FOREIGN KEY''
    AND TABLE_NAME LIKE ''Old_%'''
    Exec(@AlterTables)
    
    Open Dyn_Cursor 
    	FETCH NEXT FROM Dyn_Cursor INTO @name   
    	WHILE @@FETCH_STATUS = 0   
    BEGIN 
    END
    
    Close Dyn_cursor
    Deallocate Dyn_cursor

Thank you in advance to whom would have a solution for that!

cheers

J.
",3
4800473,01/26/2011 00:48:18,113141,05/27/2009 12:53:28,10588,489,Tools for visualising execution xml plans as HTML,Are there any tools / XSLT style sheets around for transforming the XML execution plans returned by Microsoft Visual Studio into HTML?,sql-server,query-execution-plans,,,,,open,0,22,8,Tools for visualising execution xml plans as HTML Are there any tools / XSLT style sheets around for transforming the XML execution plans returned by Microsoft Visual Studio into HTML?,2
7040026,08/12/2011 12:25:50,37055,11/12/2008 19:20:19,5397,415,Is there a proper acronym for Sql Server Express?,"I know that for the full edition of Sql Server it is readily understood as MSSQS or simply SQS, is there a corresponding acronym for the Express edition?",sql-server,sql-server-express,acronym,,,08/12/2011 12:54:03,off topic,1,28,9,"Is there a proper acronym for Sql Server Express? I know that for the full edition of Sql Server it is readily understood as MSSQS or simply SQS, is there a corresponding acronym for the Express edition?",3
5650536,04/13/2011 14:01:03,675114,03/24/2011 14:49:59,3,0,SQL Server stored procedure for randomly assigning survey,"I have to do the following: Select instructors from an existing table, randomly assign them 1 of 4 surveys and enter the instructors and the assigned survey into an existing table (teacherID, surveyID), and finally randomly select 5 of their students and record this into another existing table (studentID and teacherID).

As separate tasks this would be easy...err, easier.

Not having done this before I am trying to figure out the best process. Create a temp table to first store the teachers and then somehow loop (I've never done this in a stored procedure) through that to randomly assign surveys and then insert into the survey table? Create another temp table for randomly selecting the teacher's students then assign that into the survey students table?

Thanks,

James",sql-server,tsql,stored-procedures,,,,open,0,123,8,"SQL Server stored procedure for randomly assigning survey I have to do the following: Select instructors from an existing table, randomly assign them 1 of 4 surveys and enter the instructors and the assigned survey into an existing table (teacherID, surveyID), and finally randomly select 5 of their students and record this into another existing table (studentID and teacherID).

As separate tasks this would be easy...err, easier.

Not having done this before I am trying to figure out the best process. Create a temp table to first store the teachers and then somehow loop (I've never done this in a stored procedure) through that to randomly assign surveys and then insert into the survey table? Create another temp table for randomly selecting the teacher's students then assign that into the survey students table?

Thanks,

James",3
81521,09/17/2008 09:40:10,11436,09/16/2008 07:57:31,51,16,scheduled web synchronization with MS Sql Server 2005,"I have settled a web synchronization between SQLSERVER 2005 as publisher and SQLEXPRESS as suscriber. synchronisation is working fine except that I did not find a way to automate the synchro, which I still have to launch manually through internet explorer. Any idea? ",sql-server,,,,,,open,0,44,8,"scheduled web synchronization with MS Sql Server 2005 I have settled a web synchronization between SQLSERVER 2005 as publisher and SQLEXPRESS as suscriber. synchronisation is working fine except that I did not find a way to automate the synchro, which I still have to launch manually through internet explorer. Any idea? ",1
1062075,06/30/2009 06:45:18,6068,09/12/2008 08:42:06,1882,64,"Why do table names in SQL Server start with ""dbo""?","At least on my local instance, when I create tables, they are all prefixed with ""dbo."". Why is that?",sql-server,,,,,,open,0,19,10,"Why do table names in SQL Server start with ""dbo""? At least on my local instance, when I create tables, they are all prefixed with ""dbo."". Why is that?",1
3967640,10/19/2010 11:00:28,457136,09/24/2010 10:07:33,15,0,Distributed Database Communication,"I am a junior software engineer,I like this site and people in it.So,I want to ask my problems to see your answers and suggestions.Then,please don't mad at me for asking without searching.

My problem is about Distributed database communication(MSSQL Server 2008).In picture,I need a Main Server in center of star topology and other small servers  that holding less data than center.Small servers job is normal web service with small database changes.On the other hand,Main Server should communicate with others periodicly(Once in hour,or twice in a day) and gather distrubited data changes in other small databases.

According to this plan,Main server is trustable,secured and backed up.Here is my question:
I plan to communicate on web services level.Main server should have a methods for controlling and checking databases.Is there any tools for this usage?I am looking forward to your suggestions,visions.

my kind regards and thanks in advance.


![alt text][1]


  [1]: http://i.stack.imgur.com/U09V3.png",sql-server,web-services,distributed-objects,,,,open,0,146,3,"Distributed Database Communication I am a junior software engineer,I like this site and people in it.So,I want to ask my problems to see your answers and suggestions.Then,please don't mad at me for asking without searching.

My problem is about Distributed database communication(MSSQL Server 2008).In picture,I need a Main Server in center of star topology and other small servers  that holding less data than center.Small servers job is normal web service with small database changes.On the other hand,Main Server should communicate with others periodicly(Once in hour,or twice in a day) and gather distrubited data changes in other small databases.

According to this plan,Main server is trustable,secured and backed up.Here is my question:
I plan to communicate on web services level.Main server should have a methods for controlling and checking databases.Is there any tools for this usage?I am looking forward to your suggestions,visions.

my kind regards and thanks in advance.


![alt text][1]


  [1]: http://i.stack.imgur.com/U09V3.png",3
10395335,05/01/2012 08:29:51,1352851,04/24/2012 05:06:31,48,2,How to create job in SQL Server 2005,"This is the error that i cannot fix it.....

Unable to cast object of type 'Microsoft.SqlServer.Management.Smo.SimpleObjectKey' to type 'Microsoft.SqlServer.Management.Smo.Agent.JobObjectKey'. (Microsoft.SqlServer.Smo)
 

Please, help me...

Thanks you in advance",sql-server,,,,,05/04/2012 11:08:35,not a real question,1,25,8,"How to create job in SQL Server 2005 This is the error that i cannot fix it.....

Unable to cast object of type 'Microsoft.SqlServer.Management.Smo.SimpleObjectKey' to type 'Microsoft.SqlServer.Management.Smo.Agent.JobObjectKey'. (Microsoft.SqlServer.Smo)
 

Please, help me...

Thanks you in advance",1
4000104,10/22/2010 19:07:18,405921,07/29/2010 16:21:19,25,1,QUOTED_IDENTIFIER set wrong on table,"I'm trying to use the XML concatination trick in a query.  but, I'm getting this error:

> SELECT failed because the following
> SET options have incorrect settings:
> 'QUOTED_IDENTIFIER'. Verify that SET
> options are correct for use with
> indexed views and/or indexes on
> computed columns and/or query
> notifications and/or xml data type
> methods.

how/where can I see and change the 'QUOTED_IDENTIFIER' setting for this table?

**duh, i figured it out.**  I had

    SET QUOTED_IDENTIFIER OFF

running before my query",sql-server,sql-server-2005,,,,10/22/2010 19:35:46,not a real question,1,79,5,"QUOTED_IDENTIFIER set wrong on table I'm trying to use the XML concatination trick in a query.  but, I'm getting this error:

> SELECT failed because the following
> SET options have incorrect settings:
> 'QUOTED_IDENTIFIER'. Verify that SET
> options are correct for use with
> indexed views and/or indexes on
> computed columns and/or query
> notifications and/or xml data type
> methods.

how/where can I see and change the 'QUOTED_IDENTIFIER' setting for this table?

**duh, i figured it out.**  I had

    SET QUOTED_IDENTIFIER OFF

running before my query",2
10897029,06/05/2012 12:07:41,1437308,06/05/2012 12:04:31,1,0,How can I determine how many SQL cals I need to buy?,"So nobody at our company tracked this previously.  We are doing a software compliance audit.  How do I audit all of the SQL server installs and determine how many users / devices have connected to the SQL server.  This way I know how many licenses we are short.

I saw some posts somewhat relevant to this but none that give a specific way of determining this information.",sql-server,,,,,06/05/2012 13:30:57,off topic,1,69,12,"How can I determine how many SQL cals I need to buy? So nobody at our company tracked this previously.  We are doing a software compliance audit.  How do I audit all of the SQL server installs and determine how many users / devices have connected to the SQL server.  This way I know how many licenses we are short.

I saw some posts somewhat relevant to this but none that give a specific way of determining this information.",1
11477390,07/13/2012 19:49:38,1524498,07/13/2012 19:43:38,1,0,MSSQL syntax error - MSG 156/MSG 102,"pretty green on MS SQL, and I have been given a query to run on our server. The query keeps popping up the following error:

    Msg 156, Level 15, State 1, Line 2
    Incorrect syntax near the keyword 'as'.
    Msg 102, Level 15, State 1, Line 6
    Incorrect syntax near ','

Can anyone see an issue with the below query?

    RECPT as
    (select PRDOCO, PRDCTO, prlnid, SUM(prarec)/100 AREC, PRCRCD, PRCRR/10000000 RExchng, sum(PRFREC)/100 FAREC
    from PRODDTA.F43121
    where PRMATC = 1 and PRDGL between 112182 and 112195
    group by PRDOCO, PRDCTO, prlnid, PRCRCD, PRCRR/10000000),
    PODet as
    (select pdco, pdan8, abalph, pddoco, pddcto, pdlnid, pdlnty, pdtrdj, pddrqj, pddsc1,
    pdcrcd, pdcrr/10000000 CurRate,
    pdaexp/100 OrigAmt, pdaopn/100 OpenAmt, pdarec/100 RecAmt,
    PDFEC/100 FOrigAmt, PDFAP/100 FOpnAmnt, PDFREC/100 FRecAmt
    from PRODDTA.F4311
    left outer join PRODDTA.F0101 on
    PDAN8 = aban8
    where PDTRDJ < 112183)
    select pdco, pdan8, abalph, pddoco, pddcto, pdlnid, pdlnty, pdtrdj, pddrqj, pddsc1,
    pdcrcd, CurRate, PRCRCD, RExchng,
    OrigAmt, OpenAmt, RecAmt, AREC,
    FOrigAmt, FOpnAmnt, FRecAmt, FAREC
    from PODet
    left outer join RECPT on
    pddoco = PRDOCO and pddcto = PRDCTO and pdlnid = prlnid",sql-server,microsoft,,,,07/16/2012 02:30:49,too localized,1,249,7,"MSSQL syntax error - MSG 156/MSG 102 pretty green on MS SQL, and I have been given a query to run on our server. The query keeps popping up the following error:

    Msg 156, Level 15, State 1, Line 2
    Incorrect syntax near the keyword 'as'.
    Msg 102, Level 15, State 1, Line 6
    Incorrect syntax near ','

Can anyone see an issue with the below query?

    RECPT as
    (select PRDOCO, PRDCTO, prlnid, SUM(prarec)/100 AREC, PRCRCD, PRCRR/10000000 RExchng, sum(PRFREC)/100 FAREC
    from PRODDTA.F43121
    where PRMATC = 1 and PRDGL between 112182 and 112195
    group by PRDOCO, PRDCTO, prlnid, PRCRCD, PRCRR/10000000),
    PODet as
    (select pdco, pdan8, abalph, pddoco, pddcto, pdlnid, pdlnty, pdtrdj, pddrqj, pddsc1,
    pdcrcd, pdcrr/10000000 CurRate,
    pdaexp/100 OrigAmt, pdaopn/100 OpenAmt, pdarec/100 RecAmt,
    PDFEC/100 FOrigAmt, PDFAP/100 FOpnAmnt, PDFREC/100 FRecAmt
    from PRODDTA.F4311
    left outer join PRODDTA.F0101 on
    PDAN8 = aban8
    where PDTRDJ < 112183)
    select pdco, pdan8, abalph, pddoco, pddcto, pdlnid, pdlnty, pdtrdj, pddrqj, pddsc1,
    pdcrcd, CurRate, PRCRCD, RExchng,
    OrigAmt, OpenAmt, RecAmt, AREC,
    FOrigAmt, FOpnAmnt, FRecAmt, FAREC
    from PODet
    left outer join RECPT on
    pddoco = PRDOCO and pddcto = PRDCTO and pdlnid = prlnid",2
11030390,06/14/2012 09:37:18,1126464,01/02/2012 15:34:41,70,4,Select rows based on other rows in same table,"In MSSQL I have a table (let's call it TransList) that looks like:

    TPN    Start    End    TDate                      DoneBy
    10     6        7      2003-03-17 14:48:42.750    User2 *
    10     1        6      2003-03-13 08:02:09.317    User3
    11     3        6      2003-03-21 08:15:45.410    User3 ** yes
    11     6        3      2003-03-13 08:13:13.920    User4 <--
    11     5        6      2003-03-08 17:39:51.460    User4
    12     13       3      2003-03-19 10:58:23.187    User8 *
    12     6        13     2003-03-17 14:48:42.750    User7
    12     3        6      2003-03-13 08:02:09.317    User6
    12     1        3      2003-03-01 14:09:17.167    User1
    13     3        6      2003-03-19 10:58:23.187    User1 *** no
    13     1        3      2003-03-01 14:09:17.167    User2 <--
    14     3        6      2003-03-21 08:15:45.410    User5 ** yes
    14     13       3      2003-03-13 08:13:13.920    User6 <--
    14     6        13     2003-03-08 17:39:51.460    User7
    15     6        3      2003-03-17 14:48:42.750    User2 *
    15     1        6      2003-03-13 08:02:09.317    User3

This is the result of a pretty complex query which joins two separate SELECT statements which joins several tables each. Rows are ordered by `TPN ASC, TDate DESC`.

I would now like to filter this table and obtain:

    TPN    Start    End    TDate                      DoneBy
    10     6        7      2003-03-17 14:48:42.750    User2
    11     3        6      2003-03-21 08:15:45.410    User3
    12     13       3      2003-03-19 10:58:23.187    User8
    14     3        6      2003-03-21 08:15:45.410    User5
    15     6        3      2003-03-17 14:48:42.750    User2

That is:

- the newest transaction for each selected TPN
- TPN is selected based on conditions on its newest transaction and/or its two newest transactions

Rows marked with `*` are there because `(Start=6 and End=7) or (Start=13 and End=3) or (Start=6 and End=3)` therefore I do not care of other transactions for these TPN
Rows marked with `**` are there because `(Start=3 and End=6) and for previous transaction (Start=6 and End=3)`
Rows marked with `***` are <b>not</b> there because `(Start=3 and End=6) but for previous transaction is not (Start=6 and End=3)` 

I might need to further select based on which User did the previous transaction and/or have more complex logical conditions for `*` and `**` (the state machine is complex and I have not yet finished checking it) but `***` is always a `not **`.
I always need to check only the top 2 transactions for each TPN.

I am new to SQL and I spent already a couple of days to try figure out how I can achieve this. I considered self joining TransList, using LIMIT or TOP or walking through the table but I did not manage to make any of this solution work.

Can anyone help?",sql-server,,,,,,open,0,911,9,"Select rows based on other rows in same table In MSSQL I have a table (let's call it TransList) that looks like:

    TPN    Start    End    TDate                      DoneBy
    10     6        7      2003-03-17 14:48:42.750    User2 *
    10     1        6      2003-03-13 08:02:09.317    User3
    11     3        6      2003-03-21 08:15:45.410    User3 ** yes
    11     6        3      2003-03-13 08:13:13.920    User4 <--
    11     5        6      2003-03-08 17:39:51.460    User4
    12     13       3      2003-03-19 10:58:23.187    User8 *
    12     6        13     2003-03-17 14:48:42.750    User7
    12     3        6      2003-03-13 08:02:09.317    User6
    12     1        3      2003-03-01 14:09:17.167    User1
    13     3        6      2003-03-19 10:58:23.187    User1 *** no
    13     1        3      2003-03-01 14:09:17.167    User2 <--
    14     3        6      2003-03-21 08:15:45.410    User5 ** yes
    14     13       3      2003-03-13 08:13:13.920    User6 <--
    14     6        13     2003-03-08 17:39:51.460    User7
    15     6        3      2003-03-17 14:48:42.750    User2 *
    15     1        6      2003-03-13 08:02:09.317    User3

This is the result of a pretty complex query which joins two separate SELECT statements which joins several tables each. Rows are ordered by `TPN ASC, TDate DESC`.

I would now like to filter this table and obtain:

    TPN    Start    End    TDate                      DoneBy
    10     6        7      2003-03-17 14:48:42.750    User2
    11     3        6      2003-03-21 08:15:45.410    User3
    12     13       3      2003-03-19 10:58:23.187    User8
    14     3        6      2003-03-21 08:15:45.410    User5
    15     6        3      2003-03-17 14:48:42.750    User2

That is:

- the newest transaction for each selected TPN
- TPN is selected based on conditions on its newest transaction and/or its two newest transactions

Rows marked with `*` are there because `(Start=6 and End=7) or (Start=13 and End=3) or (Start=6 and End=3)` therefore I do not care of other transactions for these TPN
Rows marked with `**` are there because `(Start=3 and End=6) and for previous transaction (Start=6 and End=3)`
Rows marked with `***` are <b>not</b> there because `(Start=3 and End=6) but for previous transaction is not (Start=6 and End=3)` 

I might need to further select based on which User did the previous transaction and/or have more complex logical conditions for `*` and `**` (the state machine is complex and I have not yet finished checking it) but `***` is always a `not **`.
I always need to check only the top 2 transactions for each TPN.

I am new to SQL and I spent already a couple of days to try figure out how I can achieve this. I considered self joining TransList, using LIMIT or TOP or walking through the table but I did not manage to make any of this solution work.

Can anyone help?",1
11660409,07/25/2012 23:52:38,1553060,07/25/2012 23:11:44,1,0,Microsoft SQL Server Client Statistics - Client vs total processing time,"I am trying to better understand the relationship between client processing time and total processing time.  I've always worked with the thought of reducing all the numbers.  I have recently run into a situation where I can reduce the total processing time but the client processing time is greater.  Is it better or worse to have the client do the work?  If one can push processing to the client, wouldn't that be favorable to having the server do it?  Providing all other stats ( bytes/packets/round trips/total processing time ) stays the same or is lower.

",sql-server,sql-server-2008,tsql,sql-server-2005,,07/27/2012 00:25:39,off topic,1,100,11,"Microsoft SQL Server Client Statistics - Client vs total processing time I am trying to better understand the relationship between client processing time and total processing time.  I've always worked with the thought of reducing all the numbers.  I have recently run into a situation where I can reduce the total processing time but the client processing time is greater.  Is it better or worse to have the client do the work?  If one can push processing to the client, wouldn't that be favorable to having the server do it?  Providing all other stats ( bytes/packets/round trips/total processing time ) stays the same or is lower.

",4
5884235,05/04/2011 13:34:12,557022,12/29/2010 10:44:06,87,3,How good is sql server report server,we are in the middle of implementing a bi solution for a big retail company. They have reports which run on excel as per the moment. Do you think SSRS (Sql server report services) will be a good consideration to replace the excel reports? Also will there be any licencing issues that we/our client may have to face? (At the moment our client has SQL Server 2008 R2 standard edition licence),sql-server,sql-server-2008,reporting-services,business-intelligence,,05/06/2011 11:13:37,not constructive,1,71,7,How good is sql server report server we are in the middle of implementing a bi solution for a big retail company. They have reports which run on excel as per the moment. Do you think SSRS (Sql server report services) will be a good consideration to replace the excel reports? Also will there be any licencing issues that we/our client may have to face? (At the moment our client has SQL Server 2008 R2 standard edition licence),4
3311559,07/22/2010 17:21:54,406143,07/22/2010 16:58:20,1,0,Too many lookup tables ,"What are the adverse effects of having too many lookup tables in the database?

 I have to incorportate too many Enumerations, based on the applications. 

What would experts advice?",sql-server,database-design,enums,,,,open,0,29,5,"Too many lookup tables  What are the adverse effects of having too many lookup tables in the database?

 I have to incorportate too many Enumerations, based on the applications. 

What would experts advice?",3
7398664,09/13/2011 08:09:05,942071,09/13/2011 08:09:05,1,0,"syntax error ""create function ""","CREATE FUNCTION ConvertFromBase  
(  
    @value AS VARCHAR(MAX),  
    @base AS BIGINT  
) RETURNS BIGINT AS BEGIN  
      
    DECLARE @characters CHAR(36),  
            @result BIGINT,  
            @index SMALLINT;  
     
    SELECT @characters = '0123456789abcdefghijklmnopqrstuvwxyz',  
           @result = 0,  
           @index = 0;  
      
    IF @base < 2 OR @base > 36 RETURN NULL;  
     WHILE @index < LEN(@value)  
        SELECT @result = @result + POWER(@base, @index) *   
                         (CHARINDEX  
                            (SUBSTRING(@value, LEN(@value) - @index, 1)  
                            , @characters) - 1  
                         ),  
               @index = @index + 1;  
    -- return the result  
    RETURN @result;  
END 
dbo.ConvertFromBase('nawy fieldaka', 16)
       ",sql-server,,,,,09/13/2011 10:37:16,not a real question,1,334,5,"syntax error ""create function "" CREATE FUNCTION ConvertFromBase  
(  
    @value AS VARCHAR(MAX),  
    @base AS BIGINT  
) RETURNS BIGINT AS BEGIN  
      
    DECLARE @characters CHAR(36),  
            @result BIGINT,  
            @index SMALLINT;  
     
    SELECT @characters = '0123456789abcdefghijklmnopqrstuvwxyz',  
           @result = 0,  
           @index = 0;  
      
    IF @base < 2 OR @base > 36 RETURN NULL;  
     WHILE @index < LEN(@value)  
        SELECT @result = @result + POWER(@base, @index) *   
                         (CHARINDEX  
                            (SUBSTRING(@value, LEN(@value) - @index, 1)  
                            , @characters) - 1  
                         ),  
               @index = @index + 1;  
    -- return the result  
    RETURN @result;  
END 
dbo.ConvertFromBase('nawy fieldaka', 16)
       ",1
9036988,01/27/2012 16:49:44,318535,04/16/2010 13:45:41,405,31,Drop DB using MSBuild even if in use,"I am using the following command in my MSBuild file to drop a database: sqlcmd -E -S <ServerName> -Q ""DROP DATABASE <DBName>"". But sometimes I get the error ""Cannot drop database <DBName> because it is currently in use.""

What command should I use so that the DB is dropped even if it is in use?",sql-server,msbuild,sqlcmd,,,,open,0,54,8,"Drop DB using MSBuild even if in use I am using the following command in my MSBuild file to drop a database: sqlcmd -E -S <ServerName> -Q ""DROP DATABASE <DBName>"". But sometimes I get the error ""Cannot drop database <DBName> because it is currently in use.""

What command should I use so that the DB is dropped even if it is in use?",3
10783422,05/28/2012 10:52:46,1268247,03/14/2012 06:29:16,11,0,How differential back works in sql server,"i just want to know how differential back up works internally in sql server. i know what sort of data the differential back up contain but my question is how sql server knows which page and what data it has to pick for the differential backup.

if this information is stord at the page lavel in the header section then it has to scan all the data pages to find the corrosponding page which is marked for differential backup in this case there is no difference between full and differential back as we have to scan all the pages 

one more thing is the database is in bulk recovery model (in which only the action of the bulk operation is marked in the transaction log not the data itself) then if i take the transaction log how the bulk logged operation data is available when i restore the transaction log 

thanks in advance 
",sql-server,backup,,,,05/28/2012 16:16:27,off topic,1,153,7,"How differential back works in sql server i just want to know how differential back up works internally in sql server. i know what sort of data the differential back up contain but my question is how sql server knows which page and what data it has to pick for the differential backup.

if this information is stord at the page lavel in the header section then it has to scan all the data pages to find the corrosponding page which is marked for differential backup in this case there is no difference between full and differential back as we have to scan all the pages 

one more thing is the database is in bulk recovery model (in which only the action of the bulk operation is marked in the transaction log not the data itself) then if i take the transaction log how the bulk logged operation data is available when i restore the transaction log 

thanks in advance 
",2
8661437,12/28/2011 21:17:48,215541,11/20/2009 15:35:41,348,6,infopath 2010 submitting data sql server 2008,"I am looking to create a form in infopath which can submit data to a SQL Server, I am just wondering how to go about this with infopath i.e. what form template to use, what the problems are etc..

Also is it possible to send i.e. only some of the values from the form to SQL Database and email the rest to someone ?",sql-server,infopath,,,,,open,0,63,7,"infopath 2010 submitting data sql server 2008 I am looking to create a form in infopath which can submit data to a SQL Server, I am just wondering how to go about this with infopath i.e. what form template to use, what the problems are etc..

Also is it possible to send i.e. only some of the values from the form to SQL Database and email the rest to someone ?",2
11362564,07/06/2012 12:50:52,1482953,06/26/2012 13:49:52,18,0,sql server calculation of columns from multiple tables,"    select s.part_no,s.part_name,s.uom,i.Invoice_Quantity,r.Return_Quantity,p.Issue_Quantity,sr.Quantity,rp.Return_Quantity,er.Quantity from dbo.dri_Stock as s left join (select part_no,sum(Invoice_Quantity) as Invoice_Quantity from dbo.dri_InwardEntry where month(_date)=6 and year(_date)=2012 group by part_no ) as i on s.part_no=i.part_no left join (select part_no,sum(Return_Quantity) as Return_Quantity from dbo.dri_ReturnToCustomer where month(date)=6 and year(date)=2012 group by part_no)as  r on s.part_no=r.part_no left join (select part_no,sum(Issue_Quantity) as Issue_Quantity from dbo.dri_IssueToProd where month(date)=6 and year(date)=2012 group by part_no)as p on s.part_no=p.part_no left join (select part_no,sum(Quantity) as Quantity from dbo.dri_ShortReceipt where month(date)=6 and year(date)=2012 group by part_no)as sr on s.part_no=sr.part_no left join (select part_no,sum(Return_Quantity) as Return_Quantity  from dbo.dri_ReceiptFromProd where month(date)=6 and year(date)=2012 group by part_no)as  rp on s.part_no=rp.part_no left join (select part_no,sum(Quantity) as Quantity from dbo.dri_ExcessReceipt where month(date)=6 and year(date)=2012 group by part_no )as er on s.part_no=er.part_no where i.invoice_quantity>0

i want to add a columns in my output i.e **stockBalance**
  how can i do this:
Formula for calculating StockBalance will be **(i.Invoice_Quantity + rp.Return_Quantity + er.Quantity) - (r.Return_Quantity + p.Issue_Quantity + sr.Quantity)** 

Thank You",sql-server,calc,,,,07/06/2012 15:39:16,too localized,1,160,8,"sql server calculation of columns from multiple tables     select s.part_no,s.part_name,s.uom,i.Invoice_Quantity,r.Return_Quantity,p.Issue_Quantity,sr.Quantity,rp.Return_Quantity,er.Quantity from dbo.dri_Stock as s left join (select part_no,sum(Invoice_Quantity) as Invoice_Quantity from dbo.dri_InwardEntry where month(_date)=6 and year(_date)=2012 group by part_no ) as i on s.part_no=i.part_no left join (select part_no,sum(Return_Quantity) as Return_Quantity from dbo.dri_ReturnToCustomer where month(date)=6 and year(date)=2012 group by part_no)as  r on s.part_no=r.part_no left join (select part_no,sum(Issue_Quantity) as Issue_Quantity from dbo.dri_IssueToProd where month(date)=6 and year(date)=2012 group by part_no)as p on s.part_no=p.part_no left join (select part_no,sum(Quantity) as Quantity from dbo.dri_ShortReceipt where month(date)=6 and year(date)=2012 group by part_no)as sr on s.part_no=sr.part_no left join (select part_no,sum(Return_Quantity) as Return_Quantity  from dbo.dri_ReceiptFromProd where month(date)=6 and year(date)=2012 group by part_no)as  rp on s.part_no=rp.part_no left join (select part_no,sum(Quantity) as Quantity from dbo.dri_ExcessReceipt where month(date)=6 and year(date)=2012 group by part_no )as er on s.part_no=er.part_no where i.invoice_quantity>0

i want to add a columns in my output i.e **stockBalance**
  how can i do this:
Formula for calculating StockBalance will be **(i.Invoice_Quantity + rp.Return_Quantity + er.Quantity) - (r.Return_Quantity + p.Issue_Quantity + sr.Quantity)** 

Thank You",2
7068481,08/15/2011 17:43:19,842663,07/13/2011 12:22:22,64,0,I can't connect to sqlserver,"I can't connect to SQL Server Database engine for first time after installation .

I asked it once but marc_s closed that . Really it's my big problem .

Server name is empty . What should i type for this ?

I use it in my personal laptop and i am not professional , It means i want use it just as a tables like access .

Someone help me please .",sql-server,,,,,08/15/2011 18:10:45,off topic,1,68,5,"I can't connect to sqlserver I can't connect to SQL Server Database engine for first time after installation .

I asked it once but marc_s closed that . Really it's my big problem .

Server name is empty . What should i type for this ?

I use it in my personal laptop and i am not professional , It means i want use it just as a tables like access .

Someone help me please .",1
226223,10/22/2008 15:13:52,5055,09/07/2008 15:43:03,281,20,Whats the best way to profile a sqlserver database for performance?,What techinques do you use? How do you find out which jobs take the longest to run? Is there a way to find out the offending applications?,sql-server,bestpractice,optimization,profiling,,,open,0,27,11,Whats the best way to profile a sqlserver database for performance? What techinques do you use? How do you find out which jobs take the longest to run? Is there a way to find out the offending applications?,4
9896320,03/27/2012 19:28:31,68608,02/19/2009 20:37:18,702,12,SQL Server 2012 backward compatibility for backups with 2008,"I have a number of clients with SQL Server 2008 and that's what I have here on my server too. I use backup files to send databases back and forth between clients and at my office.

I have read that when you create a backup from SQL Server 2012 there is no way to restore it onto a 2008 instance. I assumed that the compatibility level would take care of this problem, but it doesn't. Therefore, I am at a loss as to how to upgrade. Other than upgrade all my clients all at once, which is impossible, I can think of no clean way to do this.

I have the need to send a database to a client as well as receive a database from a client. This is my first version upgrade on SQL Server, so I'm new to this problem. Any ideas on how to proceed?",sql-server,,,,,03/28/2012 09:02:40,off topic,1,147,9,"SQL Server 2012 backward compatibility for backups with 2008 I have a number of clients with SQL Server 2008 and that's what I have here on my server too. I use backup files to send databases back and forth between clients and at my office.

I have read that when you create a backup from SQL Server 2012 there is no way to restore it onto a 2008 instance. I assumed that the compatibility level would take care of this problem, but it doesn't. Therefore, I am at a loss as to how to upgrade. Other than upgrade all my clients all at once, which is impossible, I can think of no clean way to do this.

I have the need to send a database to a client as well as receive a database from a client. This is my first version upgrade on SQL Server, so I'm new to this problem. Any ideas on how to proceed?",1
11746039,07/31/2012 17:46:37,511625,11/18/2010 03:34:11,20,1,Partition Key questions in SQL Server 2008,"We are planning to use table partitioning for our database based on an integer column. I have read about it on MSDN at http://msdn.microsoft.com/en-us/library/ms190787.aspx and have few queries.

a) Is it required that partition key be part of primary key? Even if it is not required still would it be of any benefit if it is part of primary key or clustered index?

b) In our case, we would be performing JOIN operation of partitioned tables with non-partitioned master data. Will I loose the performance gained by partition elimination? In general, if any of the tables used in JOIN operation is non-partitioned then will I loose the benefit of Partitioning?

c) Does adding filter criteria in JOIN criteria over Partition key help in any way in partition elimination? Or only the filter criteria in WHERE clause over Partition column is used for Partition elimination?

d) Should partition key be part of non-clustered index?

Thanks in advance.",sql-server,sql-server-2008,sql-server-2008-r2,,,07/31/2012 18:27:22,off topic,1,151,7,"Partition Key questions in SQL Server 2008 We are planning to use table partitioning for our database based on an integer column. I have read about it on MSDN at http://msdn.microsoft.com/en-us/library/ms190787.aspx and have few queries.

a) Is it required that partition key be part of primary key? Even if it is not required still would it be of any benefit if it is part of primary key or clustered index?

b) In our case, we would be performing JOIN operation of partitioned tables with non-partitioned master data. Will I loose the performance gained by partition elimination? In general, if any of the tables used in JOIN operation is non-partitioned then will I loose the benefit of Partitioning?

c) Does adding filter criteria in JOIN criteria over Partition key help in any way in partition elimination? Or only the filter criteria in WHERE clause over Partition column is used for Partition elimination?

d) Should partition key be part of non-clustered index?

Thanks in advance.",3
2809395,05/11/2010 09:17:52,338068,05/11/2010 09:01:39,1,0,What does xp_qv do in SQL Server?,"Last night one of our SQL servers developed some major problems and after a colleague stopped, started, and all the usual things it started checking and rebuilding databases and is now running an extended stored procedure called ""xp_qv"".

The internet seems to be very short of information on what this procedure does or anythign like that so I was hoping somebody here might be able to help.

I should add that I assume it is meant to be running so the question isn't ""Can I stop it"" or anything like that, its just curiosity in what it is doing in the hope that it will help determine how long before things are usable again...",sql-server,sql-server-2000,,,,,open,0,112,7,"What does xp_qv do in SQL Server? Last night one of our SQL servers developed some major problems and after a colleague stopped, started, and all the usual things it started checking and rebuilding databases and is now running an extended stored procedure called ""xp_qv"".

The internet seems to be very short of information on what this procedure does or anythign like that so I was hoping somebody here might be able to help.

I should add that I assume it is meant to be running so the question isn't ""Can I stop it"" or anything like that, its just curiosity in what it is doing in the hope that it will help determine how long before things are usable again...",2
8696710,01/02/2012 01:17:34,938866,09/11/2011 05:24:57,1,0,Will this Stored Procedure slow down in 100k calls a day?,"Will this Stored Procedure slow down in 100k calls a day?
This is my stored procedure:


        SET ANSI_NULLS ON
        GO
        SET QUOTED_IDENTIFIER ON
        GO
        CREATE PROCEDURE [dbo].[StockCardProc]
        (
        @tag CHAR(1),
        @brncode CHAR(4),
        @ddate DATETIME,
        @incode CHAR(14),
        @endqty DECIMAL(10,3),
        @sales DECIMAL(10,3)

        )
        AS
        BEGIN
	        SET NOCOUNT ON
	        DECLARE @loccode CHAR(4)
	        SET @loccode = '0001'

	IF EXISTS( SELECT brn_code FROM dbo.StockCard WHERE brn_code = @brncode AND loc_code = @loccode AND CONVERT(CHAR(10),date,101) = CONVERT(CHAR(10),@ddate,101) AND in_code = @incode)
	BEGIN
	   IF RTRIM(UPPER(@tag)) = 'S'
		BEGIN
			UPDATE dbo.StockCard SET         
			end_qty = end_qty - @endqty
			,sales = sales + @sales
			WHERE brn_code = @brncode
			AND loc_code = @loccode
			AND CONVERT(CHAR(10),date,101) = CONVERT(CHAR(10),@ddate,101)
			AND in_code = @incode		
		END

	   ELSE
		BEGIN
			UPDATE dbo.StockCard SET         
			end_qty = end_qty + @endqty
			,sales = sales - @sales
			WHERE brn_code = @brncode
			AND loc_code = @loccode
			AND CONVERT(CHAR(10),date,101) = CONVERT(CHAR(10),@ddate,101)
			AND in_code = @incode		
		END

	END

	ELSE
	BEGIN
		IF RTRIM(UPPER(@tag)) = 'S'
		 BEGIN
			SET @endqty = 0 - @endqty			
		 END
		ELSE
		 BEGIN
			SET @sales = 0 - @sales
		 END
		DECLARE @begqty DECIMAL(10,3)		
		SET @begqty = (SELECT TOP 1 beg_qty FROM StockCard WHERE brn_code = @brncode AND loc_code = @loccode AND in_code = @incode ORDER BY date DESC)
		INSERT INTO dbo.StockCard (brn_code,loc_code,date,in_code,beg_qty,end_qty,sales) 
         VALUES (@brncode,@loccode,@ddate,@incode,@begqty,@endqty,@sales)        

	END
        END


do i need to add WITH RECOMPILE? or NOT? will this slow down after 100k calls?
im simply using this stored proc for upsert. pls help thanks!  ",sql-server,performance,sql-server-2005,stored-procedures,slowdown,01/02/2012 01:53:53,too localized,1,370,11,"Will this Stored Procedure slow down in 100k calls a day? Will this Stored Procedure slow down in 100k calls a day?
This is my stored procedure:


        SET ANSI_NULLS ON
        GO
        SET QUOTED_IDENTIFIER ON
        GO
        CREATE PROCEDURE [dbo].[StockCardProc]
        (
        @tag CHAR(1),
        @brncode CHAR(4),
        @ddate DATETIME,
        @incode CHAR(14),
        @endqty DECIMAL(10,3),
        @sales DECIMAL(10,3)

        )
        AS
        BEGIN
	        SET NOCOUNT ON
	        DECLARE @loccode CHAR(4)
	        SET @loccode = '0001'

	IF EXISTS( SELECT brn_code FROM dbo.StockCard WHERE brn_code = @brncode AND loc_code = @loccode AND CONVERT(CHAR(10),date,101) = CONVERT(CHAR(10),@ddate,101) AND in_code = @incode)
	BEGIN
	   IF RTRIM(UPPER(@tag)) = 'S'
		BEGIN
			UPDATE dbo.StockCard SET         
			end_qty = end_qty - @endqty
			,sales = sales + @sales
			WHERE brn_code = @brncode
			AND loc_code = @loccode
			AND CONVERT(CHAR(10),date,101) = CONVERT(CHAR(10),@ddate,101)
			AND in_code = @incode		
		END

	   ELSE
		BEGIN
			UPDATE dbo.StockCard SET         
			end_qty = end_qty + @endqty
			,sales = sales - @sales
			WHERE brn_code = @brncode
			AND loc_code = @loccode
			AND CONVERT(CHAR(10),date,101) = CONVERT(CHAR(10),@ddate,101)
			AND in_code = @incode		
		END

	END

	ELSE
	BEGIN
		IF RTRIM(UPPER(@tag)) = 'S'
		 BEGIN
			SET @endqty = 0 - @endqty			
		 END
		ELSE
		 BEGIN
			SET @sales = 0 - @sales
		 END
		DECLARE @begqty DECIMAL(10,3)		
		SET @begqty = (SELECT TOP 1 beg_qty FROM StockCard WHERE brn_code = @brncode AND loc_code = @loccode AND in_code = @incode ORDER BY date DESC)
		INSERT INTO dbo.StockCard (brn_code,loc_code,date,in_code,beg_qty,end_qty,sales) 
         VALUES (@brncode,@loccode,@ddate,@incode,@begqty,@endqty,@sales)        

	END
        END


do i need to add WITH RECOMPILE? or NOT? will this slow down after 100k calls?
im simply using this stored proc for upsert. pls help thanks!  ",5
8634111,12/26/2011 08:31:15,1116057,12/26/2011 08:28:16,1,0,Backup Restore a large Sql server database,"I need to back up a database from one server and need to restore it on another server. Backup file size is more than 20GB. Which is the best way to backup a db-> transfer the .bak file to another server-> and restore that db?


Regards

Animesh",sql-server,,,,,12/29/2011 12:10:42,off topic,1,45,7,"Backup Restore a large Sql server database I need to back up a database from one server and need to restore it on another server. Backup file size is more than 20GB. Which is the best way to backup a db-> transfer the .bak file to another server-> and restore that db?


Regards

Animesh",1
150825,09/29/2008 21:36:38,23360,09/29/2008 06:18:17,11,1,Pentaho vs Microsoft BI Stack,"My company is heavily invested in the MS BI Stack (SQL Server Reporting Services, -Analysis Services and -Integration Services), but I want to have a look at what the seemingly most talked about open-source alternative Pentaho is like.

I've installed a version, and I got it up and running quite painlessly. So that's good. But I haven't really the time to start using it for actual work to get a thorough understanding of the package.

Have any of you got any insights into what are the pros and cons of Pentaho vs MS BI, or any links to such comparisons?

Much appreciated!",sql-server,reporting-services,business-intelligence,analysisservices,pentaho,07/28/2012 01:40:35,not constructive,1,99,5,"Pentaho vs Microsoft BI Stack My company is heavily invested in the MS BI Stack (SQL Server Reporting Services, -Analysis Services and -Integration Services), but I want to have a look at what the seemingly most talked about open-source alternative Pentaho is like.

I've installed a version, and I got it up and running quite painlessly. So that's good. But I haven't really the time to start using it for actual work to get a thorough understanding of the package.

Have any of you got any insights into what are the pros and cons of Pentaho vs MS BI, or any links to such comparisons?

Much appreciated!",5
7509853,09/22/2011 05:14:25,133476,07/06/2009 01:42:49,843,26,How can I find what locks are involved in a process,"I am running a SQL transaction with a bunch of statements in it.

The transaction was causing other processes to deadlock very occasionally, so I removed some of the things from the transaction that weren't really important. These are now done separately before the transaction.

I want to be able to compare the locking that occurs between the SQL before and after my change so that I can be confident the change will make a difference.

I expect more locking occurred before because more things were in the transaction.

Are there any tools that I can use? I can pretty easily get a SQL profile of both cases.

I am aware of things like sp_who, sp_who2, but the thing I struggle with for those things is that this is a snapshot in a particular moment in time. I would like the full picture from start to finish.",sql-server,,,,,,open,0,142,11,"How can I find what locks are involved in a process I am running a SQL transaction with a bunch of statements in it.

The transaction was causing other processes to deadlock very occasionally, so I removed some of the things from the transaction that weren't really important. These are now done separately before the transaction.

I want to be able to compare the locking that occurs between the SQL before and after my change so that I can be confident the change will make a difference.

I expect more locking occurred before because more things were in the transaction.

Are there any tools that I can use? I can pretty easily get a SQL profile of both cases.

I am aware of things like sp_who, sp_who2, but the thing I struggle with for those things is that this is a snapshot in a particular moment in time. I would like the full picture from start to finish.",1
10139880,04/13/2012 11:22:40,1221355,02/20/2012 15:11:55,28,4,Running SQL Server queries from remote computer,"I am novice to SQL Server and Database also. 

we have SQL Server 2008 installed on server. 

I want to run queries from remote computer on the database which is resides in SQL Server 2008. 

I want know that is there any tool/utility so I can install it on my local machine and run queries over database server. 

Any alternate approach would be helpful. ",sql-server,sql-server-2008,sql-server-2005,sql-server-2008-r2,,04/14/2012 12:54:54,not a real question,1,65,7,"Running SQL Server queries from remote computer I am novice to SQL Server and Database also. 

we have SQL Server 2008 installed on server. 

I want to run queries from remote computer on the database which is resides in SQL Server 2008. 

I want know that is there any tool/utility so I can install it on my local machine and run queries over database server. 

Any alternate approach would be helpful. ",4
9121045,02/02/2012 22:34:22,478319,10/17/2010 03:17:13,372,13,Caveats when accessing a MS SQL database that isn't stored on the local machine,"I have experience working with database files, mostly access since that's what my employer used for a while, but now we're transitioning over to MSSQL. Learning to work with this new one isn't very hard, as google is full of useful tutorials and the like, but one important difference is that now the MSSQL database is going to be stored on its own separate server, as opposed to the local mdb files of old.

This is something I've never done before, so I'm wondering if anyone has any general advice about some caveats when dealing with non local databases? Are there specific things I should look out for as opposed to when dealing with a local database? I'm not even sure how to do this yet, and while I'm in the process of reading up on it, if anyone knows of any good tutorials for working with a separate database server for the first time, that'd be very appreciated. ",sql-server,,,,,02/06/2012 18:36:25,off topic,1,159,14,"Caveats when accessing a MS SQL database that isn't stored on the local machine I have experience working with database files, mostly access since that's what my employer used for a while, but now we're transitioning over to MSSQL. Learning to work with this new one isn't very hard, as google is full of useful tutorials and the like, but one important difference is that now the MSSQL database is going to be stored on its own separate server, as opposed to the local mdb files of old.

This is something I've never done before, so I'm wondering if anyone has any general advice about some caveats when dealing with non local databases? Are there specific things I should look out for as opposed to when dealing with a local database? I'm not even sure how to do this yet, and while I'm in the process of reading up on it, if anyone knows of any good tutorials for working with a separate database server for the first time, that'd be very appreciated. ",1
9063611,01/30/2012 12:05:55,388364,07/10/2010 08:55:52,595,9,SQL Server Get Date Field if less than 3 month,I just need a where condition in my select statement where AddedDate is less than or within the 3 month backet. Like Select * FROM My Table where AddedDate DateDiff of DateNow less than 3 months,sql-server,sql-server-2008,,,,,open,0,36,10,SQL Server Get Date Field if less than 3 month I just need a where condition in my select statement where AddedDate is less than or within the 3 month backet. Like Select * FROM My Table where AddedDate DateDiff of DateNow less than 3 months,2
7375070,09/10/2011 22:22:46,457217,09/24/2010 11:32:21,58,2,Wrong character encoding from SQL Server to Rails 3 app on Linux via freetds,"I'm developing an application on MacOS in Ruby 3.0 using SQL Server 2008 R2 as the database.  I'm connecting through freetds and tiny_tds.

When I save a data through a scaffold using extended characters, like ÞþÆæÓó it works fine, the letters are correct when looking at the data in SQL Server Management Studio and when I read the data back into the Rails UI it displays correct.

When I deploy the application on a Linux machine which is also using the freetds and tiny_tds to connect to the same database I get the characters garbled in the UI.  When I save the data via the Linux server the characters are displaying correctly in the browser but when looking at the data in SSMS the characters have been encoded and are unreadable (I enter ÞÞðð) and get this in SSMS:

ÃžÃžÃ°Ã°

This I get in the browser from the Linux server for Suðurnes written into the db from the Mac:

Su�urnes

I have set this line in the database.yml:

encoding: utf8

It didn't change anything.  I also set this line in the freetds.conf file:

client charset = UTF-8

The SQL database has  as the CODEPAGE but I'm pretty sure that is not the fault because it is working correctly from the Mac machine.

I have tested this both on Passenger apache and WEBrick so I don't think it is the apache that is causing this.

So is there any setting on the Linux I have to change to let it behave in similar way as the mac?

Regards,
Johann
",sql-server,linux,ruby-on-rails-3,freetds,,,open,0,248,14,"Wrong character encoding from SQL Server to Rails 3 app on Linux via freetds I'm developing an application on MacOS in Ruby 3.0 using SQL Server 2008 R2 as the database.  I'm connecting through freetds and tiny_tds.

When I save a data through a scaffold using extended characters, like ÞþÆæÓó it works fine, the letters are correct when looking at the data in SQL Server Management Studio and when I read the data back into the Rails UI it displays correct.

When I deploy the application on a Linux machine which is also using the freetds and tiny_tds to connect to the same database I get the characters garbled in the UI.  When I save the data via the Linux server the characters are displaying correctly in the browser but when looking at the data in SSMS the characters have been encoded and are unreadable (I enter ÞÞðð) and get this in SSMS:

ÃžÃžÃ°Ã°

This I get in the browser from the Linux server for Suðurnes written into the db from the Mac:

Su�urnes

I have set this line in the database.yml:

encoding: utf8

It didn't change anything.  I also set this line in the freetds.conf file:

client charset = UTF-8

The SQL database has  as the CODEPAGE but I'm pretty sure that is not the fault because it is working correctly from the Mac machine.

I have tested this both on Passenger apache and WEBrick so I don't think it is the apache that is causing this.

So is there any setting on the Linux I have to change to let it behave in similar way as the mac?

Regards,
Johann
",4
4018793,10/25/2010 20:57:35,335036,10/06/2008 18:02:50,870,20,Get records whose count matches max(count) for a category,"Given the following rows of course,section,grade,count of grades within course section:

    course	SECTION	grade	gradeCount
    1301	001	C	3
    1301	001	C+	3
    1301	001	C-	4
    1301	001	D	5
    1301	001	D+	3
    1301	001	D-	2
    1301	001	F	18
    1301	002	A-	1
    1301	002	B	1
    1301	002	B-	3
    1301	002	C	2

I want to get a list of course/sections with the greatest number of each grade.

For example:

    A | 1301-023 | 75     // 1301-023 had the most A's, 75 of them
    B | 1301-033 | 65     // 1301-034 had the most B's, 65 of them

Ties should appear in the list.

",sql-server,count,group,max,,,open,0,121,9,"Get records whose count matches max(count) for a category Given the following rows of course,section,grade,count of grades within course section:

    course	SECTION	grade	gradeCount
    1301	001	C	3
    1301	001	C+	3
    1301	001	C-	4
    1301	001	D	5
    1301	001	D+	3
    1301	001	D-	2
    1301	001	F	18
    1301	002	A-	1
    1301	002	B	1
    1301	002	B-	3
    1301	002	C	2

I want to get a list of course/sections with the greatest number of each grade.

For example:

    A | 1301-023 | 75     // 1301-023 had the most A's, 75 of them
    B | 1301-033 | 65     // 1301-034 had the most B's, 65 of them

Ties should appear in the list.

",4
1588984,10/19/2009 14:26:51,105445,05/12/2009 15:29:14,163,12,"How to make ""No Duplicates"" column in Sql Server 2008 ?","I have simple table in my SQL Server DataBase. This table contain two columns: `ID int, Name nvarchar(50)`.

The ID column is the primary key for my table.

 **I want the ""Name"" column to be ""(No Duplicates)"" but this column isn't primary column. How could i do this like MS Access ??.**",sql-server,ms-access,biginteger,,,,open,0,51,11,"How to make ""No Duplicates"" column in Sql Server 2008 ? I have simple table in my SQL Server DataBase. This table contain two columns: `ID int, Name nvarchar(50)`.

The ID column is the primary key for my table.

 **I want the ""Name"" column to be ""(No Duplicates)"" but this column isn't primary column. How could i do this like MS Access ??.**",3
11436512,07/11/2012 15:50:03,1361315,04/27/2012 14:12:23,160,0,"Do you set an index on JOIN clauses or where clauses, or both?","Say my query looks like:

    SELECT t1, t2
    FROM t1
      LEFT JOIN t2 ON (t1.id = t2.id AND t2.userid = @userid)
    WHERE t1.enabled = 1 AND
          t1.startDate <= ??? AND 
          (t1.counter = -1 OR
           t2.counter IS NULL OR
           (t1.counter > t2.counter)


Now this table might have a few hundred thousand rows in it.

Would you suggest I put an index on the JOIN clause only like this?

      t2.id t2.userid


What about the where clause?  Or is the join clause more important?

I realize testing is important, but in theory what should be done?

(this is sql 2000)



",sql-server,indexes,,,,07/12/2012 17:10:19,off topic,1,151,13,"Do you set an index on JOIN clauses or where clauses, or both? Say my query looks like:

    SELECT t1, t2
    FROM t1
      LEFT JOIN t2 ON (t1.id = t2.id AND t2.userid = @userid)
    WHERE t1.enabled = 1 AND
          t1.startDate <= ??? AND 
          (t1.counter = -1 OR
           t2.counter IS NULL OR
           (t1.counter > t2.counter)


Now this table might have a few hundred thousand rows in it.

Would you suggest I put an index on the JOIN clause only like this?

      t2.id t2.userid


What about the where clause?  Or is the join clause more important?

I realize testing is important, but in theory what should be done?

(this is sql 2000)



",2
8297655,11/28/2011 14:54:06,859154,07/23/2011 09:23:42,5100,341,SqlServer identity naming convention,"I have  table **Widgets** and table **Persons**

both of them contains Identity column ( seed)

*what is the recommended naming convention for the identity column ?* 

**is** it ""`id`"" ( for both tables ) :

    Widgets.Id
    Persons.Id

**or** 

    Widgets.WidgetId
    Persons.PersonId


Is there advantages / disadvantages in the former  compare to the latter ?



",sql-server,naming-conventions,,,,11/28/2011 15:10:48,not constructive,1,64,4,"SqlServer identity naming convention I have  table **Widgets** and table **Persons**

both of them contains Identity column ( seed)

*what is the recommended naming convention for the identity column ?* 

**is** it ""`id`"" ( for both tables ) :

    Widgets.Id
    Persons.Id

**or** 

    Widgets.WidgetId
    Persons.PersonId


Is there advantages / disadvantages in the former  compare to the latter ?



",2
1559514,10/13/2009 10:56:11,128071,06/24/2009 08:39:06,331,0,Query Executing Problem,"Using SQL 2005

“Taking too much time to execute”

I want to filter the date, the date should not display in holidays, and I am using three tables with Inner Join

When I run the below query, It taking too much time to execute, because I filter the cardeventdate with three table.

Query

    SELECT PERSONID, CardEventDate tmp_cardevent3 WHERE (CardEventDate NOT IN (SELECT     T_CARDEVENT.CARDEVENTDATE FROM T_PERSON INNER JOIN T_CARDEVENT ON T_PERSON.PERSONID = T_CARDEVENT.PERSONID INNER JOIN DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME ON  T_CARDEVENT.CARDEVENTDAY = DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME.DAYCODE AND  T_PERSON.TACODE = DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME.TACODE WHERE (DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME.HOLIDAY = 'true'))) ORDER BY PERSONID, CardEventDate DESC

For the above mentioned Query, there is any other way to do date filter.

Expecting alternative queries for my query?

",sql-server,,,,,,open,0,115,3,"Query Executing Problem Using SQL 2005

“Taking too much time to execute”

I want to filter the date, the date should not display in holidays, and I am using three tables with Inner Join

When I run the below query, It taking too much time to execute, because I filter the cardeventdate with three table.

Query

    SELECT PERSONID, CardEventDate tmp_cardevent3 WHERE (CardEventDate NOT IN (SELECT     T_CARDEVENT.CARDEVENTDATE FROM T_PERSON INNER JOIN T_CARDEVENT ON T_PERSON.PERSONID = T_CARDEVENT.PERSONID INNER JOIN DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME ON  T_CARDEVENT.CARDEVENTDAY = DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME.DAYCODE AND  T_PERSON.TACODE = DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME.TACODE WHERE (DUAL_PRO_II_TAS.dbo.T_WORKINOUTTIME.HOLIDAY = 'true'))) ORDER BY PERSONID, CardEventDate DESC

For the above mentioned Query, there is any other way to do date filter.

Expecting alternative queries for my query?

",1
9944830,03/30/2012 14:23:13,1269636,03/14/2012 17:03:57,641,34,tsql - seperate a text bloc by new lines,"I need to seperate a `TEXT` value by new lines character and then loop on each line.


In other words, I need an `explode()` function, but for T-SQL, and I need to to loop on each line.

Is there a quick way to do this in T-SQL ?",sql-server,tsql,triggers,,,,open,0,46,9,"tsql - seperate a text bloc by new lines I need to seperate a `TEXT` value by new lines character and then loop on each line.


In other words, I need an `explode()` function, but for T-SQL, and I need to to loop on each line.

Is there a quick way to do this in T-SQL ?",3
4610367,01/05/2011 23:36:52,283040,02/28/2010 10:29:43,57,8,"filtering results, manipulating data aspnet mvc","I was wondering if anyone can suggest me a book or tutorial in order to enhance knowledge on data manipulation or filtering data results.

I would like to know how to create a query on Entity framework, pass that info to the controller and then manipulate data in a grid or list using checkboxes - eg only results with photo, etc - , price range sliders and more data results filtering from the UI.

Thank you so much.
ps: I have a tutorial in ajax but I`m looking in plan c#.",sql-server,asp.net-mvc,,,,,open,0,88,6,"filtering results, manipulating data aspnet mvc I was wondering if anyone can suggest me a book or tutorial in order to enhance knowledge on data manipulation or filtering data results.

I would like to know how to create a query on Entity framework, pass that info to the controller and then manipulate data in a grid or list using checkboxes - eg only results with photo, etc - , price range sliders and more data results filtering from the UI.

Thank you so much.
ps: I have a tutorial in ajax but I`m looking in plan c#.",2
10913292,06/06/2012 11:27:36,1398631,05/16/2012 12:41:15,1,0,How To Backup Database In Sql Server with 100 records each tables?,"I want to backup sql server database with all the objects along with data but data in all the tables should be limited that is 100 records each tables. I can do this in mysql very easily but in sql server I don`t know how to do??

Please help me out.

Thanks

Nitesh Kumar",sql-server,,,,,,open,0,51,12,"How To Backup Database In Sql Server with 100 records each tables? I want to backup sql server database with all the objects along with data but data in all the tables should be limited that is 100 records each tables. I can do this in mysql very easily but in sql server I don`t know how to do??

Please help me out.

Thanks

Nitesh Kumar",1
1585993,10/18/2009 20:49:07,51,08/01/2008 13:31:13,3922,105,Perform Data Analysis on Sql Server or in .Net?,"I have some data analysis that needs to perform. On average, it would involve somewhere in between 50K-150K rows. From these rows I need to extract the summation of Sum(X) as well as Count(X) based on five different criteria. There are two ways of going about it:

 1. Write 10 different queries, each one designed to aggregate the data from column X using Sum() or Count(). Run each one and retrieve the result using SqlCommand.ExecuteScalar().
 2. Create a custom object to contain all of the different parameters that would be needed to evaluate the different conditions. Run one query that will return all of the data needed to make up the superset containing all of the different conditional subsets, using SqlCommand.ExecuteDataReader(). Read each row from the DataReader into a new object, adding each one into a List<CustomObject> collection. One all data is retrieved, use Linq-to-Object to determine the different Sum() and Count() values needed based on different conditions.

I know that I could try each one out to see which is fastest, but I am interested in the community's advice on which one is likely to be faster. Assume Sql Server and Web Server each running on their own machines, each with sufficient memory. 

Right now I am leaning towards option 1. Even though there are many more queries to the DB, the DB itself will do all of the aggregation work and very little data will pass in between the Sql Server and the Web Server. With option 2, there is only one query, but it will pass a very large amount of data to .Net, and then .Net will have to do all of the heavy lifting with regards to the aggregate functions (and though I don't have anything to base it on, I suspect that Sql Server is more efficient at running these types of big aggregate functions).

Any thoughts on which way to go (or a third option that I am missing)?",sql-server,aggregate,.net,asp.net,c#,,open,0,324,9,"Perform Data Analysis on Sql Server or in .Net? I have some data analysis that needs to perform. On average, it would involve somewhere in between 50K-150K rows. From these rows I need to extract the summation of Sum(X) as well as Count(X) based on five different criteria. There are two ways of going about it:

 1. Write 10 different queries, each one designed to aggregate the data from column X using Sum() or Count(). Run each one and retrieve the result using SqlCommand.ExecuteScalar().
 2. Create a custom object to contain all of the different parameters that would be needed to evaluate the different conditions. Run one query that will return all of the data needed to make up the superset containing all of the different conditional subsets, using SqlCommand.ExecuteDataReader(). Read each row from the DataReader into a new object, adding each one into a List<CustomObject> collection. One all data is retrieved, use Linq-to-Object to determine the different Sum() and Count() values needed based on different conditions.

I know that I could try each one out to see which is fastest, but I am interested in the community's advice on which one is likely to be faster. Assume Sql Server and Web Server each running on their own machines, each with sufficient memory. 

Right now I am leaning towards option 1. Even though there are many more queries to the DB, the DB itself will do all of the aggregation work and very little data will pass in between the Sql Server and the Web Server. With option 2, there is only one query, but it will pass a very large amount of data to .Net, and then .Net will have to do all of the heavy lifting with regards to the aggregate functions (and though I don't have anything to base it on, I suspect that Sql Server is more efficient at running these types of big aggregate functions).

Any thoughts on which way to go (or a third option that I am missing)?",5
2431412,03/12/2010 08:47:34,149578,08/03/2009 08:26:27,416,7,[SQL server] How to insert artificial data into a select statement,"Suppose we got a original query as follows:

    SELECT A, B, C FROM tblA

Now, I need to additional artificial rows like 
**SELECT 'Kyala', B, C FROM tblA** when, for example, C = 100 to be inserted into the resultset. 

How could I achieve it **using a single SQL** instead of relying on table variable or temp table?",sql-server,,,,,,open,0,60,11,"[SQL server] How to insert artificial data into a select statement Suppose we got a original query as follows:

    SELECT A, B, C FROM tblA

Now, I need to additional artificial rows like 
**SELECT 'Kyala', B, C FROM tblA** when, for example, C = 100 to be inserted into the resultset. 

How could I achieve it **using a single SQL** instead of relying on table variable or temp table?",1
10415225,05/02/2012 13:55:24,9647,09/15/2008 19:28:27,2513,152,Mirroring and Availability Groups in SQL2012,"I've been looking at the new features of SQL 2012, and how it can help my current situation.

Currently we're on SQL 2008R2, and replicate two OLTP database servers to a single reporting server via transactional replication. We then use these replicated DBs for reporting.

I'm interested in whether SQL 2012 and the Availability Groups can replace this - So instead of transactional replication, I'd use the new availability groups and mirror the two OLTP servers to the replication server - Where the reporting will be able to access the read-only copies.

I'm unsure if this will work well, or even at all. 

Does anyone have any good examples or experience with this?",sql-server,replication,mirroring,sql2012,,05/03/2012 19:54:18,off topic,1,110,6,"Mirroring and Availability Groups in SQL2012 I've been looking at the new features of SQL 2012, and how it can help my current situation.

Currently we're on SQL 2008R2, and replicate two OLTP database servers to a single reporting server via transactional replication. We then use these replicated DBs for reporting.

I'm interested in whether SQL 2012 and the Availability Groups can replace this - So instead of transactional replication, I'd use the new availability groups and mirror the two OLTP servers to the replication server - Where the reporting will be able to access the read-only copies.

I'm unsure if this will work well, or even at all. 

Does anyone have any good examples or experience with this?",4
11400175,07/09/2012 17:35:53,9382,09/15/2008 18:36:29,12964,229,Mechanics of partitioning,"Imagine the following hypothetical database structure.  Basically it's a top down structure (Country has Orders, Order has OrderLines, OrderLine has ShipLines, etc...).

![enter image description here][1]

I want to partition my SQL Server 2008 database by CountryID.  As you can see, CountryID is only in the first 2 tables (e.g. amCountries and amOrders).  Given that (as far as I understand) that partitioning is done at the table level, do I need to add CountryID to the remaining tables to be able to partition them?  Or is there some type of cascade available in SQL Server that will allow me to skip adding CountryID to everything?

  [1]: http://i.stack.imgur.com/Gfcmr.png",sql-server,sql-server-2008,partitioning,database-partitioning,,07/09/2012 17:56:21,off topic,1,110,3,"Mechanics of partitioning Imagine the following hypothetical database structure.  Basically it's a top down structure (Country has Orders, Order has OrderLines, OrderLine has ShipLines, etc...).

![enter image description here][1]

I want to partition my SQL Server 2008 database by CountryID.  As you can see, CountryID is only in the first 2 tables (e.g. amCountries and amOrders).  Given that (as far as I understand) that partitioning is done at the table level, do I need to add CountryID to the remaining tables to be able to partition them?  Or is there some type of cascade available in SQL Server that will allow me to skip adding CountryID to everything?

  [1]: http://i.stack.imgur.com/Gfcmr.png",4
5831198,04/29/2011 11:04:21,712973,04/18/2011 07:33:31,5,0,exporting store procedure result to excel with column name,"i have attached the code for storing the store procedure output to an excel sheet..

but i have few issues, they are

(1)
all the columns are displayed in the first column of the excel sheet..which i dont need, i need to show the report in diff columns.. how to do that..

(2)
if i use inner join with the main, how can i get the column names of the other table

can anyone please help me out to solve the above issues




alter procedure proc_generate_excel_with_columns

(
@db_name varchar(100),

@schm_name varchar(100),

@table_name varchar(100), 

@file_name varchar(100)

)

as

--Generate column names as a recordset

declare @columns varchar(8000), @sql varchar(8000), @data_file varchar(100)

select 

@columns=coalesce(@columns+',','')+column_name+' as '+column_name 

from 

information_schema.columns

where 

table_name=@table_name

select @columns=''''+replace(replace(@columns,' as ',''' as '),',',',''')


--Create a dummy file to have actual data

select @data_file=substring(@file_name,1,len(@file_name)-charindex('\',reverse(@file_name)))+'\data_file.xls'


--Generate column names in the passed EXCEL file

set @sql='bcp "" select * from (select '+@columns+') as t"" queryout   
c:\test.xls  -c -t,  -T -S ' + @@servername

exec master..xp_cmdshell @sql


--Generate data in the dummy file

set @sql='bcp ""select * from st..VEN_FULLREPORTMASTER 
where entry_date =  convert(varchar, getdate()-3, 105) "" 
queryout   c:\data_file.xls  -c -t,  -T -S' + @@servername

--	exec master..xp_cmdshell @sql


--Copy dummy file to passed EXCEL file

set @sql= 'exec master..xp_cmdshell ''type '+@data_file+' >> ""'+@file_name+'""'''

exec(@sql)


----Delete dummy file 

set @sql= 'exec master..xp_cmdshell ''del '+@data_file+''''

exec(@sql)



",sql-server,,,,,,open,0,198,9,"exporting store procedure result to excel with column name i have attached the code for storing the store procedure output to an excel sheet..

but i have few issues, they are

(1)
all the columns are displayed in the first column of the excel sheet..which i dont need, i need to show the report in diff columns.. how to do that..

(2)
if i use inner join with the main, how can i get the column names of the other table

can anyone please help me out to solve the above issues




alter procedure proc_generate_excel_with_columns

(
@db_name varchar(100),

@schm_name varchar(100),

@table_name varchar(100), 

@file_name varchar(100)

)

as

--Generate column names as a recordset

declare @columns varchar(8000), @sql varchar(8000), @data_file varchar(100)

select 

@columns=coalesce(@columns+',','')+column_name+' as '+column_name 

from 

information_schema.columns

where 

table_name=@table_name

select @columns=''''+replace(replace(@columns,' as ',''' as '),',',',''')


--Create a dummy file to have actual data

select @data_file=substring(@file_name,1,len(@file_name)-charindex('\',reverse(@file_name)))+'\data_file.xls'


--Generate column names in the passed EXCEL file

set @sql='bcp "" select * from (select '+@columns+') as t"" queryout   
c:\test.xls  -c -t,  -T -S ' + @@servername

exec master..xp_cmdshell @sql


--Generate data in the dummy file

set @sql='bcp ""select * from st..VEN_FULLREPORTMASTER 
where entry_date =  convert(varchar, getdate()-3, 105) "" 
queryout   c:\data_file.xls  -c -t,  -T -S' + @@servername

--	exec master..xp_cmdshell @sql


--Copy dummy file to passed EXCEL file

set @sql= 'exec master..xp_cmdshell ''type '+@data_file+' >> ""'+@file_name+'""'''

exec(@sql)


----Delete dummy file 

set @sql= 'exec master..xp_cmdshell ''del '+@data_file+''''

exec(@sql)



",1
9679861,03/13/2012 07:25:06,1182792,02/01/2012 13:28:14,1,0,Sql Server Connection String for a Standard User,"
I am trying to connect to an mdf file using the following connection string:

> <add name=""ApplicationServices"" connectionString=""data
> source=.\SQLEXPRESS;Integrated
> Security=SSPI;AttachDBFilename=|DataDirectory|nzdb.mdf;User
> Instance=true"" providerName=""System.Data.SqlClient""/>

I am a standard Windows user (don't have administrative rights). When I try to connect, I get an error ""Cannot open user default database. Login failed. Login failed for user 'MACHINENAME\USERNAME'.""

I have not attached this file to the local sql server express instance assuming that the file will get automatically attached when connecting. 

Basically, I am configuring the project such a way that anybody can easily make a copy of the .mdf file and start working on it by changing the web.config without caring about permission of the user currently logged in because sql server express is running locally.

Please let me know what am I missing. How do I change the connection string such that the application just connects to any .mdf pointed by AttachDBFilename file. If user credentials are necessary then which user should be used so that the project would work on any machine (users like sa?)

",sql-server,database-connection,connection-string,,,,open,0,169,8,"Sql Server Connection String for a Standard User 
I am trying to connect to an mdf file using the following connection string:

> <add name=""ApplicationServices"" connectionString=""data
> source=.\SQLEXPRESS;Integrated
> Security=SSPI;AttachDBFilename=|DataDirectory|nzdb.mdf;User
> Instance=true"" providerName=""System.Data.SqlClient""/>

I am a standard Windows user (don't have administrative rights). When I try to connect, I get an error ""Cannot open user default database. Login failed. Login failed for user 'MACHINENAME\USERNAME'.""

I have not attached this file to the local sql server express instance assuming that the file will get automatically attached when connecting. 

Basically, I am configuring the project such a way that anybody can easily make a copy of the .mdf file and start working on it by changing the web.config without caring about permission of the user currently logged in because sql server express is running locally.

Please let me know what am I missing. How do I change the connection string such that the application just connects to any .mdf pointed by AttachDBFilename file. If user credentials are necessary then which user should be used so that the project would work on any machine (users like sa?)

",3
7069421,08/15/2011 19:05:08,895191,08/15/2011 15:37:38,8,0,change repeated fields,"table: `tbl1`

Fields:`id`,`name`

<pre>id       name</pre>

<pre>1        a
1        a
1        a
1        b

</pre>

I like places that have been repeated name and Id(id=1,name=a || id=1,name=a || id=1,name=a).

change to

id=1,name=a1 || id=1,name=a2  || id=1,name=a3


By Linq && SqlServer",sql-server,linq,sql-server-2005,sql-server-2008,,08/15/2011 20:36:53,not a real question,1,63,3,"change repeated fields table: `tbl1`

Fields:`id`,`name`

<pre>id       name</pre>

<pre>1        a
1        a
1        a
1        b

</pre>

I like places that have been repeated name and Id(id=1,name=a || id=1,name=a || id=1,name=a).

change to

id=1,name=a1 || id=1,name=a2  || id=1,name=a3


By Linq && SqlServer",4
5373052,03/21/2011 01:45:04,206698,11/09/2009 07:47:11,20,4,Elapsed time of SQL,"![enter image description here][1]


  [1]: http://i.stack.imgur.com/lWTV1.gif

When I remove 41 and 42 lines, Elapsed time is ""00:00:03.13"". The ""com_site"" table aliased as [c] has no index or PK.
Result records count is 5503(20 records before removing.)
Could anyone explain me why this happens?
Thanks...",sql-server,,,,,,open,0,41,4,"Elapsed time of SQL ![enter image description here][1]


  [1]: http://i.stack.imgur.com/lWTV1.gif

When I remove 41 and 42 lines, Elapsed time is ""00:00:03.13"". The ""com_site"" table aliased as [c] has no index or PK.
Result records count is 5503(20 records before removing.)
Could anyone explain me why this happens?
Thanks...",1
3083440,06/21/2010 09:29:48,190578,10/15/2009 12:27:42,73,2,Change path for default SQL Server trace,"How do I change the path for the default trace in SQL Server? Can this be done with SQL Management Studio or do I have to use sp_configure

Thanks
",sql-server,sql-server-2005,,,,,open,0,28,7,"Change path for default SQL Server trace How do I change the path for the default trace in SQL Server? Can this be done with SQL Management Studio or do I have to use sp_configure

Thanks
",2
1343027,08/27/2009 18:40:07,2885,08/25/2008 17:52:09,373,11,How can I execute a single query in SQL Server Management Studio?,"Background: I'm using SQL Server Management Studio 2008 and I have a query window open that contains multiple queries.

Is there a keyboard shortcut that will allow me to execute a single query without highlighting the query I would like to run first?  Some other SQL tools have shorcuts that run the query that is under the cursor, which keeps the hands on the keyboard, and away from the mouse.

Thanks everyone.",sql-server,keyboard-shortcuts,,,,,open,0,71,12,"How can I execute a single query in SQL Server Management Studio? Background: I'm using SQL Server Management Studio 2008 and I have a query window open that contains multiple queries.

Is there a keyboard shortcut that will allow me to execute a single query without highlighting the query I would like to run first?  Some other SQL tools have shorcuts that run the query that is under the cursor, which keeps the hands on the keyboard, and away from the mouse.

Thanks everyone.",2
3401218,08/03/2010 22:22:09,53007,01/08/2009 16:57:03,4748,203,Is there a way to pivot a customer ID and a their most recent order dates?,"I have a query that gives me all customer's and their last three order dates.

EX:

    CustomerId DateOrdered
    167	2006-09-16 01:25:38.060
    167	2006-09-21 13:11:53.530
    171	2006-08-31 15:19:22.543
    171	2006-09-01 13:30:54.013
    171	2006-09-01 13:34:36.483
    178	2006-09-04 11:36:19.983
    186	2006-09-05 12:50:27.153
    186	2006-09-05 12:51:08.513

I want to know if there is a way for me to pivot it to display like this:

    [CustomerId]	[Most Recent] [Middle] [Oldest]
    '167'	'2006-09-21 13:11:53.530'	'2006-09-16 01:25:38.060'	'NULL'
    '171'    '2006-09-01 13:34:36.483'   '2006-09-01 13:30:54.013'   '2006-08-31 15:19:22.543'
    '178'	'2006-09-04 11:36:19.983'	NULL	NULL
    '186'	'2006-09-05 12:51:08.513'	'2006-09-05 12:50:27.153'	NULL	",sql-server,sql-server-2005,tsql,,,,open,0,118,16,"Is there a way to pivot a customer ID and a their most recent order dates? I have a query that gives me all customer's and their last three order dates.

EX:

    CustomerId DateOrdered
    167	2006-09-16 01:25:38.060
    167	2006-09-21 13:11:53.530
    171	2006-08-31 15:19:22.543
    171	2006-09-01 13:30:54.013
    171	2006-09-01 13:34:36.483
    178	2006-09-04 11:36:19.983
    186	2006-09-05 12:50:27.153
    186	2006-09-05 12:51:08.513

I want to know if there is a way for me to pivot it to display like this:

    [CustomerId]	[Most Recent] [Middle] [Oldest]
    '167'	'2006-09-21 13:11:53.530'	'2006-09-16 01:25:38.060'	'NULL'
    '171'    '2006-09-01 13:34:36.483'   '2006-09-01 13:30:54.013'   '2006-08-31 15:19:22.543'
    '178'	'2006-09-04 11:36:19.983'	NULL	NULL
    '186'	'2006-09-05 12:51:08.513'	'2006-09-05 12:50:27.153'	NULL	",3
10682681,05/21/2012 09:29:01,211452,11/15/2009 14:27:23,1051,23,sql server database security,"I've Sql Server 2008 installed on Windows 2008 Server.
I've disabled built-in administrator user and created sa with sysadmin privileges. 

Question is: Is there any way to access to db, or back up it or methods to reset(and/or)get password for **sa**?

I want to secure my database.
Thanks.
",sql-server,security,,,,05/21/2012 21:21:47,off topic,1,45,4,"sql server database security I've Sql Server 2008 installed on Windows 2008 Server.
I've disabled built-in administrator user and created sa with sysadmin privileges. 

Question is: Is there any way to access to db, or back up it or methods to reset(and/or)get password for **sa**?

I want to secure my database.
Thanks.
",2
2369237,03/03/2010 06:40:19,141282,07/20/2009 09:44:02,177,7,SQL CLR - Does lock statement make any difference?,"I have written the following piece of code ( sql clr stored procedure ) that writes messages to a local file. The problem occurs when multiple connections call the stored proc at the same time. So I used a lock statement. But this doesn't seem to make any difference? What am I doing wrong here?

lock (SqlContext.Pipe)<BR>
            {<BR>
 StreamWriter sw = File.AppendText(""C:\\Date.txt"");<BR>
                int y = 50;<BR>
                while (y != 0)<BR>
                {<BR>
                    sw.WriteLine(DateTime.Now + ""  "" + serverName + "" -- "" + jobId.ToString() );<BR>
                    System.Threading.Thread.Sleep(new Random().Next());<BR>
                    y = y - 1;<BR>
                }<BR>
                sw.Close();<BR>
            }<BR>
}<BR>",sql-server,sql-server-2005,sql-server-2008,sqlclr,,,open,0,248,9,"SQL CLR - Does lock statement make any difference? I have written the following piece of code ( sql clr stored procedure ) that writes messages to a local file. The problem occurs when multiple connections call the stored proc at the same time. So I used a lock statement. But this doesn't seem to make any difference? What am I doing wrong here?

lock (SqlContext.Pipe)<BR>
            {<BR>
 StreamWriter sw = File.AppendText(""C:\\Date.txt"");<BR>
                int y = 50;<BR>
                while (y != 0)<BR>
                {<BR>
                    sw.WriteLine(DateTime.Now + ""  "" + serverName + "" -- "" + jobId.ToString() );<BR>
                    System.Threading.Thread.Sleep(new Random().Next());<BR>
                    y = y - 1;<BR>
                }<BR>
                sw.Close();<BR>
            }<BR>
}<BR>",4
79856,09/17/2008 04:03:38,10630,09/16/2008 00:32:30,1,1,"What is the most efficient way to count the results of a stored procedure, from another stored procedure?","In a stored procedure, I need to get the count of the results of another stored procedure. Specifically, I need to know if it returns any results, or an empty set.

I could create a temp table/table variable, exec the stored procedure into it, and then run a select count on that data.  But I really don't care about the data itself, all I need is the count (or presence/absence of data). I was wondering if there is a more efficient way of getting just that information.

I don't want to just copy the contents of the other stored procedure and rewrite it as a select count. The stored procedure changes too frequently for that to be workable.",sql-server,tsql,,,,,open,0,117,18,"What is the most efficient way to count the results of a stored procedure, from another stored procedure? In a stored procedure, I need to get the count of the results of another stored procedure. Specifically, I need to know if it returns any results, or an empty set.

I could create a temp table/table variable, exec the stored procedure into it, and then run a select count on that data.  But I really don't care about the data itself, all I need is the count (or presence/absence of data). I was wondering if there is a more efficient way of getting just that information.

I don't want to just copy the contents of the other stored procedure and rewrite it as a select count. The stored procedure changes too frequently for that to be workable.",2
3013447,06/10/2010 10:13:57,172231,09/11/2009 19:31:15,48,5,How to retrieve all errors and messages from a query using ADO,"When a SQL batch returns more than one message from e.g. print statements, then I can only retrieve the first one using the ADO connection's Errors collection. How do I get the rest of the messages?

If I run this script:

    Option Explicit
    Dim conn
    Set conn = CreateObject(""ADODB.Connection"")
    conn.Provider = ""SQLOLEDB""
    conn.ConnectionString = ""Data Source=(local);Integrated Security=SSPI;Initial Catalog=Master""
    conn.Open
    
    conn.Execute(""print 'Foo'"" & vbCrLf & ""print 'Bar'"" & vbCrLf & ""raiserror ('xyz', 10, 127)"")
    
    Dim error
    For Each error in conn.Errors
    	MsgBox error.Description
    Next

Then I only get ""Foo"" back, never ""Bar"" or ""xyz"".

Is there a way to get the remaining messages?

",sql-server,vbscript,ado,,,,open,0,140,12,"How to retrieve all errors and messages from a query using ADO When a SQL batch returns more than one message from e.g. print statements, then I can only retrieve the first one using the ADO connection's Errors collection. How do I get the rest of the messages?

If I run this script:

    Option Explicit
    Dim conn
    Set conn = CreateObject(""ADODB.Connection"")
    conn.Provider = ""SQLOLEDB""
    conn.ConnectionString = ""Data Source=(local);Integrated Security=SSPI;Initial Catalog=Master""
    conn.Open
    
    conn.Execute(""print 'Foo'"" & vbCrLf & ""print 'Bar'"" & vbCrLf & ""raiserror ('xyz', 10, 127)"")
    
    Dim error
    For Each error in conn.Errors
    	MsgBox error.Description
    Next

Then I only get ""Foo"" back, never ""Bar"" or ""xyz"".

Is there a way to get the remaining messages?

",3
6705493,07/15/2011 10:10:46,118110,06/05/2009 15:50:52,600,9,Problem accessing SQL Server from PowerShell,"I'm trying to implement a backup management script i found at [http://sev17.com/2011/03/restore-and-relocate-database-files-using-powershell/][1]

The article says it depends on SQLPSX version 2.3.2.1 or higher - I have the most current version.

attempting to execute this line:

    $server = get-sqlserver $sqlserver

results in:


    New-Object : Cannot find type [Microsoft.SqlServer.Management.Common.ServerConnection]: make sure the assembly containing this type is loaded.
    At C:\Users\...\Documents\WindowsPowerShell\Modules\sqlserver\SQLServer.psm1:68 char:24
    +     { $con = new-object <<<<  (""Microsoft.SqlServer.Management.Common.ServerConnection"") $sqlserver }


  [1]: http://sev17.com/2011/03/restore-and-relocate-database-files-using-powershell/",sql-server,powershell,,,,,open,0,85,6,"Problem accessing SQL Server from PowerShell I'm trying to implement a backup management script i found at [http://sev17.com/2011/03/restore-and-relocate-database-files-using-powershell/][1]

The article says it depends on SQLPSX version 2.3.2.1 or higher - I have the most current version.

attempting to execute this line:

    $server = get-sqlserver $sqlserver

results in:


    New-Object : Cannot find type [Microsoft.SqlServer.Management.Common.ServerConnection]: make sure the assembly containing this type is loaded.
    At C:\Users\...\Documents\WindowsPowerShell\Modules\sqlserver\SQLServer.psm1:68 char:24
    +     { $con = new-object <<<<  (""Microsoft.SqlServer.Management.Common.ServerConnection"") $sqlserver }


  [1]: http://sev17.com/2011/03/restore-and-relocate-database-files-using-powershell/",2
8482631,12/12/2011 23:53:45,945601,09/14/2011 21:52:18,272,15,SQL Profiler shows high duration on unknown TextData,"I have been profiling my web app's connection to the sql server for the last 24 hours.
Out of 1.226.709 batchcompleted I have 36 with the duration over 0.1 second.

Out of the 36 I have 4 unknown statements. And here I hoped some of you could help me tell what these are about and from where they come?! :)

The first concerns me a bit, cause it have a duration over 1 second.

(The trace were saved to a table in the database, which is why all the durations are in microseconds)
    
    TextData: 	SELECT 'Server[@Name=' + quotename(CAST(          serverproperty(N'Servername')         AS sysname),'''') + ']' + '/Collation[@Name=' + quotename(cl.name,'''') + ']' AS [Urn], cl.name AS [Name], CAST(COLLATIONPROPERTY(name, 'CodePage') AS int) AS [CodePage], CAST(COLLATIONPROPERTY(name, 'LCID') AS int) AS [LocaleID], CAST(COLLATIONPROPERTY(name, 'ComparisonStyle') AS int) AS [ComparisonStyle], cl.description AS [Description], CAST(COLLATIONPROPERTY(name, 'Version') AS int) AS [CollationVersion] FROM sys.fn_helpcollations() cl ORDER BY [Name] ASC
    CPU: 		93
    Reads: 		0
    Writes: 	0
    Duration: 	1013301
    
    TextData: 	select  IndA.name, IndA.index_id, IndA.fill_factor, IndA.is_padded, IndA.is_disabled,IndA.is_hypothetical, IndA.allow_row_locks, IndA.allow_page_locks,IndA.spatial_index_type, IndB.bounding_box_xmin, IndB.bounding_box_ymin, IndB.bounding_box_xmax, IndB.bounding_box_ymax, IndB.level_1_grid, IndB.level_2_grid, IndB.level_3_grid, IndB.level_4_grid, IndB.cells_per_object, ind_col.index_column_id, col.name as column_nName, ind_col.key_ordinal, ind_col.is_descending_key, ind_col.column_id, st.no_recompute from (sys.spatial_indexes IndA left outer join sys.spatial_index_tessellations IndB on IndB.object_id = IndA.object_id and IndB.index_id = IndA.index_id) inner join(sys.internal_tables IntT inner join sys.stats st on st.object_id = IntT.object_id and st.stats_id = 1) on IntT.parent_id = IndA.object_id and  IntT.parent_minor_id  = IndA.index_id inner join sys.index_columns ind_col on ind_col.object_id = IndA.object_id and ind_col.index_id = IndA.index_id inner join sys.columns col on col.object_id = ind_col.object_id and col.column_id = ind_col.column_id where IndA.object_id = object_id(N'dbo.rapports') order by IndA.index_id, ind_col.key_ordinal
    CPU: 		109
    Reads: 		216
    Writes: 	0
    Duration: 	148322
    
    TextData: 	select col.name, col.column_id, st.name as DT_name, schema_name(st.schema_id) as DT_schema, col.max_length, col.precision, col.scale, bt.name as BT_name, col.collation_name, col.is_nullable, col.is_ansi_padded, col.is_rowguidcol, col.is_identity, case when(idc.column_id is null) then null else CONVERT(nvarchar(40), idc.seed_value) end, case when(idc.column_id is null) then null else CONVERT(nvarchar(40), idc.increment_value) end, CONVERT(bit, case when(cmc.column_id is null) then 0 else 1 end) as is_computed, convert(bit, ColumnProperty(col.object_id, col.name, N'IsIdNotForRepl')) as IsIdNotForRepl, col.is_replicated, col.is_non_sql_subscribed, col.is_merge_published, col.is_dts_replicated, col.rule_object_id, robj.name as Rul_name, schema_name(robj.schema_id) as Rul_schema, col.default_object_id, OBJECTPROPERTY(col.default_object_id, N'IsDefaultCnst') as is_defcnst, dobj.name as def_name, schema_name(dobj.schema_id) as def_schema, CONVERT(bit, case when (ftc.column_id is null) then 0 else 1 end) as is_FullTextCol, col_name(col.object_id, ftc.type_column_id) FT_type_column, ftc.language_id as FT_language_id, case when(cmc.column_id is null) then null else cmc.definition end as formular, case when(cmc.column_id is null) then null else cmc.is_persisted end as is_persisted, defCst.definition, COLUMNPROPERTY(col.object_id, col.name, 'IsDeterministic') as IsDeterministic, xmlcoll.name as xmlSchema_name, schema_name(xmlcoll.schema_id) as xmlSchema_schema, col.is_xml_document, col.is_sparse, col.is_column_set from sys.columns col left outer join sys.types st on st.user_type_id = col.user_type_id left outer join sys.types bt on bt.user_type_id = col.system_type_id left outer join sys.objects robj on robj.object_id = col.rule_object_id and robj.type = 'R' left outer join sys.objects dobj on dobj.object_id = col.default_object_id and dobj.type = 'D' left outer join sys.default_constraints defCst on defCst.parent_object_id = col.object_id and defCst.parent_column_id = col.column_id left outer join sys.identity_columns idc on idc.object_id = col.object_id and idc.column_id = col.column_id left outer join sys.computed_columns cmc on cmc.object_id = col.object_id and cmc.column_id = col.column_id left outer join sys.fulltext_index_columns ftc on ftc.object_id = col.object_id and ftc.column_id = col.column_id left outer join sys.xml_schema_collections xmlcoll on xmlcoll.xml_Collection_id = col.xml_Collection_id where col.object_id = object_id(N'dbo.rapports') order by col.column_id
    CPU: 		215
    Reads: 		6895
    Writes: 	0
    Duration: 	142054
    
    TextData: 	SELECT dtb.name AS [Name], dtb.database_id AS [ID], CAST(case when dtb.name in ('master','model','msdb','tempdb') then 1 else dtb.is_distributor end AS bit) AS [IsSystemObject], CAST(has_dbaccess(dtb.name) AS bit) AS [IsAccessible], dtb.collation_name AS [Collation], dtb.name AS [DatabaseName2] FROM master.sys.databases AS dtb ORDER BY [Name] ASC
    CPU: 		15
    Reads: 		324
    Writes: 	0
    Duration: 	111258


**Extra info!**

I run a script every night to backup the database. I have no idea if the 4 statements have nothing to do with that. The statement for the backup is the following:

    TextData: 	declare @DBName varchar(200)  declare @Filename varchar(1000)  declare @Description varchar(1000)    DECLARE AllDatabases CURSOR FOR  SELECT name AS Name  FROM MASTER.DBO.SYSDATABASES  WHERE [NAME] NOT IN('MODEL', 'tempdb')    OPEN AllDatabases    FETCH NEXT FROM AllDatabases INTO @DBName    WHILE @@FETCH_STATUS = 0  BEGIN    print ''  print ''  print 'Backing up database ' + @DBName    -- Backup the database  set @Filename = 'D:\backup\' + convert(varchar, getDate(), 112) + ' - ' + @DBName + '.bak'  set @Description = 'Full backup of database ' + @Filename  BACKUP DATABASE @DBName TO DISK = @Filename WITH INIT , NOUNLOAD , NAME = @Description, NOSKIP , STATS = 10, NOFORMAT      FETCH NEXT FROM AllDatabases INTO @DBName  END    CLOSE AllDatabases  DEALLOCATE AllDatabases
    CPU: 		219
    Reads: 		2569
    Writes: 	83
    Duration: 	4478260


Oh yeah and... I'm not used to profiling my SQL Server. Are there any tips you can give? :) I have of course been googling the topic.",sql-server,sql-server-2008,,,,,open,0,893,8,"SQL Profiler shows high duration on unknown TextData I have been profiling my web app's connection to the sql server for the last 24 hours.
Out of 1.226.709 batchcompleted I have 36 with the duration over 0.1 second.

Out of the 36 I have 4 unknown statements. And here I hoped some of you could help me tell what these are about and from where they come?! :)

The first concerns me a bit, cause it have a duration over 1 second.

(The trace were saved to a table in the database, which is why all the durations are in microseconds)
    
    TextData: 	SELECT 'Server[@Name=' + quotename(CAST(          serverproperty(N'Servername')         AS sysname),'''') + ']' + '/Collation[@Name=' + quotename(cl.name,'''') + ']' AS [Urn], cl.name AS [Name], CAST(COLLATIONPROPERTY(name, 'CodePage') AS int) AS [CodePage], CAST(COLLATIONPROPERTY(name, 'LCID') AS int) AS [LocaleID], CAST(COLLATIONPROPERTY(name, 'ComparisonStyle') AS int) AS [ComparisonStyle], cl.description AS [Description], CAST(COLLATIONPROPERTY(name, 'Version') AS int) AS [CollationVersion] FROM sys.fn_helpcollations() cl ORDER BY [Name] ASC
    CPU: 		93
    Reads: 		0
    Writes: 	0
    Duration: 	1013301
    
    TextData: 	select  IndA.name, IndA.index_id, IndA.fill_factor, IndA.is_padded, IndA.is_disabled,IndA.is_hypothetical, IndA.allow_row_locks, IndA.allow_page_locks,IndA.spatial_index_type, IndB.bounding_box_xmin, IndB.bounding_box_ymin, IndB.bounding_box_xmax, IndB.bounding_box_ymax, IndB.level_1_grid, IndB.level_2_grid, IndB.level_3_grid, IndB.level_4_grid, IndB.cells_per_object, ind_col.index_column_id, col.name as column_nName, ind_col.key_ordinal, ind_col.is_descending_key, ind_col.column_id, st.no_recompute from (sys.spatial_indexes IndA left outer join sys.spatial_index_tessellations IndB on IndB.object_id = IndA.object_id and IndB.index_id = IndA.index_id) inner join(sys.internal_tables IntT inner join sys.stats st on st.object_id = IntT.object_id and st.stats_id = 1) on IntT.parent_id = IndA.object_id and  IntT.parent_minor_id  = IndA.index_id inner join sys.index_columns ind_col on ind_col.object_id = IndA.object_id and ind_col.index_id = IndA.index_id inner join sys.columns col on col.object_id = ind_col.object_id and col.column_id = ind_col.column_id where IndA.object_id = object_id(N'dbo.rapports') order by IndA.index_id, ind_col.key_ordinal
    CPU: 		109
    Reads: 		216
    Writes: 	0
    Duration: 	148322
    
    TextData: 	select col.name, col.column_id, st.name as DT_name, schema_name(st.schema_id) as DT_schema, col.max_length, col.precision, col.scale, bt.name as BT_name, col.collation_name, col.is_nullable, col.is_ansi_padded, col.is_rowguidcol, col.is_identity, case when(idc.column_id is null) then null else CONVERT(nvarchar(40), idc.seed_value) end, case when(idc.column_id is null) then null else CONVERT(nvarchar(40), idc.increment_value) end, CONVERT(bit, case when(cmc.column_id is null) then 0 else 1 end) as is_computed, convert(bit, ColumnProperty(col.object_id, col.name, N'IsIdNotForRepl')) as IsIdNotForRepl, col.is_replicated, col.is_non_sql_subscribed, col.is_merge_published, col.is_dts_replicated, col.rule_object_id, robj.name as Rul_name, schema_name(robj.schema_id) as Rul_schema, col.default_object_id, OBJECTPROPERTY(col.default_object_id, N'IsDefaultCnst') as is_defcnst, dobj.name as def_name, schema_name(dobj.schema_id) as def_schema, CONVERT(bit, case when (ftc.column_id is null) then 0 else 1 end) as is_FullTextCol, col_name(col.object_id, ftc.type_column_id) FT_type_column, ftc.language_id as FT_language_id, case when(cmc.column_id is null) then null else cmc.definition end as formular, case when(cmc.column_id is null) then null else cmc.is_persisted end as is_persisted, defCst.definition, COLUMNPROPERTY(col.object_id, col.name, 'IsDeterministic') as IsDeterministic, xmlcoll.name as xmlSchema_name, schema_name(xmlcoll.schema_id) as xmlSchema_schema, col.is_xml_document, col.is_sparse, col.is_column_set from sys.columns col left outer join sys.types st on st.user_type_id = col.user_type_id left outer join sys.types bt on bt.user_type_id = col.system_type_id left outer join sys.objects robj on robj.object_id = col.rule_object_id and robj.type = 'R' left outer join sys.objects dobj on dobj.object_id = col.default_object_id and dobj.type = 'D' left outer join sys.default_constraints defCst on defCst.parent_object_id = col.object_id and defCst.parent_column_id = col.column_id left outer join sys.identity_columns idc on idc.object_id = col.object_id and idc.column_id = col.column_id left outer join sys.computed_columns cmc on cmc.object_id = col.object_id and cmc.column_id = col.column_id left outer join sys.fulltext_index_columns ftc on ftc.object_id = col.object_id and ftc.column_id = col.column_id left outer join sys.xml_schema_collections xmlcoll on xmlcoll.xml_Collection_id = col.xml_Collection_id where col.object_id = object_id(N'dbo.rapports') order by col.column_id
    CPU: 		215
    Reads: 		6895
    Writes: 	0
    Duration: 	142054
    
    TextData: 	SELECT dtb.name AS [Name], dtb.database_id AS [ID], CAST(case when dtb.name in ('master','model','msdb','tempdb') then 1 else dtb.is_distributor end AS bit) AS [IsSystemObject], CAST(has_dbaccess(dtb.name) AS bit) AS [IsAccessible], dtb.collation_name AS [Collation], dtb.name AS [DatabaseName2] FROM master.sys.databases AS dtb ORDER BY [Name] ASC
    CPU: 		15
    Reads: 		324
    Writes: 	0
    Duration: 	111258


**Extra info!**

I run a script every night to backup the database. I have no idea if the 4 statements have nothing to do with that. The statement for the backup is the following:

    TextData: 	declare @DBName varchar(200)  declare @Filename varchar(1000)  declare @Description varchar(1000)    DECLARE AllDatabases CURSOR FOR  SELECT name AS Name  FROM MASTER.DBO.SYSDATABASES  WHERE [NAME] NOT IN('MODEL', 'tempdb')    OPEN AllDatabases    FETCH NEXT FROM AllDatabases INTO @DBName    WHILE @@FETCH_STATUS = 0  BEGIN    print ''  print ''  print 'Backing up database ' + @DBName    -- Backup the database  set @Filename = 'D:\backup\' + convert(varchar, getDate(), 112) + ' - ' + @DBName + '.bak'  set @Description = 'Full backup of database ' + @Filename  BACKUP DATABASE @DBName TO DISK = @Filename WITH INIT , NOUNLOAD , NAME = @Description, NOSKIP , STATS = 10, NOFORMAT      FETCH NEXT FROM AllDatabases INTO @DBName  END    CLOSE AllDatabases  DEALLOCATE AllDatabases
    CPU: 		219
    Reads: 		2569
    Writes: 	83
    Duration: 	4478260


Oh yeah and... I'm not used to profiling my SQL Server. Are there any tips you can give? :) I have of course been googling the topic.",2
7614720,09/30/2011 18:46:31,955289,09/20/2011 17:09:01,8,0,Return all records where all fields are equal except two,"I am looking for a way to determine which records have conflicting fields (null) where other fields are equal.  VehicleID and PartName are the fields that need to be equal and AttributeID is where I need to find the conflict.  The rest of the fields don't need to match.  For example:

ID|VehicleID|PartName|AttributeID|AttributeValueID|PartNumber<br>
123456|784|Air Filter|7|84|ABC123<br>
456789|784|Air Filter|NULL|NULL|ABC456<br>
321654|784|Air Filter|12|45|ABC789<br>
654321|784|Air Filter|7|84|ABC321<br>
987789|451|Air Filter|7|84|ABC123<br>
654456|451|Air Filter|7|84|ABC456<br>
123321|451|Air Filter|12|45|ABC789<br>
852258|451|Air Filter|7|84|ABC321<br>

I need the query to return this grouping:
ID|VehicleID|PartName|AttributeID|AttributeValueID|PartNumber<br>
123456|784|Air Filter|7|84|ABC123<br>
456789|784|Air Filter|NULL|NULL|ABC456<br>
123456|784|Air Filter|7|84|ABC321<br><br>
ID|VehicleID|PartName|AttributeID|AttributeValueID|PartNumber<br>
456789|784|Air Filter|NULL|NULL|ABC456<br>
123456|784|Air Filter|12|45|ABC789<br><br>
The records with VehicleID of 451 would not return because there is no conflict.

Thanks in advance!",sql-server,sql-server-2008,,,,10/01/2011 11:45:15,not a real question,1,89,10,"Return all records where all fields are equal except two I am looking for a way to determine which records have conflicting fields (null) where other fields are equal.  VehicleID and PartName are the fields that need to be equal and AttributeID is where I need to find the conflict.  The rest of the fields don't need to match.  For example:

ID|VehicleID|PartName|AttributeID|AttributeValueID|PartNumber<br>
123456|784|Air Filter|7|84|ABC123<br>
456789|784|Air Filter|NULL|NULL|ABC456<br>
321654|784|Air Filter|12|45|ABC789<br>
654321|784|Air Filter|7|84|ABC321<br>
987789|451|Air Filter|7|84|ABC123<br>
654456|451|Air Filter|7|84|ABC456<br>
123321|451|Air Filter|12|45|ABC789<br>
852258|451|Air Filter|7|84|ABC321<br>

I need the query to return this grouping:
ID|VehicleID|PartName|AttributeID|AttributeValueID|PartNumber<br>
123456|784|Air Filter|7|84|ABC123<br>
456789|784|Air Filter|NULL|NULL|ABC456<br>
123456|784|Air Filter|7|84|ABC321<br><br>
ID|VehicleID|PartName|AttributeID|AttributeValueID|PartNumber<br>
456789|784|Air Filter|NULL|NULL|ABC456<br>
123456|784|Air Filter|12|45|ABC789<br><br>
The records with VehicleID of 451 would not return because there is no conflict.

Thanks in advance!",2
3681357,09/09/2010 23:40:57,59198,01/27/2009 02:29:32,3928,180,Having problem generating a certificate request from a sql 2005 server,"I'm trying to generate a certificate request from a sql 2005 / windows 2008 server, so that i can get a certificate made and thus enable encryption on my sql connections from clients.

On the server, i do:

* start -> run -> mmc
* add 'certificates' snapin
* choose 'computer account'
* choose 'local computer'
* Right click the Certificates > Personal folder in the left hand tree pane, choose All tasks > Request new certificate

But then it gives me the error:

    Certificate Types are not available
    You cannot request a certificate at this time because no certificate types are available.
    The requested certificate template is not supported by this CA.
    A valid certification authority configured to issue certificates based on this template
    cannot be located, or the CA is not trusted.

Any ideas? We've got an enterprise CA, if that's worth knowing.
Thanks",sql-server,windows,ssl,certificate,,,open,0,152,11,"Having problem generating a certificate request from a sql 2005 server I'm trying to generate a certificate request from a sql 2005 / windows 2008 server, so that i can get a certificate made and thus enable encryption on my sql connections from clients.

On the server, i do:

* start -> run -> mmc
* add 'certificates' snapin
* choose 'computer account'
* choose 'local computer'
* Right click the Certificates > Personal folder in the left hand tree pane, choose All tasks > Request new certificate

But then it gives me the error:

    Certificate Types are not available
    You cannot request a certificate at this time because no certificate types are available.
    The requested certificate template is not supported by this CA.
    A valid certification authority configured to issue certificates based on this template
    cannot be located, or the CA is not trusted.

Any ideas? We've got an enterprise CA, if that's worth knowing.
Thanks",4
7496845,09/21/2011 08:35:35,956485,09/21/2011 08:35:35,1,0,dump data of sql server 7 on NT,"We've discovered an old NT machine which is running an (also old) SQL Server 7.0. We'd like to migrate this to a new machine, but the Quest SQL Navigator software that we were using has an expired key. Does anybody know a good (preferably free) tool to dump the data out of that old server to an SQL file?",sql-server,,,,,09/21/2011 10:19:34,off topic,1,59,8,"dump data of sql server 7 on NT We've discovered an old NT machine which is running an (also old) SQL Server 7.0. We'd like to migrate this to a new machine, but the Quest SQL Navigator software that we were using has an expired key. Does anybody know a good (preferably free) tool to dump the data out of that old server to an SQL file?",1
5062286,02/21/2011 04:26:01,625982,02/21/2011 04:26:01,1,0,"SQL Server, always rounding up","I need to always round up in SQL Server TSQL, such that I have the `Given` and need to return the `Needed Result`:

    Given         Needed Result
    -----------   --------------
    25            25
    25.1          26
    25.001        26
    12            12
    0.1            1
    0.001          1
    0              0",sql-server,sql-server-2005,tsql,,,,open,0,150,5,"SQL Server, always rounding up I need to always round up in SQL Server TSQL, such that I have the `Given` and need to return the `Needed Result`:

    Given         Needed Result
    -----------   --------------
    25            25
    25.1          26
    25.001        26
    12            12
    0.1            1
    0.001          1
    0              0",3
