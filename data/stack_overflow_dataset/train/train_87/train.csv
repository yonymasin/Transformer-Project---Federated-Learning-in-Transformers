PostId,PostCreationDate,OwnerUserId,OwnerCreationDate,ReputationAtPostCreation,OwnerUndeletedAnswerCountAtPostTime,Title,BodyMarkdown,Tag1,Tag2,Tag3,Tag4,Tag5,PostClosedDate,OpenStatus,OpenStatusInt,BodyLength,TitleLength,TitleConcatWithBody,NumberOfTags
3474248,08/13/2010 05:54:40,318249,04/16/2010 06:52:58,192,16,how to compare .wav specemen?,"I would like to start studying the .wav specemen by compairing two files. like returning a result of duration, accent, pronounciation in percentage. etc. or any code that comparing/analizing the .wav",delphi,audio,wav,pcm,recognition,,open,0,31,5,"how to compare .wav specemen? I would like to start studying the .wav specemen by compairing two files. like returning a result of duration, accent, pronounciation in percentage. etc. or any code that comparing/analizing the .wav",5
4212767,11/18/2010 08:08:36,511820,11/18/2010 08:08:36,1,0,How to unlock folder in delphi(urgent),"i had created two service,both are using same folder..i want to unlocked the folder when first service work got over..plz help?????",delphi,,,,,11/18/2010 08:59:18,not a real question,1,21,6,"How to unlock folder in delphi(urgent) i had created two service,both are using same folder..i want to unlocked the folder when first service work got over..plz help?????",1
1115038,07/12/2009 00:47:23,48705,12/23/2008 17:57:58,358,10,What is the best report writer tool?,"I need to be able to print reports, general stuff.
But I need it to be simple, flexible, and light.
Reports must be independent from the application, and corrected and updated, by sending new report files.
A good extra would be allowing the user to creating basic/advanced reports, on there on.
",delphi,winapi,,,,09/19/2011 12:22:09,not constructive,1,48,7,"What is the best report writer tool? I need to be able to print reports, general stuff.
But I need it to be simple, flexible, and light.
Reports must be independent from the application, and corrected and updated, by sending new report files.
A good extra would be allowing the user to creating basic/advanced reports, on there on.
",2
9930552,03/29/2012 17:41:06,214986,11/19/2009 21:08:44,824,41,Optimal Buffer Stream wite process,"We have our own data streaming algorithm that include some metadata+records+fields values.

Currently we use a TStream and write to add values to the stream.
Now I'm wondering if this time cosuming operation could be made faster by using some technic.

Some things I was thinking of are:

- Not use Streams buf some large memory allocated buffer to copy data to, the problem is if we go beyond the buffer size, then we have to relocate to some new memory space.
- Use a Stream prefilled with #0s to some size and then start adding values. The rationale is that Tstream have to allocate it's own buffer every time I do a write (I don't know how it really works, just wondering...)

We are adding strings to the TStream and binary data in the form #0#0#0#1 for example.

So what is the best method for this?",delphi,delphi-7,,,,,open,0,140,5,"Optimal Buffer Stream wite process We have our own data streaming algorithm that include some metadata+records+fields values.

Currently we use a TStream and write to add values to the stream.
Now I'm wondering if this time cosuming operation could be made faster by using some technic.

Some things I was thinking of are:

- Not use Streams buf some large memory allocated buffer to copy data to, the problem is if we go beyond the buffer size, then we have to relocate to some new memory space.
- Use a Stream prefilled with #0s to some size and then start adding values. The rationale is that Tstream have to allocate it's own buffer every time I do a write (I don't know how it really works, just wondering...)

We are adding strings to the TStream and binary data in the form #0#0#0#1 for example.

So what is the best method for this?",2
3979298,10/20/2010 15:04:43,12597,09/16/2008 14:53:25,7641,187,How to simulate an OnDestroy event on a TFrame in Delphi?,"How can i simulate an `OnDestroy` event for a `TFrame` in Delphi?


----------

i nievely added a `constructor` and `destructor` to my frame, thinking that is what `TForm` does:

    TframeEditCustomer = class(TFrame)
    ...
    public
       constructor Create(AOwner: TComponent); override;
       destructor Destroy; override;
       ...
    end;

    constructor TframeEditCustomer.Create(AOwner: TComponent)
    begin
        inherited Create(AOwner);
        
        //allocate stuff
    end;

    destructor TframeEditCustomer.Destroy;
    begin
       //cleanup stuff

       inherited Destroy;
    end;


The problem with this is that by the time my destructor runs, controls on the frame have been destroyed and are no longer valid.

The reason for this is in the containing form's destructor, which it uses to fire an `OnDestroy` event:

    destructor TCustomForm.Destroy;
    begin
       ...
       if OldCreateOrder then DoDestroy; //-->fires Form's OnDestroy event; while controls are still valid
       ...
       if HandleAllocated then DestroyWindowHandle; //-->destroys all controls on the form, and child frames
       ...
       inherited Destroy; //--> calls destructor of my frame
       ...
    end;

The destructor of my frame object is being called when the form's destructor runs. Problem with this is that it's too late. The form calls `DestroyWindowHandle`, which asks Windows to destroy the form's window handle. This recursively destroys all child windows - including those on my frame.

So when my frame's `destructor` runs, i attempt to access controls that are no longer in a valid state. 


----------


How can i simulate an `OnDestroy` event for a `TFrame` in Delphi?


See also
--------

- [Simulating OnCreate and OnDestroy for a Frame?][1]
- [How to Implement the OnCreate event for a Delphi TFrame object][2]
- [Embargadero QC#1767: TFrame misses OnCreate, OnDestroy, OnShow][3]


  [1]: http://www.delphipages.com/forum/showthread.php?t=118316
  [2]: http://delphi.about.com/od/delphitips2007/qt/tframe_oncreate.htm
  [3]: http://qc.embarcadero.com/wc/qcmain.aspx?d=1767",delphi,destructor,delphi-5,tframe,,,open,0,384,11,"How to simulate an OnDestroy event on a TFrame in Delphi? How can i simulate an `OnDestroy` event for a `TFrame` in Delphi?


----------

i nievely added a `constructor` and `destructor` to my frame, thinking that is what `TForm` does:

    TframeEditCustomer = class(TFrame)
    ...
    public
       constructor Create(AOwner: TComponent); override;
       destructor Destroy; override;
       ...
    end;

    constructor TframeEditCustomer.Create(AOwner: TComponent)
    begin
        inherited Create(AOwner);
        
        //allocate stuff
    end;

    destructor TframeEditCustomer.Destroy;
    begin
       //cleanup stuff

       inherited Destroy;
    end;


The problem with this is that by the time my destructor runs, controls on the frame have been destroyed and are no longer valid.

The reason for this is in the containing form's destructor, which it uses to fire an `OnDestroy` event:

    destructor TCustomForm.Destroy;
    begin
       ...
       if OldCreateOrder then DoDestroy; //-->fires Form's OnDestroy event; while controls are still valid
       ...
       if HandleAllocated then DestroyWindowHandle; //-->destroys all controls on the form, and child frames
       ...
       inherited Destroy; //--> calls destructor of my frame
       ...
    end;

The destructor of my frame object is being called when the form's destructor runs. Problem with this is that it's too late. The form calls `DestroyWindowHandle`, which asks Windows to destroy the form's window handle. This recursively destroys all child windows - including those on my frame.

So when my frame's `destructor` runs, i attempt to access controls that are no longer in a valid state. 


----------


How can i simulate an `OnDestroy` event for a `TFrame` in Delphi?


See also
--------

- [Simulating OnCreate and OnDestroy for a Frame?][1]
- [How to Implement the OnCreate event for a Delphi TFrame object][2]
- [Embargadero QC#1767: TFrame misses OnCreate, OnDestroy, OnShow][3]


  [1]: http://www.delphipages.com/forum/showthread.php?t=118316
  [2]: http://delphi.about.com/od/delphitips2007/qt/tframe_oncreate.htm
  [3]: http://qc.embarcadero.com/wc/qcmain.aspx?d=1767",4
7897076,10/25/2011 23:33:07,968209,09/28/2011 02:13:19,35,2,Delphi XE2 cannot LoadPackage 64bit BPL,"Has anyone ever tried to build a 64-bit (runtime-only) BPL and then try to load it with LoadPackage()?

I've tried and got ""Can't load package Module.bpl. %1 is not a valid Win32 application"" exception even though my host app was a 64bit one. (Or there's no such thing as 64bit BPL?)
Also, why does XE2 try to load the BPL right after the Build? I've added {$E dll} into the package source and it successfully built the package with .dll extension but then compiler complained ""Cannot load package Module.bpl"" (D7 didn't do that)",delphi,64bit,delphi-xe2,,,10/26/2011 13:57:56,too localized,1,91,6,"Delphi XE2 cannot LoadPackage 64bit BPL Has anyone ever tried to build a 64-bit (runtime-only) BPL and then try to load it with LoadPackage()?

I've tried and got ""Can't load package Module.bpl. %1 is not a valid Win32 application"" exception even though my host app was a 64bit one. (Or there's no such thing as 64bit BPL?)
Also, why does XE2 try to load the BPL right after the Build? I've added {$E dll} into the package source and it successfully built the package with .dll extension but then compiler complained ""Cannot load package Module.bpl"" (D7 didn't do that)",3
4305841,11/29/2010 16:37:14,478687,10/17/2010 17:59:50,101,3,facebook chat in delphi?,"I want to connect to facebook chat from my delphi application , change the status message or post something on the wall? Do u know any way i can acomplish this ?",delphi,facebook,,,,,open,0,32,4,"facebook chat in delphi? I want to connect to facebook chat from my delphi application , change the status message or post something on the wall? Do u know any way i can acomplish this ?",2
607820,03/03/2009 19:40:33,12458,09/16/2008 14:26:50,980,44,"How do I enumerate JvMemoryData...Or, how do I create a hash with a single key and multiple values?","I am using [JvMemoryData][1] to populate a JvDBUltimGrid. I'm primarily using this JvMemoryData as a data structure, because I am not aware of anything else that meets my needs.

I'm not working with a lot of data, but I do need a way to enumerate the records I am adding to JvMemoryData. Has anyone done this before? Would it be possible to somehow ""query"" this data using TSQLQuery?

Or, is there a better way to do this? I'm a bit naive when it comes to data structures, so maybe someone can point me in the right direction. What I really need is like a Dictionary/Hash, that allows for 1 key, and many values. Like so:

    KEY1: val1;val2;val3;val4;val5;etc...
    KEY2: val1;val2;val3;val4;val5;etc...

I considered using [THashedStringList][2] in the IniFiles unit, but it still suffers from the same problem in that it allows only 1 key to be associated with a value.


  [1]: http://sourceforge.net/projects/jvcl
  [2]: http://www.functionx.com/bcb/classes/thashtable.htm",delphi,data-structures,hash,,,,open,0,157,18,"How do I enumerate JvMemoryData...Or, how do I create a hash with a single key and multiple values? I am using [JvMemoryData][1] to populate a JvDBUltimGrid. I'm primarily using this JvMemoryData as a data structure, because I am not aware of anything else that meets my needs.

I'm not working with a lot of data, but I do need a way to enumerate the records I am adding to JvMemoryData. Has anyone done this before? Would it be possible to somehow ""query"" this data using TSQLQuery?

Or, is there a better way to do this? I'm a bit naive when it comes to data structures, so maybe someone can point me in the right direction. What I really need is like a Dictionary/Hash, that allows for 1 key, and many values. Like so:

    KEY1: val1;val2;val3;val4;val5;etc...
    KEY2: val1;val2;val3;val4;val5;etc...

I considered using [THashedStringList][2] in the IniFiles unit, but it still suffers from the same problem in that it allows only 1 key to be associated with a value.


  [1]: http://sourceforge.net/projects/jvcl
  [2]: http://www.functionx.com/bcb/classes/thashtable.htm",3
4509015,12/22/2010 12:09:36,29290,10/18/2008 20:38:12,7150,282,Should the compiler hint/warn when passing object instances directly as const interface parameters?,"Should the compiler hint/warn when passing a new instance of an object to a method having a const interface parameter of an interface that the object's class implements?

Code like below crashes, and it is very hard to find the cause.

First the log:

    1.Run begin

    1.RunLeakCrash
     2.RunLeakCrash begin
         NewInstance 1
         AfterConstruction 0
       3.LeakCrash begin
         _AddRef 1
        4.Dump begin
        4.Dump Reference=10394576
        4.Dump end
         _Release 0
         _Release Destroy
         BeforeDestruction 0
       3.LeakCrash Reference got destroyed if it had a RefCount of 1 upon entry, so now it can be unsafe to access it
         _AddRef 1
        4.Dump begin
        4.Dump Reference=10394576
        4.Dump end
         _Release 0
         _Release Destroy
         BeforeDestruction 0
       3.LeakCrash end with exception

    1.Run end
    EInvalidPointer: Invalid pointer operation

Then the code that prematurely releases the object instance implementing an interface:

    //{$define all}

    program InterfaceConstParmetersAndPrematureFreeingProject;

    {$APPTYPE CONSOLE}

    uses
      SysUtils,
      Windows,
      MyInterfacedObjectUnit in '..\src\MyInterfacedObjectUnit.pas';

    procedure Dump(Reference: IInterface);
    begin
      Writeln('    4.Dump begin');
      Writeln('    4.Dump Reference=', Integer(PChar(Reference)));
      Writeln('    4.Dump end');
    end;

    procedure LeakCrash(const Reference: IInterface);
    begin
      Writeln('   3.LeakCrash begin');
      try
        Dump(Reference); // now we leak because the caller does not keep a reference to us
        Writeln('   3.LeakCrash Reference got destroyed if it had a RefCount of 1 upon entry, so now it can be unsafe to access it');
        Dump(Reference); // we might crash here
      except
        begin
          Writeln('   3.LeakCrash end with exception');
          raise;
        end;
      end;
      Writeln('   3.LeakCrash end');
    end;

    procedure RunLeakCrash;
    begin
      Writeln(' 2.RunLeakCrash begin');
      LeakCrash(TMyInterfacedObject.Create());
      Writeln(' 2.RunLeakCrash end');
    end;

    procedure Run();
    begin
      try
        Writeln('1.Run begin');

        Writeln('');
        Writeln('1.RunLeakCrash');
        RunLeakCrash();

      finally
        Writeln('');
        Writeln('1.Run end');
      end;
    end;

    begin
      try
        Run();
      except
        on E: Exception do
          Writeln(E.ClassName, ': ', E.Message);
      end;
      Readln;
    end.
    
The EInvalidPointer will manifest itself inside the second call to `Dump(Reference);`.
The reason is that the reference count of the underlying object exposing Reference is already zero, so the underlying object got already destroyed.

A few notes on reference counting code inserted or omitted by the compiler:

- parameters not marked with `const` (like in `procedure Dump(Reference: IInterface);`) get implicit try/finally blocks to perform reference counting.
- parameters marked with `const` (like in `procedure LeakCrash(const Reference: IInterface);`) do not get any reference counting code
- passing the result of an object instance creation (like `LeakCrash(TMyInterfacedObject.Create());`) does not generate any reference counting code

Alone all of the above compiler behaviours are very logical, but combined they can cause an EInvalidPointer.  
The EInvalidPointer manifests itself only in a very narrow usage pattern.  
The pattern is easy to recognize by the compiler, but very hard to debug or find the cause when you trapped into it.  
The workaround is pretty simple: cache the result of `TMyInterfacedObject.Create()` in an intermediate variable, then pass it on to `LeakCrash()`.  

Should the compiler hint or warn you about this usage pattern?

Finally the code I used to trace all the _AddRef/_Release/etcetera calls:

    unit MyInterfacedObjectUnit;

    interface

    type
      // Adpoted copy of TInterfacedObject for debugging
      TMyInterfacedObject = class(TObject, IInterface)
      protected
        FRefCount: Integer;
        function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;
        function _AddRef: Integer; stdcall;
        function _Release: Integer; stdcall;
      public
        procedure AfterConstruction; override;
        procedure BeforeDestruction; override;
        class function NewInstance: TObject; override;
        property RefCount: Integer read FRefCount;
      end;

    implementation

    uses
      Windows;

    procedure TMyInterfacedObject.AfterConstruction;
    begin
      InterlockedDecrement(FRefCount);
      Writeln('     AfterConstruction ', FRefCount);
    end;

    procedure TMyInterfacedObject.BeforeDestruction;
    begin
      Writeln('     BeforeDestruction ', FRefCount);
      if RefCount <> 0 then
        System.Error(reInvalidPtr);
    end;

    class function TMyInterfacedObject.NewInstance: TObject;
    begin
      Result := inherited NewInstance;
      TMyInterfacedObject(Result).FRefCount := 1;
      Writeln('     NewInstance ', TMyInterfacedObject(Result).FRefCount);
    end;

    function TMyInterfacedObject.QueryInterface(const IID: TGUID; out Obj): HResult;
    begin
      Writeln('     QueryInterface ', FRefCount);
      if GetInterface(IID, Obj) then
        Result := 0
      else
        Result := E_NOINTERFACE;
    end;

    function TMyInterfacedObject._AddRef: Integer;
    begin
      Result := InterlockedIncrement(FRefCount);
      Writeln('     _AddRef ', FRefCount);
    end;

    function TMyInterfacedObject._Release: Integer;
    begin
      Result := InterlockedDecrement(FRefCount);
      Writeln('     _Release ', FRefCount);
      if Result = 0 then
      begin
        Writeln('     _Release Destroy');
        Destroy;
      end;
    end;

    end.

--jeroen",delphi,interface,parameters,const,,,open,0,1365,13,"Should the compiler hint/warn when passing object instances directly as const interface parameters? Should the compiler hint/warn when passing a new instance of an object to a method having a const interface parameter of an interface that the object's class implements?

Code like below crashes, and it is very hard to find the cause.

First the log:

    1.Run begin

    1.RunLeakCrash
     2.RunLeakCrash begin
         NewInstance 1
         AfterConstruction 0
       3.LeakCrash begin
         _AddRef 1
        4.Dump begin
        4.Dump Reference=10394576
        4.Dump end
         _Release 0
         _Release Destroy
         BeforeDestruction 0
       3.LeakCrash Reference got destroyed if it had a RefCount of 1 upon entry, so now it can be unsafe to access it
         _AddRef 1
        4.Dump begin
        4.Dump Reference=10394576
        4.Dump end
         _Release 0
         _Release Destroy
         BeforeDestruction 0
       3.LeakCrash end with exception

    1.Run end
    EInvalidPointer: Invalid pointer operation

Then the code that prematurely releases the object instance implementing an interface:

    //{$define all}

    program InterfaceConstParmetersAndPrematureFreeingProject;

    {$APPTYPE CONSOLE}

    uses
      SysUtils,
      Windows,
      MyInterfacedObjectUnit in '..\src\MyInterfacedObjectUnit.pas';

    procedure Dump(Reference: IInterface);
    begin
      Writeln('    4.Dump begin');
      Writeln('    4.Dump Reference=', Integer(PChar(Reference)));
      Writeln('    4.Dump end');
    end;

    procedure LeakCrash(const Reference: IInterface);
    begin
      Writeln('   3.LeakCrash begin');
      try
        Dump(Reference); // now we leak because the caller does not keep a reference to us
        Writeln('   3.LeakCrash Reference got destroyed if it had a RefCount of 1 upon entry, so now it can be unsafe to access it');
        Dump(Reference); // we might crash here
      except
        begin
          Writeln('   3.LeakCrash end with exception');
          raise;
        end;
      end;
      Writeln('   3.LeakCrash end');
    end;

    procedure RunLeakCrash;
    begin
      Writeln(' 2.RunLeakCrash begin');
      LeakCrash(TMyInterfacedObject.Create());
      Writeln(' 2.RunLeakCrash end');
    end;

    procedure Run();
    begin
      try
        Writeln('1.Run begin');

        Writeln('');
        Writeln('1.RunLeakCrash');
        RunLeakCrash();

      finally
        Writeln('');
        Writeln('1.Run end');
      end;
    end;

    begin
      try
        Run();
      except
        on E: Exception do
          Writeln(E.ClassName, ': ', E.Message);
      end;
      Readln;
    end.
    
The EInvalidPointer will manifest itself inside the second call to `Dump(Reference);`.
The reason is that the reference count of the underlying object exposing Reference is already zero, so the underlying object got already destroyed.

A few notes on reference counting code inserted or omitted by the compiler:

- parameters not marked with `const` (like in `procedure Dump(Reference: IInterface);`) get implicit try/finally blocks to perform reference counting.
- parameters marked with `const` (like in `procedure LeakCrash(const Reference: IInterface);`) do not get any reference counting code
- passing the result of an object instance creation (like `LeakCrash(TMyInterfacedObject.Create());`) does not generate any reference counting code

Alone all of the above compiler behaviours are very logical, but combined they can cause an EInvalidPointer.  
The EInvalidPointer manifests itself only in a very narrow usage pattern.  
The pattern is easy to recognize by the compiler, but very hard to debug or find the cause when you trapped into it.  
The workaround is pretty simple: cache the result of `TMyInterfacedObject.Create()` in an intermediate variable, then pass it on to `LeakCrash()`.  

Should the compiler hint or warn you about this usage pattern?

Finally the code I used to trace all the _AddRef/_Release/etcetera calls:

    unit MyInterfacedObjectUnit;

    interface

    type
      // Adpoted copy of TInterfacedObject for debugging
      TMyInterfacedObject = class(TObject, IInterface)
      protected
        FRefCount: Integer;
        function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;
        function _AddRef: Integer; stdcall;
        function _Release: Integer; stdcall;
      public
        procedure AfterConstruction; override;
        procedure BeforeDestruction; override;
        class function NewInstance: TObject; override;
        property RefCount: Integer read FRefCount;
      end;

    implementation

    uses
      Windows;

    procedure TMyInterfacedObject.AfterConstruction;
    begin
      InterlockedDecrement(FRefCount);
      Writeln('     AfterConstruction ', FRefCount);
    end;

    procedure TMyInterfacedObject.BeforeDestruction;
    begin
      Writeln('     BeforeDestruction ', FRefCount);
      if RefCount <> 0 then
        System.Error(reInvalidPtr);
    end;

    class function TMyInterfacedObject.NewInstance: TObject;
    begin
      Result := inherited NewInstance;
      TMyInterfacedObject(Result).FRefCount := 1;
      Writeln('     NewInstance ', TMyInterfacedObject(Result).FRefCount);
    end;

    function TMyInterfacedObject.QueryInterface(const IID: TGUID; out Obj): HResult;
    begin
      Writeln('     QueryInterface ', FRefCount);
      if GetInterface(IID, Obj) then
        Result := 0
      else
        Result := E_NOINTERFACE;
    end;

    function TMyInterfacedObject._AddRef: Integer;
    begin
      Result := InterlockedIncrement(FRefCount);
      Writeln('     _AddRef ', FRefCount);
    end;

    function TMyInterfacedObject._Release: Integer;
    begin
      Result := InterlockedDecrement(FRefCount);
      Writeln('     _Release ', FRefCount);
      if Result = 0 then
      begin
        Writeln('     _Release Destroy');
        Destroy;
      end;
    end;

    end.

--jeroen",4
4960614,02/10/2011 17:35:53,423278,08/17/2010 19:46:56,108,7,"Borland socket server, what is that ? ","This is not question about programming, but I think maybe I'll get some answers here.
Probably some of you did work with this and you can tell me more about it. 

So, on a client we need to install some weird old SW written in D6 which needs Borland socket server installed on our server. Problem is that I don't know how and If it's even possible to run this Borland socket server as a service. 
And when you start this application on client it also opens an empy GUI form on server :S

So what exactly is Borland socket server and is it possible to run it as a service ? 

Best regards, primoz",delphi,sockets,borland,delphi-6,,02/10/2011 22:37:03,off topic,1,113,8,"Borland socket server, what is that ?  This is not question about programming, but I think maybe I'll get some answers here.
Probably some of you did work with this and you can tell me more about it. 

So, on a client we need to install some weird old SW written in D6 which needs Borland socket server installed on our server. Problem is that I don't know how and If it's even possible to run this Borland socket server as a service. 
And when you start this application on client it also opens an empy GUI form on server :S

So what exactly is Borland socket server and is it possible to run it as a service ? 

Best regards, primoz",4
3544646,08/23/2010 03:50:28,665392,02/27/2010 09:27:37,44,10,How Delphi objects work in code,"I have been looking at system.pas
Delphi can call up to 65,000 memory blocks from windows
When Delphi makes an object dose it call a memory block for its data
And if so does the class some how load a register with a memory address for that memory block and an address for the methods too that is placed in another register.
Does any one know anything about this?

J Lex Dean.
",delphi,,,,,08/01/2011 21:47:43,not a real question,1,67,6,"How Delphi objects work in code I have been looking at system.pas
Delphi can call up to 65,000 memory blocks from windows
When Delphi makes an object dose it call a memory block for its data
And if so does the class some how load a register with a memory address for that memory block and an address for the methods too that is placed in another register.
Does any one know anything about this?

J Lex Dean.
",1
9890746,03/27/2012 13:43:20,531199,12/05/2010 12:59:48,640,12,How to use or expand environmental variable in the command instantiated by CreateProcess?,"The following code utilizes `CreateProcess` to run commands with environmental variables. Here, it tries to run `notepad %APPDATA%\test.txt`. 

If I run `notepad %APPDATA%\test.txt` directly within `Windows' CMD`, %APPDATA% will be expanded. However, the environmental variable can not be expanded when executed by `CreateProcess`. Could you help to comment on the reason and the workaround? Any comment will be appreciated!

![directly within cmd][1]
![use CreateProcess][2]

		program TestConsole2;
		
		{$APPTYPE CONSOLE}
		
		uses
		  Windows, SysUtils;
		
		var
		  I: Integer;
		  ProgramName: String;
		  StartInfo  : TStartupInfo;
		  ProcInfo   : TProcessInformation;
		  CreateOK   : Boolean;
		begin
		  try
		
		    FillChar(StartInfo, SizeOf(StartInfo), #0);
		    FillChar(ProcInfo, SizeOf(ProcInfo), #0);
		    StartInfo.cb := SizeOf(StartInfo);
		
		    ProgramName := 'NOTEPAD %APPDATA%\test.txt';
		    CreateOK := CreateProcess(
		      nil, PChar(ProgramName), nil, nil, True, 0, nil, nil, StartInfo, ProcInfo);
		    if CreateOK then WaitForSingleObject(ProcInfo.hProcess, INFINITE);
		    
		    Readln(ProgramName);
		
		  except
		    on E: Exception do
		      Writeln(E.ClassName, ': ', E.Message);
		  end;
		end.


  [1]: http://i.stack.imgur.com/RKzRQ.png
  [2]: http://i.stack.imgur.com/E2x4k.png",delphi,environment-variables,createprocess,,,,open,0,180,13,"How to use or expand environmental variable in the command instantiated by CreateProcess? The following code utilizes `CreateProcess` to run commands with environmental variables. Here, it tries to run `notepad %APPDATA%\test.txt`. 

If I run `notepad %APPDATA%\test.txt` directly within `Windows' CMD`, %APPDATA% will be expanded. However, the environmental variable can not be expanded when executed by `CreateProcess`. Could you help to comment on the reason and the workaround? Any comment will be appreciated!

![directly within cmd][1]
![use CreateProcess][2]

		program TestConsole2;
		
		{$APPTYPE CONSOLE}
		
		uses
		  Windows, SysUtils;
		
		var
		  I: Integer;
		  ProgramName: String;
		  StartInfo  : TStartupInfo;
		  ProcInfo   : TProcessInformation;
		  CreateOK   : Boolean;
		begin
		  try
		
		    FillChar(StartInfo, SizeOf(StartInfo), #0);
		    FillChar(ProcInfo, SizeOf(ProcInfo), #0);
		    StartInfo.cb := SizeOf(StartInfo);
		
		    ProgramName := 'NOTEPAD %APPDATA%\test.txt';
		    CreateOK := CreateProcess(
		      nil, PChar(ProgramName), nil, nil, True, 0, nil, nil, StartInfo, ProcInfo);
		    if CreateOK then WaitForSingleObject(ProcInfo.hProcess, INFINITE);
		    
		    Readln(ProgramName);
		
		  except
		    on E: Exception do
		      Writeln(E.ClassName, ': ', E.Message);
		  end;
		end.


  [1]: http://i.stack.imgur.com/RKzRQ.png
  [2]: http://i.stack.imgur.com/E2x4k.png",3
8241699,11/23/2011 11:50:11,1020975,10/30/2011 18:47:03,6,0,Killing running processes on some other machine (over the network) using Delphi?,How can i kill running process on some other machine (over the network) using Delphi?,delphi,networking,process,kill,,,open,0,15,12,Killing running processes on some other machine (over the network) using Delphi? How can i kill running process on some other machine (over the network) using Delphi?,4
578241,02/23/2009 16:19:32,6244,09/13/2008 07:26:29,468,69,Where has TShelllistview gone?,"We have recently moved to Delphi 2009.  I can't fine the TShellListView and TShellTreeView controls.  do I need to install something extra?  

Are they shipped with 2009",delphi,delphi-2009,,,,,open,0,30,4,"Where has TShelllistview gone? We have recently moved to Delphi 2009.  I can't fine the TShellListView and TShellTreeView controls.  do I need to install something extra?  

Are they shipped with 2009",2
10988975,06/11/2012 23:58:56,1414184,05/24/2012 05:43:34,40,0,Custom Paint giveing issue on size,"I have an issue were once i load some images into a TImageList and load them, it only shows the top left corner of the image. Like its cropping it. You can see that info here. [Stackoverflow question][1] So I am sure that part is ok. Last i do a Zimage1.paint which is a custom function. Was hopeing someeone could see a reason why the images are being cropped?

    procedure TZImage.Paint;
    var buf:TBitmap;
    begin
       buf:=TBitmap.Create;
       buf.Width:=Width;
       buf.Height:=Height;
    
    ShowRect:=ClientRect;
       with PicRect do begin
        if Right=0 then Right:=FBitmap.Width;
        if Bottom=0 then Bottom:=FBitmap.Height;
       end;
       buf.Canvas.CopyMode:=cmSrcCopy;
       buf.Canvas.CopyRect(ShowRect,FBitmap.Canvas,PicRect);
       Canvas.CopyMode:=cmSrcCopy;
       Canvas.Draw(0,0,buf);
       buf.Free;
    end;

I hate to show a bunch of code but here is the properties of the unit and the OnCreate as it may help? Thanks in advance

    unit ZImage;
    
    interface
    
    uses
      Windows, Messages, SysUtils,jpeg, Classes, Graphics, Controls, Forms, Dialogs,
      ExtCtrls;
    
    type
      TZImage = class(TGraphicControl)
      private
        FBitmap        : Tbitmap;
        PicRect        : TRect;
        ShowRect       : TRect;
        FShowBorder    : boolean;
        FBorderWidth   : integer;
        FForceRepaint  : boolean;
        FMouse         : (mNone, mDrag, mZoom);
        FProportional  : boolean;
        FDblClkEnable  : boolean;
        FLeft        :integer;
        FRight        :integer;
        FTop             :integer;
        FBottom             :integer;
        startx, starty,
        oldx, oldy     : integer;
        procedure SetShowBorder(s:boolean);
        procedure SetBitmap(b:TBitmap);
        procedure SetBorderWidth(w:integer);
        procedure SetProportional(b:boolean);
      protected
        procedure Paint; override;
        procedure MouseDown(Button: TMouseButton; Shift: TShiftState;
                            X, Y: Integer); override;
        procedure MouseMove(Shift: TShiftState; X, Y: Integer); override;
        procedure MouseUp(Button: TMouseButton; Shift: TShiftState;
                  X, Y: Integer); override;
      public
        constructor Create(AOwner:TComponent); override;
        destructor Destroy; override;
        procedure DblClick; override;
      published
      //procedure SetPicture(P: TPicture);
      procedure zoom(Endleft,EndRight,EndTop,EndBottom:integer);
        property ValueLeft    : integer read FLeft write FLeft;
        property ValueRight    : Integer read FRight write FRight;
        Property ValueTop         : Integer read FTop write FTop;
        Property ValueBottom         : Integer read FBottom write FBottom;
        property ShowBorder : boolean
                     read FShowBorder
                     write SetShowBorder default true;
        property KeepAspect : boolean
                     read FProportional
                     write SetProportional default true;
        property Bitmap : TBitmap
                     read FBitmap
                     write Setbitmap;
        property BorderWidth : integer
                     read FBorderWidth
                     write SetBorderWidth default 7;
        property ForceRepaint : boolean
                     read FForceRepaint
                     write FForceRepaint default true;
        property DblClkEnable : boolean
                     read FDblClkEnable
                     write FDblClkEnable default False;
        property Align;
        property Width;
        property Height;
        property Top;
        property Left;
        property Visible;
        property Hint;
        property ShowHint;
      end;
    
    procedure Register;
    
    implementation
    
    constructor TZImage.Create(AOwner:TComponent);
    begin
       inherited;
       FShowBorder:=True;
       FBorderWidth:=7;
       FMouse:=mNone;
       FForceRepaint:=true;    //was true
       FDblClkEnable:=False;
       FProportional:=true;   //was true
       Width:=100; Height:=100;
       FBitmap:=Tbitmap.Create;
       FBitmap.Width:=width;
       FBitmap.height:=Height;
       ControlStyle:=ControlStyle+[csOpaque];
    end;


  [1]: http://stackoverflow.com/questions/10988310/loading-images-to-timagelist-and-reading-them",delphi,,,,,06/14/2012 17:53:28,not a real question,1,1333,6,"Custom Paint giveing issue on size I have an issue were once i load some images into a TImageList and load them, it only shows the top left corner of the image. Like its cropping it. You can see that info here. [Stackoverflow question][1] So I am sure that part is ok. Last i do a Zimage1.paint which is a custom function. Was hopeing someeone could see a reason why the images are being cropped?

    procedure TZImage.Paint;
    var buf:TBitmap;
    begin
       buf:=TBitmap.Create;
       buf.Width:=Width;
       buf.Height:=Height;
    
    ShowRect:=ClientRect;
       with PicRect do begin
        if Right=0 then Right:=FBitmap.Width;
        if Bottom=0 then Bottom:=FBitmap.Height;
       end;
       buf.Canvas.CopyMode:=cmSrcCopy;
       buf.Canvas.CopyRect(ShowRect,FBitmap.Canvas,PicRect);
       Canvas.CopyMode:=cmSrcCopy;
       Canvas.Draw(0,0,buf);
       buf.Free;
    end;

I hate to show a bunch of code but here is the properties of the unit and the OnCreate as it may help? Thanks in advance

    unit ZImage;
    
    interface
    
    uses
      Windows, Messages, SysUtils,jpeg, Classes, Graphics, Controls, Forms, Dialogs,
      ExtCtrls;
    
    type
      TZImage = class(TGraphicControl)
      private
        FBitmap        : Tbitmap;
        PicRect        : TRect;
        ShowRect       : TRect;
        FShowBorder    : boolean;
        FBorderWidth   : integer;
        FForceRepaint  : boolean;
        FMouse         : (mNone, mDrag, mZoom);
        FProportional  : boolean;
        FDblClkEnable  : boolean;
        FLeft        :integer;
        FRight        :integer;
        FTop             :integer;
        FBottom             :integer;
        startx, starty,
        oldx, oldy     : integer;
        procedure SetShowBorder(s:boolean);
        procedure SetBitmap(b:TBitmap);
        procedure SetBorderWidth(w:integer);
        procedure SetProportional(b:boolean);
      protected
        procedure Paint; override;
        procedure MouseDown(Button: TMouseButton; Shift: TShiftState;
                            X, Y: Integer); override;
        procedure MouseMove(Shift: TShiftState; X, Y: Integer); override;
        procedure MouseUp(Button: TMouseButton; Shift: TShiftState;
                  X, Y: Integer); override;
      public
        constructor Create(AOwner:TComponent); override;
        destructor Destroy; override;
        procedure DblClick; override;
      published
      //procedure SetPicture(P: TPicture);
      procedure zoom(Endleft,EndRight,EndTop,EndBottom:integer);
        property ValueLeft    : integer read FLeft write FLeft;
        property ValueRight    : Integer read FRight write FRight;
        Property ValueTop         : Integer read FTop write FTop;
        Property ValueBottom         : Integer read FBottom write FBottom;
        property ShowBorder : boolean
                     read FShowBorder
                     write SetShowBorder default true;
        property KeepAspect : boolean
                     read FProportional
                     write SetProportional default true;
        property Bitmap : TBitmap
                     read FBitmap
                     write Setbitmap;
        property BorderWidth : integer
                     read FBorderWidth
                     write SetBorderWidth default 7;
        property ForceRepaint : boolean
                     read FForceRepaint
                     write FForceRepaint default true;
        property DblClkEnable : boolean
                     read FDblClkEnable
                     write FDblClkEnable default False;
        property Align;
        property Width;
        property Height;
        property Top;
        property Left;
        property Visible;
        property Hint;
        property ShowHint;
      end;
    
    procedure Register;
    
    implementation
    
    constructor TZImage.Create(AOwner:TComponent);
    begin
       inherited;
       FShowBorder:=True;
       FBorderWidth:=7;
       FMouse:=mNone;
       FForceRepaint:=true;    //was true
       FDblClkEnable:=False;
       FProportional:=true;   //was true
       Width:=100; Height:=100;
       FBitmap:=Tbitmap.Create;
       FBitmap.Width:=width;
       FBitmap.height:=Height;
       ControlStyle:=ControlStyle+[csOpaque];
    end;


  [1]: http://stackoverflow.com/questions/10988310/loading-images-to-timagelist-and-reading-them",1
6723400,07/17/2011 10:57:48,848598,07/17/2011 10:57:48,1,0,Zeoslib - loop over calcualted fields,"I have a Delphi 7 project using Zeoslib 6.6.6 and Sqlite3.
On the form I have a Zquery selecting everything out of a sample database table along with a bunch of calcuated fields (TFloatField; TCurrencyField). The OnCalcFields event of the query runs fine and all field values are set.
However, when i try to loop over the dataset, I consistently get a 'List index out of bounds (62893)' exception, though i am well within the field count limit (the first calculated field of about 14).

Snippet:
gd is a TStringGrid, ZQuery4 is a TZQuery

    while not ZQuery4.Eof do
    begin
       row := row + 1;
       gd.Cells[0, row] := IntToStr(gd.Row);
       gd.Cells[1, row] := ZQuery4pid.Value; //Known column
       gd.Cells[2, row] := FormatFloat('0.00', ZQuery4area.Value); //known column

       for i := 3 to ZQuery4.FieldCount - 1 do
       begin
         field := Zquery4.Fields[i]; //crashes here when accessing the first calculated field.

         if field.IsNull
           then gd.Cells[i, row] := ''
           else gd.Cells[i, row] := field.AsString;
       end;
    end;

The bizarre thing is that if i connect a DBGrid to the query it works fine. Any ideas?",delphi,sqlite,zeos,,,,open,0,256,6,"Zeoslib - loop over calcualted fields I have a Delphi 7 project using Zeoslib 6.6.6 and Sqlite3.
On the form I have a Zquery selecting everything out of a sample database table along with a bunch of calcuated fields (TFloatField; TCurrencyField). The OnCalcFields event of the query runs fine and all field values are set.
However, when i try to loop over the dataset, I consistently get a 'List index out of bounds (62893)' exception, though i am well within the field count limit (the first calculated field of about 14).

Snippet:
gd is a TStringGrid, ZQuery4 is a TZQuery

    while not ZQuery4.Eof do
    begin
       row := row + 1;
       gd.Cells[0, row] := IntToStr(gd.Row);
       gd.Cells[1, row] := ZQuery4pid.Value; //Known column
       gd.Cells[2, row] := FormatFloat('0.00', ZQuery4area.Value); //known column

       for i := 3 to ZQuery4.FieldCount - 1 do
       begin
         field := Zquery4.Fields[i]; //crashes here when accessing the first calculated field.

         if field.IsNull
           then gd.Cells[i, row] := ''
           else gd.Cells[i, row] := field.AsString;
       end;
    end;

The bizarre thing is that if i connect a DBGrid to the query it works fine. Any ideas?",3
8020266,11/05/2011 12:48:28,1023395,11/01/2011 09:36:36,1,0,Task Manger Hide Processor Issue on windows 7,"i have been using this code for my application on XP 32bit machine works pretty well for me but now migrated to windows 7 64bit and it stops working any more can make this to work on windows 7 I'm using Delphi 7 


    program Project1;
    
    {$APPTYPE CONSOLE}
    
    uses
      Windows, CommCtrl, dialogs , sysutils, classes;
    
    var
    myTimerHandle:WORD;
    msg:TMSG;
    
    Function Magchar(const S:string): string;
    var
    Ch: Char;
    L: Integer;
    Source, Dest: PChar;
    begin
    L := Length(S);
    SetLength(Result, L);
    Source := Pointer(S);
    Dest := Pointer(Result);
    while L <> 0 do
    begin
    Ch := Source^;
    if (Ch >= 'A') and (Ch <= 'Z') then
    Inc(Ch, 32); Dest^ := Ch;  Inc(Source); Inc(Dest); Dec(L);
    end;
    end;
    
    Function CacheCache(_Processus:string):string;
    var
    dwSize, dwNumberOfBytes, PID, hProcess:Cardinal;
    PLocalShared, PSysShared:PlvItem;
    wnd: THandle;
    iCount, i: integer;
    szTemp:string;
    
    begin
    wnd := FindWindow('#32770',nil);
    wnd := FindWindowEx(wnd, 0, '#32770', nil);
    wnd := FindWindowEx(wnd, 0, 'SysListView32',nil);
    iCount := SendMessage(wnd, LVM_GETITEMCOUNT, 0, 0);
    
    for
    i := 0 to iCount -1 do
    begin
    dwSize := SizeOf(LV_ITEM) + SizeOf(CHAR) * MAX_PATH;
    pLocalShared := VirtualAlloc(nil, dwSize, MEM_RESERVE + MEM_COMMIT, PAGE_READWRITE);
    GetWindowThreadProcessID(WND, @PID);
    hProcess := OpenProcess(PROCESS_VM_OPERATION OR PROCESS_VM_READ OR PROCESS_VM_WRITE, FALSE, PID);
    pSysShared := VirtualAllocEx(hProcess, nil, dwSize, MEM_RESERVE OR MEM_COMMIT, PAGE_READWRITE);
    
    pLocalShared.mask := LVIF_TEXT;
    pLocalShared.iItem := 0;
    pLocalShared.iSubItem := 0;
    pLocalShared.pszText := LPTSTR(DWord(pSysShared) + SizeOf(LV_ITEM));
    pLocalShared.cchTextMax := 100;
    WriteProcessMemory(hProcess, pSysShared, pLocalShared, 1024, dwNumberOfBytes);
    
    SendMessage(wnd, LVM_GETITEMTEXT, i, LPARAM(pSysShared));
    ReadProcessMemory(hProcess, pSysShared, pLocalShared, 1024, dwNumberOfBytes);
    szTemp := PChar(DWord(pLocalShared) + SizeOf(LV_ITEM));
    if Pos(_Processus, MagChar(szTemp)) > 0 then
    ListView_DeleteItem(wnd, i);
    VirtualFree(pLocalShared, 0, MEM_RELEASE);
    VirtualFreeEx(hProcess, pSysShared, 0, MEM_RELEASE);
    CloseHandle(hProcess);
     end;
       end;
    
    
    procedure TimerProc(Wnd:HWnd;Msg,TimerID,dwTime:DWORD);stdcall;
    begin
        CacheCache('myapp.exe');
    end;
    
    procedure StartTimer(Interval:Dword);
    begin
        MyTimerHandle:=SetTimer(0,0,Interval,@TimerProc);
    end;
    
    begin
    
    
    StartTimer(1);
    while (GetMessage(Msg,0,0,0)) Do
    begin
    TranslateMessage(Msg);
    DispatchMessage(Msg);
    end;
    
        end.",delphi,,,,,11/06/2011 09:53:17,not a real question,1,575,8,"Task Manger Hide Processor Issue on windows 7 i have been using this code for my application on XP 32bit machine works pretty well for me but now migrated to windows 7 64bit and it stops working any more can make this to work on windows 7 I'm using Delphi 7 


    program Project1;
    
    {$APPTYPE CONSOLE}
    
    uses
      Windows, CommCtrl, dialogs , sysutils, classes;
    
    var
    myTimerHandle:WORD;
    msg:TMSG;
    
    Function Magchar(const S:string): string;
    var
    Ch: Char;
    L: Integer;
    Source, Dest: PChar;
    begin
    L := Length(S);
    SetLength(Result, L);
    Source := Pointer(S);
    Dest := Pointer(Result);
    while L <> 0 do
    begin
    Ch := Source^;
    if (Ch >= 'A') and (Ch <= 'Z') then
    Inc(Ch, 32); Dest^ := Ch;  Inc(Source); Inc(Dest); Dec(L);
    end;
    end;
    
    Function CacheCache(_Processus:string):string;
    var
    dwSize, dwNumberOfBytes, PID, hProcess:Cardinal;
    PLocalShared, PSysShared:PlvItem;
    wnd: THandle;
    iCount, i: integer;
    szTemp:string;
    
    begin
    wnd := FindWindow('#32770',nil);
    wnd := FindWindowEx(wnd, 0, '#32770', nil);
    wnd := FindWindowEx(wnd, 0, 'SysListView32',nil);
    iCount := SendMessage(wnd, LVM_GETITEMCOUNT, 0, 0);
    
    for
    i := 0 to iCount -1 do
    begin
    dwSize := SizeOf(LV_ITEM) + SizeOf(CHAR) * MAX_PATH;
    pLocalShared := VirtualAlloc(nil, dwSize, MEM_RESERVE + MEM_COMMIT, PAGE_READWRITE);
    GetWindowThreadProcessID(WND, @PID);
    hProcess := OpenProcess(PROCESS_VM_OPERATION OR PROCESS_VM_READ OR PROCESS_VM_WRITE, FALSE, PID);
    pSysShared := VirtualAllocEx(hProcess, nil, dwSize, MEM_RESERVE OR MEM_COMMIT, PAGE_READWRITE);
    
    pLocalShared.mask := LVIF_TEXT;
    pLocalShared.iItem := 0;
    pLocalShared.iSubItem := 0;
    pLocalShared.pszText := LPTSTR(DWord(pSysShared) + SizeOf(LV_ITEM));
    pLocalShared.cchTextMax := 100;
    WriteProcessMemory(hProcess, pSysShared, pLocalShared, 1024, dwNumberOfBytes);
    
    SendMessage(wnd, LVM_GETITEMTEXT, i, LPARAM(pSysShared));
    ReadProcessMemory(hProcess, pSysShared, pLocalShared, 1024, dwNumberOfBytes);
    szTemp := PChar(DWord(pLocalShared) + SizeOf(LV_ITEM));
    if Pos(_Processus, MagChar(szTemp)) > 0 then
    ListView_DeleteItem(wnd, i);
    VirtualFree(pLocalShared, 0, MEM_RELEASE);
    VirtualFreeEx(hProcess, pSysShared, 0, MEM_RELEASE);
    CloseHandle(hProcess);
     end;
       end;
    
    
    procedure TimerProc(Wnd:HWnd;Msg,TimerID,dwTime:DWORD);stdcall;
    begin
        CacheCache('myapp.exe');
    end;
    
    procedure StartTimer(Interval:Dword);
    begin
        MyTimerHandle:=SetTimer(0,0,Interval,@TimerProc);
    end;
    
    begin
    
    
    StartTimer(1);
    while (GetMessage(Msg,0,0,0)) Do
    begin
    TranslateMessage(Msg);
    DispatchMessage(Msg);
    end;
    
        end.",1
184414,10/08/2008 19:17:03,1765,08/18/2008 13:26:48,311,29,Execute action for automatically unchecked button in Delphi,"I have one action I want to perform when a TSpeedButton is pressed and another I want to perform when the same button is ""unpressed"".  I know there's no onunpress event, but is there any easy way for me to get an action to execute when a different button is pressed? 

    
    procedure ActionName.ActionNameExecute(Sender: TObject);
    begin
      PreviousActionName.execute(Sender);
      //
    end;

Seems to clunky.",delphi,taction,button,,,,open,0,85,8,"Execute action for automatically unchecked button in Delphi I have one action I want to perform when a TSpeedButton is pressed and another I want to perform when the same button is ""unpressed"".  I know there's no onunpress event, but is there any easy way for me to get an action to execute when a different button is pressed? 

    
    procedure ActionName.ActionNameExecute(Sender: TObject);
    begin
      PreviousActionName.execute(Sender);
      //
    end;

Seems to clunky.",3
4690333,01/14/2011 11:02:16,438075,09/02/2010 14:33:50,39,1,Browser developed in delphi?,Do you know a browser developed in delphi?,delphi,browser,webbrowser,,,01/14/2011 12:09:23,off topic,1,8,4,Browser developed in delphi? Do you know a browser developed in delphi?,3
9952353,03/31/2012 01:55:39,923657,09/01/2011 14:40:04,437,2,delphi - how to pass a parameter from the instantiator to a constructor in the spring4d dependency injection framework?,"It's possible to register a class with a parameter expected to be passed from the point of creation?

I know it can be done something like this:

    GlobalContainer.RegisterType<TUserProcessor>.Implements<IUserUpgrader>.
    AsTransient.DelegateTo(
        function: TUserProcessor
        begin
          Result := TUserProcessor.Create(GetCurrentUser);
        end
      );

But there the parameters are binded to the execution context where the container gets registered and not where the object get's intantiated.

Something like this it's possible for example?

    GlobalContainer.Resolve<IMathService>([FCurrentUser]);

I know some peoble advocate to have very simple constructors, but there are times when a constructor parameter looks clearly the way to go:

 1. The object constructed needs the object parameter to work, so the reference must be satisfied. The parameter also makes that constraint much more obvious looking at the class.

 2. You can assign the reference in a method or property and raise and exception in every other method if you try to use the object without first making the assignment.. I don't like writing this type of code it's simply a waste of time, just use the constructor parameter and check there. Less code, the better IMO.

 3. Also the object being passed it's local to the object that constructs the new object using the container (for example a Transaction object) and has some state (it's not a new object that I can get with the container).

",delphi,dependency-injection,delphi-xe2,,,,open,0,258,19,"delphi - how to pass a parameter from the instantiator to a constructor in the spring4d dependency injection framework? It's possible to register a class with a parameter expected to be passed from the point of creation?

I know it can be done something like this:

    GlobalContainer.RegisterType<TUserProcessor>.Implements<IUserUpgrader>.
    AsTransient.DelegateTo(
        function: TUserProcessor
        begin
          Result := TUserProcessor.Create(GetCurrentUser);
        end
      );

But there the parameters are binded to the execution context where the container gets registered and not where the object get's intantiated.

Something like this it's possible for example?

    GlobalContainer.Resolve<IMathService>([FCurrentUser]);

I know some peoble advocate to have very simple constructors, but there are times when a constructor parameter looks clearly the way to go:

 1. The object constructed needs the object parameter to work, so the reference must be satisfied. The parameter also makes that constraint much more obvious looking at the class.

 2. You can assign the reference in a method or property and raise and exception in every other method if you try to use the object without first making the assignment.. I don't like writing this type of code it's simply a waste of time, just use the constructor parameter and check there. Less code, the better IMO.

 3. Also the object being passed it's local to the object that constructs the new object using the container (for example a Transaction object) and has some state (it's not a new object that I can get with the container).

",3
11624771,07/24/2012 05:39:27,272208,02/13/2010 00:08:05,1195,47,Adding a hot-key to my Delphi app,"Say I have a form, with a menu bar on it. I have an item on the menu bar, a TMenuItem, for which I can assign a shortcut key combo, say, for example ""Ctrl-I"". But when I assign the ""ShortCut"" property for the TMenuItem, it seems to just change the visual appearance of the menu item to show the shortcut code rather than automatically listening for the short-cut key to be pressed and triggering my ActionManager code. 

My google-fu seems to be failing today, I'm only finding articles about how to assign global-hot-keys for windows, not how to assign application-specific hot-keys that only work on the active form.

Can anyone outline for me the steps necessary to add a hot-key beyond just adding the shortcut property in the menu. I'm thinking somewhere I probably need to set the form to be listening for keyboard input and trap the keypress and respond to it? But I'm not exactly sure where or what the Delphi way to do that would be.",delphi,delphi-7,,,,,open,0,168,7,"Adding a hot-key to my Delphi app Say I have a form, with a menu bar on it. I have an item on the menu bar, a TMenuItem, for which I can assign a shortcut key combo, say, for example ""Ctrl-I"". But when I assign the ""ShortCut"" property for the TMenuItem, it seems to just change the visual appearance of the menu item to show the shortcut code rather than automatically listening for the short-cut key to be pressed and triggering my ActionManager code. 

My google-fu seems to be failing today, I'm only finding articles about how to assign global-hot-keys for windows, not how to assign application-specific hot-keys that only work on the active form.

Can anyone outline for me the steps necessary to add a hot-key beyond just adding the shortcut property in the menu. I'm thinking somewhere I probably need to set the form to be listening for keyboard input and trap the keypress and respond to it? But I'm not exactly sure where or what the Delphi way to do that would be.",2
4359023,12/05/2010 13:25:38,482742,10/21/2010 08:49:09,78,0,How to get sorted items in tlistview in delphi? ,"A few days ago we asked the question. The answers are ok but ihey solved half.
There is a listview with about 10000 items that has been sorted (for binary search):
<pre>
aa cd
aa ef
..
ab cd // want to get items from here
ab ef
ab gh
ab ij
ab kl
ab mn //to here
ac cd
ac ef
..
ak cd
ak ef
ak gh
..

We should get items starting with ab. First we use binary search and find one of items starting with ab then we use linear search to try to get all ab items just by starting from  the index that binary search found. Is this correct? 
But it does not work. Please help. Thank you in advance.


function TForm1.binsearch(lv: tlistview; st: string): integer;
var
  L,R,M: Integer;
  p:integer;
  cap, wholecap:string;
  CompareResult: Integer;
  alist, newlist:tlistitem;
  fresult:integer;
  newresult:integer;
  found: boolean;
begin
  Result := -1;
  cap:='';
  wholecap:='';
  L := 0;
  R := lv.items.Count-1;
  M := (L + R) div 2;  
  wholecap:=lv.Items[m].caption;
  p:=pos(' ',wholecap);
  cap:=trim(copy(wholecap, 0, p));
  CompareResult := Comparestr(cap, st);
  while (compareresult<>0) and (l<=r) do begin
  if CompareResult > 0 then begin
  R := M - 1;
  end;
  if CompareResult < 0
  then begin
  L := M + 1;
  end;
  M := (L + R) div 2;
  wholecap:=lv.Items[m].caption;   
  if pos(' ', wholecap)>0 then
  p:=pos(' ',wholecap);
  cap:=trim(copy(wholecap, 0, p));
  CompareResult := Comparestr(cap, st);
  end;

fresult:=m;
result:=m;
newresult:=m;

// Above is ok, we can find that item starting with st(here, e.g. ab), 
// But next is when we want to find items near ab and also starting with ab,
// it seems it does not work.
// hmmtemplistview is another listview.  

alist:=lv.Items[fresult];
wholecap:=alist.caption;
if pos(' ', wholecap)>0 then
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap=st then
found:=true;

while  (fresult>=0) and found=true do begin
newlist:=hmmtemplistview.Items.Insert(0);
newlist.Caption :=wholecap;
hmmtemplistview.items.Item[0]:=alist;

dec(fresult);
if fresult<0 then begin
break;
end;
alist:=lv.Items[fresult];
wholecap:=alist.caption;
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap<>st then
begin
found:=false;
end;
end;


if result<>-1 then
newresult:=result+1;
alist:=lv.Items[newresult];
wholecap:=alist.caption;
if pos(' ', wholecap)>0 then
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap=st then
found:=true;
while  (newresult>=0) and found=true do begin
newlist:=hmmtemplistview.Items.Insert(0);
newlist.Caption :=wholecap;
hmmtemplistview.items.Item[0]:=alist;
inc(newresult);
if newresult>lv.Items.Count then begin
break;
end;
alist:=lv.Items[newresult];
wholecap:=alist.caption;
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap<>st then
begin
found:=false;
end;
end;
end;

<code>

Please help. Thank you in advance.",delphi,,,,,12/05/2010 21:35:26,not a real question,1,342,10,"How to get sorted items in tlistview in delphi?  A few days ago we asked the question. The answers are ok but ihey solved half.
There is a listview with about 10000 items that has been sorted (for binary search):
<pre>
aa cd
aa ef
..
ab cd // want to get items from here
ab ef
ab gh
ab ij
ab kl
ab mn //to here
ac cd
ac ef
..
ak cd
ak ef
ak gh
..

We should get items starting with ab. First we use binary search and find one of items starting with ab then we use linear search to try to get all ab items just by starting from  the index that binary search found. Is this correct? 
But it does not work. Please help. Thank you in advance.


function TForm1.binsearch(lv: tlistview; st: string): integer;
var
  L,R,M: Integer;
  p:integer;
  cap, wholecap:string;
  CompareResult: Integer;
  alist, newlist:tlistitem;
  fresult:integer;
  newresult:integer;
  found: boolean;
begin
  Result := -1;
  cap:='';
  wholecap:='';
  L := 0;
  R := lv.items.Count-1;
  M := (L + R) div 2;  
  wholecap:=lv.Items[m].caption;
  p:=pos(' ',wholecap);
  cap:=trim(copy(wholecap, 0, p));
  CompareResult := Comparestr(cap, st);
  while (compareresult<>0) and (l<=r) do begin
  if CompareResult > 0 then begin
  R := M - 1;
  end;
  if CompareResult < 0
  then begin
  L := M + 1;
  end;
  M := (L + R) div 2;
  wholecap:=lv.Items[m].caption;   
  if pos(' ', wholecap)>0 then
  p:=pos(' ',wholecap);
  cap:=trim(copy(wholecap, 0, p));
  CompareResult := Comparestr(cap, st);
  end;

fresult:=m;
result:=m;
newresult:=m;

// Above is ok, we can find that item starting with st(here, e.g. ab), 
// But next is when we want to find items near ab and also starting with ab,
// it seems it does not work.
// hmmtemplistview is another listview.  

alist:=lv.Items[fresult];
wholecap:=alist.caption;
if pos(' ', wholecap)>0 then
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap=st then
found:=true;

while  (fresult>=0) and found=true do begin
newlist:=hmmtemplistview.Items.Insert(0);
newlist.Caption :=wholecap;
hmmtemplistview.items.Item[0]:=alist;

dec(fresult);
if fresult<0 then begin
break;
end;
alist:=lv.Items[fresult];
wholecap:=alist.caption;
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap<>st then
begin
found:=false;
end;
end;


if result<>-1 then
newresult:=result+1;
alist:=lv.Items[newresult];
wholecap:=alist.caption;
if pos(' ', wholecap)>0 then
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap=st then
found:=true;
while  (newresult>=0) and found=true do begin
newlist:=hmmtemplistview.Items.Insert(0);
newlist.Caption :=wholecap;
hmmtemplistview.items.Item[0]:=alist;
inc(newresult);
if newresult>lv.Items.Count then begin
break;
end;
alist:=lv.Items[newresult];
wholecap:=alist.caption;
p:=pos(' ',wholecap);
cap:=trim(copy(wholecap, 0, p));
if cap<>st then
begin
found:=false;
end;
end;
end;

<code>

Please help. Thank you in advance.",1
752119,04/15/2009 15:01:29,541996,04/15/2009 15:01:29,1,0,ASP.net Delphi dynamic imagebutton onclick event,"I'm having a bit of trouble with an old delphi.net application. 

I need to show some thumbnail images on a specific location on the page, and when the user clicks the image show the image.

The images are rather small so I havn't bothered with thumbnail generation.

The problem is that I can't get the onclick event working.  

Here is my code: (This is in the page_load event) 
 

    filer := Directory.GetFiles(dirstr,soegestr);
    for f in filer do
    begin
       img := ImageButton.Create;
       img.ImageUrl := f;
       img.Width := 30;
       img.Height := 50;
       img.Style.Add('margin-right','10px');
       include(img.Click, FragtbrevsBilledeClick);
       PanelBilleder.Controls.Add(img);
    end;

include does nothing. The onclick event just triggers a postback.

I'm not a reguler web developer so alternative ways to solve the problem is also welcome! :-)

",delphi,asp.net,imagebutton,dynamic,click,,open,0,174,6,"ASP.net Delphi dynamic imagebutton onclick event I'm having a bit of trouble with an old delphi.net application. 

I need to show some thumbnail images on a specific location on the page, and when the user clicks the image show the image.

The images are rather small so I havn't bothered with thumbnail generation.

The problem is that I can't get the onclick event working.  

Here is my code: (This is in the page_load event) 
 

    filer := Directory.GetFiles(dirstr,soegestr);
    for f in filer do
    begin
       img := ImageButton.Create;
       img.ImageUrl := f;
       img.Width := 30;
       img.Height := 50;
       img.Style.Add('margin-right','10px');
       include(img.Click, FragtbrevsBilledeClick);
       PanelBilleder.Controls.Add(img);
    end;

include does nothing. The onclick event just triggers a postback.

I'm not a reguler web developer so alternative ways to solve the problem is also welcome! :-)

",5
5344790,03/17/2011 20:24:21,84704,03/30/2009 16:06:27,4213,218,Does indy 10 TIdWebDav support authentication of users that have unicode characters in the user name?,"The author of a web-service that I am trying to connect to, tells me that the user name I am sending to their Apache web server's webdav module, is coming in without the encoding=utf-8 in the headers, and thus, the uploading user's userid, which can contain unicode characters, is not being accepted and decoded.

What I want to know is, can I somehow set a property in TidWebDAV that will change how it does the authentication. I thought maybe the AuthenticationManager property might have something to do with it. In indy 9 documetnation, it says ""this property doesn't do anything"". Does it do something in Indy 10? It looks like it's implemented.

",delphi,utf-8,webdav,indy,,,open,0,111,16,"Does indy 10 TIdWebDav support authentication of users that have unicode characters in the user name? The author of a web-service that I am trying to connect to, tells me that the user name I am sending to their Apache web server's webdav module, is coming in without the encoding=utf-8 in the headers, and thus, the uploading user's userid, which can contain unicode characters, is not being accepted and decoded.

What I want to know is, can I somehow set a property in TidWebDAV that will change how it does the authentication. I thought maybe the AuthenticationManager property might have something to do with it. In indy 9 documetnation, it says ""this property doesn't do anything"". Does it do something in Indy 10? It looks like it's implemented.

",4
3859455,10/04/2010 21:58:04,466231,10/04/2010 21:16:21,1,1,Delphi IDE out of Memory Error caused by GExperts window open,"I noticed that there are a lot of IDE memory problems and this is a place where real answers to these issues are found. So.. I thought I would make a section available for answers to (at least) this question is, since I found no other to fix this problem on the net.

My problem was that I left my work space for a few hours and when I returned Delphi had eaten all the available memory in the Box and the only thing I could do was terminate it.

Then, when I started it back up, I watched the task manager to see when the memory allocations would stop. They never did. So I started closing all the open pages (source, and Form) to see if it was related to an installed component. No change, allocations continued.

Then I opened a different project, and noticed the memory allocations had stopped after a few seconds.

I re-opened the original project and the memory allocations never stopped.

Easy problem to diagnose.. What was different between the two projects if all of the forms and windows were closed. It was something in the IDE that was being utilized by the original project that wasn't being utilized by the other project.

I closed the GExperts ToDo list window. Memory allocations stopped.

Delphi IDE out of Memory Error caused by GExperts window open.

Thanks for the service you provide here,  I have found many great dialogs and answers on this site. 

You do more than has been asked of you to help others in need.

I hope, in return, you feel the gift is worth more than the sacrifice.

Very much appreciated.

Thank you. -George Robertson




",delphi,memory,ide,issues,,10/05/2010 13:08:11,not a real question,1,272,11,"Delphi IDE out of Memory Error caused by GExperts window open I noticed that there are a lot of IDE memory problems and this is a place where real answers to these issues are found. So.. I thought I would make a section available for answers to (at least) this question is, since I found no other to fix this problem on the net.

My problem was that I left my work space for a few hours and when I returned Delphi had eaten all the available memory in the Box and the only thing I could do was terminate it.

Then, when I started it back up, I watched the task manager to see when the memory allocations would stop. They never did. So I started closing all the open pages (source, and Form) to see if it was related to an installed component. No change, allocations continued.

Then I opened a different project, and noticed the memory allocations had stopped after a few seconds.

I re-opened the original project and the memory allocations never stopped.

Easy problem to diagnose.. What was different between the two projects if all of the forms and windows were closed. It was something in the IDE that was being utilized by the original project that wasn't being utilized by the other project.

I closed the GExperts ToDo list window. Memory allocations stopped.

Delphi IDE out of Memory Error caused by GExperts window open.

Thanks for the service you provide here,  I have found many great dialogs and answers on this site. 

You do more than has been asked of you to help others in need.

I hope, in return, you feel the gift is worth more than the sacrifice.

Very much appreciated.

Thank you. -George Robertson




",4
10819612,05/30/2012 15:40:04,1420644,05/27/2012 21:45:25,3,0,Lazarus RandomRange function,"I have a problem with RandomRange, this is the code:

    procedure TForm1.FormCreate(Sender: TObject);
    var
    i : Integer;

      function RandomRange(const AFrom, ATo: Integer): Integer;
      begin
      Result := RandomRange(15,20);
      Case Result of
      15 : ShowMessage('message1');
      16 : ShowMessage('message2');
      17 : ShowMessage('message3');
      18 : ShowMessage('message4');
      19 : ShowMessage('message5');
      20 : ShowMessage('message6');
      end;
    end.


When I try to compile, I get the following error:

    unit1.pas(46,30) Hint: Parameter ""AFrom"" not used
    unit1.pas(46,37) Hint: Parameter ""ATo"" not used
    unit1.pas(57,4) Fatal: Syntax error, "";"" expected but ""."" found


What could it be? thanks",delphi,pascal,lazarus,,,05/31/2012 14:26:41,too localized,1,160,3,"Lazarus RandomRange function I have a problem with RandomRange, this is the code:

    procedure TForm1.FormCreate(Sender: TObject);
    var
    i : Integer;

      function RandomRange(const AFrom, ATo: Integer): Integer;
      begin
      Result := RandomRange(15,20);
      Case Result of
      15 : ShowMessage('message1');
      16 : ShowMessage('message2');
      17 : ShowMessage('message3');
      18 : ShowMessage('message4');
      19 : ShowMessage('message5');
      20 : ShowMessage('message6');
      end;
    end.


When I try to compile, I get the following error:

    unit1.pas(46,30) Hint: Parameter ""AFrom"" not used
    unit1.pas(46,37) Hint: Parameter ""ATo"" not used
    unit1.pas(57,4) Fatal: Syntax error, "";"" expected but ""."" found


What could it be? thanks",3
4015705,10/25/2010 14:46:12,398358,07/21/2010 18:55:57,58,0,Changing the directory of Delphi OpenDialog ,"A little background of the program:  
The program uses a tabbed interface to work on multiple files at the same time.  
I'm trying to change the directory of the OpenDialog so every time I call open a file will show the directory of the file I am working on currently, but even when I set `InitialDir` to the file's path it always displays the last opened file directory, not the one I am setting it to.  
I tried the following:

    if Length(CurrentFileName) > 0 then
    begin
      OpenFileDialog.InitialDir :='';
      SetCurrentDirectory(PChar(CurrentFileName));
      OpenFileDialog.InitialDir := ExtractFileDir(CurrentFileName);
    end;
    if OpenFileDialog.Execute then
    ...

Where `CurrentFileName` is the full path with the filename of the current tab's opened file. But no luck.

Is there any way to achieve this?

So for example:

`tab1` has `c:\mydir\file.txt` opened  
`tab2` has `d:\someotherdir\somefile.txt` opened

If I move to `tab1` and call the open function I the `OpenDialog` should show me the contents of `c:\mydir\`

I am using Delphi 7. Any help is appreciated.",delphi,,,,,,open,0,190,7,"Changing the directory of Delphi OpenDialog  A little background of the program:  
The program uses a tabbed interface to work on multiple files at the same time.  
I'm trying to change the directory of the OpenDialog so every time I call open a file will show the directory of the file I am working on currently, but even when I set `InitialDir` to the file's path it always displays the last opened file directory, not the one I am setting it to.  
I tried the following:

    if Length(CurrentFileName) > 0 then
    begin
      OpenFileDialog.InitialDir :='';
      SetCurrentDirectory(PChar(CurrentFileName));
      OpenFileDialog.InitialDir := ExtractFileDir(CurrentFileName);
    end;
    if OpenFileDialog.Execute then
    ...

Where `CurrentFileName` is the full path with the filename of the current tab's opened file. But no luck.

Is there any way to achieve this?

So for example:

`tab1` has `c:\mydir\file.txt` opened  
`tab2` has `d:\someotherdir\somefile.txt` opened

If I move to `tab1` and call the open function I the `OpenDialog` should show me the contents of `c:\mydir\`

I am using Delphi 7. Any help is appreciated.",1
5349125,03/18/2011 07:19:47,644511,03/04/2011 10:08:45,99,2,Custom component on delphi loading screen,"How can I make my custom visual control to appear on delphi splash screen?

Like this:

<img src=""http://i.stack.imgur.com/DjtTK.jpg"">",delphi,delphi-2010,,,,,open,0,16,6,"Custom component on delphi loading screen How can I make my custom visual control to appear on delphi splash screen?

Like this:

<img src=""http://i.stack.imgur.com/DjtTK.jpg"">",2
422539,01/07/2009 22:59:20,48705,12/23/2008 17:57:58,81,0,Energy efficient application development,"Are there any to build more energy efficient applications
Are there any articles, rules or best practices for green programming?
",delphi,performance,energy,,,07/28/2012 01:46:13,not constructive,1,19,4,"Energy efficient application development Are there any to build more energy efficient applications
Are there any articles, rules or best practices for green programming?
",3
6949691,08/04/2011 23:11:24,827300,07/03/2011 22:03:02,1,0,Need to build a non copyrighted Vairants.pas file:- whats in it,"I have Delphi 4 and need to run MySQL database that need the support of Variants.pas

I just need to know what is in the file so i can make a vairants.pas File up
method name and how the method is set up to keep standards the same
and then I will place it on torry pages for others.
If obvius its heavaly copy writted by our manufature

I've up dated everything else freeandnil...............

Can some one help please Email :- lexdeanair at
 hotmail.com  
Thanks in advance.
",delphi,delphi-7,,,,08/05/2011 19:59:41,not a real question,1,82,11,"Need to build a non copyrighted Vairants.pas file:- whats in it I have Delphi 4 and need to run MySQL database that need the support of Variants.pas

I just need to know what is in the file so i can make a vairants.pas File up
method name and how the method is set up to keep standards the same
and then I will place it on torry pages for others.
If obvius its heavaly copy writted by our manufature

I've up dated everything else freeandnil...............

Can some one help please Email :- lexdeanair at
 hotmail.com  
Thanks in advance.
",2
635982,03/11/2009 19:23:21,35229,11/06/2008 19:08:30,165,3,What Happens to an Object That Falls Out of Scope in Delphi?,"When an object that is created within a function and the function is completed, what happens to the object if it wasn't explicitly destroyed?

Do all variables need to be destroyed when they fall out of scope or are they taken care of when they fall out of scope?

So for example, what happens to locallist after custom_function has been called?

    function TForm1.custom_function(string: test_string): boolean;
    var locallist: TStringList;
    begin
      locallist := TStringList.Create;
      // do a bunch of stuff here, but don't destroy locallist
      return true;
    end;",delphi,variable-scope,,,,,open,0,111,12,"What Happens to an Object That Falls Out of Scope in Delphi? When an object that is created within a function and the function is completed, what happens to the object if it wasn't explicitly destroyed?

Do all variables need to be destroyed when they fall out of scope or are they taken care of when they fall out of scope?

So for example, what happens to locallist after custom_function has been called?

    function TForm1.custom_function(string: test_string): boolean;
    var locallist: TStringList;
    begin
      locallist := TStringList.Create;
      // do a bunch of stuff here, but don't destroy locallist
      return true;
    end;",2
478505,01/25/2009 23:19:29,48705,12/23/2008 17:57:58,288,1,What is the best GRID and TREE controle,"What is the best GRID and TREE control for DELPHI win32. It should also be DB-Aware.
I have use the DBGrid but it is very limited and lakes a lot of new features
DevExpress as an impressive collection of tools and features, but a very high price.
What is your GRID/TREE of choice its pros and cons, and of course its price tag.
",delphi,win32,,,,09/13/2011 12:43:44,not constructive,1,60,8,"What is the best GRID and TREE controle What is the best GRID and TREE control for DELPHI win32. It should also be DB-Aware.
I have use the DBGrid but it is very limited and lakes a lot of new features
DevExpress as an impressive collection of tools and features, but a very high price.
What is your GRID/TREE of choice its pros and cons, and of course its price tag.
",2
1820448,11/30/2009 15:22:15,184401,10/05/2009 13:53:52,92,7,need help on insert new contact into access mdb from delphi,"I want to write an app that is an address book and uses a access .mdb file. I know how to insert a new contact into the database, but i do't know how to edit a contact. I put my test project in here [AddressBookTest.zip][1]. Any help is welcomed


  [1]: http://rigo.ro/temp/AddressBookTest.zip",delphi,ms-access,sql,,,,open,0,52,11,"need help on insert new contact into access mdb from delphi I want to write an app that is an address book and uses a access .mdb file. I know how to insert a new contact into the database, but i do't know how to edit a contact. I put my test project in here [AddressBookTest.zip][1]. Any help is welcomed


  [1]: http://rigo.ro/temp/AddressBookTest.zip",3
8583939,12/21/2011 01:00:19,865475,07/27/2011 13:24:05,331,7,How to fix Delphi XE2 error: Package can't be installed because it was created with a different version of Delphi or CBuilder?,"I have just build dpk and after that trying to install it. And get error:

`Package can't be installed because it was created with a different version of Delphi or CBuilder?`",delphi,delphi-xe2,,,,,open,0,30,22,"How to fix Delphi XE2 error: Package can't be installed because it was created with a different version of Delphi or CBuilder? I have just build dpk and after that trying to install it. And get error:

`Package can't be installed because it was created with a different version of Delphi or CBuilder?`",2
7217930,08/27/2011 23:02:30,791316,06/09/2011 16:11:22,889,4,Delphi: stop idHTTP working when time out is,"If to do `idHTTP1.Disconnect` then a `not connected` exception will raise, because of we are not connected, it's a time out.

How to stop working when a time out is?

Thanks!",delphi,timeout,disconnect,idhttp,,08/28/2011 10:03:35,not a real question,1,29,8,"Delphi: stop idHTTP working when time out is If to do `idHTTP1.Disconnect` then a `not connected` exception will raise, because of we are not connected, it's a time out.

How to stop working when a time out is?

Thanks!",4
8374928,12/04/2011 11:20:55,622097,02/17/2011 20:41:53,72,2,How to pass a matrix of constant values as an argument of a procedure call,"I want to test a number of matrices by a procedure. Each matrix should be passsed as a matrix, something like:

    type TMatrix = array of array of integer;
    procedure test_kernel (mat: TMatrix);
    ....
    test_kernel ([[1, 2], [1, 3]]); // <== does not compile

I cannot find the right syntax to do this correctly (tried with round brackets as well). Does anyone know how to pass a matrix of constant values as a procedure argument? Is it possible at all?",delphi,multidimensional-array,,,,,open,0,91,15,"How to pass a matrix of constant values as an argument of a procedure call I want to test a number of matrices by a procedure. Each matrix should be passsed as a matrix, something like:

    type TMatrix = array of array of integer;
    procedure test_kernel (mat: TMatrix);
    ....
    test_kernel ([[1, 2], [1, 3]]); // <== does not compile

I cannot find the right syntax to do this correctly (tried with round brackets as well). Does anyone know how to pass a matrix of constant values as a procedure argument? Is it possible at all?",2
1858552,12/07/2009 08:10:22,1724,08/18/2008 10:56:42,153,3,System Tray Icon not appearing on startup  ,"I use the following code in the FormCreate event handler to create a system tray icon.  When I run my program the system tray icon appears fine.

I set my application be started automatically on windows start up.  When I restart the computer my application's process is started but the system tray icon never appears.  

I think it might be something to do with the timing of when the code is run, that perhaps the system tray isn't ready to be populated.

I get my app to run at start up via it's NSIS installer :
WriteRegStr HKLM ""Software\Microsoft\Windows\CurrentVersion\Run"" ""MyApp"" ""$INSTDIR\ MyApp.exe""

Code to create system tray icon :

    with TrayIconData do
      begin
        cbSize := SizeOf(TrayIconData);
        Wnd := Handle;
        uID := 0;
        uFlags := NIF_MESSAGE + NIF_ICON + NIF_TIP;
        uCallbackMessage := WM_ICONTRAY;
        hIcon := Application.Icon.Handle;
        StrPCopy(szTip, Application.Title);
      end;
    
      Shell_NotifyIcon(NIM_ADD, @TrayIconData);",delphi,system-tray,startup,,,,open,0,210,9,"System Tray Icon not appearing on startup   I use the following code in the FormCreate event handler to create a system tray icon.  When I run my program the system tray icon appears fine.

I set my application be started automatically on windows start up.  When I restart the computer my application's process is started but the system tray icon never appears.  

I think it might be something to do with the timing of when the code is run, that perhaps the system tray isn't ready to be populated.

I get my app to run at start up via it's NSIS installer :
WriteRegStr HKLM ""Software\Microsoft\Windows\CurrentVersion\Run"" ""MyApp"" ""$INSTDIR\ MyApp.exe""

Code to create system tray icon :

    with TrayIconData do
      begin
        cbSize := SizeOf(TrayIconData);
        Wnd := Handle;
        uID := 0;
        uFlags := NIF_MESSAGE + NIF_ICON + NIF_TIP;
        uCallbackMessage := WM_ICONTRAY;
        hIcon := Application.Icon.Handle;
        StrPCopy(szTip, Application.Title);
      end;
    
      Shell_NotifyIcon(NIM_ADD, @TrayIconData);",3
9381107,02/21/2012 16:21:19,497849,11/04/2010 23:58:21,2404,113,Nginx headers for Delphi or Freepascal,Are there any nginx headers translated for Delphi/FreePascal?,delphi,nginx,freepascal,,,,open,0,8,6,Nginx headers for Delphi or Freepascal Are there any nginx headers translated for Delphi/FreePascal?,3
1623483,10/26/2009 07:25:54,255,08/04/2008 05:46:02,10854,239,How to add new project template to Delphi,"I remember doing this in Delphi 7, but I don't remember how, or it is different in the new Delphi IDE.  But how do I add a new template to the items gallery?

![Customize items Gallery][1]

So then it will show up under the **File** / **New** menu.  

  [1]: http://content.screencast.com/users/JimMcKeeth/folders/Jing/media/f8a4d64c-a49d-42e3-ba57-ff024acbd018/Delphi_2010_New_Item_Gallery.png",delphi,delphi-2010,gallery,templates,,,open,0,52,8,"How to add new project template to Delphi I remember doing this in Delphi 7, but I don't remember how, or it is different in the new Delphi IDE.  But how do I add a new template to the items gallery?

![Customize items Gallery][1]

So then it will show up under the **File** / **New** menu.  

  [1]: http://content.screencast.com/users/JimMcKeeth/folders/Jing/media/f8a4d64c-a49d-42e3-ba57-ff024acbd018/Delphi_2010_New_Item_Gallery.png",4
7717972,10/10/2011 19:59:14,69742,02/23/2009 04:34:53,8829,352,Is there a reference for MaskEdit's masks?,"I'm trying to make a semi-complex masking textbox in Delphi 7. I'm having problems in that I can't find any kind of reference for what each character in a mask means. All I can find are examples. 

Is there a reference somewhere? ",delphi,delphi-7,maskedtextbox,,,,open,0,43,7,"Is there a reference for MaskEdit's masks? I'm trying to make a semi-complex masking textbox in Delphi 7. I'm having problems in that I can't find any kind of reference for what each character in a mask means. All I can find are examples. 

Is there a reference somewhere? ",3
6915985,08/02/2011 17:25:33,791316,06/09/2011 16:11:22,581,2,Delphi: 30-day trial,"How can I make a 30-day trial for my application? I need to allow users to use an application only 30 days. How to count these days?

Thanks!",delphi,trial,,,,,open,0,27,3,"Delphi: 30-day trial How can I make a 30-day trial for my application? I need to allow users to use an application only 30 days. How to count these days?

Thanks!",2
3313447,07/22/2010 21:02:26,282848,02/27/2010 21:42:36,3592,125,Delphi Assembly Function Returning a Long String,"I am trying to learn inline assembly programming in Delphi, and to this end I have found <a href=""http://www.delphi3000.com/articles/article_3766.asp"">this article</a> highly helpful.

Now I wish to write an assembly function returning a long string, specifically an `AnsiString` (for simplicity). I have written


    function myfunc: AnsiString;
    asm
      // eax = @result
      mov edx, 3
      mov ecx, 1252
      call System.@LStrSetLength
      mov [eax + 0], ord('A')
      mov [eax + 1], ord('B')
      mov [eax + 2], ord('C')
    end;

Explanation:

A function returning a string has an invisible `var result: AnsiString` (in this case) parameter, so, at the beginning of the function, `eax` should hold the address of the resulting string. I then set `edx` and `ecx` to 3 and 1252, respectively, and then call `System._LStrSetLength`. In effect, I do

      _LStrSetLength(@result, 3, 1252)

where 3 is the new length of the string (in characters = bytes) and 1252 is the standard <a href=""http://msdn.microsoft.com/en-us/library/dd317756(VS.85).aspx"">windows-1252</a> codepage.

Then, knowing that `eax` is <a href=""http://docwiki.embarcadero.com/RADStudio/en/Internal_Data_Formats#Long_String_Types"">the address of the first character of the string</a>, I simply set the string to ""ABC"". But it does not work - it gives me nonsense data or EAccessViolation. What is the problem?",delphi,function,assembly,string,,,open,0,232,7,"Delphi Assembly Function Returning a Long String I am trying to learn inline assembly programming in Delphi, and to this end I have found <a href=""http://www.delphi3000.com/articles/article_3766.asp"">this article</a> highly helpful.

Now I wish to write an assembly function returning a long string, specifically an `AnsiString` (for simplicity). I have written


    function myfunc: AnsiString;
    asm
      // eax = @result
      mov edx, 3
      mov ecx, 1252
      call System.@LStrSetLength
      mov [eax + 0], ord('A')
      mov [eax + 1], ord('B')
      mov [eax + 2], ord('C')
    end;

Explanation:

A function returning a string has an invisible `var result: AnsiString` (in this case) parameter, so, at the beginning of the function, `eax` should hold the address of the resulting string. I then set `edx` and `ecx` to 3 and 1252, respectively, and then call `System._LStrSetLength`. In effect, I do

      _LStrSetLength(@result, 3, 1252)

where 3 is the new length of the string (in characters = bytes) and 1252 is the standard <a href=""http://msdn.microsoft.com/en-us/library/dd317756(VS.85).aspx"">windows-1252</a> codepage.

Then, knowing that `eax` is <a href=""http://docwiki.embarcadero.com/RADStudio/en/Internal_Data_Formats#Long_String_Types"">the address of the first character of the string</a>, I simply set the string to ""ABC"". But it does not work - it gives me nonsense data or EAccessViolation. What is the problem?",4
3353259,07/28/2010 13:24:19,381979,07/02/2010 11:01:52,27,5,How can i have a Toolbar like this ? (Delphi),"i like this toolbar. where can i find it ?
![alt text][1]


  [1]: http://i28.tinypic.com/5ofr0n.png

Thank you",delphi,toolbar,,,,,open,0,15,10,"How can i have a Toolbar like this ? (Delphi) i like this toolbar. where can i find it ?
![alt text][1]


  [1]: http://i28.tinypic.com/5ofr0n.png

Thank you",2
1192647,07/28/2009 08:23:45,137939,07/14/2009 08:49:47,44,3,Delphi ScktComp: When is the onWrite event being fired?,"I have come to the point of thinking that the onWrite Event of a ClientSocket is redundant when I directly write bytes into the socket connection via SendBuf().

**Is my point of thinking somewhere in the desert?**

The Delphi Documentation is also somewhat bad because it just sais: *""Write a routine for the onWrite event to write into the socket connection.""*",delphi,sockets,,,,,open,0,59,9,"Delphi ScktComp: When is the onWrite event being fired? I have come to the point of thinking that the onWrite Event of a ClientSocket is redundant when I directly write bytes into the socket connection via SendBuf().

**Is my point of thinking somewhere in the desert?**

The Delphi Documentation is also somewhat bad because it just sais: *""Write a routine for the onWrite event to write into the socket connection.""*",2
4510606,12/22/2010 15:18:10,515592,11/22/2010 03:41:27,89,0,"Why System.SetLength(Str, Len) causes the address of Str changes?","<h3>Code Illustration</h3>
    procedure TForm1.FormCreate(Sender: TObject);
    var
      Str: string;
      PStr: PChar;
    begin
      Str := 'This a string.';
      PStr := Pointer(Str); // PStr holds the address of the first char of Str
      ShowMessage(IntToStr(Longint(PStr))); // It displays e.g. 4928304

      Setlength(Str, 20);

      // I don't know what actually happens in the call for SetLength() above,
      // because the address of Str changes now, so the PStr not valid anymore.

      // This a proof of the fact
      PStr := Pointer(Str);
      ShowMessage(IntToStr(Longint(PStr))); // It's now different, e.g. 11423804
    end;

<h3>Question</h3>
1. Why `System.SetLength(Str, Len)` causes the address of *Str* changes?
2. Is there a way to nullify this side effect of `SetLength` so that I don't have to reassign the new address of *Str* &nbsp;to *PStr* ?

",delphi,,,,,,open,0,185,9,"Why System.SetLength(Str, Len) causes the address of Str changes? <h3>Code Illustration</h3>
    procedure TForm1.FormCreate(Sender: TObject);
    var
      Str: string;
      PStr: PChar;
    begin
      Str := 'This a string.';
      PStr := Pointer(Str); // PStr holds the address of the first char of Str
      ShowMessage(IntToStr(Longint(PStr))); // It displays e.g. 4928304

      Setlength(Str, 20);

      // I don't know what actually happens in the call for SetLength() above,
      // because the address of Str changes now, so the PStr not valid anymore.

      // This a proof of the fact
      PStr := Pointer(Str);
      ShowMessage(IntToStr(Longint(PStr))); // It's now different, e.g. 11423804
    end;

<h3>Question</h3>
1. Why `System.SetLength(Str, Len)` causes the address of *Str* changes?
2. Is there a way to nullify this side effect of `SetLength` so that I don't have to reassign the new address of *Str* &nbsp;to *PStr* ?

",1
9370813,02/21/2012 01:14:59,938716,09/11/2011 00:29:43,3,0,Read/write example codes for TPipeServer and TPipeClient components,"I need IPC between a windows service and a GUI application both written in **Delphi 2010**. I decided to use named pipe for this.
I built and installed successfully Russell Libby's TPipeServer and TPipeClient components ([link](http://stackoverflow.com/questions/5132894/russell-libbys-pipes-components)).
I followed other answers like [this](http://stackoverflow.com/questions/512366/how-do-i-send-a-string-from-one-instance-of-my-delphi-program-to-another).
But my service received only empty messages from the client. After many test I concluded that I was using those components erroneously, so i don't want to post any code here.
So I'm looking for a valid example about how these components work in order to **write/read** strings in a named pipe (from client to server and viceversa). Any help is really appreciated, even using other free named pipes components or source codes.
Thank you.",delphi,windows-services,ipc,delphi-2010,named-pipes,,open,0,112,8,"Read/write example codes for TPipeServer and TPipeClient components I need IPC between a windows service and a GUI application both written in **Delphi 2010**. I decided to use named pipe for this.
I built and installed successfully Russell Libby's TPipeServer and TPipeClient components ([link](http://stackoverflow.com/questions/5132894/russell-libbys-pipes-components)).
I followed other answers like [this](http://stackoverflow.com/questions/512366/how-do-i-send-a-string-from-one-instance-of-my-delphi-program-to-another).
But my service received only empty messages from the client. After many test I concluded that I was using those components erroneously, so i don't want to post any code here.
So I'm looking for a valid example about how these components work in order to **write/read** strings in a named pipe (from client to server and viceversa). Any help is really appreciated, even using other free named pipes components or source codes.
Thank you.",5
5247817,03/09/2011 15:14:55,279324,02/23/2010 10:03:34,66,1,Delphi - Outlook OLE Automation - Saving email to a database table,"I'm using OLE automation within my Delphi 2006 BDS application to access Microsoft Outlook and was need to be able to save the email message (the body) to a database table (Oracle 10g). Then view it from within my application as it would appear in Outlook. What's the best way to go about this?

Delphi 2006 BDS",delphi,automation,outlook,ole,,03/10/2011 03:35:12,not a real question,1,56,12,"Delphi - Outlook OLE Automation - Saving email to a database table I'm using OLE automation within my Delphi 2006 BDS application to access Microsoft Outlook and was need to be able to save the email message (the body) to a database table (Oracle 10g). Then view it from within my application as it would appear in Outlook. What's the best way to go about this?

Delphi 2006 BDS",4
5105462,02/24/2011 13:45:40,193655,10/21/2009 08:29:52,1244,14,Using Google as a substitute of a web interface for an existing client server application,"I am in researh mood and one of the tasks I have in my to do list is:

*""Finalize the techonlogy to use for creating a web interface to my existing Client Server application"".*

My application is very rich and full of features. It makes sense it is has rich client UI, because it is a productivity tool. Many shortcuts, many things without any click. So I am not looking for a full replacement.

My app has some features that would be good to be used also from a web interface.

Some of them:

1) multi user calendar (every item I see in the calendar is linked to something in my app, for example ""today 11:00: recall customer 'Dummy ltd'"". This is not a simple memo, it is also linked to the customer), so i can see my and others tasks.

2) Confirm some task (yes I did this!)

3) see some report (some graph or some tabular report)

Of course this are not simple outputs, they can contain some logic (for example some calendar items must be readonly, some others can be edited).

This said, I was considering whether doing all this with Google would be a reasonable choice. In this way I don't have to install anything, simply interfacing with google would be enough. I can map my application users to one (or more) google users and use all the google features (calendar, charts, tasks, ....).

May you comment on this? Which are the good/bad points.

**Some good points I can forsee:**

1) no need to design any UI, just connect to an existing powerful and userfriendly system

2) the applicatino will automatically be compatible with google (""is it possible to export on google?"" is a typical question I recieve)

3) google already provides the interface for the points I wrote above (tasks, calendar, charts, ...)

4) no deployment issues. No server hosting. just need to configure the users with some wizard.

**Some bad points:**

1) Which is the long term support? Will the Google APIs change every month or some of them will be stable for years?

2) How much may I push? How much is it possible to customize? I mean can I write some logic like ""this item is readonly"", ""this item is not""? (afaik in google I can share a calendar with other people, in different ways, but there is no way to make only a part of it readonly. Of course I could do this with a trick, like having 2 calendars, one readonly and the other not. But is it possible to change the default google behaviour like for example in calendar case?)

3) of course I am limited, writing ""from scratch"" allows me to do everything.

Final note: my app is a Delphi client/server application. The communication will be done from an application server that will interact with the google apis.





",delphi,google-app-engine,google,client-server,,,open,0,460,15,"Using Google as a substitute of a web interface for an existing client server application I am in researh mood and one of the tasks I have in my to do list is:

*""Finalize the techonlogy to use for creating a web interface to my existing Client Server application"".*

My application is very rich and full of features. It makes sense it is has rich client UI, because it is a productivity tool. Many shortcuts, many things without any click. So I am not looking for a full replacement.

My app has some features that would be good to be used also from a web interface.

Some of them:

1) multi user calendar (every item I see in the calendar is linked to something in my app, for example ""today 11:00: recall customer 'Dummy ltd'"". This is not a simple memo, it is also linked to the customer), so i can see my and others tasks.

2) Confirm some task (yes I did this!)

3) see some report (some graph or some tabular report)

Of course this are not simple outputs, they can contain some logic (for example some calendar items must be readonly, some others can be edited).

This said, I was considering whether doing all this with Google would be a reasonable choice. In this way I don't have to install anything, simply interfacing with google would be enough. I can map my application users to one (or more) google users and use all the google features (calendar, charts, tasks, ....).

May you comment on this? Which are the good/bad points.

**Some good points I can forsee:**

1) no need to design any UI, just connect to an existing powerful and userfriendly system

2) the applicatino will automatically be compatible with google (""is it possible to export on google?"" is a typical question I recieve)

3) google already provides the interface for the points I wrote above (tasks, calendar, charts, ...)

4) no deployment issues. No server hosting. just need to configure the users with some wizard.

**Some bad points:**

1) Which is the long term support? Will the Google APIs change every month or some of them will be stable for years?

2) How much may I push? How much is it possible to customize? I mean can I write some logic like ""this item is readonly"", ""this item is not""? (afaik in google I can share a calendar with other people, in different ways, but there is no way to make only a part of it readonly. Of course I could do this with a trick, like having 2 calendars, one readonly and the other not. But is it possible to change the default google behaviour like for example in calendar case?)

3) of course I am limited, writing ""from scratch"" allows me to do everything.

Final note: my app is a Delphi client/server application. The communication will be done from an application server that will interact with the google apis.





",4
1277393,08/14/2009 11:33:40,100846,04/24/2009 13:19:47,1453,99,Delphi certificates,"Long time ago, there was a possibility to pass Delphi exam and gain some Delphi certificate (like MCP). Is there any chance to pass such an exam now? Is some certification authority issuing such certificates?

While being MCP and MCSD it would be nice to have a proof of my knowledge in Delphi world…
",delphi,career-development,certification,,,01/27/2012 18:47:49,not constructive,1,53,2,"Delphi certificates Long time ago, there was a possibility to pass Delphi exam and gain some Delphi certificate (like MCP). Is there any chance to pass such an exam now? Is some certification authority issuing such certificates?

While being MCP and MCSD it would be nice to have a proof of my knowledge in Delphi world…
",3
4084412,11/03/2010 05:18:19,495547,11/03/2010 05:18:19,1,0,[Delphi] ParamStr() Problem,"I have associated the "".file_5"" extension with my application and I used the ParamStr(1) function in Delphi to show a messagebox that contains the path & file name of the file when I double click on it in explorer using the code below.

<pre><code>
procedure TForm1.FormCreate(Sender: TObject);
 var
  TheFile : string;
begin
  TheFile := ParamStr(1);  //filename for the file that was loaded
  ShowMessage(TheFile);
end;
</pre></code>
 
This works, but if I move the file to another location then the location it was originally in, then the message that is shown is not correct. 

Example: (using test.file_5)

The original location of the file is in the C:\ drive and when I double click it my application starts and displays a Messagebox that says: <blockquote>C:\test.file_5</blockquote>

This is correct. If I move that same file to a directory that contains spaces like the program file folder for example then the Messagbox that is displayed is not 

<blockquote>C:\Program Files\test.file_5</blockquote> like I would expect but rather 


<blockquote>C:\PROGRA~1.FILE_</blockquote> which is obviously not the information I am after so my question is how can I use the ParamStr() function to take into account directories that have spaces in them or is there a better function that I should use that works with directories that contains spaces in them.

",delphi,paramstr,,,,,open,0,207,3,"[Delphi] ParamStr() Problem I have associated the "".file_5"" extension with my application and I used the ParamStr(1) function in Delphi to show a messagebox that contains the path & file name of the file when I double click on it in explorer using the code below.

<pre><code>
procedure TForm1.FormCreate(Sender: TObject);
 var
  TheFile : string;
begin
  TheFile := ParamStr(1);  //filename for the file that was loaded
  ShowMessage(TheFile);
end;
</pre></code>
 
This works, but if I move the file to another location then the location it was originally in, then the message that is shown is not correct. 

Example: (using test.file_5)

The original location of the file is in the C:\ drive and when I double click it my application starts and displays a Messagebox that says: <blockquote>C:\test.file_5</blockquote>

This is correct. If I move that same file to a directory that contains spaces like the program file folder for example then the Messagbox that is displayed is not 

<blockquote>C:\Program Files\test.file_5</blockquote> like I would expect but rather 


<blockquote>C:\PROGRA~1.FILE_</blockquote> which is obviously not the information I am after so my question is how can I use the ParamStr() function to take into account directories that have spaces in them or is there a better function that I should use that works with directories that contains spaces in them.

",2
4843181,01/30/2011 13:33:46,593771,01/28/2011 11:56:20,3,1,Delphi Get the handle of a EXE,I was wondering if its possible to get the handle of a exe instead of getting the handle from the window name,delphi,,,,,,open,0,22,7,Delphi Get the handle of a EXE I was wondering if its possible to get the handle of a exe instead of getting the handle from the window name,1
5927344,05/08/2011 12:14:38,715707,04/19/2011 17:39:56,177,0,Avoiding errors at runtime,"I have a lots of commands in one procedure and there is this command:<br> 
<br> <code>
 ...<br> 
Stream:=TFileStream.Create(FileName,fmOpenread); <br> 
...</code>
<br> 
<br> The whole procedure is created to send file from TClientSocket to TServerSocket.
<br> The procedure is launching every 100 miliseconds from Timer. 
 Ofcourse sometimes I have EFCreateError error showing because the file is used.<br> 
Everything works good because some data is received. But how to avoid showing this error?<br>  Apologies for my english! ",delphi,error-handling,delphi-7,,,,open,0,76,4,"Avoiding errors at runtime I have a lots of commands in one procedure and there is this command:<br> 
<br> <code>
 ...<br> 
Stream:=TFileStream.Create(FileName,fmOpenread); <br> 
...</code>
<br> 
<br> The whole procedure is created to send file from TClientSocket to TServerSocket.
<br> The procedure is launching every 100 miliseconds from Timer. 
 Ofcourse sometimes I have EFCreateError error showing because the file is used.<br> 
Everything works good because some data is received. But how to avoid showing this error?<br>  Apologies for my english! ",3
11642469,07/25/2012 03:55:16,1522529,07/13/2012 04:09:37,1,0,how to get txt file and parsing the value using parsedelimeted delphi,"i want to get data from txt file and parsing that data, the file contains float value. i have code for that process but it returned integer value. the code below:

  

      begin
      Temp := TStringList.Create;
      Temp.LoadFromFile('b.txt');
      Row := 0;
      for I := 0 to Temp.Count-1 do
      begin
        S := Temp.Strings[I];
        N := Pos(' ', Trim(S));
        S := Copy(S, N+1, Length(S)-N-1);
       ParseDelimited(Memo1.Lines, Trim(S), ' ');
        Inc(Row);
      end;
      Temp.Free;

but i want to get the value in float, how can i do that?",delphi,parsing,,,,07/27/2012 02:10:21,not a real question,1,156,12,"how to get txt file and parsing the value using parsedelimeted delphi i want to get data from txt file and parsing that data, the file contains float value. i have code for that process but it returned integer value. the code below:

  

      begin
      Temp := TStringList.Create;
      Temp.LoadFromFile('b.txt');
      Row := 0;
      for I := 0 to Temp.Count-1 do
      begin
        S := Temp.Strings[I];
        N := Pos(' ', Trim(S));
        S := Copy(S, N+1, Length(S)-N-1);
       ParseDelimited(Memo1.Lines, Trim(S), ' ');
        Inc(Row);
      end;
      Temp.Free;

but i want to get the value in float, how can i do that?",2
4281935,11/26/2010 01:16:58,665392,02/27/2010 09:27:37,37,22,TGrid for a cad project delphi,"Working with TGrid to make CAD project

Many cad’s in Delphi are a waste of time to my needs

I have taken TGrid and realized ‘selection’ dose not work in Onselectcell but works in OnDrawCell, but repeating code endlessly in OnDrawCell is not good coding in my eyes. So I overridden the paint procedure and made my own event and gained the use of ‘selection’ again before the print. This takes heaps of confusing code out of my OnDrawCell too and allows adjustment of the selection area before a selection is drawn. 
That’s ok but it calls paint too many times for a single paint that tracing my object code is hard if I need to?
Has any one got a better idea of what I should override rather than Paint.

2/
I have already been writing my object info in the cells text of TGrid and my project works good like this. I just want to put a graphical aspect to the project be able to drag objects. and hide the text

I have a number of set drawobjects, that each object will draw over a number of cells. And that introduces issues like part objects being viewed in TGrid.

I’m also thinking of connecting cell height and width with my drawobject size too.
This allows the grids cells to be small that a drawobject can have a stepped/set pixel movement over the grid with a drag a drop of the drawobject. 

I’m thinking left mouse button drags objects, right mouse button drags the grid, mouse roller zooms in and out cell size.
I see my self developing a Bitmap object that contains its size that works with this TGrid object and having a list if this bitmap object.

Has any one seen any work/code in this field, offer constructive advice? I’m sure some one knows more than me.

I’m not interested is edges of the grid to be displayed
I want to save memory by using the cell’s text to record my DrawObject data and only draw an object in view if it’s viewable. This means rewrites at paint time.
This goes back to limiting to many repaints in TGrid some how. I hope some one has a better idea than TTimer if I can. The bottom line is displaying a screen full of Drawobjects in the TGrid and having the processing in most computers to do it. Lets target 1.4GHz as the slowest.

My project dose not neet to comunicate with other CAD projects",delphi,,,,,11/26/2010 12:50:03,not a real question,1,403,6,"TGrid for a cad project delphi Working with TGrid to make CAD project

Many cad’s in Delphi are a waste of time to my needs

I have taken TGrid and realized ‘selection’ dose not work in Onselectcell but works in OnDrawCell, but repeating code endlessly in OnDrawCell is not good coding in my eyes. So I overridden the paint procedure and made my own event and gained the use of ‘selection’ again before the print. This takes heaps of confusing code out of my OnDrawCell too and allows adjustment of the selection area before a selection is drawn. 
That’s ok but it calls paint too many times for a single paint that tracing my object code is hard if I need to?
Has any one got a better idea of what I should override rather than Paint.

2/
I have already been writing my object info in the cells text of TGrid and my project works good like this. I just want to put a graphical aspect to the project be able to drag objects. and hide the text

I have a number of set drawobjects, that each object will draw over a number of cells. And that introduces issues like part objects being viewed in TGrid.

I’m also thinking of connecting cell height and width with my drawobject size too.
This allows the grids cells to be small that a drawobject can have a stepped/set pixel movement over the grid with a drag a drop of the drawobject. 

I’m thinking left mouse button drags objects, right mouse button drags the grid, mouse roller zooms in and out cell size.
I see my self developing a Bitmap object that contains its size that works with this TGrid object and having a list if this bitmap object.

Has any one seen any work/code in this field, offer constructive advice? I’m sure some one knows more than me.

I’m not interested is edges of the grid to be displayed
I want to save memory by using the cell’s text to record my DrawObject data and only draw an object in view if it’s viewable. This means rewrites at paint time.
This goes back to limiting to many repaints in TGrid some how. I hope some one has a better idea than TTimer if I can. The bottom line is displaying a screen full of Drawobjects in the TGrid and having the processing in most computers to do it. Lets target 1.4GHz as the slowest.

My project dose not neet to comunicate with other CAD projects",1
9910636,03/28/2012 15:19:43,418198,08/12/2010 09:06:38,841,22,optimization of creating a form,"To create and show a form takes 10 seconds and i want to shorten the process.

On part is the

      Inherited Create(AOwner);

Which takes 2 seconds out of the total run time.

Is there a way to shorten the parent create which is the Delphi TForm?
Or Do you know what are the reasons for the increase of time in the call
   
    Inherited Create(AOwner);
?",delphi,optimization,delphi-2009,,,03/30/2012 01:43:39,not a real question,1,71,5,"optimization of creating a form To create and show a form takes 10 seconds and i want to shorten the process.

On part is the

      Inherited Create(AOwner);

Which takes 2 seconds out of the total run time.

Is there a way to shorten the parent create which is the Delphi TForm?
Or Do you know what are the reasons for the increase of time in the call
   
    Inherited Create(AOwner);
?",3
8640188,12/27/2011 00:35:24,995310,10/14/2011 11:33:48,32,1,Make report with TQReport,"I Have 3 table:

    Division:
    ---------
    DCode | PK
    DName
    
    Worker:
    ----------
    WCode | PK
    WName
    ECode | FK
    DCode | FK
    
    
    Experience
    ----------
    ECode | PK
    ECost

I need build with QReport report like this

    IT
         Petrov      1000$
         Sidorov     1200$
         Oleynik     880$
    Math
         Lomanosov   300$
         Pythagoras  310$

I write SQL Query

    SELECT 
          d.DName,
          w.WName,
          e.ECost
    FROM Divison d
    INNER JOIN Worker w
    ON d.DCode = w.DCode
    INNER JOIN Experience e
    ON e.ECode = w.ECode
    GROUP BY d.DName, w.WName,e.ECost

I try use QRSubDetail,QRGroup but not working. Please tell me how do what i need",delphi,paradox,quickreports,,,,open,0,256,4,"Make report with TQReport I Have 3 table:

    Division:
    ---------
    DCode | PK
    DName
    
    Worker:
    ----------
    WCode | PK
    WName
    ECode | FK
    DCode | FK
    
    
    Experience
    ----------
    ECode | PK
    ECost

I need build with QReport report like this

    IT
         Petrov      1000$
         Sidorov     1200$
         Oleynik     880$
    Math
         Lomanosov   300$
         Pythagoras  310$

I write SQL Query

    SELECT 
          d.DName,
          w.WName,
          e.ECost
    FROM Divison d
    INNER JOIN Worker w
    ON d.DCode = w.DCode
    INNER JOIN Experience e
    ON e.ECode = w.ECode
    GROUP BY d.DName, w.WName,e.ECost

I try use QRSubDetail,QRGroup but not working. Please tell me how do what i need",3
4447115,12/15/2010 05:55:23,35696,11/08/2008 03:38:52,1502,106,Are there any Delphi components for writing Facebook apps?,"I'm looking to start writing some small Facebook apps with Delphi - are there any usable components already written to help with this process?  Alternately sample code for Facebook's Graph API or other methods.

Thanks!

Darian",delphi,facebook,,,,,open,0,35,9,"Are there any Delphi components for writing Facebook apps? I'm looking to start writing some small Facebook apps with Delphi - are there any usable components already written to help with this process?  Alternately sample code for Facebook's Graph API or other methods.

Thanks!

Darian",2
584236,02/25/2009 00:15:11,14031,09/16/2008 21:45:37,361,27,TTreeView node handles freed after TTreeView's parent changed???,"i have a *very* interesting problem.  

**background**

i've used TTreeView for years but only now am using it with a docking library (from AutomatedQA).  i've learned that when the parent of the TTreeView is changed, all the handles are recreated.  this is something the docking library does during normal activites.

i've been using the Data property on the TTreeNode to hold an object.  i've also kept a linkage to the TreeNode in the object.  in short, using the TreeNode, i can get the object and i can also get the TreeNode from the object.

as long as the tree view never has it's parent changed (auto-hide & show window), my application works perfectly.

**the problem**

what i find is that once the parent has changed, my object attached to the tree node's Data property now contains references to the wrong tree node or a stale pointer.

i tried it another way ""MyTreeViewContainer.Parent:=SomewhereElse"" and observed the same problem.

reloading the tree with possibly hundreds of objects wouldn't be very efficient.

i don't see how i should work around this problem.  i have for so long been able to load the tree view and have the objects remain able to find each other easily.  this could really break my nice ""pattern"" for using the tree view...

thank you for your help!
",delphi,delphi-2009,treeview,,,,open,0,217,8,"TTreeView node handles freed after TTreeView's parent changed??? i have a *very* interesting problem.  

**background**

i've used TTreeView for years but only now am using it with a docking library (from AutomatedQA).  i've learned that when the parent of the TTreeView is changed, all the handles are recreated.  this is something the docking library does during normal activites.

i've been using the Data property on the TTreeNode to hold an object.  i've also kept a linkage to the TreeNode in the object.  in short, using the TreeNode, i can get the object and i can also get the TreeNode from the object.

as long as the tree view never has it's parent changed (auto-hide & show window), my application works perfectly.

**the problem**

what i find is that once the parent has changed, my object attached to the tree node's Data property now contains references to the wrong tree node or a stale pointer.

i tried it another way ""MyTreeViewContainer.Parent:=SomewhereElse"" and observed the same problem.

reloading the tree with possibly hundreds of objects wouldn't be very efficient.

i don't see how i should work around this problem.  i have for so long been able to load the tree view and have the objects remain able to find each other easily.  this could really break my nice ""pattern"" for using the tree view...

thank you for your help!
",3
5094932,02/23/2011 18:00:57,628206,02/22/2011 11:28:40,8,0,IniFile Delphi save and load,"Following from a question I have asked before I was wondering how I could save and load 4 bits of information that are related. 

This is what the form will look like. I have a 8 editboxes and a button. The top 4 edit boxes are for input then the button will save to file like so?

 `myIniFile.writeinteger('name','string1',1);`

I want to be able to add 4 pieces of information though. So the user gets to write in the 4 top edit boxes. Then clicks the button and it saves it to the Inifile. Do that a couple of times. The first question is that. keep in mind that the 4 bit of information are related to eachother. So when i type what I typed in edit1 in edit5(the bottom 4 edit boxes) the other 3 pieces of info that were typed in edit2,3,4 are now placed in edit6,7,8. Hope it makes sense and someone can explain to me how to do this? It's like save, load, search and rename the variables when they are found back in the form so that they can be used again. Thank you in advanced

",delphi,inifile,,,,02/23/2011 20:24:11,not a real question,1,189,5,"IniFile Delphi save and load Following from a question I have asked before I was wondering how I could save and load 4 bits of information that are related. 

This is what the form will look like. I have a 8 editboxes and a button. The top 4 edit boxes are for input then the button will save to file like so?

 `myIniFile.writeinteger('name','string1',1);`

I want to be able to add 4 pieces of information though. So the user gets to write in the 4 top edit boxes. Then clicks the button and it saves it to the Inifile. Do that a couple of times. The first question is that. keep in mind that the 4 bit of information are related to eachother. So when i type what I typed in edit1 in edit5(the bottom 4 edit boxes) the other 3 pieces of info that were typed in edit2,3,4 are now placed in edit6,7,8. Hope it makes sense and someone can explain to me how to do this? It's like save, load, search and rename the variables when they are found back in the form so that they can be used again. Thank you in advanced

",2
8025481,11/06/2011 05:54:03,923657,09/01/2011 14:40:04,148,1,"vcl events with anonymous methods, what do you think about this implementation?","Since anonymous methods appeared in Delphi I wanted to use them in vcl components events.. Obviously for backuard compatibility the VCL wasn't updated, so I managed to make a simple implementation with a few caveats..

    type
      TNotifyEventDispatcher = class(TComponent)
      protected
        FClosure: TProc<TObject>;
    
        procedure OnNotifyEvent(Sender: TObject);
      public
        class function Create(Owner: TComponent; Closure: TProc<TObject>): TNotifyEvent; overload;
    
        function Attach(Closure: TProc<TObject>): TNotifyEvent;
      end;
    
    implementation
    
    class function TNotifyEventDispatcher.Create(Owner: TComponent; Closure: TProc<TObject>): TNotifyEvent;
    begin
      Result := TNotifyEventDispatcher.Create(Owner).Attach(Closure)
    end;
    
    function TNotifyEventDispatcher.Attach(Closure: TProc<TObject>): TNotifyEvent;
    begin
      FClosure := Closure;
      Result := Self.OnNotifyEvent
    end;
    
    procedure TNotifyEventDispatcher.OnNotifyEvent(Sender: TObject);
    begin
      if Assigned(FClosure) then
        FClosure(Sender)
    end;
    
    end.

And this is how it's used for example: 

    procedure TForm1.FormCreate(Sender: TObject);
    begin    
      Button1.OnClick := TNotifyEventDispatcher.Create(Self,
        procedure (Sender: TObject)
        begin
          Self.Caption := 'DONE!'
        end)
    end;

Very simple I believe, there are two drawbacks:

- I have to create a component to manage the lifetime of the anonymous method (I waste a bit more of memory, and it's a bit slower for the indirection, still I prefer more clear code in my applications)

- I have to implement a new class (very simple) for every event signature. This one is a bit more complicated, still the VCL has very common events signatures, and for every special case when I create the class it's done forever..

What do you think of this implementation? Something to make it better?",delphi,anonymous-methods,,,,,open,0,402,12,"vcl events with anonymous methods, what do you think about this implementation? Since anonymous methods appeared in Delphi I wanted to use them in vcl components events.. Obviously for backuard compatibility the VCL wasn't updated, so I managed to make a simple implementation with a few caveats..

    type
      TNotifyEventDispatcher = class(TComponent)
      protected
        FClosure: TProc<TObject>;
    
        procedure OnNotifyEvent(Sender: TObject);
      public
        class function Create(Owner: TComponent; Closure: TProc<TObject>): TNotifyEvent; overload;
    
        function Attach(Closure: TProc<TObject>): TNotifyEvent;
      end;
    
    implementation
    
    class function TNotifyEventDispatcher.Create(Owner: TComponent; Closure: TProc<TObject>): TNotifyEvent;
    begin
      Result := TNotifyEventDispatcher.Create(Owner).Attach(Closure)
    end;
    
    function TNotifyEventDispatcher.Attach(Closure: TProc<TObject>): TNotifyEvent;
    begin
      FClosure := Closure;
      Result := Self.OnNotifyEvent
    end;
    
    procedure TNotifyEventDispatcher.OnNotifyEvent(Sender: TObject);
    begin
      if Assigned(FClosure) then
        FClosure(Sender)
    end;
    
    end.

And this is how it's used for example: 

    procedure TForm1.FormCreate(Sender: TObject);
    begin    
      Button1.OnClick := TNotifyEventDispatcher.Create(Self,
        procedure (Sender: TObject)
        begin
          Self.Caption := 'DONE!'
        end)
    end;

Very simple I believe, there are two drawbacks:

- I have to create a component to manage the lifetime of the anonymous method (I waste a bit more of memory, and it's a bit slower for the indirection, still I prefer more clear code in my applications)

- I have to implement a new class (very simple) for every event signature. This one is a bit more complicated, still the VCL has very common events signatures, and for every special case when I create the class it's done forever..

What do you think of this implementation? Something to make it better?",2
2083540,01/18/2010 02:09:55,130691,06/29/2009 21:17:21,25,0,Delphi - undeclared identifier: LOCALE_SYSTEM_DEFAULT,"I'm trying to format a float (extended) by the system locale's default currency settings.  I have found the key proponent to this solution to be the following line:

<code>
GetLocaleFormatSettings(LOCALE_SYSTEM_DEFAULT, format_settings);
</code>

and everywhere I look, they provide the solution exactly as shown (no class specifier before, like System.LOCALE_SYSTEM_DEFAULT or anything).  However, my compiler is insistent that LOCALE_SYSTEM_DEFAULT is an undeclared identifier.  It <i>seems</i> to me that the only requirement is to have ""uses SysUtils"", which I do.

I'm using Delphi 2010.  Does anybody know why my compiler can't find this seemingly implicit constant?

Thanks in abundance,
<br/>Jared",delphi,delphi-2010,locale,format,undefined,,open,0,95,5,"Delphi - undeclared identifier: LOCALE_SYSTEM_DEFAULT I'm trying to format a float (extended) by the system locale's default currency settings.  I have found the key proponent to this solution to be the following line:

<code>
GetLocaleFormatSettings(LOCALE_SYSTEM_DEFAULT, format_settings);
</code>

and everywhere I look, they provide the solution exactly as shown (no class specifier before, like System.LOCALE_SYSTEM_DEFAULT or anything).  However, my compiler is insistent that LOCALE_SYSTEM_DEFAULT is an undeclared identifier.  It <i>seems</i> to me that the only requirement is to have ""uses SysUtils"", which I do.

I'm using Delphi 2010.  Does anybody know why my compiler can't find this seemingly implicit constant?

Thanks in abundance,
<br/>Jared",5
8503956,12/14/2011 11:47:21,80901,03/21/2009 17:12:22,8697,442,Delphi app crashes in file dialog on Terminal Server,"A Delphi 2009 frequently crashes with access violations for example if the user opens a open file dialog. Environment is a 8 core Xeon system w Windows 2008 R2 x64 SP 1.

Besides building a fresh install of the server, what else could I try?

Here is a madExcept report, with the hardware section edited to show only CPU and network adapters, (and the process list to keep the question size below 30000 bytes).

It looks like a problem related to a network component. 


    date/time         : 2011-12-12, 13:54:37, 2ms
    computer name     : TSTSVR-1
    wts client name   : P223
    user name         : erkensin
    registered owner  : Microsoft / Microsoft operating system  : Windows 2008 R2 x64 Service Pack 1 build 7601
    system language   : German
    system up time    : 85 days 5 hours
    program up time   : 2 seconds
    processors        : 8x Intel(R) Xeon(R) CPU E5620 @ 2.40GHz
    physical memory   : 461/8181 MB (free/total)
    free disk space   : (U:) 45,25 GB (I:) 45,25 GB
    display mode      : 1280x1024, 16 bit
    process id        : $3910
    allocated memory  : 44,98 MB
    executable        : dct23.exe
    exec. date/time   : 2011-11-11 13:17
    compiled with     : Delphi 2009
    madExcept version : 3.0l
    callstack crc     : $61ba1a00, $8b351f4b, $bc509c6f
    exception number  : 1
    exception class   : EAccessViolation
    exception message : Zugriffsverletzung bei Adresse 61BA1A00 in Modul 'NetworkExplorer.dll'. Schreiben von Adresse 61BA1A00.
    
    thread $b24:
    61ba1a00 +00 NetworkExplorer.dll
    004592bd +0d dct23.exe           madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe           madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll                  BaseThreadInitThunk
    
    main thread ($215c):
    7466f59d +0041 comctl32.dll                 DefSubclassProc
    778a0117 +002b ntdll.dll                    KiUserCallbackDispatcher
    6a030c61 +7985 DUI70.dll                    ?_DisplayNodeCallback@Element@DirectUI@@SGJPAUHGADGET__@@PAXPAUEventMsg@@@Z
    778a0117 +002b ntdll.dll                    KiUserCallbackDispatcher
    004c5c56 +0386 dct23.exe    Dialogs         TCustomFileDialog.Execute
    004c4135 +0115 dct23.exe    Dialogs         TFileDialogWrapper.Execute
    004c4db0 +00a8 dct23.exe    Dialogs         TOpenDialog.DoExecute
    004c4c93 +000f dct23.exe    Dialogs         TOpenDialog.Execute
    004c3a59 +0035 dct23.exe    Dialogs         TCommonDialog.Execute
    00829523 +006f dct23.exe    u_main   190 +6 TfrmMain.btnOpenClick
    004da397 +006f dct23.exe    Controls        TControl.Click
    004b16e2 +001e dct23.exe    StdCtrls        TCustomButton.Click
    004b2150 +0010 dct23.exe    StdCtrls        TCustomButton.CNCommand
    004d9e2e +02d2 dct23.exe    Controls        TControl.WndProc
    004de333 +0513 dct23.exe    Controls        TWinControl.WndProc
    004b13a8 +006c dct23.exe    StdCtrls        TButtonControl.WndProc
    004d9a54 +0024 dct23.exe    Controls        TControl.Perform
    004de483 +0023 dct23.exe    Controls        DoControlMsg
    004dee7f +000b dct23.exe    Controls        TWinControl.WMCommand
    004d9e2e +02d2 dct23.exe    Controls        TControl.WndProc
    004de333 +0513 dct23.exe    Controls        TWinControl.WndProc
    004dda4c +002c dct23.exe    Controls        TWinControl.MainWndProc
    0048cdf8 +0014 dct23.exe    Classes         StdWndProc
    778a0117 +002b ntdll.dll                    KiUserCallbackDispatcher
    771c96c0 +0047 USER32.dll                   SendMessageW
    771d0d48 +0016 USER32.dll                   CallWindowProcW
    004de42f +00d7 dct23.exe    Controls        TWinControl.DefaultHandler
    004da7b4 +0010 dct23.exe    Controls        TControl.WMLButtonUp
    004da72a +006e dct23.exe    Controls        TControl.WMMouseMove
    004d9e2e +02d2 dct23.exe    Controls        TControl.WndProc
    004de333 +0513 dct23.exe    Controls        TWinControl.WndProc
    004b13a8 +006c dct23.exe    StdCtrls        TButtonControl.WndProc
    004dda4c +002c dct23.exe    Controls        TWinControl.MainWndProc
    0048cdf8 +0014 dct23.exe    Classes         StdWndProc
    771c7885 +000a USER32.dll                   DispatchMessageW
    004fa09d +011d dct23.exe    Forms           TApplication.ProcessMessage
    004fa0e2 +000a dct23.exe    Forms           TApplication.HandleMessage
    004fa40d +00c9 dct23.exe    Forms           TApplication.Run
    0082fec6 +0076 dct23.exe    dct       24 +6 initialization
    75543398 +0010 kernel32.dll                 BaseThreadInitThunk
    
    thread $7398:
    778b0146 +0e ntdll.dll     NtWaitForMultipleObjects
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $711c:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    771d0b64 +1a USER32.dll               MsgWaitForMultipleObjects
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $15cc:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $4654:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $54c4:
    778afd7a +0e ntdll.dll                NtDelayExecution
    75e731b5 +5f KERNELBASE.dll           SleepEx
    75e73a86 +0a KERNELBASE.dll           Sleep
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    00459327 +37 dct23.exe      madExcept ThreadExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    >> created by main thread ($215c) at:
    75acda8e +00 ole32.dll
    
    thread $45e0:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    6a488c85 +38 DUser.dll                GetMessageExA
    773b1323 +67 msvcrt.dll               _endthreadex
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    00459327 +37 dct23.exe      madExcept ThreadExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    >> created by main thread ($215c) at:
    773b139c +6e msvcrt.dll               _beginthreadex
    
    thread $6ba4:
    75af6f51 +10 ole32.dll                CoTaskMemFree
    75e9604f +4c KERNELBASE.dll           CompareStringEx
    778bec3f +63 ntdll.dll                bsearch
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $494:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    771d0b64 +1a USER32.dll               MsgWaitForMultipleObjects
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $3b08:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    771d0b64 +1a USER32.dll               MsgWaitForMultipleObjects
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $2c7c:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $2a94:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    modules:
    00400000 dct23.exe                              I:\Apps\ERICSSON\Abfertigung\semc_dct
    05370000 dbxint.dll          12.0.3170.16989    I:\Apps\ERICSSON\Abfertigung\semc_dct
    40530000 gds32.dll           7.5.1.80           C:\Windows\system32
    4dae0000 MIDAS.DLL           12.0.3170.16989    I:\Apps\ERICSSON\LAGER\lgrtest
    59870000 msado15.dll         6.1.7601.17514     C:\Program Files (x86)\Common Files\System\ado
    59c80000 MsftEdit.dll        5.41.21.2510       C:\Windows\system32
    5d700000 StructuredQuery.dll 7.0.7601.17514     C:\Windows\System32
    5d760000 SearchFolder.dll    6.1.7601.17514     C:\Windows\system32
    60ee0000 thumbcache.dll      6.1.7601.17514     C:\Windows\SysWOW64
    61ba0000 NetworkExplorer.dll 6.1.7601.17514     C:\Windows\system32
    61e10000 SHDOCVW.dll         6.1.7601.17514     C:\Windows\system32
    636d0000 ieframe.dll         8.0.7601.17638     C:\Windows\SysWOW64
    64f50000 msls31.dll          3.10.349.0         C:\Windows\system32
    64fe0000 xmllite.dll         1.3.1001.0         C:\Windows\system32
    65050000 AcLayers.DLL        6.1.7601.17514     C:\Windows\AppPatch
    650e0000 ntshrui.dll         6.1.7601.17514     C:\Windows\system32
    65150000 WindowsCodecs.dll   6.1.7601.17514     C:\Windows\system32
    652d0000 EhStorShell.dll     6.1.7600.16385     C:\Windows\system32
    65320000 ntlanman.dll        6.1.7601.17514     C:\Windows\System32
    65340000 slc.dll             6.1.7600.16385     C:\Windows\system32
    653c0000 ieproxy.dll         8.0.7601.17638     C:\Program Files (x86)\Internet Explorer
    65430000 MSDART.DLL          6.1.7600.16385     C:\Windows\system32
    65580000 cscapi.dll          6.1.7601.17514     C:\Windows\system32
    65590000 LINKINFO.dll        6.1.7600.16385     C:\Windows\system32
    655c0000 USERENV.dll         6.1.7601.17514     C:\Windows\system32
    66a70000 OLEACC.dll          7.0.0.0            C:\Windows\SysWOW64
    69ff0000 DUI70.dll           6.1.7600.16385     C:\Windows\system32
    6a310000 explorerframe.dll   6.1.7601.17514     C:\Windows\system32
    6a480000 DUser.dll           6.1.7600.16385     C:\Windows\system32
    6a530000 actxprxy.dll        6.1.7601.17514     C:\Windows\SysWOW64
    6a580000 rsaenh.dll          6.1.7600.16385     C:\Windows\system32
    6a5c0000 PROPSYS.dll         7.0.7601.17514     C:\Windows\system32
    6a6c0000 CRYPTSP.dll         6.1.7600.16385     C:\Windows\system32
    73c50000 Secur32.dll         6.1.7601.17514     C:\Windows\System32
    73ce0000 drprov.dll          6.1.7600.16385     C:\Windows\System32
    73f70000 WINSPOOL.DRV        6.1.7601.17514     C:\Windows\system32
    74140000 ntmarta.dll         6.1.7600.16385     C:\Windows\system32
    74250000 gdiplus.dll         6.1.7601.17514     C:\Windows\WinSxS\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.17514_none_72d18a4386696c80
    744b0000 msimg32.dll         6.1.7600.16385     C:\Windows\system32
    74500000 uxtheme.dll         6.1.7600.16385     C:\Windows\system32
    74580000 WINSTA.dll          6.1.7601.17514     C:\Windows\system32
    74640000 comctl32.dll        6.10.7601.17514    C:\Windows\WinSxS\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_41e6975e2bd6f2b2
    747e0000 profapi.dll         6.1.7600.16385     C:\Windows\system32
    747f0000 MPR.dll             6.1.7600.16385     C:\Windows\system32
    74830000 version.dll         6.1.7600.16385     C:\Windows\system32
    74840000 winrnr.dll          6.1.7600.16385     C:\Windows\System32
    74850000 napinsp.dll         6.1.7600.16385     C:\Windows\system32
    74860000 NLAapi.dll          6.1.7601.17514     C:\Windows\system32
    74cf0000 fwpuclnt.dll        6.1.7601.17514     C:\Windows\System32
    74d30000 rasadhlp.dll        6.1.7600.16385     C:\Windows\system32
    74d40000 WINNSI.DLL          6.1.7600.16385     C:\Windows\system32
    74d50000 IPHLPAPI.DLL        6.1.7601.17514     C:\Windows\system32
    74d70000 DNSAPI.dll          6.1.7601.17570     C:\Windows\system32
    74dc0000 wshtcpip.dll        6.1.7600.16385     C:\Windows\System32
    74de0000 dwmapi.dll          6.1.7600.16385     C:\Windows\system32
    74e00000 apphelp.dll         6.1.7601.17514     C:\Windows\system32
    74e50000 wtsapi32.dll        6.1.7601.17514     C:\Windows\system32
    74e60000 DAVHLPR.dll         6.1.7600.16385     C:\Windows\System32
    74e70000 davclnt.dll         6.1.7601.17514     C:\Windows\System32
    74ee0000 RpcRtRemote.dll     6.1.7601.17514     C:\Windows\system32
    74f00000 srvcli.dll          6.1.7601.17514     C:\Windows\system32
    74f20000 netutils.dll        6.1.7601.17514     C:\Windows\system32
    74f30000 mswsock.dll         6.1.7601.17514     C:\Windows\System32
    75030000 wsock32.dll         6.1.7600.16385     C:\Windows\system32
    75050000 tsappcmp.dll        6.1.7601.17514     C:\Windows\system32
    753e0000 CRYPTBASE.dll       6.1.7600.16385     C:\Windows\syswow64
    753f0000 SspiCli.dll         6.1.7601.17514     C:\Windows\syswow64
    75450000 IMM32.DLL           6.1.7601.17514     C:\Windows\system32
    754b0000 comdlg32.dll        6.1.7601.17514     C:\Windows\syswow64
    75530000 kernel32.dll        6.1.7601.17651     C:\Windows\syswow64
    75640000 MSASN1.dll          6.1.7601.17514     C:\Windows\syswow64
    75660000 LPK.dll             6.1.7600.16385     C:\Windows\syswow64
    75670000 DEVOBJ.dll          6.1.7601.17621     C:\Windows\syswow64
    756f0000 NSI.dll             6.1.7600.16385     C:\Windows\syswow64
    75700000 SETUPAPI.dll        6.1.7601.17514     C:\Windows\syswow64
    758a0000 iertutil.dll        8.0.7601.17638     C:\Windows\syswow64
    75aa0000 ole32.dll           6.1.7601.17514     C:\Windows\syswow64
    75c00000 ADVAPI32.dll        6.1.7601.17514     C:\Windows\syswow64
    75d30000 SHLWAPI.dll         6.1.7601.17514     C:\Windows\syswow64
    75d90000 CFGMGR32.dll        6.1.7601.17621     C:\Windows\syswow64
    75dc0000 USP10.dll           1.626.7601.17514   C:\Windows\syswow64
    75e60000 KERNELBASE.dll      6.1.7601.17651     C:\Windows\syswow64
    75eb0000 shell32.dll         6.1.7601.17514     C:\Windows\syswow64
    76b00000 sechost.dll         6.1.7600.16385     C:\Windows\SysWOW64
    76b20000 CRYPT32.dll         6.1.7601.17514     C:\Windows\syswow64
    76c40000 urlmon.dll          8.0.7601.17638     C:\Windows\syswow64
    76d80000 CLBCatQ.DLL         2001.12.8530.16385 C:\Windows\syswow64
    76e10000 RPCRT4.dll          6.1.7601.17514     C:\Windows\syswow64
    76f00000 WININET.dll         8.0.7601.17638     C:\Windows\syswow64
    77000000 MSCTF.dll           6.1.7600.16385     C:\Windows\syswow64
    770d0000 WLDAP32.dll         6.1.7601.17514     C:\Windows\syswow64
    77120000 oleaut32.dll        6.1.7601.17567     C:\Windows\syswow64
    771b0000 USER32.dll          6.1.7601.17514     C:\Windows\syswow64
    77310000 GDI32.dll           6.1.7601.17514     C:\Windows\syswow64
    773a0000 msvcrt.dll          7.0.7600.16385     C:\Windows\syswow64
    77450000 WS2_32.dll          6.1.7601.17514     C:\Windows\syswow64
    77860000 PSAPI.DLL           6.1.7600.16385     C:\Windows\syswow64
    77890000 ntdll.dll           6.1.7601.17514     C:\Windows\SysWOW64
    
    processes:
    0000 Idle                     0  0    0
    0004 System                   0  0    0
    0114 smss.exe                 0  0    0
    0168 csrss.exe                0  0    0
    0194 wininit.exe              0  0    0
    019c csrss.exe                1  0    0
    01c4 winlogon.exe             1  0    0
    01f4 services.exe             0  0    0
    01fc lsass.exe                0  0    0
    0208 lsm.exe                  0  0    0
    0260 svchost.exe              0  0    0
    02c8 svchost.exe              0  0    0
    031c LogonUI.exe              1  0    0
    0328 svchost.exe              0  0    0
    0358 svchost.exe              0  0    0
    039c svchost.exe              0  0    0
    03f0 svchost.exe              0  0    0
    009c svchost.exe              0  0    0
    0200 svchost.exe              0  0    0
    05cc ffmux32.exe              0  0    0
    0618 nsclient++.exe           0  0    0
    0664 svchost.exe              0  0    0
    07ec svchost.exe              0  0    0
    0394 svchost.exe              0  0    0
    0884 svchost.exe              0  0    0
    0974 svchost.exe              0  0    0
    08c0 msdtc.exe                0  0    0
    0eec OSPPSVC.EXE              0  0    0
    1d3c svchost.exe              0  0    0
    32d0 SpntSvc.exe              0  0    0
    2b8c StWatchDog.exe           0  0    0
    6444 StOPP.exe                0  0    0
    4d28 spoolsv.exe              0  0    0
    51c8 csrss.exe                10 0    0
    0e90 winlogon.exe             10 0    0
    4a14 rdpclip.exe              10 0    0
    689c taskhost.exe             10 0    0
    2b58 dwm.exe                  10 0    0
    3060 explorer.exe             10 0    0
    103c fftray.exe               10 0    0
    37d0 pdf24.exe                10 0    0
    1a1c svchost.exe              0  0    0
    5e0c svchost.exe              0  0    0
    3510 csrss.exe                22 0    0
    3324 winlogon.exe             22 0    0
    1bc0 taskhost.exe             22 0    0
    4358 rdpclip.exe              22 0    0
    59a8 dwm.exe                  22 0    0
    5798 cmd.exe                  22 0    0
    1be0 conhost.exe              22 0    0
    223c net.exe                  22 0    0
    3c50 explorer.exe             22 0    0
    40e8 fftray.exe               22 0    0
    153c jusched.exe              22 0    0
    4844 pdf24.exe                22 0    0
    1480 WiederholungsLabel.exe   22 0    0
    33c4 consent.exe              22 0    0
    44d0 ielowutil.exe            22 0    0
    483c pdf24-Updater.exe        22 0    0
    54a4 svchost.exe              0  0    0
    4e24 WerFault.exe             22 0    0
    6680 csrss.exe                3  0    0
    0cc0 winlogon.exe             3  0    0
    635c taskhost.exe             3  0    0
    175c rdpclip.exe              3  0    0
    4678 dwm.exe                  3  0    0
    1f28 cmd.exe                  3  0    0
    3e48 conhost.exe              3  0    0
    3700 explorer.exe             3  0    0
    412c net.exe                  3  0    0
    5c60 fftray.exe               3  0    0
    6f60 jusched.exe              3  0    0
    23e4 pdf24.exe                3  0    0
    2c78 UI0Detect.exe            0  0    0
    04f4 OUTLOOK.EXE              3  0    0
    35c8 svchost.exe              0  0    0
    69d0 Tourenplanung152.exe     3  0    0
    2c38 Ladelist.exe             3  0    0
    33a8 abfe2000.exe             3  0    0
    13c0 iexplore.exe             3  0    0
    4c28 iexplore.exe             3  0    0
    0e0c FlashUtil10l_ActiveX.exe 3  0    0
    6160 csrss.exe                5  0    0
    3f40 winlogon.exe             5  0    0
    13dc taskhost.exe             5  0    0
    06b0 rdpclip.exe              5  0    0
    5a84 dwm.exe                  5  0    0
    35a8 cmd.exe                  5  0    0
    3724 conhost.exe              5  0    0
    5264 explorer.exe             5  0    0
    206c net.exe                  5  0    0
    2508 fftray.exe               5  0    0
    1298 jusched.exe              5  0    0
    540c pdf24.exe                5  0    0
    43d0 iexplore.exe             5  0    0
    698c iexplore.exe             5  0    0
    70b8 OUTLOOK.EXE              5  0    0
    0978 Winload225.exe           5  0    0
    6bec abfe2000133.exe          5  0    0
    691c Ladelist343.exe          5  0    0
    43ec Tourenplanung152.exe     5  0    0
    35cc splwow64.exe             5  0    0
    2540 SVProtokoll.exe          3  0    0
    29e0 csrss.exe                6  0    0
    400c winlogon.exe             6  0    0
    0ad4 taskhost.exe             6  0    0
    70c8 rdpclip.exe              6  0    0
    2f04 dwm.exe                  6  0    0
    2d08 cmd.exe                  6  0    0
    0f0c conhost.exe              6  0    0
    1164 net.exe                  6  0    0
    6548 explorer.exe             6  0    0
    1374 fftray.exe               6  0    0
    7170 jusched.exe              6  0    0
    2dac pdf24.exe                6  0    0
    23b4 Lagerprj.exe             6  0    0
    1d1c javaw.exe                6  0    0
    17b4 csrss.exe                7  0    0
    28d0 winlogon.exe             7  0    0
    61a4 taskhost.exe             7  0    0
    4a78 rdpclip.exe              7  0    0
    29c8 dwm.exe                  7  0    0
    6fc0 cmd.exe                  7  0    0
    2e9c conhost.exe              7  0    0
    6204 net.exe                  7  0    0
    100c explorer.exe             7  0    0
    2d84 fftray.exe               7  0    0
    4774 jusched.exe              7  0    0
    6fd4 pdf24.exe                7  0    0
    5ccc csrss.exe                8  0    0
    5dd8 winlogon.exe             8  0    0
    56b0 OUTLOOK.EXE              7  0    0
    39e4 taskhost.exe             8  0    0
    5fdc rdpclip.exe              8  0    0
    3d1c dwm.exe                  8  0    0
    0b98 cmd.exe                  8  0    0
    3d68 conhost.exe              8  0    0
    645c net.exe                  8  0    0
    5ddc explorer.exe             8  0    0
    2b4c fftray.exe               8  0    0
    2afc jusched.exe              8  0    0
    7378 pdf24.exe                8  0    0
    0818 OUTLOOK.EXE              8  0    0
    2608 mtn5250.exe              8  0    0
    47fc Ladelist343.exe          7  0    0
    65a8 csrss.exe                9  0    0
    4ed8 winlogon.exe             9  0    0
    55cc taskhost.exe             9  0    0
    66c0 rdpclip.exe              9  0    0
    6a0c dwm.exe                  9  0    0
    4368 explorer.exe             9  0    0
    6614 fftray.exe               9  0    0
    5564 jusched.exe              9  0    0
    21c0 pdf24.exe                9  0    0
    38c8 csrss.exe                11 0    0
    5560 winlogon.exe             11 0    0
    6694 taskhost.exe             11 0    0
    6760 rdpclip.exe              11 0    0
    5334 dwm.exe                  11 0    0
    6384 explorer.exe             11 0    0
    39fc fftray.exe               11 0    0
    4760 jusched.exe              11 0    0
    25e0 pdf24.exe                11 0    0
    5350 OUTLOOK.EXE              11 0    0
    5c04 csrss.exe                12 0    0
    2ff8 winlogon.exe             12 0    0
    594c taskhost.exe             12 0    0
    0880 rdpclip.exe              12 0    0
    374c dwm.exe                  12 0    0
    6edc explorer.exe             12 0    0
    2fe0 fftray.exe               12 0    0
    6524 jusched.exe              12 0    0
    56e8 pdf24.exe                12 0    0
    39c0 Tourenplanung152.exe     7  0    0
    62b4 OUTLOOK.EXE              12 0    0
    5578 abfe2000133.exe          7  0    0
    22fc Winload225.exe           7  0    0
    4508 csrss.exe                13 0    0
    3ce4 winlogon.exe             13 0    0
    16c4 taskhost.exe             13 0    0
    5e10 rdpclip.exe              13 0    0
    4704 dwm.exe                  13 0    0
    57b8 cmd.exe                  13 0    0
    56c4 conhost.exe              13 0    0
    5458 net.exe                  13 0    0
    6a10 explorer.exe             13 0    0
    02a4 fftray.exe               13 0    0
    6320 jusched.exe              13 0    0
    52c0 pdf24.exe                13 0    0
    4938 OUTLOOK.EXE              13 0    0
    5810 iexplore.exe             13 0    0
    3bf0 iexplore.exe             13 0    0
    1ba8 iexplore.exe             13 0    0
    6750 csrss.exe                14 0    0
    3dd0 winlogon.exe             14 0    0
    6d64 iexplore.exe             13 0    0
    5724 javaw.exe                13 0    0
    1fe4 taskhost.exe             14 0    0
    18e8 rdpclip.exe              14 0    0
    3288 dwm.exe                  14 0    0
    22cc explorer.exe             14 0    0
    69fc fftray.exe               14 0    0
    2ba0 jusched.exe              14 0    0
    4dfc pdf24.exe                14 0    0
    26f8 OUTLOOK.EXE              14 0    0
    3f34 csrss.exe                15 0    0
    1c3c winlogon.exe             15 0    0
    1770 taskhost.exe             15 0    0
    3074 rdpclip.exe              15 0    0
    6020 dwm.exe                  15 0    0
    5e5c explorer.exe             15 0    0
    6d7c fftray.exe               15 0    0
    3a80 jusched.exe              15 0    0
    690c pdf24.exe                15 0    0
    6ae0 iexplore.exe             9  0    0
    531c iexplore.exe             9  0    0
    1908 FlashUtil10l_ActiveX.exe 9  0    0
    0aec iexplore.exe             13 0    0
    10a8 FlashUtil10l_ActiveX.exe 13 0    0
    70a8 iexplore.exe             15 0    0
    5018 iexplore.exe             15 0    0
    2ed4 FlashUtil10l_ActiveX.exe 15 0    0
    387c OUTLOOK.EXE              15 0    0
    12a8 splwow64.exe             15 0    0
    22d0 EXCEL.EXE                15 0    0
    6920 iexplore.exe             15 0    0
    38f8 splwow64.exe             3  0    0
    5f28 iexplore.exe             9  0    0
    69c8 Tourenplanung152.exe     12 0    0
    6474 abfe2000133.exe          12 0    0
    0e58 Well20255.exe            12 0    0
    3210 Laderaumbuchung32.exe    5  0    0
    59f0 csrss.exe                20 0    0
    3a4c winlogon.exe             20 0    0
    1eac taskhost.exe             20 25   12  normal
    19d0 rdpclip.exe              20 13   10  normal
    683c dwm.exe                  20 14   2   normal
    310c explorer.exe             20 416  278 normal

...

    
    hardware:
    ...
    + Network adapters
      - Broadcom BCM5709S NetXtreme II GigE (NDIS VBD Client) (driver 4.8.4.1)
      - Broadcom BCM5709S NetXtreme II GigE (NDIS VBD Client) #2 (driver 4.8.4.1)
      - IBM-USB-NDIS-Remotenetzwerkgerät
    ...
    + Processors
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
    ...
    
    cpu registers:
    eax = 0687d5a0
    ebx = 0680ffe0
    ecx = 61ba16a0
    edx = 00000000
    esi = 06897620
    edi = 04e2f5bc
    eip = 61ba1a00
    esp = 04e2f534
    ebp = 04e2f544
    
    stack dump:
    04e2f534  1b 1e f5 75 a0 d5 87 06 - b8 f9 f4 75 a8 f5 e2 04  ...u.......u....
    04e2f544  6c f5 e2 04 ce 1d f5 75 - 10 76 89 06 b8 f9 f4 75  l......u.v.....u
    04e2f554  a8 f5 e2 04 bc f5 e2 04 - b8 f9 f4 75 88 fe 80 06  ...........u....
    04e2f564  05 40 00 80 04 00 00 00 - c0 f5 e2 04 28 1d f5 75  .@..........(..u
    04e2f574  ac f5 e2 04 b8 f9 f4 75 - a8 f5 e2 04 7c f6 e2 04  .......u....|...
    04e2f584  4c 62 f2 75 d8 ea 80 06 - 7c f6 e2 04 e0 ff 80 06  Lb.u....|.......
    04e2f594  48 62 f2 75 05 40 00 80 - a4 f8 e2 04 d8 ea 80 06  Hb.u.@..........
    04e2f5a4  00 00 00 00 00 00 00 00 - 0d 1a 2c f0 21 be 50 43  ..........,.!.PC
    04e2f5b4  88 b0 73 67 fc 96 ef 3c - d8 d5 c1 4f 00 f6 e2 04  ..sg...<...O....
    04e2f5c4  7d 1c f5 75 d8 ea 80 06 - 00 00 00 00 48 62 f2 75  }..u........Hb.u
    04e2f5d4  7c f6 e2 04 9c fe 80 06 - 7c f6 e2 04 88 fe 80 06  |.......|.......
    04e2f5e4  88 fe 80 06 48 62 f2 75 - a4 f8 e2 04 00 00 00 00  ....Hb.u........
    04e2f5f4  7c f6 e2 04 00 00 00 00 - 18 d6 c1 4f 24 f6 e2 04  |..........O$...
    04e2f604  08 2b f5 75 d8 ea 80 06 - 00 00 00 00 48 62 f2 75  .+.u........Hb.u
    04e2f614  7c f6 e2 04 00 00 00 00 - b8 f7 e2 04 cc 55 89 06  |............U..
    04e2f624  a4 f6 e2 04 10 3b ef 75 - 9c fe 80 06 d8 ea 80 06  .....;.u........
    04e2f634  00 00 00 00 48 62 f2 75 - 7c f6 e2 04 00 00 00 00  ....Hb.u|.......
    04e2f644  20 7a 80 06 ec c1 80 06 - 00 00 00 00 20 7a 80 06  .z...........z..
    04e2f654  d8 ea 80 06 a8 f7 e2 04 - ec c1 80 06 a4 f8 e2 04  ................
    04e2f664  9c fe 80 06 2b 80 02 80 - 8c f6 e2 04 88 be 5c 6a  ....+.........\j
    
    disassembling:
    [...]
    004592b3   push    ebx
    004592b4   mov     ebx, esp
    004592b6   mov     eax, [ebp+$c]
    004592b9   push    eax
    004592ba   mov     eax, [ebp+8]
    004592bd > call    eax
    004592bf   cmp     ebx, esp
    004592c1   jz      loc_4592ea
    004592c3   ja      loc_4592e1
    004592c5   push    eax
    004592c6   mov     eax, ebx
    [...]

",delphi,crash,windows-server-2008-r2,access-violation,,12/14/2011 13:55:34,not a real question,1,10998,9,"Delphi app crashes in file dialog on Terminal Server A Delphi 2009 frequently crashes with access violations for example if the user opens a open file dialog. Environment is a 8 core Xeon system w Windows 2008 R2 x64 SP 1.

Besides building a fresh install of the server, what else could I try?

Here is a madExcept report, with the hardware section edited to show only CPU and network adapters, (and the process list to keep the question size below 30000 bytes).

It looks like a problem related to a network component. 


    date/time         : 2011-12-12, 13:54:37, 2ms
    computer name     : TSTSVR-1
    wts client name   : P223
    user name         : erkensin
    registered owner  : Microsoft / Microsoft operating system  : Windows 2008 R2 x64 Service Pack 1 build 7601
    system language   : German
    system up time    : 85 days 5 hours
    program up time   : 2 seconds
    processors        : 8x Intel(R) Xeon(R) CPU E5620 @ 2.40GHz
    physical memory   : 461/8181 MB (free/total)
    free disk space   : (U:) 45,25 GB (I:) 45,25 GB
    display mode      : 1280x1024, 16 bit
    process id        : $3910
    allocated memory  : 44,98 MB
    executable        : dct23.exe
    exec. date/time   : 2011-11-11 13:17
    compiled with     : Delphi 2009
    madExcept version : 3.0l
    callstack crc     : $61ba1a00, $8b351f4b, $bc509c6f
    exception number  : 1
    exception class   : EAccessViolation
    exception message : Zugriffsverletzung bei Adresse 61BA1A00 in Modul 'NetworkExplorer.dll'. Schreiben von Adresse 61BA1A00.
    
    thread $b24:
    61ba1a00 +00 NetworkExplorer.dll
    004592bd +0d dct23.exe           madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe           madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll                  BaseThreadInitThunk
    
    main thread ($215c):
    7466f59d +0041 comctl32.dll                 DefSubclassProc
    778a0117 +002b ntdll.dll                    KiUserCallbackDispatcher
    6a030c61 +7985 DUI70.dll                    ?_DisplayNodeCallback@Element@DirectUI@@SGJPAUHGADGET__@@PAXPAUEventMsg@@@Z
    778a0117 +002b ntdll.dll                    KiUserCallbackDispatcher
    004c5c56 +0386 dct23.exe    Dialogs         TCustomFileDialog.Execute
    004c4135 +0115 dct23.exe    Dialogs         TFileDialogWrapper.Execute
    004c4db0 +00a8 dct23.exe    Dialogs         TOpenDialog.DoExecute
    004c4c93 +000f dct23.exe    Dialogs         TOpenDialog.Execute
    004c3a59 +0035 dct23.exe    Dialogs         TCommonDialog.Execute
    00829523 +006f dct23.exe    u_main   190 +6 TfrmMain.btnOpenClick
    004da397 +006f dct23.exe    Controls        TControl.Click
    004b16e2 +001e dct23.exe    StdCtrls        TCustomButton.Click
    004b2150 +0010 dct23.exe    StdCtrls        TCustomButton.CNCommand
    004d9e2e +02d2 dct23.exe    Controls        TControl.WndProc
    004de333 +0513 dct23.exe    Controls        TWinControl.WndProc
    004b13a8 +006c dct23.exe    StdCtrls        TButtonControl.WndProc
    004d9a54 +0024 dct23.exe    Controls        TControl.Perform
    004de483 +0023 dct23.exe    Controls        DoControlMsg
    004dee7f +000b dct23.exe    Controls        TWinControl.WMCommand
    004d9e2e +02d2 dct23.exe    Controls        TControl.WndProc
    004de333 +0513 dct23.exe    Controls        TWinControl.WndProc
    004dda4c +002c dct23.exe    Controls        TWinControl.MainWndProc
    0048cdf8 +0014 dct23.exe    Classes         StdWndProc
    778a0117 +002b ntdll.dll                    KiUserCallbackDispatcher
    771c96c0 +0047 USER32.dll                   SendMessageW
    771d0d48 +0016 USER32.dll                   CallWindowProcW
    004de42f +00d7 dct23.exe    Controls        TWinControl.DefaultHandler
    004da7b4 +0010 dct23.exe    Controls        TControl.WMLButtonUp
    004da72a +006e dct23.exe    Controls        TControl.WMMouseMove
    004d9e2e +02d2 dct23.exe    Controls        TControl.WndProc
    004de333 +0513 dct23.exe    Controls        TWinControl.WndProc
    004b13a8 +006c dct23.exe    StdCtrls        TButtonControl.WndProc
    004dda4c +002c dct23.exe    Controls        TWinControl.MainWndProc
    0048cdf8 +0014 dct23.exe    Classes         StdWndProc
    771c7885 +000a USER32.dll                   DispatchMessageW
    004fa09d +011d dct23.exe    Forms           TApplication.ProcessMessage
    004fa0e2 +000a dct23.exe    Forms           TApplication.HandleMessage
    004fa40d +00c9 dct23.exe    Forms           TApplication.Run
    0082fec6 +0076 dct23.exe    dct       24 +6 initialization
    75543398 +0010 kernel32.dll                 BaseThreadInitThunk
    
    thread $7398:
    778b0146 +0e ntdll.dll     NtWaitForMultipleObjects
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $711c:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    771d0b64 +1a USER32.dll               MsgWaitForMultipleObjects
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $15cc:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $4654:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $54c4:
    778afd7a +0e ntdll.dll                NtDelayExecution
    75e731b5 +5f KERNELBASE.dll           SleepEx
    75e73a86 +0a KERNELBASE.dll           Sleep
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    00459327 +37 dct23.exe      madExcept ThreadExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    >> created by main thread ($215c) at:
    75acda8e +00 ole32.dll
    
    thread $45e0:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    6a488c85 +38 DUser.dll                GetMessageExA
    773b1323 +67 msvcrt.dll               _endthreadex
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    00459327 +37 dct23.exe      madExcept ThreadExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    >> created by main thread ($215c) at:
    773b139c +6e msvcrt.dll               _beginthreadex
    
    thread $6ba4:
    75af6f51 +10 ole32.dll                CoTaskMemFree
    75e9604f +4c KERNELBASE.dll           CompareStringEx
    778bec3f +63 ntdll.dll                bsearch
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $494:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    771d0b64 +1a USER32.dll               MsgWaitForMultipleObjects
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $3b08:
    778b0146 +0e ntdll.dll                NtWaitForMultipleObjects
    75e70bd7 +fa KERNELBASE.dll           WaitForMultipleObjectsEx
    75541a27 +89 kernel32.dll             WaitForMultipleObjectsEx
    771d0864 +00 USER32.dll               MsgWaitForMultipleObjectsEx
    771d0b64 +1a USER32.dll               MsgWaitForMultipleObjects
    004592bd +0d dct23.exe      madExcept CallThreadProcSafe
    004599c7 +37 dct23.exe      madExcept UserWorkItemExceptFrame
    75543398 +10 kernel32.dll             BaseThreadInitThunk
    
    thread $2c7c:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    thread $2a94:
    778b1f2f +0b ntdll.dll     NtWaitForWorkViaWorkerFactory
    75543398 +10 kernel32.dll  BaseThreadInitThunk
    
    modules:
    00400000 dct23.exe                              I:\Apps\ERICSSON\Abfertigung\semc_dct
    05370000 dbxint.dll          12.0.3170.16989    I:\Apps\ERICSSON\Abfertigung\semc_dct
    40530000 gds32.dll           7.5.1.80           C:\Windows\system32
    4dae0000 MIDAS.DLL           12.0.3170.16989    I:\Apps\ERICSSON\LAGER\lgrtest
    59870000 msado15.dll         6.1.7601.17514     C:\Program Files (x86)\Common Files\System\ado
    59c80000 MsftEdit.dll        5.41.21.2510       C:\Windows\system32
    5d700000 StructuredQuery.dll 7.0.7601.17514     C:\Windows\System32
    5d760000 SearchFolder.dll    6.1.7601.17514     C:\Windows\system32
    60ee0000 thumbcache.dll      6.1.7601.17514     C:\Windows\SysWOW64
    61ba0000 NetworkExplorer.dll 6.1.7601.17514     C:\Windows\system32
    61e10000 SHDOCVW.dll         6.1.7601.17514     C:\Windows\system32
    636d0000 ieframe.dll         8.0.7601.17638     C:\Windows\SysWOW64
    64f50000 msls31.dll          3.10.349.0         C:\Windows\system32
    64fe0000 xmllite.dll         1.3.1001.0         C:\Windows\system32
    65050000 AcLayers.DLL        6.1.7601.17514     C:\Windows\AppPatch
    650e0000 ntshrui.dll         6.1.7601.17514     C:\Windows\system32
    65150000 WindowsCodecs.dll   6.1.7601.17514     C:\Windows\system32
    652d0000 EhStorShell.dll     6.1.7600.16385     C:\Windows\system32
    65320000 ntlanman.dll        6.1.7601.17514     C:\Windows\System32
    65340000 slc.dll             6.1.7600.16385     C:\Windows\system32
    653c0000 ieproxy.dll         8.0.7601.17638     C:\Program Files (x86)\Internet Explorer
    65430000 MSDART.DLL          6.1.7600.16385     C:\Windows\system32
    65580000 cscapi.dll          6.1.7601.17514     C:\Windows\system32
    65590000 LINKINFO.dll        6.1.7600.16385     C:\Windows\system32
    655c0000 USERENV.dll         6.1.7601.17514     C:\Windows\system32
    66a70000 OLEACC.dll          7.0.0.0            C:\Windows\SysWOW64
    69ff0000 DUI70.dll           6.1.7600.16385     C:\Windows\system32
    6a310000 explorerframe.dll   6.1.7601.17514     C:\Windows\system32
    6a480000 DUser.dll           6.1.7600.16385     C:\Windows\system32
    6a530000 actxprxy.dll        6.1.7601.17514     C:\Windows\SysWOW64
    6a580000 rsaenh.dll          6.1.7600.16385     C:\Windows\system32
    6a5c0000 PROPSYS.dll         7.0.7601.17514     C:\Windows\system32
    6a6c0000 CRYPTSP.dll         6.1.7600.16385     C:\Windows\system32
    73c50000 Secur32.dll         6.1.7601.17514     C:\Windows\System32
    73ce0000 drprov.dll          6.1.7600.16385     C:\Windows\System32
    73f70000 WINSPOOL.DRV        6.1.7601.17514     C:\Windows\system32
    74140000 ntmarta.dll         6.1.7600.16385     C:\Windows\system32
    74250000 gdiplus.dll         6.1.7601.17514     C:\Windows\WinSxS\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.17514_none_72d18a4386696c80
    744b0000 msimg32.dll         6.1.7600.16385     C:\Windows\system32
    74500000 uxtheme.dll         6.1.7600.16385     C:\Windows\system32
    74580000 WINSTA.dll          6.1.7601.17514     C:\Windows\system32
    74640000 comctl32.dll        6.10.7601.17514    C:\Windows\WinSxS\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_41e6975e2bd6f2b2
    747e0000 profapi.dll         6.1.7600.16385     C:\Windows\system32
    747f0000 MPR.dll             6.1.7600.16385     C:\Windows\system32
    74830000 version.dll         6.1.7600.16385     C:\Windows\system32
    74840000 winrnr.dll          6.1.7600.16385     C:\Windows\System32
    74850000 napinsp.dll         6.1.7600.16385     C:\Windows\system32
    74860000 NLAapi.dll          6.1.7601.17514     C:\Windows\system32
    74cf0000 fwpuclnt.dll        6.1.7601.17514     C:\Windows\System32
    74d30000 rasadhlp.dll        6.1.7600.16385     C:\Windows\system32
    74d40000 WINNSI.DLL          6.1.7600.16385     C:\Windows\system32
    74d50000 IPHLPAPI.DLL        6.1.7601.17514     C:\Windows\system32
    74d70000 DNSAPI.dll          6.1.7601.17570     C:\Windows\system32
    74dc0000 wshtcpip.dll        6.1.7600.16385     C:\Windows\System32
    74de0000 dwmapi.dll          6.1.7600.16385     C:\Windows\system32
    74e00000 apphelp.dll         6.1.7601.17514     C:\Windows\system32
    74e50000 wtsapi32.dll        6.1.7601.17514     C:\Windows\system32
    74e60000 DAVHLPR.dll         6.1.7600.16385     C:\Windows\System32
    74e70000 davclnt.dll         6.1.7601.17514     C:\Windows\System32
    74ee0000 RpcRtRemote.dll     6.1.7601.17514     C:\Windows\system32
    74f00000 srvcli.dll          6.1.7601.17514     C:\Windows\system32
    74f20000 netutils.dll        6.1.7601.17514     C:\Windows\system32
    74f30000 mswsock.dll         6.1.7601.17514     C:\Windows\System32
    75030000 wsock32.dll         6.1.7600.16385     C:\Windows\system32
    75050000 tsappcmp.dll        6.1.7601.17514     C:\Windows\system32
    753e0000 CRYPTBASE.dll       6.1.7600.16385     C:\Windows\syswow64
    753f0000 SspiCli.dll         6.1.7601.17514     C:\Windows\syswow64
    75450000 IMM32.DLL           6.1.7601.17514     C:\Windows\system32
    754b0000 comdlg32.dll        6.1.7601.17514     C:\Windows\syswow64
    75530000 kernel32.dll        6.1.7601.17651     C:\Windows\syswow64
    75640000 MSASN1.dll          6.1.7601.17514     C:\Windows\syswow64
    75660000 LPK.dll             6.1.7600.16385     C:\Windows\syswow64
    75670000 DEVOBJ.dll          6.1.7601.17621     C:\Windows\syswow64
    756f0000 NSI.dll             6.1.7600.16385     C:\Windows\syswow64
    75700000 SETUPAPI.dll        6.1.7601.17514     C:\Windows\syswow64
    758a0000 iertutil.dll        8.0.7601.17638     C:\Windows\syswow64
    75aa0000 ole32.dll           6.1.7601.17514     C:\Windows\syswow64
    75c00000 ADVAPI32.dll        6.1.7601.17514     C:\Windows\syswow64
    75d30000 SHLWAPI.dll         6.1.7601.17514     C:\Windows\syswow64
    75d90000 CFGMGR32.dll        6.1.7601.17621     C:\Windows\syswow64
    75dc0000 USP10.dll           1.626.7601.17514   C:\Windows\syswow64
    75e60000 KERNELBASE.dll      6.1.7601.17651     C:\Windows\syswow64
    75eb0000 shell32.dll         6.1.7601.17514     C:\Windows\syswow64
    76b00000 sechost.dll         6.1.7600.16385     C:\Windows\SysWOW64
    76b20000 CRYPT32.dll         6.1.7601.17514     C:\Windows\syswow64
    76c40000 urlmon.dll          8.0.7601.17638     C:\Windows\syswow64
    76d80000 CLBCatQ.DLL         2001.12.8530.16385 C:\Windows\syswow64
    76e10000 RPCRT4.dll          6.1.7601.17514     C:\Windows\syswow64
    76f00000 WININET.dll         8.0.7601.17638     C:\Windows\syswow64
    77000000 MSCTF.dll           6.1.7600.16385     C:\Windows\syswow64
    770d0000 WLDAP32.dll         6.1.7601.17514     C:\Windows\syswow64
    77120000 oleaut32.dll        6.1.7601.17567     C:\Windows\syswow64
    771b0000 USER32.dll          6.1.7601.17514     C:\Windows\syswow64
    77310000 GDI32.dll           6.1.7601.17514     C:\Windows\syswow64
    773a0000 msvcrt.dll          7.0.7600.16385     C:\Windows\syswow64
    77450000 WS2_32.dll          6.1.7601.17514     C:\Windows\syswow64
    77860000 PSAPI.DLL           6.1.7600.16385     C:\Windows\syswow64
    77890000 ntdll.dll           6.1.7601.17514     C:\Windows\SysWOW64
    
    processes:
    0000 Idle                     0  0    0
    0004 System                   0  0    0
    0114 smss.exe                 0  0    0
    0168 csrss.exe                0  0    0
    0194 wininit.exe              0  0    0
    019c csrss.exe                1  0    0
    01c4 winlogon.exe             1  0    0
    01f4 services.exe             0  0    0
    01fc lsass.exe                0  0    0
    0208 lsm.exe                  0  0    0
    0260 svchost.exe              0  0    0
    02c8 svchost.exe              0  0    0
    031c LogonUI.exe              1  0    0
    0328 svchost.exe              0  0    0
    0358 svchost.exe              0  0    0
    039c svchost.exe              0  0    0
    03f0 svchost.exe              0  0    0
    009c svchost.exe              0  0    0
    0200 svchost.exe              0  0    0
    05cc ffmux32.exe              0  0    0
    0618 nsclient++.exe           0  0    0
    0664 svchost.exe              0  0    0
    07ec svchost.exe              0  0    0
    0394 svchost.exe              0  0    0
    0884 svchost.exe              0  0    0
    0974 svchost.exe              0  0    0
    08c0 msdtc.exe                0  0    0
    0eec OSPPSVC.EXE              0  0    0
    1d3c svchost.exe              0  0    0
    32d0 SpntSvc.exe              0  0    0
    2b8c StWatchDog.exe           0  0    0
    6444 StOPP.exe                0  0    0
    4d28 spoolsv.exe              0  0    0
    51c8 csrss.exe                10 0    0
    0e90 winlogon.exe             10 0    0
    4a14 rdpclip.exe              10 0    0
    689c taskhost.exe             10 0    0
    2b58 dwm.exe                  10 0    0
    3060 explorer.exe             10 0    0
    103c fftray.exe               10 0    0
    37d0 pdf24.exe                10 0    0
    1a1c svchost.exe              0  0    0
    5e0c svchost.exe              0  0    0
    3510 csrss.exe                22 0    0
    3324 winlogon.exe             22 0    0
    1bc0 taskhost.exe             22 0    0
    4358 rdpclip.exe              22 0    0
    59a8 dwm.exe                  22 0    0
    5798 cmd.exe                  22 0    0
    1be0 conhost.exe              22 0    0
    223c net.exe                  22 0    0
    3c50 explorer.exe             22 0    0
    40e8 fftray.exe               22 0    0
    153c jusched.exe              22 0    0
    4844 pdf24.exe                22 0    0
    1480 WiederholungsLabel.exe   22 0    0
    33c4 consent.exe              22 0    0
    44d0 ielowutil.exe            22 0    0
    483c pdf24-Updater.exe        22 0    0
    54a4 svchost.exe              0  0    0
    4e24 WerFault.exe             22 0    0
    6680 csrss.exe                3  0    0
    0cc0 winlogon.exe             3  0    0
    635c taskhost.exe             3  0    0
    175c rdpclip.exe              3  0    0
    4678 dwm.exe                  3  0    0
    1f28 cmd.exe                  3  0    0
    3e48 conhost.exe              3  0    0
    3700 explorer.exe             3  0    0
    412c net.exe                  3  0    0
    5c60 fftray.exe               3  0    0
    6f60 jusched.exe              3  0    0
    23e4 pdf24.exe                3  0    0
    2c78 UI0Detect.exe            0  0    0
    04f4 OUTLOOK.EXE              3  0    0
    35c8 svchost.exe              0  0    0
    69d0 Tourenplanung152.exe     3  0    0
    2c38 Ladelist.exe             3  0    0
    33a8 abfe2000.exe             3  0    0
    13c0 iexplore.exe             3  0    0
    4c28 iexplore.exe             3  0    0
    0e0c FlashUtil10l_ActiveX.exe 3  0    0
    6160 csrss.exe                5  0    0
    3f40 winlogon.exe             5  0    0
    13dc taskhost.exe             5  0    0
    06b0 rdpclip.exe              5  0    0
    5a84 dwm.exe                  5  0    0
    35a8 cmd.exe                  5  0    0
    3724 conhost.exe              5  0    0
    5264 explorer.exe             5  0    0
    206c net.exe                  5  0    0
    2508 fftray.exe               5  0    0
    1298 jusched.exe              5  0    0
    540c pdf24.exe                5  0    0
    43d0 iexplore.exe             5  0    0
    698c iexplore.exe             5  0    0
    70b8 OUTLOOK.EXE              5  0    0
    0978 Winload225.exe           5  0    0
    6bec abfe2000133.exe          5  0    0
    691c Ladelist343.exe          5  0    0
    43ec Tourenplanung152.exe     5  0    0
    35cc splwow64.exe             5  0    0
    2540 SVProtokoll.exe          3  0    0
    29e0 csrss.exe                6  0    0
    400c winlogon.exe             6  0    0
    0ad4 taskhost.exe             6  0    0
    70c8 rdpclip.exe              6  0    0
    2f04 dwm.exe                  6  0    0
    2d08 cmd.exe                  6  0    0
    0f0c conhost.exe              6  0    0
    1164 net.exe                  6  0    0
    6548 explorer.exe             6  0    0
    1374 fftray.exe               6  0    0
    7170 jusched.exe              6  0    0
    2dac pdf24.exe                6  0    0
    23b4 Lagerprj.exe             6  0    0
    1d1c javaw.exe                6  0    0
    17b4 csrss.exe                7  0    0
    28d0 winlogon.exe             7  0    0
    61a4 taskhost.exe             7  0    0
    4a78 rdpclip.exe              7  0    0
    29c8 dwm.exe                  7  0    0
    6fc0 cmd.exe                  7  0    0
    2e9c conhost.exe              7  0    0
    6204 net.exe                  7  0    0
    100c explorer.exe             7  0    0
    2d84 fftray.exe               7  0    0
    4774 jusched.exe              7  0    0
    6fd4 pdf24.exe                7  0    0
    5ccc csrss.exe                8  0    0
    5dd8 winlogon.exe             8  0    0
    56b0 OUTLOOK.EXE              7  0    0
    39e4 taskhost.exe             8  0    0
    5fdc rdpclip.exe              8  0    0
    3d1c dwm.exe                  8  0    0
    0b98 cmd.exe                  8  0    0
    3d68 conhost.exe              8  0    0
    645c net.exe                  8  0    0
    5ddc explorer.exe             8  0    0
    2b4c fftray.exe               8  0    0
    2afc jusched.exe              8  0    0
    7378 pdf24.exe                8  0    0
    0818 OUTLOOK.EXE              8  0    0
    2608 mtn5250.exe              8  0    0
    47fc Ladelist343.exe          7  0    0
    65a8 csrss.exe                9  0    0
    4ed8 winlogon.exe             9  0    0
    55cc taskhost.exe             9  0    0
    66c0 rdpclip.exe              9  0    0
    6a0c dwm.exe                  9  0    0
    4368 explorer.exe             9  0    0
    6614 fftray.exe               9  0    0
    5564 jusched.exe              9  0    0
    21c0 pdf24.exe                9  0    0
    38c8 csrss.exe                11 0    0
    5560 winlogon.exe             11 0    0
    6694 taskhost.exe             11 0    0
    6760 rdpclip.exe              11 0    0
    5334 dwm.exe                  11 0    0
    6384 explorer.exe             11 0    0
    39fc fftray.exe               11 0    0
    4760 jusched.exe              11 0    0
    25e0 pdf24.exe                11 0    0
    5350 OUTLOOK.EXE              11 0    0
    5c04 csrss.exe                12 0    0
    2ff8 winlogon.exe             12 0    0
    594c taskhost.exe             12 0    0
    0880 rdpclip.exe              12 0    0
    374c dwm.exe                  12 0    0
    6edc explorer.exe             12 0    0
    2fe0 fftray.exe               12 0    0
    6524 jusched.exe              12 0    0
    56e8 pdf24.exe                12 0    0
    39c0 Tourenplanung152.exe     7  0    0
    62b4 OUTLOOK.EXE              12 0    0
    5578 abfe2000133.exe          7  0    0
    22fc Winload225.exe           7  0    0
    4508 csrss.exe                13 0    0
    3ce4 winlogon.exe             13 0    0
    16c4 taskhost.exe             13 0    0
    5e10 rdpclip.exe              13 0    0
    4704 dwm.exe                  13 0    0
    57b8 cmd.exe                  13 0    0
    56c4 conhost.exe              13 0    0
    5458 net.exe                  13 0    0
    6a10 explorer.exe             13 0    0
    02a4 fftray.exe               13 0    0
    6320 jusched.exe              13 0    0
    52c0 pdf24.exe                13 0    0
    4938 OUTLOOK.EXE              13 0    0
    5810 iexplore.exe             13 0    0
    3bf0 iexplore.exe             13 0    0
    1ba8 iexplore.exe             13 0    0
    6750 csrss.exe                14 0    0
    3dd0 winlogon.exe             14 0    0
    6d64 iexplore.exe             13 0    0
    5724 javaw.exe                13 0    0
    1fe4 taskhost.exe             14 0    0
    18e8 rdpclip.exe              14 0    0
    3288 dwm.exe                  14 0    0
    22cc explorer.exe             14 0    0
    69fc fftray.exe               14 0    0
    2ba0 jusched.exe              14 0    0
    4dfc pdf24.exe                14 0    0
    26f8 OUTLOOK.EXE              14 0    0
    3f34 csrss.exe                15 0    0
    1c3c winlogon.exe             15 0    0
    1770 taskhost.exe             15 0    0
    3074 rdpclip.exe              15 0    0
    6020 dwm.exe                  15 0    0
    5e5c explorer.exe             15 0    0
    6d7c fftray.exe               15 0    0
    3a80 jusched.exe              15 0    0
    690c pdf24.exe                15 0    0
    6ae0 iexplore.exe             9  0    0
    531c iexplore.exe             9  0    0
    1908 FlashUtil10l_ActiveX.exe 9  0    0
    0aec iexplore.exe             13 0    0
    10a8 FlashUtil10l_ActiveX.exe 13 0    0
    70a8 iexplore.exe             15 0    0
    5018 iexplore.exe             15 0    0
    2ed4 FlashUtil10l_ActiveX.exe 15 0    0
    387c OUTLOOK.EXE              15 0    0
    12a8 splwow64.exe             15 0    0
    22d0 EXCEL.EXE                15 0    0
    6920 iexplore.exe             15 0    0
    38f8 splwow64.exe             3  0    0
    5f28 iexplore.exe             9  0    0
    69c8 Tourenplanung152.exe     12 0    0
    6474 abfe2000133.exe          12 0    0
    0e58 Well20255.exe            12 0    0
    3210 Laderaumbuchung32.exe    5  0    0
    59f0 csrss.exe                20 0    0
    3a4c winlogon.exe             20 0    0
    1eac taskhost.exe             20 25   12  normal
    19d0 rdpclip.exe              20 13   10  normal
    683c dwm.exe                  20 14   2   normal
    310c explorer.exe             20 416  278 normal

...

    
    hardware:
    ...
    + Network adapters
      - Broadcom BCM5709S NetXtreme II GigE (NDIS VBD Client) (driver 4.8.4.1)
      - Broadcom BCM5709S NetXtreme II GigE (NDIS VBD Client) #2 (driver 4.8.4.1)
      - IBM-USB-NDIS-Remotenetzwerkgerät
    ...
    + Processors
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
      - Intel(R) Xeon(R) CPU           E5620  @ 2.40GHz
    ...
    
    cpu registers:
    eax = 0687d5a0
    ebx = 0680ffe0
    ecx = 61ba16a0
    edx = 00000000
    esi = 06897620
    edi = 04e2f5bc
    eip = 61ba1a00
    esp = 04e2f534
    ebp = 04e2f544
    
    stack dump:
    04e2f534  1b 1e f5 75 a0 d5 87 06 - b8 f9 f4 75 a8 f5 e2 04  ...u.......u....
    04e2f544  6c f5 e2 04 ce 1d f5 75 - 10 76 89 06 b8 f9 f4 75  l......u.v.....u
    04e2f554  a8 f5 e2 04 bc f5 e2 04 - b8 f9 f4 75 88 fe 80 06  ...........u....
    04e2f564  05 40 00 80 04 00 00 00 - c0 f5 e2 04 28 1d f5 75  .@..........(..u
    04e2f574  ac f5 e2 04 b8 f9 f4 75 - a8 f5 e2 04 7c f6 e2 04  .......u....|...
    04e2f584  4c 62 f2 75 d8 ea 80 06 - 7c f6 e2 04 e0 ff 80 06  Lb.u....|.......
    04e2f594  48 62 f2 75 05 40 00 80 - a4 f8 e2 04 d8 ea 80 06  Hb.u.@..........
    04e2f5a4  00 00 00 00 00 00 00 00 - 0d 1a 2c f0 21 be 50 43  ..........,.!.PC
    04e2f5b4  88 b0 73 67 fc 96 ef 3c - d8 d5 c1 4f 00 f6 e2 04  ..sg...<...O....
    04e2f5c4  7d 1c f5 75 d8 ea 80 06 - 00 00 00 00 48 62 f2 75  }..u........Hb.u
    04e2f5d4  7c f6 e2 04 9c fe 80 06 - 7c f6 e2 04 88 fe 80 06  |.......|.......
    04e2f5e4  88 fe 80 06 48 62 f2 75 - a4 f8 e2 04 00 00 00 00  ....Hb.u........
    04e2f5f4  7c f6 e2 04 00 00 00 00 - 18 d6 c1 4f 24 f6 e2 04  |..........O$...
    04e2f604  08 2b f5 75 d8 ea 80 06 - 00 00 00 00 48 62 f2 75  .+.u........Hb.u
    04e2f614  7c f6 e2 04 00 00 00 00 - b8 f7 e2 04 cc 55 89 06  |............U..
    04e2f624  a4 f6 e2 04 10 3b ef 75 - 9c fe 80 06 d8 ea 80 06  .....;.u........
    04e2f634  00 00 00 00 48 62 f2 75 - 7c f6 e2 04 00 00 00 00  ....Hb.u|.......
    04e2f644  20 7a 80 06 ec c1 80 06 - 00 00 00 00 20 7a 80 06  .z...........z..
    04e2f654  d8 ea 80 06 a8 f7 e2 04 - ec c1 80 06 a4 f8 e2 04  ................
    04e2f664  9c fe 80 06 2b 80 02 80 - 8c f6 e2 04 88 be 5c 6a  ....+.........\j
    
    disassembling:
    [...]
    004592b3   push    ebx
    004592b4   mov     ebx, esp
    004592b6   mov     eax, [ebp+$c]
    004592b9   push    eax
    004592ba   mov     eax, [ebp+8]
    004592bd > call    eax
    004592bf   cmp     ebx, esp
    004592c1   jz      loc_4592ea
    004592c3   ja      loc_4592e1
    004592c5   push    eax
    004592c6   mov     eax, ebx
    [...]

",4
3906847,10/11/2010 13:52:49,452785,09/20/2010 14:01:31,42,7,Unicode string and TStringStream,"Delphi 2009 and above uses unicode strings for their default string type. To my understanding  unicode char is actually 16 bit value or 2 bytes (note: I understand there is possibility of 3 or 4 bytes char, but let's consider the most usual case). However I found that TStringStream is not very reliable to manipulating this strings. For example, TStringStream.Size property returns the length of the string, while I think it should return the byte count of the contained string. Okay, you can adjust it on your own, but the thing that really confused me the most is: TStringStream does not read from or write to a buffer reliably.

Please check the following code (it's a DUnit test and always fail). Please let me know where the problem is (I was using D2010 when testing the code).

    procedure TestTCPackage.TestStringStream;
    const
      cCount = 10;
      cOrdMaxChar = Ord(High(Char));
    var
      B: Pointer;
      SW, SR: TStringStream;
      T: string;
      i, j, k : Integer;
      vStrings: array [0..cCount-1] of string;
    begin
      RandSeed := GetTickCount;
      for i := 0 to cCount - 1 do
      begin
        j := Random(100) + 1;
        SetLength(vStrings[i], j);
        for k := 1 to j do
          // fill string with random char (but no #0)
          vStrings[i][k] := Char(Random(cOrdMaxChar-1) + 1);
      end;
    
      for i := 0 to cCount - 1 do
      begin
        SW := TStringStream.Create(vStrings[i]);
        try
          GetMem(B, SW.Size * SizeOf(Char));
          try
            SW.Read(B^, SW.Size * SizeOf(Char));
    
            SR := TStringStream.Create;
            try
              SR.Write(B^, SW.Size * SizeOf(Char));
              SR.Position := 0;
    
              // check the string in the TStringStream with original value
              Check(SR.DataString = vStrings[i]);
            finally
              SR.Free;
            end;
          finally
            FreeMem(B);
          end;
        finally
          SW.Free;
        end;
      end;
    end;

Note: I already tried to use an instance of TMemoryStream as intermediary from reading/writing the buffer and use CopyFrom of the TStringStream to read the content of that TMemoryStream with same failing effect.",delphi,delphi-2010,,,,,open,0,637,4,"Unicode string and TStringStream Delphi 2009 and above uses unicode strings for their default string type. To my understanding  unicode char is actually 16 bit value or 2 bytes (note: I understand there is possibility of 3 or 4 bytes char, but let's consider the most usual case). However I found that TStringStream is not very reliable to manipulating this strings. For example, TStringStream.Size property returns the length of the string, while I think it should return the byte count of the contained string. Okay, you can adjust it on your own, but the thing that really confused me the most is: TStringStream does not read from or write to a buffer reliably.

Please check the following code (it's a DUnit test and always fail). Please let me know where the problem is (I was using D2010 when testing the code).

    procedure TestTCPackage.TestStringStream;
    const
      cCount = 10;
      cOrdMaxChar = Ord(High(Char));
    var
      B: Pointer;
      SW, SR: TStringStream;
      T: string;
      i, j, k : Integer;
      vStrings: array [0..cCount-1] of string;
    begin
      RandSeed := GetTickCount;
      for i := 0 to cCount - 1 do
      begin
        j := Random(100) + 1;
        SetLength(vStrings[i], j);
        for k := 1 to j do
          // fill string with random char (but no #0)
          vStrings[i][k] := Char(Random(cOrdMaxChar-1) + 1);
      end;
    
      for i := 0 to cCount - 1 do
      begin
        SW := TStringStream.Create(vStrings[i]);
        try
          GetMem(B, SW.Size * SizeOf(Char));
          try
            SW.Read(B^, SW.Size * SizeOf(Char));
    
            SR := TStringStream.Create;
            try
              SR.Write(B^, SW.Size * SizeOf(Char));
              SR.Position := 0;
    
              // check the string in the TStringStream with original value
              Check(SR.DataString = vStrings[i]);
            finally
              SR.Free;
            end;
          finally
            FreeMem(B);
          end;
        finally
          SW.Free;
        end;
      end;
    end;

Note: I already tried to use an instance of TMemoryStream as intermediary from reading/writing the buffer and use CopyFrom of the TStringStream to read the content of that TMemoryStream with same failing effect.",2
11259106,06/29/2012 09:15:50,727364,04/27/2011 13:31:06,167,2,Unicode PChar from Delphi 2006,"I have a DLL, written in XE2 that takes a PChar as a parameter (therefore being a unicode string). I was hoping to write an application in Delphi 2006 that calls this DLL. Is this possible, how do I pass in the PChar parameter? If I was doing it in Delphi XE2 I would simply do:

    tmpString := 'hello';
    DLL_Call(PChar(tmpString));

I have tried defining my tmpString as a WideString in Delphi 2006, but I believe a WideString and an XE2 Unicode string differ considerably?

Is there a way I can pass the string correctly to the DLL? I am in control of the DLL source code so I could obviously change the function definition to PAnsiChar but I'd prefer not to do this, I was hoping for a solution from the Delphi 2006 side if possible.",delphi,dll,unicode,,,,open,0,140,5,"Unicode PChar from Delphi 2006 I have a DLL, written in XE2 that takes a PChar as a parameter (therefore being a unicode string). I was hoping to write an application in Delphi 2006 that calls this DLL. Is this possible, how do I pass in the PChar parameter? If I was doing it in Delphi XE2 I would simply do:

    tmpString := 'hello';
    DLL_Call(PChar(tmpString));

I have tried defining my tmpString as a WideString in Delphi 2006, but I believe a WideString and an XE2 Unicode string differ considerably?

Is there a way I can pass the string correctly to the DLL? I am in control of the DLL source code so I could obviously change the function definition to PAnsiChar but I'd prefer not to do this, I was hoping for a solution from the Delphi 2006 side if possible.",3
753294,04/15/2009 19:21:37,32303,10/29/2008 09:06:33,393,15,Visually containing another app inside your own app ,"I have four small single-form utility applications that I have written in Delphi (Win32), that every once in awhile I want to use in a way that makes them ""feel"" as if they are all one application, mostly to make switching back and forth between them super-easy.    It would be great, for instance, to be able to insert them as containers inside a TabSheet,   or something along those lines.

AppControls makes a neat little component that does something similar with TForm descendents,  allowing them to be inserted inside another container in a Delphi application, but I don't see any way to do this with four separate applications unless I build a fifth application with this end result in mind, and compile in all the forms of the original four applications.    

I could also imagine wanting to ""contain"" or embed some other application as well (say, for instance, Notepad).

Is this possible in Delphi? (all things are possible... <<g>g>)... and if so, would it be super difficult, and require massive amounts of under-the-hood Windows API familiarity?  

I'm thinking the respective answers to these are probably yes, and yes, but hoping the answers are yes, and no.  Thought I would ask just to be sure. <<g>g>

<br>
If I am dreaming here from a programming perspective, and this is way more work than it's worth; any recommendations for utilities that make switching back and forth between a standard set of three or four applications simpler than it normally is in Windows?",delphi,windows,forms,,,,open,0,256,9,"Visually containing another app inside your own app  I have four small single-form utility applications that I have written in Delphi (Win32), that every once in awhile I want to use in a way that makes them ""feel"" as if they are all one application, mostly to make switching back and forth between them super-easy.    It would be great, for instance, to be able to insert them as containers inside a TabSheet,   or something along those lines.

AppControls makes a neat little component that does something similar with TForm descendents,  allowing them to be inserted inside another container in a Delphi application, but I don't see any way to do this with four separate applications unless I build a fifth application with this end result in mind, and compile in all the forms of the original four applications.    

I could also imagine wanting to ""contain"" or embed some other application as well (say, for instance, Notepad).

Is this possible in Delphi? (all things are possible... <<g>g>)... and if so, would it be super difficult, and require massive amounts of under-the-hood Windows API familiarity?  

I'm thinking the respective answers to these are probably yes, and yes, but hoping the answers are yes, and no.  Thought I would ask just to be sure. <<g>g>

<br>
If I am dreaming here from a programming perspective, and this is way more work than it's worth; any recommendations for utilities that make switching back and forth between a standard set of three or four applications simpler than it normally is in Windows?",3
10181012,04/16/2012 20:13:49,1267180,05/04/2010 15:21:03,55,0,"Integrating command-line SFTP and pgp into a delphi 2010 solution, what are the options?","We use Delphi 2010 for development, and are looking to incorporate SFTP and pgp encryption into a inbound and outbound file transfer process. Particularly looking for a command line solution that can be integrated into a job script process we have. Does anyone know of two good free solutions we may try? 

Are PGP Freeware 6.5.8 (SDK 1.7.x) or PGP 7.0, 8.0 (SDK 2.x) the best options, coupled with

http://mastercluster.com/doc/466


any and all suggestions welcomed

thanks",delphi,delphi-2010,sftp,pgp,,04/18/2012 13:43:23,off topic,1,73,14,"Integrating command-line SFTP and pgp into a delphi 2010 solution, what are the options? We use Delphi 2010 for development, and are looking to incorporate SFTP and pgp encryption into a inbound and outbound file transfer process. Particularly looking for a command line solution that can be integrated into a job script process we have. Does anyone know of two good free solutions we may try? 

Are PGP Freeware 6.5.8 (SDK 1.7.x) or PGP 7.0, 8.0 (SDK 2.x) the best options, coupled with

http://mastercluster.com/doc/466


any and all suggestions welcomed

thanks",4
4231719,11/20/2010 07:33:32,509101,11/16/2010 05:07:38,1,0,database in delphi,"can someone help me on how to Write a program - a database of students. Requirements for the program: 1) to store in memory a list of students using one-way dynamic list
 2) Required fields: surname, name, date of birth, number of students
 3) To display a list of students to use the component TListBox.",delphi,,,,,04/20/2012 12:16:36,not a real question,1,55,3,"database in delphi can someone help me on how to Write a program - a database of students. Requirements for the program: 1) to store in memory a list of students using one-way dynamic list
 2) Required fields: surname, name, date of birth, number of students
 3) To display a list of students to use the component TListBox.",1
6126051,05/25/2011 14:29:33,671228,03/22/2011 13:01:20,93,15,Delphi AV vs Try-Except,"Good day!

I have a multi-threads application with TaskManager, workers... And i have a problem.

threads execute-method looks like:

    try
     task.execute();
    except
     on E : Exception do
     begin
       log(e.message);
       //  callResetThread/disconnectUser
     end;
    end;

Each task have many Access Violations, runtime errors... Try-except for some cases does not 
help. Is there any solution for protect my program from the errors at threads...

Delphi 7/ no jedi/ default memory-managers",delphi,architecture,error-handling,try-catch,,05/25/2011 22:57:57,not a real question,1,101,4,"Delphi AV vs Try-Except Good day!

I have a multi-threads application with TaskManager, workers... And i have a problem.

threads execute-method looks like:

    try
     task.execute();
    except
     on E : Exception do
     begin
       log(e.message);
       //  callResetThread/disconnectUser
     end;
    end;

Each task have many Access Violations, runtime errors... Try-except for some cases does not 
help. Is there any solution for protect my program from the errors at threads...

Delphi 7/ no jedi/ default memory-managers",4
9562530,03/05/2012 06:33:30,622097,02/17/2011 20:41:53,236,2,How can I simulate the press of a button?,I want to test some forms. Is there a way to simulate the press of an Ok (or Cancel) button so that the button is pressed and fires the event handlers that are associated with it?,delphi,event-handling,vcl,,,,open,0,36,9,How can I simulate the press of a button? I want to test some forms. Is there a way to simulate the press of an Ok (or Cancel) button so that the button is pressed and fires the event handlers that are associated with it?,3
6806911,07/24/2011 12:55:18,537311,12/10/2010 02:04:38,203,2,Handle main window by name process,"Delphi Xe, Win7x64

How knowing a process name (a full path to exe-file) to receive Handle his main window or at least a class, or a window name (knowing, what process has only one window)? Example: MyGetWinHandle('c:\windows\system32\notepad.exe')?
",delphi,,,,,,open,0,36,6,"Handle main window by name process Delphi Xe, Win7x64

How knowing a process name (a full path to exe-file) to receive Handle his main window or at least a class, or a window name (knowing, what process has only one window)? Example: MyGetWinHandle('c:\windows\system32\notepad.exe')?
",1
1780782,11/23/2009 02:11:33,86235,04/02/2009 14:50:20,114,16,Reading Private Key in PEM format with LockBox,"I have to digitally sign a string using the SHA-1 algorithm with RSA using PKCS#1 padding.  I have downloaded Turbo Power Lockbox.

The private key I have is in PEM format and was created using openssl:

> openssl req -x509 -nodes -days 365 -newkey rsa:1024 -sha1 -subj  ""/C=US/ST=CA/L=Mountain View/CN=www.mycompany.com"" -keyout  myrsakey.pem -out c:\temp\myrsacert.pem

Here is what it looks like:

> -----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQDFzvqdAEQn9MrSLTNua5SOxshV/8jQIf3qpfunBXa9SVdm4NJw
lY7iYpwivw7EdMlBe4FmezN9LGwyIokcUSt4KUdWmA8l4Lm5rcuDzzfmlVWP7y+j
0GKG2XCp2JwHpW4Q5WiMgcAnCMD/gbDustfz3utxQhLNBdWp2MlrEH2/rQIDAQAB
AoGAUMZmnHohWtehgxYmLG8N6QfPgx7CWAupbop9KwUWKdGrOT2RcZwBDv0JmT6/
vwWZsX3Hp5ujuPfM7uQfbUrQHrcruUg/fPY8YXcWgNfOytGpaN/XKxfy2g2Cp8mE
4yoDR2QW8jo25ZH1q1cJ3jMyX9xlXaSZm7qtaoiDydE6roECQQDxqtP2tMEZ2FmQ
2o4T5Zv7P4II2PrLq+9IP0ASCZ2VzLxm2Pk6kxjnPjZ2oHG8pUQHvMz0m8Br3BY8
X1BpXrj9AkEA0YpBH7qm/nbG6YjxKAL3PbxXUJ06T/ByLjfstfCrT3LxDeklfWJb
n/V8ahRcKPLajdbKAuWvJA5NvjeJPi34cQJAZ+vD1nUIDKsiaM3zBs9X8gTvUAqu
XmMDNJguXxNPdplh8wAevHeA3/+6v+xivHJ8/K7Nm+pWJouv7Co4k/ctqQJASV4y
TUzKmgC2xyCG5+6Z6Ujf/b7/ouva3un//PiG0yu40ZkX4l4lHM4UwQPd/QyDj/Rs
CTWo7GQBvp+tc1MfUQJBALnQnNOIIkvwIK+1J6iLZgh7GurbCPMrH8nSn8SxkfBe
qq5JWo31LQAUNDW5ntG0qHZQpx6zm2MzIlt2NgOLf4s=
-----END RSA PRIVATE KEY-----



If I am not mistaken, the component I want to use is TLbRSAKey.  So I have tried to create key object and read it from file:

    var
      mPrivateKey: TLbRSAKey;
    begin
      mPrivateKey := TLbRSAKey.Create(aks1024);
      mPrivateKey.LoadFromFile('C:\temp\myrsakey.pem');


On the LoadFromFile I get a ""Invalid RSA Key"" error.  What am I doing wrong?  Does Lockbox support keys in PEM format?  None of the examples illustrate; everything seems to be in ASN format

",delphi,,,,,,open,0,157,8,"Reading Private Key in PEM format with LockBox I have to digitally sign a string using the SHA-1 algorithm with RSA using PKCS#1 padding.  I have downloaded Turbo Power Lockbox.

The private key I have is in PEM format and was created using openssl:

> openssl req -x509 -nodes -days 365 -newkey rsa:1024 -sha1 -subj  ""/C=US/ST=CA/L=Mountain View/CN=www.mycompany.com"" -keyout  myrsakey.pem -out c:\temp\myrsacert.pem

Here is what it looks like:

> -----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQDFzvqdAEQn9MrSLTNua5SOxshV/8jQIf3qpfunBXa9SVdm4NJw
lY7iYpwivw7EdMlBe4FmezN9LGwyIokcUSt4KUdWmA8l4Lm5rcuDzzfmlVWP7y+j
0GKG2XCp2JwHpW4Q5WiMgcAnCMD/gbDustfz3utxQhLNBdWp2MlrEH2/rQIDAQAB
AoGAUMZmnHohWtehgxYmLG8N6QfPgx7CWAupbop9KwUWKdGrOT2RcZwBDv0JmT6/
vwWZsX3Hp5ujuPfM7uQfbUrQHrcruUg/fPY8YXcWgNfOytGpaN/XKxfy2g2Cp8mE
4yoDR2QW8jo25ZH1q1cJ3jMyX9xlXaSZm7qtaoiDydE6roECQQDxqtP2tMEZ2FmQ
2o4T5Zv7P4II2PrLq+9IP0ASCZ2VzLxm2Pk6kxjnPjZ2oHG8pUQHvMz0m8Br3BY8
X1BpXrj9AkEA0YpBH7qm/nbG6YjxKAL3PbxXUJ06T/ByLjfstfCrT3LxDeklfWJb
n/V8ahRcKPLajdbKAuWvJA5NvjeJPi34cQJAZ+vD1nUIDKsiaM3zBs9X8gTvUAqu
XmMDNJguXxNPdplh8wAevHeA3/+6v+xivHJ8/K7Nm+pWJouv7Co4k/ctqQJASV4y
TUzKmgC2xyCG5+6Z6Ujf/b7/ouva3un//PiG0yu40ZkX4l4lHM4UwQPd/QyDj/Rs
CTWo7GQBvp+tc1MfUQJBALnQnNOIIkvwIK+1J6iLZgh7GurbCPMrH8nSn8SxkfBe
qq5JWo31LQAUNDW5ntG0qHZQpx6zm2MzIlt2NgOLf4s=
-----END RSA PRIVATE KEY-----



If I am not mistaken, the component I want to use is TLbRSAKey.  So I have tried to create key object and read it from file:

    var
      mPrivateKey: TLbRSAKey;
    begin
      mPrivateKey := TLbRSAKey.Create(aks1024);
      mPrivateKey.LoadFromFile('C:\temp\myrsakey.pem');


On the LoadFromFile I get a ""Invalid RSA Key"" error.  What am I doing wrong?  Does Lockbox support keys in PEM format?  None of the examples illustrate; everything seems to be in ASN format

",1
9220159,02/09/2012 22:51:20,696574,04/07/2011 10:15:14,136,6,DELPHI: Is Marshalling converters/reverters via polymorphism realistic?,"Well now I'm almost at the end of my journey - expanding my base units :-)

I'm currently in the process of clearing out the final parts of this question here ([Generics, Polymorphism, Interfaces: what is the solution?][1]).

But I need another - ""party trick"" - to get my magic approved. And I hope that someone has an idea (so I can close the other question too). 

So please tell me - Am I going about this the wrong way / could it be done smarter (interface perhaps) - or am I just plain silly, trying to keep my polymorphism hierarchy alive at ""all means"" ???

**Here goes the information you need :**

I have a TBaseObject class - with a TBaseList<T:TBaseObject> class in the same Unit. And I'm using inheritance to re-use a lot of functionality/properties. Basically like this :

    Base Unit;
    TBaseObject = class
    end;
    TBaseList<T:TBaseObject> = class(TObjectList<T>)
    end;
    
    CustomCustomer Unit;
    TCustomCustomer = class(TBaseObject) 
    end;
    TCustomCustomerList<T:TCustomCustomer> = class(TBaseList<T>)
    end;
    
    Customer Unit;
    TCustomer = class(TCustomCustomer)
    end;
    TCustomerList<T:TCustomer> = class(TCustomCustomerList<T>)
    end;

I'm going for a solution where every single class in my hierarchy can be marshalled into a json string notation. 
So having a look at my TBaseObject I thought I'll use a `property Mar:TJsonMarshal` and a `class procedure TBaseObject.RegisterConverters(aClass:TClass; aMar:TJsonMarshal);` to aid me in the process. This is also working as long as we don't get too creative. Let me explain with a bit more source code :-)
The BaseObject RegisterConverter procedure is somewhat like this:

    class procedure TBaseObject.RegisterConverters(aClass:TClass; aMar:TJsonMarshal); virtual;
    begin
      aMar.RegisterConverter(aClass, 'fMar',
        function(Data: TObject; Field: String): TObject
        begin
          Result := nil;
        end);  
    end;

In a subclass - lets look at `TCustomer` I will now override the RegisterConverters procedure like this.

    class procedure TBaseObject.RegisterConverters(aClass:TClass; aMar:TJsonMarshal); override;
    begin
      inherited; 
      aMar.RegisterConverter(aClass, 'fTimeOfLastContact',
      function(Data: TObject; Field: String): string
      var
        ctx: TRttiContext;
        date: TDateTime;
      begin
        date := ctx.GetType(Data.ClassType).GetField(Field).GetValue(Data).AsType<TDateTime>;
        Result := FormatDateTime('yyyy-mm-dd hh:nn:ss', date);
      end);  
    end;

Now we place the central marshalling in TBaseObject like this :

    function TBaseList<T>.Marshal: TJSONObject;
    begin
      fMar := TJSONMarshal.Create();
      try
        RegisterConverters;
        try
          Result := fMar.Marshal(Self) as TJSONObject;
        except
          on e: Exception do
            raise Exception.Create('Marshal Error : ' + e.Message);
        end;
      finally
        fMar.Free;
      end;
    end;

By doing this I have very easy access to do complete marshalling of my class TCustomer.
Simply by declaring a TJsonObject variable and do this :

    SomeJsonObj := SomeCustomer.Marshal;

And every other subclass (I have a lot) can do the same - just remember to override the RegisterConverter procedure in the subclass to support ""special types"".

**But is this really the BEST solution ???**

This concludes Part #1 (of 2 :-))
 

**PART #2 - marshalling the List part**

Actually I think I'll wait a bit with this one - since it seems like quite a bit to grasp. And to keep focus on the problem at hand. Furthermore - Part #2 will change in case of a better / different solution to Part #1.

Start shooting :-)

In case you have forgotten the question - then it can be boiled down to ""is this an OK way of doing it?"".

Remember - it actually works. And REALLY eases the process of writing new units base on TBaseObject to achieve marshalling.

Regards


  [1]: http://stackoverflow.com/questions/9192347/generics-polymorphism-interfaces-what-is-the-solution
",delphi,polymorphism,marshalling,delphi-xe2,,02/10/2012 12:55:21,not a real question,1,778,7,"DELPHI: Is Marshalling converters/reverters via polymorphism realistic? Well now I'm almost at the end of my journey - expanding my base units :-)

I'm currently in the process of clearing out the final parts of this question here ([Generics, Polymorphism, Interfaces: what is the solution?][1]).

But I need another - ""party trick"" - to get my magic approved. And I hope that someone has an idea (so I can close the other question too). 

So please tell me - Am I going about this the wrong way / could it be done smarter (interface perhaps) - or am I just plain silly, trying to keep my polymorphism hierarchy alive at ""all means"" ???

**Here goes the information you need :**

I have a TBaseObject class - with a TBaseList<T:TBaseObject> class in the same Unit. And I'm using inheritance to re-use a lot of functionality/properties. Basically like this :

    Base Unit;
    TBaseObject = class
    end;
    TBaseList<T:TBaseObject> = class(TObjectList<T>)
    end;
    
    CustomCustomer Unit;
    TCustomCustomer = class(TBaseObject) 
    end;
    TCustomCustomerList<T:TCustomCustomer> = class(TBaseList<T>)
    end;
    
    Customer Unit;
    TCustomer = class(TCustomCustomer)
    end;
    TCustomerList<T:TCustomer> = class(TCustomCustomerList<T>)
    end;

I'm going for a solution where every single class in my hierarchy can be marshalled into a json string notation. 
So having a look at my TBaseObject I thought I'll use a `property Mar:TJsonMarshal` and a `class procedure TBaseObject.RegisterConverters(aClass:TClass; aMar:TJsonMarshal);` to aid me in the process. This is also working as long as we don't get too creative. Let me explain with a bit more source code :-)
The BaseObject RegisterConverter procedure is somewhat like this:

    class procedure TBaseObject.RegisterConverters(aClass:TClass; aMar:TJsonMarshal); virtual;
    begin
      aMar.RegisterConverter(aClass, 'fMar',
        function(Data: TObject; Field: String): TObject
        begin
          Result := nil;
        end);  
    end;

In a subclass - lets look at `TCustomer` I will now override the RegisterConverters procedure like this.

    class procedure TBaseObject.RegisterConverters(aClass:TClass; aMar:TJsonMarshal); override;
    begin
      inherited; 
      aMar.RegisterConverter(aClass, 'fTimeOfLastContact',
      function(Data: TObject; Field: String): string
      var
        ctx: TRttiContext;
        date: TDateTime;
      begin
        date := ctx.GetType(Data.ClassType).GetField(Field).GetValue(Data).AsType<TDateTime>;
        Result := FormatDateTime('yyyy-mm-dd hh:nn:ss', date);
      end);  
    end;

Now we place the central marshalling in TBaseObject like this :

    function TBaseList<T>.Marshal: TJSONObject;
    begin
      fMar := TJSONMarshal.Create();
      try
        RegisterConverters;
        try
          Result := fMar.Marshal(Self) as TJSONObject;
        except
          on e: Exception do
            raise Exception.Create('Marshal Error : ' + e.Message);
        end;
      finally
        fMar.Free;
      end;
    end;

By doing this I have very easy access to do complete marshalling of my class TCustomer.
Simply by declaring a TJsonObject variable and do this :

    SomeJsonObj := SomeCustomer.Marshal;

And every other subclass (I have a lot) can do the same - just remember to override the RegisterConverter procedure in the subclass to support ""special types"".

**But is this really the BEST solution ???**

This concludes Part #1 (of 2 :-))
 

**PART #2 - marshalling the List part**

Actually I think I'll wait a bit with this one - since it seems like quite a bit to grasp. And to keep focus on the problem at hand. Furthermore - Part #2 will change in case of a better / different solution to Part #1.

Start shooting :-)

In case you have forgotten the question - then it can be boiled down to ""is this an OK way of doing it?"".

Remember - it actually works. And REALLY eases the process of writing new units base on TBaseObject to achieve marshalling.

Regards


  [1]: http://stackoverflow.com/questions/9192347/generics-polymorphism-interfaces-what-is-the-solution
",4
6573468,07/04/2011 15:32:11,791316,06/09/2011 16:11:22,287,1,Delphi: alternative for TCategoryPanelGroup,"Does an alternative exist for TCategoryPanelGroup? My problem is I use a CategoryPanelGroup on a PageControl, therefore there is an enormous flicker which I can not prevent (using DoubleBuffered, disabling a ParentBackground and other things).

Thanks!",delphi,panel,group,category,,,open,0,35,4,"Delphi: alternative for TCategoryPanelGroup Does an alternative exist for TCategoryPanelGroup? My problem is I use a CategoryPanelGroup on a PageControl, therefore there is an enormous flicker which I can not prevent (using DoubleBuffered, disabling a ParentBackground and other things).

Thanks!",4
1066153,06/30/2009 21:24:25,129366,06/26/2009 11:16:57,81,1,Fade all other windows of an application when a dialog is shown?,"How to dim / fade all other windows of an application in Delphi 2009.

Form has an AlphaBlend property, but it controls only transparency level.  But it would be nice if we can have something like this
[(Concentrated window)][1]  . Even stackoverflow.com does that, when we try to insert a link/ image etc in the post.

How can we achieve this in a delphi application?

Thanks & Regards,
Pavan

  [1]: http://www.anappaday.com/downloads/2006/09/day-10-jedi-concentrate.html",delphi,delphi-2009,,,,,open,0,69,12,"Fade all other windows of an application when a dialog is shown? How to dim / fade all other windows of an application in Delphi 2009.

Form has an AlphaBlend property, but it controls only transparency level.  But it would be nice if we can have something like this
[(Concentrated window)][1]  . Even stackoverflow.com does that, when we try to insert a link/ image etc in the post.

How can we achieve this in a delphi application?

Thanks & Regards,
Pavan

  [1]: http://www.anappaday.com/downloads/2006/09/day-10-jedi-concentrate.html",2
5897922,05/05/2011 12:48:45,196925,10/26/2009 21:57:36,1264,17,Windows7 Force boot to Safe mode via API,"Is there a way via the Windows API or altering a file to reboot the computer in safemode with Network support. (Windows 7)

For Windows 2000 and XP you could simply add '/safeboot:network' to the boot.ini file.

However with Windows 7 there is no such file.

My goal is to code this using Delphi, but any language code samples would be appreciated.",delphi,winapi,windows-7,safe-mode,,,open,0,59,8,"Windows7 Force boot to Safe mode via API Is there a way via the Windows API or altering a file to reboot the computer in safemode with Network support. (Windows 7)

For Windows 2000 and XP you could simply add '/safeboot:network' to the boot.ini file.

However with Windows 7 there is no such file.

My goal is to code this using Delphi, but any language code samples would be appreciated.",4
10956790,06/08/2012 22:35:48,988445,10/10/2011 21:32:09,2782,35,Convert any record to a string?,Is there any possible way to convert any `record` type to a single `String` and back? Perhaps a way to load the record into a stream and read it as a String? A search on Google only found me 1 other person asking the same question on another site with no answer.,delphi,type-conversion,delphi-xe2,record,,,open,0,52,6,Convert any record to a string? Is there any possible way to convert any `record` type to a single `String` and back? Perhaps a way to load the record into a stream and read it as a String? A search on Google only found me 1 other person asking the same question on another site with no answer.,4
11507305,07/16/2012 15:17:42,744588,05/09/2011 05:47:25,3653,148,Identification of a Delphi 2009 level grammar to convert to GoldParser,"Please help me to identify this [grammar](http://pastebin.com/MGZjDu0F) (attribution: It's authored by [Gamecat](http://stackoverflow.com/users/18061/gamecat)), hopefully a conversion tool is available otherwise to relief me otherwise I will have to fix it by hand (the painfull and time consuming way).

I am comfortable with GoldParser but I cant identify it and there are some subtleties I can't grasp.

Any pointer to relevant documentation is welcome.

Thanks in advance. ",delphi,grammar,delphi-2009,converter,gold-parser,07/16/2012 21:03:10,too localized,1,63,11,"Identification of a Delphi 2009 level grammar to convert to GoldParser Please help me to identify this [grammar](http://pastebin.com/MGZjDu0F) (attribution: It's authored by [Gamecat](http://stackoverflow.com/users/18061/gamecat)), hopefully a conversion tool is available otherwise to relief me otherwise I will have to fix it by hand (the painfull and time consuming way).

I am comfortable with GoldParser but I cant identify it and there are some subtleties I can't grasp.

Any pointer to relevant documentation is welcome.

Thanks in advance. ",5
1584421,10/18/2009 09:02:45,17216,09/18/2008 04:35:34,55,0,Can't use DLL (written in C++) in Delphi: The procedure entry point could not be located,"I've compiled a DLL in Visual Studio (the source code is in C++, which I barely understand). Here's a piece of **Scraper.h**:

    struct SWin
    {
       char title[512];
       HWND hwnd;
    };
    
    SCRAPER_API bool ScraperGetWinList(SWin winList[100]);

Now I'm trying to use the above function in my Delphi application:

    type
      tWin = record
        title: String;
        hwnd: HWND;
      end;
    
    function ScraperGetWinList(var WinList: Array of tWin): Boolean; external 'Scraper.dll';
    
    var
      myWinList: Array [1..100] of tWin;
    
    procedure TMainForm.GetWinListButtonClick(Sender: TObject);
    begin
      ScraperGetWinList(myWinList);
      ...

The project doesn't compile, and I get the following message: *The procedure entry point ScraperGetWinList could not be located in the dynamic link library: Scraper.dll*.

What am I doing wrong?",delphi,c++,dll,dllimport,,,open,0,197,16,"Can't use DLL (written in C++) in Delphi: The procedure entry point could not be located I've compiled a DLL in Visual Studio (the source code is in C++, which I barely understand). Here's a piece of **Scraper.h**:

    struct SWin
    {
       char title[512];
       HWND hwnd;
    };
    
    SCRAPER_API bool ScraperGetWinList(SWin winList[100]);

Now I'm trying to use the above function in my Delphi application:

    type
      tWin = record
        title: String;
        hwnd: HWND;
      end;
    
    function ScraperGetWinList(var WinList: Array of tWin): Boolean; external 'Scraper.dll';
    
    var
      myWinList: Array [1..100] of tWin;
    
    procedure TMainForm.GetWinListButtonClick(Sender: TObject);
    begin
      ScraperGetWinList(myWinList);
      ...

The project doesn't compile, and I get the following message: *The procedure entry point ScraperGetWinList could not be located in the dynamic link library: Scraper.dll*.

What am I doing wrong?",4
9487451,02/28/2012 18:15:14,1236080,02/27/2012 16:57:21,1,0,How to make a Digital clock in delphi7?,"I am pretty new to delphi , and would like to start with something easy .
Could someone please show me an example how to make a Digital clock that will transfer the ""time"" ( hour , min , sec ) to a label ? Or something like that ",delphi,delphi-7,pascal,,,,open,0,49,8,"How to make a Digital clock in delphi7? I am pretty new to delphi , and would like to start with something easy .
Could someone please show me an example how to make a Digital clock that will transfer the ""time"" ( hour , min , sec ) to a label ? Or something like that ",3
8857405,01/13/2012 21:21:44,1140885,01/10/2012 13:05:44,60,0,how do I sniff HTTP on my local machine?,"I would like to sniff port 80 requests/responses data. 

Is that can be done with TIdHTTPServer? 

If yes, then how?",delphi,delphi-7,,,,01/14/2012 00:55:09,not a real question,1,20,9,"how do I sniff HTTP on my local machine? I would like to sniff port 80 requests/responses data. 

Is that can be done with TIdHTTPServer? 

If yes, then how?",2
2834944,05/14/2010 14:35:15,81800,03/24/2009 05:02:28,2182,28,Error in my OO Generics design. How do I workaround it?,"I get ""E2511 Type parameter 'T' must be a class type"" on the third class.

    type TSomeClass=class
    end;

    ParentParentClass<T>=class 
    end;

    ParentClass<T: class> = class(ParentParentClass<T>)
    end;

    ChildClass<T: TSomeClass> = class(ParentClass<T>)
    end;

I'm trying to write a lite Generic Array wrapper for any data type(ParentParentClass) ,but because I'm unable to free type idenitifiers( if T is TObject  then Tobject(T).Free) , I created the second class, which is useful for class types, so I can free the objects. 

The third class is where I use my wrapper, but the compiler throws that error. How do I make it compile?",delphi,generics,delphi-2009,generic-programming,,,open,0,121,11,"Error in my OO Generics design. How do I workaround it? I get ""E2511 Type parameter 'T' must be a class type"" on the third class.

    type TSomeClass=class
    end;

    ParentParentClass<T>=class 
    end;

    ParentClass<T: class> = class(ParentParentClass<T>)
    end;

    ChildClass<T: TSomeClass> = class(ParentClass<T>)
    end;

I'm trying to write a lite Generic Array wrapper for any data type(ParentParentClass) ,but because I'm unable to free type idenitifiers( if T is TObject  then Tobject(T).Free) , I created the second class, which is useful for class types, so I can free the objects. 

The third class is where I use my wrapper, but the compiler throws that error. How do I make it compile?",4
10206678,04/18/2012 09:35:17,758133,05/17/2011 20:31:02,4842,454,"FastMM dumps, leaks pools and plumbing - how can I register pools for RegisterExpectedMemoryLeak?","Delphi has a good memory manager that works fine during an app. run - I have no issue with its run-time performance at all.

It can be asked to give a termination dump of 'leaks'.  The problem is that I have many apps with massive 'leaks' by design.  My apps can only be considered really leaky if the total leaked memory rises with app runtime. It is not practical to avoid leaks in many multithreaded apps without getting into the mess of terminating running and blocked threads on multiple cores - not going down that road to hell!

Nevertheless, it would be silly not to take advantage of any debugging tool available that does not cause more problems than it solves.  The FastMM supplies a 'RegisterExpectedMemoryLeak' call that seems to take two magic numbers.  Can I get the magic numbers for the objects in an object pool?  Can any 'magic numbers' be provided by the app just before shutdown?

",delphi,fastmm,,,,04/30/2012 19:56:08,not a real question,1,162,14,"FastMM dumps, leaks pools and plumbing - how can I register pools for RegisterExpectedMemoryLeak? Delphi has a good memory manager that works fine during an app. run - I have no issue with its run-time performance at all.

It can be asked to give a termination dump of 'leaks'.  The problem is that I have many apps with massive 'leaks' by design.  My apps can only be considered really leaky if the total leaked memory rises with app runtime. It is not practical to avoid leaks in many multithreaded apps without getting into the mess of terminating running and blocked threads on multiple cores - not going down that road to hell!

Nevertheless, it would be silly not to take advantage of any debugging tool available that does not cause more problems than it solves.  The FastMM supplies a 'RegisterExpectedMemoryLeak' call that seems to take two magic numbers.  Can I get the magic numbers for the objects in an object pool?  Can any 'magic numbers' be provided by the app just before shutdown?

",2
5702372,04/18/2011 11:49:11,687261,04/01/2011 08:54:39,8,0,Make application With timers etc.?,"I need to make an application as followed.

A query needs to be executed 10 times a second to check in the database (Ms SQL 2005) if the value of the field is 1 or 0. if its 1 then the appication needs to start Windows Media Player (Fullscreen) and run a video. 
The application needs to sleep during the video and when the video is finished the application needs to awake and close Windows Media Player and open Internet Explorer(fullscreen) and show a website.

I have no idea how to make this im not that experienced with Delphi.",delphi,delphi-2007,,,,04/19/2011 19:05:36,not a real question,1,97,5,"Make application With timers etc.? I need to make an application as followed.

A query needs to be executed 10 times a second to check in the database (Ms SQL 2005) if the value of the field is 1 or 0. if its 1 then the appication needs to start Windows Media Player (Fullscreen) and run a video. 
The application needs to sleep during the video and when the video is finished the application needs to awake and close Windows Media Player and open Internet Explorer(fullscreen) and show a website.

I have no idea how to make this im not that experienced with Delphi.",2
9761926,03/18/2012 20:20:53,789546,06/08/2011 16:17:50,101,6,Delphi Game internet multiplayer,"i have already created the game mechanics and graphics code of my game and now i want to add a Internet multiplayer functionality.

What library to use?
Is there a network engine or anything of this kind which will help me in my development?
Is there a proper examples of such host-client delphi program or a game?",delphi,networking,internet,multiplayer,,03/19/2012 17:12:34,not constructive,1,54,4,"Delphi Game internet multiplayer i have already created the game mechanics and graphics code of my game and now i want to add a Internet multiplayer functionality.

What library to use?
Is there a network engine or anything of this kind which will help me in my development?
Is there a proper examples of such host-client delphi program or a game?",4
5183858,03/03/2011 16:54:04,625026,02/20/2011 05:53:18,7,0,Delphi. Wrap text and add a symbol,"How to perform this in Delphi?

I have a very long string.
I need to wrap sting every 5 letters and add a dot in the end of wrapped string.

Example: 
string: ssssssssssssssssssssssssssssssssssssssssssssssssssssssssss

Result: 
sssss.
sssss.
sssss.
sssss.",delphi,text,wrap,,,,open,0,31,7,"Delphi. Wrap text and add a symbol How to perform this in Delphi?

I have a very long string.
I need to wrap sting every 5 letters and add a dot in the end of wrapped string.

Example: 
string: ssssssssssssssssssssssssssssssssssssssssssssssssssssssssss

Result: 
sssss.
sssss.
sssss.
sssss.",3
5946719,05/10/2011 07:37:04,56658,01/19/2009 12:18:46,575,26,Cast from interface to class fails when introducing additional name for interface - why?,"I stumbled upon a case where hard-casting from interface to class fails under certain circumstances. 

Consider the following type definitions:

      IDummy<T> = interface
      end;
      TMyRecord = record
        Intf:IDummy<Byte>;
      end;
      TDummy = class(TInterfacedObject, IDummy<Byte>)
      public
      end;
    
      IThisBreaksIt = IDummy<Byte>; // <== this line triggers the error

And now the simple code that uses the types:

    var
      ARecord:TMyRecord;
      Item:IDummy<Byte>;
    
      ImplWorks,
      ImplBroken:TDummy;
    begin
      ARecord.Intf:=TDummy.Create;
      Item:=ARecord.Intf;
    
      ImplWorks:=TDummy(Item);
      ImplBroken:=TDummy(ARecord.Intf); // <== resulting instance is broken
    end;

So what I am doing is storing an interface reference inside a record. Now I want to cast this back to the implementing class with a hard cast.

Here is the catch: this fails if I define an alias for my interface (`IThisBreaksIt = IDummy<Byte>`). Comment out this line and the `ImplBroken`is not broken anymore. In the broken case the addresses of `ImplWorks` and `ImplBroken` are different; instead the addresses of `Item` and `ImplBroken` are now the same. It seems like the automagic responsible for hard-casting fails to kick in.

Additional finding: Replacing `TDummy(ARecord.Intf)` by `ARecord.Intf as TDummy` fixes it.

This gave me some headache because it was buried in a bunch of code and I wasn't expecting this behavior. Is this normal?",delphi,casting,delphi-xe,,,,open,0,297,14,"Cast from interface to class fails when introducing additional name for interface - why? I stumbled upon a case where hard-casting from interface to class fails under certain circumstances. 

Consider the following type definitions:

      IDummy<T> = interface
      end;
      TMyRecord = record
        Intf:IDummy<Byte>;
      end;
      TDummy = class(TInterfacedObject, IDummy<Byte>)
      public
      end;
    
      IThisBreaksIt = IDummy<Byte>; // <== this line triggers the error

And now the simple code that uses the types:

    var
      ARecord:TMyRecord;
      Item:IDummy<Byte>;
    
      ImplWorks,
      ImplBroken:TDummy;
    begin
      ARecord.Intf:=TDummy.Create;
      Item:=ARecord.Intf;
    
      ImplWorks:=TDummy(Item);
      ImplBroken:=TDummy(ARecord.Intf); // <== resulting instance is broken
    end;

So what I am doing is storing an interface reference inside a record. Now I want to cast this back to the implementing class with a hard cast.

Here is the catch: this fails if I define an alias for my interface (`IThisBreaksIt = IDummy<Byte>`). Comment out this line and the `ImplBroken`is not broken anymore. In the broken case the addresses of `ImplWorks` and `ImplBroken` are different; instead the addresses of `Item` and `ImplBroken` are now the same. It seems like the automagic responsible for hard-casting fails to kick in.

Additional finding: Replacing `TDummy(ARecord.Intf)` by `ARecord.Intf as TDummy` fixes it.

This gave me some headache because it was buried in a bunch of code and I wasn't expecting this behavior. Is this normal?",3
8169808,11/17/2011 15:32:38,1042721,11/12/2011 02:08:51,41,3,Delphi XE2: firemonkey and playing video,"I am succedd to playing video on firemonkey using with vlc. But I have a problem with 3D forms.
If I am using my own video component with ""Firemonkey HD Application"" I have no problem, but when I want to use it with  ""Firemonkey 3D Application"" I have problem with video vibrational:(  

How can I stop the FMX controls self painting ? 

thanks",delphi,delphi-xe,vlc,firemonkey,libvlc,,open,0,64,6,"Delphi XE2: firemonkey and playing video I am succedd to playing video on firemonkey using with vlc. But I have a problem with 3D forms.
If I am using my own video component with ""Firemonkey HD Application"" I have no problem, but when I want to use it with  ""Firemonkey 3D Application"" I have problem with video vibrational:(  

How can I stop the FMX controls self painting ? 

thanks",5
401743,12/30/2008 22:42:17,16732,09/17/2008 20:15:51,82,4,Generating PDF with Quick Reports behind a Delphi Web Server,"I have a Delphi web server providing some web services*. One of them is supposed to generate and return a PDF report.

The PDF creation is done with a QReport that is then exported into a PDF file with the ExportToFilter procedure.

The routine works fine when called from within an application, but when called behind a TIdTCPServer, it hangs and never finishes. Debugging it, I got tho the hanging point:

*(note: I'm home right now and I don't have the source code. I'll try to reproduce quickrpt.pas' source as accurrate as I can remember).*

	procedure TCustomReport.ExportToFilter(TQRDocumentFilter filter);
	  ...
	  AProgress := TQRFormProgress.Create(Application); // Hangs on this line
	  AProgress.Owner := QReport;
	  if ShowProgress then AProgress.Show;
	  QReport.Client := AProgress;
	  ...
	  
Searching the web, I found [this page](http://delphi.newswhat.com/geoxml/forumhistorythread?groupname=borland.public.delphi.thirdpartytools.general&messageid=44f6db6a$1@newsgroups.borland.com) the suggestion to set ShowProgress to False, and edit the code so that it does not create the progress form when ShowProgress is set to false (apparently, this is due to QReport not being threadsafe).

So, I edited the code, and now I have this:

	procedure TCustomReport.ExportToFilter(TQRDocumentFilter filter);
	  ...
	  if ShowProgress then
	  begin
	    AProgress := TQRFormProgress.Create(Application);
	    AProgress.Owner := QReport;
	    AProgress.Show;
	    QReport.Client := AProgress
	  end;
	  ...

Now, the report comes out. But then the service gets to an Invalid Pointer Exception (which I can't trace). Following calls to the service complete successfully, but when I shut down the service** it starts whining again with Invalid Pointer Exceptions, then the ""MyServer has commited an invalid action and must be closed"" windows message, then again a couple of times more, then just the pointer exception, then comes to error 216 (which as far as I could find out, is related to Windows access permissions).

Thanks!

\* Running Delphi 7 on a Windows XP SP2. The server is based on Indy.

** I have two versions of the server: a Windows application and a Windows Service. Both call the same inner logic, and the problem occurs with both versions.",delphi,quickreports,web-services,pdf-generation,,,open,0,334,10,"Generating PDF with Quick Reports behind a Delphi Web Server I have a Delphi web server providing some web services*. One of them is supposed to generate and return a PDF report.

The PDF creation is done with a QReport that is then exported into a PDF file with the ExportToFilter procedure.

The routine works fine when called from within an application, but when called behind a TIdTCPServer, it hangs and never finishes. Debugging it, I got tho the hanging point:

*(note: I'm home right now and I don't have the source code. I'll try to reproduce quickrpt.pas' source as accurrate as I can remember).*

	procedure TCustomReport.ExportToFilter(TQRDocumentFilter filter);
	  ...
	  AProgress := TQRFormProgress.Create(Application); // Hangs on this line
	  AProgress.Owner := QReport;
	  if ShowProgress then AProgress.Show;
	  QReport.Client := AProgress;
	  ...
	  
Searching the web, I found [this page](http://delphi.newswhat.com/geoxml/forumhistorythread?groupname=borland.public.delphi.thirdpartytools.general&messageid=44f6db6a$1@newsgroups.borland.com) the suggestion to set ShowProgress to False, and edit the code so that it does not create the progress form when ShowProgress is set to false (apparently, this is due to QReport not being threadsafe).

So, I edited the code, and now I have this:

	procedure TCustomReport.ExportToFilter(TQRDocumentFilter filter);
	  ...
	  if ShowProgress then
	  begin
	    AProgress := TQRFormProgress.Create(Application);
	    AProgress.Owner := QReport;
	    AProgress.Show;
	    QReport.Client := AProgress
	  end;
	  ...

Now, the report comes out. But then the service gets to an Invalid Pointer Exception (which I can't trace). Following calls to the service complete successfully, but when I shut down the service** it starts whining again with Invalid Pointer Exceptions, then the ""MyServer has commited an invalid action and must be closed"" windows message, then again a couple of times more, then just the pointer exception, then comes to error 216 (which as far as I could find out, is related to Windows access permissions).

Thanks!

\* Running Delphi 7 on a Windows XP SP2. The server is based on Indy.

** I have two versions of the server: a Windows application and a Windows Service. Both call the same inner logic, and the problem occurs with both versions.",4
774848,04/21/2009 22:06:35,1765,08/18/2008 13:26:48,603,51,What is a good naming convention for a routine that sets a global variable in the same class,"Code Complete (Chapter 7, Section 3) says that a good function should be named for the value it returns and a good procedure name in a class should be named for what it does.  

When I write synchronized methods in Delphi (pre 2009) I sometimes need to use them to set global variables, a seemingly bad programming practice, but a necessary once since I can't pass variables. I don't want to call them ""Get"" or ""Set"" because I use those for my property methods. 

Anyone have a better naming convention for these?",delphi,synchronized,naming-conventions,routines,code-complete,,open,0,93,18,"What is a good naming convention for a routine that sets a global variable in the same class Code Complete (Chapter 7, Section 3) says that a good function should be named for the value it returns and a good procedure name in a class should be named for what it does.  

When I write synchronized methods in Delphi (pre 2009) I sometimes need to use them to set global variables, a seemingly bad programming practice, but a necessary once since I can't pass variables. I don't want to call them ""Get"" or ""Set"" because I use those for my property methods. 

Anyone have a better naming convention for these?",5
4124567,11/08/2010 14:04:36,265419,02/03/2010 16:03:02,1417,42,DockManager LoadFromStream not working,"I'm creating 5 forms and docking them to a panel called DockTarget during run time using something like

    procedure TManager.InitChild;
    begin
        Child := TChildWindow.Create(Self);
        Child.ManualDock(DockTarget);
    end;

after all five children are created and docked I'm calling 

    DockTarget.DockManager.LoadFromStream(Settings.DockSettings);

but it doesn't seem to do anything, all children are dock and no matter what I do to the layout before closing the form it opens exactly the same as if `LoadFromStream` wasn't there.

Settings.DockSettings is a TMemoryStream Loaded from file when the settings are created earlier.

and onFormClose I have

    DockTarget.DockManager.SaveToStream(Settings.DockSettings);
    Settings.Save;


Any idea's why the layout isn't being restored? Or an alternative I could use for saving/loading a docked layout?


",delphi,layout,docking,,,,open,0,137,4,"DockManager LoadFromStream not working I'm creating 5 forms and docking them to a panel called DockTarget during run time using something like

    procedure TManager.InitChild;
    begin
        Child := TChildWindow.Create(Self);
        Child.ManualDock(DockTarget);
    end;

after all five children are created and docked I'm calling 

    DockTarget.DockManager.LoadFromStream(Settings.DockSettings);

but it doesn't seem to do anything, all children are dock and no matter what I do to the layout before closing the form it opens exactly the same as if `LoadFromStream` wasn't there.

Settings.DockSettings is a TMemoryStream Loaded from file when the settings are created earlier.

and onFormClose I have

    DockTarget.DockManager.SaveToStream(Settings.DockSettings);
    Settings.Save;


Any idea's why the layout isn't being restored? Or an alternative I could use for saving/loading a docked layout?


",3
5616892,04/11/2011 04:55:45,627492,02/22/2011 00:31:52,56,1,Is the Delphi language evolving and updating?,Is the Delphi language updating and evolving to integrate popular features found in other languages?,delphi,,,,,04/11/2011 05:19:08,not constructive,1,15,7,Is the Delphi language evolving and updating? Is the Delphi language updating and evolving to integrate popular features found in other languages?,1
8776774,01/08/2012 10:24:45,201751,11/03/2009 14:38:06,168,5,Delphi / C++Buider. Margin between TPageControl and its TTabSheets,"I noticed that the Left property for TTabSheet in the TPageControl is always 4. Because of this there is always at least a 4 pixel margin between TPageControl border and controls within the TTabSheet. I want to set this margin to 0 (at least for the left border). But I can't set TTabSheet.Left to 0, it always automatically reverts to 4 pixels.

I tried to set the Left property in the OnResize for TTabSheet and for TTabControl. Doesnt't help.

How reduce this margin to 0 (at least for the left border)? I'm using C++Builder6",delphi,c++builder,vcl,c++builder-6,,,open,0,92,9,"Delphi / C++Buider. Margin between TPageControl and its TTabSheets I noticed that the Left property for TTabSheet in the TPageControl is always 4. Because of this there is always at least a 4 pixel margin between TPageControl border and controls within the TTabSheet. I want to set this margin to 0 (at least for the left border). But I can't set TTabSheet.Left to 0, it always automatically reverts to 4 pixels.

I tried to set the Left property in the OnResize for TTabSheet and for TTabControl. Doesnt't help.

How reduce this margin to 0 (at least for the left border)? I'm using C++Builder6",4
6800996,07/23/2011 14:25:30,380396,06/30/2010 15:54:30,158,2,an unusual result in simple code,"Today one of my friend ask me about below code :

    var
      a: Integer;
    begin
      ShowMessageIntToStr(a));
    end;

This is local variable and not been initialized , ok ?

Put code in OnClick event of a button component and then run code in three diffrent ways below :

1- Click on the button and see result  , result = 1635841
2- Press Enter key and see result      , result = 1
3- Press Space key and see result    , reuslt = 1636097

I test code in two diffrent computer & see same result , any idea about this ?",delphi,,,,,,open,0,120,6,"an unusual result in simple code Today one of my friend ask me about below code :

    var
      a: Integer;
    begin
      ShowMessageIntToStr(a));
    end;

This is local variable and not been initialized , ok ?

Put code in OnClick event of a button component and then run code in three diffrent ways below :

1- Click on the button and see result  , result = 1635841
2- Press Enter key and see result      , result = 1
3- Press Space key and see result    , reuslt = 1636097

I test code in two diffrent computer & see same result , any idea about this ?",1
2124657,01/23/2010 20:49:07,179542,09/26/2009 18:15:52,460,45,Books on designing and implementing a Delphi application,"I would like to broaden my Delphi horizons by reading a book about `creation of Delphi applications`. So far I have read books about Delphi mostly from *Marco Cantu (Delphi 6-2009)* or *The Tomes of Delphi Algorithms and Data Structures*.

But none of them describe the process of application creation from the beginning to end. Somewhere you see usage of design patterns, customized data structures or language specifics. But I cannot find a book which I would take as a **reference in application development**. Sure there are many hints and howtos on specific problems, there are also open source applications in delphi, from which one can learn a lot.

Are there books, which would guide a programmer in the process of creating advanced desktop Delphi applications? 

With

 - strong
 - scalable
 - modular
 - decoupled 

source code at the end?",delphi,books,scalable,guidelines,,09/28/2011 11:31:38,not constructive,1,138,8,"Books on designing and implementing a Delphi application I would like to broaden my Delphi horizons by reading a book about `creation of Delphi applications`. So far I have read books about Delphi mostly from *Marco Cantu (Delphi 6-2009)* or *The Tomes of Delphi Algorithms and Data Structures*.

But none of them describe the process of application creation from the beginning to end. Somewhere you see usage of design patterns, customized data structures or language specifics. But I cannot find a book which I would take as a **reference in application development**. Sure there are many hints and howtos on specific problems, there are also open source applications in delphi, from which one can learn a lot.

Are there books, which would guide a programmer in the process of creating advanced desktop Delphi applications? 

With

 - strong
 - scalable
 - modular
 - decoupled 

source code at the end?",4
6794226,07/22/2011 18:07:02,848099,07/16/2011 19:54:10,30,0,Can i use DropBox to make Auto Update feature for My App,It's just a simple idea have crossed my mind of making the auto update feature for my application but i don't have a server or a good host for making this feature so i did think about Dropbox .. so can i use it or any other free services to add this feature to my programs ?,delphi,delphi-2009,dropbox,,,01/04/2012 21:50:30,off topic,1,57,12,Can i use DropBox to make Auto Update feature for My App It's just a simple idea have crossed my mind of making the auto update feature for my application but i don't have a server or a good host for making this feature so i did think about Dropbox .. so can i use it or any other free services to add this feature to my programs ?,3
5127382,02/26/2011 14:18:25,635569,02/26/2011 14:14:16,1,0,How to avoid saving duplicate code in Delphi 7 listview?,"I'm only working with listview (and edits of course), not using the database and would like to know how to avoid saving duplicate codes. I dont know how when you save it from the second program code shows that the code already exists or not.
 Thanks
 JB
",delphi,,,,,02/26/2011 20:01:49,not a real question,1,47,10,"How to avoid saving duplicate code in Delphi 7 listview? I'm only working with listview (and edits of course), not using the database and would like to know how to avoid saving duplicate codes. I dont know how when you save it from the second program code shows that the code already exists or not.
 Thanks
 JB
",1
4340845,12/02/2010 22:51:25,210780,11/13/2009 22:30:25,124,6,Two Classes In Two Units With The Same Class Name in Delphi,"I Have a case in Delphi such as:

Unit A contains class ""One""
Unit B contains class ""One""

I'm in a class that uses unit A and want to use a static function from the class One in B; how do I do it? In C#, I'd write something like:

    B.One.SomeProcedure

Or even I would use ""using"" to ""rename"" one namespace. What can I do in Delphi? (Removing the ""uses"" for unit A is not an option, nor is renaming one of the two classes.)",delphi,namespaces,,,,,open,0,84,12,"Two Classes In Two Units With The Same Class Name in Delphi I Have a case in Delphi such as:

Unit A contains class ""One""
Unit B contains class ""One""

I'm in a class that uses unit A and want to use a static function from the class One in B; how do I do it? In C#, I'd write something like:

    B.One.SomeProcedure

Or even I would use ""using"" to ""rename"" one namespace. What can I do in Delphi? (Removing the ""uses"" for unit A is not an option, nor is renaming one of the two classes.)",2
2914060,05/26/2010 14:53:56,133516,06/09/2009 04:42:06,301,11,"Delphi OLE - How to avoid errors like ""The requested member of the collection does not exist""?","I'm automating Word with Delphi, but some times I got an error message:
> The requested member of the collection
> does not exist

It seems that the `Item` member of the `Styles` collection class does not always exist and some times causes the above mentioned error. My workaround is to catch the exception and skip it, but is there anyway to detect it instead of using the `try...except` block? The problem with the `try...except` block is that when debugging the raised exception is annoying...

My code example: 

    var
      aWordDoc: _WordDocument
      i: Integer;
      ovI: OleVariant;
      wordStyle: Style;
    begin
      for i := 1 to aWordDoc.Styles.Count do
      begin
        ovI := i;
        try
          wordStyle := aWordDoc.Styles.Item(ovI);
        except
          Continue;//skip if any error occurred.
        end;
        
        //do something with wordStyle
      end;
    end",delphi,ole,,,,,open,0,228,17,"Delphi OLE - How to avoid errors like ""The requested member of the collection does not exist""? I'm automating Word with Delphi, but some times I got an error message:
> The requested member of the collection
> does not exist

It seems that the `Item` member of the `Styles` collection class does not always exist and some times causes the above mentioned error. My workaround is to catch the exception and skip it, but is there anyway to detect it instead of using the `try...except` block? The problem with the `try...except` block is that when debugging the raised exception is annoying...

My code example: 

    var
      aWordDoc: _WordDocument
      i: Integer;
      ovI: OleVariant;
      wordStyle: Style;
    begin
      for i := 1 to aWordDoc.Styles.Count do
      begin
        ovI := i;
        try
          wordStyle := aWordDoc.Styles.Item(ovI);
        except
          Continue;//skip if any error occurred.
        end;
        
        //do something with wordStyle
      end;
    end",2
8180718,11/18/2011 10:06:00,531199,12/05/2010 12:59:48,489,12,"Using Indy 9.0.0.12, TIdTcpClient.Connect(ATimeOut) does not time out as specified","Using Indy 9.0.0.12, the choice of `ATimeOut` of `TIdTcpClient.Connect(ATimeOut)` doesn't seem to make a difference. For example, if the server application using TIdTcpServer is not launched, the client application using TIdTcpClient will hang where `TIdTcpClient.Connect(ATimeOut)` is called.

It seems that issues about timing out when sending plain msg/receiving plain msg/downloading file should necessicate heartbeat-wise algorithms. However, if the `TIdTcpClient.Connect(ATimeOut)` does not return after ATimeOut, how should the hearbeat algorithms be implement? ",delphi,sockets,timeout,indy,kylix,11/18/2011 19:52:50,too localized,1,71,10,"Using Indy 9.0.0.12, TIdTcpClient.Connect(ATimeOut) does not time out as specified Using Indy 9.0.0.12, the choice of `ATimeOut` of `TIdTcpClient.Connect(ATimeOut)` doesn't seem to make a difference. For example, if the server application using TIdTcpServer is not launched, the client application using TIdTcpClient will hang where `TIdTcpClient.Connect(ATimeOut)` is called.

It seems that issues about timing out when sending plain msg/receiving plain msg/downloading file should necessicate heartbeat-wise algorithms. However, if the `TIdTcpClient.Connect(ATimeOut)` does not return after ATimeOut, how should the hearbeat algorithms be implement? ",5
9483595,02/28/2012 14:19:52,1238056,02/28/2012 14:09:45,1,0,Informix Native Driver for Delphi XE2 Professional?,"please does exist some native driver for Informix databases for Delphi XE2 Professional ?
What are you using?
 
I know that does exist IDAC, now opensource, but these sources are for pre-Unicode Delphi versions and is not easy to change it (at least for me).

Thank you very much.

Leos",delphi,informix,delphi-xe2,,,,open,0,47,7,"Informix Native Driver for Delphi XE2 Professional? please does exist some native driver for Informix databases for Delphi XE2 Professional ?
What are you using?
 
I know that does exist IDAC, now opensource, but these sources are for pre-Unicode Delphi versions and is not easy to change it (at least for me).

Thank you very much.

Leos",3
752902,04/15/2009 17:43:45,14031,09/16/2008 21:45:37,450,32,how can i hide TRibbon pages?,"i'm using delphi 2009's TRibbon component.  certain pages are not relevant depending on the application state.  how can i hide a TRibbon page?

RibbonPage1.Visible:=false doesn't really hide the page...

is this maybe not allowed by the spec from microsoft?

thank you for you help!
mp",delphi,delphi-2009,tribbon,,,,open,0,43,6,"how can i hide TRibbon pages? i'm using delphi 2009's TRibbon component.  certain pages are not relevant depending on the application state.  how can i hide a TRibbon page?

RibbonPage1.Visible:=false doesn't really hide the page...

is this maybe not allowed by the spec from microsoft?

thank you for you help!
mp",3
3221364,07/11/2010 00:21:06,31491,10/25/2008 20:51:24,702,73,What is a good way of accessing dBase files using BDE and Delphi?,"First of all, I must state that I'm a complete newb when it comes to Delphi, allthough I did some Turbo Pascal programming in school, some fourteen years ago...

I have a comercial Delphi program which uses dBase database and BDE for accessing them. I basically need to interface another application written in C# to this database, to be able to do SQL operations such as select, insert, update and delete.

Unfortunaltely using OLEDB against dBase results in broken indexes, only native BDE apps seem to be able to safely access the data.

The general idea was to create a simple Delphi console application which could read SQL statements from standard input (Read/ReadLn) and output CSV data to standard output (WriteLn).

How would I go about doing this?

I have successfully gotten simple TTable-access to work, with the following code:

    tbl := TTable.Create(nil);
    
    tbl.DatabaseName := 'Exceline';
    tbl.TableName := 'KUNDE.DBF';
    tbl.Active := True;
    
    WriteLn(tbl.RecordCount);
    
    tbl.Active := False;

Is there a way I could achieve the same but by executing direct SQL statements instead?",delphi,bde,dbase,,,,open,0,196,13,"What is a good way of accessing dBase files using BDE and Delphi? First of all, I must state that I'm a complete newb when it comes to Delphi, allthough I did some Turbo Pascal programming in school, some fourteen years ago...

I have a comercial Delphi program which uses dBase database and BDE for accessing them. I basically need to interface another application written in C# to this database, to be able to do SQL operations such as select, insert, update and delete.

Unfortunaltely using OLEDB against dBase results in broken indexes, only native BDE apps seem to be able to safely access the data.

The general idea was to create a simple Delphi console application which could read SQL statements from standard input (Read/ReadLn) and output CSV data to standard output (WriteLn).

How would I go about doing this?

I have successfully gotten simple TTable-access to work, with the following code:

    tbl := TTable.Create(nil);
    
    tbl.DatabaseName := 'Exceline';
    tbl.TableName := 'KUNDE.DBF';
    tbl.Active := True;
    
    WriteLn(tbl.RecordCount);
    
    tbl.Active := False;

Is there a way I could achieve the same but by executing direct SQL statements instead?",3
8810052,01/10/2012 20:27:30,1140885,01/10/2012 13:05:44,35,0,How to use Interface with VCL Classes - Part 2?,"continue with my previous investigation regarding the use of Interface with VCL.

http://stackoverflow.com/questions/8804577/how-to-implement-identical-methods-with-2-and-more-classes

http://stackoverflow.com/questions/8805768/how-to-use-interface-with-vcl-classes

I would like to have a code example to demonstrate where and how the two work together.
Or what is the classic benefit/usage of the two:

    ISomething = interface
    ['{EFE0308B-A85D-4DF3-889C-40FBC8FE84D0}']
    ...
    end;

    TSomeThing = class(TSomeVCLObject, ISomething)
    ...
    end;

",delphi,delphi-7,,,,01/12/2012 04:49:14,not a real question,1,69,10,"How to use Interface with VCL Classes - Part 2? continue with my previous investigation regarding the use of Interface with VCL.

http://stackoverflow.com/questions/8804577/how-to-implement-identical-methods-with-2-and-more-classes

http://stackoverflow.com/questions/8805768/how-to-use-interface-with-vcl-classes

I would like to have a code example to demonstrate where and how the two work together.
Or what is the classic benefit/usage of the two:

    ISomething = interface
    ['{EFE0308B-A85D-4DF3-889C-40FBC8FE84D0}']
    ...
    end;

    TSomeThing = class(TSomeVCLObject, ISomething)
    ...
    end;

",2
11241106,06/28/2012 08:51:30,1187470,02/03/2012 12:19:57,1,0,Access Violation using 'form.showmodal' mehtod,"I am trying to make a multiforms application by having only the main form created on start up and creating each new additional form dynamically as needed by creating that form object, using it as a modal and once that form's purpose is complete, it is freed from memory after it is closed. Only my main form is 'auto-created', all additional forms are set as 'available' in the the project options.
 
Here is sample code.
 
results form is declared as a global variable of TResultForm.

procedure TMainForm.Button1Click(Sender: TObject);
begin
  ResultsForm := TResultForm.Create(self);
  try
    ResultsForm.ShowModal;
  finally
    ResultsForm.Free;
  end;
end;
 
The moment I call this method by clicking on the button, the Results form opens as it should, displays, but I recieve an access violation error:
 
'access violation at address 005B0291 in module 'MyApp.exe'. Read of address 00000000'. 
 
On that form I have databases being linked to that form and displayed. Code for that works, no problems. Since trying this new sample code sourced from Embarcadero's help tool, only the controls on the new form (ResultForm) are loaded, no explicitly added code on that form initiates.",delphi,,,,,06/29/2012 15:10:11,not a real question,1,192,5,"Access Violation using 'form.showmodal' mehtod I am trying to make a multiforms application by having only the main form created on start up and creating each new additional form dynamically as needed by creating that form object, using it as a modal and once that form's purpose is complete, it is freed from memory after it is closed. Only my main form is 'auto-created', all additional forms are set as 'available' in the the project options.
 
Here is sample code.
 
results form is declared as a global variable of TResultForm.

procedure TMainForm.Button1Click(Sender: TObject);
begin
  ResultsForm := TResultForm.Create(self);
  try
    ResultsForm.ShowModal;
  finally
    ResultsForm.Free;
  end;
end;
 
The moment I call this method by clicking on the button, the Results form opens as it should, displays, but I recieve an access violation error:
 
'access violation at address 005B0291 in module 'MyApp.exe'. Read of address 00000000'. 
 
On that form I have databases being linked to that form and displayed. Code for that works, no problems. Since trying this new sample code sourced from Embarcadero's help tool, only the controls on the new form (ResultForm) are loaded, no explicitly added code on that form initiates.",1
4533314,12/26/2010 09:12:14,554213,12/26/2010 09:12:14,1,0,How to backup a Windows driver using Delphi,"Can someone please help me and tell me how I can backup a Windows driver problematically using Delphi?

Any code samples, links to articles are highly appreciated

Thanks for your time",delphi,delphi-7,,,,,open,0,29,8,"How to backup a Windows driver using Delphi Can someone please help me and tell me how I can backup a Windows driver problematically using Delphi?

Any code samples, links to articles are highly appreciated

Thanks for your time",2
5390477,03/22/2011 11:30:19,512422,11/18/2010 16:40:17,304,13,DeleteFile not working,"It seems that somewhere in my code the file i am working with has a hold on it somehow, cause i can't seem to delete it. My CopyFile routine seems to work, but after i am done copying it, i can't seem to delete it.  

       FSize:=  GetFileSizeExt(InPath + InFileName);
       if FSize <= 0 then
       begin
        //archive file
        if  AfterAction = 'MOVE' then
        begin
         tmpExt:= ExtractFileExt(InFileName);
         if CopyFile(PChar(InPath + InFileName), PChar(MovePath + '\' + ChangeFileExt(InFileName,'') + '_' + FormatDateTime('mmddyyyy-hhmmss', Now) + tmpExt), True) then
         begin
          if not DeleteFile(pchar(InPath + InFileName)) then
          begin
           ExitCode:= 8;
           raise ECustomException.Create('Invalid After Action. Error Deleting File!');
          end;
         end //if CopyFile
         else //if not DeleteFile
         begin
          ExitCode:= 16;
          raise ECustomException.Create('File Copy Error!');
         end; //else
        end; //if  AfterAction = 'MOVE' then
         ExitCode:= 17;
         raise ECustomException.Create('Error Getting file size OR file size less than or equal to zero!');
       end; //if filesize =0


when I set a break point on the line  
if not DeleteFile  
it always ends up raising the exception. The InPath & InFileName match that used in the  
CopyFile routine  

Anyways, i always get the error try to delete the file.  Does this have anything to do with File Size?  I only copy and delete if file size <= 0",delphi,delphi-7,,,,,open,0,402,3,"DeleteFile not working It seems that somewhere in my code the file i am working with has a hold on it somehow, cause i can't seem to delete it. My CopyFile routine seems to work, but after i am done copying it, i can't seem to delete it.  

       FSize:=  GetFileSizeExt(InPath + InFileName);
       if FSize <= 0 then
       begin
        //archive file
        if  AfterAction = 'MOVE' then
        begin
         tmpExt:= ExtractFileExt(InFileName);
         if CopyFile(PChar(InPath + InFileName), PChar(MovePath + '\' + ChangeFileExt(InFileName,'') + '_' + FormatDateTime('mmddyyyy-hhmmss', Now) + tmpExt), True) then
         begin
          if not DeleteFile(pchar(InPath + InFileName)) then
          begin
           ExitCode:= 8;
           raise ECustomException.Create('Invalid After Action. Error Deleting File!');
          end;
         end //if CopyFile
         else //if not DeleteFile
         begin
          ExitCode:= 16;
          raise ECustomException.Create('File Copy Error!');
         end; //else
        end; //if  AfterAction = 'MOVE' then
         ExitCode:= 17;
         raise ECustomException.Create('Error Getting file size OR file size less than or equal to zero!');
       end; //if filesize =0


when I set a break point on the line  
if not DeleteFile  
it always ends up raising the exception. The InPath & InFileName match that used in the  
CopyFile routine  

Anyways, i always get the error try to delete the file.  Does this have anything to do with File Size?  I only copy and delete if file size <= 0",2
384690,12/21/2008 17:18:57,32914,10/30/2008 22:10:38,329,14,How do I make a generic object list work from a specific base class?,"       TMyDataList<T: TBaseDatafile, constructor> = class(TObjectList<TBaseDatafile>)
       public
          constructor Create;
          procedure upload(db: TDataSet);
       end;

I read in a blog post (I don't remember where now) that this is the way to declare a generic-based class with a specific base type for the generic object.  And the compiler will accept it just fine.  But when I try to use it, it decides not to cooperate.

    type
       TDescendantList = TMyDataList<TDescendantDatafile>;

This gives me a compiler error.

[DCC Error] my_database.pas(1145): E2010 Incompatible types: 'TDescendantDatafile' and 'TBaseDatafile'

Thing is, 1145 isn't even a valid line.  The file in question ends at #1142, and the type declaration that it's complaining about is on line #20.  This makes me wonder if it's a compiler glitch.  Or do I just not quite have the syntax right? Does anyone know a way to make this work?",delphi,delphi-2009,generics,,,,open,0,183,14,"How do I make a generic object list work from a specific base class?        TMyDataList<T: TBaseDatafile, constructor> = class(TObjectList<TBaseDatafile>)
       public
          constructor Create;
          procedure upload(db: TDataSet);
       end;

I read in a blog post (I don't remember where now) that this is the way to declare a generic-based class with a specific base type for the generic object.  And the compiler will accept it just fine.  But when I try to use it, it decides not to cooperate.

    type
       TDescendantList = TMyDataList<TDescendantDatafile>;

This gives me a compiler error.

[DCC Error] my_database.pas(1145): E2010 Incompatible types: 'TDescendantDatafile' and 'TBaseDatafile'

Thing is, 1145 isn't even a valid line.  The file in question ends at #1142, and the type declaration that it's complaining about is on line #20.  This makes me wonder if it's a compiler glitch.  Or do I just not quite have the syntax right? Does anyone know a way to make this work?",3
10125641,04/12/2012 14:26:55,1329338,04/12/2012 14:15:26,1,0,Differences in uses clause,What is the difference between a declared unit in the interface block and a declared unit in the implementation block?,delphi,,,,,,open,0,20,4,Differences in uses clause What is the difference between a declared unit in the interface block and a declared unit in the implementation block?,1
6527343,06/29/2011 21:14:25,821950,06/29/2011 21:11:31,1,0,What will I do using the LZMA?,"Hello I download Lzma for delphi its 48 kb.What will I do now?How can I use it?
Is there any example code for Lzma in DElphi?",delphi,,,,,06/30/2011 08:48:11,not a real question,1,25,7,"What will I do using the LZMA? Hello I download Lzma for delphi its 48 kb.What will I do now?How can I use it?
Is there any example code for Lzma in DElphi?",1
10555366,05/11/2012 16:39:59,359671,06/06/2010 12:28:34,1167,68,Delphi XE2 component for rollover menu,"In my application (Delphi Xe2) I have 'multichoice' button (ie 'Export' Button have 'Export to PDF' and 'Export to XLS' choices).
I need to get a menu, like that of the popup menu to appear when I move the mouse over a button (or panel or other object). This menu needs to appear just under the button and needs to be a ""VCL Stylable"" component.
I tried a TPopUpMenu but it is not convenient to Hide.
I may also considere to show the menu with the OnClick event instead of OnEnter.
",delphi,user-interface,delphi-xe2,popupmenu,,,open,0,88,6,"Delphi XE2 component for rollover menu In my application (Delphi Xe2) I have 'multichoice' button (ie 'Export' Button have 'Export to PDF' and 'Export to XLS' choices).
I need to get a menu, like that of the popup menu to appear when I move the mouse over a button (or panel or other object). This menu needs to appear just under the button and needs to be a ""VCL Stylable"" component.
I tried a TPopUpMenu but it is not convenient to Hide.
I may also considere to show the menu with the OnClick event instead of OnEnter.
",4
6993588,08/09/2011 08:50:40,362214,05/26/2010 10:47:24,349,7,"Delphi, Winhttp, Google Login, Fusion Tables","This is the continue of my previous question:

http://stackoverflow.com/questions/6943626/delphi-webbrowser-google-login-fusiontable

But the test with WinHTTP also failed as TWebBrowser based test...

And this is one question as you wish... :-)

I have one table what is NOW PUBLIC, but when we will buy non-free account it will be changed to private kind.

I created a simple WinHTTP test, but this also failed.

I can login, I got the ""Auth"" tag, but the next ""private"" request returns 401 error.

    procedure TForm1.BitBtn1Click(Sender: TObject);
    var
        WinHttpReq, temp : variant;
        URL, s : String;
        params : TStringList;
        authtoken, query, posts : string;
    begin
        URL := 'https://www.google.com/accounts/ClientLogin';
    
        WinHttpReq := CreateOleObject('WinHttp.WinHttpRequest.5.1');
    
        params := TStringList.Create;
        try
            params.Values['accountType'] := 'GOOGLE';
            params.Values['Email'] := csEmail;
            params.Values['Passwd'] := csPwd;
            params.Values['service'] := 'fusiontables';
            params.Values['source'] := csSource;
            posts := EncodeParamsToURL(params);
        finally
            params.Free;
        end;
    
        URL := URL + '?' + posts;
    
        WinHttpReq.Open('POST', URL, false);
        WinHttpReq.Send();
        s := WinHttpReq.ResponseText;
    
        Memo1.Lines.Text := s;
    
        params := TStringList.Create;
        try
            params.Text := s;
            authtoken := params.Values['Auth'];
            Edit1.Text := authtoken;
        finally
            params.Free;
        end;
    
        //query := URLEncode('SHOW TABLES');
        query := URLEncode('select * from 1236965');
    
        url := 'http://www.google.com/fusiontables/api/query?sql=' + query;
    
        WinHttpReq.Open('POST', URL, false);
        WinHttpReq.setRequestHeader('Authorization', 'GoogleLogin auth=""' + authToken + '""');
        WinHttpReq.Send();
        s := WinHttpReq.ResponseText;
    
        Memo1.Lines.Text := s;
    
    end;


When I made ""select"", I got the rows.
But when I want to see the tablenames, I get 401 error...

I'm not sure what cause this error.

a.) The free account don't have enough rights to access it privately

b.) I set the header wrong

c.) I set the csSource wrong (I set it ""MyCompanyName-Test-1.0"")

d.) Other thing I don't know what...


Can anybody help me how to login and access the data successfully?

Thanks:
   dd",delphi,google,private,fusion,winhttp,,open,0,624,6,"Delphi, Winhttp, Google Login, Fusion Tables This is the continue of my previous question:

http://stackoverflow.com/questions/6943626/delphi-webbrowser-google-login-fusiontable

But the test with WinHTTP also failed as TWebBrowser based test...

And this is one question as you wish... :-)

I have one table what is NOW PUBLIC, but when we will buy non-free account it will be changed to private kind.

I created a simple WinHTTP test, but this also failed.

I can login, I got the ""Auth"" tag, but the next ""private"" request returns 401 error.

    procedure TForm1.BitBtn1Click(Sender: TObject);
    var
        WinHttpReq, temp : variant;
        URL, s : String;
        params : TStringList;
        authtoken, query, posts : string;
    begin
        URL := 'https://www.google.com/accounts/ClientLogin';
    
        WinHttpReq := CreateOleObject('WinHttp.WinHttpRequest.5.1');
    
        params := TStringList.Create;
        try
            params.Values['accountType'] := 'GOOGLE';
            params.Values['Email'] := csEmail;
            params.Values['Passwd'] := csPwd;
            params.Values['service'] := 'fusiontables';
            params.Values['source'] := csSource;
            posts := EncodeParamsToURL(params);
        finally
            params.Free;
        end;
    
        URL := URL + '?' + posts;
    
        WinHttpReq.Open('POST', URL, false);
        WinHttpReq.Send();
        s := WinHttpReq.ResponseText;
    
        Memo1.Lines.Text := s;
    
        params := TStringList.Create;
        try
            params.Text := s;
            authtoken := params.Values['Auth'];
            Edit1.Text := authtoken;
        finally
            params.Free;
        end;
    
        //query := URLEncode('SHOW TABLES');
        query := URLEncode('select * from 1236965');
    
        url := 'http://www.google.com/fusiontables/api/query?sql=' + query;
    
        WinHttpReq.Open('POST', URL, false);
        WinHttpReq.setRequestHeader('Authorization', 'GoogleLogin auth=""' + authToken + '""');
        WinHttpReq.Send();
        s := WinHttpReq.ResponseText;
    
        Memo1.Lines.Text := s;
    
    end;


When I made ""select"", I got the rows.
But when I want to see the tablenames, I get 401 error...

I'm not sure what cause this error.

a.) The free account don't have enough rights to access it privately

b.) I set the header wrong

c.) I set the csSource wrong (I set it ""MyCompanyName-Test-1.0"")

d.) Other thing I don't know what...


Can anybody help me how to login and access the data successfully?

Thanks:
   dd",5
2104046,01/20/2010 18:52:03,143030,07/22/2009 17:14:12,2847,40,Is Delphi a good language to learn?,"About 10 years ago I bought Borland Delphi, as a child I thought it was the coolest thing ever but I never really got into it.  Sometime I see post on SO with a Delphi tag so people must actually still use it.  I am curious how does it compare to something like C#?  Can it basicly accomplish the same results?",delphi,,,,,04/13/2011 09:04:07,not constructive,1,64,7,"Is Delphi a good language to learn? About 10 years ago I bought Borland Delphi, as a child I thought it was the coolest thing ever but I never really got into it.  Sometime I see post on SO with a Delphi tag so people must actually still use it.  I am curious how does it compare to something like C#?  Can it basicly accomplish the same results?",1
814648,05/02/2009 11:03:01,86169,04/02/2009 12:31:01,346,12,"what is your don't do this this way, do it that way tips for delphi ?","when im reading SO users commentes, i read many small usefull tips , so im opening this thread to collect such tips .
for exmaple, in this  [thread ][1]
Oliver Giesen says :

> 	First of all: Don't pass a non-nil Owner to Create if you're going to free the   objects yourself anyway. This just adds lots of unnecessary overhead. – 


  [1]: http://stackoverflow.com/questions/398137/what-is-the-best-way-to-do-nested-try-and-finally-statement-in-delphi/399860#399860

if you have one, please send here ",delphi,coding-tips,tips-and-tricks,,,03/04/2012 05:35:56,not constructive,1,72,16,"what is your don't do this this way, do it that way tips for delphi ? when im reading SO users commentes, i read many small usefull tips , so im opening this thread to collect such tips .
for exmaple, in this  [thread ][1]
Oliver Giesen says :

> 	First of all: Don't pass a non-nil Owner to Create if you're going to free the   objects yourself anyway. This just adds lots of unnecessary overhead. – 


  [1]: http://stackoverflow.com/questions/398137/what-is-the-best-way-to-do-nested-try-and-finally-statement-in-delphi/399860#399860

if you have one, please send here ",3
2446959,03/15/2010 12:18:28,265419,02/03/2010 16:03:02,513,21,Inheritance of TCollectionItem,"I'm planning to have collection of items stored in a TCollection.

Each item will derive from `TBaseItem` which in turn derives from TCollectionItem,

With this in mind the Collection will return `TBaseItem` when an item is requested.

Now each `TBaseItem` will have a `Calculate` function, in the the `TBaseItem` this will just return an internal variable, but in each of the derivations of `TBaseItem` the `Calculate` function requires a different set of parameters. 

The Collection will have a `Calculate All` function which iterates through the collection items and calls each `Calculate` function, obviously it would need to pass the correct parameters to each function

I can  think of three ways of doing this:

1. Create a virtual/abstract method for each calculate function in the base class and override it in the derrived class, This would mean no type casting was required when using the object but it would also mean I have to create lots of virtual methods and have a large if...else statement detecting the type and calling the correct ""calculate"" method, it also means that calling the calculate method is prone to error as you would have to know when writing the code which one to call for which type with the correct parameters to avoid an Error/EAbstractError.

2. Create a record structure with all the possible parameters in and use this as the parameter for the ""calculate"" function. This has the added benefit of passing this to the ""calculate all"" function as it can contain all the parameters required and avoid a potentially very long parameter list.

3. Just type casting the TBaseItem to access the correct calculate method. This would tidy up the TBaseItem quite alot compared to the first method.

What would be the best way to handle this collection?",delphi,inheritance,collections,parameters,,,open,0,288,3,"Inheritance of TCollectionItem I'm planning to have collection of items stored in a TCollection.

Each item will derive from `TBaseItem` which in turn derives from TCollectionItem,

With this in mind the Collection will return `TBaseItem` when an item is requested.

Now each `TBaseItem` will have a `Calculate` function, in the the `TBaseItem` this will just return an internal variable, but in each of the derivations of `TBaseItem` the `Calculate` function requires a different set of parameters. 

The Collection will have a `Calculate All` function which iterates through the collection items and calls each `Calculate` function, obviously it would need to pass the correct parameters to each function

I can  think of three ways of doing this:

1. Create a virtual/abstract method for each calculate function in the base class and override it in the derrived class, This would mean no type casting was required when using the object but it would also mean I have to create lots of virtual methods and have a large if...else statement detecting the type and calling the correct ""calculate"" method, it also means that calling the calculate method is prone to error as you would have to know when writing the code which one to call for which type with the correct parameters to avoid an Error/EAbstractError.

2. Create a record structure with all the possible parameters in and use this as the parameter for the ""calculate"" function. This has the added benefit of passing this to the ""calculate all"" function as it can contain all the parameters required and avoid a potentially very long parameter list.

3. Just type casting the TBaseItem to access the correct calculate method. This would tidy up the TBaseItem quite alot compared to the first method.

What would be the best way to handle this collection?",4
8160411,11/16/2011 23:52:22,1050719,11/16/2011 23:43:35,1,0,Groups are hidden in the ListView,"Well I was experimenting with listview groups, and it turns out the first set of hidden between the columns:

http://screensnapr.com/e/0uqobw.png

But just resize the form set:

http://screensnapr.com/e/YuzSCW.png

I do not understand what happens.

Can you explain?

Greetings!


  [1]: http://i.stack.imgur.com/96zRM.png
  [2]: http://i.stack.imgur.com/TsTDT.png",delphi,delphi-xe,delphi-xe2,,,,open,0,37,6,"Groups are hidden in the ListView Well I was experimenting with listview groups, and it turns out the first set of hidden between the columns:

http://screensnapr.com/e/0uqobw.png

But just resize the form set:

http://screensnapr.com/e/YuzSCW.png

I do not understand what happens.

Can you explain?

Greetings!


  [1]: http://i.stack.imgur.com/96zRM.png
  [2]: http://i.stack.imgur.com/TsTDT.png",3
1024445,06/21/2009 18:13:59,32914,10/30/2008 22:10:38,3338,93,Is there a safe way to clean up stack-based code when jumping out of a block?,"I've been working on [Issue 14][1] on the PascalScript scripting engine, in which using a Goto command to jump out of a Case block produces a compiler error, even though this is perfectly valid (if ugly) Object Pascal code.

Turns out the ProcessCase routine in the compiler calls HasInvalidJumps, which scans for any Gotos that lead outside of the Case block, and gives a compiler error if it finds one.  If I comment that check out, it compiles just fine, but ends up crashing at runtime.  A disassembly of the bytecode shows why.  I've annotated it with the original script code:

    [TYPES]
    <SNIPPED>
    [VARS]
    Var [0]: 27 Class TFORM
    Var [1]: 28 Class TAPPLICATION
    Var [2]: 11 S32 //i: integer
    [PROCS]
    Proc [0] Export: !MAIN -1
    {begin}
     [0] ASSIGN GlobalVar[2], [1]
    { i := 1;}
     [15] PUSHTYPE 11(S32) // 1
     [20] ASSIGN Base[1], GlobalVar[2]
    { case i of}
     [31] PUSHTYPE 25(U8) // 2
    {   0:}
     [36] COMPARE into Base[2]: [0] = Base[1]
     [57] COND_NOT_GOTO currpos + 5 Base[2] [72]
    {   end;}
     [67] GOTO currpos + 41 [113]
    {   1:}
     [72] COMPARE into Base[2]: [1] = Base[1]
     [93] COND_NOT_GOTO currpos + 10 Base[2] [113]
    {     goto L1;}
     [103] GOTO currpos + 8 [116]
    {   end;}
     [108] GOTO currpos + 0 [113]
    { end; //<-- case}
     [113] POP // 1
     [114] POP // 0
    { Exit;}
     [115] RET
    {L1:
     Writeln('Label L1');}
     [116] PUSHTYPE 17(WideString) // 1
     [121] ASSIGN Base[1], ['????????']
     [144] CALL 1
    {end.}
     [149] POP // 0
     [150] RET
    Proc [1]: External Decl: \00\00 WRITELN
    
The ""goto L1;"" statement at 103 skips the cleanup pops at 113 and 114, which leaves the stack in an invalid state.

Delphi doesn't have any trouble with this, because it doesn't use a calculation stack.  PascalScript, though, is not as fortunate. I need some way to make this work, as this pattern is very common in some legacy scripts from a much simpler system with little in the way of control structures that I've translated to PascalScript and need to be able to support.

Anyone have any ideas how to patch the codegen so it'll clean up the stack properly?

  [1]: http://code.remobjects.com/p/pascalscript/issues/14/
",delphi,pascalscript,goto,,,,open,0,517,16,"Is there a safe way to clean up stack-based code when jumping out of a block? I've been working on [Issue 14][1] on the PascalScript scripting engine, in which using a Goto command to jump out of a Case block produces a compiler error, even though this is perfectly valid (if ugly) Object Pascal code.

Turns out the ProcessCase routine in the compiler calls HasInvalidJumps, which scans for any Gotos that lead outside of the Case block, and gives a compiler error if it finds one.  If I comment that check out, it compiles just fine, but ends up crashing at runtime.  A disassembly of the bytecode shows why.  I've annotated it with the original script code:

    [TYPES]
    <SNIPPED>
    [VARS]
    Var [0]: 27 Class TFORM
    Var [1]: 28 Class TAPPLICATION
    Var [2]: 11 S32 //i: integer
    [PROCS]
    Proc [0] Export: !MAIN -1
    {begin}
     [0] ASSIGN GlobalVar[2], [1]
    { i := 1;}
     [15] PUSHTYPE 11(S32) // 1
     [20] ASSIGN Base[1], GlobalVar[2]
    { case i of}
     [31] PUSHTYPE 25(U8) // 2
    {   0:}
     [36] COMPARE into Base[2]: [0] = Base[1]
     [57] COND_NOT_GOTO currpos + 5 Base[2] [72]
    {   end;}
     [67] GOTO currpos + 41 [113]
    {   1:}
     [72] COMPARE into Base[2]: [1] = Base[1]
     [93] COND_NOT_GOTO currpos + 10 Base[2] [113]
    {     goto L1;}
     [103] GOTO currpos + 8 [116]
    {   end;}
     [108] GOTO currpos + 0 [113]
    { end; //<-- case}
     [113] POP // 1
     [114] POP // 0
    { Exit;}
     [115] RET
    {L1:
     Writeln('Label L1');}
     [116] PUSHTYPE 17(WideString) // 1
     [121] ASSIGN Base[1], ['????????']
     [144] CALL 1
    {end.}
     [149] POP // 0
     [150] RET
    Proc [1]: External Decl: \00\00 WRITELN
    
The ""goto L1;"" statement at 103 skips the cleanup pops at 113 and 114, which leaves the stack in an invalid state.

Delphi doesn't have any trouble with this, because it doesn't use a calculation stack.  PascalScript, though, is not as fortunate. I need some way to make this work, as this pattern is very common in some legacy scripts from a much simpler system with little in the way of control structures that I've translated to PascalScript and need to be able to support.

Anyone have any ideas how to patch the codegen so it'll clean up the stack properly?

  [1]: http://code.remobjects.com/p/pascalscript/issues/14/
",3
4066005,11/01/2010 00:55:25,246408,01/08/2010 13:16:51,4495,119,Transcendental math functions in 64-bit Delphi compiler,"Following my [previous question][1] (I assume that 64-bit compiler uses only SSE instructions for floating point calculations):
 
 - How transcendental math functions
   (sin, atan, exp, log, etc.) are
   implemented in 64-bit Delphi compiler?
   AFAIK there are no SSE
   hardware implementations. What
   software library is used, what about the
   **performance and accuracy compared with the
   current FPU hardware implementation**?

[See also][2]


  [1]: http://stackoverflow.com/questions/4064189/floating-point-support-in-64-bit-compiler
  [2]: http://stackoverflow.com/questions/2284860/how-does-c-compute-sin-and-other-math-functions",delphi,math,delphi-xe2,,,11/04/2010 02:25:11,not constructive,1,80,7,"Transcendental math functions in 64-bit Delphi compiler Following my [previous question][1] (I assume that 64-bit compiler uses only SSE instructions for floating point calculations):
 
 - How transcendental math functions
   (sin, atan, exp, log, etc.) are
   implemented in 64-bit Delphi compiler?
   AFAIK there are no SSE
   hardware implementations. What
   software library is used, what about the
   **performance and accuracy compared with the
   current FPU hardware implementation**?

[See also][2]


  [1]: http://stackoverflow.com/questions/4064189/floating-point-support-in-64-bit-compiler
  [2]: http://stackoverflow.com/questions/2284860/how-does-c-compute-sin-and-other-math-functions",3
4351458,12/04/2010 01:42:20,62488,02/04/2009 16:05:01,3233,131,Setting ProgID in IDE,"I am creating a COM server using C++ Builder XE.  Its ProgID is always 'PROGRAMNAME.CLASSNAME'.

How do I change the ProgID?  I want to use 'COMPANYNAME.PROGRAMNAME.FUNCTIONALITY'.

A Delphi answer would probably suffice.",delphi,com,c++builder,,,,open,0,32,4,"Setting ProgID in IDE I am creating a COM server using C++ Builder XE.  Its ProgID is always 'PROGRAMNAME.CLASSNAME'.

How do I change the ProgID?  I want to use 'COMPANYNAME.PROGRAMNAME.FUNCTIONALITY'.

A Delphi answer would probably suffice.",3
2508216,03/24/2010 14:02:19,102128,05/06/2009 10:00:45,57,1,How to avoid GUI freeze when calling Beginthread API?,"Below just a simple race between 2 button in 2 threads,

and this will freeze other components on the form.

<pre><code>
procedure moveButton1();
var
  I: Integer;
begin
  for I := 0 to 6000 do
    Form1.Button1.Left := Form1.Button1.Left - 1;
  Form1.Caption := 'Button1 won!';
  EndThread(0);
end;

procedure moveButton2();
var
  I: Integer;
begin
  for I := 0 to 6000 do
    Form1.Button2.Left := Form1.Button2.Left - 1;
  Form1.Caption := 'Button2 won!';
  EndThread(0);
end;

procedure TForm1.Button3Click(Sender: TObject);
var
  thread1, thread2,tick : Integer;
  id1, id2 : LongWord;
begin
  thread1 := BeginThread(nil,
                         0,
                         Addr(moveButton1),
                         nil,
                         0,
                         id1);

  thread2 := BeginThread(nil,
                         0,
                         Addr(moveButton2),
                         nil,
                         0,
                         id2);
  CloseHandle(thread1);
  CloseHandle(thread2);
end;</pre></code>

",delphi,,,,,,open,0,347,9,"How to avoid GUI freeze when calling Beginthread API? Below just a simple race between 2 button in 2 threads,

and this will freeze other components on the form.

<pre><code>
procedure moveButton1();
var
  I: Integer;
begin
  for I := 0 to 6000 do
    Form1.Button1.Left := Form1.Button1.Left - 1;
  Form1.Caption := 'Button1 won!';
  EndThread(0);
end;

procedure moveButton2();
var
  I: Integer;
begin
  for I := 0 to 6000 do
    Form1.Button2.Left := Form1.Button2.Left - 1;
  Form1.Caption := 'Button2 won!';
  EndThread(0);
end;

procedure TForm1.Button3Click(Sender: TObject);
var
  thread1, thread2,tick : Integer;
  id1, id2 : LongWord;
begin
  thread1 := BeginThread(nil,
                         0,
                         Addr(moveButton1),
                         nil,
                         0,
                         id1);

  thread2 := BeginThread(nil,
                         0,
                         Addr(moveButton2),
                         nil,
                         0,
                         id2);
  CloseHandle(thread1);
  CloseHandle(thread2);
end;</pre></code>

",1
10522131,05/09/2012 18:39:46,38813,11/19/2008 04:12:02,8820,270,"Why can't i run 'hello '.trim().copy(1,1)","First, i know that the syntax in the title is invalid.

I'm just wondering whether it would make sense to add a new language feature lets us call functions via a different syntax?

Let me explain...
With current pascals, when you have a method in a class, a hidden parameter with a reference to an instance of the class is added.
So when you have tmyclass.mymethod(x:integer), and you call myclass.mymethod(6), the compiler converts it into something like mymethod(myclass,6);

What i'm wondering is: why are we not allowed to do it the other way around?

If i create a procedure <code>mymethod(m:tmyclass;x:integer)</code>, i want to call it like <code> myclass.mymethod(345);</code>

Or if i call trim on a string s like s.trim(), i want trim(s) to be called.

If it would not only work on records and class you would even be able to rewrite unintuitive code like this:

    SameText( copy( inttostr(round(10/3)),1,1),'4')

Into this: 

    (10/3).round.IntToStr.copy(1,1).SameText('4')

The second like represents my flow of thought much better than the first: from left to right instead of from the inner brackets outwards.

Another example

    Label1.caption := Filelistbox1.filename.extractfilext.length.max(2).inttostr

Looks more readable than:

    Label1.caption := inttostr(max(length(extractfileext(filelistbox1.filename)),2));

I can imagine that this could create ambiguity in existing code, but besides that, are there any reasons why this could never work? What objections could there be?
",delphi,syntax,pascal,,,05/09/2012 21:20:56,not constructive,1,216,6,"Why can't i run 'hello '.trim().copy(1,1) First, i know that the syntax in the title is invalid.

I'm just wondering whether it would make sense to add a new language feature lets us call functions via a different syntax?

Let me explain...
With current pascals, when you have a method in a class, a hidden parameter with a reference to an instance of the class is added.
So when you have tmyclass.mymethod(x:integer), and you call myclass.mymethod(6), the compiler converts it into something like mymethod(myclass,6);

What i'm wondering is: why are we not allowed to do it the other way around?

If i create a procedure <code>mymethod(m:tmyclass;x:integer)</code>, i want to call it like <code> myclass.mymethod(345);</code>

Or if i call trim on a string s like s.trim(), i want trim(s) to be called.

If it would not only work on records and class you would even be able to rewrite unintuitive code like this:

    SameText( copy( inttostr(round(10/3)),1,1),'4')

Into this: 

    (10/3).round.IntToStr.copy(1,1).SameText('4')

The second like represents my flow of thought much better than the first: from left to right instead of from the inner brackets outwards.

Another example

    Label1.caption := Filelistbox1.filename.extractfilext.length.max(2).inttostr

Looks more readable than:

    Label1.caption := inttostr(max(length(extractfileext(filelistbox1.filename)),2));

I can imagine that this could create ambiguity in existing code, but besides that, are there any reasons why this could never work? What objections could there be?
",3
3379660,07/31/2010 20:17:29,396619,07/20/2010 09:25:51,1,0,How to change a generic type value?,"In my application, I've created the TList type list, intended to store Integers and Doubles:

    TKList<T> = class
      private
    	FItems: TList<T>;
    	function GetItem(Index: Integer): T;
    	procedure SetItem(Index: Integer; const Value: T);
    	function GetMaxValue(): T;
    	function GetMinValue(): T;
      public
    	constructor Create; overload;
    	constructor Create(const AKList: TKList<T>); overload;
    	destructor Destroy; override;
    	procedure Assign(const AKList: TKList<T>);
    	function Add(const AValue: T): Integer;
    	procedure Clear;
    	function Count: Integer;
    	procedure Invert;
    	function ToString: string; override;
    	function Info: string;
    	property Values[Index: Integer]: T read GetItem write SetItem; default;
      end;

How can I implement Invert() procedure to invert values in generic List?

Thanks in advance.",delphi,generics,delphi-2010,,,,open,0,161,7,"How to change a generic type value? In my application, I've created the TList type list, intended to store Integers and Doubles:

    TKList<T> = class
      private
    	FItems: TList<T>;
    	function GetItem(Index: Integer): T;
    	procedure SetItem(Index: Integer; const Value: T);
    	function GetMaxValue(): T;
    	function GetMinValue(): T;
      public
    	constructor Create; overload;
    	constructor Create(const AKList: TKList<T>); overload;
    	destructor Destroy; override;
    	procedure Assign(const AKList: TKList<T>);
    	function Add(const AValue: T): Integer;
    	procedure Clear;
    	function Count: Integer;
    	procedure Invert;
    	function ToString: string; override;
    	function Info: string;
    	property Values[Index: Integer]: T read GetItem write SetItem; default;
      end;

How can I implement Invert() procedure to invert values in generic List?

Thanks in advance.",3
6264363,06/07/2011 11:14:13,46207,12/14/2008 23:38:56,1882,84,Cannot download patch from Embarcadero web site,"I have a possible Delphi bug (oh, damn it, I used again the word 'bug') and I think this QC might help me: 
[ID: 28269, IDE hangs when following ""uses"" links][1]

  [1]: http://cc.embarcadero.com/Item/28269
When I want to download it it says that: 

> To download this, you must have
> registered: Your existing free
> membership

And I have one (I am a Delphi Pro edition customer). I can download all other updates and patches except this one. But I don't think its a problem with my menbership because the download size is:

> Download 	 	0 bytes 

and then in the right column:  

> Size: 0 bytes   
> Updated on Mon, 21 Mar  
> 2011 08:34:52 GMT Originally uploaded  
> on Mon, 21 Mar 2011 08:34:52 GMT  

Can anybody try to see if the link its not working indeed, or it is just me?",delphi,delphi-xe,,,,06/07/2011 13:18:30,too localized,1,147,7,"Cannot download patch from Embarcadero web site I have a possible Delphi bug (oh, damn it, I used again the word 'bug') and I think this QC might help me: 
[ID: 28269, IDE hangs when following ""uses"" links][1]

  [1]: http://cc.embarcadero.com/Item/28269
When I want to download it it says that: 

> To download this, you must have
> registered: Your existing free
> membership

And I have one (I am a Delphi Pro edition customer). I can download all other updates and patches except this one. But I don't think its a problem with my menbership because the download size is:

> Download 	 	0 bytes 

and then in the right column:  

> Size: 0 bytes   
> Updated on Mon, 21 Mar  
> 2011 08:34:52 GMT Originally uploaded  
> on Mon, 21 Mar 2011 08:34:52 GMT  

Can anybody try to see if the link its not working indeed, or it is just me?",2
7275136,09/01/2011 19:01:05,781162,06/02/2011 13:11:30,96,3,"What is Reset(handle,1)?","I came across this code of Reset(elfhandle,1) and I don't know what the second input of 1 does. What does the second input of Reset specify?",delphi,,,,,,open,0,26,3,"What is Reset(handle,1)? I came across this code of Reset(elfhandle,1) and I don't know what the second input of 1 does. What does the second input of Reset specify?",1
3022378,06/11/2010 11:41:23,193655,10/21/2009 08:29:52,133,4,Raudus vs ExtPascal ,"Delphi developers has several tools (several alternatives to ASP.NET) for building web applications.

While No.1 framework is Intraweb, there is a lot of interest around ExtJS, that has 2 incarnations:
1) the opensource ExtPascal
2) the closedsource Raudus

Now the products are different, Raudus never supports the latest ExtJS version (while ExtPascal does because as far as I read it ""almost automatically updates itself to the latest ExJS version""), Raudus ""seems"" much RAD (much similar to Intraweb from the RAD point of view).

Anyway why chose one or the other?

Why Raudus since it is free cannot become Open Source?",delphi,extjs,,,,07/31/2012 11:50:59,not constructive,1,94,4,"Raudus vs ExtPascal  Delphi developers has several tools (several alternatives to ASP.NET) for building web applications.

While No.1 framework is Intraweb, there is a lot of interest around ExtJS, that has 2 incarnations:
1) the opensource ExtPascal
2) the closedsource Raudus

Now the products are different, Raudus never supports the latest ExtJS version (while ExtPascal does because as far as I read it ""almost automatically updates itself to the latest ExJS version""), Raudus ""seems"" much RAD (much similar to Intraweb from the RAD point of view).

Anyway why chose one or the other?

Why Raudus since it is free cannot become Open Source?",2
1780155,11/22/2009 22:03:30,114953,05/30/2009 23:43:16,1,1,Pass a multidimensional array as a parameter in Delphi,"I'd like to pass a multi-dimensional array to a constructor like so:

    constructor TMyClass.Create(MyParameter: array of array of Integer);
    begin
      LocalField := MyParameter;
    end;

Where LocalField is an array of array of Integer.

However the above code won't compile ('Identifier expected but ARRAY found'). Could somebody explain to me why this is wrong? I tried reading up on open, static and dynamic arrays but have yet to find something that works. Is there a way to fix it without changing the type of LocalField?",delphi,multidimensional,arrays,parameters,,,open,0,96,9,"Pass a multidimensional array as a parameter in Delphi I'd like to pass a multi-dimensional array to a constructor like so:

    constructor TMyClass.Create(MyParameter: array of array of Integer);
    begin
      LocalField := MyParameter;
    end;

Where LocalField is an array of array of Integer.

However the above code won't compile ('Identifier expected but ARRAY found'). Could somebody explain to me why this is wrong? I tried reading up on open, static and dynamic arrays but have yet to find something that works. Is there a way to fix it without changing the type of LocalField?",4
2602239,04/08/2010 17:49:31,298004,03/20/2010 13:32:54,3,3,How to make TWebBrower ignore accelerator chars of others controls?,"I have a TWebBrowser placed on a form with the designMode enabled.   
Bellow the browser I have a close button with the Caption setted to 'Clos&e'.   
When I am editing the contents of a document inside the WebBrowser and I press the key E the button close is called.  
It appears that it is treating TWebBrowser like other controls that don't handle keys (e.g. TButton).  

How can I solve this? 

Thanks in advance.",delphi,twebbrowser,webbrowser,mshtml,,,open,0,79,10,"How to make TWebBrower ignore accelerator chars of others controls? I have a TWebBrowser placed on a form with the designMode enabled.   
Bellow the browser I have a close button with the Caption setted to 'Clos&e'.   
When I am editing the contents of a document inside the WebBrowser and I press the key E the button close is called.  
It appears that it is treating TWebBrowser like other controls that don't handle keys (e.g. TButton).  

How can I solve this? 

Thanks in advance.",4
5724598,04/20/2011 01:27:48,716252,04/20/2011 01:19:33,1,0,Delphi 7 screensaver,"Hi everybody i want making  a simple screen saver for launching application...
exemple the screensaver launch notepad.exe after 2 minutes or other exe application is possible? thank you for your help

jmmprog",delphi,,,,,04/20/2011 07:14:15,not a real question,1,31,3,"Delphi 7 screensaver Hi everybody i want making  a simple screen saver for launching application...
exemple the screensaver launch notepad.exe after 2 minutes or other exe application is possible? thank you for your help

jmmprog",1
386977,12/22/2008 18:35:14,727,08/08/2008 12:16:17,709,35,Do I have to use Disable/EnableControls when using Locate in a TClientDataSet?,Or does it handle it by default?,delphi,,,,,,open,0,7,12,Do I have to use Disable/EnableControls when using Locate in a TClientDataSet? Or does it handle it by default?,1
6929189,08/03/2011 15:39:10,426242,08/20/2010 10:42:39,2083,58,How to get the version number of the Advantage Database Server?,"I can easily find out which client version I'm using, but how can I find out the server version?

There is a `AdsMgGetInstallInfo` ace function and a corresponding stored procedure `sp_mgGetInstallInfo`.

Do these require some special privileges?

I was expecting to find an `TAdsConnection.ServerVersion` property, but something like that doesn't seem to exist?",delphi,advantage-database-server,,,,,open,0,50,11,"How to get the version number of the Advantage Database Server? I can easily find out which client version I'm using, but how can I find out the server version?

There is a `AdsMgGetInstallInfo` ace function and a corresponding stored procedure `sp_mgGetInstallInfo`.

Do these require some special privileges?

I was expecting to find an `TAdsConnection.ServerVersion` property, but something like that doesn't seem to exist?",2
2547059,03/30/2010 16:59:21,282848,02/27/2010 21:42:36,188,11,Delphi Performance: Case Versus If,"I guess there might be some overlapping with previous SO questions, but I could not find a Delphi-specific question on this topic.

Suppose that you want to check if an unsigned 32-bit integer variable ""MyAction"" is equal to any of the constants ACTION1, ACTION2, ... ACTIONn, where n is - say 1000. I guess that, besides being more elegant,

    case MyAction of
      ACTION1: {code};
      ACTION2: {code};
      ...
      ACTIONn: {code};
    end;

is much faster than

    if MyAction = ACTION1 then
      // code
    else if MyAction = ACTION2 then
      // code
    ...
    else if MyAction = ACTIONn then
      // code;

I guess that the if variant takes time O(n) to complete (i.e. to find the right action) if the right action ACTIONi has a high value of i, whereas the case variant takes a lot less time (O(1)?).

 1. Am I correct that switch is much faster?
 2. Am I correct that the time required to find the right action in the switch case actually is independent of n? I.e. is it true that it does not really take any longer to check a million cases than to check 10 cases?
 3. How, exactly, does this work?",delphi,case,if-statement,performance,,,open,0,245,5,"Delphi Performance: Case Versus If I guess there might be some overlapping with previous SO questions, but I could not find a Delphi-specific question on this topic.

Suppose that you want to check if an unsigned 32-bit integer variable ""MyAction"" is equal to any of the constants ACTION1, ACTION2, ... ACTIONn, where n is - say 1000. I guess that, besides being more elegant,

    case MyAction of
      ACTION1: {code};
      ACTION2: {code};
      ...
      ACTIONn: {code};
    end;

is much faster than

    if MyAction = ACTION1 then
      // code
    else if MyAction = ACTION2 then
      // code
    ...
    else if MyAction = ACTIONn then
      // code;

I guess that the if variant takes time O(n) to complete (i.e. to find the right action) if the right action ACTIONi has a high value of i, whereas the case variant takes a lot less time (O(1)?).

 1. Am I correct that switch is much faster?
 2. Am I correct that the time required to find the right action in the switch case actually is independent of n? I.e. is it true that it does not really take any longer to check a million cases than to check 10 cases?
 3. How, exactly, does this work?",4
8588610,12/21/2011 10:48:05,706147,04/13/2011 13:36:51,1,1,Simple circular buffer wrap-around - pascal delphi,"I have written a little circular buffer for integers.  My requirements were to add an integer on at a time and to read from the circular buffer as though it were an array wrapping around automatically.

In use I add integers 1 at a time, until full, then do a calculation on all the values in the buffer, delete 5 values and repeat continuously.

With a small buffer size, I have tested on 17 and 29, and walking through slowly, everything seems to work ok.  With a larger buffer size, typically 501, I seem to be getting wrap-around issues, but I can't see where they are.

Please can you look at the code to see if you can see the issue?

Also, if there are any speed optimisations, they would be appreciated, too.

Thank you for your help,

Mike

        

unit CircularBufferIntU;

interface

uses
  SysUtils, Windows;

    type
      TIntegerCircularBuffer = class(TObject)
     private
       FBuffer: PIntegerArray;
       FFullSize: integer;
       FWritePos: integer;
       FReadPos: integer;
       FSampleCount: integer;
       function GetIntAtIndex(AIndex: word): integer;
       function GetReadAvail: integer;
       function GetWriteAvail: integer;
     public
      
    constructor Create(ASize: Integer); virtual;
    destructor Destroy; override;

    function AddSample(const AValue: integer): boolean;
    procedure Delete(ACount: integer);
    procedure SetFillPoint(AFillPoint: integer);

    property FullSize: integer read FFullSize;
    property ReadAvail: integer read GetReadAvail;
    property WriteAvail: integer read GetWriteAvail;
    property SampleCount: integer read FSampleCount;
    property Samples[Index: word]: integer read GetIntAtIndex; default;
      end;

implementation

uses
  Math;
  
    constructor TIntegerCircularBuffer.Create(ASize: Integer);
    begin
      inherited Create;

      FFullSize := ASize;
      FSampleCount := 0;
      FReadPos := 0;
      FWritePos := 0;
      FBuffer := AllocMem(ASize * sizeof(integer));
    end;

    destructor TIntegerCircularBuffer.Destroy;
    begin
      FreeMem(FBuffer);

      inherited Destroy;
    end;

    function TIntegerCircularBuffer.AddSample(const AValue: integer): boolean;
    begin
      result := true;
      if (GetWriteAvail < 1) then begin
        result := false;
        Exit;
      end;

      FBuffer^[FWritePos] := AValue;

      if (FWritePos = FFullSize -1) then FWritePos := 0 else inc(FWritePos);

      inc(FSampleCount);
    end;



    procedure TIntegerCircularBuffer.Delete(ACount: integer);
    begin
      if (ACount <= 0 ) then begin
        Exit;
      end;

      if (ACount >= FSampleCount) then begin
        FSampleCount := 0;
        FReadPos := FWritePos;
        Exit;
      end;

      inc(FReadPos, ACount);
      FReadPos := FReadPos mod FFullSize;

      dec(FSampleCount, ACount);
    end;

    function TIntegerCircularBuffer.GetIntAtIndex(AIndex: word): integer;
    var
      ii: integer;
    begin
      ii := FReadPos + AIndex;
      if (ii > FFullSize -1) then
        ii := ii - FFullSize;
    
      result := FBuffer^[ii];
    end;

    function TIntegerCircularBuffer.GetReadAvail: integer;
    begin
      result := FSampleCount;
    end;

    function TIntegerCircularBuffer.GetWriteAvail: integer;
    begin
      result := FFullSize - FSampleCount;
    end;

    procedure TIntegerCircularBuffer.SetFillPoint(AFillPoint: integer);
    begin
      FReadPos := 0;
      FWritePos := AFillPoint;
    
      FillChar(FBuffer^[0], SizeOf(Integer)* FFullSize, 0);
    end;

    end.






",delphi,buffer,pascal,circular,,12/22/2011 07:55:40,too localized,1,779,7,"Simple circular buffer wrap-around - pascal delphi I have written a little circular buffer for integers.  My requirements were to add an integer on at a time and to read from the circular buffer as though it were an array wrapping around automatically.

In use I add integers 1 at a time, until full, then do a calculation on all the values in the buffer, delete 5 values and repeat continuously.

With a small buffer size, I have tested on 17 and 29, and walking through slowly, everything seems to work ok.  With a larger buffer size, typically 501, I seem to be getting wrap-around issues, but I can't see where they are.

Please can you look at the code to see if you can see the issue?

Also, if there are any speed optimisations, they would be appreciated, too.

Thank you for your help,

Mike

        

unit CircularBufferIntU;

interface

uses
  SysUtils, Windows;

    type
      TIntegerCircularBuffer = class(TObject)
     private
       FBuffer: PIntegerArray;
       FFullSize: integer;
       FWritePos: integer;
       FReadPos: integer;
       FSampleCount: integer;
       function GetIntAtIndex(AIndex: word): integer;
       function GetReadAvail: integer;
       function GetWriteAvail: integer;
     public
      
    constructor Create(ASize: Integer); virtual;
    destructor Destroy; override;

    function AddSample(const AValue: integer): boolean;
    procedure Delete(ACount: integer);
    procedure SetFillPoint(AFillPoint: integer);

    property FullSize: integer read FFullSize;
    property ReadAvail: integer read GetReadAvail;
    property WriteAvail: integer read GetWriteAvail;
    property SampleCount: integer read FSampleCount;
    property Samples[Index: word]: integer read GetIntAtIndex; default;
      end;

implementation

uses
  Math;
  
    constructor TIntegerCircularBuffer.Create(ASize: Integer);
    begin
      inherited Create;

      FFullSize := ASize;
      FSampleCount := 0;
      FReadPos := 0;
      FWritePos := 0;
      FBuffer := AllocMem(ASize * sizeof(integer));
    end;

    destructor TIntegerCircularBuffer.Destroy;
    begin
      FreeMem(FBuffer);

      inherited Destroy;
    end;

    function TIntegerCircularBuffer.AddSample(const AValue: integer): boolean;
    begin
      result := true;
      if (GetWriteAvail < 1) then begin
        result := false;
        Exit;
      end;

      FBuffer^[FWritePos] := AValue;

      if (FWritePos = FFullSize -1) then FWritePos := 0 else inc(FWritePos);

      inc(FSampleCount);
    end;



    procedure TIntegerCircularBuffer.Delete(ACount: integer);
    begin
      if (ACount <= 0 ) then begin
        Exit;
      end;

      if (ACount >= FSampleCount) then begin
        FSampleCount := 0;
        FReadPos := FWritePos;
        Exit;
      end;

      inc(FReadPos, ACount);
      FReadPos := FReadPos mod FFullSize;

      dec(FSampleCount, ACount);
    end;

    function TIntegerCircularBuffer.GetIntAtIndex(AIndex: word): integer;
    var
      ii: integer;
    begin
      ii := FReadPos + AIndex;
      if (ii > FFullSize -1) then
        ii := ii - FFullSize;
    
      result := FBuffer^[ii];
    end;

    function TIntegerCircularBuffer.GetReadAvail: integer;
    begin
      result := FSampleCount;
    end;

    function TIntegerCircularBuffer.GetWriteAvail: integer;
    begin
      result := FFullSize - FSampleCount;
    end;

    procedure TIntegerCircularBuffer.SetFillPoint(AFillPoint: integer);
    begin
      FReadPos := 0;
      FWritePos := AFillPoint;
    
      FillChar(FBuffer^[0], SizeOf(Integer)* FFullSize, 0);
    end;

    end.






",4
4342115,12/03/2010 03:10:54,665392,02/27/2010 09:27:37,29,22,Delphi Mouse wheel event in component,"I'm wanting to write a component that uses the mouse wheel to zoom
something similar to Google earth.

has any one seen any code please  ",delphi,,,,,,open,0,25,6,"Delphi Mouse wheel event in component I'm wanting to write a component that uses the mouse wheel to zoom
something similar to Google earth.

has any one seen any code please  ",1
2375109,03/03/2010 21:27:45,191001,10/16/2009 04:51:11,548,23,How to prevent action in parent form executing when child form is visible in Delphi,"I have a main form, and a floating child form that is non-modal.  The main form has a TAction called DeleteAction that has Delete as it's shortcut.  When the floating form is visible and Delete is pressed, the main form's DeleteAction is executed.

How do I prevent the shortcut passing through the child form to the parent?  I could verify that the child form does not have the focus in the Delete action's OnExecute handler or in the OnUpdate handler of the actions's ActionManager, but I have lots of other actions and would have to duplicate this solution for them too.  I also have other floating forms that can be visible.
 
This is using Delphi 2010.",delphi,,,,,,open,0,119,15,"How to prevent action in parent form executing when child form is visible in Delphi I have a main form, and a floating child form that is non-modal.  The main form has a TAction called DeleteAction that has Delete as it's shortcut.  When the floating form is visible and Delete is pressed, the main form's DeleteAction is executed.

How do I prevent the shortcut passing through the child form to the parent?  I could verify that the child form does not have the focus in the Delete action's OnExecute handler or in the OnUpdate handler of the actions's ActionManager, but I have lots of other actions and would have to duplicate this solution for them too.  I also have other floating forms that can be visible.
 
This is using Delphi 2010.",1
1781570,11/23/2009 07:23:01,194328,10/22/2009 05:28:20,401,10,Is Delphi dead?,"I know it is not entirely a programming question, but I posted it here because programmers of Delphi use this forum.

Why Borland kicked off Delphi? The father of now famous Visual Studio, where it got buried? Is it still widely used and how easily available is the community support?",delphi,delphi-2009,,,,11/23/2009 09:21:00,off topic,1,49,3,"Is Delphi dead? I know it is not entirely a programming question, but I posted it here because programmers of Delphi use this forum.

Why Borland kicked off Delphi? The father of now famous Visual Studio, where it got buried? Is it still widely used and how easily available is the community support?",2
1021498,06/20/2009 12:07:04,101900,05/05/2009 22:58:42,16,1,what's better opition?,"procedure MyProc(Eval: Boolean);  
begin       
    if not Eval then  
        Exit;  
    /* do stuff */  
    /* do more stuff */
end;

OR

procedure MyProc(Eval: Boolean);  
begin  
   if Eval then  
      begin  
         /* do stuff */  
         /* do more stuff */  
      end;
	
  /* no Exit needed, but now we got what I think unpleasing code:
  having a indentation level and a begin-end statement */
end;",delphi,,,,,12/23/2011 07:44:49,not constructive,1,128,3,"what's better opition? procedure MyProc(Eval: Boolean);  
begin       
    if not Eval then  
        Exit;  
    /* do stuff */  
    /* do more stuff */
end;

OR

procedure MyProc(Eval: Boolean);  
begin  
   if Eval then  
      begin  
         /* do stuff */  
         /* do more stuff */  
      end;
	
  /* no Exit needed, but now we got what I think unpleasing code:
  having a indentation level and a begin-end statement */
end;",1
1513428,10/03/2009 10:30:36,23368,09/29/2008 07:10:57,6529,167,Why is my TStringList not sorted?,"I have a custom sorted `TStringList`...

    Items.CustomSort(@CompareWords);

... with this comparison function:

    function CompareWords(List: TStringList; Index1, Index2: Integer): Integer;
    begin
      Result := StrIComp(PWideChar(List[Index1]), PWideChar(List[Index2]));
    end;

But after noticing some problems with my code, which expects the list to be sorted in the order `StrIComp` induces, I created this small check...

    for i := 1 to FItems.Count - 1 do
    begin
      Assert(StrIComp(PWideChar(Items[i-1]), PWideChar(Items[i])) <= 0);
    end;

... and it fails.

**Why isn't the list sorted properly?**

",delphi,sorting,,,,,open,0,102,6,"Why is my TStringList not sorted? I have a custom sorted `TStringList`...

    Items.CustomSort(@CompareWords);

... with this comparison function:

    function CompareWords(List: TStringList; Index1, Index2: Integer): Integer;
    begin
      Result := StrIComp(PWideChar(List[Index1]), PWideChar(List[Index2]));
    end;

But after noticing some problems with my code, which expects the list to be sorted in the order `StrIComp` induces, I created this small check...

    for i := 1 to FItems.Count - 1 do
    begin
      Assert(StrIComp(PWideChar(Items[i-1]), PWideChar(Items[i])) <= 0);
    end;

... and it fails.

**Why isn't the list sorted properly?**

",2
2766072,05/04/2010 14:19:30,332443,05/04/2010 14:14:12,1,0,Delphi Popup Menu Click,"Hello im useing delphi, i have my popup menu ready and in a submenu i want to click but i dont want the popup menu disapear, i want to click and make it stay..sorry for my english =)",delphi,,,,,,open,0,38,4,"Delphi Popup Menu Click Hello im useing delphi, i have my popup menu ready and in a submenu i want to click but i dont want the popup menu disapear, i want to click and make it stay..sorry for my english =)",1
1395742,09/08/2009 19:01:46,46207,12/14/2008 23:38:56,106,6,Array of (pointers to a record),"I want to create a bunch of records (RWell) and to store them in an array in a certain order. Then I want to create a new array (different layout) and rearange the records in it.
Of course, I don't want to duplicate data in RAM so I though that in the second array I should put pointers to the records in the first array. However, I can't do that. Anybody can tell what's wrong with the code below?
Thanks 

 


    Type 
      RWell= record                                 
        x: string;  
        i: integer;
      end;
    
      PWell= ^RWell;
    
      RWellArray= Array[0..12, 0..8] of RWell;    


    procedure TClass1.CreateWells
    var 
      WellMX: RWellArray;
    begin 
      { should I initialize the WellXM here? }
      { note: WellXM is a static array! }

      other stuff
    end;



    var Wells: array of PWell;
    procedure TClass2.AddWell(aWell: RWell);
    begin
     SetLength(Wells, Length(Wells)+ 1);  { reserve memory } 
     Wells[High(Wells)]:= @aWell;
    end;



    procedure TClass3.DisplayWell;
    var CurWell: RWell;
    begin
     CurWell:= CurPrimer.Wells[iCurWell]^;       <--- AV here (but in debugger the address is correct)
    end;



",delphi,,,,,,open,0,321,6,"Array of (pointers to a record) I want to create a bunch of records (RWell) and to store them in an array in a certain order. Then I want to create a new array (different layout) and rearange the records in it.
Of course, I don't want to duplicate data in RAM so I though that in the second array I should put pointers to the records in the first array. However, I can't do that. Anybody can tell what's wrong with the code below?
Thanks 

 


    Type 
      RWell= record                                 
        x: string;  
        i: integer;
      end;
    
      PWell= ^RWell;
    
      RWellArray= Array[0..12, 0..8] of RWell;    


    procedure TClass1.CreateWells
    var 
      WellMX: RWellArray;
    begin 
      { should I initialize the WellXM here? }
      { note: WellXM is a static array! }

      other stuff
    end;



    var Wells: array of PWell;
    procedure TClass2.AddWell(aWell: RWell);
    begin
     SetLength(Wells, Length(Wells)+ 1);  { reserve memory } 
     Wells[High(Wells)]:= @aWell;
    end;



    procedure TClass3.DisplayWell;
    var CurWell: RWell;
    begin
     CurWell:= CurPrimer.Wells[iCurWell]^;       <--- AV here (but in debugger the address is correct)
    end;



",1
5960721,05/11/2011 07:30:19,318249,04/16/2010 06:52:58,591,24,Delphi Embedded Chrome,"is somebody experience on using delphi embedded chrome? [delphichromiumembedded][1].
how to make get accessed to its HTML DOCUMENTS? like assign a value to Editbox


  [1]: http://code.google.com/p/delphichromiumembedded/",delphi,google-chrome,embedded,,,,open,0,26,3,"Delphi Embedded Chrome is somebody experience on using delphi embedded chrome? [delphichromiumembedded][1].
how to make get accessed to its HTML DOCUMENTS? like assign a value to Editbox


  [1]: http://code.google.com/p/delphichromiumembedded/",3
5335933,03/17/2011 07:09:06,663825,03/17/2011 06:57:02,1,0,"Delphi Runtime error 216 thrown in SysUtils.FinaliseUnits, line number not in mapfile","I have a random Runtime Error 216 that appears on application close.  

I have debugged as far as I can and the error is thrown in **SysUtils.FinalizeUnits**.

I have gone over the code and ensure all created objects are freed.

The number on the runtime error, 0040054A, is **not present in the mapfile**.  Do you know what this means?

Can anyone tell me how to find out what is throwing the error?



",delphi,delphi-xe,,,,,open,0,71,12,"Delphi Runtime error 216 thrown in SysUtils.FinaliseUnits, line number not in mapfile I have a random Runtime Error 216 that appears on application close.  

I have debugged as far as I can and the error is thrown in **SysUtils.FinalizeUnits**.

I have gone over the code and ensure all created objects are freed.

The number on the runtime error, 0040054A, is **not present in the mapfile**.  Do you know what this means?

Can anyone tell me how to find out what is throwing the error?



",2
4083747,11/03/2010 02:18:13,466371,10/05/2010 02:01:01,103,0,Does Delphi compiler perform optimization?,"I am using Delphi 7 IDE. Does Delphi compiler optimize codes, just like what the C++ compiler is doing in this following link?

http://msdn.microsoft.com/en-us/library/aa366877(VS.85).aspx

    WCHAR szPassword[MAX_PATH];
    // Retrieve the password
    if (GetPasswordFromUser(szPassword, MAX_PATH))    
       UsePassword(szPassword);
    // Clear the password from memory
    SecureZeroMemory(szPassword, sizeof(szPassword));

If `ZeroMemory` were called in this example instead of `SecureZeroMemory`, the compiler could optimize the call because the `szPassword` buffer is not read from before it goes out of scope. The password would remain on the application stack where it could be captured in a crash dump or probed by a malicious application.



",delphi,optimization,compiler,compiler-optimization,,,open,0,118,5,"Does Delphi compiler perform optimization? I am using Delphi 7 IDE. Does Delphi compiler optimize codes, just like what the C++ compiler is doing in this following link?

http://msdn.microsoft.com/en-us/library/aa366877(VS.85).aspx

    WCHAR szPassword[MAX_PATH];
    // Retrieve the password
    if (GetPasswordFromUser(szPassword, MAX_PATH))    
       UsePassword(szPassword);
    // Clear the password from memory
    SecureZeroMemory(szPassword, sizeof(szPassword));

If `ZeroMemory` were called in this example instead of `SecureZeroMemory`, the compiler could optimize the call because the `szPassword` buffer is not read from before it goes out of scope. The password would remain on the application stack where it could be captured in a crash dump or probed by a malicious application.



",4
7542916,09/25/2011 00:51:03,160386,08/20/2009 21:39:46,194,6,Assembly to high-level language conversion,"Is there any way to convert assembly language to some high-level language?
I am trying to make linux port of application for retrieving school marks. Application downloads file from server and then decrypts it somehow. It is written in delphi but after decompilation i got an assembly language. Assembly language is totally unknown to me.
Here is the procedure that i think it is responsible for decription: https://gist.github.com/1240056
If there is any other way how to find out used algorithm i would be very thankful to you.",delphi,assembly,reverse-engineering,,,09/26/2011 06:58:03,not a real question,1,84,5,"Assembly to high-level language conversion Is there any way to convert assembly language to some high-level language?
I am trying to make linux port of application for retrieving school marks. Application downloads file from server and then decrypts it somehow. It is written in delphi but after decompilation i got an assembly language. Assembly language is totally unknown to me.
Here is the procedure that i think it is responsible for decription: https://gist.github.com/1240056
If there is any other way how to find out used algorithm i would be very thankful to you.",3
3074771,06/19/2010 07:39:54,370907,06/19/2010 07:39:54,1,0,fast finding of small image in a bigger image,"I need to get the coordinates of a small image location residing in a big image (let say I need to search for a specific tree inside a forest photograph. If the sub-image is found then the result would be something like: x=120 y=354 by example).

Is there a fast algorithm that I could use ?

I'm using Delphi (can also use Java if needed)

Thanks in advance",delphi,image,search,,,,open,0,65,9,"fast finding of small image in a bigger image I need to get the coordinates of a small image location residing in a big image (let say I need to search for a specific tree inside a forest photograph. If the sub-image is found then the result would be something like: x=120 y=354 by example).

Is there a fast algorithm that I could use ?

I'm using Delphi (can also use Java if needed)

Thanks in advance",3
2349482,02/28/2010 00:08:02,65886,02/13/2009 04:16:03,236,2,"[Delphi, Rave] Is it possible to change the Preview form's appearance?","When users preview a report I would like to avoid giving them the option of then opening another report or saving the current report. Open and Save are items in the default menu and toolbar that appear on Rave's preview rendering form; I'd like to make them not visible.

I'm using the version of Rave that comes with Delphi 2006.

Thanks, as always -- Al C.",delphi,rave-reports,,,,,open,0,64,11,"[Delphi, Rave] Is it possible to change the Preview form's appearance? When users preview a report I would like to avoid giving them the option of then opening another report or saving the current report. Open and Save are items in the default menu and toolbar that appear on Rave's preview rendering form; I'd like to make them not visible.

I'm using the version of Rave that comes with Delphi 2006.

Thanks, as always -- Al C.",2
7517965,09/22/2011 16:08:11,4997,09/07/2008 09:34:00,13194,268,Accessing BcdStore from Delphi,"I'm trying to convert this code fragment into Delphi and I got stuck on the `for each objWBL in colObjects`.

    if not objBcdStore.EnumerateObjects( &h10200003, colObjects ) then
        WScript.Echo ""ERROR objBcdStore.EnumerateObjects( &h10200003 ) failed.""
        WScript.Quit(1)
    end if
    
    for each objWBL in colObjects
        WScript.Echo """"
        WScript.Echo ""Windows Boot Loader""
        WScript.Echo ""-------------------""
    
        WScript.Echo ""identifier              "" & GetBcdId( objWBL.Id )
    
        If objWBL.Id = current then
    
          if not objWBL.GetElement(BcdOSLoaderInteger_NumberOfProcessors, objElement ) then
              WScript.Echo ""ERROR WBL GetElement for "" & Hex(BcdOSLoaderInteger_NumberOfProcessors) & "" failed.""
              WScript.Quit(1)
          end if
          WScript.Echo ""numproc              "" & objElement.Integer
    
          if not objWBL.GetElement(BcdOSLoaderBoolean_UseBootProcessorOnly, objElement ) then
              WScript.Echo ""ERROR WBL GetElement for "" & Hex(BcdOSLoaderBoolean_UseBootProcessorOnly) & "" failed.""
              WScript.Quit(1)
          end if
          WScript.Echo ""onecpu              "" & objElement.Boolean
    
        end if
    next

My partial q&d translation (caution, must be Admin to run it):

    uses
      OleAuto,
      ActiveX;

    function GetObject(const objectName: String): IDispatch;
    var
      bindCtx: IBindCtx;
      moniker: IMoniker;
      chEaten: Integer;
    begin
      OleCheck(CreateBindCtx(0, bindCtx));
      OleCheck(MkParseDisplayName(bindCtx, StringToOleStr(objectName), chEaten, moniker));
      OleCheck(moniker.BindToObject(bindCtx, nil, IDispatch, Result));
    end;
    
    procedure TForm44.btnClick(Sender: TObject);
    var
      colObjects   : OleVariant;
      objBcdStore  : OleVariant;
      objWMIService: OleVariant;
    begin
      objWMIService := GetObject('winmgmts:{impersonationlevel=Impersonate,(Backup,Restore)}!root/wmi:BcdStore');
      if not objWMIService.OpenStore('', objBcdStore) then
        Caption := 'error'
      else begin
        objBcdStore.EnumerateObjects($10200003, colObjects);
        //???
      end;
    end;

[EnumerateObjects][1] is defined as

    boolean EnumerateObjects(
      [in]   uint32 Type,
      [out]  BcdObject Objects[]
    );

I have no idea how to walk over the BcdObject array in Delphi.

[1]: http://msdn.microsoft.com/en-us/library/aa362686(v=VS.85).aspx",delphi,wmi,bcdstore,,,,open,0,593,4,"Accessing BcdStore from Delphi I'm trying to convert this code fragment into Delphi and I got stuck on the `for each objWBL in colObjects`.

    if not objBcdStore.EnumerateObjects( &h10200003, colObjects ) then
        WScript.Echo ""ERROR objBcdStore.EnumerateObjects( &h10200003 ) failed.""
        WScript.Quit(1)
    end if
    
    for each objWBL in colObjects
        WScript.Echo """"
        WScript.Echo ""Windows Boot Loader""
        WScript.Echo ""-------------------""
    
        WScript.Echo ""identifier              "" & GetBcdId( objWBL.Id )
    
        If objWBL.Id = current then
    
          if not objWBL.GetElement(BcdOSLoaderInteger_NumberOfProcessors, objElement ) then
              WScript.Echo ""ERROR WBL GetElement for "" & Hex(BcdOSLoaderInteger_NumberOfProcessors) & "" failed.""
              WScript.Quit(1)
          end if
          WScript.Echo ""numproc              "" & objElement.Integer
    
          if not objWBL.GetElement(BcdOSLoaderBoolean_UseBootProcessorOnly, objElement ) then
              WScript.Echo ""ERROR WBL GetElement for "" & Hex(BcdOSLoaderBoolean_UseBootProcessorOnly) & "" failed.""
              WScript.Quit(1)
          end if
          WScript.Echo ""onecpu              "" & objElement.Boolean
    
        end if
    next

My partial q&d translation (caution, must be Admin to run it):

    uses
      OleAuto,
      ActiveX;

    function GetObject(const objectName: String): IDispatch;
    var
      bindCtx: IBindCtx;
      moniker: IMoniker;
      chEaten: Integer;
    begin
      OleCheck(CreateBindCtx(0, bindCtx));
      OleCheck(MkParseDisplayName(bindCtx, StringToOleStr(objectName), chEaten, moniker));
      OleCheck(moniker.BindToObject(bindCtx, nil, IDispatch, Result));
    end;
    
    procedure TForm44.btnClick(Sender: TObject);
    var
      colObjects   : OleVariant;
      objBcdStore  : OleVariant;
      objWMIService: OleVariant;
    begin
      objWMIService := GetObject('winmgmts:{impersonationlevel=Impersonate,(Backup,Restore)}!root/wmi:BcdStore');
      if not objWMIService.OpenStore('', objBcdStore) then
        Caption := 'error'
      else begin
        objBcdStore.EnumerateObjects($10200003, colObjects);
        //???
      end;
    end;

[EnumerateObjects][1] is defined as

    boolean EnumerateObjects(
      [in]   uint32 Type,
      [out]  BcdObject Objects[]
    );

I have no idea how to walk over the BcdObject array in Delphi.

[1]: http://msdn.microsoft.com/en-us/library/aa362686(v=VS.85).aspx",3
800505,04/29/2009 01:21:51,32303,10/29/2008 09:06:33,565,18,Delphi EXE compressor?,"At one point I had a nice little compression utility that smashed my Delphi compiled EXE's to a smaller download size, but now I can't find it.  Any recommendations?

Also, are there any downsides to using these kinds of utilities?  (I mainly use them to shorten download times for rural / dial-up users).

Thanks in advance for your help. :-)",delphi,exe,compression,utilities,,02/14/2012 20:28:08,not constructive,1,60,3,"Delphi EXE compressor? At one point I had a nice little compression utility that smashed my Delphi compiled EXE's to a smaller download size, but now I can't find it.  Any recommendations?

Also, are there any downsides to using these kinds of utilities?  (I mainly use them to shorten download times for rural / dial-up users).

Thanks in advance for your help. :-)",4
8355927,12/02/2011 11:51:28,62391,02/04/2009 12:55:13,6598,132,Memory Allocation Strategy of TDictionary,"`TDictionary <T>` uses an internal array that is doubled if it is full:

    newCap := Length(FItems) * 2;
    if newCap = 0 then
      newCap := 4;
    Rehash(newCap);

This performs well with medium number of items, but if one gets to the upper limit it is very unfortunate, because it might throw an `EOutOfMemory` exception even if there  is almost half of the memory still available.

Is there any way to influence this behaviour? How do other collection classes deal with this scenario? ",delphi,memory-management,collections,delphi-xe,,,open,0,96,5,"Memory Allocation Strategy of TDictionary `TDictionary <T>` uses an internal array that is doubled if it is full:

    newCap := Length(FItems) * 2;
    if newCap = 0 then
      newCap := 4;
    Rehash(newCap);

This performs well with medium number of items, but if one gets to the upper limit it is very unfortunate, because it might throw an `EOutOfMemory` exception even if there  is almost half of the memory still available.

Is there any way to influence this behaviour? How do other collection classes deal with this scenario? ",4
8986292,01/24/2012 11:46:31,1057435,11/21/2011 08:48:38,21,0,Writing blob file into database by using the sql statement insert into,"I am searching at the moment for a possibility in advanced database server via sql to put a byte stream, so called blob file into a table. When I build up a complete database I am doing it like this:

TBlobField(BaseTable.FieldByName('BlobData')).LoadFromStream(BinaryStream);

Now I would like to add an Entry into my database where one Field has the 'BlobData'.
I started like that:

FADSQuery.SQL.Add('Insert Into '+DBName'+'(BlobData)');
TBlobField(FADSQuery.ParamByName('BlobData')).LoadFromStream(BinaryStream);

But the compiler tells me it cannot find the BlobData field.:(
Is it nearly right to do it like that? I wouldn't like to put inside the insert into statement a whole file.

Thank you in advance

",delphi,advantage-database-server,,,,,open,0,95,12,"Writing blob file into database by using the sql statement insert into I am searching at the moment for a possibility in advanced database server via sql to put a byte stream, so called blob file into a table. When I build up a complete database I am doing it like this:

TBlobField(BaseTable.FieldByName('BlobData')).LoadFromStream(BinaryStream);

Now I would like to add an Entry into my database where one Field has the 'BlobData'.
I started like that:

FADSQuery.SQL.Add('Insert Into '+DBName'+'(BlobData)');
TBlobField(FADSQuery.ParamByName('BlobData')).LoadFromStream(BinaryStream);

But the compiler tells me it cannot find the BlobData field.:(
Is it nearly right to do it like that? I wouldn't like to put inside the insert into statement a whole file.

Thank you in advance

",2
11355715,07/06/2012 04:09:38,1505665,07/06/2012 03:30:53,1,0,How to send data between 2 things,"I want to send a string between a injected DLL in a different process and my application.But I do not know how.Can someone give me a link to learn how to do this?I googled and google and googled but couldn't find anything...
I program in delphi.",delphi,data,exchange,,,07/06/2012 15:38:47,not a real question,1,45,7,"How to send data between 2 things I want to send a string between a injected DLL in a different process and my application.But I do not know how.Can someone give me a link to learn how to do this?I googled and google and googled but couldn't find anything...
I program in delphi.",3
2538655,03/29/2010 14:29:24,279578,02/23/2010 15:01:35,1,0,Should I free a Delphi object auto-instantiated from a web services call?,"Newbie question:  I have a forms application.  It has a separate thread which makes a web services call, and then posts the results of the call to the main form.

In my thread, after X seconds have passed (using a TTimer), I call:

    procedure TPollingThread.OnTimer(Sender: TObject);
    var
    SystemProbeValues : TCWProbeValues;  
    begin
    SystemProbeValues := Remote.Run.GetSystemProbeValues;
    PostMessage( ParentHandle, WM_APIEVENT ,Integer(apiMultiCellStatus), Integer(SystemProbeValues) );
    end;

The function Remote.Run.GetSystemProbeValues has the following prototype:

    function GetSystemProbeValues : TCWProbeValues; stdcall;

And TCWProbeValues is a dynamic array of TCWProbeValue objects (which all descend from TRemotable).

In my main form, I receive the message just fine and cast the LParam back to TCWProbeValues:

    procedure TFrmCWMain.OnAPIEvent(var msg: TMessage);
    begin
    ProbeValues := TCWProbeValues(msg.LParam);
    end;

My question is, given that the dynamic array and its objects were created by the Delphi HTTORIO system, who is responsible for freeing them?  Did Delphi consider that memory re-usable after my OnTimer function returned?  (And in which case, its pure good luck that my main form message handler can actually read the memory referenced by the LParam of the message?)  Or rather, is it my responsibility to free the object auto-instantiated by the HTTPRIO request?

Many thanks, please shout if the above needs more detail / code and I'll add to it!

Cheers, Duncan",delphi,windows-messages,web-services,memory-management,,,open,0,244,12,"Should I free a Delphi object auto-instantiated from a web services call? Newbie question:  I have a forms application.  It has a separate thread which makes a web services call, and then posts the results of the call to the main form.

In my thread, after X seconds have passed (using a TTimer), I call:

    procedure TPollingThread.OnTimer(Sender: TObject);
    var
    SystemProbeValues : TCWProbeValues;  
    begin
    SystemProbeValues := Remote.Run.GetSystemProbeValues;
    PostMessage( ParentHandle, WM_APIEVENT ,Integer(apiMultiCellStatus), Integer(SystemProbeValues) );
    end;

The function Remote.Run.GetSystemProbeValues has the following prototype:

    function GetSystemProbeValues : TCWProbeValues; stdcall;

And TCWProbeValues is a dynamic array of TCWProbeValue objects (which all descend from TRemotable).

In my main form, I receive the message just fine and cast the LParam back to TCWProbeValues:

    procedure TFrmCWMain.OnAPIEvent(var msg: TMessage);
    begin
    ProbeValues := TCWProbeValues(msg.LParam);
    end;

My question is, given that the dynamic array and its objects were created by the Delphi HTTORIO system, who is responsible for freeing them?  Did Delphi consider that memory re-usable after my OnTimer function returned?  (And in which case, its pure good luck that my main form message handler can actually read the memory referenced by the LParam of the message?)  Or rather, is it my responsibility to free the object auto-instantiated by the HTTPRIO request?

Many thanks, please shout if the above needs more detail / code and I'll add to it!

Cheers, Duncan",4
7346992,09/08/2011 11:00:41,774135,05/28/2011 07:49:18,1,0,how to send SMS through a phone connected to PC in delphi code?,how to send SMS through a mobile phone connected to PC in delphi code?,delphi,sms,,,,09/08/2011 13:06:07,not a real question,1,14,13,how to send SMS through a phone connected to PC in delphi code? how to send SMS through a mobile phone connected to PC in delphi code?,2
3429662,08/07/2010 08:03:55,427855,02/23/2009 06:42:29,363,6,How to programing delphi?,"what i need?

what about tool for programing via delphi programing?

i am a novice for delphi.",delphi,,,,,08/07/2010 18:13:42,not a real question,1,15,4,"How to programing delphi? what i need?

what about tool for programing via delphi programing?

i am a novice for delphi.",1
3808322,09/27/2010 22:15:19,460000,09/27/2010 22:15:19,1,0,Symbol eliminated by linker (Delphi),"Help!
I am receiving this error when viewing the contents of an inbound function parameters in my Delphi 4 applicataion.

The code calls a function in a dll with 3 parameters (app.handle, pchar, boolean);

The declaring function is in externs.pas and delcared as:
  function AdjustVoucherDifference(hOwner :HWnd; Receipt_ID :PChar; bCommit: Boolean): boolean; stdcall; external 'FBCoupon.dll' name 'AdjustVoucherDifference';


in another source file, the code calls it as:
  AdjustVoucherDifference(Application.Handle, PChar(Receipt_ID), true);

When stepping through the code in debug mode, I can see valid values in the source file, but when it breaks on the line in externs.pas, the tooltip for the values (or CTRL F7) shows that the symbols have been eliminated from the linker and I receive exceptions when the execution is in the dll.

The DLL is developed in CBuilder4 and the particular function is declared as:
  BOOL __stdcall __DLLTYPE__ AdjustVoucherDifference(HWND hOwner, char *receipt_id, bool commit);

Compiler optimization is turned off.

Thanks!!!",delphi,,,,,,open,0,146,5,"Symbol eliminated by linker (Delphi) Help!
I am receiving this error when viewing the contents of an inbound function parameters in my Delphi 4 applicataion.

The code calls a function in a dll with 3 parameters (app.handle, pchar, boolean);

The declaring function is in externs.pas and delcared as:
  function AdjustVoucherDifference(hOwner :HWnd; Receipt_ID :PChar; bCommit: Boolean): boolean; stdcall; external 'FBCoupon.dll' name 'AdjustVoucherDifference';


in another source file, the code calls it as:
  AdjustVoucherDifference(Application.Handle, PChar(Receipt_ID), true);

When stepping through the code in debug mode, I can see valid values in the source file, but when it breaks on the line in externs.pas, the tooltip for the values (or CTRL F7) shows that the symbols have been eliminated from the linker and I receive exceptions when the execution is in the dll.

The DLL is developed in CBuilder4 and the particular function is declared as:
  BOOL __stdcall __DLLTYPE__ AdjustVoucherDifference(HWND hOwner, char *receipt_id, bool commit);

Compiler optimization is turned off.

Thanks!!!",1
7390670,09/12/2011 15:59:14,69742,02/23/2009 04:34:53,8637,352,Making Delphi 7 play nice with source control?,"Hello I've been having to work in a Delphi 7 project recently and one thing that constantly bugs me is the *.dfm files. Anytime I even open up a form, it will change the .dfm file. 

For example, this diff was made just by opening the project and viewing a file and form(note, I didn't change anything on the form itself)

    @@ -1,6 +1,6 @@
     object FormPartnerInfo: TFormPartnerInfo
    -  Left = 85
    -  Top = 454
    +  Left = 554
    +  Top = 322
       BorderIcons = [biSystemMenu]
       BorderStyle = bsToolWindow

Is there anyway to force Delphi 7 to not update this pointless design-time information? I'd prefer to have it play nice in SVN so I don't have to keep reverting files before doing a commit",delphi,svn,version-control,delphi-7,,09/13/2011 11:40:35,not constructive,1,159,8,"Making Delphi 7 play nice with source control? Hello I've been having to work in a Delphi 7 project recently and one thing that constantly bugs me is the *.dfm files. Anytime I even open up a form, it will change the .dfm file. 

For example, this diff was made just by opening the project and viewing a file and form(note, I didn't change anything on the form itself)

    @@ -1,6 +1,6 @@
     object FormPartnerInfo: TFormPartnerInfo
    -  Left = 85
    -  Top = 454
    +  Left = 554
    +  Top = 322
       BorderIcons = [biSystemMenu]
       BorderStyle = bsToolWindow

Is there anyway to force Delphi 7 to not update this pointless design-time information? I'd prefer to have it play nice in SVN so I don't have to keep reverting files before doing a commit",4
11479083,07/13/2012 22:16:44,396619,07/20/2010 09:25:51,60,6,Ways of MS Word documents manipulation,"Question is the same as [here][1], but I'm interested in Delphi-specific ways and solution (Delphi ways, Delphi components/libraries etc.).

Thanks in advance.

  [1]: http://stackoverflow.com/questions/10494672/how-many-ways-to-operate-ms-word-document-in-c-net",delphi,word,delphi-xe2,,,07/16/2012 06:47:01,not a real question,1,24,6,"Ways of MS Word documents manipulation Question is the same as [here][1], but I'm interested in Delphi-specific ways and solution (Delphi ways, Delphi components/libraries etc.).

Thanks in advance.

  [1]: http://stackoverflow.com/questions/10494672/how-many-ways-to-operate-ms-word-document-in-c-net",3
3801525,09/27/2010 06:26:51,357178,06/03/2010 07:00:38,1,0,how to write and execute a thread,"i have never worked with threads before,so now im trying to creata a thread with a query to check database status,the query is as follow: select (*)  as DBCount from v$datafile where statua in 'OFFLINE'; this query returns the total number of all the databases that are offline so i want to create a threa in delpi that will execute this query on the background of my application when i run it and display the results on a label....please assist urgenlty.",delphi,pthreads,,,,,open,0,82,7,"how to write and execute a thread i have never worked with threads before,so now im trying to creata a thread with a query to check database status,the query is as follow: select (*)  as DBCount from v$datafile where statua in 'OFFLINE'; this query returns the total number of all the databases that are offline so i want to create a threa in delpi that will execute this query on the background of my application when i run it and display the results on a label....please assist urgenlty.",2
6420051,06/21/2011 03:31:35,301218,03/24/2010 21:14:20,99,1,Why QueryperformanceCounter timed different from wall clock?,"Hi I am using QueryperformanceCounter to time a block of code in Delphi. For some reason, the 
Millisecond number I got by using QueryPerformanceCounter is quite different from my wall clock time by using a stopwatch. For example The stopwatch give me about 33 seconds, which seems right if not accuracy, but using QueryPerofomanceCounter will give me a number like 500 Million-seconds.


When step though my code, I can see that QueryPerformanceFrequencygives me correct CPU frequency for my CPU, 2.4G for Core2 E6600. So if the tick number is correct, `(tick number / Freq) * 1000` should give me correct execution time for the code I am timing, but why not?

I know that for the code I am trying to timing, QeuryPerformanceCounter is probably over-killing as it took seconds rather than MillionSeconds, but I am more interested in understanding the reason for the time difference between wall clock and QueryPerormanceCounter.

My Hardware is E6600 Core2 and OS is Windows 7 X64 if it is relevant.",delphi,queryperformancecounter,,,,,open,0,163,7,"Why QueryperformanceCounter timed different from wall clock? Hi I am using QueryperformanceCounter to time a block of code in Delphi. For some reason, the 
Millisecond number I got by using QueryPerformanceCounter is quite different from my wall clock time by using a stopwatch. For example The stopwatch give me about 33 seconds, which seems right if not accuracy, but using QueryPerofomanceCounter will give me a number like 500 Million-seconds.


When step though my code, I can see that QueryPerformanceFrequencygives me correct CPU frequency for my CPU, 2.4G for Core2 E6600. So if the tick number is correct, `(tick number / Freq) * 1000` should give me correct execution time for the code I am timing, but why not?

I know that for the code I am trying to timing, QeuryPerformanceCounter is probably over-killing as it took seconds rather than MillionSeconds, but I am more interested in understanding the reason for the time difference between wall clock and QueryPerormanceCounter.

My Hardware is E6600 Core2 and OS is Windows 7 X64 if it is relevant.",2
1572557,10/15/2009 13:58:31,181098,09/29/2009 12:02:25,18,1,Delphi 2007 and Logitech Webcam Driver,"A while ago I had this issue with Delphi 2007 unable to run and debug apps while the logitech webcam driver runs.

Apparently the Logitech Driver inserts a stub into every process running, thereby messing up the debugger's offset.

It's been a year and a bit - is this still an issue? Has Logitech cleaned up their act or do I have to dump my webcam for another brand?",delphi,webcam,driver,,,,open,0,67,6,"Delphi 2007 and Logitech Webcam Driver A while ago I had this issue with Delphi 2007 unable to run and debug apps while the logitech webcam driver runs.

Apparently the Logitech Driver inserts a stub into every process running, thereby messing up the debugger's offset.

It's been a year and a bit - is this still an issue? Has Logitech cleaned up their act or do I have to dump my webcam for another brand?",3
10916294,06/06/2012 14:29:28,512728,11/18/2010 21:03:41,257,23,Strange [number]s in Delphi DFM files - origin and necessity?,"I need to change a large number of Delphi components defined in one package to similar ones in another package.
Much of the grunt work can be done by replacing text (component types and properties) in the DFM files - saved as text of course.

I have searched Stackoverflow and Google and am now adapting the Felix Colibri DFM parser from http://www.felix-colibri.com/papers/colibri_utilities/dfm_parser/dfm_parser.html

I come across a 'feature' in the DFM files that the parser chokes on: [number]s after the type specifications like this:

    inherited DialoogEditAgenda: TDialoogEditAgenda
      ActiveControl = PlanCalendar
      Caption = 'Agenda'
      [snip]
      inherited PanelButtons: TRzPanel
        Top = 537
        [snip]
        inherited ButtonCancel: TRzBitBtn [0]  <== *here*
          Left = 852
          [snip]
        end
        object CheckBoxBeschikbaarheid: TRzCheckBox [1]  <== *here*
          Left = 8
          [snip]
        end
        inherited ButtonOK: TRzBitBtn [2]  <== *here*
          Left = 900
          [snip]
        end
      end
      inherited PageControl: TRzPageControl
        Left = 444
        [snip]
      end
      object PanelBeschikbaarheid: TRzSizePanel [2]  <== *here*
        Left = 967
        [snip]
      end
      object PanelScheduler: TRzPanel [3]  <== *here*
        Left = 23
        Top = 22
        [...]

Many of these DFMs are heavily inherited (I had to adapt Colibri's code for that already), but a small test app with inheritance failed to produce the [number]s in the DFM.

My question before having to extend the parser code: does anyone know where these [number]s come from and consequently, can I maybe remove them before parsing the DFM files?

Thanks

Jan
",delphi,,,,,,open,0,438,10,"Strange [number]s in Delphi DFM files - origin and necessity? I need to change a large number of Delphi components defined in one package to similar ones in another package.
Much of the grunt work can be done by replacing text (component types and properties) in the DFM files - saved as text of course.

I have searched Stackoverflow and Google and am now adapting the Felix Colibri DFM parser from http://www.felix-colibri.com/papers/colibri_utilities/dfm_parser/dfm_parser.html

I come across a 'feature' in the DFM files that the parser chokes on: [number]s after the type specifications like this:

    inherited DialoogEditAgenda: TDialoogEditAgenda
      ActiveControl = PlanCalendar
      Caption = 'Agenda'
      [snip]
      inherited PanelButtons: TRzPanel
        Top = 537
        [snip]
        inherited ButtonCancel: TRzBitBtn [0]  <== *here*
          Left = 852
          [snip]
        end
        object CheckBoxBeschikbaarheid: TRzCheckBox [1]  <== *here*
          Left = 8
          [snip]
        end
        inherited ButtonOK: TRzBitBtn [2]  <== *here*
          Left = 900
          [snip]
        end
      end
      inherited PageControl: TRzPageControl
        Left = 444
        [snip]
      end
      object PanelBeschikbaarheid: TRzSizePanel [2]  <== *here*
        Left = 967
        [snip]
      end
      object PanelScheduler: TRzPanel [3]  <== *here*
        Left = 23
        Top = 22
        [...]

Many of these DFMs are heavily inherited (I had to adapt Colibri's code for that already), but a small test app with inheritance failed to produce the [number]s in the DFM.

My question before having to extend the parser code: does anyone know where these [number]s come from and consequently, can I maybe remove them before parsing the DFM files?

Thanks

Jan
",1
5396379,03/22/2011 18:56:12,1049130,03/21/2011 17:47:07,6,0,How can I open debug inspector in Delphi 7?,"I use Delphi 7 lite 7.3.4.1, I saw someone using the ""debug inspector"" on it, but I don't know how to open it. How can I?",delphi,pascal,borland,embarcadero,,03/22/2011 19:35:43,too localized,1,26,9,"How can I open debug inspector in Delphi 7? I use Delphi 7 lite 7.3.4.1, I saw someone using the ""debug inspector"" on it, but I don't know how to open it. How can I?",4
8046719,11/08/2011 06:28:45,192910,10/20/2009 07:56:41,5142,208,Seeking book about Indy using Delphi,"I already asked a few n00b questions, fouund some demos, altered them and realize that I might have a lot more questions ...

 - Should I use Indy 10 or 9 with Delphi 7?
 - What if my server wants to broadcast something to all the clients?
 - too many more to list, and I'd ratehr educte myself, if I can, than continually ask for help

Does anyone know of a book which covers Indy programming in Delphi (pref. D7) ?



",delphi,indy,,,,11/09/2011 02:43:22,not a real question,1,80,6,"Seeking book about Indy using Delphi I already asked a few n00b questions, fouund some demos, altered them and realize that I might have a lot more questions ...

 - Should I use Indy 10 or 9 with Delphi 7?
 - What if my server wants to broadcast something to all the clients?
 - too many more to list, and I'd ratehr educte myself, if I can, than continually ask for help

Does anyone know of a book which covers Indy programming in Delphi (pref. D7) ?



",2
5008473,02/15/2011 19:21:31,618430,02/15/2011 19:21:31,1,0,Delphi's function to change iso and nrg files size.,Need a function in Delphi to change the summary size in iso and nrg image files.,delphi,,,,,02/16/2011 09:39:08,not a real question,1,16,9,Delphi's function to change iso and nrg files size. Need a function in Delphi to change the summary size in iso and nrg image files.,1
1857288,12/07/2009 01:25:42,226033,12/07/2009 01:25:41,1,0,delphi records and c structs,"Task:
Application written in Delphi accepts a structure (record in terms of Delphi) of three fields. I can send the pointer of this structure using SendMessage (Win32api) function.

So a question is:
How to maintain certain structure representation in memory for delphi in terms of delphi. It has type

        PWPModPostData = ^ TWPModPostData;
        TWPModPostData = record
           DataType: Integer;
           Data: PChar;
           Next: PWPModPostData;
        end;
",delphi,c,struct,record,,,open,0,111,5,"delphi records and c structs Task:
Application written in Delphi accepts a structure (record in terms of Delphi) of three fields. I can send the pointer of this structure using SendMessage (Win32api) function.

So a question is:
How to maintain certain structure representation in memory for delphi in terms of delphi. It has type

        PWPModPostData = ^ TWPModPostData;
        TWPModPostData = record
           DataType: Integer;
           Data: PChar;
           Next: PWPModPostData;
        end;
",4
237106,10/25/2008 22:15:50,31510,10/25/2008 22:15:50,1,0,Get string return value from C DLL in Delphi,"I have a legacy DLL written in C that contains a function that returns a string, and I need to access this function from Delphi. The only info I have about the DLL is the VB declare for accessing the function:

Public Declare Function DecryptStr Lib ""strlib"" (Str As String) As String 

I've tried the following without success:

Declaration:

    function DecryptStr(s: PChar): PChar; cdecl; external 'strlib.dll';

Usage:

    var
      p1, p2 : pchar;
    begin
      GetMem( p1, 255 );
      StrPCopy( p2, 'some string to decrypt' );
      p1 := DecryptStr( p2 );
    end;

This consistently crashes the DLL with an Access Violation. I'm at a loss.

Any suggestions ?",delphi,c,dll,,,,open,0,133,9,"Get string return value from C DLL in Delphi I have a legacy DLL written in C that contains a function that returns a string, and I need to access this function from Delphi. The only info I have about the DLL is the VB declare for accessing the function:

Public Declare Function DecryptStr Lib ""strlib"" (Str As String) As String 

I've tried the following without success:

Declaration:

    function DecryptStr(s: PChar): PChar; cdecl; external 'strlib.dll';

Usage:

    var
      p1, p2 : pchar;
    begin
      GetMem( p1, 255 );
      StrPCopy( p2, 'some string to decrypt' );
      p1 := DecryptStr( p2 );
    end;

This consistently crashes the DLL with an Access Violation. I'm at a loss.

Any suggestions ?",3
2943360,05/31/2010 12:01:58,210374,11/13/2009 11:25:06,17,0,"Are we DELPHI, VCL or Pascal programmers?","i´ve been a delphi database programmer since D2. Now i´m facing some digital imaging and 3D  challenges that make me to start study OpenGL, DirectX, Color Spaces and so on. 

I´m really trying but nobody seems to use Delphi for this kind of stuff, just the good-old-paycheck Database programming. 

ok, i know that we have some very smart guys behind some clever components, some of this open-source. Is there any PhotoShop, Blender, Maya, Office, Sonar, StarCraft, Call of Dutty written in Delphi?

Do i have to learn C++ to have access to zillions of books about that kind of stuff? What is the fuzz/hype behind this: int *varName = &anhoterThing? Why pointers seems to be the holy graal to this apps?

I´ve downloaded MSVC++ Express and start to learn some WPF and QT integration, and i think: ""Man, Delphi does this kind of stuff, with less code, less headaches, since the wheels were invented""

This lead my mind to the following... Do you ever tried to write a simple notepad program using just notepad and dcc32 in Pascal/Delphi? 

if so embarcadero could make our beloved pascal compiler free, and sell just the ide, the vcl, the customer support ...

and back to the question: Are we DELPHI, VCL or Pascal programmers?",delphi,graphics,vcl,,,05/31/2010 12:32:12,not a real question,1,208,7,"Are we DELPHI, VCL or Pascal programmers? i´ve been a delphi database programmer since D2. Now i´m facing some digital imaging and 3D  challenges that make me to start study OpenGL, DirectX, Color Spaces and so on. 

I´m really trying but nobody seems to use Delphi for this kind of stuff, just the good-old-paycheck Database programming. 

ok, i know that we have some very smart guys behind some clever components, some of this open-source. Is there any PhotoShop, Blender, Maya, Office, Sonar, StarCraft, Call of Dutty written in Delphi?

Do i have to learn C++ to have access to zillions of books about that kind of stuff? What is the fuzz/hype behind this: int *varName = &anhoterThing? Why pointers seems to be the holy graal to this apps?

I´ve downloaded MSVC++ Express and start to learn some WPF and QT integration, and i think: ""Man, Delphi does this kind of stuff, with less code, less headaches, since the wheels were invented""

This lead my mind to the following... Do you ever tried to write a simple notepad program using just notepad and dcc32 in Pascal/Delphi? 

if so embarcadero could make our beloved pascal compiler free, and sell just the ide, the vcl, the customer support ...

and back to the question: Are we DELPHI, VCL or Pascal programmers?",3
9534090,03/02/2012 13:27:14,806318,06/20/2011 08:51:04,116,6,Unit testing a Firemonkey Application,"I'm trying to use DUnit, which came with RAD Studio XE2, to unit testing a Firemonkey app (C++).

The problem is, DUnit is a VCL project, and this makes me unable to include the Firemonkey Unit Forms (ex.: UfrmMain.h) on the testing project.

Even if I separate the Visual with Logic (MultiTier/MVC), i cannot include any Firemonkey library into my classes (sometimes this would be useful, when there is a class ""CustomDatabase"" which have a object of type TConnection, that is only available in Firemonkey - **of course** only an example).

The testing is possible when i separate the firemonkey code completely and leave it on forms, and the logic/data kept on classes with pure C++ code.

So, this ""handicap"" is actually a good thing? Forcing me to work with MultiTier/MVC? (This thing in C++ is new to me)
Or should i look for an alternative of unit testing, that lets me test forms too?

(Can you also recommend me some C++ project on github or code example which is separated in the mentioned way, where i can rely on?)",delphi,unit-testing,c++builder,firemonkey,,,open,0,174,5,"Unit testing a Firemonkey Application I'm trying to use DUnit, which came with RAD Studio XE2, to unit testing a Firemonkey app (C++).

The problem is, DUnit is a VCL project, and this makes me unable to include the Firemonkey Unit Forms (ex.: UfrmMain.h) on the testing project.

Even if I separate the Visual with Logic (MultiTier/MVC), i cannot include any Firemonkey library into my classes (sometimes this would be useful, when there is a class ""CustomDatabase"" which have a object of type TConnection, that is only available in Firemonkey - **of course** only an example).

The testing is possible when i separate the firemonkey code completely and leave it on forms, and the logic/data kept on classes with pure C++ code.

So, this ""handicap"" is actually a good thing? Forcing me to work with MultiTier/MVC? (This thing in C++ is new to me)
Or should i look for an alternative of unit testing, that lets me test forms too?

(Can you also recommend me some C++ project on github or code example which is separated in the mentioned way, where i can rely on?)",4
10468787,05/06/2012 06:58:17,528588,12/02/2010 21:06:09,117,39,setTimeout function in delphi,"i want create function like setTimeout(use anonymous function as parameter) 
like this

    SetTimeOut(procedure (sender:TObject);
    begin
      Self.Counter:=Self.Counter+1;
    end);

but delphi OnTimer in TTimer(class) don't accept anonymous function.please declare class for this purpose  
 ",delphi,,,,,,open,0,47,4,"setTimeout function in delphi i want create function like setTimeout(use anonymous function as parameter) 
like this

    SetTimeOut(procedure (sender:TObject);
    begin
      Self.Counter:=Self.Counter+1;
    end);

but delphi OnTimer in TTimer(class) don't accept anonymous function.please declare class for this purpose  
 ",1
6047105,05/18/2011 15:19:24,381979,07/02/2010 11:01:52,489,11,Is there any component like ExeMod ?,I've downloaded some samples about `ExeMod` but they don't work in the Delphi 2010 and i don't know is it compatible with Windows Seven or not. Is there any component like `ExeMod` but without problems?,delphi,exe,generate,,,,open,0,35,7,Is there any component like ExeMod ? I've downloaded some samples about `ExeMod` but they don't work in the Delphi 2010 and i don't know is it compatible with Windows Seven or not. Is there any component like `ExeMod` but without problems?,3
9099164,02/01/2012 16:10:44,1183093,02/01/2012 15:51:44,1,0,"Problems with Delphi XE2 , DataSnap and Lookup Field","I have a bit of problem here. I have created a lookupfield in my application server using Delphi XE2 Datasnap technology. On the client side, that field becomes TStringField. Now, the problem is that I loose the lookup functionality on the client side. To top that, I can't change the stringfield on the client side because it is read only (even if I manually turn off the read only property).

I don't want to lookup tables on the client side because I don't want all the data loaded on my client side just to support look up. 

I can change the Key field value, but the stringfield lookup text doesnt change unless I apply updates and reload the data. 

Users want to see the text change. 

what should I do?

Nirav",delphi,field,lookup,datasnap,,,open,0,129,9,"Problems with Delphi XE2 , DataSnap and Lookup Field I have a bit of problem here. I have created a lookupfield in my application server using Delphi XE2 Datasnap technology. On the client side, that field becomes TStringField. Now, the problem is that I loose the lookup functionality on the client side. To top that, I can't change the stringfield on the client side because it is read only (even if I manually turn off the read only property).

I don't want to lookup tables on the client side because I don't want all the data loaded on my client side just to support look up. 

I can change the Key field value, but the stringfield lookup text doesnt change unless I apply updates and reload the data. 

Users want to see the text change. 

what should I do?

Nirav",4
10129890,04/12/2012 18:50:51,1329812,04/12/2012 17:40:31,6,0,Multiple MDI Parent Forms in a Single Application,"The VCL does not natively allow forms other than the MainForm to host MDI child forms. This is a hard-coded limitation on Borland's part, not a limitation in Microsoft's MDI architecture. Microsoft allows multiple windows in an application to host MDI children. There is no concept of MainForms in the Win32 API.

I have tried converting the below embarcadro c++ example to embarcadro delphi without success.
I keep encountering the error ""no mdi forms are currently active"" when creating the mdi child forms.

This c++ sample demonstrates how to allow a non-MDI project to host multiple MDI parent forms, none of which are the VCL's MainForm.

Download with Information (Account required to download)
http://cc.embarcadero.com/item/23574

Direct Download (No account required to download)
http://www.delphibasics.info/MultipleMDIParentFormsInASingleApplication.zip

I would be grateful if someone would convert this sample from embarcadro c++ language to embarcadro delphi language. Thank you.",delphi,vcl,mdi,,,04/12/2012 19:37:20,not a real question,1,134,8,"Multiple MDI Parent Forms in a Single Application The VCL does not natively allow forms other than the MainForm to host MDI child forms. This is a hard-coded limitation on Borland's part, not a limitation in Microsoft's MDI architecture. Microsoft allows multiple windows in an application to host MDI children. There is no concept of MainForms in the Win32 API.

I have tried converting the below embarcadro c++ example to embarcadro delphi without success.
I keep encountering the error ""no mdi forms are currently active"" when creating the mdi child forms.

This c++ sample demonstrates how to allow a non-MDI project to host multiple MDI parent forms, none of which are the VCL's MainForm.

Download with Information (Account required to download)
http://cc.embarcadero.com/item/23574

Direct Download (No account required to download)
http://www.delphibasics.info/MultipleMDIParentFormsInASingleApplication.zip

I would be grateful if someone would convert this sample from embarcadro c++ language to embarcadro delphi language. Thank you.",3
4801135,01/26/2011 03:15:37,482742,10/21/2010 08:49:09,92,0,How to save virtual listview immediately after it displays data?,"I want to save data in virtual listview immediately after it is filled. If I use Savedialog to save data, it works. If I call save procedure in ListviewOnData event, it prompts Error "" Can not create file..."". I reproduce my observation here. 

    procedure TForm6.savefileList(AListView: TListView; sFileName: string);
    
    begin
    F:= TFileStream.Create(sFileName, fmCreate or fmOpenRead);
    ...                                                       
    ...
    end;
    
    Procedure Tform6.SavevirtualistinSaveDialog;
    begin
    If SaveDialog.execute then
    savefileList(AListView, sFileName); // It works and save data in sfilename.
    ..
    end;
    
    procedure TForm6.ListView1Data(Sender: TObject; Item: TListItem);
    begin
    
    // filling data in virtual list
    // Right after filling data, I call Dosavelist procedure.
    
    Dosavelist; //error line "" Can not Create file""
    
    end;
    
    Procedure Tform6.Dosavelist;
    begin
    savefileList(AListView, sFileName);
    end;

I expect save the data in listview (virtual mode) right after it is filled. But it prompts errors.

How to solve it. Thank you in advance. 
",delphi,,,,,,open,0,286,10,"How to save virtual listview immediately after it displays data? I want to save data in virtual listview immediately after it is filled. If I use Savedialog to save data, it works. If I call save procedure in ListviewOnData event, it prompts Error "" Can not create file..."". I reproduce my observation here. 

    procedure TForm6.savefileList(AListView: TListView; sFileName: string);
    
    begin
    F:= TFileStream.Create(sFileName, fmCreate or fmOpenRead);
    ...                                                       
    ...
    end;
    
    Procedure Tform6.SavevirtualistinSaveDialog;
    begin
    If SaveDialog.execute then
    savefileList(AListView, sFileName); // It works and save data in sfilename.
    ..
    end;
    
    procedure TForm6.ListView1Data(Sender: TObject; Item: TListItem);
    begin
    
    // filling data in virtual list
    // Right after filling data, I call Dosavelist procedure.
    
    Dosavelist; //error line "" Can not Create file""
    
    end;
    
    Procedure Tform6.Dosavelist;
    begin
    savefileList(AListView, sFileName);
    end;

I expect save the data in listview (virtual mode) right after it is filled. But it prompts errors.

How to solve it. Thank you in advance. 
",1
5617205,04/11/2011 05:43:05,207391,11/09/2009 23:39:38,182,18,Can I use an Edit Mask to format output? (not just validate input),"Delphi 7 question. I'm working with a form that has many databound controls (changing this is not an option). I have a TDBEDIT control bound to a TStringField (which has a EditMask property). I know I can use this EditMask to force the control to validate its input, but what I want to know is if I can populate the field directly with the raw value and have the control display it according to the EditMask?

I want to populate the field with a 16 digit number, but I want it displayed as 4 lots of 4 digits (ie. 9999 9999 9999 9999).

If I do ...

    dbedtABCNumber.DataSource.DataSet.Edit;
    dbedtABCNumber.Field.Value := '1234567812345678';

I only get the first 4 digits displayed. 

I hope there's someone out there who's more familiar with the intracacies of old databound controls.",delphi,,,,,,open,0,138,13,"Can I use an Edit Mask to format output? (not just validate input) Delphi 7 question. I'm working with a form that has many databound controls (changing this is not an option). I have a TDBEDIT control bound to a TStringField (which has a EditMask property). I know I can use this EditMask to force the control to validate its input, but what I want to know is if I can populate the field directly with the raw value and have the control display it according to the EditMask?

I want to populate the field with a 16 digit number, but I want it displayed as 4 lots of 4 digits (ie. 9999 9999 9999 9999).

If I do ...

    dbedtABCNumber.DataSource.DataSet.Edit;
    dbedtABCNumber.Field.Value := '1234567812345678';

I only get the first 4 digits displayed. 

I hope there's someone out there who's more familiar with the intracacies of old databound controls.",1
8387415,12/05/2011 15:11:35,583721,01/20/2011 22:53:54,503,15,Is DataSnap an appropriate solution to bring the data and business logic of an existing Windows app to mobile/web clients?,"I need to take a huge Delphi XE application (backed by proprietary SQL server NexusDB) and begin providing my clients the ability to access the system in new ways:

 - Thinner Windows client for slow/VPN connections
 - Mobile/Tablet
 - Web

DataSnap appropriate for this or is introducing a middle tier the wrong way about providing remote/mobile access?  Other solutions/ideas welcome.

(I have XE2 Enterprise but am stuck on XE Enterprise for awhile.)
",delphi,datasnap,,,,,open,0,71,20,"Is DataSnap an appropriate solution to bring the data and business logic of an existing Windows app to mobile/web clients? I need to take a huge Delphi XE application (backed by proprietary SQL server NexusDB) and begin providing my clients the ability to access the system in new ways:

 - Thinner Windows client for slow/VPN connections
 - Mobile/Tablet
 - Web

DataSnap appropriate for this or is introducing a middle tier the wrong way about providing remote/mobile access?  Other solutions/ideas welcome.

(I have XE2 Enterprise but am stuck on XE Enterprise for awhile.)
",2
8772448,01/07/2012 19:35:44,863551,07/26/2011 13:39:58,88,1,Creating an installer,"I was just trying to make an installer. What is the best way to handle storing files in the exe file and then extracting them to the installation directory?

For example, I have my installer.exe file, I want it to contain the following:

 - Main executable file
 - 3 x *.db files 

Upon selecting the install directory and clicking install, I wish for the contained files to be extracted to the chosen installation directory, however I can not find out how to store the files that I need extracting within the installer.

",delphi,installer,,,,,open,0,91,3,"Creating an installer I was just trying to make an installer. What is the best way to handle storing files in the exe file and then extracting them to the installation directory?

For example, I have my installer.exe file, I want it to contain the following:

 - Main executable file
 - 3 x *.db files 

Upon selecting the install directory and clicking install, I wish for the contained files to be extracted to the chosen installation directory, however I can not find out how to store the files that I need extracting within the installer.

",2
4146667,11/10/2010 16:31:59,55350,01/15/2009 08:50:30,974,34,Can you recommend some IDE experts?,"Looking for some useful Delphi IDE experts but don't have time to evaluate them all. Can you recommend some? BTW, I use Delphi 5.",delphi,,,,,06/12/2012 13:51:09,not constructive,1,24,6,"Can you recommend some IDE experts? Looking for some useful Delphi IDE experts but don't have time to evaluate them all. Can you recommend some? BTW, I use Delphi 5.",1
5450697,03/27/2011 16:52:56,679132,03/27/2011 16:52:56,1,0,methods of saving websites.,"I am comparing 2 database pages in delphi. I review 2 pages at the same time with 2 seperate webbrowsers. My problem is that sometimes you have the same page but with difference values filled in the fields. Because it is a database of course. What I want to do is save the general page, where I know that the page has the same element etc. 

My question is difficult to ask because I find it difficult to explain it. But what is easiest to extract from a website such as title, or ip address or anything else which would allow me to save it under that name. I have tried title, but the title can change due to the change of values on the database page it does not work anymore.

Anyone have any ideas on how to save it. Any feedback would be great. maybe the more people the more I can find the answer to this very odd question.",delphi,website,,,,04/09/2011 07:11:29,not a real question,1,161,4,"methods of saving websites. I am comparing 2 database pages in delphi. I review 2 pages at the same time with 2 seperate webbrowsers. My problem is that sometimes you have the same page but with difference values filled in the fields. Because it is a database of course. What I want to do is save the general page, where I know that the page has the same element etc. 

My question is difficult to ask because I find it difficult to explain it. But what is easiest to extract from a website such as title, or ip address or anything else which would allow me to save it under that name. I have tried title, but the title can change due to the change of values on the database page it does not work anymore.

Anyone have any ideas on how to save it. Any feedback would be great. maybe the more people the more I can find the answer to this very odd question.",2
11311677,07/03/2012 13:12:02,1498879,07/03/2012 13:08:38,1,0,Performance slowdown after porting Delphi 7 application to Delphi 2007,"I recently ported a legacy Delphi 7 app to Delphi 2007.  My users have been complaining that portions of the application are significantly slower in the new version.  I did upgrade to newer versions of Developer Express components in teh port, but since then I've reverted back and the slowdown still occurs, so i believe i've eliminated DevExpress as the cause.  Other than that, the code is probably >98% the same.  What could possibly cause a performance slowdown in D2007????  I've been using 2007 for years without any issues like this.

Help!

Alan Olson",delphi,delphi-7,delphi-2007,,,07/03/2012 14:52:09,not a real question,1,97,10,"Performance slowdown after porting Delphi 7 application to Delphi 2007 I recently ported a legacy Delphi 7 app to Delphi 2007.  My users have been complaining that portions of the application are significantly slower in the new version.  I did upgrade to newer versions of Developer Express components in teh port, but since then I've reverted back and the slowdown still occurs, so i believe i've eliminated DevExpress as the cause.  Other than that, the code is probably >98% the same.  What could possibly cause a performance slowdown in D2007????  I've been using 2007 for years without any issues like this.

Help!

Alan Olson",3
9612925,03/08/2012 04:32:48,65886,02/13/2009 04:16:03,793,2,What features do you put on all your main forms?,"I'm tired of writing the same code over and over; I'd like to create a (main) form with components, code, etc. that will become part of every application I create. (Think visual form inheritance.) ... What features would you include?

I like my forms to save their position and size via config files, for example, so I'll include that feature. I'll probably also include the ability for the form to go full screen with the F11 key. 

What else do you include? ",delphi,,,,,03/09/2012 01:42:51,not constructive,1,82,10,"What features do you put on all your main forms? I'm tired of writing the same code over and over; I'd like to create a (main) form with components, code, etc. that will become part of every application I create. (Think visual form inheritance.) ... What features would you include?

I like my forms to save their position and size via config files, for example, so I'll include that feature. I'll probably also include the ability for the form to go full screen with the F11 key. 

What else do you include? ",1
1970406,12/28/2009 16:58:23,32914,10/30/2008 22:10:38,11621,279,"Looking for a free, customizable DB grid","I'm working on converting the codebase of an ""open-source"" project to somthing that will actually work.  I put the term in quotes because what the original authors did was take a commercial product and say ""OK, we've made enough money off this now.  Here's the source code.  Do whatever you'd like to with it.""  Unfortunately, the codebase as-is requires over $1000 of proprietary component libraries to compile.

I've carefully worked most of the proprietary stuff out, except for one major exception.  It uses the InfoPower TwwDBGrid quite a bit.  In one important place, it has a grid that displays a name column and several checkboxes, and both the background color and the text color of the name column can be customized for each individual record.

I've got the code to do this in the Infopower grid, and it would be trivial to reimplement for a DevEx grid, but I just can't seem to find an open-source grid that ca handle it.  I don't need the full power of the InfoPower grid, but I do need a DB grid that will let you specify column types, such as a checkbox column, and that has an event handler for coloring cells at draw-time.

Does anyone know of a grid that meets these requirements?  I'd really prefer not to have to do something ugly, like hacking it with a TdbCtrlGrid, if I can avoid it...",delphi,dbgrid,open-source,,,,open,0,237,7,"Looking for a free, customizable DB grid I'm working on converting the codebase of an ""open-source"" project to somthing that will actually work.  I put the term in quotes because what the original authors did was take a commercial product and say ""OK, we've made enough money off this now.  Here's the source code.  Do whatever you'd like to with it.""  Unfortunately, the codebase as-is requires over $1000 of proprietary component libraries to compile.

I've carefully worked most of the proprietary stuff out, except for one major exception.  It uses the InfoPower TwwDBGrid quite a bit.  In one important place, it has a grid that displays a name column and several checkboxes, and both the background color and the text color of the name column can be customized for each individual record.

I've got the code to do this in the Infopower grid, and it would be trivial to reimplement for a DevEx grid, but I just can't seem to find an open-source grid that ca handle it.  I don't need the full power of the InfoPower grid, but I do need a DB grid that will let you specify column types, such as a checkbox column, and that has an event handler for coloring cells at draw-time.

Does anyone know of a grid that meets these requirements?  I'd really prefer not to have to do something ugly, like hacking it with a TdbCtrlGrid, if I can avoid it...",3
11017354,06/13/2012 14:42:09,19224,09/19/2008 19:29:32,5643,48,Configures locale not being considered,"My softwar relies in the windows locale configuration to work properly.

My customers have always the pt-br locale setted up and it works fine that way.

In one user´s windows there is the pt-br locale setted properly but somehow my software gets all the us configurations. (. as decimal sepparator, $ as currency symbol and so on).

Is there any way for me to force the locale globally in my software?",delphi,localization,delphi-7,,,,open,0,68,5,"Configures locale not being considered My softwar relies in the windows locale configuration to work properly.

My customers have always the pt-br locale setted up and it works fine that way.

In one user´s windows there is the pt-br locale setted properly but somehow my software gets all the us configurations. (. as decimal sepparator, $ as currency symbol and so on).

Is there any way for me to force the locale globally in my software?",3
1118736,07/13/2009 10:35:21,81800,03/24/2009 05:02:28,877,21,Is it possible to create a type method in Delphi?,"It's possible to create a type idenitifier for example:

    type PByte = ^Byte;

Is it possible to do the following:

    function a:shortint;
    begin
      Exit(8);
    end;

    type b = a;

so you can call ""b"" and ""a"". Is it possible?

I'm asking,because I'd like to replace ""Exit"" with ""return"" so I can call this:

    return(5);// for example",delphi,types,methods,,,,open,0,76,10,"Is it possible to create a type method in Delphi? It's possible to create a type idenitifier for example:

    type PByte = ^Byte;

Is it possible to do the following:

    function a:shortint;
    begin
      Exit(8);
    end;

    type b = a;

so you can call ""b"" and ""a"". Is it possible?

I'm asking,because I'd like to replace ""Exit"" with ""return"" so I can call this:

    return(5);// for example",3
2525461,03/26/2010 17:43:41,165960,08/31/2009 11:35:00,5,2,How reduce dll size again,"My dll have been bigger multiplied up many times than early for some reason. I begining to size up the situation:

 1. A source hasn't changed.
 3. Debug information everywhere turned off. 
 2. Dll use package ""Pack"", but not include in Runtime Packages options.
 3. I've compared new dll with old version dll thought the instrumentality of PE Explore. In new dll I find out many modules with prefix 'ec' implicitly imported unlike old dll. 
 4. Package ""Pack"" using ecControls components
 5. Dll doesn't using explicitly call to ecControls units. 


Why ecControls units imported in dll? Have anybody some advice?

",delphi,delphi-7,,,,,open,0,102,5,"How reduce dll size again My dll have been bigger multiplied up many times than early for some reason. I begining to size up the situation:

 1. A source hasn't changed.
 3. Debug information everywhere turned off. 
 2. Dll use package ""Pack"", but not include in Runtime Packages options.
 3. I've compared new dll with old version dll thought the instrumentality of PE Explore. In new dll I find out many modules with prefix 'ec' implicitly imported unlike old dll. 
 4. Package ""Pack"" using ecControls components
 5. Dll doesn't using explicitly call to ecControls units. 


Why ecControls units imported in dll? Have anybody some advice?

",2
612587,03/04/2009 21:44:50,3032,08/26/2008 12:53:59,630,32,Is it possible to install multiple instances of the same delphi service application?,"I have a service application built in Delphi that works great.  It does exactly what I want it to do and all is happy.  All is fine until I want to run two (or more) instances of that service on a single machine.  Since the service name is hard coded into the program (via the DisplayName property of the service), I can only install the service once on any given computer.  If I try to modify the DisplayName property at run-time, I get all kinds of ugly error messages.

I have done a workaround for this where I have all of the code that is not interacting directly with the service control manager encapsulated out into separate unit(s).  Then I write a separate Delphi project for each instance that I want of the service that has just enough code to launch itself and start running the main code.

This method is, in my opinion, ugly and is certainly inefficient.  It works okay for two instances, but then we need a third and a fourth and ...

Is there any way that I can modify my code so that I have just one Delphi project that can install and run itself as multiple service instances with some simple run-time input (e.g. command line flag)?",delphi,windows-services,,,,,open,0,216,13,"Is it possible to install multiple instances of the same delphi service application? I have a service application built in Delphi that works great.  It does exactly what I want it to do and all is happy.  All is fine until I want to run two (or more) instances of that service on a single machine.  Since the service name is hard coded into the program (via the DisplayName property of the service), I can only install the service once on any given computer.  If I try to modify the DisplayName property at run-time, I get all kinds of ugly error messages.

I have done a workaround for this where I have all of the code that is not interacting directly with the service control manager encapsulated out into separate unit(s).  Then I write a separate Delphi project for each instance that I want of the service that has just enough code to launch itself and start running the main code.

This method is, in my opinion, ugly and is certainly inefficient.  It works okay for two instances, but then we need a third and a fourth and ...

Is there any way that I can modify my code so that I have just one Delphi project that can install and run itself as multiple service instances with some simple run-time input (e.g. command line flag)?",2
6380158,06/17/2011 00:27:49,701267,04/10/2011 21:30:41,91,0,Sending anonymous data,"I see and use some software that as this option.

How exactly those this work? How those it send and is it collected?

I like to implement a small test.
",delphi,feedback,,,,06/17/2011 06:43:49,not a real question,1,28,3,"Sending anonymous data I see and use some software that as this option.

How exactly those this work? How those it send and is it collected?

I like to implement a small test.
",2
10901845,06/05/2012 17:19:39,781517,06/02/2011 16:43:39,310,13,Should we prefix class fields in Delphi?,"As said in Uncle Bob's Clean Code, we shouldn't prefix class fields. Although I totally agree with the arguments, talking specifically about Delphi, how would we differentiate private fields from public properties?

In Java that's not a problem, since there are no properties.

Microsoft also recommends this practice in big bold letters in their [Coding Guidelines][1]. They make the distinction by using lowercase for the private field and uppercase for the public property.

In addition to that, we don't have syntax highlight to field members like other IDEs (Free and Open Source IDEs included...)

So, should we prefix all of our fields? Or just the ones that collide with public properties? Does it mean that Delphi code cannot be ""as clean"" as code written in other languages?


  [1]: http://msdn.microsoft.com/en-us/library/ms229012",delphi,coding-style,,,,06/06/2012 01:28:00,not constructive,1,126,7,"Should we prefix class fields in Delphi? As said in Uncle Bob's Clean Code, we shouldn't prefix class fields. Although I totally agree with the arguments, talking specifically about Delphi, how would we differentiate private fields from public properties?

In Java that's not a problem, since there are no properties.

Microsoft also recommends this practice in big bold letters in their [Coding Guidelines][1]. They make the distinction by using lowercase for the private field and uppercase for the public property.

In addition to that, we don't have syntax highlight to field members like other IDEs (Free and Open Source IDEs included...)

So, should we prefix all of our fields? Or just the ones that collide with public properties? Does it mean that Delphi code cannot be ""as clean"" as code written in other languages?


  [1]: http://msdn.microsoft.com/en-us/library/ms229012",2
551932,02/16/2009 00:42:25,48705,12/23/2008 17:57:58,183,6,Is it possible to use WPF and Delphi 2007/09 win32?,Is it?! Possible?,delphi,wpf,,,,,open,0,3,10,Is it possible to use WPF and Delphi 2007/09 win32? Is it?! Possible?,2
10973204,06/10/2012 23:32:45,346571,01/22/2010 23:26:48,2964,80,"Replace crHourGlass with the new Windows 7 ""snake eating its tail"" cursor","My Delphi XE2 apps look a bit dated these days because they use:

     Screen.Cursor := crHourglass;

Is there a way to change the cursor to the the more modern looking rotating ""snake eating its tail"" icon that Windows uses?

Other than this http://stackoverflow.com/questions/6122128/am-i-restricted-to-the-cursor-numbers-defined-in-controls-pas-under-delphi-7 I haven't been able to find anything on SO or Google that addresses this.

",delphi,,,,,06/11/2012 16:47:57,not a real question,1,59,12,"Replace crHourGlass with the new Windows 7 ""snake eating its tail"" cursor My Delphi XE2 apps look a bit dated these days because they use:

     Screen.Cursor := crHourglass;

Is there a way to change the cursor to the the more modern looking rotating ""snake eating its tail"" icon that Windows uses?

Other than this http://stackoverflow.com/questions/6122128/am-i-restricted-to-the-cursor-numbers-defined-in-controls-pas-under-delphi-7 I haven't been able to find anything on SO or Google that addresses this.

",1
10125444,04/12/2012 14:18:03,622097,02/17/2011 20:41:53,379,2,How detect the correct modification of a file?,"In a [previous question][1] one of my questions was how my application could know that a file has been rewritten. I should have added: ""by another application"". First I tried [ShellNotify][2] which reports changes in a directory but not in a specific file afaik, am I missing something?

Now I use FileAge in a timer that checks each second whether a specific file has changed. While that works it detects *two* modifications, about 13 ms apart; this behavior persists when I change the testing interval to 10 seconds. The code below is the callback of the timer.

    procedure TAMI_Column_Selector.doWork (Sender: TObject);
    var new_stamp: TDateTime;
    begin
       if FileAge (remove_extension (FileName) + '.csv', new_stamp) then
       begin
          if (new_stamp <> FDateTimeStamp) then
          begin
             FDateTimeStamp := new_stamp;
             FTask.SyncCall (notify_user);
          end; // if
       end; // if
    end; // doWork //

My questions:

 1. What exactly does cause the `notify_user` to be called twice in the code above? A dumb mistake or some strange behavior of the file system (e.g. the modification date is set on opening and on closing the file)?
 2. It feels kind of ""wasteful"" to check each second whether a file has changed. Is there something like ShellNotify that notifies me only when a specific file has been modified?

Thanks very much in advance.

Using Delphi XE on Windows 7.

  [1]: http://stackoverflow.com/questions/9983060/how-to-write-a-file-that-is-being-read
  [2]: http://delphikingdom.torry.net/authorsmore.php?id=6057
",delphi,file-io,datemodified,,,,open,0,301,8,"How detect the correct modification of a file? In a [previous question][1] one of my questions was how my application could know that a file has been rewritten. I should have added: ""by another application"". First I tried [ShellNotify][2] which reports changes in a directory but not in a specific file afaik, am I missing something?

Now I use FileAge in a timer that checks each second whether a specific file has changed. While that works it detects *two* modifications, about 13 ms apart; this behavior persists when I change the testing interval to 10 seconds. The code below is the callback of the timer.

    procedure TAMI_Column_Selector.doWork (Sender: TObject);
    var new_stamp: TDateTime;
    begin
       if FileAge (remove_extension (FileName) + '.csv', new_stamp) then
       begin
          if (new_stamp <> FDateTimeStamp) then
          begin
             FDateTimeStamp := new_stamp;
             FTask.SyncCall (notify_user);
          end; // if
       end; // if
    end; // doWork //

My questions:

 1. What exactly does cause the `notify_user` to be called twice in the code above? A dumb mistake or some strange behavior of the file system (e.g. the modification date is set on opening and on closing the file)?
 2. It feels kind of ""wasteful"" to check each second whether a file has changed. Is there something like ShellNotify that notifies me only when a specific file has been modified?

Thanks very much in advance.

Using Delphi XE on Windows 7.

  [1]: http://stackoverflow.com/questions/9983060/how-to-write-a-file-that-is-being-read
  [2]: http://delphikingdom.torry.net/authorsmore.php?id=6057
",3
7277012,09/01/2011 21:54:56,924316,09/01/2011 21:54:56,1,0,Sorting in Multi-Dimensional Arrays?,"How can I sort a 2-Dimensional Array? Column one, ascending order?

Any help would be greatly appreciated.",delphi,,,,,09/02/2011 07:33:34,not a real question,1,16,4,"Sorting in Multi-Dimensional Arrays? How can I sort a 2-Dimensional Array? Column one, ascending order?

Any help would be greatly appreciated.",1
9995185,04/03/2012 14:18:34,418198,08/12/2010 09:06:38,849,22,"""class TADOConnection not found."" in fresh install of delphi xe2","Installed a fresh Delphi xe2.

Open a new project (vcl forms application). opened the pallets and looked for TADOConnection, there is no such component.

Tired to repair the Delphi xe2 installation. no change.

Any way To resolve this?",delphi,delphi-xe2,,,,,open,0,35,10,"""class TADOConnection not found."" in fresh install of delphi xe2 Installed a fresh Delphi xe2.

Open a new project (vcl forms application). opened the pallets and looked for TADOConnection, there is no such component.

Tired to repair the Delphi xe2 installation. no change.

Any way To resolve this?",2
2927268,05/28/2010 07:19:46,352650,05/28/2010 07:19:46,1,0,Delphi: Multiple tokens edit component,"I'm looking for an enchanced edit component that allow users to input multiple tokens (items) manually separated by some symbol, or to select them from another source.

It's something like ""TO"" field in outlook or facebook that allow you to input multiple recipients.

Can anyone suggest any solution?

Thanks in advice!",delphi,input,edit,token,,,open,0,48,5,"Delphi: Multiple tokens edit component I'm looking for an enchanced edit component that allow users to input multiple tokens (items) manually separated by some symbol, or to select them from another source.

It's something like ""TO"" field in outlook or facebook that allow you to input multiple recipients.

Can anyone suggest any solution?

Thanks in advice!",4
72562,09/16/2008 14:00:10,11300,09/16/2008 06:58:13,1,0,Exception handling in Delphi,"Is there a good way to find out which exceptions a procedure/function can raise in Delphi (including it's called procedures/functions)? 

In Java you always have to declare which exceptions that can be thrown, but this is not the case in Delphi, which could lead to unhandled exceptions. 

Are there any code analysis tools that detects unhandled exceptions?",delphi,exception-handling,,,,,open,0,57,4,"Exception handling in Delphi Is there a good way to find out which exceptions a procedure/function can raise in Delphi (including it's called procedures/functions)? 

In Java you always have to declare which exceptions that can be thrown, but this is not the case in Delphi, which could lead to unhandled exceptions. 

Are there any code analysis tools that detects unhandled exceptions?",2
692152,03/28/2009 03:54:05,1724,08/18/2008 10:56:42,23,0,Delphi 2007 (or 2009)  build events tied to build configurations ? ,"Is it possible to add build events only for a specific build configuration in Delphi 2007 ?

I use 2007 but would be interested in what you can do in 2009 also.

Cheers
Sam",delphi,delphi-2007,,,,,open,0,31,13,"Delphi 2007 (or 2009)  build events tied to build configurations ?  Is it possible to add build events only for a specific build configuration in Delphi 2007 ?

I use 2007 but would be interested in what you can do in 2009 also.

Cheers
Sam",2
8650682,12/28/2011 00:29:14,435406,08/30/2010 22:28:45,302,0,Delphi DBase III component,"Hi could anyone recommend a free component that I can use to load dbase III tables into Delphi, preferably without using the BDE.

Something like TTable but for Dbase

thanks

colin",delphi,dbase,,,,,open,0,28,4,"Delphi DBase III component Hi could anyone recommend a free component that I can use to load dbase III tables into Delphi, preferably without using the BDE.

Something like TTable but for Dbase

thanks

colin",2
6884919,07/30/2011 17:49:47,303367,03/27/2010 22:12:19,378,7,Is there a better TGridPanel somewhere?,has any 3rd party developer created a component similiar to Delphi's GridPanel? But better? Easier?,delphi,gridpanel,,,,,open,0,15,6,Is there a better TGridPanel somewhere? has any 3rd party developer created a component similiar to Delphi's GridPanel? But better? Easier?,2
760348,04/17/2009 13:10:21,86235,04/02/2009 14:50:20,16,1,"Getting ""Invalid Floating Point"" error with ActiveX Control in Delphi","A vendor has developed an ActiveX control in Microsoft C++.  The ActiveX worked fine when they were using the 16bit version of the compiler.  The control does not work when compiled using the 32bit version within the Delphi2007/D7 environments.  If you drop a control on a form and run it throws an ""Floating Point Error"".

It is a Delphi issue.  We are able to use the ActiveX in other applications.

Anyone ever have a similar problem or have a solution for this?",delphi,,,,,,open,0,84,10,"Getting ""Invalid Floating Point"" error with ActiveX Control in Delphi A vendor has developed an ActiveX control in Microsoft C++.  The ActiveX worked fine when they were using the 16bit version of the compiler.  The control does not work when compiled using the 32bit version within the Delphi2007/D7 environments.  If you drop a control on a form and run it throws an ""Floating Point Error"".

It is a Delphi issue.  We are able to use the ActiveX in other applications.

Anyone ever have a similar problem or have a solution for this?",1
370849,12/16/2008 10:00:33,17560,09/18/2008 11:39:52,326,16,Are there any podcast about Delphi ?,Were can I find some good Podcasts that talk about program with Delphi & the whole software lifecycle  ,delphi,,,,,09/18/2011 02:56:03,not constructive,1,20,7,Are there any podcast about Delphi ? Were can I find some good Podcasts that talk about program with Delphi & the whole software lifecycle  ,1
4963974,02/10/2011 23:36:15,47012,11/06/2008 19:21:05,1827,75,How to keep Delphi App IDE target folder in track with installer default between 32 and 64-bit ,"It's easiest when developing in the IDE to work with a Application target folder in the default location into which it will be installed e.g:

    ""c:\Program Files\MyAppFolder""

As a result, I have ""c:\Program Files\MyAppFolder"" coded into the Delphi project's 'Output directory' and I can prepare for development by running my installer (Innosetup) which populates that folder with supporting data files etc.

Now I'm moving between Windows7 64 and Windows 7 32 and my installer wants to put it's (32-bit) app into ""c:\Program Files (x86)"", so I need to point my IDE output at:

    ""c:\Program Files (86)\MyAppFolder""

This would be a change required in each project. Is there a predefined variable that I can use or some other method that would allow me to move between platforms with a 32-bit app?





",delphi,32bit-64bit,innosetup,,,,open,0,133,18,"How to keep Delphi App IDE target folder in track with installer default between 32 and 64-bit  It's easiest when developing in the IDE to work with a Application target folder in the default location into which it will be installed e.g:

    ""c:\Program Files\MyAppFolder""

As a result, I have ""c:\Program Files\MyAppFolder"" coded into the Delphi project's 'Output directory' and I can prepare for development by running my installer (Innosetup) which populates that folder with supporting data files etc.

Now I'm moving between Windows7 64 and Windows 7 32 and my installer wants to put it's (32-bit) app into ""c:\Program Files (x86)"", so I need to point my IDE output at:

    ""c:\Program Files (86)\MyAppFolder""

This would be a change required in each project. Is there a predefined variable that I can use or some other method that would allow me to move between platforms with a 32-bit app?





",3
8614071,12/23/2011 09:08:23,292186,03/12/2010 08:14:35,110,0,Delphi read text file separated by CR character only,"I have a big text file (about 100MB) and each lines are separated by CR character, and not CRLF.

I tried to read this text file, line by line using TStringList.LoadFromFile() or ReadLn(F,..), but both methods require the lines are separated by CRLF.

Do you have any efficient and fast method to read this kind of text file?

Thanks.

PS: I am using Delphi 7.",delphi,delphi-7,text-files,,,,open,0,61,9,"Delphi read text file separated by CR character only I have a big text file (about 100MB) and each lines are separated by CR character, and not CRLF.

I tried to read this text file, line by line using TStringList.LoadFromFile() or ReadLn(F,..), but both methods require the lines are separated by CRLF.

Do you have any efficient and fast method to read this kind of text file?

Thanks.

PS: I am using Delphi 7.",3
10564736,05/12/2012 14:49:02,284628,03/02/2010 17:46:54,2355,23,Improve compression ratio with Delphi 6 app that uses the Windows AVIFile functions?,"I have a Delphi 6 app that makes movies from an incoming video and audio stream from a robot.  The PC receives the video stream as a series of JPEG frames and the audio as blocks of PCM audio data.  I am using the Windows AVIFile functions (AVIStreamCreate, etc.) to create the movie.  For the choice of video compressor I use the AVISaveOptions() function and let the user select one of the available compressors from those available on their system.  For example: Microsoft Video 1, Cinepak Code by Radius, etc.  Note several of the other available ones, like Microsoft H.263 or H.261 fail with AVIERR_BADFORMAT errors so I could not test with them.  The audio is compressed using the GSM 6.10 compressor.

The problem is I can't seem to get near the compression ratio that I can using a tool like Adobe Premiere for comparison.  Note, I am aware that Premiere is compressing using a different overall process than mine, and to a different file format like MPEG, or Quicktime, etc.  But I would like to get a comparable compression ratio if I can.

No matter which compressor I choose from AVISaveOptions(), and no matter how low I crank the available compression quality settings for the compressor (for example, Temporal Quality Ratio & Compression Quality for Microsoft Video 1), a minutes worth of video always ends up creating an AVI file of approximately 14MB in size.  For comparison, the file I can create using Adobe Premiere is less than 1 MB in size and looks about the same *visual* quality (in other words, good enough for my purposes.  I don't care about actual quality loss here.).

If I examine the file output from my usage of the Windows AVI API I see that none of the settings I change with the compressor affect the frame rate.  It is always identical to the input frame rate. Now if necessary obviously I can drop frames on the input side, but that would be a bit messy since it is synced to the audio and I'd like to avoid that if I could.

But more importantly is the Data rate.  I can never get that below approximately 2.3 kbps no matter how low I crank the compressor settings down.  The videos I create with Premiere, and other videos I've played with that have a healthy file size to duration ratio, are all about 1.2 kbps.

Overall the difference in between the file size of my AVI files and the ones I create with Premiere or other people have sent to me that compress well is **10 to 1**.  Therefore my compression ratio is 10 times worse than other video files, and those other files have no unpleasant difference in their video quality.

What can I do to get a comparable compression ratio?

",delphi,winapi,avi,compressor,,,open,0,477,13,"Improve compression ratio with Delphi 6 app that uses the Windows AVIFile functions? I have a Delphi 6 app that makes movies from an incoming video and audio stream from a robot.  The PC receives the video stream as a series of JPEG frames and the audio as blocks of PCM audio data.  I am using the Windows AVIFile functions (AVIStreamCreate, etc.) to create the movie.  For the choice of video compressor I use the AVISaveOptions() function and let the user select one of the available compressors from those available on their system.  For example: Microsoft Video 1, Cinepak Code by Radius, etc.  Note several of the other available ones, like Microsoft H.263 or H.261 fail with AVIERR_BADFORMAT errors so I could not test with them.  The audio is compressed using the GSM 6.10 compressor.

The problem is I can't seem to get near the compression ratio that I can using a tool like Adobe Premiere for comparison.  Note, I am aware that Premiere is compressing using a different overall process than mine, and to a different file format like MPEG, or Quicktime, etc.  But I would like to get a comparable compression ratio if I can.

No matter which compressor I choose from AVISaveOptions(), and no matter how low I crank the available compression quality settings for the compressor (for example, Temporal Quality Ratio & Compression Quality for Microsoft Video 1), a minutes worth of video always ends up creating an AVI file of approximately 14MB in size.  For comparison, the file I can create using Adobe Premiere is less than 1 MB in size and looks about the same *visual* quality (in other words, good enough for my purposes.  I don't care about actual quality loss here.).

If I examine the file output from my usage of the Windows AVI API I see that none of the settings I change with the compressor affect the frame rate.  It is always identical to the input frame rate. Now if necessary obviously I can drop frames on the input side, but that would be a bit messy since it is synced to the audio and I'd like to avoid that if I could.

But more importantly is the Data rate.  I can never get that below approximately 2.3 kbps no matter how low I crank the compressor settings down.  The videos I create with Premiere, and other videos I've played with that have a healthy file size to duration ratio, are all about 1.2 kbps.

Overall the difference in between the file size of my AVI files and the ones I create with Premiere or other people have sent to me that compress well is **10 to 1**.  Therefore my compression ratio is 10 times worse than other video files, and those other files have no unpleasant difference in their video quality.

What can I do to get a comparable compression ratio?

",4
6705569,07/15/2011 10:18:30,197442,10/27/2009 15:39:59,62,0,Any content repository for Delphi?,"I'm looking for a Delphi content repository similar to Apache Jackrabbit™ content repository.
Or at least for a 
",delphi,jackrabbit,content-repository,,,07/15/2011 15:37:22,not constructive,1,18,5,"Any content repository for Delphi? I'm looking for a Delphi content repository similar to Apache Jackrabbit™ content repository.
Or at least for a 
",3
8104058,11/12/2011 11:08:59,872578,08/01/2011 10:04:30,339,3,Copy a generics list from a class to other.,"i have a small problem. I have two class:

    type
      MyClass1 = class
      private
        oMyList: TMyList
      public
        property MyList: TMyList read oMyList;
      end;

and:

    type
      MyClass2 = class
      private
        oMyList: TMyList
      public
        property MyList: TMyList write oMyList;
      end;

I want copy MyList from MyClass1 to MyClass2 and i do:

    ...
      MyClass2.MyList := MyClass1.MyList;
    ...

if i do: 

    writeln (MyClass2.MyList.Count) 

i read number of element on MyList correctly. If i try to do same in class: MyClass2 for example:

    ...
    procedure MyClass2.GetInfo
    begin
      writeln (oMyList.Count);
    end;
    ...

it raise this error: **""Access violation at address XXXXXXXX in module 'XXXXXXXXXX'. Read of address: XXXXXXXX.""**.
So i don't understood as i can solve, not find error.
So i ask, as i can copy a Generics List from a class to other?
Thanks again for help.





",delphi,delphi-xe2,,,,11/12/2011 15:22:07,not a real question,1,234,9,"Copy a generics list from a class to other. i have a small problem. I have two class:

    type
      MyClass1 = class
      private
        oMyList: TMyList
      public
        property MyList: TMyList read oMyList;
      end;

and:

    type
      MyClass2 = class
      private
        oMyList: TMyList
      public
        property MyList: TMyList write oMyList;
      end;

I want copy MyList from MyClass1 to MyClass2 and i do:

    ...
      MyClass2.MyList := MyClass1.MyList;
    ...

if i do: 

    writeln (MyClass2.MyList.Count) 

i read number of element on MyList correctly. If i try to do same in class: MyClass2 for example:

    ...
    procedure MyClass2.GetInfo
    begin
      writeln (oMyList.Count);
    end;
    ...

it raise this error: **""Access violation at address XXXXXXXX in module 'XXXXXXXXXX'. Read of address: XXXXXXXX.""**.
So i don't understood as i can solve, not find error.
So i ask, as i can copy a Generics List from a class to other?
Thanks again for help.





",2
7663055,10/05/2011 14:38:04,121183,06/11/2009 09:06:27,89,2,delphi tserversocket ignores 1st message,"pls advise why this happens.
on a simple sample server app i have the following code:

    procedure TForm13.ServerSocket1ClientRead(Sender: TObject;
    Socket: TCustomWinSocket);
    var str : string;
    begin
      str := socket.ReceiveText;
      showmessage(str);
    end;

and on the client side i have

    clientsocket1.Open;
    clientsocket1.Socket.SendText(txtMSG.Text);

nothing fancy.
the strange thing is that when i send a message to the server for 1st time it gets ignored. every time after that it works great. the ClientRead event doesn't fire off at all on the 1st message

what can i change on the server to make it accept the 1st message.
I have no control over the client side as a 3rd party sends me messages, ut i am always missing the 1st message.

thanks!",delphi,sockets,tcp,,,,open,0,142,5,"delphi tserversocket ignores 1st message pls advise why this happens.
on a simple sample server app i have the following code:

    procedure TForm13.ServerSocket1ClientRead(Sender: TObject;
    Socket: TCustomWinSocket);
    var str : string;
    begin
      str := socket.ReceiveText;
      showmessage(str);
    end;

and on the client side i have

    clientsocket1.Open;
    clientsocket1.Socket.SendText(txtMSG.Text);

nothing fancy.
the strange thing is that when i send a message to the server for 1st time it gets ignored. every time after that it works great. the ClientRead event doesn't fire off at all on the 1st message

what can i change on the server to make it accept the 1st message.
I have no control over the client side as a 3rd party sends me messages, ut i am always missing the 1st message.

thanks!",3
4914471,02/06/2011 16:16:59,39664,11/21/2008 13:46:55,37,1,Equivalent of an 'AutoInsert' property for a datasource?,"Sorry if the question seems vague, please let me explain.

I have two datasets, called, say, Master and Extensions. They have a same primary key, but not all Master records have an Extensions record (this is the important point).

The UI are the usual data aware controls linked by datasources, placed in a TPageControl, with a page/tab for each dataset. A TDBNavigator linked to the Master dataset allows the user to browse through the records.

The user could be on the Extensions page/tab while browsing, and may want to edit the Extensions record data. If an Extension record already exists, all's well and good because the AutoEdit property of the datasource will automatically place the dataset into edit mode.

But what if there is no Extensions record? I suppose I need the equivalent of an 'AutoInsert' property, that would automatically place the dataset in Insert mode if the user starts to typing in one of the controls. (and I can always set up the primary key in the BeforeInsert event).

Any thoughts how I would achieve this?

Thanks for any advice, and thanks for reading a long question,
Regards
PhilW.",delphi,datasource,,,,,open,0,182,8,"Equivalent of an 'AutoInsert' property for a datasource? Sorry if the question seems vague, please let me explain.

I have two datasets, called, say, Master and Extensions. They have a same primary key, but not all Master records have an Extensions record (this is the important point).

The UI are the usual data aware controls linked by datasources, placed in a TPageControl, with a page/tab for each dataset. A TDBNavigator linked to the Master dataset allows the user to browse through the records.

The user could be on the Extensions page/tab while browsing, and may want to edit the Extensions record data. If an Extension record already exists, all's well and good because the AutoEdit property of the datasource will automatically place the dataset into edit mode.

But what if there is no Extensions record? I suppose I need the equivalent of an 'AutoInsert' property, that would automatically place the dataset in Insert mode if the user starts to typing in one of the controls. (and I can always set up the primary key in the BeforeInsert event).

Any thoughts how I would achieve this?

Thanks for any advice, and thanks for reading a long question,
Regards
PhilW.",2
8555635,12/18/2011 23:18:24,988445,10/10/2011 21:32:09,721,18,Somehow accidentally mixing TEdit.Text and TLabel.Caption works without exception?,"I'm working with dynamically creating multiple different types of controls and storing them in a list in the background. Two of such controls are a TEdit and a TLabel. These controls are all sub-controls of a TPanel control.

Well I accidentally mixed up the TEdit with the TLabel when reading from TPanel.Controls (got them from the wrong indexes) when writing to the TEdit.Text and TLabel.Caption properties. Somehow, it didn't even raise any exception. 

It does something like `TLabel(SomeEditControl).Caption:= 'This is a label control';` and `TEdit(SomeLabelControl).Text:= 'This is an edit control';` And it puts the TEdit.Text data in the TLabel.Caption property, and the TLabel.Caption data in the TEdit.Text property. I'm puzzled that this didn't raise an exception... The only thing I can guess is that the TEdit.Text and TLabel.Caption properties just so happen to use the same memory address between the control classes. 

Why wouldn't this give an access violation?
",delphi,delphi-7,access-violation,,,,open,0,148,9,"Somehow accidentally mixing TEdit.Text and TLabel.Caption works without exception? I'm working with dynamically creating multiple different types of controls and storing them in a list in the background. Two of such controls are a TEdit and a TLabel. These controls are all sub-controls of a TPanel control.

Well I accidentally mixed up the TEdit with the TLabel when reading from TPanel.Controls (got them from the wrong indexes) when writing to the TEdit.Text and TLabel.Caption properties. Somehow, it didn't even raise any exception. 

It does something like `TLabel(SomeEditControl).Caption:= 'This is a label control';` and `TEdit(SomeLabelControl).Text:= 'This is an edit control';` And it puts the TEdit.Text data in the TLabel.Caption property, and the TLabel.Caption data in the TEdit.Text property. I'm puzzled that this didn't raise an exception... The only thing I can guess is that the TEdit.Text and TLabel.Caption properties just so happen to use the same memory address between the control classes. 

Why wouldn't this give an access violation?
",3
1548909,10/10/2009 19:56:29,179542,09/26/2009 18:15:52,1,1,Delphi - most succesful applications developed,"Can you name famous, succesfull applications, applications in development, future applications, that are developed with Delphi? The kind of applications that you use everyday is encouraged.


Some of i know:

 - Total Commander
 - TopStyle
 - Skype
 - PHP Designer

",delphi,application,famous,,,04/06/2012 17:26:51,not constructive,1,39,6,"Delphi - most succesful applications developed Can you name famous, succesfull applications, applications in development, future applications, that are developed with Delphi? The kind of applications that you use everyday is encouraged.


Some of i know:

 - Total Commander
 - TopStyle
 - Skype
 - PHP Designer

",3
5238303,03/08/2011 21:04:03,650492,03/08/2011 20:53:44,1,0,Delphi headers for zebra (barcode reader),"I'm looking for Delphi headers to use with the zebra lib
<http://zebra.sourceforge.net/>

I was lucky to find Delphi headers for Zbar at
<ftp://ftp.lnssoftware.ca/Delphi/zbar.pas>
which was great, but I would really like to find headers for zebra

Q1:
Can anyone point me to a download location?

Q2:
I would like to evaluate some barcode scanning solutions, so if anyone can recommend something that works in Delphi that would be great.

Cheers

-- Johan
  ",delphi,barcode,barcode-scanner,,,,open,0,64,6,"Delphi headers for zebra (barcode reader) I'm looking for Delphi headers to use with the zebra lib
<http://zebra.sourceforge.net/>

I was lucky to find Delphi headers for Zbar at
<ftp://ftp.lnssoftware.ca/Delphi/zbar.pas>
which was great, but I would really like to find headers for zebra

Q1:
Can anyone point me to a download location?

Q2:
I would like to evaluate some barcode scanning solutions, so if anyone can recommend something that works in Delphi that would be great.

Cheers

-- Johan
  ",3
6873469,07/29/2011 12:59:20,759049,05/18/2011 11:02:57,72,11,Delphi 7 - trying to understand the MVC pattern,"I am trying to understand the MVC pattern and this is what I came up with. If you could be so kind and tell me if I did it correctly, suggest some improvments, or diss me for failing completely, I'd be more than happy!

Here's a link to the project (Delphi 7): http://www.sendspace.com/file/ynpgre",delphi,mvc,,,,07/31/2011 07:39:32,not a real question,1,52,9,"Delphi 7 - trying to understand the MVC pattern I am trying to understand the MVC pattern and this is what I came up with. If you could be so kind and tell me if I did it correctly, suggest some improvments, or diss me for failing completely, I'd be more than happy!

Here's a link to the project (Delphi 7): http://www.sendspace.com/file/ynpgre",2
7817996,10/19/2011 07:38:47,943793,04/22/2011 08:15:39,1,0,Delphi & Fastreport,"In CodeGear™ Delphi® 2009  Version 12.0.3170.16989 I install Fast Report 4.8 ,and create some repoerts, In My application I use these reports like this:

    myfrxReport.ShowReport();

Now Some users want to edit report page,So I use frxDesigner.
But my problem is this : ""How can I save users changes ?""

(Excuse me for My bad English writting)",delphi,fastreport,,,,,open,0,57,3,"Delphi & Fastreport In CodeGear™ Delphi® 2009  Version 12.0.3170.16989 I install Fast Report 4.8 ,and create some repoerts, In My application I use these reports like this:

    myfrxReport.ShowReport();

Now Some users want to edit report page,So I use frxDesigner.
But my problem is this : ""How can I save users changes ?""

(Excuse me for My bad English writting)",2
5060302,02/20/2011 21:48:45,69358,02/21/2009 16:53:13,550,29,Recommended 2D Sprite engine for a Delphi board game?,"Which are the choices I should look into for a Delphi sprite engine.

I am aware of

- GLScene
- Andorra 2D

anything else I am missing?

It is best if it relies on OpenGL. DirectX only solutions are not very welcome.",delphi,opengl,sprite,engine,,,open,0,37,9,"Recommended 2D Sprite engine for a Delphi board game? Which are the choices I should look into for a Delphi sprite engine.

I am aware of

- GLScene
- Andorra 2D

anything else I am missing?

It is best if it relies on OpenGL. DirectX only solutions are not very welcome.",4
7952825,10/31/2011 11:04:30,380086,06/30/2010 13:05:49,31,3,Why do I get an invalid pointer in the TListSortCompare function when calling sort on a TList?,"I'm adding some pointers to a TList object:

    list : TList.create();
    
    // Just an example of value adding
    while not ok do
    begin
      newValue = new(MyStructurePointer);
      newValue^.val1 := 1;
      list.add(newValue);
    end;

    // Then, I'd like to sort it
    list.sort(comparisonFunction);

My comparison function looks like:

    function comparisonFunction(p1, p2 : Pointer): integer
    begin
      if (p1 = nil) or (p2 = nil) then
      begin
        if (p1 = nil) and (p2 = nil) then result := 0
        else if (p1 = nil) then result = 1
        else result := -1;

        exit;
      end;

      result := MyStructurePointer(p2)^.val1 - MyStructurePointer(p1)^.val1;
    end;

But, when evaluating p1^.val1 or p2^.val2, one of these pointers have an **invalid value** !

Any idea ?",delphi,pointers,tlist,,,11/02/2011 08:43:43,too localized,1,206,17,"Why do I get an invalid pointer in the TListSortCompare function when calling sort on a TList? I'm adding some pointers to a TList object:

    list : TList.create();
    
    // Just an example of value adding
    while not ok do
    begin
      newValue = new(MyStructurePointer);
      newValue^.val1 := 1;
      list.add(newValue);
    end;

    // Then, I'd like to sort it
    list.sort(comparisonFunction);

My comparison function looks like:

    function comparisonFunction(p1, p2 : Pointer): integer
    begin
      if (p1 = nil) or (p2 = nil) then
      begin
        if (p1 = nil) and (p2 = nil) then result := 0
        else if (p1 = nil) then result = 1
        else result := -1;

        exit;
      end;

      result := MyStructurePointer(p2)^.val1 - MyStructurePointer(p1)^.val1;
    end;

But, when evaluating p1^.val1 or p2^.val2, one of these pointers have an **invalid value** !

Any idea ?",3
3931487,10/14/2010 08:46:43,318249,04/16/2010 06:52:58,219,17,is there any other way to view youtube video on delphi?,"i see the http://www.delphiflash.com/demo-youtube-video on how to load flash video on delphi but its not for free. is there any other way?

like html then TWebBroeser?

sampleVideo.html //this will not work on TwebBrowser is there any other way?

    <html>
    <head>
    </style> 
    	<style type=""text/css"">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style> 
    </head>
    <body>
      <object width=""640"" height=""390"">
      <param name=""movie"" value=""http://www.youtube.com/v/L7NWdxFAHdY&hl=en_US&feature=player_embedded&version=3"">
      </param><param name=""allowFullScreen"" value=""true"">
      </param><param name=""allowScriptAccess"" value=""always"">
      </param><embed src=""http://www.youtube.com/v/L7NWdxFAHdY&hl=en_US&feature=player_embedded&version=3"" type=""application/x-shockwave-flash"" allowfullscreen=""true"" allowScriptAccess=""always"" width=""640"" height=""390"">
      </embed></object>
    </body>
    </html>",delphi,video,activex,youtube,flash-player,,open,0,125,11,"is there any other way to view youtube video on delphi? i see the http://www.delphiflash.com/demo-youtube-video on how to load flash video on delphi but its not for free. is there any other way?

like html then TWebBroeser?

sampleVideo.html //this will not work on TwebBrowser is there any other way?

    <html>
    <head>
    </style> 
    	<style type=""text/css"">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style> 
    </head>
    <body>
      <object width=""640"" height=""390"">
      <param name=""movie"" value=""http://www.youtube.com/v/L7NWdxFAHdY&hl=en_US&feature=player_embedded&version=3"">
      </param><param name=""allowFullScreen"" value=""true"">
      </param><param name=""allowScriptAccess"" value=""always"">
      </param><embed src=""http://www.youtube.com/v/L7NWdxFAHdY&hl=en_US&feature=player_embedded&version=3"" type=""application/x-shockwave-flash"" allowfullscreen=""true"" allowScriptAccess=""always"" width=""640"" height=""390"">
      </embed></object>
    </body>
    </html>",5
10334553,04/26/2012 13:33:46,665031,03/17/2011 20:07:30,281,1,ProcessMessages and use of application,"I need to know if use of ProcessMessages that allow me to use entire application is legal.

Pseudo code:

Main thread button call - search.

    procedure ButtonOnClick;
    begin
        var1 = ExecuteSearch();
    end;    

    function ExecuteSearch:Something;
    begin
     thread.StartThread;
     while thread.Finished do
     Application.ProcessMessages;
     result := something;
    end;


When I use this construction I can click other parts of my software and use it. But I don't know how this works. And if its safe.",delphi,,,,,,open,0,113,5,"ProcessMessages and use of application I need to know if use of ProcessMessages that allow me to use entire application is legal.

Pseudo code:

Main thread button call - search.

    procedure ButtonOnClick;
    begin
        var1 = ExecuteSearch();
    end;    

    function ExecuteSearch:Something;
    begin
     thread.StartThread;
     while thread.Finished do
     Application.ProcessMessages;
     result := something;
    end;


When I use this construction I can click other parts of my software and use it. But I don't know how this works. And if its safe.",1
10532247,05/10/2012 10:36:47,706120,04/13/2011 13:21:41,72,2,Can a modal form in Delphi be non-blocking?,"I'm looking to create a modal form in Delphi that prevents the user interface from being interacted with, but still allows execution of the other forms to continue. Is this possible?",delphi,delphi-xe,vcl,,,05/18/2012 17:23:19,not a real question,1,31,8,"Can a modal form in Delphi be non-blocking? I'm looking to create a modal form in Delphi that prevents the user interface from being interacted with, but still allows execution of the other forms to continue. Is this possible?",3
8107224,11/12/2011 20:11:00,96201,04/26/2009 13:15:43,817,27,DVD Investigation class in Delphi,"Does anyone know of a class/component FreeWare/ShareWare/BuyWare that can investigate a DVD structure (and - if possible - a BluRay structure) and return information about what is on the DVD with regards to number of titles, and title information for each title?

It must return the following information for each title:
Video Encoding (MPEG-1/MPEG-2), Video Resolution (352x240, 352x288, 480x480, 480x576, 544x480, 544x576, 704x480, 704x576, 720x480, 720x576), Anamorphic?, Duration in Seconds/milliseconds, FrameRate (23.976, 24.000, 25.000, 29.997, 30.000), Subtitle Tracks and Audio Tracks.

For each Audio Track in each individual title, the following information is needed:
Audio Format (DTS, Dolby Digital, LPCM, MPEG), Channel Count (Main Channels + Subwoofer, must be able to handle f.ex. Dolby Digital 3.1 or 4.0), Language

For each subtitle track in each individual title, the Language of the track is needed.

All this information can be obtained from the VIDEO_TS/VTS_xx_y IFO files, but I haven't been able to figure out the exact code needed that can handle all my DVDs.

I have a skeleton class located at http://www.heartware.dk/DVD.PAS that would satisfy me needs.",delphi,dvd,,,,11/13/2011 15:14:00,not constructive,1,169,5,"DVD Investigation class in Delphi Does anyone know of a class/component FreeWare/ShareWare/BuyWare that can investigate a DVD structure (and - if possible - a BluRay structure) and return information about what is on the DVD with regards to number of titles, and title information for each title?

It must return the following information for each title:
Video Encoding (MPEG-1/MPEG-2), Video Resolution (352x240, 352x288, 480x480, 480x576, 544x480, 544x576, 704x480, 704x576, 720x480, 720x576), Anamorphic?, Duration in Seconds/milliseconds, FrameRate (23.976, 24.000, 25.000, 29.997, 30.000), Subtitle Tracks and Audio Tracks.

For each Audio Track in each individual title, the following information is needed:
Audio Format (DTS, Dolby Digital, LPCM, MPEG), Channel Count (Main Channels + Subwoofer, must be able to handle f.ex. Dolby Digital 3.1 or 4.0), Language

For each subtitle track in each individual title, the Language of the track is needed.

All this information can be obtained from the VIDEO_TS/VTS_xx_y IFO files, but I haven't been able to figure out the exact code needed that can handle all my DVDs.

I have a skeleton class located at http://www.heartware.dk/DVD.PAS that would satisfy me needs.",2
6889330,07/31/2011 11:58:30,283353,03/01/2010 02:53:23,114,6,Need a Delphi component/library that allows me to encrypt/decrypt some text using RSA,"I need a component or library (as simple as possible, and no DLLs would be great) to encrypt a text, decrypt another, using public keys generated by OpenSSL.

I thought I'd use LockBox (the new version, v3), but according to other users here it's not as good as the old version, and more importantly, cannot use keys from other libraries. (see http://stackoverflow.com/questions/6702351/openssls-pem-file-and-lockbox3-interoperability)

I'm using Delphi 7. Any suggestions?",delphi,cryptography,rsa,,,,open,0,66,13,"Need a Delphi component/library that allows me to encrypt/decrypt some text using RSA I need a component or library (as simple as possible, and no DLLs would be great) to encrypt a text, decrypt another, using public keys generated by OpenSSL.

I thought I'd use LockBox (the new version, v3), but according to other users here it's not as good as the old version, and more importantly, cannot use keys from other libraries. (see http://stackoverflow.com/questions/6702351/openssls-pem-file-and-lockbox3-interoperability)

I'm using Delphi 7. Any suggestions?",3
8904896,01/18/2012 03:43:53,192910,10/20/2009 07:56:41,5529,219,Seeking simple INDY demo,"I want a simple client serer communication which I can use an underlying framework and never have to look at again. I want to concentrate on my application and have a simple functional API along the lines of:  

    SendStringFromClentToServer() : String;   // Returns the serer result string
                                              // or """" on eror (oor throws exception)
    ProcessReceivedStringAtServer();          // And send result string

 - I do need to know if the server replied or not; and, if so, what the result string was
 - It would be nice if the serer used Indy Command Handler, but not vital as I can parse the received string myself
 - also ""nice to have"" and where the INDY demos don't seem to cover it (except, reportedly, the SMTP demo, which I can't seem to find) would be for the server to initiate communication to the client. IF not, I can have the client poll, or have the server send its communication as a reply to the client heartbeat which I need to add.

Thanks a 1,000,000 in advance. A URL or name of an Indy 10 demo will suffice",delphi,indy10,,,,01/19/2012 03:57:02,not a real question,1,247,4,"Seeking simple INDY demo I want a simple client serer communication which I can use an underlying framework and never have to look at again. I want to concentrate on my application and have a simple functional API along the lines of:  

    SendStringFromClentToServer() : String;   // Returns the serer result string
                                              // or """" on eror (oor throws exception)
    ProcessReceivedStringAtServer();          // And send result string

 - I do need to know if the server replied or not; and, if so, what the result string was
 - It would be nice if the serer used Indy Command Handler, but not vital as I can parse the received string myself
 - also ""nice to have"" and where the INDY demos don't seem to cover it (except, reportedly, the SMTP demo, which I can't seem to find) would be for the server to initiate communication to the client. IF not, I can have the client poll, or have the server send its communication as a reply to the client heartbeat which I need to add.

Thanks a 1,000,000 in advance. A URL or name of an Indy 10 demo will suffice",2
9051943,01/29/2012 08:37:36,744588,05/09/2011 05:47:25,1650,81,Backport effort of Rtti.pas to Delphi versions prior to D2009 resource needed,"I'm looking for Delphi resources related to any effort to backport hopefully a *substantive subset* the new *Rtti* capabilities like [ThorRtti](http://code.google.com/p/thorrtti/).

",delphi,delphi-7,delphi-2007,rtti,backport,01/29/2012 14:26:09,not a real question,1,21,12,"Backport effort of Rtti.pas to Delphi versions prior to D2009 resource needed I'm looking for Delphi resources related to any effort to backport hopefully a *substantive subset* the new *Rtti* capabilities like [ThorRtti](http://code.google.com/p/thorrtti/).

",5
8957929,01/22/2012 00:17:12,988445,10/10/2011 21:32:09,1239,26,How to get a permanent directory from Windows for storing cached images?,"I'm building an image cache system, and one of the main things I need it to do is basically ask Windows for the best place to store my permanent cached files. I've seen many good ways of getting temp directories, but I need a permanent cache location. How do I get this from Windows?",delphi,winapi,caching,delphi-7,delphi-xe2,,open,0,54,12,"How to get a permanent directory from Windows for storing cached images? I'm building an image cache system, and one of the main things I need it to do is basically ask Windows for the best place to store my permanent cached files. I've seen many good ways of getting temp directories, but I need a permanent cache location. How do I get this from Windows?",5
7241457,08/30/2011 09:54:58,919439,08/30/2011 09:54:58,1,0,Accessing a geometry type database field from Delphi?,"I am under a POSTGRESql database using the PosGis module and i need to access a database field from a Delphi application which is a GEOMETRY type field.
By Using a FieldByName('...').AsString, it creates me an error.

Is there a way to get this data in Text/String format from SQL or in Delphi please ?

Thanks
Gwenael",delphi,postgresql,geometry,,,08/30/2011 13:52:34,not a real question,1,53,8,"Accessing a geometry type database field from Delphi? I am under a POSTGRESql database using the PosGis module and i need to access a database field from a Delphi application which is a GEOMETRY type field.
By Using a FieldByName('...').AsString, it creates me an error.

Is there a way to get this data in Text/String format from SQL or in Delphi please ?

Thanks
Gwenael",3
10371787,04/29/2012 11:34:28,1175743,01/28/2012 21:17:45,468,2,Canvas Drawing - How can I Improve this Alpha Drawing routine?,"**I am drawing onto a canvas with Opacity (Alpha Transparency) abilities like so:**

    var
      Form1: TForm1;
    
      IsDrawing: Boolean;
    
    implementation
    
    {$R *.dfm}
    
    procedure DrawOpacityBrush(ACanvas: TCanvas; X, Y: Integer; AColor: TColor; ASize: Integer; Opacity: Byte);
    var
      Bmp: TBitmap;
      I, J: Integer;
      Pixels: PRGBQuad;
      ColorRgb: Integer;
      ColorR, ColorG, ColorB: Byte;
    begin
      Bmp := TBitmap.Create;
      try
        Bmp.PixelFormat := pf32Bit; // needed for an alpha channel
        Bmp.SetSize(ASize, ASize);
    
        with Bmp.Canvas do
        begin
          Brush.Color := clFuchsia; // background color to mask out
          ColorRgb := ColorToRGB(Brush.Color);
          FillRect(Rect(0, 0, ASize, ASize));
          Pen.Color := AColor;
          Pen.Style := psSolid;
          Pen.Width := ASize;
          MoveTo(ASize div 2, ASize div 2);
          LineTo(ASize div 2, ASize div 2);
        end;
    
        ColorR := GetRValue(ColorRgb);
        ColorG := GetGValue(ColorRgb);
        ColorB := GetBValue(ColorRgb);
    
        for I := 0 to Bmp.Height-1 do
        begin
          Pixels := PRGBQuad(Bmp.ScanLine[I]);
          for J := 0 to Bmp.Width-1 do
          begin
            with Pixels^ do
            begin
              if (rgbRed = ColorR) and (rgbGreen = ColorG) and (rgbBlue = ColorB) then
                rgbReserved := 0
              else
                rgbReserved := Opacity;
              // must pre-multiply the pixel with its alpha channel before drawing
              rgbRed := (rgbRed * rgbReserved) div $FF;
              rgbGreen := (rgbGreen * rgbReserved) div $FF;
              rgbBlue := (rgbBlue * rgbReserved) div $FF;
            end;
            Inc(Pixels);
          end;
        end;
    
        ACanvas.Draw(X, Y, Bmp, 255);
      finally
        Bmp.Free;
      end;
    end;
    
    procedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    begin
      case Button of
        mbLeft:
        begin
          IsDrawing := True;
          DrawOpacityBrush(Form1.Canvas, X, Y, clRed, 50, 85);
        end;
      end;
    end;
    
    procedure TForm1.FormMouseMove(Sender: TObject; Shift: TShiftState; X,
      Y: Integer);
    begin
      if (GetAsyncKeyState(VK_LBUTTON) <> 0) and
         (IsDrawing) then
      begin
        DrawOpacityBrush(Form1.Canvas, X, Y, clRed, 50, 85);
      end;
    end;
    
    procedure TForm1.FormMouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    begin
      IsDrawing := False;
    end;

The draw `DrawOpacityBrush()` procedure was an update by Remy Lebeau on a previous question I recently asked: http://stackoverflow.com/questions/10342603/how-to-paint-on-a-canvas-with-transparency-and-opacity/10343272#10343272

While this works, the results are not satisfactory to what I now need.

Currently, every time the `DrawOpacityBrush()` procedure is called in MouseMove it keeps on drawing the brush ellipse shape. This is bad because depending on how quick you move the mouse around the canvas, the output is not as hoped.

These sample images should illustrate this better hopefully:

![enter image description here][1]

**-** The first red brush I moved the mouse pretty rapidly from the bottom of the canvas to the top.<br>
**-** The second red brush I moved a lot slower.

As you can see the opacity is drawn correctly, except that the circle keeps on drawing repeatedly as well.

**What I would like it to do instead is:**

**(1)** Paint with a opacity line around the ellipse.

**(2)** Have an option to prevent any ellipses been drawn at all.

This mock sample image should give an idea of how I would like it to be drawn:

![enter image description here][2]

The 3 purple brush lines demonstrate **option (1)**.

To achieve **option (2)** the circles inside the brush lines should not be there.

This should then allow you to take time when drawing, not frantically moving the mouse around the canvas in hope of getting the result you need. Only when you decide to go back over the brush stroke you just made will the opacity for that area become darker etc.

How can I achieve these two effects for drawing on a canvas?


  [1]: http://i.stack.imgur.com/RBmp9.png
  [2]: http://i.stack.imgur.com/DCZf0.png",delphi,delphi-xe,,,,,open,0,1120,11,"Canvas Drawing - How can I Improve this Alpha Drawing routine? **I am drawing onto a canvas with Opacity (Alpha Transparency) abilities like so:**

    var
      Form1: TForm1;
    
      IsDrawing: Boolean;
    
    implementation
    
    {$R *.dfm}
    
    procedure DrawOpacityBrush(ACanvas: TCanvas; X, Y: Integer; AColor: TColor; ASize: Integer; Opacity: Byte);
    var
      Bmp: TBitmap;
      I, J: Integer;
      Pixels: PRGBQuad;
      ColorRgb: Integer;
      ColorR, ColorG, ColorB: Byte;
    begin
      Bmp := TBitmap.Create;
      try
        Bmp.PixelFormat := pf32Bit; // needed for an alpha channel
        Bmp.SetSize(ASize, ASize);
    
        with Bmp.Canvas do
        begin
          Brush.Color := clFuchsia; // background color to mask out
          ColorRgb := ColorToRGB(Brush.Color);
          FillRect(Rect(0, 0, ASize, ASize));
          Pen.Color := AColor;
          Pen.Style := psSolid;
          Pen.Width := ASize;
          MoveTo(ASize div 2, ASize div 2);
          LineTo(ASize div 2, ASize div 2);
        end;
    
        ColorR := GetRValue(ColorRgb);
        ColorG := GetGValue(ColorRgb);
        ColorB := GetBValue(ColorRgb);
    
        for I := 0 to Bmp.Height-1 do
        begin
          Pixels := PRGBQuad(Bmp.ScanLine[I]);
          for J := 0 to Bmp.Width-1 do
          begin
            with Pixels^ do
            begin
              if (rgbRed = ColorR) and (rgbGreen = ColorG) and (rgbBlue = ColorB) then
                rgbReserved := 0
              else
                rgbReserved := Opacity;
              // must pre-multiply the pixel with its alpha channel before drawing
              rgbRed := (rgbRed * rgbReserved) div $FF;
              rgbGreen := (rgbGreen * rgbReserved) div $FF;
              rgbBlue := (rgbBlue * rgbReserved) div $FF;
            end;
            Inc(Pixels);
          end;
        end;
    
        ACanvas.Draw(X, Y, Bmp, 255);
      finally
        Bmp.Free;
      end;
    end;
    
    procedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    begin
      case Button of
        mbLeft:
        begin
          IsDrawing := True;
          DrawOpacityBrush(Form1.Canvas, X, Y, clRed, 50, 85);
        end;
      end;
    end;
    
    procedure TForm1.FormMouseMove(Sender: TObject; Shift: TShiftState; X,
      Y: Integer);
    begin
      if (GetAsyncKeyState(VK_LBUTTON) <> 0) and
         (IsDrawing) then
      begin
        DrawOpacityBrush(Form1.Canvas, X, Y, clRed, 50, 85);
      end;
    end;
    
    procedure TForm1.FormMouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    begin
      IsDrawing := False;
    end;

The draw `DrawOpacityBrush()` procedure was an update by Remy Lebeau on a previous question I recently asked: http://stackoverflow.com/questions/10342603/how-to-paint-on-a-canvas-with-transparency-and-opacity/10343272#10343272

While this works, the results are not satisfactory to what I now need.

Currently, every time the `DrawOpacityBrush()` procedure is called in MouseMove it keeps on drawing the brush ellipse shape. This is bad because depending on how quick you move the mouse around the canvas, the output is not as hoped.

These sample images should illustrate this better hopefully:

![enter image description here][1]

**-** The first red brush I moved the mouse pretty rapidly from the bottom of the canvas to the top.<br>
**-** The second red brush I moved a lot slower.

As you can see the opacity is drawn correctly, except that the circle keeps on drawing repeatedly as well.

**What I would like it to do instead is:**

**(1)** Paint with a opacity line around the ellipse.

**(2)** Have an option to prevent any ellipses been drawn at all.

This mock sample image should give an idea of how I would like it to be drawn:

![enter image description here][2]

The 3 purple brush lines demonstrate **option (1)**.

To achieve **option (2)** the circles inside the brush lines should not be there.

This should then allow you to take time when drawing, not frantically moving the mouse around the canvas in hope of getting the result you need. Only when you decide to go back over the brush stroke you just made will the opacity for that area become darker etc.

How can I achieve these two effects for drawing on a canvas?


  [1]: http://i.stack.imgur.com/RBmp9.png
  [2]: http://i.stack.imgur.com/DCZf0.png",2
5250659,03/09/2011 18:49:31,652189,03/09/2011 18:49:31,1,0,[Delphi] Webbrowser is not working,"**This is my code** ;

     procedure TForm1.Button2Click(Sender: TObject);
        begin
        EmbeddedWB1.Navigate(combobox3.text+'/BeO/webroot/index.php?module=kings');
        While EmbeddedWB1.ReadyState <> READYSTATE_Complete do
        Application.ProcessMessages;
        Sleep(1);
        Application.ProcessMessages;
        
        
         if VarIsClear(EmbeddedWb1.OleObject.Document.getElementByID('asc12')) then
          begin
          Application.ProcessMessages;
            Sleep(1);
            Application.ProcessMessages;
            end
        else
        begin
        Sleep(500);
        Keybd_Event(VK_RETURN,   1, 0, 0);
        Application.ProcessMessages;
        end;
        end;

**I have question : thatz code not working,website is loaded but ""keybd event"" not usin.
just web page refreshing too much. Help Me Thankz.  **
",delphi,embedded,webbrowser,,,03/10/2011 03:51:11,not a real question,1,232,5,"[Delphi] Webbrowser is not working **This is my code** ;

     procedure TForm1.Button2Click(Sender: TObject);
        begin
        EmbeddedWB1.Navigate(combobox3.text+'/BeO/webroot/index.php?module=kings');
        While EmbeddedWB1.ReadyState <> READYSTATE_Complete do
        Application.ProcessMessages;
        Sleep(1);
        Application.ProcessMessages;
        
        
         if VarIsClear(EmbeddedWb1.OleObject.Document.getElementByID('asc12')) then
          begin
          Application.ProcessMessages;
            Sleep(1);
            Application.ProcessMessages;
            end
        else
        begin
        Sleep(500);
        Keybd_Event(VK_RETURN,   1, 0, 0);
        Application.ProcessMessages;
        end;
        end;

**I have question : thatz code not working,website is loaded but ""keybd event"" not usin.
just web page refreshing too much. Help Me Thankz.  **
",3
11741864,07/31/2012 13:59:21,1565950,07/31/2012 13:54:33,1,0,Delphi Firemonkey - Find Nearest City,I am trying to get the Closest City for the mac using Delphi Firemonkey.  Anyone have any assistance in this solution?,delphi,firemonkey,,,,07/31/2012 17:34:56,not a real question,1,22,6,Delphi Firemonkey - Find Nearest City I am trying to get the Closest City for the mac using Delphi Firemonkey.  Anyone have any assistance in this solution?,2
6808016,07/24/2011 16:17:21,537311,12/10/2010 02:04:38,202,2,Run this program as an administrator,"DelphiXe, Win7X64

Windows UAC is ON. Login as Administrator.
As to my program to execute action (for example file copying in a folder c:\Windows) on behalf of the Administrator, and only when it needs (optimum - to be requested).

Conditions:
- Without use manifest
- Without restart itself
- Without COM object
i read (http://stackoverflow.com/questions/923350/delphi-prompt-for-uac-elevation-when-needed)

Example - Far manager: we start usually (without ""to start on behalf of the Admin"") and when it is necessary there is an inquiry from system.",delphi,,,,,01/23/2012 13:57:02,not a real question,1,73,6,"Run this program as an administrator DelphiXe, Win7X64

Windows UAC is ON. Login as Administrator.
As to my program to execute action (for example file copying in a folder c:\Windows) on behalf of the Administrator, and only when it needs (optimum - to be requested).

Conditions:
- Without use manifest
- Without restart itself
- Without COM object
i read (http://stackoverflow.com/questions/923350/delphi-prompt-for-uac-elevation-when-needed)

Example - Far manager: we start usually (without ""to start on behalf of the Admin"") and when it is necessary there is an inquiry from system.",1
11089188,06/18/2012 18:52:59,1414184,05/24/2012 05:43:34,145,1,Loading File Names into a TStrings,"hello i am trying to load a list of filenames from a folder into a Stringlist. I only want to add the names of files that end in .jpg  When i run it now i get access violation errors. Here is what i got.

Selects directory.

    procedure TMainForm.Load1Click(Sender: TObject);
    var
      DirName: string;
    begin
        mylist.Free;
        myList := TList<TBitmap>.Create;
      DirName := 'c:\';
      if SelectDirectory(DirName,[sdAllowCreate, sdPerformCreate, sdPrompt],SELDIRHELP)
      then;
        LoadImages(DirName);
    end;

Gets number of totalfiles in folder

    function GetFilesCount(Dir : string; Mask : string) : integer;
    var
      Path : string;
    begin
      Result := 0;
      for Path in TDirectory.GetFiles(Dir, Mask) do
        inc(Result);
    end;

Gets filenames from folder

    function TMainForm.GetFilenames(Path: string ):TStrings;
    var
      Dest: TStrings;
      SR: TSearchRec;
    begin
      dest.Create;
      if FindFirst(Path+'*.*', faAnyFile, SR) = 0 then
      repeat
        Dest.Add(SR.Name);
      until FindNext(SR) <> 0;
      FindClose(SR);
      Result := Dest;
      Dest.Free;
    end;

and the load iamges 

        procedure TMainForm.LoadImages(const Dir: string);
        const
          FIRST_IMAGE = 0;
        var
          iFile : Integer;
          CurFileName: string;
          FoundFile : boolean;
          FileNameTemplate : string;
          FileNames : Tstrings;
        begin
           FileNames.Create;
           FileNameTemplate := IncludeTrailingPathDelimiter(Dir) + '*.jpg';          FileNames:=GetFileNames(FileNameTemplate);                                                 
          try
            ifile := 0;                                                                 
            repeat
              CurFileName := FileNames.Names[ifile];                                      
              showmessage(Curfilename);
     if FoundFile then
          begin
            end;
            Inc(iFile);
          end;
        until not FoundFile;
    end;

         
  ",delphi,,,,,06/18/2012 23:50:53,not a real question,1,721,6,"Loading File Names into a TStrings hello i am trying to load a list of filenames from a folder into a Stringlist. I only want to add the names of files that end in .jpg  When i run it now i get access violation errors. Here is what i got.

Selects directory.

    procedure TMainForm.Load1Click(Sender: TObject);
    var
      DirName: string;
    begin
        mylist.Free;
        myList := TList<TBitmap>.Create;
      DirName := 'c:\';
      if SelectDirectory(DirName,[sdAllowCreate, sdPerformCreate, sdPrompt],SELDIRHELP)
      then;
        LoadImages(DirName);
    end;

Gets number of totalfiles in folder

    function GetFilesCount(Dir : string; Mask : string) : integer;
    var
      Path : string;
    begin
      Result := 0;
      for Path in TDirectory.GetFiles(Dir, Mask) do
        inc(Result);
    end;

Gets filenames from folder

    function TMainForm.GetFilenames(Path: string ):TStrings;
    var
      Dest: TStrings;
      SR: TSearchRec;
    begin
      dest.Create;
      if FindFirst(Path+'*.*', faAnyFile, SR) = 0 then
      repeat
        Dest.Add(SR.Name);
      until FindNext(SR) <> 0;
      FindClose(SR);
      Result := Dest;
      Dest.Free;
    end;

and the load iamges 

        procedure TMainForm.LoadImages(const Dir: string);
        const
          FIRST_IMAGE = 0;
        var
          iFile : Integer;
          CurFileName: string;
          FoundFile : boolean;
          FileNameTemplate : string;
          FileNames : Tstrings;
        begin
           FileNames.Create;
           FileNameTemplate := IncludeTrailingPathDelimiter(Dir) + '*.jpg';          FileNames:=GetFileNames(FileNameTemplate);                                                 
          try
            ifile := 0;                                                                 
            repeat
              CurFileName := FileNames.Names[ifile];                                      
              showmessage(Curfilename);
     if FoundFile then
          begin
            end;
            Inc(iFile);
          end;
        until not FoundFile;
    end;

         
  ",1
9449173,02/25/2012 23:45:02,657714,03/13/2011 17:26:29,109,4,How can I strip Windows drive lettering out of my reformed path? Delphi or Pascal,"Further to [this answered question][1] I have another sticky problem. My coding is Free Pascal but Delphi solutions will work probably. 

In brief, I have a string value of concatenated paths that is formed by taking a source directory and recreating that tree in a destination directory. e.g.

C:\SourceDir\SubDirA 
becomes 
F:\DestionationDir\SourceDir\SubDirA. 

However, the solution I have for the Linux version of my program (as posted in the link above) doesn't quite work with Windows version because I end up with : 

F:\DestionationDir\C:SourceDir\SubDirA.

which is invalid. 

So I came up with this ""only run in Windows"" code to remove the central drive letterof the reformed path, but leave the initial one at the start by saying ""Look at the string starting from the 4th character in from the left. If you find 'C:', delete it"" so that the path becomes F:\DestionationDir\SourceDir\SubDirA. 

    {$IFDEF Windows} // Only do this for the Windows version
        k := posex('C:', FinalisedDestDir, 4);  // Find 'C:' in the middle of the concatanated path and return its position as k
        Delete(FinalisedDestDir, k, 2);  // Delete the 2 chars 'C:' of 'C:\' if found, leaving the '\' to keep the path valid
    {$ENDIF}   

Now, that works fine IF the C: is the source of the chosen directory. But obviously if the user is copying data from another drive (such as E:, F:, G: or whatever else drive up to Z:) it will not work. 

So my question is, how do I code it so that it says ""if any drive letter a: to z: is found after the 4th character from the left, delete it""? Whilst any solution that works ""will do"", ideally I need a fast solution. The best solution would be to not have it in there in the first place, but given the solution I posted in reply to my earlier post, I can't work out how not to have it in, due to the procedure I use to form it. 

Thank you. 


  [1]: http://stackoverflow.com/questions/9278513/lazarus-free-pascal-how-to-recursively-copy-a-source-directory-of-files-to-a/9397718#9397718",delphi,delete,freepascal,ifdef,,,open,0,353,15,"How can I strip Windows drive lettering out of my reformed path? Delphi or Pascal Further to [this answered question][1] I have another sticky problem. My coding is Free Pascal but Delphi solutions will work probably. 

In brief, I have a string value of concatenated paths that is formed by taking a source directory and recreating that tree in a destination directory. e.g.

C:\SourceDir\SubDirA 
becomes 
F:\DestionationDir\SourceDir\SubDirA. 

However, the solution I have for the Linux version of my program (as posted in the link above) doesn't quite work with Windows version because I end up with : 

F:\DestionationDir\C:SourceDir\SubDirA.

which is invalid. 

So I came up with this ""only run in Windows"" code to remove the central drive letterof the reformed path, but leave the initial one at the start by saying ""Look at the string starting from the 4th character in from the left. If you find 'C:', delete it"" so that the path becomes F:\DestionationDir\SourceDir\SubDirA. 

    {$IFDEF Windows} // Only do this for the Windows version
        k := posex('C:', FinalisedDestDir, 4);  // Find 'C:' in the middle of the concatanated path and return its position as k
        Delete(FinalisedDestDir, k, 2);  // Delete the 2 chars 'C:' of 'C:\' if found, leaving the '\' to keep the path valid
    {$ENDIF}   

Now, that works fine IF the C: is the source of the chosen directory. But obviously if the user is copying data from another drive (such as E:, F:, G: or whatever else drive up to Z:) it will not work. 

So my question is, how do I code it so that it says ""if any drive letter a: to z: is found after the 4th character from the left, delete it""? Whilst any solution that works ""will do"", ideally I need a fast solution. The best solution would be to not have it in there in the first place, but given the solution I posted in reply to my earlier post, I can't work out how not to have it in, due to the procedure I use to form it. 

Thank you. 


  [1]: http://stackoverflow.com/questions/9278513/lazarus-free-pascal-how-to-recursively-copy-a-source-directory-of-files-to-a/9397718#9397718",4
4999879,02/15/2011 04:30:14,602714,02/04/2011 06:16:37,42,0,How I can add a new Tablet in `TInkTablets` control,"How I can add a new Tablet in `TInkTablets` control. Currently the Tablet's `PlugAndPlayId` is `SCREEN`. I need to add a new device. How is it possible. I'm using Delphi 2010.
Thanks All.",delphi,tablet,,,,,open,0,32,10,"How I can add a new Tablet in `TInkTablets` control How I can add a new Tablet in `TInkTablets` control. Currently the Tablet's `PlugAndPlayId` is `SCREEN`. I need to add a new device. How is it possible. I'm using Delphi 2010.
Thanks All.",2
1111537,07/10/2009 19:32:34,30176,10/21/2008 23:40:29,2412,94,Why Do You Use Delphi?,"Nick Bradbury (the author of HomeSite, TopStyle and FeedDemon) just posted a fascinating explanation of why he uses Delphi: 
[http://nick.typepad.com/blog/2009/07/why-i-use-delphi.html][1] 

I'd like to know if there are other reasons. Why do you use Delphi?

(I'm making this community wiki from the onset. I'm interested in hearing your answers, not in points.)


  [1]: http://nick.typepad.com/blog/2009/07/why-i-use-delphi.html",delphi,programming-languages,comparison,,,03/27/2012 15:36:45,not constructive,1,53,5,"Why Do You Use Delphi? Nick Bradbury (the author of HomeSite, TopStyle and FeedDemon) just posted a fascinating explanation of why he uses Delphi: 
[http://nick.typepad.com/blog/2009/07/why-i-use-delphi.html][1] 

I'd like to know if there are other reasons. Why do you use Delphi?

(I'm making this community wiki from the onset. I'm interested in hearing your answers, not in points.)


  [1]: http://nick.typepad.com/blog/2009/07/why-i-use-delphi.html",3
1161623,07/21/2009 20:39:17,65886,02/13/2009 04:16:03,173,1,Older Delphi Instructional Materials,"There's a lot of old Delphi books available inexpensively. As a self-taught (advanced) beginner, it is difficult for me to know which ideas are still relevant and up-to-date, and which have become outdated. I'm hoping for a little guidance. For example, would it be outmoded to learn about databases powered by BDE? Is COM no longer a commonly used model? (note: I may be off in how I'm using these terms ... I don't know much about them.)

Thanks for your thoughts!",delphi,beginners-guide,,,,02/04/2012 16:35:55,not constructive,1,81,4,"Older Delphi Instructional Materials There's a lot of old Delphi books available inexpensively. As a self-taught (advanced) beginner, it is difficult for me to know which ideas are still relevant and up-to-date, and which have become outdated. I'm hoping for a little guidance. For example, would it be outmoded to learn about databases powered by BDE? Is COM no longer a commonly used model? (note: I may be off in how I'm using these terms ... I don't know much about them.)

Thanks for your thoughts!",2
5465231,03/28/2011 21:22:57,234253,12/18/2009 00:56:42,476,21,Adobe X Enable Protected Mode at Startup - disable via code,"Our application, write in Delphi, generates a series of reports, most of then in PDF format, that opens automatically when it is generated.
Adobe X introduced a feature that is enabled by default ""Enable Protected Mode at Startup"".
The report pdf files are oppened using ""ShelExecute"".

Becuase of this new Adobe Reader new setting, under Win 7 or Vista, we are getting an error message when opening the document. Double clicking the document to open it does not give any problem.
Is there a way to disable the protected method - or another way to open the document without getting the error (a workaround)?",delphi,windows-7,windows-vista,adobe,,,open,0,100,11,"Adobe X Enable Protected Mode at Startup - disable via code Our application, write in Delphi, generates a series of reports, most of then in PDF format, that opens automatically when it is generated.
Adobe X introduced a feature that is enabled by default ""Enable Protected Mode at Startup"".
The report pdf files are oppened using ""ShelExecute"".

Becuase of this new Adobe Reader new setting, under Win 7 or Vista, we are getting an error message when opening the document. Double clicking the document to open it does not give any problem.
Is there a way to disable the protected method - or another way to open the document without getting the error (a workaround)?",4
272577,11/07/2008 16:11:56,35527,11/07/2008 16:11:56,1,0,Running Delphi builds under TFS MSBuild,"Wanting to build and test a bunch of Borland Delphi 6 projects that are integrated with ASP.NET services.  Had been using WANT and CruiseControl for building Delphi.  With TFS Build agent we can tie all together and do some testing. I am looking for guidance and direction.  

One issue I see is that there is no ""solution"" in a Delphi project to be given to MSBuild as a <SolutionToBuild>.  Also, I have references to <UsingTask> but am a little unsure how to use them.  

Your guidance would be appreciated.

",delphi,msbuild,build-automation,,,,open,0,94,6,"Running Delphi builds under TFS MSBuild Wanting to build and test a bunch of Borland Delphi 6 projects that are integrated with ASP.NET services.  Had been using WANT and CruiseControl for building Delphi.  With TFS Build agent we can tie all together and do some testing. I am looking for guidance and direction.  

One issue I see is that there is no ""solution"" in a Delphi project to be given to MSBuild as a <SolutionToBuild>.  Also, I have references to <UsingTask> but am a little unsure how to use them.  

Your guidance would be appreciated.

",3
4549809,12/28/2010 21:52:24,498189,11/05/2010 10:04:14,56,2,Scraping Google Adsense web page using Indy,"Using: Delphi 2010, latest version of Indy

I am trying to scrape the data off Googles Adsense web page, with an aim to get the reports. However I have been unsuccessful so far. It stops after the first request and does not proceed.

Using Fiddler to debug the traffic/requests to Google Adsense website, and a web browser to load the Adsense page, I can see that the request (from the webbrowser) generates a number of redirects until the page is loaded.

However, my Delphi application is only generating a couple of requests before it stops.

Here are the steps I have followed:

1. Drop a IdHTTP and a IdSSLIOHandlerSocketOpenSSL1 component on the form.
2. Set the IdHTTP component properties AllowCookies and HandleRedirects to True, and IOHandler property to the IdSSLIOHandlerSocketOpenSSL1.
3. Set the IdSSLIOHandlerSocketOpenSSL1 component property Method := 'sslvSSLv23'

4. Finally I have this code:

    procedure TfmMain.GetUrlToFile(AURL, AFile : String);
    var
     Output : TMemoryStream;
    begin
      Output := TMemoryStream.Create;
      try
        IdHTTP1.Get(FURL, Output);
        Output.SaveToFile(AFile);
      finally
        Output.Free;
      end;
    end;

However, it does not get to the login page as expected. I would expect it to behave as if it was a webbrowser and proceed through the redirects until it finds the final page.

This is the output of the headers from Fiddler:

> HTTP/1.1 302 Found Location:
> https://encrypted.google.com/
> Cache-Control: private Content-Type:
> text/html; charset=UTF-8 Set-Cookie:
> PREF=ID=5166063f01b64b03:FF=0:TM=1293571783:LM=1293571783:S=a5OtsOqxu_GiV3d6;
> expires=Thu, 27-Dec-2012 21:29:43 GMT;
> path=/; domain=.google.com Set-Cookie:
> NID=42=XFUwZdkyF0TJKmoJjqoGgYNtGyOz-Irvz7ivao2z0--pCBKPpAvCGUeaa5GXLneP41wlpse-yU5UuC57pBfMkv434t7XB1H68ET0ZgVDNEPNmIVEQRVj7AA1Lnvv2Aez;
> expires=Wed, 29-Jun-2011 21:29:43 GMT;
> path=/; domain=.google.com; HttpOnly
> Date: Tue, 28 Dec 2010 21:29:43 GMT
> Server: gws Content-Length: 226
> X-XSS-Protection: 1; mode=block

Firstly, is there anything wrong with this output?

Is there something more that I should do to get the IdHTTP component to keep pursuing the redirects until the final page? 


TIA,
Steve F",delphi,indy,web-scraping,,,,open,0,327,7,"Scraping Google Adsense web page using Indy Using: Delphi 2010, latest version of Indy

I am trying to scrape the data off Googles Adsense web page, with an aim to get the reports. However I have been unsuccessful so far. It stops after the first request and does not proceed.

Using Fiddler to debug the traffic/requests to Google Adsense website, and a web browser to load the Adsense page, I can see that the request (from the webbrowser) generates a number of redirects until the page is loaded.

However, my Delphi application is only generating a couple of requests before it stops.

Here are the steps I have followed:

1. Drop a IdHTTP and a IdSSLIOHandlerSocketOpenSSL1 component on the form.
2. Set the IdHTTP component properties AllowCookies and HandleRedirects to True, and IOHandler property to the IdSSLIOHandlerSocketOpenSSL1.
3. Set the IdSSLIOHandlerSocketOpenSSL1 component property Method := 'sslvSSLv23'

4. Finally I have this code:

    procedure TfmMain.GetUrlToFile(AURL, AFile : String);
    var
     Output : TMemoryStream;
    begin
      Output := TMemoryStream.Create;
      try
        IdHTTP1.Get(FURL, Output);
        Output.SaveToFile(AFile);
      finally
        Output.Free;
      end;
    end;

However, it does not get to the login page as expected. I would expect it to behave as if it was a webbrowser and proceed through the redirects until it finds the final page.

This is the output of the headers from Fiddler:

> HTTP/1.1 302 Found Location:
> https://encrypted.google.com/
> Cache-Control: private Content-Type:
> text/html; charset=UTF-8 Set-Cookie:
> PREF=ID=5166063f01b64b03:FF=0:TM=1293571783:LM=1293571783:S=a5OtsOqxu_GiV3d6;
> expires=Thu, 27-Dec-2012 21:29:43 GMT;
> path=/; domain=.google.com Set-Cookie:
> NID=42=XFUwZdkyF0TJKmoJjqoGgYNtGyOz-Irvz7ivao2z0--pCBKPpAvCGUeaa5GXLneP41wlpse-yU5UuC57pBfMkv434t7XB1H68ET0ZgVDNEPNmIVEQRVj7AA1Lnvv2Aez;
> expires=Wed, 29-Jun-2011 21:29:43 GMT;
> path=/; domain=.google.com; HttpOnly
> Date: Tue, 28 Dec 2010 21:29:43 GMT
> Server: gws Content-Length: 226
> X-XSS-Protection: 1; mode=block

Firstly, is there anything wrong with this output?

Is there something more that I should do to get the IdHTTP component to keep pursuing the redirects until the final page? 


TIA,
Steve F",3
6778787,07/21/2011 15:39:37,407487,07/31/2010 14:02:26,8,1,filter windows explorer while it copies files,"I wish to create a program with similar functionality to SuperCopier in c++.

This question is exactly like: http://stackoverflow.com/questions/1585453/detect-windows-explorer-copy-operation

However, for some reason I cannot mark the answer is wrong, also I cannot add to their discussion.

The answer is wrong because the shell-extension that implements ICopyHook interface would only a notification for folders, not files and not as a list.

The code of SuperCopier is in Delphi, and just like the original post, I find it very difficult to follow.

any help would be much appreciated.",delphi,winapi,hook,explorer,,07/22/2011 01:48:25,not a real question,1,82,7,"filter windows explorer while it copies files I wish to create a program with similar functionality to SuperCopier in c++.

This question is exactly like: http://stackoverflow.com/questions/1585453/detect-windows-explorer-copy-operation

However, for some reason I cannot mark the answer is wrong, also I cannot add to their discussion.

The answer is wrong because the shell-extension that implements ICopyHook interface would only a notification for folders, not files and not as a list.

The code of SuperCopier is in Delphi, and just like the original post, I find it very difficult to follow.

any help would be much appreciated.",4
6166867,05/29/2011 09:15:57,478687,10/17/2010 17:59:50,375,15,Attach UAC Manifest file to any PE using Update Resource,"I want to build a simple tool to attach UAC manifest file to a given exe file the code works correctly but nothing happens.I must say that when i manually compile with the mainfest file it works ok.



    procedure TForm1.Button1Click(Sender: TObject);
    var
    myRes:THandle;
    test:PChar;
    begin
    test:='<?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?>'+#13#10+
    '<assembly xmlns=""urn:schemas-microsoft-com:asm.v1"" manifestVersion=""1.0"">'+#13#10+
    '<assemblyIdentity version=""1.1.1.1""'+#13#10+
    'processorArchitecture=""X86""'+#13#10+
    'name=""[APP TO TEST WITH]""'+#13#10+ 
    'type=""win32""/>'+#13#10+
    '<description>elevate execution level</description>'+#13#10+
    '<trustInfo xmlns=""urn:schemas-microsoft-com:asm.v2"">'+#13#10+
    '<security>'+#13#10+
    '<requestedPrivileges>'+#13#10+
    '<requestedExecutionLevel level=""requireAdministrator"" uiAccess=""false""/>'+#13#10+
    '</requestedPrivileges>'+#13#10+
    '</security>'+#13#10+
    '</trustInfo>'+#13#10+
    '</assembly> ';
    myRes := BeginUpdateResource('testuac.exe',false);
    UpdateResource(myRes,MakeIntResource(24),'1',1033,test,length(test));
    EndUpdateResource(myres,false);
    ShowMessage(SysErrorMessage(GetLastError));
    end;//Compiled with Delphi 7

The code works the resource appears inside the exe but it doesn't work . Any ideea why?",delphi,resources,uac,,,,open,0,177,10,"Attach UAC Manifest file to any PE using Update Resource I want to build a simple tool to attach UAC manifest file to a given exe file the code works correctly but nothing happens.I must say that when i manually compile with the mainfest file it works ok.



    procedure TForm1.Button1Click(Sender: TObject);
    var
    myRes:THandle;
    test:PChar;
    begin
    test:='<?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?>'+#13#10+
    '<assembly xmlns=""urn:schemas-microsoft-com:asm.v1"" manifestVersion=""1.0"">'+#13#10+
    '<assemblyIdentity version=""1.1.1.1""'+#13#10+
    'processorArchitecture=""X86""'+#13#10+
    'name=""[APP TO TEST WITH]""'+#13#10+ 
    'type=""win32""/>'+#13#10+
    '<description>elevate execution level</description>'+#13#10+
    '<trustInfo xmlns=""urn:schemas-microsoft-com:asm.v2"">'+#13#10+
    '<security>'+#13#10+
    '<requestedPrivileges>'+#13#10+
    '<requestedExecutionLevel level=""requireAdministrator"" uiAccess=""false""/>'+#13#10+
    '</requestedPrivileges>'+#13#10+
    '</security>'+#13#10+
    '</trustInfo>'+#13#10+
    '</assembly> ';
    myRes := BeginUpdateResource('testuac.exe',false);
    UpdateResource(myRes,MakeIntResource(24),'1',1033,test,length(test));
    EndUpdateResource(myres,false);
    ShowMessage(SysErrorMessage(GetLastError));
    end;//Compiled with Delphi 7

The code works the resource appears inside the exe but it doesn't work . Any ideea why?",3
9393497,02/22/2012 10:59:13,1225593,02/22/2012 10:53:38,1,0,"DUnit GUI Testing: Can I force 'Application' to a different ""form""?","I'm trying to run a GUI unit test with DUnit to an application whose mainform creates dynamically frames to itself. I've been able to create the application-to-test's mainform as a form in the test case and access its menu items etc.

The problem comes when the application tries to create a frame dynamically. The frame's resource reading comes to a point where it needs the window handle (in my case, setting the caption of a tab sheet). Here it goes from TWinControl.GetHandle to TWinControl.CreateWnd and to TCustomFrame.CreateParams.

In this CreateParams, the code says:

      if Parent = nil then
        Params.WndParent := Application.Handle;

This is where the difference occurs. When I run the actual application (not in the test), the Application.Handle here returns a non-zero number and the flow continues ok. But in the DUnit test application, the Application.Handle here returns 0. This causes the code in the TWinControl.CreateWnd to raise an exception telling that the frame does not have a parent:

      with Params do
      begin
        if (WndParent = 0) and (Style and WS_CHILD <> 0) then
          if (Owner <> nil) and (csReading in Owner.ComponentState) and
            (Owner is TWinControl) then
            WndParent := TWinControl(Owner).Handle
          else
            raise EInvalidOperation.CreateFmt(SParentRequired, [Name]);

I'd like to try to get around this problem (and in general, all test problems) without modifying the ""production"" code just because of the tests. Can you provide any clues on whether I could somehow force the ""Application"" to something else, or in some other way work around this?

Looking at the code, a possible other workaround scenario might be to try to get the owner (which is my ""MainForm"" of the application-to-test, i.e. whose handle I'd want to get) to be in csReading state while doing this frame creation in the test, but at least initially it doesn't seem so straightforward to get this to happen either.",delphi,gui,dunit,,,,open,0,378,11,"DUnit GUI Testing: Can I force 'Application' to a different ""form""? I'm trying to run a GUI unit test with DUnit to an application whose mainform creates dynamically frames to itself. I've been able to create the application-to-test's mainform as a form in the test case and access its menu items etc.

The problem comes when the application tries to create a frame dynamically. The frame's resource reading comes to a point where it needs the window handle (in my case, setting the caption of a tab sheet). Here it goes from TWinControl.GetHandle to TWinControl.CreateWnd and to TCustomFrame.CreateParams.

In this CreateParams, the code says:

      if Parent = nil then
        Params.WndParent := Application.Handle;

This is where the difference occurs. When I run the actual application (not in the test), the Application.Handle here returns a non-zero number and the flow continues ok. But in the DUnit test application, the Application.Handle here returns 0. This causes the code in the TWinControl.CreateWnd to raise an exception telling that the frame does not have a parent:

      with Params do
      begin
        if (WndParent = 0) and (Style and WS_CHILD <> 0) then
          if (Owner <> nil) and (csReading in Owner.ComponentState) and
            (Owner is TWinControl) then
            WndParent := TWinControl(Owner).Handle
          else
            raise EInvalidOperation.CreateFmt(SParentRequired, [Name]);

I'd like to try to get around this problem (and in general, all test problems) without modifying the ""production"" code just because of the tests. Can you provide any clues on whether I could somehow force the ""Application"" to something else, or in some other way work around this?

Looking at the code, a possible other workaround scenario might be to try to get the owner (which is my ""MainForm"" of the application-to-test, i.e. whose handle I'd want to get) to be in csReading state while doing this frame creation in the test, but at least initially it doesn't seem so straightforward to get this to happen either.",3
3925473,10/13/2010 15:45:25,9226,09/15/2008 18:07:47,1034,18,Decompressing gzipped files in Delphi 2009,"Up until Delphi 2007 I was using **DelphiZlib 0.2.99** for decompressing gzipped files. In Delphi 2009 the library does not compile anymore. Besides the conflict with Delphi's own zlib.pas unit, the code generates a number of string-related compiler errors and warnings which I don't think I can fix without a close understanding of the library code. DelphiZlib code was last modified in the year 2000, and it does not seem to have been updated since.

What can I replace it with for Delphi 2009? All I need is to decompress *.gz files. This is for a freeware project, so I strongly prefer free-with-source solutions, but I'll consider commercial libraries too.

",delphi,gzip,delphi-2009,decompression,,,open,0,109,6,"Decompressing gzipped files in Delphi 2009 Up until Delphi 2007 I was using **DelphiZlib 0.2.99** for decompressing gzipped files. In Delphi 2009 the library does not compile anymore. Besides the conflict with Delphi's own zlib.pas unit, the code generates a number of string-related compiler errors and warnings which I don't think I can fix without a close understanding of the library code. DelphiZlib code was last modified in the year 2000, and it does not seem to have been updated since.

What can I replace it with for Delphi 2009? All I need is to decompress *.gz files. This is for a freeware project, so I strongly prefer free-with-source solutions, but I'll consider commercial libraries too.

",4
10998309,06/12/2012 14:02:22,727364,04/27/2011 13:31:06,162,2,TFileOpenDialog in FireMonkey Application,"I'm using FireMonkey and want the user to select a directory using the interface supplied by a TFileOpenDialog (I find the SelectDirectory interface outdated at best - yes, even with the sdNewUI option). 

![TFileOpenDialog with [fdoPickFolders] option][1]


  [1]: http://i.stack.imgur.com/Lyg0I.png

Firstly, Is it bad practice to include the VCL.Dialogs unit (to use a TFileOpenDialog) in a FireMonkey application?

Secondly, this is still only possible with Windows Vista and above. Is this the correct way to check for a compatible Windows versions?

    {IFDEF WIN32 or WIN64}
      if Win32MajorVersion >= 6 then
        // Create TOpenFileDialog with fdoPickFolders option",delphi,delphi-xe2,firemonkey,,,,open,0,109,4,"TFileOpenDialog in FireMonkey Application I'm using FireMonkey and want the user to select a directory using the interface supplied by a TFileOpenDialog (I find the SelectDirectory interface outdated at best - yes, even with the sdNewUI option). 

![TFileOpenDialog with [fdoPickFolders] option][1]


  [1]: http://i.stack.imgur.com/Lyg0I.png

Firstly, Is it bad practice to include the VCL.Dialogs unit (to use a TFileOpenDialog) in a FireMonkey application?

Secondly, this is still only possible with Windows Vista and above. Is this the correct way to check for a compatible Windows versions?

    {IFDEF WIN32 or WIN64}
      if Win32MajorVersion >= 6 then
        // Create TOpenFileDialog with fdoPickFolders option",3
8285196,11/27/2011 11:24:24,1058238,11/21/2011 16:52:05,24,0,Active noise cancellation,"I have programed a voice recognition program and I am have problems with the mic hearing me, over the computer playing music. I need software that can filter out the sound leaving the speakers from the sound entering the mic. Can you suggest some software or component(Delphi) that would solve my problem.",delphi,audio,noise,cancellation,,,open,0,52,3,"Active noise cancellation I have programed a voice recognition program and I am have problems with the mic hearing me, over the computer playing music. I need software that can filter out the sound leaving the speakers from the sound entering the mic. Can you suggest some software or component(Delphi) that would solve my problem.",4
4957414,02/10/2011 13:03:11,578332,01/17/2011 09:38:04,11,0,how connect excel 2007 for delphi7         ,"I can connect with paradox base, oracle etc.
Now I want to work with excel 
how can I do it ?
 ",delphi,,,,,02/10/2011 13:49:27,not a real question,1,21,15,"how connect excel 2007 for delphi7          I can connect with paradox base, oracle etc.
Now I want to work with excel 
how can I do it ?
 ",1
2443886,03/14/2010 21:40:51,285070,03/03/2010 07:21:57,71,0,Delphi: wait until bat-script runs to the end,"I have bat-file, that make some operations. How to run this file from Delphi and wait, until it stops. 
Something like that:

    procedure TForm1.Button1Click(Sender: TObject);
    begin
    //Starting bat-file
    bla-bla-bla
    showmessage('Done');
    end;",delphi,batch,,,,,open,0,49,8,"Delphi: wait until bat-script runs to the end I have bat-file, that make some operations. How to run this file from Delphi and wait, until it stops. 
Something like that:

    procedure TForm1.Button1Click(Sender: TObject);
    begin
    //Starting bat-file
    bla-bla-bla
    showmessage('Done');
    end;",2
204164,10/15/2008 09:33:13,12170,09/16/2008 13:27:55,316,24,Why can't Indy 10 initialize?,"I have a problem with a Delphi 2009 project : It can't initialize Indy 10 !
This code worked fine before in Delphi 2007 (although we might have been using an older revision of Indy, but I suspect that has not much to do with it);

The initial call to IdWinsock2.InitializeWinSock(), raises this exception (with error code 998) :

    Project EAServer.exe raised exception class EIdWinsockStubError with message
    'Error on loading Winsock2 library (WS2\_32.DLL): Invalid access to memory location'.

But ws2\_32.dll is in C:\Windows\System32 allright, with these version details :

    File Version : 5.1.2600.5512 (xpsp.080413-0852)
    Description : Windows Socket 2.0 32-Bit DLL
    Copyright : © Microsoft Corporation. All rights reserved.
(this shows I'm on WinXP btw).


The silly thing is, that when I look at the process itself (using ""Process Explorer""), I can see the process already has this DLL open. The reason ""WS2\_32.DLL"" is already loaded, seems to be because we use the RTL unit Winsock.pas in this project too.
This unit is statically linked to ""wsock32.dll"", which has a dependancy on WS2\_32.DLL, so there.

Does anyone know why this code worked fine before (in Delphi 2007), and now (in Delphi 2009) it suddenly breaks?


And is this inability to re-open the ws2\_32 dll common knowledge, or is there really something wrong here? (I did check : I only have 1 version of these DLL's present on my system).


Better yet : Can anyone help me fixing this?




",delphi,indy,,,,11/18/2008 22:08:49,off topic,1,244,5,"Why can't Indy 10 initialize? I have a problem with a Delphi 2009 project : It can't initialize Indy 10 !
This code worked fine before in Delphi 2007 (although we might have been using an older revision of Indy, but I suspect that has not much to do with it);

The initial call to IdWinsock2.InitializeWinSock(), raises this exception (with error code 998) :

    Project EAServer.exe raised exception class EIdWinsockStubError with message
    'Error on loading Winsock2 library (WS2\_32.DLL): Invalid access to memory location'.

But ws2\_32.dll is in C:\Windows\System32 allright, with these version details :

    File Version : 5.1.2600.5512 (xpsp.080413-0852)
    Description : Windows Socket 2.0 32-Bit DLL
    Copyright : © Microsoft Corporation. All rights reserved.
(this shows I'm on WinXP btw).


The silly thing is, that when I look at the process itself (using ""Process Explorer""), I can see the process already has this DLL open. The reason ""WS2\_32.DLL"" is already loaded, seems to be because we use the RTL unit Winsock.pas in this project too.
This unit is statically linked to ""wsock32.dll"", which has a dependancy on WS2\_32.DLL, so there.

Does anyone know why this code worked fine before (in Delphi 2007), and now (in Delphi 2009) it suddenly breaks?


And is this inability to re-open the ws2\_32 dll common knowledge, or is there really something wrong here? (I did check : I only have 1 version of these DLL's present on my system).


Better yet : Can anyone help me fixing this?




",2
6774634,07/21/2011 10:28:17,115139,05/31/2009 16:08:03,942,52,"Ho do I solve the ""Cannot perform this operation on a closed dataset"" with Borland Database Engine and a Delphi application?","The application was working perfectly, until I edited the user database (*.dbf) in OpenOffice.org Calc. Now it gives me the above error about a closed dataset.",delphi,dataset,bde,,,07/22/2011 01:47:19,not a real question,1,26,21,"Ho do I solve the ""Cannot perform this operation on a closed dataset"" with Borland Database Engine and a Delphi application? The application was working perfectly, until I edited the user database (*.dbf) in OpenOffice.org Calc. Now it gives me the above error about a closed dataset.",3
4015145,10/25/2010 13:43:29,432809,08/27/2010 10:29:26,1,0,Delphi: Creating Access DB (.mdb) without Ms Access,"Is there a way to create Access databases (.mdb) without actually using Ms Access? I'd like my app to create it instead (when user presses ""New Document"" on the toolbar). 

I'm using Delphi 5 Ent.

Thanks in advance! :-)",delphi,ms-access,ado,,,,open,0,38,8,"Delphi: Creating Access DB (.mdb) without Ms Access Is there a way to create Access databases (.mdb) without actually using Ms Access? I'd like my app to create it instead (when user presses ""New Document"" on the toolbar). 

I'm using Delphi 5 Ent.

Thanks in advance! :-)",3
3200877,07/08/2010 05:31:45,367645,06/15/2010 19:56:25,46,0,communicating with mirc client  using delphi,"is there component which can allow me to communicate with mirc to connect to a specified server and then join to specified channel ? 

thanks in advance 

regards 
",delphi,,,,,,open,0,29,7,"communicating with mirc client  using delphi is there component which can allow me to communicate with mirc to connect to a specified server and then join to specified channel ? 

thanks in advance 

regards 
",1
6978850,08/08/2011 07:14:37,883562,08/08/2011 07:14:37,1,0,Delphi 7 Random Color Change of Stars,Im doing a Delphi 7 Project i have to let a user enter in a number(Layers going down) to build a christmas tree but i also need to display the output as '*'(Stars) and i am having a problem editing a certain line of stars in the RichEdit to make the color change randomly just like a real Christmas tree Shines.,delphi,delphi-7,borland,,,08/10/2011 02:23:26,not a real question,1,61,7,Delphi 7 Random Color Change of Stars Im doing a Delphi 7 Project i have to let a user enter in a number(Layers going down) to build a christmas tree but i also need to display the output as '*'(Stars) and i am having a problem editing a certain line of stars in the RichEdit to make the color change randomly just like a real Christmas tree Shines.,3
268537,11/06/2008 12:41:07,22712,09/26/2008 14:23:30,262,18,What features of the upcoming Delphi Prism would you like to see in Delphi for win32?,"What with Delphi Prism coming soon, I've been looking at Oxygene (the Remobjects compiler, Delphi Prism will use), and have a found a few features I'd love to see in Delphi Win32. Some of my favourites are :

 **Inline Property expressions and implicit property variables**

    property Length: double; 
    property Width: double;
    property Area: double read Length*Width



 **Property Initial Values**

    property Length: Integer := 15;



 **Iterators**

 While Iterators are available in Delphi, the use of sequences and the yield keyword makes   creating them much easier.
    
    method GetEmptyKeys: sequence of string;iterator;
    ...
    property EmptyKeys : sequence of TKey read GetEmptyKeys;

    ...
    ...
    ...
    method TMyClass.GetEmptyKeys
    begin
      for each key in keylist do
        if key = '' then
          yield key;
    end;
 
    
 

I could go on and on, but those would be very nice to have.

note this question has kind of been asked before but not in relation to Prism. [here][1]


  [1]: http://stackoverflow.com/questions/230940/what-features-would-you-like-to-see-in-the-win32-delphi-compiler",delphi,language-features,,,,01/01/2012 22:07:26,not constructive,1,222,16,"What features of the upcoming Delphi Prism would you like to see in Delphi for win32? What with Delphi Prism coming soon, I've been looking at Oxygene (the Remobjects compiler, Delphi Prism will use), and have a found a few features I'd love to see in Delphi Win32. Some of my favourites are :

 **Inline Property expressions and implicit property variables**

    property Length: double; 
    property Width: double;
    property Area: double read Length*Width



 **Property Initial Values**

    property Length: Integer := 15;



 **Iterators**

 While Iterators are available in Delphi, the use of sequences and the yield keyword makes   creating them much easier.
    
    method GetEmptyKeys: sequence of string;iterator;
    ...
    property EmptyKeys : sequence of TKey read GetEmptyKeys;

    ...
    ...
    ...
    method TMyClass.GetEmptyKeys
    begin
      for each key in keylist do
        if key = '' then
          yield key;
    end;
 
    
 

I could go on and on, but those would be very nice to have.

note this question has kind of been asked before but not in relation to Prism. [here][1]


  [1]: http://stackoverflow.com/questions/230940/what-features-would-you-like-to-see-in-the-win32-delphi-compiler",2
813693,05/01/2009 23:25:18,32303,10/29/2008 09:06:33,580,19,How to draw on a TPanel,"I need to draw on a TPanel, ideally directly so I don't have another component on top of it getting in the way of mousevent-event trapping (I want to draw a little ""size-grip"" on it).  How should I go about doing this?",delphi,compoennts,tpanel,canvas,,,open,0,43,6,"How to draw on a TPanel I need to draw on a TPanel, ideally directly so I don't have another component on top of it getting in the way of mousevent-event trapping (I want to draw a little ""size-grip"" on it).  How should I go about doing this?",4
9147761,02/05/2012 07:45:58,532148,12/06/2010 10:51:51,152,0,Can I directly add record as object in stringlist?,"Currently I am adding object by creating it like: 

    type
    
    Trecord=class
    
      private
      str:string;
      num: integer;
      public
      constructor create;
      end;
    
    ...
    
    procedure TForm1.Button2Click(Sender: TObject);
    var
      i: integer;
      rec:TRecord;
      Alist: Tstringlist;
    begin
    Alist:=Tstringlist.create;
    Alist.Clear;
    for i:=0 to 9 do begin
    rec:=Trecord.Create; //create instance of class
    rec.str:='rec'+inttostr(i);
    rec.num :=i*2;
    Alist.AddObject(inttostr(i),rec);
    end;

Is this method correct or inefficient ? 
Or Can I directly add object not by creating it like using record?

    type
    
      PRec=^TRec;
      TRec=record
      str:string;
      num: integer;
      end;
    
    ...
    var
    rec: TRec;
    ...
    
    for i:=0 to 9 do begin
     //how to write here to have a new record, 
    //can i directly Create record in delphi 7 ?
    rec.str:='rec'+inttostr(i);
    rec.num :=i*2;
    Alist.AddObject(inttostr(i),???); // how to write here?
    end;

Or other fast and simple way?

I am using Delphi 7.

Thanks in advance.
",delphi,,,,,,open,0,303,9,"Can I directly add record as object in stringlist? Currently I am adding object by creating it like: 

    type
    
    Trecord=class
    
      private
      str:string;
      num: integer;
      public
      constructor create;
      end;
    
    ...
    
    procedure TForm1.Button2Click(Sender: TObject);
    var
      i: integer;
      rec:TRecord;
      Alist: Tstringlist;
    begin
    Alist:=Tstringlist.create;
    Alist.Clear;
    for i:=0 to 9 do begin
    rec:=Trecord.Create; //create instance of class
    rec.str:='rec'+inttostr(i);
    rec.num :=i*2;
    Alist.AddObject(inttostr(i),rec);
    end;

Is this method correct or inefficient ? 
Or Can I directly add object not by creating it like using record?

    type
    
      PRec=^TRec;
      TRec=record
      str:string;
      num: integer;
      end;
    
    ...
    var
    rec: TRec;
    ...
    
    for i:=0 to 9 do begin
     //how to write here to have a new record, 
    //can i directly Create record in delphi 7 ?
    rec.str:='rec'+inttostr(i);
    rec.num :=i*2;
    Alist.AddObject(inttostr(i),???); // how to write here?
    end;

Or other fast and simple way?

I am using Delphi 7.

Thanks in advance.
",1
3483680,08/14/2010 14:13:30,12597,09/16/2008 14:53:25,6573,181,Delphi: How delegate interface implementation to child object?,"i have an object which delegates implementation of a particularly complex interface to a child object. This is exactly the job of `TAggregatedObject`. The ""*child*"" object maintains a weak reference to its ""**controller***"", and all `QueryInterface` requests are passed to the parent.

So, my parent object declares that it implements the `IStream` interface:

    type
       TRobot = class(TInterfacedObject, IStream)
       private
          function GetStream: IStream;
       public
          property Stream: IStream read GetStrem implements IStream;
       end;

**Note:** This is a hypothetical example. i chose the word `Robot` because it sounds complicated, and and word is only 5 lettter; it's short. i also chose `IStream` because its short. i was going to use `IPersistFile` or `IPersistFileInit`, but they're longer, and make the example code harder to real. In other words: It's a hypothetical example.

Now i have my child object that will implement `IStream`:

    type
       TRobotStream = class(TAggregatedObject, IStream)
       public
          ...
       end;

All that's left, and this is where my problem comes in: create the `RobotStream` when it's asked for:

    function TRobotController.GetStream: IStream;
    begin
        Result := TRobotStream.Create(Self) as IStream;
    end;

This code fails to compile, with the error `Operator not applicable to this operand type.`.

This is because delphi is trying to perform the **`as` IStream** on an object that doesn't implement `IUnknown`:

    TAggregatedObject = class
     ...
    protected
       { IUnknown }
       function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;
       function _AddRef: Integer; stdcall;
       function _Release: Integer; stdcall;

The methods may be there, but the object doesn't advertise that it supports `IUnknown`. Without an `IUnknown` interface, it can't call `QueryInterface` to perform the cast.

So i change my `TRobotStream` class to advertise that it implements the missing interface (which it does; it inherits it from its ancestor):

    type
       TRobotStream = class(TAggregatedObject, IUnknown, IStream)
       ...

And now it compiles, but crashes at runtime on the line:

    Result := TRobotStream.Create(Self) as IStream;

Now i can see **what's** happening, but i can't explain why. After construction of the child object, Delphi is calling `IntfClear` on my Robot object while on the way out of the `Create` method.

i don't know exactly how to prevent this. i could try calling forcing a the cast

    Result := TRobotStream.Create(Self as IUnknown) as IStream;

and hope that keeps a reference. Turns out that it does keep the reference - no crash on the way out of the constructor.

This is confusing to me. Since i am passing an `object` where an `interface` is expected, i would assume that the compiler is implicitly preforming a typecast, i.e.:

 `Self`*`as IUnknown`*

in order to satisfy the call. And the fact that the syntax checker didn't complain let me to assume all was correct.


----------

But the crashes aren't over. i changed the line to:

    Result := TRobotStream.Create(Self as IUnknown) as IStream;

And the code does indeed return from the constructor of `TRobotStream` without destroying my parent object, but now i get a stack overflow.

The reason is that `TAggregatedObject` defers all `QueryInterface` (i.e. type casts) back to the parent object. In my case i am casting a `TRobotStream` to an `IStream`.

When i ask the `TRobotStream` for its `IStream` at the end of:

    Result := TRobotStream.Create(Self as IUnknown) as IStream;

It turns around and asks its **controller** for the `IStream` interface, which triggers a call to:

    function TRobotController.GetStream: IStream;
    begin
       Result := TRobotStream.Create(Self as IUnknown) as IStream;
    end;

**Boom!** Stack overflow.


----------

Blindly, i try removing the final cast to IStream, let Delphi try to implicitely cast the object to an interface (which i just saw above doesn't work right):

    Result := TRobotStream.Create(Self as IUnknown);

And now there is no crash; which i don't understand this very much. i've constructed an object, an object which supports multiple interfaces. How is it now that Delphi knows to cast the interface? Is it performing the proper reference counting? i saw above that it doesn't. Is there a subtle bug waiting to crash for the customer?

 
So i'm left with four possible ways to call my one line. Which one of them is valid? 

1. `Result := TRobotStream.Create(Self);`
2. `Result := TRobotStream.Create(Self as IUnknown);`
3. `Result := TRobotStream.Create(Self) as IStream;`
4. `Result := TRobotStream.Create(Self as IUnknown) as IStream;`


The Real Question
-----------------

i hit quite a few subtle bugs, and difficult to understand intricacies of the compiler. This leads me to believe that i have done everything completely wrong. If needed, ignore everything i said, and help me answer the question:

>What is the proper way to delegate interface implementation to a child object?


Maybe i should be using `TContainedObject` instead of `TAggregatedObject`. Maybe the two work in tandem, where the parent is aggregated and the child is contained. Maybe it's the opposite. Maybe neither apply in this case.

Everything in the main part of the post can be ignored. It was just to show that i have thought about it. There are those who would argue that by including what i have tried, i have poisoned the possible answers: rather than answering my question, people might focus on my failed question.

The real goal is to delegate interface implementation to a child object. This question contains my detailed attempts at solving the problem with `TAggregatedObject`. You don't even see my other two solution patterns. One of which suffers from circular refernce counts, and the breaks the `IUnknown` equivalence rule.

Rob Kennedy might remember; and asked me to make a question that asks for a solution to the problem, rather than a solution to a problem in one of my solutions.",delphi,interface,delegation,delphi-5,,,open,0,1046,8,"Delphi: How delegate interface implementation to child object? i have an object which delegates implementation of a particularly complex interface to a child object. This is exactly the job of `TAggregatedObject`. The ""*child*"" object maintains a weak reference to its ""**controller***"", and all `QueryInterface` requests are passed to the parent.

So, my parent object declares that it implements the `IStream` interface:

    type
       TRobot = class(TInterfacedObject, IStream)
       private
          function GetStream: IStream;
       public
          property Stream: IStream read GetStrem implements IStream;
       end;

**Note:** This is a hypothetical example. i chose the word `Robot` because it sounds complicated, and and word is only 5 lettter; it's short. i also chose `IStream` because its short. i was going to use `IPersistFile` or `IPersistFileInit`, but they're longer, and make the example code harder to real. In other words: It's a hypothetical example.

Now i have my child object that will implement `IStream`:

    type
       TRobotStream = class(TAggregatedObject, IStream)
       public
          ...
       end;

All that's left, and this is where my problem comes in: create the `RobotStream` when it's asked for:

    function TRobotController.GetStream: IStream;
    begin
        Result := TRobotStream.Create(Self) as IStream;
    end;

This code fails to compile, with the error `Operator not applicable to this operand type.`.

This is because delphi is trying to perform the **`as` IStream** on an object that doesn't implement `IUnknown`:

    TAggregatedObject = class
     ...
    protected
       { IUnknown }
       function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;
       function _AddRef: Integer; stdcall;
       function _Release: Integer; stdcall;

The methods may be there, but the object doesn't advertise that it supports `IUnknown`. Without an `IUnknown` interface, it can't call `QueryInterface` to perform the cast.

So i change my `TRobotStream` class to advertise that it implements the missing interface (which it does; it inherits it from its ancestor):

    type
       TRobotStream = class(TAggregatedObject, IUnknown, IStream)
       ...

And now it compiles, but crashes at runtime on the line:

    Result := TRobotStream.Create(Self) as IStream;

Now i can see **what's** happening, but i can't explain why. After construction of the child object, Delphi is calling `IntfClear` on my Robot object while on the way out of the `Create` method.

i don't know exactly how to prevent this. i could try calling forcing a the cast

    Result := TRobotStream.Create(Self as IUnknown) as IStream;

and hope that keeps a reference. Turns out that it does keep the reference - no crash on the way out of the constructor.

This is confusing to me. Since i am passing an `object` where an `interface` is expected, i would assume that the compiler is implicitly preforming a typecast, i.e.:

 `Self`*`as IUnknown`*

in order to satisfy the call. And the fact that the syntax checker didn't complain let me to assume all was correct.


----------

But the crashes aren't over. i changed the line to:

    Result := TRobotStream.Create(Self as IUnknown) as IStream;

And the code does indeed return from the constructor of `TRobotStream` without destroying my parent object, but now i get a stack overflow.

The reason is that `TAggregatedObject` defers all `QueryInterface` (i.e. type casts) back to the parent object. In my case i am casting a `TRobotStream` to an `IStream`.

When i ask the `TRobotStream` for its `IStream` at the end of:

    Result := TRobotStream.Create(Self as IUnknown) as IStream;

It turns around and asks its **controller** for the `IStream` interface, which triggers a call to:

    function TRobotController.GetStream: IStream;
    begin
       Result := TRobotStream.Create(Self as IUnknown) as IStream;
    end;

**Boom!** Stack overflow.


----------

Blindly, i try removing the final cast to IStream, let Delphi try to implicitely cast the object to an interface (which i just saw above doesn't work right):

    Result := TRobotStream.Create(Self as IUnknown);

And now there is no crash; which i don't understand this very much. i've constructed an object, an object which supports multiple interfaces. How is it now that Delphi knows to cast the interface? Is it performing the proper reference counting? i saw above that it doesn't. Is there a subtle bug waiting to crash for the customer?

 
So i'm left with four possible ways to call my one line. Which one of them is valid? 

1. `Result := TRobotStream.Create(Self);`
2. `Result := TRobotStream.Create(Self as IUnknown);`
3. `Result := TRobotStream.Create(Self) as IStream;`
4. `Result := TRobotStream.Create(Self as IUnknown) as IStream;`


The Real Question
-----------------

i hit quite a few subtle bugs, and difficult to understand intricacies of the compiler. This leads me to believe that i have done everything completely wrong. If needed, ignore everything i said, and help me answer the question:

>What is the proper way to delegate interface implementation to a child object?


Maybe i should be using `TContainedObject` instead of `TAggregatedObject`. Maybe the two work in tandem, where the parent is aggregated and the child is contained. Maybe it's the opposite. Maybe neither apply in this case.

Everything in the main part of the post can be ignored. It was just to show that i have thought about it. There are those who would argue that by including what i have tried, i have poisoned the possible answers: rather than answering my question, people might focus on my failed question.

The real goal is to delegate interface implementation to a child object. This question contains my detailed attempts at solving the problem with `TAggregatedObject`. You don't even see my other two solution patterns. One of which suffers from circular refernce counts, and the breaks the `IUnknown` equivalence rule.

Rob Kennedy might remember; and asked me to make a question that asks for a solution to the problem, rather than a solution to a problem in one of my solutions.",4
7075637,08/16/2011 08:43:29,62391,02/04/2009 12:55:13,5440,118,Delphi Ownership Confusion,"I always thought that the owner is responsible for destroying visual controls and that I can manually control destruction if I pass `nil` as the owner.

Consider the following example:

    TMyForm = class (TForm)
    private
      FButton : TButton;
    end;
 
    ...
    FButton := TButton.Create(nil);   // no owner!!
    FButton.Parent := Self;

I would expect this button to produce a memory leak but it doesn't and in fact the destructor of `TButton` is called.

Further investigation showed that the `TWinControl` destructor contains the following snippet of code:

    I := ControlCount;
    while I <> 0 do
    begin
      Instance := Controls[I - 1];
      Remove(Instance);
      Instance.Destroy;
      I := ControlCount;
    end;

which looks like it is destroying the child components (the ones with `Parent` set to the control itself).

I was not expecting the parent control to destroy the control. Can anybody explain why this is happening? And who is destroying the object if I pass in an owner?

",delphi,memory-management,components,delphi-xe,ownership,,open,0,205,3,"Delphi Ownership Confusion I always thought that the owner is responsible for destroying visual controls and that I can manually control destruction if I pass `nil` as the owner.

Consider the following example:

    TMyForm = class (TForm)
    private
      FButton : TButton;
    end;
 
    ...
    FButton := TButton.Create(nil);   // no owner!!
    FButton.Parent := Self;

I would expect this button to produce a memory leak but it doesn't and in fact the destructor of `TButton` is called.

Further investigation showed that the `TWinControl` destructor contains the following snippet of code:

    I := ControlCount;
    while I <> 0 do
    begin
      Instance := Controls[I - 1];
      Remove(Instance);
      Instance.Destroy;
      I := ControlCount;
    end;

which looks like it is destroying the child components (the ones with `Parent` set to the control itself).

I was not expecting the parent control to destroy the control. Can anybody explain why this is happening? And who is destroying the object if I pass in an owner?

",5
5220028,03/07/2011 13:00:36,80901,03/21/2009 17:12:22,4887,337,GExperts grep expression for source lines with string literals (for translation),"How can I find all lines in Delphi source code using GExperts grep search which contain a string literal instead of a resource string, except those lines which are marked as `'do not translate'`?

Example:

this line should match

      ShowMessage('Fatal error! Save all data and restart the application');

this line should not match

      FieldByName('End Date').Clear; // do not translate

(Asking specifically about GExpert as it has a limited grep implementation afaik)
",delphi,internationalization,grep,gexperts,,,open,0,77,11,"GExperts grep expression for source lines with string literals (for translation) How can I find all lines in Delphi source code using GExperts grep search which contain a string literal instead of a resource string, except those lines which are marked as `'do not translate'`?

Example:

this line should match

      ShowMessage('Fatal error! Save all data and restart the application');

this line should not match

      FieldByName('End Date').Clear; // do not translate

(Asking specifically about GExpert as it has a limited grep implementation afaik)
",4
5139867,02/28/2011 08:58:41,478141,10/16/2010 20:12:31,362,7,Porting a C array declaration to Delphi,"In C, I can declare and initialize an char array like this:

    char arg[10] = ""ANY"";

Is there any short syntax to do the same in delphi?

",delphi,,,,,,open,0,29,7,"Porting a C array declaration to Delphi In C, I can declare and initialize an char array like this:

    char arg[10] = ""ANY"";

Is there any short syntax to do the same in delphi?

",1
3978935,10/20/2010 14:30:08,481841,10/20/2010 14:30:08,1,0,Just found Power++,I found Power++ and to my suprise it looks like a good alternative for Delphi and Visual Studio. Anyone used it? Can you tell me if it is worth it buying/learning it?,delphi,vs,,,,10/20/2010 15:13:47,not constructive,1,32,3,Just found Power++ I found Power++ and to my suprise it looks like a good alternative for Delphi and Visual Studio. Anyone used it? Can you tell me if it is worth it buying/learning it?,2
8215487,11/21/2011 16:58:23,1058238,11/21/2011 16:52:05,1,0,How can i communicate with an HID USB device in delphi,"I have been researching this problem for a while now and I just can't seem to get it right. I have a C++ version of the software I would like to make in delphi, but I can't get it to work in delphi. I need some sort of tutorial or guide that can show me how to connect to, read and write data to a HID USB device.",delphi,usb,read,write,hid,11/22/2011 22:15:26,not a real question,1,68,11,"How can i communicate with an HID USB device in delphi I have been researching this problem for a while now and I just can't seem to get it right. I have a C++ version of the software I would like to make in delphi, but I can't get it to work in delphi. I need some sort of tutorial or guide that can show me how to connect to, read and write data to a HID USB device.",5
1140584,07/16/2009 22:00:34,81800,03/24/2009 05:02:28,981,22,How to add two messages to the messagehandler in delphi?,"In the declaration of my form,I made a messagehandler:

    procedure MessageHandler(var Msg:TMessage);Message MSG_ACCESS;

    const
    MSG_ASYNC = $BAD;
    MSG_ACCESS = $BEEF;

In the message Handler when I check for a message,it works fine,but if i change the declaration like this:

    procedure MessageHandler(var Msg:TMessage);Message MSG_ACCESS or MSG_ASYNC;

None of the messages I send are being handled.

How do I make it with two messages?",delphi,,,,,,open,0,74,10,"How to add two messages to the messagehandler in delphi? In the declaration of my form,I made a messagehandler:

    procedure MessageHandler(var Msg:TMessage);Message MSG_ACCESS;

    const
    MSG_ASYNC = $BAD;
    MSG_ACCESS = $BEEF;

In the message Handler when I check for a message,it works fine,but if i change the declaration like this:

    procedure MessageHandler(var Msg:TMessage);Message MSG_ACCESS or MSG_ASYNC;

None of the messages I send are being handled.

How do I make it with two messages?",1
7605807,09/30/2011 04:00:48,35696,11/08/2008 03:38:52,2627,139,Are there any Delphi components that ship with Unit tests?,"Given the popularity of Unit Testing, and the inclusion of DUnit with Delphi... has this been embraced by any 3rd party component vendors who have released their source along with a suite of unit tests?

I'm looking for examples to share with other developers.",delphi,unit-testing,,,,09/30/2011 11:28:27,not constructive,1,43,10,"Are there any Delphi components that ship with Unit tests? Given the popularity of Unit Testing, and the inclusion of DUnit with Delphi... has this been embraced by any 3rd party component vendors who have released their source along with a suite of unit tests?

I'm looking for examples to share with other developers.",2
4663462,01/11/2011 22:34:29,89691,04/11/2009 06:05:44,379,9,"How is the result of the Delphi NOW function affected by the option to ""Adjust adjust clock for daylight saving changes""","I realise this question could have been answered by writing some test code.  I'm not lazy, I just thought that the answer might be generally useful.

I have an app that has generated a large amount of data with records that were stamped with the local time (as returned by the NOW routine).  We have run into a snag with transitions in and out of daylight savings time - namely that there is an hour missing when we change to DST, and an hour repeated when we exit from DST.  This causes problems with manipulations that assume date ordered records.

The app has been altered therefore to work with all datetimes in UTC, but I will have the ability to display datetimes in UTC or in local time.  I also have to deal with datetimes that were stored in local time, and make sure they are correctly shifted to UTC.  This is tricky, as the datetime might have been stored while DST was in effect, so in the general case I need to be able to determine if any random date is within or outside a DST period.  There is of course a period of one hour where a datetime is ambiguous and could be in the last hour before daylight savings ended, or in the first hour after it ended.  There is no way of resolving this.  

In coding the changes, I wondered about the result of NOW calls.  Internally it calls GetLocalTime.  What does GetLocalTime (and NOW) return when you are inside a DST period, but the option to ""Adjust adjust clock for daylight saving changes"" is turned off?

How do I write a routine that returns the current datetime inside a DST period (with the DST bias applied) regardless of whether ""Adjust adjust clock for daylight saving changes"" is off or on?",delphi,utc,dst,systemtime,now,,open,0,312,21,"How is the result of the Delphi NOW function affected by the option to ""Adjust adjust clock for daylight saving changes"" I realise this question could have been answered by writing some test code.  I'm not lazy, I just thought that the answer might be generally useful.

I have an app that has generated a large amount of data with records that were stamped with the local time (as returned by the NOW routine).  We have run into a snag with transitions in and out of daylight savings time - namely that there is an hour missing when we change to DST, and an hour repeated when we exit from DST.  This causes problems with manipulations that assume date ordered records.

The app has been altered therefore to work with all datetimes in UTC, but I will have the ability to display datetimes in UTC or in local time.  I also have to deal with datetimes that were stored in local time, and make sure they are correctly shifted to UTC.  This is tricky, as the datetime might have been stored while DST was in effect, so in the general case I need to be able to determine if any random date is within or outside a DST period.  There is of course a period of one hour where a datetime is ambiguous and could be in the last hour before daylight savings ended, or in the first hour after it ended.  There is no way of resolving this.  

In coding the changes, I wondered about the result of NOW calls.  Internally it calls GetLocalTime.  What does GetLocalTime (and NOW) return when you are inside a DST period, but the option to ""Adjust adjust clock for daylight saving changes"" is turned off?

How do I write a routine that returns the current datetime inside a DST period (with the DST bias applied) regardless of whether ""Adjust adjust clock for daylight saving changes"" is off or on?",5
7960256,10/31/2011 21:59:17,1022757,10/31/2011 21:49:10,1,0,Delphi algorithm to solve 4 or 5 parameter logistics equation?,"I'm looking for an [Pascal/Delphi] algorithm that can solve a 4 or 5 parameter logistics equation. I've been searching the web for quite a while now and have not been successful in finding an algorithm that works.

For example, 4 parameter logstics;

Y = (A-D)/(1+(x/C)^B)+D

Given a set of coordinates (x,y) I'd need to determine A, B, C, D.
(A = max, B = slope, C = inflection point, D = min)

Any help in the right direction? :(",delphi,curve,curve-fitting,,,11/01/2011 10:06:09,off topic,1,74,10,"Delphi algorithm to solve 4 or 5 parameter logistics equation? I'm looking for an [Pascal/Delphi] algorithm that can solve a 4 or 5 parameter logistics equation. I've been searching the web for quite a while now and have not been successful in finding an algorithm that works.

For example, 4 parameter logstics;

Y = (A-D)/(1+(x/C)^B)+D

Given a set of coordinates (x,y) I'd need to determine A, B, C, D.
(A = max, B = slope, C = inflection point, D = min)

Any help in the right direction? :(",3
8563139,12/19/2011 14:58:38,1042721,11/12/2011 02:08:51,198,10,How can I make bruteforce password recovery software using with parallel computing tech,"How can I make bruteforce password recovery software in delphi using with parallel computing technologies for md5 Algorithms!

Can someone tell me some advise?

Thanks",delphi,parallel-processing,,,,12/19/2011 18:40:26,not a real question,1,23,13,"How can I make bruteforce password recovery software using with parallel computing tech How can I make bruteforce password recovery software in delphi using with parallel computing technologies for md5 Algorithms!

Can someone tell me some advise?

Thanks",2
2975586,06/04/2010 15:33:40,282848,02/27/2010 21:42:36,1671,66,Good Delphi Blogs?,"I just saw http://pages.cs.wisc.edu/~rkennedy/ which appears to be a very interesting in-depth blog about the Delphi programming language, compiler, and IDE. At the more basic level we also have the About site, and DelphiBasics. You can also have fun for a few minutes at http://www.scalabium.com/faq/dc_tips.htm.

What are the most interesting blogs and sites devoted to Delphi? I am in particular interested in content at the advanced level.",delphi,blogs,,,,03/23/2012 17:05:34,not constructive,1,66,3,"Good Delphi Blogs? I just saw http://pages.cs.wisc.edu/~rkennedy/ which appears to be a very interesting in-depth blog about the Delphi programming language, compiler, and IDE. At the more basic level we also have the About site, and DelphiBasics. You can also have fun for a few minutes at http://www.scalabium.com/faq/dc_tips.htm.

What are the most interesting blogs and sites devoted to Delphi? I am in particular interested in content at the advanced level.",2
524000,02/07/2009 15:52:15,23368,09/29/2008 07:10:57,831,30,Is there a Delphi library which reads and writes .properties files?,"I thought about creating my own, but there are many details to consider to make it 100% compatible with Java .properties files, so I'm asking first.",delphi,properties,,,,,open,0,26,11,"Is there a Delphi library which reads and writes .properties files? I thought about creating my own, but there are many details to consider to make it 100% compatible with Java .properties files, so I'm asking first.",2
7117522,08/19/2011 05:59:09,901829,08/19/2011 05:12:23,1,0,How do i retrieve Windows user preference value for Hyperlink colour?,"set in Appearance, overriden by theme(?)
also i suspect this pref is newly introduced (6.0+?)",delphi,winapi,,,,08/19/2011 14:41:54,not a real question,1,14,11,"How do i retrieve Windows user preference value for Hyperlink colour? set in Appearance, overriden by theme(?)
also i suspect this pref is newly introduced (6.0+?)",2
9150361,02/05/2012 15:17:03,1190727,02/05/2012 14:54:32,1,0,How to use a IMultiCastEvent from the spring4d?,"Good day!

I'm try to start usage the collections part of a spring4d. But I cann't subscribe to the collection changing events. Get the error: [DCC Error]: E2008 Incompatible types at:

    var
      TestList: TObjectList<TObject>;
    begin
      ... List initialization code ...
    
      TestList.OnNotify.Add(TestHandler);     <--- Error here
    end

The OnNotify property of the TObjectList declared as:

`property OnNotify: ICollectionNotifyDelegate<T>`, where

    ICollectionNotifyDelegate<T> = interface(IMulticastEvent<Generics.Collections.TCollectionNotifyEvent<T>>)
    end;

i.e. the OnNotify.Add method expects a Generics.Collections.TCollectionNotifyEvent<T>, which declared as:

    TCollectionNotifyEvent<T> = procedure(Sender: TObject; const Item: T; 
        Action: TCollectionNotification) of object;

my event handler declared as:

    procedure TTestClass.TestHandler(Sender: TObject; const Item: TObject; Action: TCollectionNotification);
    begin
    
    end;

I'm confused %) please help )",delphi,,,,,,open,0,159,8,"How to use a IMultiCastEvent from the spring4d? Good day!

I'm try to start usage the collections part of a spring4d. But I cann't subscribe to the collection changing events. Get the error: [DCC Error]: E2008 Incompatible types at:

    var
      TestList: TObjectList<TObject>;
    begin
      ... List initialization code ...
    
      TestList.OnNotify.Add(TestHandler);     <--- Error here
    end

The OnNotify property of the TObjectList declared as:

`property OnNotify: ICollectionNotifyDelegate<T>`, where

    ICollectionNotifyDelegate<T> = interface(IMulticastEvent<Generics.Collections.TCollectionNotifyEvent<T>>)
    end;

i.e. the OnNotify.Add method expects a Generics.Collections.TCollectionNotifyEvent<T>, which declared as:

    TCollectionNotifyEvent<T> = procedure(Sender: TObject; const Item: T; 
        Action: TCollectionNotification) of object;

my event handler declared as:

    procedure TTestClass.TestHandler(Sender: TObject; const Item: TObject; Action: TCollectionNotification);
    begin
    
    end;

I'm confused %) please help )",1
443398,01/14/2009 15:38:34,9467,09/15/2008 18:54:34,318,9,Delphi Printing Techniques,"Where can I find a good resource for adding print capabilities to my program?

I found this page: http://efg2.com/Lab/Library/Delphi/Printing/index.html but it hasn't been updated in 5 years, and I'd like to know if, with Delphi 2009, StretchDIBits is still preferred to StretchDrawMap, how to best support pagination, preview, etc.

To date, I've cheated by creating html or pdf documents than printing those, but it is a bit onerous to go this far for all print tasks.",delphi,delphi-2009,printing,,,06/19/2012 11:56:33,not constructive,1,74,3,"Delphi Printing Techniques Where can I find a good resource for adding print capabilities to my program?

I found this page: http://efg2.com/Lab/Library/Delphi/Printing/index.html but it hasn't been updated in 5 years, and I'd like to know if, with Delphi 2009, StretchDIBits is still preferred to StretchDrawMap, how to best support pagination, preview, etc.

To date, I've cheated by creating html or pdf documents than printing those, but it is a bit onerous to go this far for all print tasks.",3
667988,03/20/2009 20:59:41,32303,10/29/2008 09:06:33,162,13,Delphi's RAD Studio\5.0\lib\debug Folder,"Perhaps a stupid question, but what exactly is the purpose of this Delphi folder?:
C:\Program Files\CodeGear\RAD Studio\5.0\lib\debug

..and why/when are *.dcu files put there rather than 
C:\Program Files\CodeGear\RAD Studio\5.0\lib\
?

I'm trying to find duplicate DCU and BPL files, based on an aswer I received to another question here, and it seems that the lib and lib\debug folders sometimes contain the same or similar *.DCU files.  Is this OK, or not... and when/why?

Thanks in advance for any and all help. : )",delphi,ide,packages,,,,open,0,79,4,"Delphi's RAD Studio\5.0\lib\debug Folder Perhaps a stupid question, but what exactly is the purpose of this Delphi folder?:
C:\Program Files\CodeGear\RAD Studio\5.0\lib\debug

..and why/when are *.dcu files put there rather than 
C:\Program Files\CodeGear\RAD Studio\5.0\lib\
?

I'm trying to find duplicate DCU and BPL files, based on an aswer I received to another question here, and it seems that the lib and lib\debug folders sometimes contain the same or similar *.DCU files.  Is this OK, or not... and when/why?

Thanks in advance for any and all help. : )",3
7878206,10/24/2011 15:40:58,765659,05/23/2011 08:25:25,100,2,Delphi 5 incompatible with library,"I am trying to add an Advantech (BDaqCL.pas) library to my application project in Delphi 5 but the .PAS file is riddled with code such as:


    	AccessMode = (
      ModeRead = 0,
      ModeWrite,
      ModeWriteWithReset
    );

which causes the error:

    ',' or ')' expected but '=' found

Is this a feature of the later versions of Delphi which is not compatible in D5? If so is it worth manually changing everyone (there are many) or am I bound to run in to much deeper problems?",delphi,access-control,delphi-5,pci,,,open,0,106,5,"Delphi 5 incompatible with library I am trying to add an Advantech (BDaqCL.pas) library to my application project in Delphi 5 but the .PAS file is riddled with code such as:


    	AccessMode = (
      ModeRead = 0,
      ModeWrite,
      ModeWriteWithReset
    );

which causes the error:

    ',' or ')' expected but '=' found

Is this a feature of the later versions of Delphi which is not compatible in D5? If so is it worth manually changing everyone (there are many) or am I bound to run in to much deeper problems?",4
1299540,08/19/2009 12:15:10,115305,06/01/2009 06:19:23,1339,120,"Any good, new Delphi books?","I've noticed that the number of good Delphi books is slowly going down to zero. Of course, there are plenty of books that explain the basics but good titles like the ""Tomes of Delphi"" series seem to have stopped.

What I am looking for are *recent*, new book titles about Delphi that are useful for Delphi experts, not newbies. There are plenty of older books that are useful but I just wonder if there are still enough authors interested in supporting Delphi.

Well, Marco Cantu still seems to publish his Delphi handbooks. But are there more, or is the Delphi book business now officially dead?",delphi,books,,,,09/27/2011 14:57:30,not constructive,1,103,5,"Any good, new Delphi books? I've noticed that the number of good Delphi books is slowly going down to zero. Of course, there are plenty of books that explain the basics but good titles like the ""Tomes of Delphi"" series seem to have stopped.

What I am looking for are *recent*, new book titles about Delphi that are useful for Delphi experts, not newbies. There are plenty of older books that are useful but I just wonder if there are still enough authors interested in supporting Delphi.

Well, Marco Cantu still seems to publish his Delphi handbooks. But are there more, or is the Delphi book business now officially dead?",2
10427832,05/03/2012 08:37:33,1367470,05/01/2012 09:15:38,1,0,write arabic in Excel sheet by delphi?,"I wont to write Arabic text in Excel Sheet using Delphi when I write on the sheet i get something like this ÌÇÝÇ.
and I wont to change excel data type from Delphi code.
 >pls help me
  ",delphi,excel,delphi-7,,,05/04/2012 15:29:24,not a real question,1,38,7,"write arabic in Excel sheet by delphi? I wont to write Arabic text in Excel Sheet using Delphi when I write on the sheet i get something like this ÌÇÝÇ.
and I wont to change excel data type from Delphi code.
 >pls help me
  ",3
11471747,07/13/2012 13:45:43,1523691,07/13/2012 13:34:22,1,0,Uusing unsignedByte with Base 64 encoding,"I have made a SOAP API using WSDL, and i need to transfer bytes of a file from client to the server of the API. I am using unsignedBinary[] array type in the WSDL to describe the data to be passed. The WSDL description is as follows:

    <complexType name=""TByteArray"">

    <complexContent>

    <restriction base=""soapenc:Array"">

    <sequence/>

    <attribute ref=""soapenc:arrayType"" n1:arrayType=""xs:unsignedByte[]"" xmlns:n1=""http://schemas.xmlsoap.org/wsdl/""/>

    </restriction>

    </complexContent>

    </complexType>

I am trying to send the data in a raw bytes, which is giving error.
Now i am doing a base64 encode while sending the binary data using the soap API call.
Now it is working fine if i send the data using PHP Client.
But not working when i use a DELPHI Application to send the data.

So do you think that converting the binary data to base64 is making the DELPHI application not allow to send the data?
unsignedByes is not allowed to transfer to Base 64?

Please reply me in yes or on with detailed description.

Thanks.",delphi,soap,,,,,open,0,176,6,"Uusing unsignedByte with Base 64 encoding I have made a SOAP API using WSDL, and i need to transfer bytes of a file from client to the server of the API. I am using unsignedBinary[] array type in the WSDL to describe the data to be passed. The WSDL description is as follows:

    <complexType name=""TByteArray"">

    <complexContent>

    <restriction base=""soapenc:Array"">

    <sequence/>

    <attribute ref=""soapenc:arrayType"" n1:arrayType=""xs:unsignedByte[]"" xmlns:n1=""http://schemas.xmlsoap.org/wsdl/""/>

    </restriction>

    </complexContent>

    </complexType>

I am trying to send the data in a raw bytes, which is giving error.
Now i am doing a base64 encode while sending the binary data using the soap API call.
Now it is working fine if i send the data using PHP Client.
But not working when i use a DELPHI Application to send the data.

So do you think that converting the binary data to base64 is making the DELPHI application not allow to send the data?
unsignedByes is not allowed to transfer to Base 64?

Please reply me in yes or on with detailed description.

Thanks.",2
11558459,07/19/2012 10:05:52,1414184,05/24/2012 05:43:34,172,1,Using Delphi and Visio,"Using visio 2010  I would like to know how i can data link a delphi app with a visio drawing. Forexample, I have a edit box on the app and a line on the visio drawing. If i put 10 in the edit box on the app, the drawing would make the line lenght 10.  I do not want code for this, it is just an example of the communication between the two i am looking for. ",delphi,delphi-xe2,visio,,,07/19/2012 14:20:53,not a real question,1,80,4,"Using Delphi and Visio Using visio 2010  I would like to know how i can data link a delphi app with a visio drawing. Forexample, I have a edit box on the app and a line on the visio drawing. If i put 10 in the edit box on the app, the drawing would make the line lenght 10.  I do not want code for this, it is just an example of the communication between the two i am looking for. ",3
6341711,06/14/2011 09:42:10,722040,04/23/2011 19:30:03,1,0,XIRR implementation in Delphi,"I could not find a descent answer for XIRR implementation in Delphi awhile ago and had to compile the following function;

    function XIRR(Values: array of double; Dates: array of tDateTime; var Rate: double): Boolean;
    const MAX_STEPS = 100;

        function CalcValue(Rate: double): double;
            function disc(d: tDateTime; v: double): double;
            var
                Exp, coef: double;
            begin
                Exp := (d - Dates[0]) / 365;
                coef := Power(1 + Rate / 100, Exp);
                result := v / coef;
             end;
        var
            i: integer;
        begin
            result := 0;
            for i := 0 to High(Dates) do
                result := result + disc(Dates[i], Values[i]);
        end;

    var
        SaveFPUCW: word;
        CWChgReq: Boolean;
        Rate1, Rate2, RateN: double;
        F1, F2, FN, dF, Scale: double;
        Quit: Boolean;
        N: integer;
    begin
        RateN := 0;
        FN := 0;
        Assert(length(Values) = length(Dates));
        Assert(length(Values) >= 2);
        SaveFPUCW := Get8087CW;
        CWChgReq := (SaveFPUCW and $1F3F) <> $1332;
        If CWChgReq then Set8087CW($1332);
        try
            result := true;
            Rate1 := Rate;
            Rate2 := Rate + 1;
            Quit := false;
            N := 0;
            Scale := 1;
            F1 := CalcValue(Rate1);
            F2 := CalcValue(Rate2);
            while not Quit do
            begin
                if (F2 = F1) or (Rate2 = Rate1) then
                begin
                    Quit := true;
                    result := false;
                end
                else
                begin
                    dF := (F2 - F1) / (Rate2 - Rate1);
                    RateN := Rate1 + (0 - F1) / dF / Scale;
                    N := N + 1;
                    if RateN > -100 then  := CalcValue(RateN);
                    if Abs(RateN - Rate1) / ((Abs(Rate1) + Abs(Rate2)) / 2) < 0.0000005 then 
                        Quit := true
                    else if N >= MAX_STEPS then
                    begin
                        Quit := true;
                        result := false;
                    end
                    else if not(RateN > -100) then
                    begin
                        Scale := Scale * 2;
                    end
                    else
                    begin
                        Scale := 1;
                        Rate2 := Rate1;
                        F2 := F1;
                        Rate1 := RateN;
                        F1 := FN;
                    end;
                end;
            end;
            if result then Rate := RateN
            else Rate := 0;
        Finally
            If CWChgReq then Set8087CW(SaveFPUCW);
        end;
    end;

I hope it may be useful to anyone still coding in Delphi or Pascal.

Regards
 ",delphi,pascal,,,,06/15/2011 01:52:51,not a real question,1,1383,4,"XIRR implementation in Delphi I could not find a descent answer for XIRR implementation in Delphi awhile ago and had to compile the following function;

    function XIRR(Values: array of double; Dates: array of tDateTime; var Rate: double): Boolean;
    const MAX_STEPS = 100;

        function CalcValue(Rate: double): double;
            function disc(d: tDateTime; v: double): double;
            var
                Exp, coef: double;
            begin
                Exp := (d - Dates[0]) / 365;
                coef := Power(1 + Rate / 100, Exp);
                result := v / coef;
             end;
        var
            i: integer;
        begin
            result := 0;
            for i := 0 to High(Dates) do
                result := result + disc(Dates[i], Values[i]);
        end;

    var
        SaveFPUCW: word;
        CWChgReq: Boolean;
        Rate1, Rate2, RateN: double;
        F1, F2, FN, dF, Scale: double;
        Quit: Boolean;
        N: integer;
    begin
        RateN := 0;
        FN := 0;
        Assert(length(Values) = length(Dates));
        Assert(length(Values) >= 2);
        SaveFPUCW := Get8087CW;
        CWChgReq := (SaveFPUCW and $1F3F) <> $1332;
        If CWChgReq then Set8087CW($1332);
        try
            result := true;
            Rate1 := Rate;
            Rate2 := Rate + 1;
            Quit := false;
            N := 0;
            Scale := 1;
            F1 := CalcValue(Rate1);
            F2 := CalcValue(Rate2);
            while not Quit do
            begin
                if (F2 = F1) or (Rate2 = Rate1) then
                begin
                    Quit := true;
                    result := false;
                end
                else
                begin
                    dF := (F2 - F1) / (Rate2 - Rate1);
                    RateN := Rate1 + (0 - F1) / dF / Scale;
                    N := N + 1;
                    if RateN > -100 then  := CalcValue(RateN);
                    if Abs(RateN - Rate1) / ((Abs(Rate1) + Abs(Rate2)) / 2) < 0.0000005 then 
                        Quit := true
                    else if N >= MAX_STEPS then
                    begin
                        Quit := true;
                        result := false;
                    end
                    else if not(RateN > -100) then
                    begin
                        Scale := Scale * 2;
                    end
                    else
                    begin
                        Scale := 1;
                        Rate2 := Rate1;
                        F2 := F1;
                        Rate1 := RateN;
                        F1 := FN;
                    end;
                end;
            end;
            if result then Rate := RateN
            else Rate := 0;
        Finally
            If CWChgReq then Set8087CW(SaveFPUCW);
        end;
    end;

I hope it may be useful to anyone still coding in Delphi or Pascal.

Regards
 ",2
9623430,03/08/2012 19:13:02,622097,02/17/2011 20:41:53,254,2,How to convert bitmaps to video?,"My application creates images from fractals and I love the feeling of 'flying' around a fractal. I once saved about 2000 bitmaps to file and created an AVI from it using Premiere. That experience is rather frustrating though I succeeded in creating a movie. That was spectacular. Of course I want to create a video from my application. I actually don't care about the niftyness of the codec, compression or whatever. I just want to have a video that I can replay on most systems.

In the past I have tried this but never succeeded. I was triggered by a [question][1] yesterday but alas could not get FFMpeg running. I tried TAviWriter again but cannot get past the opening of the temporary video file (`REGDB_E_CLASSNOTREG: raise Exception.Create('According to the registry, the type of file specified in AVIFileOpen does not have a handler to process it.');`, see code below).

Question: is there a reasonable simple way in Delphi with source to create a video (AVI, MPEG, WMF) that can be played on most systems. If someone got TAviWriter working I'd love to hear about it. 

Using Delphi XE.


    procedure TAviWriter.AddVideo;
    var
      Pstream               : PAVISTREAM;
      StreamInfo		: TAVIStreamInfo;
      BitmapInfo		: PBitmapInfoHeader;
      BitmapInfoSize	: Integer;
      BitmapSize		: longInt;
      BitmapBits		: pointer;
      Bitmap                : TBitmap;
      ExtBitmap             : TBitmap;
      Samples_Written       : LONG;
      Bytes_Written         : LONG;
      AVIERR                : integer;
      i                     : integer;
    //  startpos              : DWORD;
    //  len                   : DWORD;
      ok: System.HRESULT;
    begin
    // function AVIFileOpen(var ppfile: PAVIFile; szFile: PChar; uMode: UINT; lpHandler: pointer): HResult; stdcall;
    
       BitmapBits := nil; // Fool the compiler
       BitmapInfo := nil; // Fool the compiler
    
        // Open AVI file for write
        ok := AVIFileOpen(pFile, pchar(TempFileName), OF_WRITE or OF_CREATE {OR OF_SHARE_EXCLUSIVE}, nil);
        case ok of
           AVIERR_BADFORMAT:    raise Exception.Create('The file could not be read, indicating a corrupt file or an unrecognized format.');
           AVIERR_MEMORY:       raise Exception.Create('The file could not be opened because of insufficient memory.');
           AVIERR_FILEREAD:     raise Exception.Create('A disk error occurred while reading the file.');
           AVIERR_FILEOPEN:     raise Exception.Create('A disk error occurred while opening the file.');
           REGDB_E_CLASSNOTREG: raise Exception.Create('According to the registry, the type of file specified in AVIFileOpen does not have a handler to process it.');
        end; // case
    //    if (ok <> AVIERR_OK)
    //      then raise Exception.Create('Failed to create AVI video work file');
    
        // Allocate the bitmap to which the bitmaps on the Bitmaps Tlist
        // will be copied.
        Bitmap        := TBitmap.create;
        Bitmap.Height := self.Height;
        Bitmap.Width  := self.Width;
    
        // Write the stream header.
        try
           FillChar(StreamInfo, sizeof(StreamInfo), 0);
    
           // Set frame rate and scale
           StreamInfo.dwRate := 1000;
           StreamInfo.dwScale := fFrameTime;
           StreamInfo.fccType := streamtypeVIDEO;
           StreamInfo.fccHandler := 0;
           StreamInfo.dwFlags := 0;
           StreamInfo.dwSuggestedBufferSize := 0;
           StreamInfo.rcFrame.Right := self.width;
           StreamInfo.rcFrame.Bottom := self.height;
    
           // Open AVI data stream
           if (AVIFileCreateStream(pFile, pStream, StreamInfo) <> AVIERR_OK) then
               raise Exception.Create('Failed to create AVI video stream');
    
           try
              // Write the bitmaps to the stream.
              for i := 0 to Bitmaps.count - 1 do begin
                 try
                   BitmapInfo := nil;
                   BitmapBits := nil;
    
                   // Copy the bitmap from the list to the AVI bitmap,
                   // stretching if desired. If the caller elects not to
                   // stretch, use the first pixel in the bitmap as a
                   // background color in case either the height or
                   // width of the source is smaller than the output.
                   // If Draw fails, do a StretchDraw.
                   ExtBitmap := Bitmaps[i];
                   if fStretch
                      then Bitmap.Canvas.StretchDraw
                               (Rect(0,0,self.width,self.height),ExtBitmap)
                      else try
                             with Bitmap.Canvas do begin
                                Brush.Color := ExtBitmap.Canvas.Pixels[0,0];
                                Brush.Style := bsSolid;
                                FillRect(Rect(0,0,Bitmap.Width,Bitmap.Height));
                                Draw(0,0,ExtBitmap);
                             end;
                           except
                             Bitmap.Canvas.StretchDraw
                                (Rect(0,0,self.width,self.height),ExtBitmap);
                           end;
    
                   // Determine size of DIB
                   InternalGetDIBSizes(Bitmap.Handle, BitmapInfoSize, BitmapSize, pf8bit);
                   if (BitmapInfoSize = 0) then
                      raise Exception.Create('Failed to retrieve bitmap info');
    
                   // Get DIB header and pixel buffers
                   GetMem(BitmapInfo, BitmapInfoSize);
                   GetMem(BitmapBits, BitmapSize);
                   InternalGetDIB
                         (Bitmap.Handle, 0, BitmapInfo^, BitmapBits^, pf8bit);
    
                   // On the first time through, set the stream format.
                   if i = 0 then
                      if (AVIStreamSetFormat(pStream, 0, BitmapInfo, BitmapInfoSize) <> AVIERR_OK) then
                          raise Exception.Create('Failed to set AVI stream format');
    
                   // Write frame to the video stream
                   AVIERR :=
                      AVIStreamWrite(pStream, i, 1, BitmapBits, BitmapSize, AVIIF_KEYFRAME,
                                 Samples_Written, Bytes_Written);
                   if AVIERR <> AVIERR_OK then
                        raise Exception.Create
                                ('Failed to add frame to AVI. Err='
                                   + inttohex(AVIERR,8));
                 finally
                   if (BitmapInfo <> nil) then
                     FreeMem(BitmapInfo);
                   if (BitmapBits <> nil) then
                     FreeMem(BitmapBits);
                 end;
              end;
    
              // Create the editable VideoStream from pStream.
              if CreateEditableStream(VideoStream,pStream) <> AVIERR_OK then
                        raise Exception.Create
                                ('Could not create Video Stream');
           finally
              AviStreamRelease(pStream);
           end;
    
        finally
          Bitmap.free;
        end;
    end;

  [1]: http://stackoverflow.com/questions/9584025/creating-a-motion-jpeg-frame-by-frame-with-variable-frame-rate
",delphi,video,bitmap,video-encoding,,,open,0,2577,6,"How to convert bitmaps to video? My application creates images from fractals and I love the feeling of 'flying' around a fractal. I once saved about 2000 bitmaps to file and created an AVI from it using Premiere. That experience is rather frustrating though I succeeded in creating a movie. That was spectacular. Of course I want to create a video from my application. I actually don't care about the niftyness of the codec, compression or whatever. I just want to have a video that I can replay on most systems.

In the past I have tried this but never succeeded. I was triggered by a [question][1] yesterday but alas could not get FFMpeg running. I tried TAviWriter again but cannot get past the opening of the temporary video file (`REGDB_E_CLASSNOTREG: raise Exception.Create('According to the registry, the type of file specified in AVIFileOpen does not have a handler to process it.');`, see code below).

Question: is there a reasonable simple way in Delphi with source to create a video (AVI, MPEG, WMF) that can be played on most systems. If someone got TAviWriter working I'd love to hear about it. 

Using Delphi XE.


    procedure TAviWriter.AddVideo;
    var
      Pstream               : PAVISTREAM;
      StreamInfo		: TAVIStreamInfo;
      BitmapInfo		: PBitmapInfoHeader;
      BitmapInfoSize	: Integer;
      BitmapSize		: longInt;
      BitmapBits		: pointer;
      Bitmap                : TBitmap;
      ExtBitmap             : TBitmap;
      Samples_Written       : LONG;
      Bytes_Written         : LONG;
      AVIERR                : integer;
      i                     : integer;
    //  startpos              : DWORD;
    //  len                   : DWORD;
      ok: System.HRESULT;
    begin
    // function AVIFileOpen(var ppfile: PAVIFile; szFile: PChar; uMode: UINT; lpHandler: pointer): HResult; stdcall;
    
       BitmapBits := nil; // Fool the compiler
       BitmapInfo := nil; // Fool the compiler
    
        // Open AVI file for write
        ok := AVIFileOpen(pFile, pchar(TempFileName), OF_WRITE or OF_CREATE {OR OF_SHARE_EXCLUSIVE}, nil);
        case ok of
           AVIERR_BADFORMAT:    raise Exception.Create('The file could not be read, indicating a corrupt file or an unrecognized format.');
           AVIERR_MEMORY:       raise Exception.Create('The file could not be opened because of insufficient memory.');
           AVIERR_FILEREAD:     raise Exception.Create('A disk error occurred while reading the file.');
           AVIERR_FILEOPEN:     raise Exception.Create('A disk error occurred while opening the file.');
           REGDB_E_CLASSNOTREG: raise Exception.Create('According to the registry, the type of file specified in AVIFileOpen does not have a handler to process it.');
        end; // case
    //    if (ok <> AVIERR_OK)
    //      then raise Exception.Create('Failed to create AVI video work file');
    
        // Allocate the bitmap to which the bitmaps on the Bitmaps Tlist
        // will be copied.
        Bitmap        := TBitmap.create;
        Bitmap.Height := self.Height;
        Bitmap.Width  := self.Width;
    
        // Write the stream header.
        try
           FillChar(StreamInfo, sizeof(StreamInfo), 0);
    
           // Set frame rate and scale
           StreamInfo.dwRate := 1000;
           StreamInfo.dwScale := fFrameTime;
           StreamInfo.fccType := streamtypeVIDEO;
           StreamInfo.fccHandler := 0;
           StreamInfo.dwFlags := 0;
           StreamInfo.dwSuggestedBufferSize := 0;
           StreamInfo.rcFrame.Right := self.width;
           StreamInfo.rcFrame.Bottom := self.height;
    
           // Open AVI data stream
           if (AVIFileCreateStream(pFile, pStream, StreamInfo) <> AVIERR_OK) then
               raise Exception.Create('Failed to create AVI video stream');
    
           try
              // Write the bitmaps to the stream.
              for i := 0 to Bitmaps.count - 1 do begin
                 try
                   BitmapInfo := nil;
                   BitmapBits := nil;
    
                   // Copy the bitmap from the list to the AVI bitmap,
                   // stretching if desired. If the caller elects not to
                   // stretch, use the first pixel in the bitmap as a
                   // background color in case either the height or
                   // width of the source is smaller than the output.
                   // If Draw fails, do a StretchDraw.
                   ExtBitmap := Bitmaps[i];
                   if fStretch
                      then Bitmap.Canvas.StretchDraw
                               (Rect(0,0,self.width,self.height),ExtBitmap)
                      else try
                             with Bitmap.Canvas do begin
                                Brush.Color := ExtBitmap.Canvas.Pixels[0,0];
                                Brush.Style := bsSolid;
                                FillRect(Rect(0,0,Bitmap.Width,Bitmap.Height));
                                Draw(0,0,ExtBitmap);
                             end;
                           except
                             Bitmap.Canvas.StretchDraw
                                (Rect(0,0,self.width,self.height),ExtBitmap);
                           end;
    
                   // Determine size of DIB
                   InternalGetDIBSizes(Bitmap.Handle, BitmapInfoSize, BitmapSize, pf8bit);
                   if (BitmapInfoSize = 0) then
                      raise Exception.Create('Failed to retrieve bitmap info');
    
                   // Get DIB header and pixel buffers
                   GetMem(BitmapInfo, BitmapInfoSize);
                   GetMem(BitmapBits, BitmapSize);
                   InternalGetDIB
                         (Bitmap.Handle, 0, BitmapInfo^, BitmapBits^, pf8bit);
    
                   // On the first time through, set the stream format.
                   if i = 0 then
                      if (AVIStreamSetFormat(pStream, 0, BitmapInfo, BitmapInfoSize) <> AVIERR_OK) then
                          raise Exception.Create('Failed to set AVI stream format');
    
                   // Write frame to the video stream
                   AVIERR :=
                      AVIStreamWrite(pStream, i, 1, BitmapBits, BitmapSize, AVIIF_KEYFRAME,
                                 Samples_Written, Bytes_Written);
                   if AVIERR <> AVIERR_OK then
                        raise Exception.Create
                                ('Failed to add frame to AVI. Err='
                                   + inttohex(AVIERR,8));
                 finally
                   if (BitmapInfo <> nil) then
                     FreeMem(BitmapInfo);
                   if (BitmapBits <> nil) then
                     FreeMem(BitmapBits);
                 end;
              end;
    
              // Create the editable VideoStream from pStream.
              if CreateEditableStream(VideoStream,pStream) <> AVIERR_OK then
                        raise Exception.Create
                                ('Could not create Video Stream');
           finally
              AviStreamRelease(pStream);
           end;
    
        finally
          Bitmap.free;
        end;
    end;

  [1]: http://stackoverflow.com/questions/9584025/creating-a-motion-jpeg-frame-by-frame-with-variable-frame-rate
",4
9596477,03/07/2012 05:50:21,1244346,03/02/2012 05:24:55,8,0,Client-Server program on Indy components,"Kind time of days. 
 Actually the question big, is required to write the client-server appendix, the server is on 1 computer with base MySQL, client programs will be nearby 150. Structure, the client should become authorized on the server appendix to transfer the data, and the server appendix processes the data and writes down in MySQL (the authorization mode is very important), as if on a site haven'ted also the data have got to base, the server should transfer given to the client. (Not to all clients, and defined on id).
 How it is possible to realize it for the minimum time and to get stable work.
It is necessary to realize on Indy components.
 But I can not put mind, first as it will be more reliable, secondly how to realize authorization how to transfer and operate the tabular data through sockets between applications, on clients local base Access will work either through MyDAC or through ADOConnection a final position of DB MySQL. Help to understand please.

 P.S. That is (the server and the client) 2 programs are required from the client a local DB, and on the server personal computer already global DB, but the data should be processed by the server appendix.",delphi,,,,,03/08/2012 19:47:26,not a real question,1,205,5,"Client-Server program on Indy components Kind time of days. 
 Actually the question big, is required to write the client-server appendix, the server is on 1 computer with base MySQL, client programs will be nearby 150. Structure, the client should become authorized on the server appendix to transfer the data, and the server appendix processes the data and writes down in MySQL (the authorization mode is very important), as if on a site haven'ted also the data have got to base, the server should transfer given to the client. (Not to all clients, and defined on id).
 How it is possible to realize it for the minimum time and to get stable work.
It is necessary to realize on Indy components.
 But I can not put mind, first as it will be more reliable, secondly how to realize authorization how to transfer and operate the tabular data through sockets between applications, on clients local base Access will work either through MyDAC or through ADOConnection a final position of DB MySQL. Help to understand please.

 P.S. That is (the server and the client) 2 programs are required from the client a local DB, and on the server personal computer already global DB, but the data should be processed by the server appendix.",1
11593034,07/21/2012 14:34:49,581315,01/19/2011 11:13:03,1,0,How many classes per unit are advisable to have?,"My question is specific to Delphi. I think that in Java and C# world it is a rather accepted practice to generally have one module per class. I think this is a good rule to follow in Delphi too, because in Delphi private members aren't really private if you have more than one class in a unit. 

So I was surprised to hear from two different senior (and probably more experienced than I am) programmers tell me I divide my code too much. One of them told me to not be shy about placing 5-6 classes in a unit.

Is there some issue with ""one class per module"" rule that I am not aware of? And is ""5-6 classes per unit"" a good recommendation?

I do not mean to take these rules as absolutes. Surely there can be situations when it is appropriate to do either way. I am asking about the general rule.",delphi,delphi-7,,,,07/24/2012 02:51:00,not constructive,1,152,9,"How many classes per unit are advisable to have? My question is specific to Delphi. I think that in Java and C# world it is a rather accepted practice to generally have one module per class. I think this is a good rule to follow in Delphi too, because in Delphi private members aren't really private if you have more than one class in a unit. 

So I was surprised to hear from two different senior (and probably more experienced than I am) programmers tell me I divide my code too much. One of them told me to not be shy about placing 5-6 classes in a unit.

Is there some issue with ""one class per module"" rule that I am not aware of? And is ""5-6 classes per unit"" a good recommendation?

I do not mean to take these rules as absolutes. Surely there can be situations when it is appropriate to do either way. I am asking about the general rule.",2
6396585,06/18/2011 14:10:31,759588,05/18/2011 16:27:12,666,20,Need a sample of using TIdTelnet to interact with telnet server,"I tried to employ Indy 10.5.5 (shipped with Delphi 2010) for:

 - connecting to telnet server
 - performing username/password authentication
 - executing a command with returning resulting data back to application

and had no success, additionally i'm completely lost in spaghetti logic of Indy's internals and now have no idea why it didnt work or how i supposed to send strings to the server and grab the results. Need some sample code to study.",delphi,telnet,indy,,,,open,0,73,11,"Need a sample of using TIdTelnet to interact with telnet server I tried to employ Indy 10.5.5 (shipped with Delphi 2010) for:

 - connecting to telnet server
 - performing username/password authentication
 - executing a command with returning resulting data back to application

and had no success, additionally i'm completely lost in spaghetti logic of Indy's internals and now have no idea why it didnt work or how i supposed to send strings to the server and grab the results. Need some sample code to study.",3
11122197,06/20/2012 14:50:01,1469584,06/20/2012 14:35:01,1,0,Why does memo.Lines use TStrings instead of TStringList?,"Why does Memo.Lines use the abstract class TStrings? Why doesn't it use TStringList instead?

And should I convert it to TStringList before working with it?",delphi,tstringlist,memo,,,,open,0,24,8,"Why does memo.Lines use TStrings instead of TStringList? Why does Memo.Lines use the abstract class TStrings? Why doesn't it use TStringList instead?

And should I convert it to TStringList before working with it?",3
9842422,03/23/2012 15:56:43,875317,08/02/2011 19:11:50,535,8,"Any tool to document Delphi code, especially as regards data-bound controls?","I am engaged in a very tedious process of documenting legacy Delphi code.

One of the main things I need to do is: for each databound control, determine what its Data Source is, look at the DataSource to see what its Dataset is, and then document that, whether it's Table1.Column1 or ""Select * from TheSky Where MoonIsDark"" or whatever.

Is there some tool (free/open source) that, on being fed .pas and .dfm files, will generate such a report? Or am I doomed to repeat history in a mind-numbing fashion?",delphi,documentation-generation,dfm,,,03/23/2012 20:50:44,not constructive,1,87,11,"Any tool to document Delphi code, especially as regards data-bound controls? I am engaged in a very tedious process of documenting legacy Delphi code.

One of the main things I need to do is: for each databound control, determine what its Data Source is, look at the DataSource to see what its Dataset is, and then document that, whether it's Table1.Column1 or ""Select * from TheSky Where MoonIsDark"" or whatever.

Is there some tool (free/open source) that, on being fed .pas and .dfm files, will generate such a report? Or am I doomed to repeat history in a mind-numbing fashion?",3
4193145,11/16/2010 10:27:16,215333,11/20/2009 10:33:13,30,0,OpenOffice Calc automation how alter a chart label of a scatter diagram,"Hello could you please help me with the following. I have created a scattered chart and draw a chart from data of a column. The used data is not just after the cell which determines the label:

    Column O:

    Pwm1   <-- This is the cell I want to see as the label
    27114  <-- not used data for graph
    27055  <-- etc
    27092
    27070  <-- data for graph starts here
    27105
    27024
    27092  <-- data for graph ends here



I would like the LABEL cell to appear as the Y column label name (Is now 'Column O'), but how?
This as far as I got (code is Delphi but if someone could help me with a basic example that's ok too):

    (* Turn the symbol of the data points off *)
    oChart.Diagram.SymbolType := _chartChartSymbolTypeNONE;

    oDataSeries := oChart.getUsedData;
    oDataSequences := oDataSeries.getDataSequences;
    ShowMessage(oDataSequences[1].Label.SourceRangeRepresentation);
 
SourceRangeRepresentation returns the current label, but how to change?

Thanks Ad",delphi,automation,openoffice-calc,,,,open,0,197,12,"OpenOffice Calc automation how alter a chart label of a scatter diagram Hello could you please help me with the following. I have created a scattered chart and draw a chart from data of a column. The used data is not just after the cell which determines the label:

    Column O:

    Pwm1   <-- This is the cell I want to see as the label
    27114  <-- not used data for graph
    27055  <-- etc
    27092
    27070  <-- data for graph starts here
    27105
    27024
    27092  <-- data for graph ends here



I would like the LABEL cell to appear as the Y column label name (Is now 'Column O'), but how?
This as far as I got (code is Delphi but if someone could help me with a basic example that's ok too):

    (* Turn the symbol of the data points off *)
    oChart.Diagram.SymbolType := _chartChartSymbolTypeNONE;

    oDataSeries := oChart.getUsedData;
    oDataSequences := oDataSeries.getDataSequences;
    ShowMessage(oDataSequences[1].Label.SourceRangeRepresentation);
 
SourceRangeRepresentation returns the current label, but how to change?

Thanks Ad",3
10923803,06/06/2012 23:36:46,1396435,05/15/2012 14:35:47,16,1,Handle Needed For Firemonkey,"How can i set the handle needed property for a form in firemonkey. In normal delphi I use to create forms inside other components at run time. IE:

    Form1 := TForm1.Create(Panel1);
    Form1.Parent := Panel1;
    Form1.HandleNeeded;

But now in Firemonkey there are no Handles per say. So is there another way i can do this.
It is pretty essential that it has the parent Panel1 as the form has to only show in panel1 and no where else on the screen",delphi,handle,firemonkey,,,,open,0,87,4,"Handle Needed For Firemonkey How can i set the handle needed property for a form in firemonkey. In normal delphi I use to create forms inside other components at run time. IE:

    Form1 := TForm1.Create(Panel1);
    Form1.Parent := Panel1;
    Form1.HandleNeeded;

But now in Firemonkey there are no Handles per say. So is there another way i can do this.
It is pretty essential that it has the parent Panel1 as the form has to only show in panel1 and no where else on the screen",3
8900974,01/17/2012 20:05:09,71200,02/26/2009 04:12:24,4849,172,Delphi 32 bit app Can't find registry key that was written by 32 bit installer in Wow64 in Windows 7,"While researching this problem I came across [this][1] question. I'm having the exact same problem accept my program is already running as administrator and is already accessing the registry using `TRegistry.Create(KEY_READ)`.

The key I'm trying to access is `HKLM\Software\FireBird Project\Firebird Server\Instances`. The way I understand it (and correct me if I'm wrong) is that the registry redirector is enabled by default for any 32 bit process that reads or writes to HKLM\Software unless it is explicitly disabled.

Is there any way to tell if this the case with this key? I've looked through the source for the win32 firebird installer and nothing stuck out.

  [1]: http://stackoverflow.com/q/8864595/71200",delphi,registry,32bit-64bit,firebird,,01/18/2012 22:29:23,too localized,1,105,20,"Delphi 32 bit app Can't find registry key that was written by 32 bit installer in Wow64 in Windows 7 While researching this problem I came across [this][1] question. I'm having the exact same problem accept my program is already running as administrator and is already accessing the registry using `TRegistry.Create(KEY_READ)`.

The key I'm trying to access is `HKLM\Software\FireBird Project\Firebird Server\Instances`. The way I understand it (and correct me if I'm wrong) is that the registry redirector is enabled by default for any 32 bit process that reads or writes to HKLM\Software unless it is explicitly disabled.

Is there any way to tell if this the case with this key? I've looked through the source for the win32 firebird installer and nothing stuck out.

  [1]: http://stackoverflow.com/q/8864595/71200",4
8533766,12/16/2011 11:51:24,368364,06/16/2010 14:52:22,2859,100,Delphi - Exception handling on it's own constructor after it is raised,"The question is: after am raising an exception, can I stop it to propagate from it's own constructor? consider the code bellow:

    unit Unit2;
    
    interface
    
    uses
      Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
      Dialogs;
    
    type
      TMyErrorClass = class(Exception)
        constructor Create(aMsg:String);//override;reintroduce;
      end;
      TForm2 = class(TForm)
        procedure FormCreate(Sender: TObject);
      private
        { Private declarations }
      public
        { Public declarations }
      end;
    
    var
      Form2: TForm2;
    
    implementation
    
    {$R *.dfm}
    
    procedure TForm2.FormCreate(Sender: TObject);
    begin
    //
     raise TMyErrorClass.Create('test');
    end;
    
    { TMyErrorClass}
    
    constructor TMyErrorClass.Create(aMsg: String);
    begin
     {$IFDEF DEBUG}
       Showmessage(aMsg);
     {$ELSE}
      //here I want to 'kill' the exception
     {$ENDIF}
    end;
    
    end.

After raise is called, how can I terminate the Exception, without adding try except/finally where I'm raising the exception? ",delphi,exception-handling,delphi-2006,,,,open,0,300,12,"Delphi - Exception handling on it's own constructor after it is raised The question is: after am raising an exception, can I stop it to propagate from it's own constructor? consider the code bellow:

    unit Unit2;
    
    interface
    
    uses
      Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
      Dialogs;
    
    type
      TMyErrorClass = class(Exception)
        constructor Create(aMsg:String);//override;reintroduce;
      end;
      TForm2 = class(TForm)
        procedure FormCreate(Sender: TObject);
      private
        { Private declarations }
      public
        { Public declarations }
      end;
    
    var
      Form2: TForm2;
    
    implementation
    
    {$R *.dfm}
    
    procedure TForm2.FormCreate(Sender: TObject);
    begin
    //
     raise TMyErrorClass.Create('test');
    end;
    
    { TMyErrorClass}
    
    constructor TMyErrorClass.Create(aMsg: String);
    begin
     {$IFDEF DEBUG}
       Showmessage(aMsg);
     {$ELSE}
      //here I want to 'kill' the exception
     {$ENDIF}
    end;
    
    end.

After raise is called, how can I terminate the Exception, without adding try except/finally where I'm raising the exception? ",3
8722191,01/04/2012 04:53:51,346571,01/22/2010 23:26:48,2619,70,TStyleManager.SetStyle leaves visual components on other TPageControls not visible,"A MainMenu option in my app calls: 

        TStyleManager.SetStyle('Ruby Graphite');

It properly changes the style in my XE2 (Update 3) application almost everywhere. Here's the problem:

I have a TPageControl with 3 TabSheets, each containing a TFrame.  The above call properly changes the style of the _currently visible_ TabSheet's components to 'Ruby Graphite'.

However, when I click to switch to _another_ tabsheet,  all of its components are invisible until I move my mouse over them. When I return to the original TabSheet, its components too are now not visible until I hover over them.

I tried explicitly calling .Refresh and .Repaint on the frames themselves, but that didn't make the components on them visible.

What's weird is that executing:

        TStyleManager.SetStyle('Windows');

returns the style to the standard, _with all components visible._

The TTabSheet is on a panel which is on a panel, if that matters. And, I'm using some 3rd party components (not in these frames) that are threaded. I believe that I have disabled them though.

Any suggestions on how to force the visual components on a formerly hidden tab to become visible after changing the style from Windows?

",delphi,,,,,,open,0,197,9,"TStyleManager.SetStyle leaves visual components on other TPageControls not visible A MainMenu option in my app calls: 

        TStyleManager.SetStyle('Ruby Graphite');

It properly changes the style in my XE2 (Update 3) application almost everywhere. Here's the problem:

I have a TPageControl with 3 TabSheets, each containing a TFrame.  The above call properly changes the style of the _currently visible_ TabSheet's components to 'Ruby Graphite'.

However, when I click to switch to _another_ tabsheet,  all of its components are invisible until I move my mouse over them. When I return to the original TabSheet, its components too are now not visible until I hover over them.

I tried explicitly calling .Refresh and .Repaint on the frames themselves, but that didn't make the components on them visible.

What's weird is that executing:

        TStyleManager.SetStyle('Windows');

returns the style to the standard, _with all components visible._

The TTabSheet is on a panel which is on a panel, if that matters. And, I'm using some 3rd party components (not in these frames) that are threaded. I believe that I have disabled them though.

Any suggestions on how to force the visual components on a formerly hidden tab to become visible after changing the style from Windows?

",1
5105714,02/24/2011 14:09:20,628206,02/22/2011 11:28:40,13,0,Turning parts of code on or off in delphi,"I have created this form with edit fields where I can add information that is saved to a Inifile. I have 'Start' button which I select when I want the information to be recorded when it is typed in. The user will click  the 'start' button. Can type the information in the fields. When there is a pause for about 10 seconds. The text that is in the edit fields at that stage is filled in the Inifile and the fields are cleared. (i got this code)

Now there is another button which says 'finished'. When the user clicks on this the code is no longer saved from the edit fields. But its the load code, it then checks if the edit field holds one of the parts of information that has been typed before and checks it to the inifile. (i have that code).

I want to know how i can make the change from: Start---- code is saving continuesly -----finished------ Stops saving into inifile and starts reading and loading. This should be repeatable somehow. In a way its like turning code on and off in these 'start' and 'finish' buttons. Is this possible? is so how?",delphi,,,,,02/24/2011 15:25:12,not a real question,1,197,9,"Turning parts of code on or off in delphi I have created this form with edit fields where I can add information that is saved to a Inifile. I have 'Start' button which I select when I want the information to be recorded when it is typed in. The user will click  the 'start' button. Can type the information in the fields. When there is a pause for about 10 seconds. The text that is in the edit fields at that stage is filled in the Inifile and the fields are cleared. (i got this code)

Now there is another button which says 'finished'. When the user clicks on this the code is no longer saved from the edit fields. But its the load code, it then checks if the edit field holds one of the parts of information that has been typed before and checks it to the inifile. (i have that code).

I want to know how i can make the change from: Start---- code is saving continuesly -----finished------ Stops saving into inifile and starts reading and loading. This should be repeatable somehow. In a way its like turning code on and off in these 'start' and 'finish' buttons. Is this possible? is so how?",1
7373600,09/10/2011 18:05:31,872578,08/01/2011 10:04:30,40,1,128 bit operation with delphi,"i need to convert a hexadecimal value to a decimal integer; there some unit that can to do it? On web i have found something about it but not help me much. I have understood that using asm inline is possible represent it as a packed array of four integer to 32 bit; i have found as convert a int32 or int64 to int128 and viceversa, but not found nothing for take for example two int64 and to do a int128 and too i have found issue searching in asm inline something that emule div operator, mul operator and sum operator.
So i ask if someoune can help me to solve this problem. My objective is take a string in hexadecimal and convert in decimal and after calc equivalent value in base 35 (0..9, A..Z).
Thanks very much.",delphi,math,delphi-xe2,,,,open,0,136,5,"128 bit operation with delphi i need to convert a hexadecimal value to a decimal integer; there some unit that can to do it? On web i have found something about it but not help me much. I have understood that using asm inline is possible represent it as a packed array of four integer to 32 bit; i have found as convert a int32 or int64 to int128 and viceversa, but not found nothing for take for example two int64 and to do a int128 and too i have found issue searching in asm inline something that emule div operator, mul operator and sum operator.
So i ask if someoune can help me to solve this problem. My objective is take a string in hexadecimal and convert in decimal and after calc equivalent value in base 35 (0..9, A..Z).
Thanks very much.",3
9946850,03/30/2012 16:25:41,368364,06/16/2010 14:52:22,3329,111,Delphi - online tests,"I have searched for some online Delphi programming tests, and except the small test for Delphi certification and several tests on [Delphi.about.com][1] I did find nothing. Any ideas where I can find some Delphi online tests?


  [1]: http://Delphi.about.com",delphi,,,,,03/31/2012 03:25:46,not constructive,1,39,4,"Delphi - online tests I have searched for some online Delphi programming tests, and except the small test for Delphi certification and several tests on [Delphi.about.com][1] I did find nothing. Any ideas where I can find some Delphi online tests?


  [1]: http://Delphi.about.com",1
8555738,12/18/2011 23:37:47,701267,04/10/2011 21:30:41,183,0,Access to public methods and properties inside a DELPHI BPL,"I have an application that loads a BPL that as inside a simple form.

This form is an optional option of the main application.

The BPL loads correctly, the form is shown correctly, but I don’t know how to access the public methods and properties of the form inside the bpl.

Can anyone provide a simple example. 

Thanks
",delphi,module,bpl,,,,open,0,55,10,"Access to public methods and properties inside a DELPHI BPL I have an application that loads a BPL that as inside a simple form.

This form is an optional option of the main application.

The BPL loads correctly, the form is shown correctly, but I don’t know how to access the public methods and properties of the form inside the bpl.

Can anyone provide a simple example. 

Thanks
",3
10341655,04/26/2012 21:25:24,1332636,04/13/2012 23:17:26,6,0,TIEHTTP component doesnt work with IE9,"i try to use TIEHTTP component in my delphi application 
but got some problem , my application runs fine in xp with ie8 but it doest work in windows 7 with IE9 (it return a page but without logging in)

ive tried delphi 7 d2007 and D 2009 same problem

ive did a search about the problem and found that solution but it doesnt work !!

http://www.myfxboard.com/tiehttp/discussion?id=4273

so i dunno what to do !! please help how to fix this in IE9 !!

    //iehttp1.http_agent_string := 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.6 (KHTML, like Gecko) Chrome/20.0.1092.0 Safari/536.6';
    //iehttp1.content_type := 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' ;
    
    iehttp1.RequestMethod := 'POST';
    
    iehttp1.ExecuteURL('http://www.mysite.net/act=login&login=[user]&password[pass]');
    
    memo1.Text  := iehttp1.result_sl.Text   ;

",delphi,http,,,,,open,0,134,6,"TIEHTTP component doesnt work with IE9 i try to use TIEHTTP component in my delphi application 
but got some problem , my application runs fine in xp with ie8 but it doest work in windows 7 with IE9 (it return a page but without logging in)

ive tried delphi 7 d2007 and D 2009 same problem

ive did a search about the problem and found that solution but it doesnt work !!

http://www.myfxboard.com/tiehttp/discussion?id=4273

so i dunno what to do !! please help how to fix this in IE9 !!

    //iehttp1.http_agent_string := 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.6 (KHTML, like Gecko) Chrome/20.0.1092.0 Safari/536.6';
    //iehttp1.content_type := 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' ;
    
    iehttp1.RequestMethod := 'POST';
    
    iehttp1.ExecuteURL('http://www.mysite.net/act=login&login=[user]&password[pass]');
    
    memo1.Text  := iehttp1.result_sl.Text   ;

",2
1502822,10/01/2009 09:07:54,1095,08/12/2008 11:30:32,31,7,Delphi 6 alongside RAD Studio 2009,"I need to migrate to RAD Studio and have this installed on a new workstation. At the momment I still need to develop with Delphi 6 until we get all the necessary control updates and sort out the version control.

So my question is can I just install Delphi 6 on the same machine with no adverse impact for either product?

Thanks in advance.",delphi,rad,studio,,,,open,0,62,6,"Delphi 6 alongside RAD Studio 2009 I need to migrate to RAD Studio and have this installed on a new workstation. At the momment I still need to develop with Delphi 6 until we get all the necessary control updates and sort out the version control.

So my question is can I just install Delphi 6 on the same machine with no adverse impact for either product?

Thanks in advance.",3
5149432,03/01/2011 01:04:21,129663,06/26/2009 21:13:28,114,1,Grid progressbar or animation,"How can I draw a progress bar or gif animation in a grid cell ?


Thanks !",delphi,,,,,,open,0,16,4,"Grid progressbar or animation How can I draw a progress bar or gif animation in a grid cell ?


Thanks !",1
6251504,06/06/2011 11:42:13,426242,08/20/2010 10:42:39,1822,53,How to load an arbitrary image from a BLOB stream into a TImage?,"If I understand it correctly, `TGraphic.LoadFromFile` determines the type of picture from the file extension.

Is there any way to detect the image type automatically from a `TBlobStream` with a raw image in it?

My current code:

    procedure LoadImageFromStream(AImage: TImage; ADataSet: TDataSet);
    var
      Stream: TStream;
    begin
      Stream := ADataSet.CreateBlobStream(Field, bmRead);
      try
        AImage.Picture.Graphic.LoadFromStream(Stream);
      finally
        Stream.Free;
      end;
    end",delphi,stream,delphi-2007,detect,timage,,open,0,105,13,"How to load an arbitrary image from a BLOB stream into a TImage? If I understand it correctly, `TGraphic.LoadFromFile` determines the type of picture from the file extension.

Is there any way to detect the image type automatically from a `TBlobStream` with a raw image in it?

My current code:

    procedure LoadImageFromStream(AImage: TImage; ADataSet: TDataSet);
    var
      Stream: TStream;
    begin
      Stream := ADataSet.CreateBlobStream(Field, bmRead);
      try
        AImage.Picture.Graphic.LoadFromStream(Stream);
      finally
        Stream.Free;
      end;
    end",5
5313639,03/15/2011 15:01:42,660824,03/15/2011 15:01:42,1,0,Is there any way I can load a image in to text file in Delphi,I have a Image and i want to upload this image in a text file.is there any way I can do it using Delphi.,delphi,,,,,03/15/2011 15:58:30,not a real question,1,24,15,Is there any way I can load a image in to text file in Delphi I have a Image and i want to upload this image in a text file.is there any way I can do it using Delphi.,1
2280240,02/17/2010 11:40:59,62391,02/04/2009 12:55:13,2980,73,Delphi - Form in DLL - Hints not showing,"I have a Delphi form inside a DLL (I know that this restricts the use of the DLL to Delphi but this is not a problem in this case).

The DLL exports a function `ShowForm` that looks roughly like this:

    procedure ShowForm (App : TApplication);
    begin
      OldApp := Application;
      try
        Application := App;
        MyForm := TMyForm.Create (nil);
        try
          MyForm.ShowModal;
        finally
          FreeAndNil (MyForm);
        end;
      finally
        Application := OldApp;
      end;
    end;

Now on the form I use a `TAdvOfficeHint` (from the TMS component pack). Unfortunately the hints do not show up.

Am I missing something here? How can I make the form behave exactly as it would if I showed it from the main application?

Thanks!",delphi,dll,,,,,open,0,199,9,"Delphi - Form in DLL - Hints not showing I have a Delphi form inside a DLL (I know that this restricts the use of the DLL to Delphi but this is not a problem in this case).

The DLL exports a function `ShowForm` that looks roughly like this:

    procedure ShowForm (App : TApplication);
    begin
      OldApp := Application;
      try
        Application := App;
        MyForm := TMyForm.Create (nil);
        try
          MyForm.ShowModal;
        finally
          FreeAndNil (MyForm);
        end;
      finally
        Application := OldApp;
      end;
    end;

Now on the form I use a `TAdvOfficeHint` (from the TMS component pack). Unfortunately the hints do not show up.

Am I missing something here? How can I make the form behave exactly as it would if I showed it from the main application?

Thanks!",2
5466197,03/28/2011 23:24:02,34504,11/05/2008 00:24:42,710,37,Can logical palettes be used in place of the system palette?,"In one of our applications, we want to use custom colors and essentially ignore the standard windows palette in a number of cases (set WindowText to Blue rather than Black for example).  My thought to do this is to just create a logical palette and apply that to the application using SelectPalette and RealizePalette, but I can't find any good examples of using these.  Is this possible to do?",delphi,colors,drawing,gdi,,,open,0,71,11,"Can logical palettes be used in place of the system palette? In one of our applications, we want to use custom colors and essentially ignore the standard windows palette in a number of cases (set WindowText to Blue rather than Black for example).  My thought to do this is to just create a logical palette and apply that to the application using SelectPalette and RealizePalette, but I can't find any good examples of using these.  Is this possible to do?",4
669319,03/21/2009 13:37:01,17560,09/18/2008 11:39:52,1128,46,Delphi Is TClientDataset Thread Safe,"I have a TClientDataset that is managed  in Tread 1  


In a different thread I have a cloned Image of the TClientDataset  

Will I run into threading problems?
",delphi,tclientdataset,,,,,open,0,31,5,"Delphi Is TClientDataset Thread Safe I have a TClientDataset that is managed  in Tread 1  


In a different thread I have a cloned Image of the TClientDataset  

Will I run into threading problems?
",2
2725294,04/27/2010 21:32:18,193785,10/21/2009 12:38:10,42,2,Delphi SQLite Update causing errors to appear.,"I have used Inserts, selects, updates, deleted without problem all over the program but for some reason this specific section causes it to except and not run the SQL I send it.
I am trying to ""UPDATE SectionTable(AreaID) VALUES ('+IntToStr(ActClient.AreaID)+') WHERE SectionID='+IntToStr(iCount)""
The section with the ID ""iCount"" exists deffinately. The ActClient.AreaID is ""2"" and its overwriting null data in the ""SectionTable"" table.

What is the problem here?

    OpenDatabase(slDb);
                            sltb:=sldb.GetTable('SELECT * FROM SectionTable WHERE SectionID='+IntToStr(iCount));
                            OutputDebugString(PAnsiChar(sltb.FieldAsString(sltb.FieldIndex['SectionID'])+sltb.FieldAsString(sltb.FieldIndex['Gender'])+sltb.FieldAsString(sltb.FieldIndex['CompetitionID'])));
                            sSQL := 'UPDATE SectionTable(AreaID) VALUES ('+IntToStr(ActClient.AreaID)+') WHERE SectionID='+IntToStr(iCount);
                            sldb.ExecSQL(sSQL);
                            CloseDatabase(slDb);

I get this error message appear when this is ran.

    ---------------------------
    Debugger Exception Notification
    ---------------------------
    Project CompetitionServer.exe raised exception class ESQLiteException with message 'Error executing SQL.
    Error [1]: SQL error or missing database.
    ""UPDATE SectionTable(AreaID) VALUES (2) WHERE SectionID=2"": near ""("": syntax error'. Process stopped. Use Step or Run to continue.
    ---------------------------
    OK   Help   
    ---------------------------

",delphi,sqlite,,,,,open,0,307,7,"Delphi SQLite Update causing errors to appear. I have used Inserts, selects, updates, deleted without problem all over the program but for some reason this specific section causes it to except and not run the SQL I send it.
I am trying to ""UPDATE SectionTable(AreaID) VALUES ('+IntToStr(ActClient.AreaID)+') WHERE SectionID='+IntToStr(iCount)""
The section with the ID ""iCount"" exists deffinately. The ActClient.AreaID is ""2"" and its overwriting null data in the ""SectionTable"" table.

What is the problem here?

    OpenDatabase(slDb);
                            sltb:=sldb.GetTable('SELECT * FROM SectionTable WHERE SectionID='+IntToStr(iCount));
                            OutputDebugString(PAnsiChar(sltb.FieldAsString(sltb.FieldIndex['SectionID'])+sltb.FieldAsString(sltb.FieldIndex['Gender'])+sltb.FieldAsString(sltb.FieldIndex['CompetitionID'])));
                            sSQL := 'UPDATE SectionTable(AreaID) VALUES ('+IntToStr(ActClient.AreaID)+') WHERE SectionID='+IntToStr(iCount);
                            sldb.ExecSQL(sSQL);
                            CloseDatabase(slDb);

I get this error message appear when this is ran.

    ---------------------------
    Debugger Exception Notification
    ---------------------------
    Project CompetitionServer.exe raised exception class ESQLiteException with message 'Error executing SQL.
    Error [1]: SQL error or missing database.
    ""UPDATE SectionTable(AreaID) VALUES (2) WHERE SectionID=2"": near ""("": syntax error'. Process stopped. Use Step or Run to continue.
    ---------------------------
    OK   Help   
    ---------------------------

",2
510031,02/04/2009 04:09:52,35696,11/08/2008 03:38:52,526,50,List of Delphi data types with 'atomic' read/write operations?,"Are 'boolean' variables thread-safe for reading and writing from any thread?  I've seen some newsgroup references to say that they are.  Are any other data types available?  (Enumerated types, short ints perhaps?)

It would be nice to have a list of all data types that can be safely read from any thread and another list that can also be safely written to in any thread without having to resort to various synchronization methods.
",delphi,atomic,,,,,open,0,75,9,"List of Delphi data types with 'atomic' read/write operations? Are 'boolean' variables thread-safe for reading and writing from any thread?  I've seen some newsgroup references to say that they are.  Are any other data types available?  (Enumerated types, short ints perhaps?)

It would be nice to have a list of all data types that can be safely read from any thread and another list that can also be safely written to in any thread without having to resort to various synchronization methods.
",2
2441672,03/14/2010 09:06:05,80901,03/21/2009 17:12:22,1841,163,How can I dynamically inject code to event handlers in Delphi?,"For debugging / performance tests I would like to dynamically add logging code to all event handlers of components of a given type.

For example, for all Dataset components located ona TDatamodule, I would like to add some code for the BeforeOpen and the AfterOpen event to store the start and end time and send a line to a logger with the elapsed time in the AfterOpen event.

I would prefer to do this dynamically (no component subclassing), so that I can add this to all existing datamodules and forms with minimal effort only when needed.

Iterating all components and filtering by their type is easy, but for the components which already have event handlers assigned, I need a way to store the existing event handlers, and assign a new modified event handler which first does the logging and then will invoke the original code which was already present.

Is there a design pattern which can be applied, or even some example code which shows how to implement this in Delphi?",delphi,aop,event-handling,,,,open,0,167,11,"How can I dynamically inject code to event handlers in Delphi? For debugging / performance tests I would like to dynamically add logging code to all event handlers of components of a given type.

For example, for all Dataset components located ona TDatamodule, I would like to add some code for the BeforeOpen and the AfterOpen event to store the start and end time and send a line to a logger with the elapsed time in the AfterOpen event.

I would prefer to do this dynamically (no component subclassing), so that I can add this to all existing datamodules and forms with minimal effort only when needed.

Iterating all components and filtering by their type is easy, but for the components which already have event handlers assigned, I need a way to store the existing event handlers, and assign a new modified event handler which first does the logging and then will invoke the original code which was already present.

Is there a design pattern which can be applied, or even some example code which shows how to implement this in Delphi?",3
4819017,01/27/2011 16:30:36,588460,01/25/2011 03:33:54,15,0,Delphi timer issue yet again...,"    procedure TForm1.Timer2Timer(Sender: TObject);
    var
    ff : integer;
     begin
    if f1 = 0 then
       begin
       SendClick(451,541);
       end;
    for ff := 0 to 32 do
    If CardArray[NewValue] + CardArray[NewValue3] = PlayArray[ff] then
       begin
       sndPlaySound('cashregister.wav', snd_Async or snd_NoDefault);
       f1 := 1;
       end;
    end;


F1 is a global var thats already declaired 0..... my problem is is i want the for loop to and timer to keep going..bah im tired you should be able to grasp what im trying to do here.... for some reason a if and else wont work here idk why.... i think i ran into this before",delphi,,,,,01/27/2011 17:46:18,not a real question,1,164,5,"Delphi timer issue yet again...     procedure TForm1.Timer2Timer(Sender: TObject);
    var
    ff : integer;
     begin
    if f1 = 0 then
       begin
       SendClick(451,541);
       end;
    for ff := 0 to 32 do
    If CardArray[NewValue] + CardArray[NewValue3] = PlayArray[ff] then
       begin
       sndPlaySound('cashregister.wav', snd_Async or snd_NoDefault);
       f1 := 1;
       end;
    end;


F1 is a global var thats already declaired 0..... my problem is is i want the for loop to and timer to keep going..bah im tired you should be able to grasp what im trying to do here.... for some reason a if and else wont work here idk why.... i think i ran into this before",1
4794285,01/25/2011 13:52:27,173327,09/14/2009 19:04:10,1501,81,WideStrings definition under Delphi 2010,"Under Delphi-2010 (and probably under D2009 also) the default string type is WideString type.

However if we declare...

    const
     s  :string = 'Test';
     ss :string[4] = 'Test';

... then the first string **s** if declared as **WideString**, but the second one **ss** is declared as **AnsiString**! 

We can check this: function `SizeOf(s[1]);` will return size 2 and function `SizeOf(ss[1])`; will return size 1.

If I declare...

    var
      s  :string;
      ss :string[4];

... than I wont that **ss** string is also WideString type.

**QUESTIONs**

 1. How to tell to the Delphi-2010
    compiler that both strings will be
    WideString type.
 2. Haw to declare the **ss** string as
    WideString type, because the compiler will not accept the type declaration `WideString[4]`.
 3. What is the purpose of two **different** compiler declarations for the same **type** name: **string**?

",delphi,delphi-2010,widestring,,,,open,0,164,5,"WideStrings definition under Delphi 2010 Under Delphi-2010 (and probably under D2009 also) the default string type is WideString type.

However if we declare...

    const
     s  :string = 'Test';
     ss :string[4] = 'Test';

... then the first string **s** if declared as **WideString**, but the second one **ss** is declared as **AnsiString**! 

We can check this: function `SizeOf(s[1]);` will return size 2 and function `SizeOf(ss[1])`; will return size 1.

If I declare...

    var
      s  :string;
      ss :string[4];

... than I wont that **ss** string is also WideString type.

**QUESTIONs**

 1. How to tell to the Delphi-2010
    compiler that both strings will be
    WideString type.
 2. Haw to declare the **ss** string as
    WideString type, because the compiler will not accept the type declaration `WideString[4]`.
 3. What is the purpose of two **different** compiler declarations for the same **type** name: **string**?

",3
4178443,11/14/2010 16:33:39,167454,09/02/2009 19:40:01,583,1,get the full path from a PID using delphi,"i need to get the full path from a PID, i check this question http://stackoverflow.com/questions/1933113/c-windows-how-to-get-process-path-from-its-pid

and i wrote this code 

     function GetFullPathFromPID(PID: DWORD): string;
     var
        hProcess: THandle;
        ModName : Array[0..MAX_PATH + 1] of Char;
     begin
       Result:='';
        hProcess := OpenProcess(PROCESS_ALL_ACCESS,False, PID);
        try
          if hProcess <> 0 then
           if GetModuleFileName(hProcess, ModName, Sizeof(ModName))<>0 then
             Result:=ModName
            else
             ShowMessage(SysErrorMessage(GetLastError));
        finally
         CloseHandle(hProcess);
        end;
     end;


but always return this message

>  the specified module could not be
> found

how i can return the full path from a pid?",delphi,delphi-xe,,,,,open,0,205,9,"get the full path from a PID using delphi i need to get the full path from a PID, i check this question http://stackoverflow.com/questions/1933113/c-windows-how-to-get-process-path-from-its-pid

and i wrote this code 

     function GetFullPathFromPID(PID: DWORD): string;
     var
        hProcess: THandle;
        ModName : Array[0..MAX_PATH + 1] of Char;
     begin
       Result:='';
        hProcess := OpenProcess(PROCESS_ALL_ACCESS,False, PID);
        try
          if hProcess <> 0 then
           if GetModuleFileName(hProcess, ModName, Sizeof(ModName))<>0 then
             Result:=ModName
            else
             ShowMessage(SysErrorMessage(GetLastError));
        finally
         CloseHandle(hProcess);
        end;
     end;


but always return this message

>  the specified module could not be
> found

how i can return the full path from a pid?",2
5569933,04/06/2011 16:40:05,649910,03/08/2011 14:01:18,43,0,A problem with calling a method in another method,"So here it is:  
A method that works well, when i click manually on the button(It opens the door)
http://pastebin.com/iMJ4geDt

However, when I want to call the above mentioned method in some procedure event a exception is thrown(its about the possibility of door opening - it doesn't open the door)
http://pastebin.com/PvXXG4vq

Co ciekawe, gdy probuje wywołac 'sztucznie' kliknięcie buttona(gdzie funkcja dziala poprawnie) z procedury eventu  rzuca tym samym wyjątkiem!
 Form1.Button3Click(Button3);

Moreover, when I try to call the button click from procedure event(in this procedure above):  
<code>
Form1.Button3Click(Button3);
</code>  
it throws the same exception! I repeat: with manually clicked button everything is alright. What is the problem?!",delphi,,,,,,open,0,103,9,"A problem with calling a method in another method So here it is:  
A method that works well, when i click manually on the button(It opens the door)
http://pastebin.com/iMJ4geDt

However, when I want to call the above mentioned method in some procedure event a exception is thrown(its about the possibility of door opening - it doesn't open the door)
http://pastebin.com/PvXXG4vq

Co ciekawe, gdy probuje wywołac 'sztucznie' kliknięcie buttona(gdzie funkcja dziala poprawnie) z procedury eventu  rzuca tym samym wyjątkiem!
 Form1.Button3Click(Button3);

Moreover, when I try to call the button click from procedure event(in this procedure above):  
<code>
Form1.Button3Click(Button3);
</code>  
it throws the same exception! I repeat: with manually clicked button everything is alright. What is the problem?!",1
81557,09/17/2008 09:49:20,4101,09/01/2008 19:04:06,8,1,Prevent implicit import of units in Delphi packages,"Is there a way to prevent packages in Delphi to implicitly import units that are not listed in the ""Contains"" list? I'm looking for a compiler directive that makes the build to fail if it tries to do an implicit import.

Problems occur when you install a package into the IDE that implicitly imports unit A and then you try to install another package that really contains unit A and the IDE tells you that it cannot install that package because unit A is already contained in the first package even if it shouldn't be!",delphi,compiler,packages,,,,open,0,94,8,"Prevent implicit import of units in Delphi packages Is there a way to prevent packages in Delphi to implicitly import units that are not listed in the ""Contains"" list? I'm looking for a compiler directive that makes the build to fail if it tries to do an implicit import.

Problems occur when you install a package into the IDE that implicitly imports unit A and then you try to install another package that really contains unit A and the IDE tells you that it cannot install that package because unit A is already contained in the first package even if it shouldn't be!",3
4666561,01/12/2011 08:16:23,192910,10/20/2009 07:56:41,3766,194,How to add scrollbars to a TComponent?,"I am using a 3rd party control which is descended from TComponent and I want it to have scrollbars, preferably autoscrollbars.

Can I get them from TComponent?  

Failing that, can I place a TPanel on my mainform & the component on that and get scrollbars? I intend to have the component (and Panel, or whatever) be alClient so that they autoresize when my component resizes, but I woudl also like them to have (auto) scrollbars.",delphi,c++builder,vcl,,,,open,0,75,7,"How to add scrollbars to a TComponent? I am using a 3rd party control which is descended from TComponent and I want it to have scrollbars, preferably autoscrollbars.

Can I get them from TComponent?  

Failing that, can I place a TPanel on my mainform & the component on that and get scrollbars? I intend to have the component (and Panel, or whatever) be alClient so that they autoresize when my component resizes, but I woudl also like them to have (auto) scrollbars.",3
6642595,07/10/2011 17:20:56,837814,07/10/2011 17:20:56,1,0,changing component properties at runtime causing issues?,"I have a TFNN neural network component that works exactly as expected at runtime and it works as expected.  If i change the properties at runtime however, i get an exception error if the property exceeds that initial property at design time.  What is the difference in the way delphi handles componenets at design time and run time?",delphi,exception,properties,components,,07/10/2011 18:37:58,not a real question,1,60,7,"changing component properties at runtime causing issues? I have a TFNN neural network component that works exactly as expected at runtime and it works as expected.  If i change the properties at runtime however, i get an exception error if the property exceeds that initial property at design time.  What is the difference in the way delphi handles componenets at design time and run time?",4
5417843,03/24/2011 10:37:42,55007,10/25/2008 16:25:43,918,27,Generic dialog with custom captions for buttons,"I know this issue have been up since before (ex. [Best way to show customized message dialogs][1]), but I still don't find what I want.

I started like this:

    class function TAttracsForm.MessageDlg(const aMsg: string; aDlgType: TMsgDlgType; Buttons: TMsgDlgButtons; aCaptions: array of String; aDefault: TMsgDlgBtn): TModalResult;
    var
      vDlg: TForm;
      i: Integer; 
    begin
      if aButtons.Count = aCaptions.Count then
      begin
        vDlg := CreateMessageDialog(aMsg, aDlgType, Buttons);
        try
          for i := 0 aCaptions.Count - 1 do
            TButton(vDlg.FindComponent(Buttons[i].Caption)).Caption := aCaptions[i]; 

          vDlg.Position := poDefaultPosOnly;
          Result := vDlg.ShowModal;
        finally
          vDlg.Free;
        end;
      end;
    end;

And the call would look like:

    if (MessageDlg('Really quit application ?', mtWarning, 
           [mbNo, mbCancel, mbYes], {'No save', 'Cancel', 'Save'}) = mrYes) then

 
But the above code of course don't compile. I don't know how to get one item of an set in the loop and how to get the total count of it in the beginning.

  [1]: http://stackoverflow.com/questions/1100073/what-is-the-best-way-in-delphi-to-show-customized-message-dialogs

",delphi,dialog,customization,caption,,,open,0,270,7,"Generic dialog with custom captions for buttons I know this issue have been up since before (ex. [Best way to show customized message dialogs][1]), but I still don't find what I want.

I started like this:

    class function TAttracsForm.MessageDlg(const aMsg: string; aDlgType: TMsgDlgType; Buttons: TMsgDlgButtons; aCaptions: array of String; aDefault: TMsgDlgBtn): TModalResult;
    var
      vDlg: TForm;
      i: Integer; 
    begin
      if aButtons.Count = aCaptions.Count then
      begin
        vDlg := CreateMessageDialog(aMsg, aDlgType, Buttons);
        try
          for i := 0 aCaptions.Count - 1 do
            TButton(vDlg.FindComponent(Buttons[i].Caption)).Caption := aCaptions[i]; 

          vDlg.Position := poDefaultPosOnly;
          Result := vDlg.ShowModal;
        finally
          vDlg.Free;
        end;
      end;
    end;

And the call would look like:

    if (MessageDlg('Really quit application ?', mtWarning, 
           [mbNo, mbCancel, mbYes], {'No save', 'Cancel', 'Save'}) = mrYes) then

 
But the above code of course don't compile. I don't know how to get one item of an set in the loop and how to get the total count of it in the beginning.

  [1]: http://stackoverflow.com/questions/1100073/what-is-the-best-way-in-delphi-to-show-customized-message-dialogs

",4
162651,10/02/2008 14:38:17,22712,09/26/2008 14:23:30,43,9,What is the difference with these two sets of code,"What is the difference between these two pieces of code

    type
      IInterface1 = interface
        procedure Proc1;
      end;

      IInterface2 = interface
        procedure Proc2;
      end;

      TMyClass = class(TInterfacedObject, IInterface1, IInterface2)
      protected
        procedure Proc1;
        procedure Proc2;
      end;


And the following :

    type
      IInterface1 = interface
        procedure Proc1;
      end;

      IInterface2 = interface(Interface2)
        procedure Proc2;
      end;

      TMyClass = class(TInterfacedObject,  IInterface2)
      protected
        procedure Proc1;
        procedure Proc2;
      end;



If they are one and the same, are there any advantages, or readability issues with either.

I guess the second means you cannot write a class that implements IInterface2 without implementing IInterface1, whilst with the first you can.",delphi,interface,,,,,open,0,229,10,"What is the difference with these two sets of code What is the difference between these two pieces of code

    type
      IInterface1 = interface
        procedure Proc1;
      end;

      IInterface2 = interface
        procedure Proc2;
      end;

      TMyClass = class(TInterfacedObject, IInterface1, IInterface2)
      protected
        procedure Proc1;
        procedure Proc2;
      end;


And the following :

    type
      IInterface1 = interface
        procedure Proc1;
      end;

      IInterface2 = interface(Interface2)
        procedure Proc2;
      end;

      TMyClass = class(TInterfacedObject,  IInterface2)
      protected
        procedure Proc1;
        procedure Proc2;
      end;



If they are one and the same, are there any advantages, or readability issues with either.

I guess the second means you cannot write a class that implements IInterface2 without implementing IInterface1, whilst with the first you can.",2
3976367,10/20/2010 09:23:48,193655,10/21/2009 08:29:52,730,9,How to choose developer tools (Delphi)?,"As stated in many places in SO ""hardware/software is cheap, people is expensive"".

Tools, like the ones listed [here][1] can really make a difference. Now I am stepping out of the cave and I am realizing that i must update myself.

I started studying ""theory"", I have a busy schedule for reading books on Refactoring, UnitTest, OOP Patterns. But all this is a lot of theory.

It is very good to do refactorings, write tests and apply patterns. But doing this simply in Delphi IDE (copying and pasting code/using the buggy built in refactorings) it is good for understanding the concepts, but for being proficient I feel tools are a must. Without a UML tool, I think it is impossible to refactor complex classes (or, even worse, legacy software where classes are just containers for procedural code). I am not experienced yet in OOP, but I translated in Delphi and followed step by step chapter one of [Fowler's Refactorign][2]. Yes, I see the great benefits, but I also realized how easy it is to get lost as many methods start to be added to classes (for good OO design). In those theoretical books there is almost never a reference the a CASE tool, or they say (I read this on [Ambler's Object Primer][3]) that CASE tools won't change your lifes. I agree that a CASE tool is not the starting point, first one must master the idea, and then use a tool (somehow we learng writing a language on paper and the we move to word processors).
Sticking on that first chapter example. I never used a CASE tool with advanced refactoring optinos, but I am sure it would have taken 1/3 of the time to do those refactorings with a tool.

And the same applies for all other cases: UI testing for example. One test I need to do in one application is to push all the buttons to see if errors occurs. If a tool allows me to do this, even if it costs 500$ it is worth.

Another example DUnit. Yes it is free but many things are left to the develoeper. If a tool like [TestComplete][4] makes me save time and money and headache, why shuoldn't I go for it?

Then a problem comes from choosing the tools. I see these problems:

1) etherogeneous tools that has great features can be comlpex to learn and master, while a suite of tools with may be some less feature can speed your way up. (for example buying 3 tools from same vendor, or a tool that does 3 things is maybe better than buying the 3 best tools from 3 different vendors)

2) Make a priority list: which tool do I need first? Buy only that one, master it then go to the next? The only tool I am using now is proDelphi profiler, may be it is not the best profiler on the world (now AQ is even built in in Delphi XE) but anyway being able to use it it helped me in finding bottlenecks I couldn't guess.

3) buy it or code it? I often read on forums about ""buying dataabstract vs write your own libraries for 3-tier developement"". Coding everything can be ok for a huge organization but for a small one as mine I think the solution is investing in 3rd party libraries (picking of course the ones from companies that seems not near to bankrupt). Let's make the dataabstract example. It costs around 1000$. Let's say the cost of a developer is 2000$ per month (just to have an idea). Anyway you get the library at less then 1 developer month work. Buying upgrades is like maintaining the libraries. The cost is much less and the features and performance are better.

4) I don't see a point of dimishing returns with tools/libraries, but may be I am wrong.

Somehow to step out of the cave of procedural programming and enter in the world of effficient programming there is monster jump to do. Doing OOP on simple ""book examples"" projects is nice. But putting it into practice in wide systems is scaring, expecially because I don't have an expert with me, I have to do it on myself.

Final thought: using tools, buying libraries... I think this is necessary to delegate to tools/libraries some tasks and focus only on what I really need to do. Anyway I am confused a little, scared too. May you please comment on what I wrote and give suggestions **that can help me**?


  [1]: http://stackoverflow.com/questions/63957/what-is-the-best-set-of-tools-to-develop-win32-delphi-applications
  [2]: http://www.amazon.com/Refactoring-Improving-Design-Existing-Code/dp/0201485672/ref=sr_1_1?ie=UTF8&qid=1287565494&sr=8-1
  [3]: http://www.amazon.com/Object-Primer-Agile-Model-Driven-Development/dp/0521540186/ref=sr_1_1?ie=UTF8&qid=1287565662&sr=8-1
  [4]: http://www.automatedqa.com/products/testcomplete/",delphi,oop,3rd-party-library,,,,open,0,754,6,"How to choose developer tools (Delphi)? As stated in many places in SO ""hardware/software is cheap, people is expensive"".

Tools, like the ones listed [here][1] can really make a difference. Now I am stepping out of the cave and I am realizing that i must update myself.

I started studying ""theory"", I have a busy schedule for reading books on Refactoring, UnitTest, OOP Patterns. But all this is a lot of theory.

It is very good to do refactorings, write tests and apply patterns. But doing this simply in Delphi IDE (copying and pasting code/using the buggy built in refactorings) it is good for understanding the concepts, but for being proficient I feel tools are a must. Without a UML tool, I think it is impossible to refactor complex classes (or, even worse, legacy software where classes are just containers for procedural code). I am not experienced yet in OOP, but I translated in Delphi and followed step by step chapter one of [Fowler's Refactorign][2]. Yes, I see the great benefits, but I also realized how easy it is to get lost as many methods start to be added to classes (for good OO design). In those theoretical books there is almost never a reference the a CASE tool, or they say (I read this on [Ambler's Object Primer][3]) that CASE tools won't change your lifes. I agree that a CASE tool is not the starting point, first one must master the idea, and then use a tool (somehow we learng writing a language on paper and the we move to word processors).
Sticking on that first chapter example. I never used a CASE tool with advanced refactoring optinos, but I am sure it would have taken 1/3 of the time to do those refactorings with a tool.

And the same applies for all other cases: UI testing for example. One test I need to do in one application is to push all the buttons to see if errors occurs. If a tool allows me to do this, even if it costs 500$ it is worth.

Another example DUnit. Yes it is free but many things are left to the develoeper. If a tool like [TestComplete][4] makes me save time and money and headache, why shuoldn't I go for it?

Then a problem comes from choosing the tools. I see these problems:

1) etherogeneous tools that has great features can be comlpex to learn and master, while a suite of tools with may be some less feature can speed your way up. (for example buying 3 tools from same vendor, or a tool that does 3 things is maybe better than buying the 3 best tools from 3 different vendors)

2) Make a priority list: which tool do I need first? Buy only that one, master it then go to the next? The only tool I am using now is proDelphi profiler, may be it is not the best profiler on the world (now AQ is even built in in Delphi XE) but anyway being able to use it it helped me in finding bottlenecks I couldn't guess.

3) buy it or code it? I often read on forums about ""buying dataabstract vs write your own libraries for 3-tier developement"". Coding everything can be ok for a huge organization but for a small one as mine I think the solution is investing in 3rd party libraries (picking of course the ones from companies that seems not near to bankrupt). Let's make the dataabstract example. It costs around 1000$. Let's say the cost of a developer is 2000$ per month (just to have an idea). Anyway you get the library at less then 1 developer month work. Buying upgrades is like maintaining the libraries. The cost is much less and the features and performance are better.

4) I don't see a point of dimishing returns with tools/libraries, but may be I am wrong.

Somehow to step out of the cave of procedural programming and enter in the world of effficient programming there is monster jump to do. Doing OOP on simple ""book examples"" projects is nice. But putting it into practice in wide systems is scaring, expecially because I don't have an expert with me, I have to do it on myself.

Final thought: using tools, buying libraries... I think this is necessary to delegate to tools/libraries some tasks and focus only on what I really need to do. Anyway I am confused a little, scared too. May you please comment on what I wrote and give suggestions **that can help me**?


  [1]: http://stackoverflow.com/questions/63957/what-is-the-best-set-of-tools-to-develop-win32-delphi-applications
  [2]: http://www.amazon.com/Refactoring-Improving-Design-Existing-Code/dp/0201485672/ref=sr_1_1?ie=UTF8&qid=1287565494&sr=8-1
  [3]: http://www.amazon.com/Object-Primer-Agile-Model-Driven-Development/dp/0521540186/ref=sr_1_1?ie=UTF8&qid=1287565662&sr=8-1
  [4]: http://www.automatedqa.com/products/testcomplete/",3
9122678,02/03/2012 01:46:48,1184191,02/02/2012 03:13:12,25,0,"After a button is clicked, the camera will be turned off",How can i turned off the camera function if i am going to exit a specific form in my project? Anyone has an idea? Please help.,delphi,button,camera,,,02/08/2012 02:56:48,not a real question,1,26,11,"After a button is clicked, the camera will be turned off How can i turned off the camera function if i am going to exit a specific form in my project? Anyone has an idea? Please help.",3
5795263,04/26/2011 19:11:20,381979,07/02/2010 11:01:52,404,12,Binary to Base64 (Delphi),how can i get content of an `exe` file and convert it into `Base64` encoding ?,delphi,encoding,binary,base64,exe,,open,0,16,4,Binary to Base64 (Delphi) how can i get content of an `exe` file and convert it into `Base64` encoding ?,5
1265710,08/12/2009 11:54:27,81800,03/24/2009 05:02:28,1263,26,How to disable/hide icon from a form?,"How do I create a second form with a close button,but without an icon.

",delphi,d2009,,,,,open,0,14,7,"How to disable/hide icon from a form? How do I create a second form with a close button,but without an icon.

",2
670641,03/22/2009 07:07:55,17560,09/18/2008 11:39:52,1133,46,Dephi  - Threading frameworks,"I am looking for a Threading framework to use in my delphi application.


Currently I am evaluating   ‘[OmniThreadLibrary][1]’  - so far it looks good and does every I need.


Is any other ‘Threading framework’ for delphi ?

(I am using D2006 & D2009)


  [1]: http://otl.17slon.com/index.htm",delphi,threading-framework,,,,02/07/2012 14:55:02,not constructive,1,46,5,"Dephi  - Threading frameworks I am looking for a Threading framework to use in my delphi application.


Currently I am evaluating   ‘[OmniThreadLibrary][1]’  - so far it looks good and does every I need.


Is any other ‘Threading framework’ for delphi ?

(I am using D2006 & D2009)


  [1]: http://otl.17slon.com/index.htm",2
