PostId,PostCreationDate,OwnerUserId,OwnerCreationDate,ReputationAtPostCreation,OwnerUndeletedAnswerCountAtPostTime,Title,BodyMarkdown,Tag1,Tag2,Tag3,Tag4,Tag5,PostClosedDate,OpenStatus,OpenStatusInt,BodyLength,TitleLength,TitleConcatWithBody,NumberOfTags
3842166,10/01/2010 18:48:40,459424,09/27/2010 11:37:33,1,1,convert HQL query to criteria api ,"I'm wondering if is possible to convert this HQL query into a criteria api query.

    select s1 
    from Student
    where 
         (
            select max(s2.Score)
            from Student
            where s1.Id = s2.Id
         )
          = 10

(selects the students that have their max score value equal to 10)

I don't know if I could use a detached criteria because of the 's1.Id = s2.Is' condition

Thanx for anyone who can help me",nhibernate,api,hql,criteria,,,open,0,134,7,"convert HQL query to criteria api  I'm wondering if is possible to convert this HQL query into a criteria api query.

    select s1 
    from Student
    where 
         (
            select max(s2.Score)
            from Student
            where s1.Id = s2.Id
         )
          = 10

(selects the students that have their max score value equal to 10)

I don't know if I could use a detached criteria because of the 's1.Id = s2.Is' condition

Thanx for anyone who can help me",4
1358744,08/31/2009 18:27:19,42272,12/01/2008 22:19:04,237,3,NHibernate: Creating a criteria which applies for all queries on a table,"Using Castle ActiveRecord / NHibernate: Is there a way you can force an ICriterion on all queries on a table?

For example, a good amount of of my tables have a ""UserId"" column. I might want to ensure that I am always selecting rows for the logged in user. I can easily create an ICriterion object, but I am forced to supply it for different methods: FindAll(), FindFirst(), FindLast() etc.

Is there a way to force a WHERE clause on all queries to a Castle ActiveRecord?",nhibernate,criteria,castle-activerecord,,,,open,0,84,12,"NHibernate: Creating a criteria which applies for all queries on a table Using Castle ActiveRecord / NHibernate: Is there a way you can force an ICriterion on all queries on a table?

For example, a good amount of of my tables have a ""UserId"" column. I might want to ensure that I am always selecting rows for the logged in user. I can easily create an ICriterion object, but I am forced to supply it for different methods: FindAll(), FindFirst(), FindLast() etc.

Is there a way to force a WHERE clause on all queries to a Castle ActiveRecord?",3
4037357,10/27/2010 20:23:22,61249,02/01/2009 18:28:55,911,104,NHibernate - How to map users belonging to both accounts and stores?,"We have many accounts and an account can have many stores and now I have users. A user could potentially belong to either an account or a store. Like below

![model][1]

I just feel like this is insanity and was hoping for some guidance in the matter. These are my requirements.

A user belonging to an account should have access to all the stores but a user belonging to a store should have access only to that store. 

I was thinking of solving this with some sort of roles but can't figure out how to yet. How are others doing it?


  [1]: http://i.stack.imgur.com/TEC22.png",nhibernate,nhibernate-mapping,,,,01/28/2012 21:11:24,not constructive,1,101,12,"NHibernate - How to map users belonging to both accounts and stores? We have many accounts and an account can have many stores and now I have users. A user could potentially belong to either an account or a store. Like below

![model][1]

I just feel like this is insanity and was hoping for some guidance in the matter. These are my requirements.

A user belonging to an account should have access to all the stores but a user belonging to a store should have access only to that store. 

I was thinking of solving this with some sort of roles but can't figure out how to yet. How are others doing it?


  [1]: http://i.stack.imgur.com/TEC22.png",2
5542517,04/04/2011 18:13:41,184131,10/05/2009 03:12:54,40,0,Extending NHibernate to support aggregate functions,"Is it possible to extend NHibernate to add support for aggregate functions that is unique to a database system? I have a handful of queries that use the array_agg() function (and others) in PostgreSQL that I'd like to convert to HQL/ICriteria. 

Thanks!",nhibernate,postgresql,,,,,open,0,42,6,"Extending NHibernate to support aggregate functions Is it possible to extend NHibernate to add support for aggregate functions that is unique to a database system? I have a handful of queries that use the array_agg() function (and others) in PostgreSQL that I'd like to convert to HQL/ICriteria. 

Thanks!",2
4468571,12/17/2010 07:37:02,184131,10/05/2009 03:12:54,17,0,NHibernate mapping not adding ON DELETE CASCADE option to foreign key reference,"Here's my NHibernate mapping.

    <?xml version=""1.0"" encoding=""utf-8"" ?>
    <hibernate-mapping xmlns=""urn:nhibernate-mapping-2.2"" assembly=""HelloNHibernate"" namespace=""HelloNHibernate"">
      <class name=""Showing"" table=""showing"">
        <id name=""Id"" column=""showing_id"">
          <generator class=""identity""/>
        </id>
        <many-to-one class=""Theater"" name=""Theater"" column=""theater_id"" foreign-key=""fk_showing_theater_theater_id"" cascade=""delete"" lazy=""false"" fetch=""join""/>
        <many-to-one class=""Movie"" name=""Movie"" column=""movie_id"" foreign-key=""fk_showing_movie_movie_id"" cascade=""delete"" lazy=""false"" fetch=""join"" />
      </class>
    </hibernate-mapping>

Here's the SQL (PostgreSQL) generated by the SchemaExport tool:

    CREATE TABLE showing
    (
      showing_id serial NOT NULL,
      theater_id integer,
      movie_id integer,
      CONSTRAINT showing_pkey PRIMARY KEY (showing_id),
      CONSTRAINT fk_showing_movie_movie_id FOREIGN KEY (movie_id)
          REFERENCES movie (movie_id) MATCH SIMPLE
          ON UPDATE NO ACTION ON DELETE NO ACTION,
      CONSTRAINT fk_showing_theater_theater_id FOREIGN KEY (theater_id)
          REFERENCES theater (theater_id) MATCH SIMPLE
          ON UPDATE NO ACTION ON DELETE NO ACTION
    )

What am I doing wrong? Thanks!",nhibernate,nhibernate-mapping,,,,,open,0,238,12,"NHibernate mapping not adding ON DELETE CASCADE option to foreign key reference Here's my NHibernate mapping.

    <?xml version=""1.0"" encoding=""utf-8"" ?>
    <hibernate-mapping xmlns=""urn:nhibernate-mapping-2.2"" assembly=""HelloNHibernate"" namespace=""HelloNHibernate"">
      <class name=""Showing"" table=""showing"">
        <id name=""Id"" column=""showing_id"">
          <generator class=""identity""/>
        </id>
        <many-to-one class=""Theater"" name=""Theater"" column=""theater_id"" foreign-key=""fk_showing_theater_theater_id"" cascade=""delete"" lazy=""false"" fetch=""join""/>
        <many-to-one class=""Movie"" name=""Movie"" column=""movie_id"" foreign-key=""fk_showing_movie_movie_id"" cascade=""delete"" lazy=""false"" fetch=""join"" />
      </class>
    </hibernate-mapping>

Here's the SQL (PostgreSQL) generated by the SchemaExport tool:

    CREATE TABLE showing
    (
      showing_id serial NOT NULL,
      theater_id integer,
      movie_id integer,
      CONSTRAINT showing_pkey PRIMARY KEY (showing_id),
      CONSTRAINT fk_showing_movie_movie_id FOREIGN KEY (movie_id)
          REFERENCES movie (movie_id) MATCH SIMPLE
          ON UPDATE NO ACTION ON DELETE NO ACTION,
      CONSTRAINT fk_showing_theater_theater_id FOREIGN KEY (theater_id)
          REFERENCES theater (theater_id) MATCH SIMPLE
          ON UPDATE NO ACTION ON DELETE NO ACTION
    )

What am I doing wrong? Thanks!",2
11402621,07/09/2012 20:28:58,981205,10/05/2011 20:59:00,58,1,"Fluent nHibernate, Hi-Lo table with entity-per-row using a convention","Is there a way to specify a table to use for Hi-Lo values, with each entity having a per-row entry, via a convention (while still having nHibernate create the table structure for you)? I would like to replicate what Phil Haydon blogged about [here][1], but without having to manually manage the table. As it stands, migrating his row-per-table code to its own convention will work only if you've already created the appropriate entries for 'TableKey' in the table already.

Alternatively, is this possible via the XML mappings?

And if all else fails, is the only other appropriate option to use a custom generator, a la [this post][2]?

  [1]: http://www.philliphaydon.com/2010/10/using-hilo-with-fluentnhibernate/
  [2]: http://daniel.wertheim.se/2011/03/08/nhibernate-custom-id-generator/",nhibernate,fluent-nhibernate,,,,,open,0,111,9,"Fluent nHibernate, Hi-Lo table with entity-per-row using a convention Is there a way to specify a table to use for Hi-Lo values, with each entity having a per-row entry, via a convention (while still having nHibernate create the table structure for you)? I would like to replicate what Phil Haydon blogged about [here][1], but without having to manually manage the table. As it stands, migrating his row-per-table code to its own convention will work only if you've already created the appropriate entries for 'TableKey' in the table already.

Alternatively, is this possible via the XML mappings?

And if all else fails, is the only other appropriate option to use a custom generator, a la [this post][2]?

  [1]: http://www.philliphaydon.com/2010/10/using-hilo-with-fluentnhibernate/
  [2]: http://daniel.wertheim.se/2011/03/08/nhibernate-custom-id-generator/",2
2459772,03/17/2010 03:41:11,142456,07/22/2009 01:19:28,165,9,Serialized NHibernate Configuration objects - detect out of date or rebuild on demand? ,"
I've been using [serialized nhibernate configuration objects](http://nhforge.org/blogs/nhibernate/archive/2009/03/13/an-improvement-on-sessionfactory-initialization.aspx) (also discussed [here](http://ayende.com/Blog/archive/2007/10/26/Real-World-NHibernate-Reducing-startup-times-for-large-amount-of.aspx) and [here](http://stackoverflow.com/questions/1625597/is-there-any-data-on-nhibernate-vs-fluent-nhibernate-startup-performance/1794569#1794569)) to speed up my application startup from about 8s to 1s. I also use fluent-nhibernate, so the path is more like 

1. ClassMap class definitions in code 
1. fluentconfiguration
1. xml
1. nhibernate configuration
1. configuration serialized to disk.

The problem from doing this is that one runs the risk of out of date mappings - if I change the mappings but forget to rebuild the serialized configuration, then I end up using the old mappings without realising it. This does not always result in an immediate and obvious error during testing, and several times the misbehaviour has been a real pain to detect and fix.

Does anybody have any idea how I would be able to detect if my classmaps have changed, so that I could either issue an immediate warning/error or rebuild it on demand?

At the moment I am comparing timestamps on my compiled assembly against the serialized configuration. This will pickup mapping changes, but unfortunately it generates a massive false positive rate as ANY change to the code results in an out of date flag. I can't move the classmaps to another assembly as they are tightly integrated into the business logic.

This has been niggling me for a while so I was wondering if anybody had any suggestions?",nhibernate,fluent-nhibernate,,,,,open,0,218,14,"Serialized NHibernate Configuration objects - detect out of date or rebuild on demand?  
I've been using [serialized nhibernate configuration objects](http://nhforge.org/blogs/nhibernate/archive/2009/03/13/an-improvement-on-sessionfactory-initialization.aspx) (also discussed [here](http://ayende.com/Blog/archive/2007/10/26/Real-World-NHibernate-Reducing-startup-times-for-large-amount-of.aspx) and [here](http://stackoverflow.com/questions/1625597/is-there-any-data-on-nhibernate-vs-fluent-nhibernate-startup-performance/1794569#1794569)) to speed up my application startup from about 8s to 1s. I also use fluent-nhibernate, so the path is more like 

1. ClassMap class definitions in code 
1. fluentconfiguration
1. xml
1. nhibernate configuration
1. configuration serialized to disk.

The problem from doing this is that one runs the risk of out of date mappings - if I change the mappings but forget to rebuild the serialized configuration, then I end up using the old mappings without realising it. This does not always result in an immediate and obvious error during testing, and several times the misbehaviour has been a real pain to detect and fix.

Does anybody have any idea how I would be able to detect if my classmaps have changed, so that I could either issue an immediate warning/error or rebuild it on demand?

At the moment I am comparing timestamps on my compiled assembly against the serialized configuration. This will pickup mapping changes, but unfortunately it generates a massive false positive rate as ANY change to the code results in an out of date flag. I can't move the classmaps to another assembly as they are tightly integrated into the business logic.

This has been niggling me for a while so I was wondering if anybody had any suggestions?",2
1488530,09/28/2009 18:13:39,2701,08/24/2008 15:51:24,1753,61,Any point in writing integration tests for a repository w/ NHibernate?,"I recently spent a great deal of time pulling out a stored procedure back-end and replaced it with a NHiberante base repository.  One test per repository was nice in the stored procedure version because I could verify my stored procedures worked and the class that mapped the returned data to my objects did it's job.  

But after I got this up and running with NHibernate I thought to myself ""is this really needed?"".  After all, NHibernate has unit tests all its own to make sure the session knows how to do dirty tracking/mapping work/etc

Am I missing something here or should I toss these tests that offer no real value?

(sample of a repository I would exercise during this integration test)

    public class UserRepository : NHibernateRepository<User>, IUserRepository
    {
        public UserRepository() : base()
        {
        }
       
        public void DeleteUser(User User)
        {
            base.Delete(User);
        }
       
        public User GetUserById(int id)
        {
            return base.Retrieve(id);
        }
       
        public IQueryable<User> GetUserCollection()
        {
            return base.RetrieveAll();
        }
       
        public void SaveUser(User User)
        {
            base.Save(User);
        }
    }",nhibernate,integration-testing,,,,,open,0,351,11,"Any point in writing integration tests for a repository w/ NHibernate? I recently spent a great deal of time pulling out a stored procedure back-end and replaced it with a NHiberante base repository.  One test per repository was nice in the stored procedure version because I could verify my stored procedures worked and the class that mapped the returned data to my objects did it's job.  

But after I got this up and running with NHibernate I thought to myself ""is this really needed?"".  After all, NHibernate has unit tests all its own to make sure the session knows how to do dirty tracking/mapping work/etc

Am I missing something here or should I toss these tests that offer no real value?

(sample of a repository I would exercise during this integration test)

    public class UserRepository : NHibernateRepository<User>, IUserRepository
    {
        public UserRepository() : base()
        {
        }
       
        public void DeleteUser(User User)
        {
            base.Delete(User);
        }
       
        public User GetUserById(int id)
        {
            return base.Retrieve(id);
        }
       
        public IQueryable<User> GetUserCollection()
        {
            return base.RetrieveAll();
        }
       
        public void SaveUser(User User)
        {
            base.Save(User);
        }
    }",2
8501790,12/14/2011 09:02:06,1095339,12/13/2011 08:42:08,11,0,Nhibernate query object pattern and query translator,Asp.net design patterns by scott millet is a good book for design patterns. But the query translator implemented in the book is incomplete. Can anyone provide me the complete implementation of query object pattern and the query translator,nhibernate,,,,,12/14/2011 16:09:56,not a real question,1,38,7,Nhibernate query object pattern and query translator Asp.net design patterns by scott millet is a good book for design patterns. But the query translator implemented in the book is incomplete. Can anyone provide me the complete implementation of query object pattern and the query translator,1
713637,04/03/2009 11:58:27,3834,08/31/2008 06:25:52,1464,68,Inverse Attribute in NHibernate,"How to use Inverse Attribute? If I am not mistaken, for one to many relationship the inverse attribute must be set to true. For many-to-many one of the entity class inverse attribute must be set to true and another set to false. 

Anyone can shed some lights on this?",nhibernate,,,,,,open,0,49,4,"Inverse Attribute in NHibernate How to use Inverse Attribute? If I am not mistaken, for one to many relationship the inverse attribute must be set to true. For many-to-many one of the entity class inverse attribute must be set to true and another set to false. 

Anyone can shed some lights on this?",1
2264126,02/15/2010 05:11:31,267679,02/06/2010 10:27:39,1,1,join 3 icriteria with or,"Is it possible to join 3 ICriteria together with OR statement not AND?


    ICriteria criteriaCity = NHibernateSession.CreateCriteria(typeof(Advertisements))
                .CreateCriteria(AdvertisementsProperties.City.ToString(), ""city"").
                Add(Restrictions.Or(
                        Restrictions.Like(""city."" + CitiesProperties.Name.ToString(), text, MatchMode.Anywhere),
                        Restrictions.Like(""city."" + CitiesProperties.SlovenianName.ToString(), text, MatchMode.Anywhere)));

            ICriteria criteriaArea = NHibernateSession.CreateCriteria(typeof(Advertisements))
                .CreateCriteria(AdvertisementsProperties.Area.ToString(), ""area"").
                Add(Restrictions.Or(
                        Restrictions.Like(""area."" + AreasProperties.Name.ToString(), text, MatchMode.Anywhere),
                        Restrictions.Like(""area."" + AreasProperties.SlovenianName.ToString(), text, MatchMode.Anywhere)));

            ICriteria criteriaCountry = NHibernateSession.CreateCriteria(typeof(Advertisements))
                .CreateCriteria(AdvertisementsProperties.Country.ToString(), ""country"").
                    Add(Restrictions.Or(
                            Restrictions.Like(""country."" + CountriesProperties.Name.ToString(), text, MatchMode.Anywhere),
                            Restrictions.Like(""country."" + CountriesProperties.SlovenianName.ToString(), text, MatchMode.Anywhere)));


Regards",nhibernate,fluent-nhibernate,,,,,open,0,329,5,"join 3 icriteria with or Is it possible to join 3 ICriteria together with OR statement not AND?


    ICriteria criteriaCity = NHibernateSession.CreateCriteria(typeof(Advertisements))
                .CreateCriteria(AdvertisementsProperties.City.ToString(), ""city"").
                Add(Restrictions.Or(
                        Restrictions.Like(""city."" + CitiesProperties.Name.ToString(), text, MatchMode.Anywhere),
                        Restrictions.Like(""city."" + CitiesProperties.SlovenianName.ToString(), text, MatchMode.Anywhere)));

            ICriteria criteriaArea = NHibernateSession.CreateCriteria(typeof(Advertisements))
                .CreateCriteria(AdvertisementsProperties.Area.ToString(), ""area"").
                Add(Restrictions.Or(
                        Restrictions.Like(""area."" + AreasProperties.Name.ToString(), text, MatchMode.Anywhere),
                        Restrictions.Like(""area."" + AreasProperties.SlovenianName.ToString(), text, MatchMode.Anywhere)));

            ICriteria criteriaCountry = NHibernateSession.CreateCriteria(typeof(Advertisements))
                .CreateCriteria(AdvertisementsProperties.Country.ToString(), ""country"").
                    Add(Restrictions.Or(
                            Restrictions.Like(""country."" + CountriesProperties.Name.ToString(), text, MatchMode.Anywhere),
                            Restrictions.Like(""country."" + CountriesProperties.SlovenianName.ToString(), text, MatchMode.Anywhere)));


Regards",2
605495,03/03/2009 08:02:53,43836,12/05/2008 22:20:51,365,17,"SchemaExport, NHibernate and deleting foreign keys","I am building my mapping and then using schema export to update my DB. However, if I delete an association in my mapping, since it's no longer in the mapping, when I run SchemaExport, it will not delete the foreign key for the deleted association. This means that it then fails to drop the table associated with that foreign key. Which further means that it can't recreate the table and I get a ""There is already an object named Foo in the database"" exception. Is there any way to brute delete the table via Schema Export?",nhibernate,schemaexport,,,,,open,0,96,6,"SchemaExport, NHibernate and deleting foreign keys I am building my mapping and then using schema export to update my DB. However, if I delete an association in my mapping, since it's no longer in the mapping, when I run SchemaExport, it will not delete the foreign key for the deleted association. This means that it then fails to drop the table associated with that foreign key. Which further means that it can't recreate the table and I get a ""There is already an object named Foo in the database"" exception. Is there any way to brute delete the table via Schema Export?",2
8895839,01/17/2012 13:58:03,1831,08/18/2008 19:04:01,32107,1092,NHibernate default child collection and criteria strategies,"In the domain model, there are a number of entities that have a `Status` enum with values of either `Active` or `Deleted`.

I'm looking for documentation and advice on recommended approaches on how to handle:

1. When fetching a collection of entities that have a `Status` enum, to exclude those with the value set to `Deleted` by default (overridable on a case by case basis)

2. When fetching a child collection of entities, by default to exclude those with the value set to `Deleted` by default.

In summary, I effectively want to keep all data relating to entities with a `Status` enum property, but to exclude those that have a value of `Deleted` for status by default.

Any pointers in the right direction much appreciated.

",nhibernate,nhibernate-criteria,,,,,open,0,120,7,"NHibernate default child collection and criteria strategies In the domain model, there are a number of entities that have a `Status` enum with values of either `Active` or `Deleted`.

I'm looking for documentation and advice on recommended approaches on how to handle:

1. When fetching a collection of entities that have a `Status` enum, to exclude those with the value set to `Deleted` by default (overridable on a case by case basis)

2. When fetching a child collection of entities, by default to exclude those with the value set to `Deleted` by default.

In summary, I effectively want to keep all data relating to entities with a `Status` enum property, but to exclude those that have a value of `Deleted` for status by default.

Any pointers in the right direction much appreciated.

",2
4205637,11/17/2010 14:57:13,264719,02/02/2010 20:53:09,1,0,Castle DynamicProxy generated class names,"Does anybody know if it is possible to control the names of the types generated through Castle DynamicProxy?  I was hoping to take advantage of the ability to persist the assembly generated by Castle to add some additional classes with some specific functionality to my project, but I would like to be able to control the names of these generated proxy types.  Any help would be greatly appreciated.

I actually plan to persist instances of these classes as well as instances of the original classes that are the sources of the proxies with NHibernate.  So, I need these names to be consistent across multiple generations of the assembly. ",nhibernate,castle-dynamicproxy,,,,,open,0,111,5,"Castle DynamicProxy generated class names Does anybody know if it is possible to control the names of the types generated through Castle DynamicProxy?  I was hoping to take advantage of the ability to persist the assembly generated by Castle to add some additional classes with some specific functionality to my project, but I would like to be able to control the names of these generated proxy types.  Any help would be greatly appreciated.

I actually plan to persist instances of these classes as well as instances of the original classes that are the sources of the proxies with NHibernate.  So, I need these names to be consistent across multiple generations of the assembly. ",2
1595637,10/20/2009 15:52:37,190548,10/15/2009 11:28:08,1,0,What's the most productive way to do NHibernate mapping?,"I know annotations to do the hibernate mapping in Java and am looking now for a similar way to do the same in C# and NHibernate. I found out that there exists several approaches

 - do the mapping in xml files
 - NHibernate.Mapping.Attributes (NHMA)
 - Fluent
 - are there any more??

I tried NHMA and found out it had some blocking points for me...

I don't want you to discuss, whats the best way to map models to NHibernate, but I was looking for a good comparison on the internet.

Do you know such sites? What facts are the main points to consider, if I choose one of the ""frameworks"" listed above? I'm thinking of aspects like 'is this project offically supported by the NH-Developers?', 'are there models that can be mapped in xml-mapping but not in fluent/NHMA/etc...?'

What can you recommend?
Why?",nhibernate,mapping,fluent-nhibernate,nhibernate-mapping,,,open,0,138,9,"What's the most productive way to do NHibernate mapping? I know annotations to do the hibernate mapping in Java and am looking now for a similar way to do the same in C# and NHibernate. I found out that there exists several approaches

 - do the mapping in xml files
 - NHibernate.Mapping.Attributes (NHMA)
 - Fluent
 - are there any more??

I tried NHMA and found out it had some blocking points for me...

I don't want you to discuss, whats the best way to map models to NHibernate, but I was looking for a good comparison on the internet.

Do you know such sites? What facts are the main points to consider, if I choose one of the ""frameworks"" listed above? I'm thinking of aspects like 'is this project offically supported by the NH-Developers?', 'are there models that can be mapped in xml-mapping but not in fluent/NHMA/etc...?'

What can you recommend?
Why?",4
325501,11/28/2008 11:04:27,5789,09/11/2008 11:33:18,763,35,Castle/ Active Records: How do you count objects?,"I'm trying to do a simple ""Select Count(*) from PRODUCTS where date > xxx"" with Castle on NHibernate.

If I was directly using NHibernate, I could reuse [this question][1] answers but unfortunately I see no easy way to access the Current NHibernate session from Castle Records.

I obviously don't want to retrieve all my objects and do a Count on the C# side ;). I only need to know how many objects there are.

Any ideas?


[1]: http://stackoverflow.com/questions/116188/how-do-i-select-the-count-of-an-nhibernate-subquerys-results",nhibernate,castle-activerecord,sql,.net,,,open,0,74,8,"Castle/ Active Records: How do you count objects? I'm trying to do a simple ""Select Count(*) from PRODUCTS where date > xxx"" with Castle on NHibernate.

If I was directly using NHibernate, I could reuse [this question][1] answers but unfortunately I see no easy way to access the Current NHibernate session from Castle Records.

I obviously don't want to retrieve all my objects and do a Count on the C# side ;). I only need to know how many objects there are.

Any ideas?


[1]: http://stackoverflow.com/questions/116188/how-do-i-select-the-count-of-an-nhibernate-subquerys-results",4
41752,09/03/2008 14:13:45,230,08/03/2008 19:32:46,484,33,NHibernate Generators,"What is the best tool for generating Entity Class and/or hbm files and/or sql script for NHibernate.

This list below is from http://www.hibernate.org/365.html, which is the best any why?

    * Moregen Free, Open Source (GPL) O/R Generator that can merge into existing Visual Studio Projects. Also merges changes to generated classes.
    * NConstruct Lite Free tool for generating NHibernate O/R mapping source code. Different databases support (Microsoft SQL Server, Oracle, Access).
    * GENNIT NHibernate Code Generator Free/Commercial Web 2.0 code generation of NHibernate code using WYSIWYG online UML designer.
    * GenWise Studio with NHibernate Template Commercial product; Imports your existing database and generates all XML and Classes, including factories. It can also generate a asp.net web-application for your NHibernate BO-Layer automatically.
    * HQL Analyzer and hbm.xml GUI Editor
    * ObjectMapper by Mats Helander is a mapping GUI with NHibernate support
    * MyGeneration is a template-based code generator GUI. Its template library includes templates for generating mapping files and classes from a database.
    * AndroMDA is an open-source code generation framework that uses Model Driven Architecture (MDA) to transform UML models into deployable components. It supports generation of data access layers that use NHibernate as their persistence framework.
    * CodeSmith Template for NH
    * NHibernate Helper Kit is a VS2005 add-in to generate classes and mapping files.
    * NConstruct - Intelligent Software Factory Commercial product; Full .NET C# source code generation for all tiers of the information system trough simple wizard procedure. O/R mapping based on NHibernate. For both WinForms and ASP.NET 2.0.",nhibernate,,,,,01/30/2012 22:33:39,not constructive,1,284,2,"NHibernate Generators What is the best tool for generating Entity Class and/or hbm files and/or sql script for NHibernate.

This list below is from http://www.hibernate.org/365.html, which is the best any why?

    * Moregen Free, Open Source (GPL) O/R Generator that can merge into existing Visual Studio Projects. Also merges changes to generated classes.
    * NConstruct Lite Free tool for generating NHibernate O/R mapping source code. Different databases support (Microsoft SQL Server, Oracle, Access).
    * GENNIT NHibernate Code Generator Free/Commercial Web 2.0 code generation of NHibernate code using WYSIWYG online UML designer.
    * GenWise Studio with NHibernate Template Commercial product; Imports your existing database and generates all XML and Classes, including factories. It can also generate a asp.net web-application for your NHibernate BO-Layer automatically.
    * HQL Analyzer and hbm.xml GUI Editor
    * ObjectMapper by Mats Helander is a mapping GUI with NHibernate support
    * MyGeneration is a template-based code generator GUI. Its template library includes templates for generating mapping files and classes from a database.
    * AndroMDA is an open-source code generation framework that uses Model Driven Architecture (MDA) to transform UML models into deployable components. It supports generation of data access layers that use NHibernate as their persistence framework.
    * CodeSmith Template for NH
    * NHibernate Helper Kit is a VS2005 add-in to generate classes and mapping files.
    * NConstruct - Intelligent Software Factory Commercial product; Full .NET C# source code generation for all tiers of the information system trough simple wizard procedure. O/R mapping based on NHibernate. For both WinForms and ASP.NET 2.0.",1
2494161,03/22/2010 17:00:12,211848,11/16/2009 07:38:50,11,1,NHibernate: How to save list in the database?,"I have a table Order, Transaction, Payment. Class Order has the properties:

    public virtual Guid Id { get; set; }
    public virtual DateTime Created { get; set; }
    ...

I added properties:

    public virtual IList<Transaction> Transactions { get; set; }
    public virtual IList<Payment> Payments { get; set; }

These properties contain a record of tables [Transaction] and [Payment].
How to keep these lists in the database?",nhibernate,c#,,,,,open,0,78,8,"NHibernate: How to save list in the database? I have a table Order, Transaction, Payment. Class Order has the properties:

    public virtual Guid Id { get; set; }
    public virtual DateTime Created { get; set; }
    ...

I added properties:

    public virtual IList<Transaction> Transactions { get; set; }
    public virtual IList<Payment> Payments { get; set; }

These properties contain a record of tables [Transaction] and [Payment].
How to keep these lists in the database?",2
2927791,05/28/2010 09:12:20,352732,05/28/2010 09:12:20,1,0,How to set connection string dynamically in Nhbiernate,"I want assign connection string for NHibernate using following code and getting exception (bold). 

log4net.Config.DOMConfigurator.Configure();
Configuration config = new Configuration();
            IDictionary props = new Hashtable();

            props[""hibernate.connection.provider""] = ""NHibernate.Connection.DriverConnectionProvider"";
            props[""hibernate.dialect""] = ""NHibernate.Dialect.MsSql2000Dialect"";
            props[""hibernate.connection.driver_class""] = ""NHibernate.Driver.SqlClientDriver"";
            props[""hibernate.connection.connection_string""] = @""Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=Sample;Data Source=HYDHTC92318D\SQLEXPRESS"";
            props[""hibernate.connection.current_session_context_class""] = ""web"";
            props[""hibernate.connection.show_sql""] = ""true"";

            props[""hibernate.connection.proxyfactoryfactory.factory_class""] = ""NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle"";

            foreach (DictionaryEntry de in props)
            {
                config.SetProperty(de.Key.ToString(), de.Value.ToString());
            }

            config.AddAssembly(""nhibernator"");
            factory = config.BuildSessionFactory();
            session = factory.OpenSession();


**The ProxyFactoryFactory was not configured.
Initialize 'proxyfactory.factory_class' property of the session-factory configuration section with one of the available NHibernate.ByteCode providers.
Example:
<property name='proxyfactory.factory_class'>NHibernate.ByteCode.LinFu.ProxyFactoryFactory, NHibernate.ByteCode.LinFu</property>
Example:
<property name='proxyfactory.factory_class'>NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>**

Please let me know the solution.
Regards
JCReddy",nhibernate,string,connection,,,,open,0,263,8,"How to set connection string dynamically in Nhbiernate I want assign connection string for NHibernate using following code and getting exception (bold). 

log4net.Config.DOMConfigurator.Configure();
Configuration config = new Configuration();
            IDictionary props = new Hashtable();

            props[""hibernate.connection.provider""] = ""NHibernate.Connection.DriverConnectionProvider"";
            props[""hibernate.dialect""] = ""NHibernate.Dialect.MsSql2000Dialect"";
            props[""hibernate.connection.driver_class""] = ""NHibernate.Driver.SqlClientDriver"";
            props[""hibernate.connection.connection_string""] = @""Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=Sample;Data Source=HYDHTC92318D\SQLEXPRESS"";
            props[""hibernate.connection.current_session_context_class""] = ""web"";
            props[""hibernate.connection.show_sql""] = ""true"";

            props[""hibernate.connection.proxyfactoryfactory.factory_class""] = ""NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle"";

            foreach (DictionaryEntry de in props)
            {
                config.SetProperty(de.Key.ToString(), de.Value.ToString());
            }

            config.AddAssembly(""nhibernator"");
            factory = config.BuildSessionFactory();
            session = factory.OpenSession();


**The ProxyFactoryFactory was not configured.
Initialize 'proxyfactory.factory_class' property of the session-factory configuration section with one of the available NHibernate.ByteCode providers.
Example:
<property name='proxyfactory.factory_class'>NHibernate.ByteCode.LinFu.ProxyFactoryFactory, NHibernate.ByteCode.LinFu</property>
Example:
<property name='proxyfactory.factory_class'>NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle</property>**

Please let me know the solution.
Regards
JCReddy",3
3962506,10/18/2010 19:15:08,479691,10/18/2010 19:15:08,1,0,XPO or NHibernate,"Cześć,
stoję właśnie przed wyborem ORM'a. I waham się: XPO czy NHibernate?
Masz jakieś konkretne doświadczenia, którymi chciałbyś się ze mną podzielić?

Będę wdzięczna za wszelkie info.

Pozdrawiam,
Ola :)
aleksandra.wasacz@snt.pl



Hallo,
I founded that you are familliar with these 2 ORM's : XPO (DevExpress) and NHibernate.
What is your experience?
I need to choose ORM for my enterprise solution and I'm not sure which one is better?
I mean memory problems, usability,....etc

I will be grateful for any suggestion with explanations.
 
Best Regards,
Alexandra
aleksandra.wasacz@snt.pl",nhibernate,,,,,10/21/2010 01:20:03,too localized,1,72,3,"XPO or NHibernate Cześć,
stoję właśnie przed wyborem ORM'a. I waham się: XPO czy NHibernate?
Masz jakieś konkretne doświadczenia, którymi chciałbyś się ze mną podzielić?

Będę wdzięczna za wszelkie info.

Pozdrawiam,
Ola :)
aleksandra.wasacz@snt.pl



Hallo,
I founded that you are familliar with these 2 ORM's : XPO (DevExpress) and NHibernate.
What is your experience?
I need to choose ORM for my enterprise solution and I'm not sure which one is better?
I mean memory problems, usability,....etc

I will be grateful for any suggestion with explanations.
 
Best Regards,
Alexandra
aleksandra.wasacz@snt.pl",1
1347302,08/28/2009 14:21:40,40822,11/25/2008 21:41:31,1608,131,Two classes mapped to same table(one readonly) must be in correct order?,"Consider these two classes mapped to the same table. One is readonly via mutable=""false"".

    <class name=""Funder"" table=""funder"">
        <id name=""id"">
          <generator class=""identity"" />
        </id>
        <property name=""funder_name"" />
        <property name=""contact_name"" />
        <property name=""addr_line_1"" />
        <property name=""addr_line_2"" />
        <property name=""addr_line_3"" />
        <property name=""city"" />
        <many-to-one name=""state"" column=""state_id"" foreign-key=""FK_funder_state_id"" fetch=""join"" />
        <property name=""zip_code"" length=""10"" />
        <property name=""phone_number"" length=""30"" />
       
        <property name=""create_dt"" update=""false"" not-null=""true"" />
        <many-to-one name=""create_by"" column=""create_by"" not-null=""true"" update=""false"" foreign-key=""FK_funder_create_by"" fetch=""join"" />
        <property name=""last_update_dt"" insert=""false"" />
        <many-to-one name=""last_update_by"" insert=""false"" foreign-key=""FK_funder_last_update_by"" fetch=""join"" />
       
      </class>
    
      <class name=""FunderSimple"" table=""funder"" schema-action=""none"" mutable=""false"">
        <id name=""id"">
          <generator class=""identity"" />
        </id>
        <property name=""funder_name"" />
        <property name=""contact_name"" />
        <property name=""phone_number"" />
      </class>

If I move the FunderSimple mapping before the Funder mapping my schema does **not** generate correctly. If I leave it as is above, it works.

Is this by design? It seems as though the schema-action=""none"" sticks to the table_name and later mappings to the same table will not generate the schema.

I'm doing it like this because I have another class named Contract which has a foreign key to the funder table. However, I don't need all the funder columns when referencing from the contract object. 

    <many-to-one name=""funder_simple"" column=""funder_id""  foreign-key=""FK_contract_funder_id"" fetch=""join"" />

Funder does not inherit from FunderSimple.

Should I be using a different technique to fetch only a subset of columns from a foreign key table? Is many-to-one the only way to setup a foreign key?

using version 2.1.0.4000",nhibernate,nhibernate-mapping,,,,,open,0,423,12,"Two classes mapped to same table(one readonly) must be in correct order? Consider these two classes mapped to the same table. One is readonly via mutable=""false"".

    <class name=""Funder"" table=""funder"">
        <id name=""id"">
          <generator class=""identity"" />
        </id>
        <property name=""funder_name"" />
        <property name=""contact_name"" />
        <property name=""addr_line_1"" />
        <property name=""addr_line_2"" />
        <property name=""addr_line_3"" />
        <property name=""city"" />
        <many-to-one name=""state"" column=""state_id"" foreign-key=""FK_funder_state_id"" fetch=""join"" />
        <property name=""zip_code"" length=""10"" />
        <property name=""phone_number"" length=""30"" />
       
        <property name=""create_dt"" update=""false"" not-null=""true"" />
        <many-to-one name=""create_by"" column=""create_by"" not-null=""true"" update=""false"" foreign-key=""FK_funder_create_by"" fetch=""join"" />
        <property name=""last_update_dt"" insert=""false"" />
        <many-to-one name=""last_update_by"" insert=""false"" foreign-key=""FK_funder_last_update_by"" fetch=""join"" />
       
      </class>
    
      <class name=""FunderSimple"" table=""funder"" schema-action=""none"" mutable=""false"">
        <id name=""id"">
          <generator class=""identity"" />
        </id>
        <property name=""funder_name"" />
        <property name=""contact_name"" />
        <property name=""phone_number"" />
      </class>

If I move the FunderSimple mapping before the Funder mapping my schema does **not** generate correctly. If I leave it as is above, it works.

Is this by design? It seems as though the schema-action=""none"" sticks to the table_name and later mappings to the same table will not generate the schema.

I'm doing it like this because I have another class named Contract which has a foreign key to the funder table. However, I don't need all the funder columns when referencing from the contract object. 

    <many-to-one name=""funder_simple"" column=""funder_id""  foreign-key=""FK_contract_funder_id"" fetch=""join"" />

Funder does not inherit from FunderSimple.

Should I be using a different technique to fetch only a subset of columns from a foreign key table? Is many-to-one the only way to setup a foreign key?

using version 2.1.0.4000",2
2461718,03/17/2010 11:14:07,283538,03/01/2010 10:53:04,17,1,NHibernate - fast way to clear out database,"I intend to perform some automated integration tests. This requires the db to be put back into a 'clean state'. Is this the fastest/best way to do this:

var cfg = new Configuration(); cfg.Configure(); cfg.AddAssembly(""Bla""); new SchemaExport(cfg).Execute(false, true, false);

Thanks.

Christian",nhibernate,integration-testing,,,,,open,0,38,8,"NHibernate - fast way to clear out database I intend to perform some automated integration tests. This requires the db to be put back into a 'clean state'. Is this the fastest/best way to do this:

var cfg = new Configuration(); cfg.Configure(); cfg.AddAssembly(""Bla""); new SchemaExport(cfg).Execute(false, true, false);

Thanks.

Christian",2
2544947,03/30/2010 12:09:11,129609,06/26/2009 19:26:50,15,1,NHibernate & Cancelling Changes to Entities,"This seems like it would be a common issue to be but I don't know the best way to solve it.  I want to be able to send an Entity to a view, have changes be made to the entity in the view, but then cancel (remove) those changes if the user cancels out of the view.  What is the proper way to do this.

Here are two options I have but I think there should be others that are better


1) Take an entity, create a clone, send the clone to the view...if changes are accepted, update the original entity with the clone's values

2) Send the entity to the view, if the user cancels, remove the entity from NHibernate's cache and reload it from the database

For (2), the issue for me would be that the old entity could still be referenced throughout my project after it has been removed from the cache.  ",nhibernate,c#,.net,entity,,,open,0,155,6,"NHibernate & Cancelling Changes to Entities This seems like it would be a common issue to be but I don't know the best way to solve it.  I want to be able to send an Entity to a view, have changes be made to the entity in the view, but then cancel (remove) those changes if the user cancels out of the view.  What is the proper way to do this.

Here are two options I have but I think there should be others that are better


1) Take an entity, create a clone, send the clone to the view...if changes are accepted, update the original entity with the clone's values

2) Send the entity to the view, if the user cancels, remove the entity from NHibernate's cache and reload it from the database

For (2), the issue for me would be that the old entity could still be referenced throughout my project after it has been removed from the cache.  ",4
799112,04/28/2009 17:50:51,15769,09/17/2008 12:35:34,598,23,Error building SessionFactory in nHibernate.,"I am getting an ""ArgumentOutOfRangeException"" on parameter index whenever I try to instantiate a session factory in nHibernate. There error comes from a procedure deep in the bowels of nHibernate. I can post the stack-trace of the error if that would help.

This is on a fresh project with a pretty simple three tier architecture. The data layer maps the nHibernate classes to simple interfaces which are implemented by the business layer. Currently there is only one interface set and mapping file being used by nHibernate. Hopefully my issue is easy to spot.

Here is the function where I build the sessionFactory.

      Private Shared Function SessionFactory() As ISessionFactory
            If _sessionFactory Is Nothing Then
                Dim config As New NHibernate.Cfg.Configuration
                config.Configure()
                config.AddClass(GetType(ICompanyProperty))
                _sessionFactory = config.BuildSessionFactory            
            End If
            Return _sessionFactory
        End Function

Here is my hibernate.cfg.xml

    <?xml version=""1.0"" encoding=""utf-8"" ?>
    <hibernate-configuration xmlns=""urn:nhibernate-configuration-2.2"">
      <session-factory>
        <property name=""connection.provider"">
          NHibernate.Connection.DriverConnectionProvider     
        </property>
        <property name=""dialect"">
          NHibernate.Dialect.MsSql2005Dialect
        </property>
        <property name=""connection.driver_class"">
          NHibernate.Driver.SqlClientDriver
        </property>
        <property name=""connection.connection_string"">
          Data Source=dataserver.domain.ad;Initial Catalog=LABs;Integrated Security=SSPI
        </property>
      </session-factory>
    </hibernate-configuration>

And the mapping file of the interface I am mapping.


    <?xml version=""1.0"" encoding=""utf-8"" ?>
    <hibernate-mapping xmlns=""urn:nhibernate-mapping-2.2"" assembly=""Sample.Data"" namespace=""Sample.Data"">
      <class name=""ICompanyProperty"" table=""CompanyProperty"">
        <id name=""CompanyPropertyID"" column=""CompanyPropertyID"">
          <generator class=""native"" />
        </id>    
        <discriminator column=""PropertyType"" type=""String"" />
        <property name=""CompanyID"" />
        <property name=""PropertyName"" />    
        <subclass discriminator-value=""SQL"" name=""ISQLLookupCompanyProperty"">
          <property name=""TableName"" />      
          <property name=""KeyField"" />
          <property name=""ValueField"" />
          <property name=""ConnectionString"" />
        </subclass>
        <subclass discriminator-value=""LIST"" name=""ILookupCompanyProperty"" />    
      </class>
    </hibernate-mapping>

And the interfaces

    Public Interface ICompanyProperty
        Property CompanyPropertyID() As Integer
        Property PropertyName() As String
        Property CompanyID() As Integer
        Property PropertyType() As String
    End Interface
    
    Public Interface ILookupCompanyProperty
        Inherits ICompanyProperty
    End Interface
    
    Public Interface ISQLLookupCompanyProperty
        Inherits ILookupCompanyProperty
    
        Property TableName() As String
        Property KeyField() As String
        Property ValueField() As String
        Property ConnectionString() As String
    End Interface

Thank you!",nhibernate,vb.net,,,,,open,0,742,5,"Error building SessionFactory in nHibernate. I am getting an ""ArgumentOutOfRangeException"" on parameter index whenever I try to instantiate a session factory in nHibernate. There error comes from a procedure deep in the bowels of nHibernate. I can post the stack-trace of the error if that would help.

This is on a fresh project with a pretty simple three tier architecture. The data layer maps the nHibernate classes to simple interfaces which are implemented by the business layer. Currently there is only one interface set and mapping file being used by nHibernate. Hopefully my issue is easy to spot.

Here is the function where I build the sessionFactory.

      Private Shared Function SessionFactory() As ISessionFactory
            If _sessionFactory Is Nothing Then
                Dim config As New NHibernate.Cfg.Configuration
                config.Configure()
                config.AddClass(GetType(ICompanyProperty))
                _sessionFactory = config.BuildSessionFactory            
            End If
            Return _sessionFactory
        End Function

Here is my hibernate.cfg.xml

    <?xml version=""1.0"" encoding=""utf-8"" ?>
    <hibernate-configuration xmlns=""urn:nhibernate-configuration-2.2"">
      <session-factory>
        <property name=""connection.provider"">
          NHibernate.Connection.DriverConnectionProvider     
        </property>
        <property name=""dialect"">
          NHibernate.Dialect.MsSql2005Dialect
        </property>
        <property name=""connection.driver_class"">
          NHibernate.Driver.SqlClientDriver
        </property>
        <property name=""connection.connection_string"">
          Data Source=dataserver.domain.ad;Initial Catalog=LABs;Integrated Security=SSPI
        </property>
      </session-factory>
    </hibernate-configuration>

And the mapping file of the interface I am mapping.


    <?xml version=""1.0"" encoding=""utf-8"" ?>
    <hibernate-mapping xmlns=""urn:nhibernate-mapping-2.2"" assembly=""Sample.Data"" namespace=""Sample.Data"">
      <class name=""ICompanyProperty"" table=""CompanyProperty"">
        <id name=""CompanyPropertyID"" column=""CompanyPropertyID"">
          <generator class=""native"" />
        </id>    
        <discriminator column=""PropertyType"" type=""String"" />
        <property name=""CompanyID"" />
        <property name=""PropertyName"" />    
        <subclass discriminator-value=""SQL"" name=""ISQLLookupCompanyProperty"">
          <property name=""TableName"" />      
          <property name=""KeyField"" />
          <property name=""ValueField"" />
          <property name=""ConnectionString"" />
        </subclass>
        <subclass discriminator-value=""LIST"" name=""ILookupCompanyProperty"" />    
      </class>
    </hibernate-mapping>

And the interfaces

    Public Interface ICompanyProperty
        Property CompanyPropertyID() As Integer
        Property PropertyName() As String
        Property CompanyID() As Integer
        Property PropertyType() As String
    End Interface
    
    Public Interface ILookupCompanyProperty
        Inherits ICompanyProperty
    End Interface
    
    Public Interface ISQLLookupCompanyProperty
        Inherits ILookupCompanyProperty
    
        Property TableName() As String
        Property KeyField() As String
        Property ValueField() As String
        Property ConnectionString() As String
    End Interface

Thank you!",2
3830747,09/30/2010 13:06:56,267153,11/20/2009 19:20:29,594,37,About NHibernate's ISession,"In [this][1] question, the user asks the better way to close sessions because he was having some errors.


The most voted answer is Ayende's answer that says:

>You should always use session.Dispose(); The other are for very strange occurances

Should I really always call `session.Dispose()`? Isn't enough to call `session.Close()`?


  [1]: http://stackoverflow.com/questions/1473019/how-to-properly-use-a-nhibernate-isession-object-session-is-closed-errors",nhibernate,isession,,,,,open,0,50,3,"About NHibernate's ISession In [this][1] question, the user asks the better way to close sessions because he was having some errors.


The most voted answer is Ayende's answer that says:

>You should always use session.Dispose(); The other are for very strange occurances

Should I really always call `session.Dispose()`? Isn't enough to call `session.Close()`?


  [1]: http://stackoverflow.com/questions/1473019/how-to-properly-use-a-nhibernate-isession-object-session-is-closed-errors",2
11342985,07/05/2012 11:01:45,571308,01/11/2011 13:25:13,11,0,Cannot create an abstract class when using abstract base class for custom id generator,"I have an abstract class implementing IIdentifierGenerator, IGeneratorDef and I have a concrete implementation of GenericGenerator called ActivitySeqenceGenerator.

When I try to use ActivitySeqenceGenerator in my class map I receive the following error:
NHibernate.MappingException : could not instantiate id generator: GenericGenerator, Repositories, Version=6.6.0.11003, Culture=neutral, PublicKeyToken=null
  ----> System.MissingMethodException : Cannot create an abstract class.


    public abstract class GenericGenerator : NHibernate.Id.IIdentifierGenerator, IGeneratorDef
    
    public class ActivitySequenceGenerator : GenericGenerator

    Id(x => x.Id, m => m.Generator(new ActivitySequenceGenerator()));

It seems wrong that nHibernate should try to instantiate the base class when I pass it the concrete implementation. Or am I missing something here?",nhibernate,nhibernate-mapping,mapping-by-code,,,,open,0,108,14,"Cannot create an abstract class when using abstract base class for custom id generator I have an abstract class implementing IIdentifierGenerator, IGeneratorDef and I have a concrete implementation of GenericGenerator called ActivitySeqenceGenerator.

When I try to use ActivitySeqenceGenerator in my class map I receive the following error:
NHibernate.MappingException : could not instantiate id generator: GenericGenerator, Repositories, Version=6.6.0.11003, Culture=neutral, PublicKeyToken=null
  ----> System.MissingMethodException : Cannot create an abstract class.


    public abstract class GenericGenerator : NHibernate.Id.IIdentifierGenerator, IGeneratorDef
    
    public class ActivitySequenceGenerator : GenericGenerator

    Id(x => x.Id, m => m.Generator(new ActivitySequenceGenerator()));

It seems wrong that nHibernate should try to instantiate the base class when I pass it the concrete implementation. Or am I missing something here?",3
9308577,02/16/2012 09:26:57,579860,01/18/2011 11:39:45,26,6,Nhibernate Proxy error,"Using Nhibernate ORM in my application and mysql database as backend.I am getting ,""proxy error"" while fetching the data.

",nhibernate,orm,,,,02/16/2012 13:51:08,not a real question,1,19,3,"Nhibernate Proxy error Using Nhibernate ORM in my application and mysql database as backend.I am getting ,""proxy error"" while fetching the data.

",2
1006647,06/17/2009 12:21:20,112757,05/26/2009 20:46:37,3,1,Updating an entity with NHibernate in Asp.Net,"What's the recommended way of updating an entity? So far, I figured out two ways:

 1. Just create a new entity with the existing Id and updated property values, and use session.SaveOrUpdate()
 2. Use a DTO, retrieve the existing entity using session.Load(dto.Id), assign new vaues from the dto, then save.

No1 requires much less effort, but sometimes I'm getting an exception: ""a different object with the same identifier value was already associated with the session"". Is there a simple way around that?

No2 might require an extra trip to the DB I guess?

Sorry if that's been answered already, just couldn't find the answer.

Thanks
ulu",nhibernate,asp.net,update,,,,open,0,101,7,"Updating an entity with NHibernate in Asp.Net What's the recommended way of updating an entity? So far, I figured out two ways:

 1. Just create a new entity with the existing Id and updated property values, and use session.SaveOrUpdate()
 2. Use a DTO, retrieve the existing entity using session.Load(dto.Id), assign new vaues from the dto, then save.

No1 requires much less effort, but sometimes I'm getting an exception: ""a different object with the same identifier value was already associated with the session"". Is there a simple way around that?

No2 might require an extra trip to the DB I guess?

Sorry if that's been answered already, just couldn't find the answer.

Thanks
ulu",3
8885616,01/16/2012 20:02:48,917010,08/29/2011 01:55:47,12,0,Discussion on Service Oriented Architecture & NServiceBus,"I'm new to Service Oriented Architecture (SOA), as well as NServicebus. I have few thoughts on structuring my code in SOA using NServicebus. So, please do give me feedback on my design.

The technology that I'm going to use are NServiceBus, NHibernate and Castle Windsor for IoC.

Assume this scenario. I have a Member service. In the Member service, I have 3 autonomous components (Add Member, Search Member, Delete Member). 

Design 1 : The Member service will have ONE service bus communicating with ONE MSMQ, ONE  NHibernate session factory, and ONE  Windsor container. Three components will be sharing the same Bus, Queue, session factory and windsor container.

Design 2 : In the Member Service ,each autonomous component has their own service bus, NHibernate Session Factory, Windsor Container. There will be total of 3 service bus created communicating with 3 MSMQ, 3 NHibernate session factory, and 3 Windsor container. Therefore, if one of the component break down, another component will still be running.

Which one do you prefer? Design 1 or 2 ? Please do tell me what you think or you have a better design. Thanks all. 

",nhibernate,castle-windsor,soa,nservicebus,nservicebus-distributor,01/17/2012 23:05:50,not constructive,1,186,7,"Discussion on Service Oriented Architecture & NServiceBus I'm new to Service Oriented Architecture (SOA), as well as NServicebus. I have few thoughts on structuring my code in SOA using NServicebus. So, please do give me feedback on my design.

The technology that I'm going to use are NServiceBus, NHibernate and Castle Windsor for IoC.

Assume this scenario. I have a Member service. In the Member service, I have 3 autonomous components (Add Member, Search Member, Delete Member). 

Design 1 : The Member service will have ONE service bus communicating with ONE MSMQ, ONE  NHibernate session factory, and ONE  Windsor container. Three components will be sharing the same Bus, Queue, session factory and windsor container.

Design 2 : In the Member Service ,each autonomous component has their own service bus, NHibernate Session Factory, Windsor Container. There will be total of 3 service bus created communicating with 3 MSMQ, 3 NHibernate session factory, and 3 Windsor container. Therefore, if one of the component break down, another component will still be running.

Which one do you prefer? Design 1 or 2 ? Please do tell me what you think or you have a better design. Thanks all. 

",5
944591,06/03/2009 12:57:15,109646,05/19/2009 22:41:47,8,1,Fastest way to query for object existence in NHibernate,"I am looking for the fastest way to **check for the existence of an object**.
The scenario is pretty simple, assume a directory tool, which reads the current hard drive. When a directory is found, it should be either created, or, if already present, updated.

First lets only focus on the creation part:

        public static DatabaseDirectory Get(DirectoryInfo dI)
        {
            var result = DatabaseController.Session
                          .CreateCriteria(typeof (DatabaseDirectory))
                          .Add(Restrictions.Eq(""FullName"", dI.FullName))
                          .List<DatabaseDirectory>().FirstOrDefault();

            if (result == null)
            {
                result = new DatabaseDirectory
                             {
                                 CreationTime = dI.CreationTime,
                                 Existing = dI.Exists,
                                 Extension = dI.Extension,
                                 FullName = dI.FullName,
                                 LastAccessTime = dI.LastAccessTime,
                                 LastWriteTime = dI.LastWriteTime,
                                 Name = dI.Name
                             };
            }
            return result;
        }


Is this the way to go regarding:

- Speed
- Separation of Concern

What comes to mind is the following: A scan will always be performed ""as a whole"". Meaning, during a scan of drive C, I know that nothing new gets added to the database (from some other process). So it MAY be a good idea to ""cache"" all existing directories prior to the scan, and look them up this way. On the other hand, this may be not suitable for large sets of data, like files (which will be 600.000 or more)...

Perhaps some performance gain can be achieved using ""index columns"" or something like this, but I am not so familiar with this topic. If anybody has some references, just point me in the right direction...

Thanks,
Chris

PS: I am using NHibernate, Fluent Interface, Automapping and SQL Express (could switch to full SQL)



 ",nhibernate,query,,,,,open,0,688,9,"Fastest way to query for object existence in NHibernate I am looking for the fastest way to **check for the existence of an object**.
The scenario is pretty simple, assume a directory tool, which reads the current hard drive. When a directory is found, it should be either created, or, if already present, updated.

First lets only focus on the creation part:

        public static DatabaseDirectory Get(DirectoryInfo dI)
        {
            var result = DatabaseController.Session
                          .CreateCriteria(typeof (DatabaseDirectory))
                          .Add(Restrictions.Eq(""FullName"", dI.FullName))
                          .List<DatabaseDirectory>().FirstOrDefault();

            if (result == null)
            {
                result = new DatabaseDirectory
                             {
                                 CreationTime = dI.CreationTime,
                                 Existing = dI.Exists,
                                 Extension = dI.Extension,
                                 FullName = dI.FullName,
                                 LastAccessTime = dI.LastAccessTime,
                                 LastWriteTime = dI.LastWriteTime,
                                 Name = dI.Name
                             };
            }
            return result;
        }


Is this the way to go regarding:

- Speed
- Separation of Concern

What comes to mind is the following: A scan will always be performed ""as a whole"". Meaning, during a scan of drive C, I know that nothing new gets added to the database (from some other process). So it MAY be a good idea to ""cache"" all existing directories prior to the scan, and look them up this way. On the other hand, this may be not suitable for large sets of data, like files (which will be 600.000 or more)...

Perhaps some performance gain can be achieved using ""index columns"" or something like this, but I am not so familiar with this topic. If anybody has some references, just point me in the right direction...

Thanks,
Chris

PS: I am using NHibernate, Fluent Interface, Automapping and SQL Express (could switch to full SQL)



 ",2
8184547,11/18/2011 15:08:42,1054049,11/18/2011 15:01:38,1,0,"Need demo code or Articles on Silverlight 4.0, MVVM, RIA, MEF, Caliburn.Micro and NHibernate","I am new to Silverlight and MVVM and need very good articles OR DEMO on Silverlight 4.0 application on MVVM, Caliburn.Micro, MEF, WCF RIA service with NHibernate for LOB application. Please share your valuable thoughts or link on the same.

Your help we be highly appreciated. Thanks
",nhibernate,silverlight-4.0,mvvm,wcf-ria-services,caliburn.micro,11/19/2011 05:19:33,not a real question,1,46,14,"Need demo code or Articles on Silverlight 4.0, MVVM, RIA, MEF, Caliburn.Micro and NHibernate I am new to Silverlight and MVVM and need very good articles OR DEMO on Silverlight 4.0 application on MVVM, Caliburn.Micro, MEF, WCF RIA service with NHibernate for LOB application. Please share your valuable thoughts or link on the same.

Your help we be highly appreciated. Thanks
",5
10470175,05/06/2012 11:29:51,395205,07/18/2010 15:02:41,14,4,How to execute update for multiple rows by linq expression as a where clause,"We use some sort of criteria language to pass queries' where clauses from clients to server. When it comes to server we convert it to linq expression and execute query with NH.
For example 'get events page' query seems like that:

    Session.Query<EventExtractData>()
    .Where(message.Criteria.GetExpression())
    .OrderByDescending(e => e.CreateTimeUtc)
    .Skip(message.Start)
    .Take(message.Size)
    .ToArray()

message.Criteria is a composition of ""atomic"" criterions implementing abstract Criterion&lt;T> and glued with And&lt;T> and Or&lt;T> criterions. Each concrete criterion implements Expression&lt;Func&lt;T, bool>> GetExpression()  function.<br>
It's work.<br>
Now we want to use same criterions to execute updates on multiple rows.<br>
I can't just fetch all rows that comply for the criteria and then update them one by one. It will be a performance issue. <br>
I want to execute update by one single command:

    UPDATE <real view name of mapped EventExtractData class> 
    SET <my business logic> 
    WHERE <my criterions' linq expression translated to SQL where clause>

I am looking for a way to implement this update with NH.<br>
Actualy, I think what I need is to parse linq expression to sql with NH linq provider.<br>
How to do it?


",nhibernate,,,,,,open,0,199,14,"How to execute update for multiple rows by linq expression as a where clause We use some sort of criteria language to pass queries' where clauses from clients to server. When it comes to server we convert it to linq expression and execute query with NH.
For example 'get events page' query seems like that:

    Session.Query<EventExtractData>()
    .Where(message.Criteria.GetExpression())
    .OrderByDescending(e => e.CreateTimeUtc)
    .Skip(message.Start)
    .Take(message.Size)
    .ToArray()

message.Criteria is a composition of ""atomic"" criterions implementing abstract Criterion&lt;T> and glued with And&lt;T> and Or&lt;T> criterions. Each concrete criterion implements Expression&lt;Func&lt;T, bool>> GetExpression()  function.<br>
It's work.<br>
Now we want to use same criterions to execute updates on multiple rows.<br>
I can't just fetch all rows that comply for the criteria and then update them one by one. It will be a performance issue. <br>
I want to execute update by one single command:

    UPDATE <real view name of mapped EventExtractData class> 
    SET <my business logic> 
    WHERE <my criterions' linq expression translated to SQL where clause>

I am looking for a way to implement this update with NH.<br>
Actualy, I think what I need is to parse linq expression to sql with NH linq provider.<br>
How to do it?


",1
7367009,09/09/2011 20:20:24,97879,04/29/2009 18:38:51,335,14,Are there examples of SPROC mappings and usage with Fluent NHibernate?,"I'm looking for an example of how I would/should use the SqlUpdate, SqlDelete, and SqlInsert parts of Fluent NHibernate in my mappings.

I have a standard 

    public class MyObjectMap : ClassMap<MyObject> {

        public MyObjectMap() {
            Table(""MyObjectsTable"");

            Id(x => x.Id).GeneratedBy.Identity();
            Map(x => x.This, ""That"");
            // Ad nauseam

            // how do I use this part?
            SqlUpdate("" some sql here "");
            


The question is, how do I make use of a StoredProcedurePart in this way?  How do I specify only the right parameters?
              


        
",nhibernate,stored-procedures,fluent-nhibernate,fluent-nhibernate-mapping,,,open,0,190,11,"Are there examples of SPROC mappings and usage with Fluent NHibernate? I'm looking for an example of how I would/should use the SqlUpdate, SqlDelete, and SqlInsert parts of Fluent NHibernate in my mappings.

I have a standard 

    public class MyObjectMap : ClassMap<MyObject> {

        public MyObjectMap() {
            Table(""MyObjectsTable"");

            Id(x => x.Id).GeneratedBy.Identity();
            Map(x => x.This, ""That"");
            // Ad nauseam

            // how do I use this part?
            SqlUpdate("" some sql here "");
            


The question is, how do I make use of a StoredProcedurePart in this way?  How do I specify only the right parameters?
              


        
",4
399459,12/30/2008 03:23:45,17510,09/18/2008 10:26:18,39,0,NHibernate Mapping intermediary table,"Hi I'm looking for some help in mapping the following tables to a hibernate mapping file:
![schema image][1]

I'm trying to fill the localCalandarGroups List with related localCalendarGroups when loading my userVOs. I'm using a intermediary table(user_localCalendarGroup) to keep the user and localCalendarGroup ids

     public class UserVO
    {
        public virtual int id { get; set; }
        public virtual string name { get; set; }
        public virtual string pass { get; set; }
        public virtual string email { get; set; }
        public virtual string level { get; set; }
        public virtual List<LocalCalendarGroupVO> localCalendarGroups { get; set; }
    }
    public class LocalCalendarGroupVO
    {

        public virtual int id { get; set; }
        public virtual string name { get; set; }

    }

This is my mapping file thus far. How can I make NHibernate aware of the intermediary table?

     <class name=""UserVO"" table=""tb_users"" lazy=""false"">

    <id name=""id"" column=""id"">

      <generator class=""native"" />

    </id>

    <property name=""name"" />
    <property name=""pass"" />
    <property name=""level"" />
    <property name=""email"" />
    <property name=""localCalendarGroups""/>
    


  </class>

Any help,pointers much appreciated.

  [1]: http://barry-jones.com/temp/sch2.jpg",nhibernate,hibernate,,,,,open,0,274,4,"NHibernate Mapping intermediary table Hi I'm looking for some help in mapping the following tables to a hibernate mapping file:
![schema image][1]

I'm trying to fill the localCalandarGroups List with related localCalendarGroups when loading my userVOs. I'm using a intermediary table(user_localCalendarGroup) to keep the user and localCalendarGroup ids

     public class UserVO
    {
        public virtual int id { get; set; }
        public virtual string name { get; set; }
        public virtual string pass { get; set; }
        public virtual string email { get; set; }
        public virtual string level { get; set; }
        public virtual List<LocalCalendarGroupVO> localCalendarGroups { get; set; }
    }
    public class LocalCalendarGroupVO
    {

        public virtual int id { get; set; }
        public virtual string name { get; set; }

    }

This is my mapping file thus far. How can I make NHibernate aware of the intermediary table?

     <class name=""UserVO"" table=""tb_users"" lazy=""false"">

    <id name=""id"" column=""id"">

      <generator class=""native"" />

    </id>

    <property name=""name"" />
    <property name=""pass"" />
    <property name=""level"" />
    <property name=""email"" />
    <property name=""localCalendarGroups""/>
    


  </class>

Any help,pointers much appreciated.

  [1]: http://barry-jones.com/temp/sch2.jpg",2
6151640,05/27/2011 11:31:12,722783,04/24/2011 17:15:18,1,0,NHibernate QueryOver<> problem return a parent collection of a child entity,"I have a parent entity Category_Types with a collection of child entities Categories each one of these child entities has a collection of child entities Expenses:

Category_Types >> Categories (1:n), Categories >> Expenses (1:n)

i want to query for the total expenses for a specific Category_Type between specific dates
into the following unmapped class
    
    public class EntityTotals<T>
    {
        T _Entity;
        public T Entity
        {
            get
            {
                return _Entity;
            }
            set
            {
                _Entity = value;
            }
        }
        decimal _Total;
        public decimal Total
        {
            get
            {
                return _Total;
            }
            set
            {
                _Total = value;
            }
        }
    }

i have the following sql query:
    
    select ct.Cat_Type , SUM(isnull(e.Spends,0)) from Expenses e right join Categories c    on e.Category_Id = c.Category_Id
    right join Category_Types ct on ct.Cat_Type_Id = c.Cat_Type_Id
    where e.Spend_Date between @from and @to
    group by ct.Cat_Type 

so i wrote a query using QueryOver<> to get the same results of the sql query 
and i get the results into EntityTotals<> class as following:
    
    Expenses e = null;
    Categories c = null;
    Category_Types ct = null;
    return Session.QueryOver<Expenses>((() => e))
        .JoinAlias(() => e.Category, () => c)
        .JoinAlias(() => c.Category_Type, () => ct)
        .WhereRestrictionOn(() => e.Spend_Date)
        .IsBetween(from)
        .And(to)
        .SelectList(list => list
            .SelectGroup(() => ct)
            .SelectSum(ee => ee.Spends))
            .List<object[]>()
            .Select(exp =>
                new EntityTotals<Categories>()
                {
                    Entity = (Categories)exp[0],
                    Total = (decimal)exp[1]
                })
                .ToList<EntityTotals<Categories>>();

when i tested this query it gave me the following exception:

could not resolve property: ct of: Expenses

so i tried to get only some properties of Category_Types into the following unmapped class 

    public class Totals
    {
        int _Id;
        public int Id
        {
            get
            {
                return _Id;
            }
            set
            {
                _Id = value;
            }
        }
        decimal _Total;
        public decimal Total
        {
            get
            {
                return _Total;
            }
            set
            {
                _Total = value;
            }
        }
    }

with the following query to only get the property Cat_Type_Id of Category_Types and it works fine:

    Expenses e = null;
    Categories c = null;
    Category_Types ct = null;
    return Session.QueryOver<Expenses>((() => e))
          .JoinAlias(() => e.Category, () => c)
          .JoinAlias(() => c.Category_Type, () => ct)
          .WhereRestrictionOn(() => e.Spend_Date)
          .IsBetween(from)
          .And(to)
          .SelectList(list => list
              .SelectGroup(() => ct.Cat_Type_Id)
              .SelectSum(ee => ee.Spends))
              .List<object[]>()
              .Select(exp =>
                  new Totals()
                  {
                      Id = (int)exp[0],
                      Total = (decimal)exp[1]
                  })
                  .ToList<Totals>();

so how can i get the complete object of Category_Types from the first query ?

Thanks ;",nhibernate,nhibernate-queryover,,,,,open,0,1334,11,"NHibernate QueryOver<> problem return a parent collection of a child entity I have a parent entity Category_Types with a collection of child entities Categories each one of these child entities has a collection of child entities Expenses:

Category_Types >> Categories (1:n), Categories >> Expenses (1:n)

i want to query for the total expenses for a specific Category_Type between specific dates
into the following unmapped class
    
    public class EntityTotals<T>
    {
        T _Entity;
        public T Entity
        {
            get
            {
                return _Entity;
            }
            set
            {
                _Entity = value;
            }
        }
        decimal _Total;
        public decimal Total
        {
            get
            {
                return _Total;
            }
            set
            {
                _Total = value;
            }
        }
    }

i have the following sql query:
    
    select ct.Cat_Type , SUM(isnull(e.Spends,0)) from Expenses e right join Categories c    on e.Category_Id = c.Category_Id
    right join Category_Types ct on ct.Cat_Type_Id = c.Cat_Type_Id
    where e.Spend_Date between @from and @to
    group by ct.Cat_Type 

so i wrote a query using QueryOver<> to get the same results of the sql query 
and i get the results into EntityTotals<> class as following:
    
    Expenses e = null;
    Categories c = null;
    Category_Types ct = null;
    return Session.QueryOver<Expenses>((() => e))
        .JoinAlias(() => e.Category, () => c)
        .JoinAlias(() => c.Category_Type, () => ct)
        .WhereRestrictionOn(() => e.Spend_Date)
        .IsBetween(from)
        .And(to)
        .SelectList(list => list
            .SelectGroup(() => ct)
            .SelectSum(ee => ee.Spends))
            .List<object[]>()
            .Select(exp =>
                new EntityTotals<Categories>()
                {
                    Entity = (Categories)exp[0],
                    Total = (decimal)exp[1]
                })
                .ToList<EntityTotals<Categories>>();

when i tested this query it gave me the following exception:

could not resolve property: ct of: Expenses

so i tried to get only some properties of Category_Types into the following unmapped class 

    public class Totals
    {
        int _Id;
        public int Id
        {
            get
            {
                return _Id;
            }
            set
            {
                _Id = value;
            }
        }
        decimal _Total;
        public decimal Total
        {
            get
            {
                return _Total;
            }
            set
            {
                _Total = value;
            }
        }
    }

with the following query to only get the property Cat_Type_Id of Category_Types and it works fine:

    Expenses e = null;
    Categories c = null;
    Category_Types ct = null;
    return Session.QueryOver<Expenses>((() => e))
          .JoinAlias(() => e.Category, () => c)
          .JoinAlias(() => c.Category_Type, () => ct)
          .WhereRestrictionOn(() => e.Spend_Date)
          .IsBetween(from)
          .And(to)
          .SelectList(list => list
              .SelectGroup(() => ct.Cat_Type_Id)
              .SelectSum(ee => ee.Spends))
              .List<object[]>()
              .Select(exp =>
                  new Totals()
                  {
                      Id = (int)exp[0],
                      Total = (decimal)exp[1]
                  })
                  .ToList<Totals>();

so how can i get the complete object of Category_Types from the first query ?

Thanks ;",2
2669103,04/19/2010 16:28:12,38522,11/18/2008 10:18:37,2144,49,Types from multiple assemblies and namespaces in nhibernate mapping files,"You can specify the namespace and assembly to use types from at the top of HBM files:

    <hibernate-mapping xmlns=""urn:nhibernate-mapping-2.2"" assembly=""MyCorp.MyAssembly"" namespace=""MyCorp.MyAssembly.MyNamespace"">

Can you use types from multiple assemblies / namespaces within the same mapping file, and if so what is the syntax for doing so?

",nhibernate,nhibernate-mapping,assemblies,namespaces,,,open,0,47,10,"Types from multiple assemblies and namespaces in nhibernate mapping files You can specify the namespace and assembly to use types from at the top of HBM files:

    <hibernate-mapping xmlns=""urn:nhibernate-mapping-2.2"" assembly=""MyCorp.MyAssembly"" namespace=""MyCorp.MyAssembly.MyNamespace"">

Can you use types from multiple assemblies / namespaces within the same mapping file, and if so what is the syntax for doing so?

",4
2418237,03/10/2010 15:45:04,267181,02/05/2010 15:18:39,1,0,NHIbernate Newbie:  Can someone please explain why NHibernate attempts to execute a database update during CreateQuery execution,"Basically, I wish to fetch a filtered set of objects from the database (Oracle 9.2) based on the id property of the object PsalertsEvent.  The code being executed is:

    Public Overloads Function GetAll(ByVal laterThan As Long, ByVal filteredPsalertsEvents     As IList) As IList Implements IPsalertsEventRepo.GetAll
            'Get all psalerts events with an ID greater then the specified laterThan parameter
            filteredPsalertsEvents = MyBase.NHibernateSession.CreateQuery(""from PsalertsEvent p where p.id > "" & laterThan).List
            Return filteredPsalertsEvents
    End Function

NUnit generates the following text ouput:

***** PsalertsIp.Tests.Data.PSALERTSEventRepoTests.CanGetUnprocessedPsalertsEvents

NHibernate: select max(psalertsev0_.Id) as col_0_0_ from ALARM_REPLAY_NEW psalertsev0_
NHibernate: select psalertsev0_.Id as Id0_, psalertsev0_.ALARM_SUBSTATION_NAME as ALARM2_0_, psalertsev0_.ALARM_BUSBAR_NUM as ALARM3_0_, psalertsev0_.ALARM_COMPONENT_ALIAS as ALARM4_0_, psalertsev0_.ALARM_NAME as ALARM5_0_, psalertsev0_.ALARM_TEXT as ALARM6_0_, psalertsev0_.ALARM_TIME as ALARM7_0_ from ALARM_REPLAY_NEW psalertsev0_ where psalertsev0_.Id>20118832
NHibernate: UPDATE ALARM_REPLAY_NEW SET ALARM_SUBSTATION_NAME = :p0, ALARM_BUSBAR_NUM = :p1, ALARM_COMPONENT_ALIAS = :p2, ALARM_NAME = :p3, ALARM_TEXT = :p4, ALARM_TIME = :p5 WHERE Id = :p6;:p0 = 'Value Text', :p1 = 0, :p2 = 'Value Text', :p3 = NULL, :p4 = 'CLOSED', :p5 = 10/03/2010 15:06:31, :p6 = 20118833
15:06:56,389 ERROR [TestRunnerThread] AbstractBatcher [(null)]- Could not execute command: UPDATE ALARM_REPLAY_NEW SET ALARM_SUBSTATION_NAME = :p0, ALARM_BUSBAR_NUM = :p1, ALARM_COMPONENT_ALIAS = :p2, ALARM_NAME = :p3, ALARM_TEXT = :p4, ALARM_TIME = :p5 WHERE Id = :p6
Oracle.DataAccess.Client.OracleException ORA-01031: insufficient privileges    at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure)

   at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, String procedure, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src)

   at Oracle.DataAccess.Client.OracleCommand.ExecuteNonQuery()

   at NHibernate.AdoNet.AbstractBatcher.ExecuteNonQuery(IDbCommand cmd)

NUnit passes the test in question, however an error is subsequently generated centered on the oracle exception:

Oracle.DataAccess.Client.OracleException ORA-01031: insufficient privileges
",nhibernate,,,,,,open,0,299,18,"NHIbernate Newbie:  Can someone please explain why NHibernate attempts to execute a database update during CreateQuery execution Basically, I wish to fetch a filtered set of objects from the database (Oracle 9.2) based on the id property of the object PsalertsEvent.  The code being executed is:

    Public Overloads Function GetAll(ByVal laterThan As Long, ByVal filteredPsalertsEvents     As IList) As IList Implements IPsalertsEventRepo.GetAll
            'Get all psalerts events with an ID greater then the specified laterThan parameter
            filteredPsalertsEvents = MyBase.NHibernateSession.CreateQuery(""from PsalertsEvent p where p.id > "" & laterThan).List
            Return filteredPsalertsEvents
    End Function

NUnit generates the following text ouput:

***** PsalertsIp.Tests.Data.PSALERTSEventRepoTests.CanGetUnprocessedPsalertsEvents

NHibernate: select max(psalertsev0_.Id) as col_0_0_ from ALARM_REPLAY_NEW psalertsev0_
NHibernate: select psalertsev0_.Id as Id0_, psalertsev0_.ALARM_SUBSTATION_NAME as ALARM2_0_, psalertsev0_.ALARM_BUSBAR_NUM as ALARM3_0_, psalertsev0_.ALARM_COMPONENT_ALIAS as ALARM4_0_, psalertsev0_.ALARM_NAME as ALARM5_0_, psalertsev0_.ALARM_TEXT as ALARM6_0_, psalertsev0_.ALARM_TIME as ALARM7_0_ from ALARM_REPLAY_NEW psalertsev0_ where psalertsev0_.Id>20118832
NHibernate: UPDATE ALARM_REPLAY_NEW SET ALARM_SUBSTATION_NAME = :p0, ALARM_BUSBAR_NUM = :p1, ALARM_COMPONENT_ALIAS = :p2, ALARM_NAME = :p3, ALARM_TEXT = :p4, ALARM_TIME = :p5 WHERE Id = :p6;:p0 = 'Value Text', :p1 = 0, :p2 = 'Value Text', :p3 = NULL, :p4 = 'CLOSED', :p5 = 10/03/2010 15:06:31, :p6 = 20118833
15:06:56,389 ERROR [TestRunnerThread] AbstractBatcher [(null)]- Could not execute command: UPDATE ALARM_REPLAY_NEW SET ALARM_SUBSTATION_NAME = :p0, ALARM_BUSBAR_NUM = :p1, ALARM_COMPONENT_ALIAS = :p2, ALARM_NAME = :p3, ALARM_TEXT = :p4, ALARM_TIME = :p5 WHERE Id = :p6
Oracle.DataAccess.Client.OracleException ORA-01031: insufficient privileges    at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure)

   at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, String procedure, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src)

   at Oracle.DataAccess.Client.OracleCommand.ExecuteNonQuery()

   at NHibernate.AdoNet.AbstractBatcher.ExecuteNonQuery(IDbCommand cmd)

NUnit passes the test in question, however an error is subsequently generated centered on the oracle exception:

Oracle.DataAccess.Client.OracleException ORA-01031: insufficient privileges
",1
